=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.06 18:42:57 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Fri Jun  6 13:36:06 2014 from 172.16.10.44
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ .viset
ksh: .viset:  not found
icjlud@codes /d/iccol/desarrollo
$ co
icjlud@codes /d/iccol/desarrollo/copys
$ grep -l 06000-U-CARGAR-TABLA-DIRESTAN *
analitico.ori.proc
analitico.proc
ANALITICO.PROC
ANALITICO.PROCGJ
BDLCER.PROG
BDLDI2-ANT.PROC
BDLDI2-GB.PROC
BDLDI2-ORI.PROC
BDLDI2.PROC
BDLDI2.PROC_20121227
BDLDI2.PROC_25nov2012
BDLDI2.PROC-20131030
BDLDI2.PROC-20131101
BDLDI2.PROC-20140131
BDLDI2.PROC-STT
BDLDI2.PROCV9
BDLDI2.PROCV9X
BDLDI2BLQ.PROC
BDLDI2CAR.PROC
BDLDI2CAR.PROC.ANT
BDLDI2CARNEW.PROC
BDLDI2FIX.PROC
BDLDI2FIX00.PROC
BDLDI2FIX00.PROC.ANT
BDLDI2NEW.PROC
BDLDI2RMB.PROC
BDLDI2UNI.PROC
BDLDI2V.PROC
BDLDI2V10.PROCX
BDLDI2V39.PROC
BDLDI2V40.PROC
BDLDI2V41.PROC
BDLDI2V42.PROC
BDLDI2VV.PROC
BDLDI2XX.PROC
BDLDI3-ANT.PROC
BDLDI3-NEW.PROC
BDLDI3.PROC
BDLDI3V43-DB.PROC
BDLDI3V44-DB.PROC
BDLDI4.PROC
BDLDIR_PRO.PROC
BDLDIR-130309.PROC
BDLDIR-7682.PROC
BDLDIR-AAM.PROC
BDLDIR-AAM.PROC-BCK
BDLDIR-CON-R.PROC
BDLDIR-FINAL.PROC
BDLDIR-HG.PROC
BDLDIR-OLD.PROC
BDLDIR-PROD-CRM.PROC
BDLDIR.PROC
BDLDIR.PROC-140309-1133
BDLDIR.PROC-150309-0021
BDLDIR.PROC-150309-0037
BDLDIR.PROC-170309-BCK
BDLDIR.PROC-20091014
BDLDIR.PROC-bk-2009-12-23
BDLDIR.PROC-bk-2010-02-16
BDLDIR.PROC-NEW
BDLDIR.PROC-NEW-CON-RIC
BDLDIR.PROC-V26
BDLDIR.PROC.0000
BDLDIR.PROC.20091013
BDLDIR.PROC.ANT
BDLDIR.PROC.DLM
BDLDIR.PROC.NR
BDLDIR.PROC.ORI
BDLDIR.PROCPV
BDLDIRBDL.PROC
BDLDIRBDL.PROC.0000
BDLDIRDOC.PROC
BDLDIRDOC.PROC.0000
BDLDIRNEW.PROC
BDLDIRRGH.PROC
BDLDIRRMB.PROC
BDLDIRV12.PROC
BDLDIRV13.PROC
BDLDIRV24.PROC
BDLDIRV25.PROC
BDLDIRXX.PROC
BDLDIRXX.PROC.0000
grep: can't open CARACTCAL-V02.PROC-BCK10
grep: can't open CARACTCAL-V02.PROC-BCK11
grep: can't open CARACTCAL-V02.PROC-BCK5
grep: can't open CARACTCAL-V02.PROC-BCK6
grep: can't open CARACTCAL-V02.PROC-BCK7
grep: can't open CARACTCAL-V02.PROC-BCK9
grep: can't open CARACTPER-009.PROC-2012-01-06
grep: can't open core
DIRALG1.PROC
grep: can't open FRAINQ.DAT
INDEREGI.PROC
INDEREGI.PROC-ANT
INDEREGI.PROC.F-OLD!
INDEREGIV01.PROC
P_BDLDI2.PROC
RECDES.PROC
UTLINDEREGI.PROC
UTLLEY.PROC
icjlud@codes /d/iccol/desarrollo/copys
$ clear
icjlud@codes /d/iccol/desarrollo/copys
$ ^[  $ clear$ grep -l 06000-U-CARGAR-TABLA-DIRESTAN *$ grep -l 06000-U-CARGAR-TABLA-DIRESTAN *.PROC
ANALITICO.PROC
BDLDI2-ANT.PROC
BDLDI2-GB.PROC
BDLDI2-ORI.PROC
BDLDI2.PROC
BDLDI2BLQ.PROC
BDLDI2CAR.PROC
BDLDI2CARNEW.PROC
BDLDI2FIX.PROC
BDLDI2FIX00.PROC
BDLDI2NEW.PROC
BDLDI2RMB.PROC
BDLDI2UNI.PROC
BDLDI2V.PROC
BDLDI2V39.PROC
BDLDI2V40.PROC
BDLDI2V41.PROC
BDLDI2V42.PROC
BDLDI2VV.PROC
BDLDI2XX.PROC
BDLDI3-ANT.PROC
BDLDI3-NEW.PROC
BDLDI3.PROC
BDLDI3V43-DB.PROC
BDLDI3V44-DB.PROC
BDLDI4.PROC
BDLDIR_PRO.PROC
BDLDIR-130309.PROC
BDLDIR-7682.PROC
BDLDIR-AAM.PROC
BDLDIR-CON-R.PROC
BDLDIR-FINAL.PROC
BDLDIR-HG.PROC
BDLDIR-OLD.PROC
BDLDIR-PROD-CRM.PROC
BDLDIR.PROC
BDLDIRBDL.PROC
BDLDIRDOC.PROC
BDLDIRNEW.PROC
BDLDIRRGH.PROC
BDLDIRRMB.PROC
BDLDIRV12.PROC
BDLDIRV13.PROC
BDLDIRV24.PROC
BDLDIRV25.PROC
BDLDIRXX.PROC
DIRALG1.PROC
INDEREGI.PROC
INDEREGIV01.PROC
P_BDLDI2.PROC
RECDES.PROC
UTLINDEREGI.PROC
UTLLEY.PROC
icjlud@codes /d/iccol/desarrollo/copys
$ ^[  $ grep -l 06000-U-CARGAR-TABLA-DIRESTAN *.PROC$ grep -l 06000-U-CARGAR-TABLA-DIRESTAN *.PROC >| qqq
icjlud@codes /d/iccol/desarrollo/copys
$ vi qqq
"qqq" 53 lines, 808 characters ANALITICO.PROC
BDLDI2-ANT.PROC
BDLDI2-GB.PROC
BDLDI2-ORI.PROC
BDLDI2.PROC
BDLDI2BLQ.PROC
BDLDI2CAR.PROC
BDLDI2CARNEW.PROC
BDLDI2FIX.PROC
BDLDI2FIX00.PROC
BDLDI2NEW.PROC
BDLDI2RMB.PROC
BDLDI2UNI.PROC
BDLDI2V.PROC
BDLDI2V39.PROC
BDLDI2V40.PROC
BDLDI2V41.PROC
BDLDI2V42.PROC
BDLDI2VV.PROC
BDLDI2XX.PROC
BDLDI3-ANT.PROC
BDLDI3-NEW.PROC
BDLDI3.PROC
BDLDI3V43-DB.PROC
BDLDI3V44-DB.PROC
BDLDI4.PROC
BDLDIR_PRO.PROC
BDLDIR-130309.PROC
BDLDIR-7682.PROC
BDLDIR-AAM.PROC
BDLDIR-CON-R.PROC
BDLDIR-FINAL.PROC
BDLDIR-HG.PROC
BDLDIR-OLD.PROC
BDLDIR-PROD-CRM.PROC
BDLDIR.PROC
BDLDIRBDL.PROC
BDLDIRDOC.PROC
BDLDIRNEW.PROC
BDLDIRRGH.PROC
BDLDIRRMB.PROC
BDLDIRV12.PROC
BDLDIRV13.PROC
BDLDIRV24.PROC
BDLDIRV25.PROC
BDLDIRXX.PROC
DIRALG1.PROC
INDEREGI.PROC
INDEREGIV01.PROC"qqq" 53 lines, 808 characters:qicjlud@codes /d/iccol/desarrollo/copys
$ cd
icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>co
/d/iccol/desarrollo/copys>vi qqq
"qqq" 53 lines, 808 characters ANALITICO.PROC
BDLDI2-ANT.PROC
BDLDI2-GB.PROC
BDLDI2-ORI.PROC
BDLDI2.PROC
BDLDI2BLQ.PROC
BDLDI2CAR.PROC
BDLDI2CARNEW.PROC
BDLDI2FIX.PROC
BDLDI2FIX00.PROC
BDLDI2NEW.PROC
BDLDI2RMB.PROC
BDLDI2UNI.PROC
BDLDI2V.PROC
BDLDI2V39.PROC
BDLDI2V40.PROC
BDLDI2V41.PROC
BDLDI2V42.PROC
BDLDI2VV.PROC
BDLDI2XX.PROC
BDLDI3-ANT.PROC
BDLDI3-NEW.PROC
BDLDI3.PROC
BDLDI3V43-DB.PROC
BDLDI3V44-DB.PROC
BDLDI4.PROC
BDLDIR_PRO.PROC
BDLDIR-130309.PROC
BDLDIR-7682.PROC
BDLDIR-AAM.PROC
BDLDIR-CON-R.PROC
BDLDIR-FINAL.PROC
BDLDIR-HG.PROC
BDLDIR-OLD.PROC
BDLDIR-PROD-CRM.PROC
BDLDIR.PROC
BDLDIRBDL.PROC
BDLDIRDOC.PROC
BDLDIRNEW.PROC
BDLDIRRGH.PROC
BDLDIRRMB.PROC
BDLDIRV12.PROC
BDLDIRV13.PROC
BDLDIRV24.PROC
BDLDIRV25.PROC
BDLDIRXX.PROC
DIRALG1.PROC
INDEREGI.PROC
INDEREGIV01.PROC"qqq" 53 lines, 808 characters:r ANALITICO.PROC"ANALITICO.PROC" 1081 lines, 57516 characters 
ANALIT 2420-ANALITICO.
REMARK******************************************************************
REMARK*2420-ANALITICO.
REMARK* PRODUCTO QUE GENERA UN RESUMEN ANALITICO DE LA INFORMACION EN LA
REMARK* BASE DE DATOS. SE ADICIONA UNA DIRECCION DENTRO DEL INFORME SIN IR
REMARK* A UN PROGRAMA EXTERNO.
REMARK******************************************************************
ANALII     INITIALIZE VARIABLES-ANALITICO.
ANALII     MOVE MULT-ANALITICO(HEADER-LSN) TO TIP-ANA.
ANALII     MOVE 1 TO TIP-ANA.
ANALII     IF TIP-ANA = 0 OR > 5
ANALII        MOVE 1 TO TIP-ANA
ANALII     END-IF.
ANALII*****************************CAMBIAR*************************
ANALII     IF PR-APELLIDO ="1" MOVE 1 TO TIP-ANA.
ANALII     IF PR-APELLIDO ="2" MOVE 2 TO TIP-ANA.
ANALII     IF PR-APELLIDO ="3" MOVE 3 TO TIP-ANA.
ANALII     IF PR-APELLIDO ="4" MOVE 4 TO TIP-ANA.
ANALII*****************************CAMBIAR*************************
ANALII      PERFORM 2422-ARCHIVOS-VALIDACION
ANALII      IF MENS-ERR = 0
ANALII         PERFORM 10500-VALIDAR-APELLIDO-REGIS.
ANALII      IF MENS-ERR = 0 AND TIP-ID = 1RMB0124
ANALII         IF BLOQUEO-TUTELA-BDIIREGI = "S"RMB0124
ANALII     PERFORM 2419-MANDAR-TUTELARMB0124
ANALII            PERFORM 2424-CONSULTASRMB0061
ANALII         END-IFRMB0124
ANALII      END-IF.RMB0124
ANALII      IF MENS-ERR = 0
ANALII         PERFORM 2421-PRESCREEN-CUBIERTOVHF0096
ANALII         IF MULT-TABLA-SCORES(HEADER-LSN) NOT = "0000000000"RMB0041
ANALII            PERFORM 2421-CALCULOS-SCORERMB0041
ANALII         END-IFRMB0041
ANALII         PERFORM 6710-ENVIAR-TITULOS
ANALII         PERFORM 2423-VER-DIRECCIONES
ANALII         MOVE TIP-ID TO TIP-IDE-AUX-BDIIALERMB0150
ANALII         MOVE NUM-ID TO NUM-IDE-AUX-BDIIALERMB0150
ANALII         IF MOD-TAB = 0RMB0161
ANALII            PERFORM 7000-RECORRER-BDIIALERMB0161
ANALII         END-IFRMB0161
ANALII         IF NUMERO-DE-SCORES > 0RMB0147
ANALII            PERFORM 6900-MEN-TIT-SISCORERMB0147
ANALII         END-IFRMB0147
ANALII         PERFORM 2423-EXTRACTAR-ANALITICOII
ANALII         PERFORM 2423-SEND-ANALITICOII
ANALII         MOVE 1 TO TUTELA  *> NO MANDE LAS CONSULTAS
ANALII         PERFORM 2424-CONSULTASRMB0061
ANALII         MOVE 0 TO TUTELA
/06000-REMARK******************************************************************
REMARK*2423-ENVIAR-ANALITICO.
REMARK* ESTA RUTINA SE ENCARGA DE CALCULAR LAS TRAMAS DE 80 CARACTERES A
REMARK* ENVIAR DE ACUERDO A LA LONGITUD ESPECIFICADA EN CADA UNO DE LOS
REMARK* TITULOS O LINEAS DISEÑADAS. SE ABLOCAN CON LA RUTINA NORMAL
REMARK******************************************************************
ANALIT     MOVE 4 TO I-ANA.
ANALIT     MOVE AREA-ANA-SEND(1:3) TO J-ANA.
ANALIT     PERFORM UNTIL I-ANA > J-ANA
ANALITMOVE AREA-ANA-SEND(I-ANA:80) TO MOVIMIENTO-S
ANALITMOVE 1 TO REC
ANALITPERFORM 6700-CONT-CTA
ANALITADD 80 TO I-ANA
ANALIT     END-PERFORM.
ANALIT 2423-VER-DIRECCIONES.
REMARK******************************************************************
REMARK*2423-VER-DIRECCIONES.
REMARK* SE DETERMINA SI EL SUSCRIPTOR PERTENECE AL CLUB DE DATACLIENTES.
REMARK* SI PERTENECE SE PROCEDE A BUSCAR TODAS LAS DIRECCIONES REPORTADAS
REMARK******************************************************************
ANALIT     IF OPEN-DIR = 0
ANALITOPEN INPUT MAESTRO-DIRECC
ANALITOPEN INPUT BDLCLI
ANALITPERFORM 06000-U-CARGAR-TABLA-DIRESTAN
ANALITMOVE 1 TO OPEN-DIR
ANALIT     END-IF.
ANALIT     MOVE MULT-NIT(HEADER-LSN) TO NIT-ID-BDLCLI.
ANALIT     READ BDLCLI IGNORE LOCK
ANALITINVALID KEY MOVE 0 TO INDICADOR-BDLCLI
ANALIT     END-READ.
ANALIT     IF INDICADOR-BDLCLI > 0
ANALITMOVE 2 TO PRIVILEGIO-BDLCLI *> OBLIGA A MIRAR TODAS LAS DIR
ANALITPERFORM 2423-SEND-DIRECCIONES
ANALIT     END-IF.
ANALIT 2423-SEND-DIRECCIONES.
REMARK******************************************************************
REMARK*2423-SEND-DIRECCIONES.
REMARK* SE DETERMINA LA MEJOR DIRECCION Y TELEFONO PARA SE ADICIONADAS
REMARK* AL HEADER STANDARD O ENCABEZADO DE LOS INFORMES DE DATACREDITO
REMARK******************************************************************
ANALIT     MOVE 0 TO HAY-CTADIR.RMB0017
ANALIT     INITIALIZE LLAVE-DIRECC.RMB0017
ANALIT     MOVE 0 TO FIN-DIR   .RMB0017
ANALIT     MOVE TIP-ID TO TIPO-ID-DIRECC.RMB0017
ANALIT     MOVE NUM-ID TO NUM-ID-DIRECC.RMB0017
ANALIT     START MAESTRO-DIRECC KEY >= LLAVE-DIRECCRMB0017
ANALITINVALID KEYRMB0017
ANALITMOVE 1 TO FIN-DIRRMB0017
ANALITNOT INVALID KEYRMB0017/Address search hit BOTTOM without matching pattern?Address search hit TOP without matching patternANALITICO.PROC
BDLDI2-ANT.PROC
BDLDI2-GB.PROC
BDLDI2-ORI.PROC
BDLDI2.PROC
BDLDI2BLQ.PROC
BDLDI2CAR.PROC
BDLDI2CARNEW.PROC
BDLDI2FIX.PROC
BDLDI2FIX00.PROC
BDLDI2NEW.PROC
BDLDI2RMB.PROC
BDLDI2UNI.PROC
BDLDI2V.PROC
BDLDI2V39.PROC
BDLDI2V40.PROC
BDLDI2V41.PROC
BDLDI2V42.PROC
BDLDI2VV.PROC
BDLDI2XX.PROC
BDLDI3-ANT.PROC
BDLDI3-NEW.PROC
BDLDI3.PROC
BDLDI3V43-DB.PROC
BDLDI3V44-DB.PROC
BDLDI4.PROC
BDLDIR_PRO.PROC
BDLDIR-130309.PROC
BDLDIR-7682.PROC
BDLDIR-AAM.PROC
BDLDIR-CON-R.PROC
BDLDIR-FINAL.PROC
BDLDIR-HG.PROC
BDLDIR-OLD.PROC
BDLDIR-PROD-CRM.PROC
BDLDIR.PROC
BDLDIRBDL.PROC
BDLDIRDOC.PROC
BDLDIRNEW.PROC
BDLDIRRGH.PROC
BDLDIRRMB.PROC
BDLDIRV12.PROC
BDLDIRV13.PROC
BDLDIRV24.PROC
BDLDIRV25.PROC
BDLDIRXX.PROC
DIRALG1.PROC
INDEREGI.PROC
INDEREGIV01.PROC
1081 fewer lines



:r BDLDI2.PROC"BDLDI2.PROC" 4799 lines, 348564 characters REMARK*BDLDI2.PROC.v.0041
MATCH1$SET CONSTANT HACERMATCH"NO"RMB0013
MATCH1$IF HACERMATCH = "SI"RMB0013
MATCH1$DISPLAY ".............COMPILANDO BDLDI2 CON MATCH **********     RMB0013
MATCH1$ELSE     RMB0013
MATCH1$DISPLAY ".............COMPILANDO BDLDI2 SIN MATCH **********     RMB0013
MATCH1$END    RMB0013
REMARK******************************************************************
REMARK* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS
REMARK* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.
REMARK*    2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO
REMARK*    2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL
REMARK*       REGISTRO DIRECC .
REMARK*    2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE
REMARK*      ORDENAN DE ACUERDO A LO DEFINIDO
REMARK*    2017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE
REMARK*        ORDENAN DE ACUERDO A LO DEFINIDO
REMARK*    06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS
REMARK*          DE ESTANDARIZACION DE NOMBRES DE
REMARK*          COMPONENTES DE LAS DIRECCIONES
REMARK*    6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO
REMARK*        A LAS TABLAS DE SINONIMOS LEIDA.
REMARK*******************************************************************
REMARK* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS
REMARK* FEB-15-2003  *PROBABLE AUMENTANDO UN PESO CON BASE A LA
REMARK* R.MARTINEZ   *CONFORMACION DE LA DIRECCION O DEL TELEFONO
REMARK*******************************************************************
REMARK* RMB0003* DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS
REMARK* MAR-15-2003  *PERMISOS DE ACCESO A LA BASE DE DATOS DE
REMARK* R.MARTINEZ   *DIRECCIONES
REMARK*******************************************************************
REMARK* RMB0004* VEC001 - SE CORRIGE PROBLEMA EN EL VECTOR DE TELE
REMARK* ABR-15-2003  *FONOS YA QUE USABA LA FECHA DE DIRECCIONES
REMARK* R.MARTINEZ   *Y NO LA V-FECHATEL
REMARK*******************************************************************
REMARK* RMB0005* UBI001 - SE CORRIGE PROBLEMA DE REFLEGAR EN EL
REMARK* ABR-15-2003  *INFORME LA MISMA DIRECCION COMO R,L,C DIF-
REMARK* R.MARTINEZ   *ENTE EN DETALLE Y RESUMEN
REMARK*******************************************************************
REMARK* VHF0006* ESTAN1 - SE PERMITE QUE LAS PARTICULAS PARA
REMARK* MAY-27-2003  *ESTANDARIZAR SEAN DE HASTA 30 CARACTERES
REMARK* V.FORERO     *
REMARK*******************************************************************
      * RMB0007     * VALPRI- SE ARREGLA PROBLEMA DE SACAR TIPO-5 SI   *//AJCONT     IF CAL-MAIL-BDLDIR > 0FARF035
AJCONTMOVE 1 TO CONTAFARF035
*se hace el ciclo hasta el tamaño de la varibale.
AJCONTPERFORM UNTIL CONTA > 40FARF035
AJCONTIF FUNCTION ORD(MAIL-BDLDIR(CONTA:1)) < 32FARF035
AJCONTMOVE 0 TO CAL-MAIL-BDLDIRFARF035
AJCONTMOVE 50 TO CONTAFARF035
AJCONTEND-IFFARF035
*FARF035
AJCONTADD 1 TO CONTAFARF035
AJCONTEND-PERFORMFARF035
AJCONT     END-IF.FARF035
*
*    verificamos si existe en el archivo de mail excluidosIF CAL-MAIL-BDLDIR > 0
RECPF2READ BDLMAIEXC NOT INVALID KEYHGO0022
RECPF2MOVE 0 TO CAL-MAIL-BDLDIRHGO0022
RECPF2END-READHGO0022END-IF.
*
NEWDIR*-----------------------------------------------------------------
REMARK*RUTINAS PARA LA ESTANDARIZACION DE DIRECCIONES
REMARK*-----------------------------------------------------------------
STANDA 06000-U-CARGAR-TABLA-DIRESTAN.
REMARK******************************************************************
REMARK*06000-CARGAR-TABLA-DIRESTAN.*
REMARK*    SE CARGA EN MEMORIA LA TABLA PARA ESTANDARIZACION DE*
REMARK*    DIRECCIONES*
REMARK*    PARAMETROS
REMARK*INPUTDECLARAR ARCHIVO DIREST
REMARK*OUTPUT     TABLA-DIR-ESTANDAR.
REPLUS*    CARGA EN MEMORIA ARCHIVO DE CIUDADES DUPLICADAS
REMARK******************************************************************
RCNCER     INITIALIZE TABLA-DIR-COMPUESTAS-BDLDIRRMB0010
RECPF2*RCNCER     OPEN INPUT DIRESTHGO0022
MOD023*    MOVE "$DATABASE/BDLDIRACE" TO TITLE-BDLDIRACERGH0023
RECPF2     OPEN INPUT BDLDIRACEHGO0022
RCNCER     MOVE 0 TO FDA-DIREST-BDLDIRRMB0010
RECPF2*STANDA     READ DIRESTHGO0022
RECPF2     READ BDLDIRACE NEXT RECORDHGO0022
STANDAAT END
RCNCERMOVE 1 TO FDA-DIREST-BDLDIRRMB0010
STANDA     END-READ
RCNCER     MOVE 1 TO I-STA-BDLDIRRMB0010
RCNCER     MOVE 1 TO J-STA-BDLDIRRMB0010
RCNCER*    PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 500   RMB0010
AMP027     PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 2000  PJV0027
RECPF2*RCNCERIF DIR-ORIG-DIREST (1:4) <> "****"HGO0022
RECPF2*RCNCERMOVE DIR-ORIG-DIRESTHGO0022STANDA 06000-U-CARGAR-TABLA-DIRESTAN.
REMARK******************************************************************
REMARK*06000-CARGAR-TABLA-DIRESTAN.*
REMARK*    SE CARGA EN MEMORIA LA TABLA PARA ESTANDARIZACION DE*
REMARK*    DIRECCIONES*
REMARK*    PARAMETROS
REMARK*INPUTDECLARAR ARCHIVO DIREST
REMARK*OUTPUT     TABLA-DIR-ESTANDAR.
REPLUS*    CARGA EN MEMORIA ARCHIVO DE CIUDADES DUPLICADAS
REMARK******************************************************************
RCNCER     INITIALIZE TABLA-DIR-COMPUESTAS-BDLDIRRMB0010
RECPF2*RCNCER     OPEN INPUT DIRESTHGO0022
MOD023*    MOVE "$DATABASE/BDLDIRACE" TO TITLE-BDLDIRACERGH0023
RECPF2     OPEN INPUT BDLDIRACEHGO0022
RCNCER     MOVE 0 TO FDA-DIREST-BDLDIRRMB0010
RECPF2*STANDA     READ DIRESTHGO0022
RECPF2     READ BDLDIRACE NEXT RECORDHGO0022
STANDAAT END
RCNCERMOVE 1 TO FDA-DIREST-BDLDIRRMB0010
STANDA     END-READ
RCNCER     MOVE 1 TO I-STA-BDLDIRRMB0010
RCNCER     MOVE 1 TO J-STA-BDLDIRRMB0010
RCNCER*    PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 500   RMB0010
AMP027     PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 2000  PJV0027
RECPF2*RCNCERIF DIR-ORIG-DIREST (1:4) <> "****"HGO0022
RECPF2*RCNCERMOVE DIR-ORIG-DIRESTHGO0022
RECPF2MOVE DIR-ORIG-BDLDIRACEHGO0022
RCNCERTO DIR-ORIGINAL-BDLDIR (I-STA-BDLDIR)RMB0010
RECPF2*RCNCERMOVE DIR-ESTAN-DIRESTHGO0022
RECPF2MOVE DIR-ESTAN-BDLDIRACEHGO0022
RCNCERTO DIR-ESTANDAR-BDLDIR (I-STA-BDLDIR)RMB0010
RCNCERINITIALIZE M-BDLDIRRMB0010
RECPF2*RCNCERINSPECT DIR-ORIG-DIREST TALLYING M-BDLDIR FOR ALHGO0022
RECPF2INSPECT DIR-ORIG-BDLDIRACE TALLYING M-BDLDIRHGO0022
RECPF2FOR ALL "*"HGO0022
RCNCERIF M-BDLDIR > 0RMB0010
RCNCERINITIALIZE M-BDLDIRRMB0010
RECPF2*RCNCERINSPECT DIR-ORIG-DIRESTHGO0022
RECPF2INSPECT DIR-ORIG-BDLDIRACEHGO0022
RCNCERTALLYING M-BDLDIRRMB0010
RCNCERFOR CHARACTERS BEFORE INITIAL " "RMB0010
RCNCERMOVE 0 TO DIR-COMPUESTAS-TIP-BDLDIR (J-STA-BDLDIR)  RMB0010
RCNCERMOVE M-BDLDIRRMB0010
RCNCERTO DIR-COMPUESTAS-LON-BDLDIR (J-STA-BDLDIR)    RMB0010
RECPF2*RCNCERMOVE DIR-ORIG-DIRESTHGO0022
RECPF2MOVE DIR-ORIG-BDLDIRACEHGO0022
RCNCERTO DIR-COMPUESTAS-AST-BDLDIR (J-STA-BDLDIR)    RMB0010
RECPF2*RCNCERINSPECT DIR-ORIG-DIREST REPLACING ALL "*" BY HGO0022
RECPF2INSPECT DIR-ORIG-BDLDIRACE REPLACING ALL "*" BY " " HGO0022



REMARKANALITICO.PROC
BDLDI2-ANT.PROC
BDLDI2-GB.PROC
BDLDI2-ORI.PROC
BDLDI2.PROC
BDLDI2BLQ.PROC
BDLDI2CAR.PROC
BDLDI2CARNEW.PROC
BDLDI2FIX.PROC
BDLDI2FIX00.PROC
BDLDI2NEW.PROC
BDLDI2RMB.PROC
BDLDI2UNI.PROC
BDLDI2V.PROC
BDLDI2V39.PROC
BDLDI2V40.PROC
BDLDI2V41.PROC
BDLDI2V42.PROC
BDLDI2VV.PROC
BDLDI2XX.PROC
BDLDI3-ANT.PROC
BDLDI3-NEW.PROC
BDLDI3.PROC
BDLDI3V43-DB.PROC
BDLDI3V44-DB.PROC
BDLDI4.PROC
BDLDIR_PRO.PROC
BDLDIR-130309.PROC
BDLDIR-7682.PROC
BDLDIR-AAM.PROC
BDLDIR-CON-R.PROC
BDLDIR-FINAL.PROC
BDLDIR-HG.PROC
BDLDIR-OLD.PROC
BDLDIR-PROD-CRM.PROC
BDLDIR.PROC
BDLDIRBDL.PROC
BDLDIRDOC.PROC
BDLDIRNEW.PROC
BDLDIRRGH.PROC
BDLDIRRMB.PROC
BDLDIRV12.PROC
BDLDIRV13.PROC
BDLDIRV24.PROC
BDLDIRV25.PROC
BDLDIRXX.PROC
DIRALG1.PROC
INDEREGI.PROC
INDEREGIV01.PROC
4799 fewer lines
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
53 lines deletedNo lines in buffer!grep -l 1000-U-RECORRER-CSV-BDAMATCHA *.PROCBDAMATCH.PROC
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC24 more lines:r BDAMATCH.PROC"BDAMATCH.PROC" 1201 lines, 77406 characters 
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK*             *MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK*             *NUM-CTAS-OUTPUT-BDAMATCH
REMARK*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK*             *BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK*             *DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************

 1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************
 MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003

/1000-U-RECORRER-CSV-BDAMATCH?Address search hit TOP without matching pattern/?1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHEND-IF.
INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVINVALID KEY
MOVE 1 TO FIN-BDAMATCHNOT INVALID KEY
READ BDACSV IGNORE LOCK NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READEND-START.
PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
NUM-IDE-INPUT-BDAMATCH  OR
TIPO-ID-BDACSV  NOT =
TIP-IDE-INPUT-BDAMATCHMOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDAMATCHNOT INVALID KEY
FUEN01MOVE 1 TO PROCESAR-BDAMATCHRMB0004END-READ
BLOQ01IF PROCESAR-BDAMATCH = 1RMB0004
BLOQ01IF ESTADO-ABD02 = 1RMB0004
BLOQ01IF IND-BLOQUEO-BDACSV <> "B"RMB0004
BLOQ01MOVE 1 TO PROCESAR-BDAMATCHRMB0004
FUEN01IF FUENTE-REG-BDACSV <= 01RMB0004
FUEN01PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004
FUEN01ELSERMB0004
FUEN01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
FUEN01END-IFRMB0004"qqq" [Modified] line 41 of 1226 --3%-- FUEN01ELSERMB0004"qqq" [Modified] line 42 of 1226 --3%-- 
   




BLOQ01IF ESTADO-ABD02 = 1RMB0004
BLOQ01IF IND-BLOQUEO-BDACSV <> "B"RMB0004
BLOQ01MOVE 1 TO PROCESAR-BDAMATCHRMB0004
FUEN01IF FUENTE-REG-BDACSV <= 01RMB0004
FUEN01PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004
FUEN01ELSERMB0004
FUEN01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
FUEN01END-IFRMB0004
FUEN01ELSERMB0004
BLOQ01MOVE 0 TO PROCESAR-BDAMATCHRMB0004
BLOQ01END-IFRMB0004
BLOQ01ELSERMB0004
BLOQ01MOVE 0 TO PROCESAR-BDAMATCHRMB0004
BLOQ01END-IFRMB0004
BLOQ01END-IFRMB0004IF PROCESAR-BDAMATCH = 1PERFORM 1200-PROC-REG-CSV-BDAMATCHEND-IF
READ BDACSV IGNORE LOCK   NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READ
LIMI01IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
LIMI01MOVE 1 TO FIN-BDAMATCH*> SE ABLIGA A TIPRMB0004
LIMI01MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y   RMB0004
LIMI01MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
LIMI01END-IFRMB0004END-PERFORM.
IF MAX-CUENTAS-BDAMATCH > 0
APEL01IF APELLIDO-INPUT-BDAMATCH <> SPACES ANDRMB0004
APEL01MAX-CUENTAS-BDAMATCH > 1RMB0004
APEL01PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004
APEL01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
APEL01PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004
APEL01END-IFRMB0004PERFORM 9000-U-REALIZAR-BDAMATCH
NOMB01IF NOM-OUTPUT-BDAMATCH <> SPACES ANDRMB0004
NOMB01(TIP-IDE-INPUT-BDAMATCH = 1 OR 4)RMB0004
NOMB01MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004
NOMB01PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004
NOMB01MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004
NOMB01END-IFRMB0004IF NOM-OUTPUT-BDAMATCH <> SPACESMOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF.
NOMB01 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004
NOMB01     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
NOMB01     MOVE 0 TO I-MAQRMB0004BLOQ01IF PROCESAR-BDAMATCH = 1RMB0004NOMB01 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004
NOMB01     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
NOMB01     MOVE 0 TO I-MAQRMB0004
NOMB01     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
NOMB01INITIAL "Y/O"RMB0004
NOMB01OR"Y\O"RMB0004
NOMB01OR" Y/OTRO "RMB0004
NOMB01OR" Y/OTRA "RMB0004
NOMB01OR" Y\OTRO "RMB0004
NOMB01OR" Y\OTRA "RMB0004
NOMB01OR" Y OTRO "RMB0004
NOMB01OR" Y OTRA "RMB0004
NOMB01     IF I-MAQ < 45 AND I-MAQ > 2RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01     ELSERMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)RMB0004
NOMB01END-IFRMB0004
NOMB01     END-IFRMB0004
NOMB01     MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01     MOVE 1 TO I-MAQ.RMB0004
NOMB01     PERFORM UNTIL I-MAQ > 45RMB0004
NOMB01MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQRMB0004
NOMB01IF TILDE-MAQRMB0004
NOMB01PERFORM 1000-CAMBIAR-TILDE-MAQRMB0004
NOMB01MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)RMB0004
NOMB01END-IFRMB0004
NOMB01IF FUNCTION ORD(ACTUAL-MAQ) < 31RMB0004
NOMB01MOVE "." TO ACTUAL-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01MOVE " " TO ANT-MAQRMB0004
NOMB01IF I-MAQ > 1RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ - 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01MOVE " " TO SIG-MAQRMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01IF ACTUAL-MAQ = ")"RMB0004
NOMB01MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01IF SW-BORRAR-MAQ = 0RMB0004
NOMB01IF ELIMINAR-MAQRMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01IF I-MAQ > 1RMB0004NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01IF I-MAQ > 1RMB0004
NOMB01MOVE 1 TO SW-BORRAR-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01IF BORRAR-MAQRMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01ELSERMB0004
NOMB01IF QUITAR-MAQRMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01COMPUTE I-MAQ = I-MAQ - 1RMB0004
NOMB01ELSERMB0004
NOMB01IF VALIDO-MAQRMB0004
NOMB01CONTINUERMB0004
NOMB01ELSERMB0004
NOMB01IF ANT-MAQ = "N" AND SIG-VOCAL-MAQRMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01COMPUTE I-MAQ = I-MAQ - 1RMB0004
NOMB01ELSERMB0004
NOMB01IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
NOMB01(ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
NOMB01IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01ELSERMB0004
NOMB01MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01IF NOT ANT-VOCAL-MAQ ANDRMB0004
NOMB01SIG-VOCAL-MAQRMB0004
NOMB01MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01ELSERMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01END-IFRMB0004
NOMB01ADD 1 TO I-MAQRMB0004NOMB01END-IFRMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01     END-PERFORM.RMB0004
NOMB01     INITIALIZE PARTICULAS-INPMAQRMB0004
NOMB01     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "RMB0004
NOMB01INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
NOMB01P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
NOMB01P10-INPMAQRMB0004
NOMB01     MOVE SPACES TO NOMBRE-OUTMAQ-OKRMB0004
NOMB01     STRING P1-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P2-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P3-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P4-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P5-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P6-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P7-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P8-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P9-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P10-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01INTO NOMBRE-OUTMAQ-OK.RMB0004
NOMB01INSPECT NOMBRE-OUTMAQ-OKRMB0004
NOMB01REPLACING ALL  " PE A " BY " PENA ".RMB0004
NOMB01  1000-CAMBIAR-TILDE-MAQ.RMB0004
NOMB01EVALUATE ACTUAL-MAQRMB0004
NOMB01WHEN "Á"RMB0004
NOMB01MOVE "A" TO ACTUAL-MAQRMB0004
NOMB01WHEN "É"RMB0004
NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Í"RMB0004
NOMB01MOVE "I" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ó"RMB0004
NOMB01MOVE "O" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ú"RMB0004
NOMB01MOVE "U" TO ACTUAL-MAQRMB0004
NOMB01WHEN "á"RMB0004
NOMB01MOVE "A" TO ACTUAL-MAQRMB0004
NOMB01WHEN "é"RMB0004
NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "í"RMB0004NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "í"RMB0004
NOMB01MOVE "I" TO ACTUAL-MAQRMB0004
NOMB01WHEN "ó"RMB0004
NOMB01MOVE "O" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ú"RMB0004
NOMB01MOVE "U" TO ACTUAL-MAQRMB0004
NOMB01END-EVALUATE.RMB0004
APEL01 1100-LLENAR-CSV-APE-BDAMATCH.RMB0004
APEL01     INITIALIZE REG-BDACSVRMB0004
APEL01     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSVRMB0004
APEL01     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSVRMB0004
APEL01     MOVE 980001TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
APEL01     MOVE 02TO  COD-CTA-BDACSVRMB0004
APEL01     MOVE "APELLID-01"   TO  NUM-CTA-BDACSVRMB0004
APEL01     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSVRMB0004
APEL01     MOVE ".-,"TO  NOMBRE-BDACSV(43:3)RMB0004
APEL01     MOVE 20110801TO  FECHA-CREA-BDACSVRMB0004
APEL01     MOVE 0TO  NUM-PORTAF-BDACSVRMB0004
APEL01     MOVE 0TO  IND-NOMBRE-BDACSVRMB0004
APEL01     MOVE 0TO  MEJOR-PORTAF-BDACSVRMB0004
APEL01     MOVE 0TO  IND-ACTUALIZ-BDACSVRMB0004
APEL01     MOVE 01TO  FUENTE-REG-BDACSV.RMB0004
APEL01 1100-LLENAR-AUX-BDAMATCH.RMB0004
REMARK***********************************************************************
REMARK*1100-LLENAR-AUX-BDAMATCH.
REMARK* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE
REMARK* TAMAÑO
REMARK***********************************************************************
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE 0 TO FALLECIDO-BDAMATCH.RMB0004
1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
REMARK* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
REMARK***********************************************************************MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
VIGE01     MOVE 0 TO FALLECIDO-BDAMATCHRMB0003IF COD-CTA-BDACSV = 01 OR 51MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECKREAD MAESTRO-CHECK IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
BLOQ01IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)RMB0004
SINBLQAND CONSECUTIVO-ABD06 = 1
VIGE01IF ADJETIVO-ABD06 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
SINBLQELSERMB0003
SINBLQMOVE 0 TO PROCESAR-BDAMATCHRMB0003
SINBLQEND-IFRMB0003
SINBLQEND-READ
ELSE
MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDITREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
BLOQ01IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)RMB0004
SINBLQAND CONSECUTIVO-ABD07 = 1
VIGE01IF ADJETIVO1-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO2-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO3-ABD07 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
SINBLQELSERMB0003
SINBLQMOVE 0 TO PROCESAR-BDAMATCHRMB0003
VIGE01END-IFRMB0003END-READ
END-IF.1200-PROC-REG-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1200-PROC-REG-CSV-BDAMATCH.
REMARK* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
REMARK* SI LO HAY
REMARK***********************************************************************IF MAX-CUENTAS-BDAMATCH = 0MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .REMARK***********************************************************************REMARK* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCHREMARK* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTANREMARK*1100-UBICAR-CHKCRE-CSV-BDAMATCH.REMARK***********************************************************************1200-PROC-REG-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1200-PROC-REG-CSV-BDAMATCH.
REMARK* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
REMARK* SI LO HAY
REMARK***********************************************************************IF MAX-CUENTAS-BDAMATCH = 0PERFORM 1000-U-INICIALIZAR-BDAMATCHEND-IF.
MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLMPERFORM 2000-U-INSERTAR-CTA-BDAMATCH.MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.READ MAESTRO-DIRECC IGNORE LOCK
MEJO01*NOT INVALID KEYRMB0004
MEJO01*PERFORM 1210-DIRTEL-BDACSV-BDAMATCHRMB0004
MEJO01INVALID KEYRMB0004
MEJO01MOVE SPACES TO LLAVE-DIRECCRMB0004END-READ.
MEJO01     IF LLAVE-DIRECC <> SPACESRMB0004
MEJO01PERFORM 1210-DIRTEL-BDACSV-BDAMATCHRMB0004
MEJO01     END-IF.RMB00041210-DIRTEL-BDACSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.
REMARK* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
REMARK* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
REMARK***********************************************************************IF CIURES-DIRECC NOT = SPACESIF DIRRES-DIRECC NOT = SPACESMOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELRES-DIRECC > 0 ANDTELRES-DIRECC < 9999999999MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIULAB-DIRECC NOT = SPACESIF DIRLAB-DIRECC NOT = SPACESMOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELLAB-DIRECC > 0 ANDTELLAB-DIRECC < 9999999999
1210-DIRTEL-BDACSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.
REMARK* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
REMARK* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
REMARK***********************************************************************IF CIURES-DIRECC NOT = SPACESIF DIRRES-DIRECC NOT = SPACESMOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELRES-DIRECC > 0 ANDTELRES-DIRECC < 9999999999MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIULAB-DIRECC NOT = SPACESIF DIRLAB-DIRECC NOT = SPACESMOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELLAB-DIRECC > 0 ANDTELLAB-DIRECC < 9999999999MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIUCOR-DIRECC NOT = SPACES ANDDIRCOR-DIRECC NOT = SPACESMOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF.8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9MOVE 0 TO IND-BLOQUEO-ABD07END-IF
END-IF.8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9MOVE 0 TO IND-BLOQUEO-ABD07END-IF
END-IF.8000-U-VER-CTAABD06-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD06-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9MOVE 0 TO IND-BLOQUEO-ABD06END-IF
END-IF.

REMARK*======================================================================
1000-U-INICIALIZAR-BDAMATCH.
REMARK********************************************************************
REMARK*1000-U-INICIALIZAR-BDAMATCH.
REMARK* INPUT = VACIO
REMARK* OUTPUT= VACIO
REMARK* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
REMARK* DEl MATCH.
REMARK********************************************************************MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.MOVE 0 TO I-CTA-BDAMATCH.
PESO01     INITIALIZE TABLA-CUENTAS-BDAMATCH.RMB0004INITIALIZE TABLA-DIR-BDAMATCH.INITIALIZE TABLA-TEL-BDAMATCH.INITIALIZE TABLA-NOM-BDAMATCH.INITIALIZE TABLA-GRUNOM-BDAMATCH.INITIALIZE V-INTERRELAC-BDAMATCH.MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.2000-U-INSERTAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-DIR-BDAMATCH.
REMARK* INPUT = DIR-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
REMARK* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
REMARK* LA DIRECCION CONTENGA ALGUN NUMERO
REMARK********************************************************************MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.MOVE 1 TO I-BDAMATCHMOVE 0 TO J-BDAMATCHMOVE " " TO CAR-ANT-BDAMATCHINITIALIZE T-CARTOT-BDAMATCH
CARTOT     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10CAV0002IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERICMOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCHIF CAR-ANT-BDAMATCH   NUMERICCOMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)= V-CARTOT-BDAMATCH  (J-BDAMATCH)* 10 + CAR-ACT-BDAMATCHELSE
ADD 1 TO J-BDAMATCH
MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)TO V-CARTOT-BDAMATCH  (J-BDAMATCH)END-IF
END-IF
MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCHADD 1 TO I-BDAMATCHEND-PERFORM.
SORT V-CARTOT-BDAMATCH   DESCENDING.IF T-CARTOT-BDAMATCH   NOT = ZEROS ANDI-DIR-BDAMATCH < LIM-BDAMATCHMOVE T-CARTOT-BDAMATCH TO
NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TOSUS-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1UNTIL  POSIC-SUMA-BDAMATCH  >  10 ORV-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZEROADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)END-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-IF.2000-U-INSERTAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-TEL-BDAMATCH.
REMARK* INPUT = TEL-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
REMARK********************************************************************IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0MOVE TEL-INPUT-BDAMATCH TO
NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TO
SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE I-CTA-BDAMATCH     TO
CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)ADD 1 TO I-TEL-BDAMATCHEND-IF.2000-U-INSERTAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-NOM-BDAMATCH.
REMARK* INPUT = NOM-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-NOM-BDAMATCH < LIM-BDAMATCH ANDNOM-INPUT-BDAMATCH <> SPACESMOVE NOM-INPUT-BDAMATCH  TONOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
NOM-LIMPI-BDAMATCHMOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCHNRO-VECES-2-BDAMATCHPERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1UNTIL  NRO-VECES-1-BDAMATCH  >  60IF NRO-VECES-1-BDAMATCH  >  1 ANDNOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCHEND-IF
IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "COMPUTE  NRO-VECES-2-BDAMATCH =
60 - NRO-VECES-1-BDAMATCHMOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.2000-U-INSERTAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-DIR-BDAMATCH.
REMARK* INPUT = DIR-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
REMARK* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
REMARK* LA DIRECCION CONTENGA ALGUN NUMERO
REMARK********************************************************************MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.MOVE 1 TO I-BDAMATCHMOVE 0 TO J-BDAMATCHMOVE " " TO CAR-ANT-BDAMATCHINITIALIZE T-CARTOT-BDAMATCH
CARTOT     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10CAV0002IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERICMOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCHIF CAR-ANT-BDAMATCH   NUMERICCOMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)= V-CARTOT-BDAMATCH  (J-BDAMATCH)* 10 + CAR-ACT-BDAMATCHELSE
ADD 1 TO J-BDAMATCH
MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)TO V-CARTOT-BDAMATCH  (J-BDAMATCH)END-IF
END-IF
MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCHADD 1 TO I-BDAMATCHEND-PERFORM.
SORT V-CARTOT-BDAMATCH   DESCENDING.IF T-CARTOT-BDAMATCH   NOT = ZEROS ANDI-DIR-BDAMATCH < LIM-BDAMATCHMOVE T-CARTOT-BDAMATCH TO
NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TOSUS-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1UNTIL  POSIC-SUMA-BDAMATCH  >  10 ORV-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZEROADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)END-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-IF.2000-U-INSERTAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-TEL-BDAMATCH.
REMARK* INPUT = TEL-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
REMARK********************************************************************IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0MOVE TEL-INPUT-BDAMATCH TO
NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TO
SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE I-CTA-BDAMATCH     TO
CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)ADD 1 TO I-TEL-BDAMATCHEND-IF.2000-U-INSERTAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-NOM-BDAMATCH.
REMARK* INPUT = NOM-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-NOM-BDAMATCH < LIM-BDAMATCH ANDNOM-INPUT-BDAMATCH <> SPACESMOVE NOM-INPUT-BDAMATCH  TONOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
NOM-LIMPI-BDAMATCHMOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCHNRO-VECES-2-BDAMATCHPERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1UNTIL  NRO-VECES-1-BDAMATCH  >  60IF NRO-VECES-1-BDAMATCH  >  1 ANDNOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCHEND-IF
IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "COMPUTE  NRO-VECES-2-BDAMATCH =
60 - NRO-VECES-1-BDAMATCHMOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH) = SPACESMOVE  85TO  NRO-VECES-1-BDAMATCHEND-IF
END-IF
END-PERFORM
INSPECT NOM-LIMPI-BDAMATCH
TALLYINGPESO-CTAS-TOT-BDAMATCHFOR CHARACTERS BEFORE INITIAL " "MOVE  PESO-CTAS-TOT-BDAMATCH TOLNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
FUEN01IF FUENTE-REG-BDACSV >= 02RMB0004
FUEN01MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)RMB0004
FUEN01END-IFRMB0004MOVE  SUSC-CTAS-BDAMATCH TO
SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCHEND-IF.2000-U-INSERTAR-CTA-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-CTA-BDAMATCH.
REMARK* INPUT = CTA-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-CTA-BDAMATCH < LIM-BDAMATCH ANDCTA-INPUT-BDAMATCH <> SPACESADD 1 TO I-CTA-BDAMATCHMOVE CTA-INPUT-BDAMATCH TOCTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
VIGE01MOVE FALLECIDO-BDAMATCH TORMB0003
VIGE01CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)RMB0003
FUEN01IF FUENTE-REG-BDACSV >= 2RMB0004
FUEN01MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)RMB0004
FUEN01END-IFRMB0004END-IF.
3000-U-ORDENAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-DIR-BDAMATCH.
REMARK* INPUT = TABLA DE DIRECCIONES LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
REMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTOREMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-DIR-BDAMATCH
DESCENDING NUM-DIR-BDAMATCHASCENDING  CTA-DIR-BDAMATCH.MOVE 1 TO I-CTA-BDAMATCH.MOVE 0 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-DIR-ANT-BDAMATCHMOVE ALL "9"TO NUM-DIR-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0IF NUM-DIR-ANT-BDAMATCH <>
NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE  I-CTA-BDAMATCHTO  POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-DIR-ANT-BDAMATCH <>CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-DIR-ANT-BDAMATCHMOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-DIR-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.
REMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
REMARK* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH) = SPACESMOVE  85TO  NRO-VECES-1-BDAMATCHEND-IF
END-IF
END-PERFORM
INSPECT NOM-LIMPI-BDAMATCH
TALLYINGPESO-CTAS-TOT-BDAMATCHFOR CHARACTERS BEFORE INITIAL " "MOVE  PESO-CTAS-TOT-BDAMATCH TOLNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
FUEN01IF FUENTE-REG-BDACSV >= 02RMB0004
FUEN01MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)RMB0004
FUEN01END-IFRMB0004MOVE  SUSC-CTAS-BDAMATCH TO
SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCHEND-IF.2000-U-INSERTAR-CTA-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-CTA-BDAMATCH.
REMARK* INPUT = CTA-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-CTA-BDAMATCH < LIM-BDAMATCH ANDCTA-INPUT-BDAMATCH <> SPACESADD 1 TO I-CTA-BDAMATCHMOVE CTA-INPUT-BDAMATCH TOCTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
VIGE01MOVE FALLECIDO-BDAMATCH TORMB0003
VIGE01CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)RMB0003
FUEN01IF FUENTE-REG-BDACSV >= 2RMB0004
FUEN01MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)RMB0004
FUEN01END-IFRMB0004END-IF.
3000-U-ORDENAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-DIR-BDAMATCH.
REMARK* INPUT = TABLA DE DIRECCIONES LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
REMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTOREMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-DIR-BDAMATCH
DESCENDING NUM-DIR-BDAMATCHASCENDING  CTA-DIR-BDAMATCH.MOVE 1 TO I-CTA-BDAMATCH.MOVE 0 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-DIR-ANT-BDAMATCHMOVE ALL "9"TO NUM-DIR-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0IF NUM-DIR-ANT-BDAMATCH <>
NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE  I-CTA-BDAMATCHTO  POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-DIR-ANT-BDAMATCH <>CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-DIR-ANT-BDAMATCHMOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-DIR-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.
REMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
REMARK* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-TEL-BDAMATCH
DESCENDING NUM-TEL-BDAMATCHASCENDING  CTA-TEL-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-TEL-ANT-BDAMATCHMOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0OR  FIL-FUE-BDAMATCH > LIM-BDAMATCHOR  COL-FUE-BDAMATCH > LIM-BDAMATCHIF NUM-TEL-ANT-BDAMATCH <>NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-TEL-ANT-BDAMATCH <>CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-TEL-ANT-BDAMATCHMOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-TEL-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-NOM-BDAMATCH.
REMARK* INPUT = TABLA DE NOMBRES     LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
REMARK* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-NOM-BDAMATCH.MOVE 1 TO GRU-NOM-BDAMATCH.MOVE GRU-NOM-BDAMATCH TOGRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).MOVE GRU-NOM-BDAMATCH TOGRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TOSUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TOSUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCH.PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0MOVE 1 TO I-GRU-BDAMATCHMOVE 0 TO MATCH-OK-OUT-VALNOMPERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCHOR MATCH-OK-OUT-VALNOM = 1MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOMBRE-INPUT-VALNOMMOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TONOMBOK-INPUT-VALNOM
VLNIT1IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3RMB0004
VLNIT1IF NUM-IDE-INPUT-BDAMATCH >= 600000000 ANDRMB0004
VLNIT1NUM-IDE-INPUT-BDAMATCH <= 999999999RMB0004
VLNIT1MOVE 2 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 1 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1ELSERMB0004
VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1END-IFRMB0004
VLNIT1ELSERMB0004
VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1END-IFRMB0004
APEL01IF NOMBRE-INPUT-VALNOM(43:3) = ".-," ORRMB0004
APEL01NOMBOK-INPUT-VALNOM(43:3) = ".-,"RMB0004
APEL01MOVE 1 TO BLOQUES-INPUT-VALNOMRMB0004
APEL01END-IFRMB0004PERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1MOVE I-GRU-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCH
APEL01IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDORMB0004
APEL01MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
APEL01END-IFRMB0004PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1
ADD   1  TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
PESO01MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TORMB0004
PESO01NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)RMB0004END-IF
END-IF
ADD 1 TO I-GRU-BDAMATCHEND-PERFORM
IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPOADD 1 TO GRU-NOM-BDAMATCHMOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLMMOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1   TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))ADD   1   TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ELSE*>MOVE GRU-NOM-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLMEND-IF
ADD 1 TO I-NOM-BDAMATCHEND-PERFORM.
SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING GRU-NOMS-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-NOM-ANT-BDAMATCHMOVE ALL "9"TO GRU-NOM-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0OR FIL-FUE-BDAMATCH > LIM-BDAMATCHOR COL-FUE-BDAMATCH > LIM-BDAMATCHIF GRU-NOM-ANT-BDAMATCH <>GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-NOM-ANT-BDAMATCH <>CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
END-IF
MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCTA-NOM-ANT-BDAMATCHMOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TOGRU-NOM-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.4000-U-INTERELACIONAR-BDAMATCH.
REMARK********************************************************************
REMARK*4000-U-INTERELACIONAR-BDAMATCH.
REMARK* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
REMARK* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
REMARK* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************
PESO01*    PERFORM 1110-MOSTRAR-MATRIZ1RMB0004MOVE 1 TO MOVIDO-BDAMATCH    .PERFORM UNTIL MOVIDO-BDAMATCH = 0MOVE 0 TO MOVIDO-BDAMATCHMOVE 1 TO FIL-BUS-BDAMATCHPERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCHMOVE 1 TO COL-BUS-BDAMATCHPERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCHIF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)> 0
MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)TO BUSCADO-BDAMATCH
PERFORM 4100-BUSCAR-RELACION-BDAMATCHELSE
MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHEND-IF
ADD 1 TO COL-BUS-BDAMATCHEND-PERFORM
ADD 1 TO FIL-BUS-BDAMATCHEND-PERFORMEND-PERFORM.4100-BUSCAR-RELACION-BDAMATCH.
REMARK********************************************************************
REMARK*4100-BUSCAR-RELACION-BDAMATCH.
REMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
REMARK********************************************************************MOVE 1 TO FIL-FUE-BDAMATCH.PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHIF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH <= 2000
PERFORM 4110-MOVER-RELACIONES-BDAMATCHEND-IF
END-IFEND-IF
END-IF
ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.4110-MOVER-RELACIONES-BDAMATCH.
REMARK********************************************************************
REMARK*4110-MOVER-RELACIONES-BDAMATCH.
REMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
REMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
REMARK********************************************************************MOVE 0 TO FIN-FUENTE-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING LIBRE-BUSCADO-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4ADD 1 TO LIBRE-BUSCADO-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCH.PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCHMOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TOPORINSERTAR-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH > 2000MOVE PORINSERTAR-BDAMATCH TOCAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)ADD 1 TO LIBRE-BUSCADO-BDAMATCHMOVE 1 TO MOVIDO-BDAMATCHEND-IF
ADD 1 TO COL-FUE-BDAMATCHEND-PERFORM.
INITIALIZE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK********************************************************************
REMARK*5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
REMARK* PORTAFOLIO QUE TIENE MAS CUENTAS
REMARK********************************************************************MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.REMARK********************************************************************MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.MOVE 0 TO MAXREL-PER-BDAMATCHMOVE 0 TO FIN-FUENTE-BDAMATCH.MOVE 1 TO FIL-FUE-BDAMATCH.MOVE 0 TO  PESOS-CTRL-BDAMATCHPERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4MOVE 0 TO PESO-CTAS-TOT-BDAMATCHMOVE 1 TO POSIC-SUMA-BDAMATCH
PESO01MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHRMB0004
PESO01MOVE 0 TO  POSIC-SUSC-BDAMATCHRMB0004
PESO01MOVE 0 TO ENT-FIN-PORT-BDAMATCHRMB0004
PESO01MOVE 0 TO ENT-UNICAS-PORT-BDAMATCHRMB0004PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCHMOVE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)TO  CTA-A-BUSCAR-BDAMATCH
PESO01IF CTA-A-BUSCAR-BDAMATCH > 0RMB0004
PESO01MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
PESO01TO SUSC-CTAS-BDAMATCHRMB0004
AJUS01MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
AJUS01TO I2-BDAMATCHRMB0005
PESO01PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCHRMB0004
PESO01PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCHRMB0004
PESO01PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCHRMB0004
PESO01END-IFRMB0004ADD 4 TO  POSIC-SUMA-BDAMATCHEND-PERFORM
PESO01PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCHRMB0004ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.
PESO01 5100-CALCULAR-PESO-DIR-BDAMATCH.RMB0004
PESO01     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1RMB0004
PESO01UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH ORRMB0004
PESO01CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROSRMB0004
PESO01IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
PESO01=  CTA-A-BUSCAR-BDAMATCH     RMB0004
PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH  =RMB0004
PESO01PESO-CTAS-TOT-BDAMATCH +RMB0004
PESO01(NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *RMB0004
PESO01PESO-DIR-BDAMATCH )RMB0004
PESO01END-IFRMB0004
PESO01     END-PERFORM.RMB0004
PESO01 5200-CALCULAR-PESO-TEL-BDAMATCH.RMB0004PESO01     END-PERFORM.RMB0004
PESO01 5200-CALCULAR-PESO-TEL-BDAMATCH.RMB0004
PESO01     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1RMB0004
PESO01UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH ORRMB0004
PESO01CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROSRMB0004
PESO01IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
PESO01=  CTA-A-BUSCAR-BDAMATCH    RMB0004
PESO01COMPUTE  PESO-CTAS-TOT-BDAMATCH  =RMB0004
PESO01PESO-CTAS-TOT-BDAMATCH +RMB0004
PESO01(NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *RMB0004
PESO01PESO-TEL-BDAMATCH )RMB0004
PESO01END-IFRMB0004
PESO01     END-PERFORM.RMB0004
PESO01 5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004
REMARK******************************************************************
PESO01*5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004
REMARK* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
REMARK* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
REMARK******************************************************************
PESO01     SET IND-DIR-BDAMATCH TO 1.RMB0004
PESO01     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT ENDRMB0004
PESO01MOVE 1 TO  INV-BDAMATCHRMB0004
PESO01WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =RMB0004
PESO01SUSC-CTAS-BDAMATCHRMB0004
PESO01MOVE 0 TO  INV-BDAMATCHRMB0004
PESO01     END-SEARCH.RMB0004
PESO01     IF INV-BDAMATCH  =  1RMB0004
PESO01AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCHRMB0004
PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
PESO01+ PESO-NOM-BDAMATCHRMB0004
PESO01ADD   1TO  POSIC-SUSC-BDAMATCHRMB0004
PESO01MOVE SUSC-CTAS-BDAMATCH  TORMB0004
PESO01COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)RMB0004
AJUS01*MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCHRMB0005
AJUS01IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100RMB0005
AJUS01IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2RMB0005
AJUS01ADD 1 TO ENT-FIN-PORT-BDAMATCHRMB0005
AJUS01END-IFRMB0005
AJUS01END-IFRMB0005
PESO01ADD 1 TO ENT-UNICAS-PORT-BDAMATCHRMB0004
PESO01     END-IF.RMB0004
PESO01     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1RMB0004
PESO01ADD 1000 TO PESO-CTAS-TOT-BDAMATCHRMB0004
PESO01     END-IF.RMB0004
PESO01 5400-DEDUCIR-MEJ-PORT-BDAMATCH.RMB0004
PESO01     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCHRMB0004
PESO01MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCHRMB0004
PESO01     END-IFRMB0004
PESO01     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCHRMB0004PESO01     END-IFRMB0004
PESO01     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCHRMB0004
PESO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
PESO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
PESO01MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
PESO01     ELSERMB0004
PESO01IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCHRMB0004
MEJO01PERFORM 5410-DESEMPATAR-BDAMATCHRMB0004
PESO01END-IFRMB0004
PESO01     END-IF.RMB0004
MEJO01 5410-DESEMPATAR-BDAMATCH.RMB0004
MEJO01IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
MEJO01ELSERMB0004
MEJO01IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
MEJO01IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 ANDRMB0004
MEJO01NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
MEJO01".-,"RMB0004
MEJO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TORMB0004
MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01ELSERMB0004
MEJO01IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >RMB0004
MEJO01LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
MEJO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TORMB0004
MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01END-IFRMB0004
MEJO01END-IFRMB0004
MEJO01END-IF.RMB0004
5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK*********************************************************************
REMARK*5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
REMARK* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
REMARK*********************************************************************MOVE 0 TO VALCTA-OUTPUT-BDAMATCHMOVE 1 TO I-BDAMATCH.IF MEJOR-PORTAFOLIO-BDAMATCH > 0PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORVALCTA-OUTPUT-BDAMATCH = 1 ORCAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)TO J-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHTO J-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHMOVE 1 TO VALCTA-OUTPUT-BDAMATCHEND-IF
ADD 1 TO I-BDAMATCHEND-PERFORMEND-IF.
*
6000-U-MEJOR-DIR-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-DIR-BDAMATCH.
REMARK*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
REMARK*********************************************************************SORT T-DIR-BDAMATCH
DESCENDING  NUM-CTAS-DIR-BDAMATCHDESCENDINGLNG-DIR-BDAMATCHDESCENDINGNUM-DIR-BDAMATCHDESCENDINGCTA-DIR-BDAMATCH.MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.6000-U-MEJOR-TEL-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-TEL-BDAMATCH.
REMARK*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
REMARK*********************************************************************SORT T-TEL-BDAMATCH
DESCENDING  NUM-CTAS-TEL-BDAMATCHDESCENDINGNUM-TEL-BDAMATCHDESCENDINGCTA-TEL-BDAMATCH.MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
*
6000-U-MEJOR-NOM-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-NOM-BDAMATCH.
REMARK*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
REMARK*********************************************************************SORT T-GRUNOM-BDAMATCH
DESCENDING  NUM-CTAS-GRUNOM-BDAMATCHDESCENDING  LNG-GRUNOM-BDAMATCHDESCENDING  NOM-GRUNOM-BDAMATCH.MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCHOR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCHOR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCHOR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,NRO-VECES-1-BDAMATCH) = 0OR ESTA-CTA-BDAMATCH  =  1IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
NRO-VECES-1-BDAMATCH)MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TOPOSIC-SUS-GRU-BDAMATCHMOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TONOM-OUTPUT-BDAMATCHMOVE 1 TO  ESTA-CTA-BDAMATCHEND-IF
END-PERFORM
END-IF
END-PERFORM
END-PERFORM.
*
9000-U-REALIZAR-BDAMATCH.
REMARK******************************************************************
REMARK*9000-U-REALIZAR-BDAMATCH.
REMARK* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL
REMARK* MEJOR NOMBRE
REMARK******************************************************************MOVE  ZEROSTO  POSIC-SUSC-BDAMATCHMOVE  ALL "9"TO  TABLA-SUSC-DIR-BDAMATCHPERFORM 3000-U-ORDENAR-DIR-BDAMATCHPERFORM 3000-U-ORDENAR-TEL-BDAMATCHPERFORM 3000-U-ORDENAR-NOM-BDAMATCHPERFORM 4000-U-INTERELACIONAR-BDAMATCHPERFORM 6000-U-MEJOR-DIR-BDAMATCH.PERFORM 6000-U-MEJOR-TEL-BDAMATCH.PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.PERFORM 6000-U-MEJOR-NOM-BDAMATCH.
*
9010-U-VER-FALLECIDO-BDAMATCH.
REMARK*********************************************************************
REMARK*9010-U-VER-FALLECIDO-BDAMATCH.
REMARK* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL
REMARK* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.
REMARK*********************************************************************
VIGE01     MOVE 1 TO I-BDAMATCH.RMB0003
VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003
VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003
VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003
VIGE01VALCTA-OUTPUT-BDAMATCH = 1 ORRMB0003
VIGE01CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
VIGE01MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
VIGE01TO J-BDAMATCHRMB0003
VIGE01ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCHRMB0003
VIGE01IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1RMB0003
VIGE01ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCHRMB0003
VIGE01END-IFRMB0003
VIGE01ADD 1 TO I-BDAMATCHRMB0003
VIGE01END-PERFORMRMB0003
VIGE01     END-IF.RMB0003
VIGE01*RMB0003
400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.
IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROCBDAMATCH.PROC
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1201 fewer lines

:r LEEMAESTROS.PROC"LEEMAESTROS.PROC" 403 lines, 22152 characters REMARK* LEEMAESTROS.PROC.v.0004
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
REMARK* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
REMARK* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
REMARK******************************************************************
REMARK* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
REMARK* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
REMARK* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
REMARK** GISTRO*
REMARK** NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
REMARK**CITA EL PROGRAMA, EL DEFAULT ES 48
REAMRK******************************************************************
REMARK* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
REMARK* G. JIMENEZ*BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
REMARK* AGOST/2009*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**CARTERA*
REAMRK******************************************************************
REMARK* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
REMARK* G. JIMENEZ*DE BLOQUEO 7 Y 8*
REMARK* OCTUB/2011*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**EL MAESTRO DE CARTERA*
REAMRK******************************************************************
      $SET CONSTANT HACERMATCH"NO"
      $SET CONSTANT AMNISTIA21"NO"

MATCH1$IF HACERMATCH = "SI"
MATCH1$DISPLAY "........COMPILANDO LEEMAESTROS CON MATCH **********
MATCH1$ELSE
MATCH1$DISPLAY "........COMPILANDO LEEMAESTROS SIN MATCH **********
MATCH1$END
REMARK* LEEMAESTROS.PROC.v.0004
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
REMARK* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
REMARK* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
REMARK******************************************************************
REMARK* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
REMARK* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
REMARK* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
REMARK** GISTRO*
REMARK** NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
REMARK**CITA EL PROGRAMA, EL DEFAULT ES 48
REAMRK******************************************************************
REMARK* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
REMARK* G. JIMENEZ*BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
REMARK* AGOST/2009*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**CARTERA*
REAMRK******************************************************************
REMARK* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
REMARK* G. JIMENEZ*DE BLOQUEO 7 Y 8*
REMARK* OCTUB/2011*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**EL MAESTRO DE CARTERA*
REAMRK******************************************************************
$SET CONSTANT HACERMATCH"NO"
$SET CONSTANT AMNISTIA21"NO"

MATCH1$IF HACERMATCH = "SI"
MATCH1$DISPLAY "........COMPILANDO LEEMAESTROS CON MATCH **********
MATCH1$ELSE
MATCH1$DISPLAY "........COMPILANDO LEEMAESTROS SIN MATCH **********
MATCH1$END

MATCH1$IF AMNISTIA21 = "SI"
MATCH1$DISPLAY "........COMPILANDO LEEMAESTROS CON AMNISTIA *******
MATCH1$ELSE
MATCH1$DISPLAY "...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
MATCH1$END

COPY BDAMATCH.PROC.
COPY AMNISTIA21.PROC.
COPY VALNOM.PROC.0500-ASIGNA-ID-ICMCRE-START.
REMARK******************************************************************
REMARK*0500-ASIGNA-ID-ICMCRE-START.
REMARK******************************************************************MOVE TIPO-ID-ABD07 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD07  TO NRO-ID-LEEMSTRS.0600-ASIGNA-ID-ICMCHK-START.0500-ASIGNA-ID-ICMCRE-START.
REMARK******************************************************************
REMARK*0500-ASIGNA-ID-ICMCRE-START.
REMARK******************************************************************MOVE TIPO-ID-ABD07 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD07  TO NRO-ID-LEEMSTRS.0600-ASIGNA-ID-ICMCHK-START.
REMARK******************************************************************
REMARK*0600-ASIGNA-ID-ICMCHK-START.
REMARK******************************************************************MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"
IF AMNISTIA21-LEEMSTRS = 1PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002
LEY002END-IFGJC0002
$END
IF SW-AMNIST21 = 1
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002
LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*ELSEGJC0002
LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*END-IFGJC0002END-IF
ELSE
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD07-BDAMATCHIF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD07-BDAMATCHEND-IF
END-IF
END-IF

END-IF
NOV048IF SW-NOV-48-LEEMSTRS = 0  *>GJC0002
NOV048MOVE ZEROS TO VECTOR-HIS-3-ABD07GJC0002
NOV048VECTOR-HIS-4-ABD07GJC0002
NOV048MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21GJC0002
NOV048MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21GJC0002
NOV048MOVE ZEROS TO VECTOR-3-CTA-AMNIST21GJC0002
NOV048MOVE ZEROS TO VECTOR-4-CTA-AMNIST21GJC0002
NOV048     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TOGJC0002
NOV048MOR-EST-CTA-AMNIST21GJC0002
NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002
NOV048END-IFGJC0002END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00032000-LEE-ICMCRE-DINAMICO.
REMARK******************************************************************
REMARK*2000-LEE-ICMCRE-DINAMICO.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
REMARK*    DEL ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"
IF AMNISTIA21-LEEMSTRS = 1PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002
LEY002END-IFGJC0002
$END
IF SW-AMNIST21 = 1
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002
LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*ELSEGJC0002
LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*END-IFGJC0002END-IF
ELSE
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1IF IDE-TIPO-BDAMATCH = 1IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD07-BDAMATCHEND-IF
END-IF
END-IF
NOV048IF SW-NOV-48-LEEMSTRS = 0GJC0002
NOV048MOVE ZEROS TO VECTOR-HIS-3-ABD07GJC0002
NOV048VECTOR-HIS-4-ABD07GJC0002
NOV048MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21GJC0002
NOV048MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21GJC0002
NOV048MOVE ZEROS TO VECTOR-3-CTA-AMNIST21GJC0002
NOV048MOVE ZEROS TO VECTOR-4-CTA-AMNIST21GJC0002
NOV048     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TOGJC0002
NOV048MOR-EST-CTA-AMNIST21GJC0002
NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002
NOV048END-IFGJC0002END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00033000-LEE-ICMCHK-SECUENCIAL.
REMARK******************************************************************
REMARK*3000-LEE-ICMCHK-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCHK EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CHECK NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
CAVSIF (TIPO-ID-ABD06 = TIPO-ID-LEEMSTRS AND
CAVSNUM-ID-ABD06  = NRO-ID-LEEMSTRS) OR
CAVS(TIPO-ID-LEEMSTRS = ZEROS AND
CAVSNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD06 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCHMOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD06-BDAMATCHEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD06 = 010050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD06GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003ADD 0 TO SW-LECTURA-MAESTROSEND-IF
END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00034000-LEE-ICMCHK-DINAMICO.
REMARK******************************************************************
REMARK*4000-LEE-ICMCHK-DINAMICO.
REMARK*    LEEE MAESTRO ICMCHK EN FORMA DIMANICA Y VALIDA EL INVALID KEY
REMARK*    DEL ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CHECK IGNORE LOCK INVALID KEYMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCH
NEWBL1IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD06 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCHPERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD06-BDAMATCHEND-IF
END-IF
END-IF
$END
ADD 0 TO SW-LECTURA-MAESTROS
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD06 = 010050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD06GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00037000-GUARDAR-REG-INICIALES.
REMARK******************************************************************
REMARK*7000-GUARDAR-REGISTROS-INICIALES.
REMARK*    GUARDA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES DE
REMARK*    EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
REMARK******************************************************************MOVE SPACES TO REG-ICMCRE-LEEMSTRS REG-ICMCHK-LEEMSTRSREG-ICBSUS-LEEMSTRS REG-ICBDIR-LEEMSTRSMOVE COMPLETO-ABD07  TO REG-ICMCRE-LEEMSTRSMOVE COMPLETO-ABD06  TO REG-ICMCHK-LEEMSTRSMOVE REG-SUSCRIPTOR  TO REG-ICBSUS-LEEMSTRSMOVE REG-DIRECCTO REG-ICBDIR-LEEMSTRS.8000-RECUPERAR-REG-INICIALES.
REMARK******************************************************************
REMARK*8000-RECUPERA-REGISTROS-INICIALES.
REMARK*    RECUPERA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES
REMARK*    DE EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
REMARK******************************************************************IF COMPLETO-ABD07  <> REG-ICMCRE-LEEMSTRS ANDREG-ICMCRE-LEEMSTRS <> SPACESMOVE REG-ICMCRE-LEEMSTRS TO COMPLETO-ABD07START MAESTRO-CREDIT KEY = LLAVE-MAES-CREDITNOT INVALID KEYSTART MAESTRO-CREDIT KEY = LLAVE-MAES-CREDITNOT INVALID KEY
READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF
IF COMPLETO-ABD06  <> REG-ICMCHK-LEEMSTRS ANDREG-ICMCHK-LEEMSTRS <> SPACESMOVE REG-ICMCHK-LEEMSTRS TO COMPLETO-ABD06START MAESTRO-CHECK  KEY = LLAVE-MAES-CHECKNOT INVALID KEY
READ MAESTRO-CHECK NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF
IF REG-SUSCRIPTOR  <> REG-ICBSUS-LEEMSTRS ANDREG-ICBSUS-LEEMSTRS <> SPACESMOVE REG-ICBSUS-LEEMSTRS TO REG-SUSCRIPTORSTART SUSCRIPTOR KEY = LLAVE-SUSCRIPNOT INVALID KEY
READ SUSCRIPTOR NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF
IF REG-DIRECC<> REG-ICBDIR-LEEMSTRS ANDREG-ICBDIR-LEEMSTRS <> SPACESMOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECCSTART MAESTRO-DIRECC KEY = LLAVE-DIRECCNOT INVALID KEY
READ MAESTRO-DIRECC NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF.
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
~
~
~
~
~
~
~
~
~BDAMATCH.PROC
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
403 fewer lines

:r BDAMATCH.PROC"BDAMATCH.PROC" 1201 lines, 77406 characters * OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*/hacer-matchAddress search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern/hHACER-MATCHAddress search hit BOTTOM without matching patternOPEN MODE
OPEN MODE
OPEN MODE
OPEN MODE
OPEN MODE:r BDAMATCH.WS"BDAMATCH.WS" 212 lines, 14407 characters REMARK*BDAMATCH-WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS      
ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
**
RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE 
        *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO
*******************************************************************
RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
R-MARTINEZ. *          DEL PORTAFOLIO .                          *
 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  
       APEL01 - INCLUIR PRIMER APELLIDO EN MATCH    *
            * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *
*******************************************************************
NOMB01 01 VARIABLES-MAQ.                                                RMB0003
NOMB01     03 I-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 J-MAQ            PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.RMB0003
NOMB01     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.   RMB0003
NOMB01     03 NOMBRE-OUTMAQ-OKPIC X(45)  VALUE SPACES.RMB0003
NOMB01     03 NOMBRE-INPMAQ-X.                                          RMB0003
NOMB01 04 FILLER          PIC X(02)  VALUE "A ".           RMB0003
NOMB01 04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.RMB0003
NOMB01     03 PARTICULAS-INPMAQ.                                        RMB0003
NOMB01        04 BASURA-INPMAQ            PIC X(45).                    RMB0003
NOMB01        04 P1-INPMAQ                PIC X(45).  RMB0003/Address search hit BOTTOM without matching pattern/hacer-matchAddress search hit BOTTOM without matching pattern/i-maq/HACERMATCH-LEEMSTRSAddress search hit BOTTOM without matching pattern?Address search hit TOP without matching patternREMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.
IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
OPEN MODE


!grep -l HACERMATCH-LEEMSTRS *.WSLEEMAESTROS-PRU.WS
LEEMAESTROS.WS
LEEMAESTROSLEY.WS
LEEMAESTROSNEW.WS
LEEMAESTROSRMB.WS4 more lines




OPEN MODE

:r LEEMAESTROS.WS"LEEMAESTROS.WS" 39 lines, 2340 characters AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC



LEEMAESTROS-PRU.WS
LEEMAESTROS.WS
LEEMAESTROSLEY.WS
LEEMAESTROSNEW.WS
LEEMAESTROSRMB.WS



REMARK*LEEMAESTROS.WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
REMARK* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
REMARK* AMNISTIA (AMNISTIA21.WS).
REMARK********************************************************************
REMARK* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
REMARK* G.JIMENEZ  *ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
REMARK* MAY 18/2009**
REMARK**********************************************************************
REMARK* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
REMARK* G.JIMENEZ  *BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
REMARK* AGO 25/2009*NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
REMARK**PES,ETC) SI LAS DEBEN TENER EN CUENTA*
REMARK**********************************************************************
XXXXXX COPY BDAMATCH.WS.
COPY AMNISTIA21.WS.
COPY VALNOM.WS.
COPY DIRECC.WS.


REMARK********************************************************************
REMARK* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
REMARK* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
01  HACERMATCH-LEEMSTRSPIC 9(01)  VALUE 1.
01  AMNISTIA21-LEEMSTRSPIC 9(01)  VALUE 1."qqq" [Modified] line 1455 of 1493 --97%-- REMARK*LEEMAESTROS.WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
REMARK* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
REMARK* AMNISTIA (AMNISTIA21.WS).
REMARK********************************************************************
REMARK* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
REMARK* G.JIMENEZ  *ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
REMARK* MAY 18/2009**
REMARK**********************************************************************
REMARK* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
REMARK* G.JIMENEZ  *BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
REMARK* AGO 25/2009*NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
REMARK**PES,ETC) SI LAS DEBEN TENER EN CUENTA*
REMARK**********************************************************************
XXXXXX COPY BDAMATCH.WS.
COPY AMNISTIA21.WS.
COPY VALNOM.WS.
COPY DIRECC.WS.


REMARK********************************************************************
REMARK* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
REMARK* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
01  HACERMATCH-LEEMSTRSPIC 9(01)  VALUE 1.
01  AMNISTIA21-LEEMSTRSPIC 9(01)  VALUE 1.
REMARK********************************************************************
01  SW-LECTURA-MAESTROSPIC 9(01)  VALUE ZEROS.
01  TIP-IDE-ANT-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NUM-IDE-ANT-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  REG-ICMCRE-LEEMSTRSPIC X(220) VALUE SPACES.
01  REG-ICMCHK-LEEMSTRSPIC X(94)  VALUE SPACES.
01  REG-ICBSUS-LEEMSTRSPIC X(200) VALUE SPACES.
01  REG-ICBDIR-LEEMSTRSPIC X(483) VALUE SPACES.
01  TIPO-ID-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NRO-ID-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  SW-FCHGRACIA-LEEMSTRSPIC 9(01)  VALUE ZEROS.
LEY001 01  SW-NOV-48-LEEMSTRSPIC 9(01)  VALUE 1.GJC0002
BBVA01 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003
~
~
~
~
~
~
~
~
~
~
OPEN MODE

:r LEEMAESTROS.PROC"LEEMAESTROS.PROC" 403 lines, 22152 characters 

REMARK********************************************************************
REMARK* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
REMARK* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
01  HACERMATCH-LEEMSTRSPIC 9(01)  VALUE 1.
01  AMNISTIA21-LEEMSTRSPIC 9(01)  VALUE 1.
REMARK********************************************************************
01  SW-LECTURA-MAESTROSPIC 9(01)  VALUE ZEROS.
01  TIP-IDE-ANT-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NUM-IDE-ANT-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  REG-ICMCRE-LEEMSTRSPIC X(220) VALUE SPACES.
01  REG-ICMCHK-LEEMSTRSPIC X(94)  VALUE SPACES.
01  REG-ICBSUS-LEEMSTRSPIC X(200) VALUE SPACES.
01  REG-ICBDIR-LEEMSTRSPIC X(483) VALUE SPACES.
01  TIPO-ID-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NRO-ID-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  SW-FCHGRACIA-LEEMSTRSPIC 9(01)  VALUE ZEROS.
LEY001 01  SW-NOV-48-LEEMSTRSPIC 9(01)  VALUE 1.GJC0002
BBVA01 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003



REMARK* LEEMAESTROS.PROC.v.0004
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
REMARK* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
REMARK* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
REMARK******************************************************************
REMARK* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
REMARK* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
REMARK* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
REMARK** GISTRO*
REMARK** NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
REMARK**CITA EL PROGRAMA, EL DEFAULT ES 48
REAMRK******************************************************************
REMARK* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
REMARK* G. JIMENEZ*BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
REMARK* AGOST/2009*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**CARTERA*
REAMRK******************************************************************
REMARK* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
REMARK* G. JIMENEZ*DE BLOQUEO 7 Y 8*
REMARK* OCTUB/2011*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**EL MAESTRO DE CARTERA*
REAMRK******************************************************************
$SET CONSTANT HACERMATCH"NO"
$SET CONSTANT AMNISTIA21"NO"

MATCH1$IF HACERMATCH = "SI"~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
403 lines deleted
REMARK* LEEMAESTROS.PROC.v.0004
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
REMARK* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
REMARK* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
REMARK******************************************************************
REMARK* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
REMARK* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
REMARK* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
REMARK** GISTRO*
REMARK** NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
REMARK**CITA EL PROGRAMA, EL DEFAULT ES 48
REAMRK******************************************************************
REMARK* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
REMARK* G. JIMENEZ*BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
REMARK* AGOST/2009*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**CARTERA*
REAMRK******************************************************************
REMARK* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
REMARK* G. JIMENEZ*DE BLOQUEO 7 Y 8*
REMARK* OCTUB/2011*TANTO PARA CUENTAS CORRIENTES COMO PARA     *
REMARK**EL MAESTRO DE CARTERA*
REAMRK******************************************************************
      $SET CONSTANT HACERMATCH"NO"
      $SET CONSTANT AMNISTIA21"NO"

MATCH1$IF HACERMATCH = "SI"
403 more lines/MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"?REMARK********************************************************************
REMARK* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
REMARK* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
REMARK* AMNISTIA (AMNISTIA21.WS).
REMARK********************************************************************
REMARK* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
REMARK* G.JIMENEZ  *ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
REMARK* MAY 18/2009**
REMARK**********************************************************************
REMARK* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
REMARK* G.JIMENEZ  *BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
REMARK* AGO 25/2009*NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
REMARK**PES,ETC) SI LAS DEBEN TENER EN CUENTA*
REMARK**********************************************************************
XXXXXX COPY BDAMATCH.WS.
COPY AMNISTIA21.WS.
COPY VALNOM.WS.
COPY DIRECC.WS.


REMARK********************************************************************
REMARK* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
REMARK* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
01  HACERMATCH-LEEMSTRSPIC 9(01)  VALUE 1.
01  AMNISTIA21-LEEMSTRSPIC 9(01)  VALUE 1.
REMARK********************************************************************
01  SW-LECTURA-MAESTROSPIC 9(01)  VALUE ZEROS.
01  TIP-IDE-ANT-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NUM-IDE-ANT-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  REG-ICMCRE-LEEMSTRSPIC X(220) VALUE SPACES.
01  REG-ICMCHK-LEEMSTRSPIC X(94)  VALUE SPACES.
01  REG-ICBSUS-LEEMSTRSPIC X(200) VALUE SPACES.
01  REG-ICBDIR-LEEMSTRSPIC X(483) VALUE SPACES.
01  TIPO-ID-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NRO-ID-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  SW-FCHGRACIA-LEEMSTRSPIC 9(01)  VALUE ZEROS.
LEY001 01  SW-NOV-48-LEEMSTRSPIC 9(01)  VALUE 1.GJC0002
BBVA01 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003



REMARK* LEEMAESTROS.PROC.v.0004
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
REMARK* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
REMARK* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
REMARK******************************************************************
REMARK* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
REMARK* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
REMARK* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*/MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"/IF AMNISTIA21-LEEMSTRS = 1
PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002

LEY002END-IFGJC0002


LEY002END-IFGJC0002



LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002




LEY002END-IFGJC0002$ENDIF SW-AMNIST21 = 1LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002LEY002END-IFGJC0002LEY002END-IFGJC0002LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002LEY002*ELSEGJC0002LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002LEY002*END-IFGJC0002END-IFELSEIF IDE-TIPO-BDAMATCH = 1IF HACERMATCH-LEEMSTRS = 1PERFORM 8000-U-VER-CTAABD07-BDAMATCHEND-IFEND-IFEND-IFEND-IFNOV048IF SW-NOV-48-LEEMSTRS = 0  *>GJC0002NOV048MOVE ZEROS TO VECTOR-HIS-3-ABD07GJC0002NOV048VECTOR-HIS-4-ABD07GJC0002NOV048MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21GJC0002NOV048MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21GJC0002NOV048MOVE ZEROS TO VECTOR-3-CTA-AMNIST21GJC0002NOV048MOVE ZEROS TO VECTOR-4-CTA-AMNIST21GJC0002NOV048     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TOGJC0002NOV048MOR-EST-CTA-AMNIST21GJC0002NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002///NOV048MOVE ZEROS TO VECTOR-3-CTA-AMNIST21GJC0002
NOV048MOVE ZEROS TO VECTOR-4-CTA-AMNIST21GJC0002
NOV048     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TOGJC0002
NOV048MOR-EST-CTA-AMNIST21GJC0002
NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002
NOV048END-IFGJC0002END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00032000-LEE-ICMCRE-DINAMICO.
REMARK******************************************************************
REMARK*2000-LEE-ICMCRE-DINAMICO.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
REMARK*    DEL ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"?NOV048MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21GJC0002NOV048MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21GJC0002NOV048VECTOR-HIS-4-ABD07GJC0002NOV048MOVE ZEROS TO VECTOR-HIS-3-ABD07GJC0002NOV048IF SW-NOV-48-LEEMSTRS = 0  *>GJC0002END-IFEND-IFEND-IFEND-IFPERFORM 8000-U-VER-CTAABD07-BDAMATCHIF HACERMATCH-LEEMSTRS = 1?IF IDE-TIPO-BDAMATCH = 1ELSEEND-IFLEY002*END-IFGJC0002LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002LEY002*ELSEGJC0002LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002LEY002END-IFGJC0002LEY002END-IFGJC0002LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002?LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002IF SW-AMNIST21 = 1$ENDLEY002END-IFGJC0002LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002LEY002END-IFGJC0002LEY002END-IFGJC0002LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002?MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"?REMARK********************************************************************
REMARK* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
REMARK* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
REMARK* AMNISTIA (AMNISTIA21.WS).
REMARK********************************************************************
REMARK* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
REMARK* G.JIMENEZ  *ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
REMARK* MAY 18/2009**
REMARK**********************************************************************
REMARK* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
REMARK* G.JIMENEZ  *BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
REMARK* AGO 25/2009*NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
REMARK**PES,ETC) SI LAS DEBEN TENER EN CUENTA*
REMARK**********************************************************************
XXXXXX COPY BDAMATCH.WS.
COPY AMNISTIA21.WS.
COPY VALNOM.WS.
COPY DIRECC.WS.


REMARK********************************************************************
REMARK* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
REMARK* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
01  HACERMATCH-LEEMSTRSPIC 9(01)  VALUE 1.
01  AMNISTIA21-LEEMSTRSPIC 9(01)  VALUE 1.
REMARK********************************************************************
01  SW-LECTURA-MAESTROSPIC 9(01)  VALUE ZEROS.
01  TIP-IDE-ANT-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NUM-IDE-ANT-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  REG-ICMCRE-LEEMSTRSPIC X(220) VALUE SPACES.
01  REG-ICMCHK-LEEMSTRSPIC X(94)  VALUE SPACES.
01  REG-ICBSUS-LEEMSTRSPIC X(200) VALUE SPACES.
01  REG-ICBDIR-LEEMSTRSPIC X(483) VALUE SPACES.
01  TIPO-ID-LEEMSTRSPIC 9(01)  VALUE ZEROS.
01  NRO-ID-LEEMSTRSPIC 9(11)  VALUE ZEROS.
01  SW-FCHGRACIA-LEEMSTRSPIC 9(01)  VALUE ZEROS.
LEY001 01  SW-NOV-48-LEEMSTRSPIC 9(01)  VALUE 1.GJC0002
BBVA01 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003



REMARK* LEEMAESTROS.PROC.v.0004
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
REMARK* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
REMARK* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
REMARK******************************************************************
REMARK* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
REMARK* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
REMARK* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*?Address search hit TOP without matching pattern/MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRSMOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"/IF AMNISTIA21-LEEMSTRS = 1
PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"
IF AMNISTIA21-LEEMSTRS = 1PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002
LEY002END-IFGJC0002
$END
IF SW-AMNIST21 = 1
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002
LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*ELSEGJC0002
LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*END-IFGJC0002END-IF
ELSE
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD07-BDAMATCHEND-IF
END-IF
END-IF
//




/NOV048MOVE ZEROS TO VECTOR-3-CTA-AMNIST21GJC0002
NOV048MOVE ZEROS TO VECTOR-4-CTA-AMNIST21GJC0002
NOV048     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TOGJC0002
NOV048MOR-EST-CTA-AMNIST21GJC0002
NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002
NOV048END-IFGJC0002END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00032000-LEE-ICMCRE-DINAMICO.
REMARK******************************************************************
REMARK*2000-LEE-ICMCRE-DINAMICO.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
REMARK*    DEL ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"/IF AMNISTIA21-LEEMSTRS = 1
PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
/LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002
LEY002END-IFGJC0002
$END
IF SW-AMNIST21 = 1
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
/LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002
LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*ELSEGJC0002
LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*END-IFGJC0002
END-IF
ELSE
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
/NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002
NOV048END-IFGJC0002END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00033000-LEE-ICMCHK-SECUENCIAL.
REMARK******************************************************************
REMARK*3000-LEE-ICMCHK-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCHK EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CHECK NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
CAVSIF (TIPO-ID-ABD06 = TIPO-ID-LEEMSTRS AND
CAVSNUM-ID-ABD06  = NRO-ID-LEEMSTRS) OR
CAVS(TIPO-ID-LEEMSTRS = ZEROS AND
CAVSNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD06 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD06-BDAMATCHEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD06 = 010050GJC0003//BBVA01IF COD-SUS-ABD06 = 010050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD06GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003ADD 0 TO SW-LECTURA-MAESTROSEND-IF
END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00034000-LEE-ICMCHK-DINAMICO.
REMARK******************************************************************
REMARK*4000-LEE-ICMCHK-DINAMICO.
REMARK*    LEEE MAESTRO ICMCHK EN FORMA DIMANICA Y VALIDA EL INVALID KEY
REMARK*    DEL ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CHECK IGNORE LOCK INVALID KEYMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCH
NEWBL1IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD06 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
IF IDE-TIPO-BDAMATCH = 1
IF HACERMATCH-LEEMSTRS = 1
PERFORM 8000-U-VER-CTAABD06-BDAMATCHEND-IF
END-IF
END-IF
$END
ADD 0 TO SW-LECTURA-MAESTROS
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003//Address search hit BOTTOM without matching patternSTART MAESTRO-CHECK  KEY = LLAVE-MAES-CHECKNOT INVALID KEY
READ MAESTRO-CHECK NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF
IF REG-SUSCRIPTOR  <> REG-ICBSUS-LEEMSTRS ANDREG-ICBSUS-LEEMSTRS <> SPACESMOVE REG-ICBSUS-LEEMSTRS TO REG-SUSCRIPTORSTART SUSCRIPTOR KEY = LLAVE-SUSCRIPNOT INVALID KEY
READ SUSCRIPTOR NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF
IF REG-DIRECC<> REG-ICBDIR-LEEMSTRS ANDREG-ICBDIR-LEEMSTRS <> SPACESMOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECCSTART MAESTRO-DIRECC KEY = LLAVE-DIRECCNOT INVALID KEY
READ MAESTRO-DIRECC NEXT RECORD IGNORE LOCKEND-READ
END-START
END-IF.
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC



LEEMAESTROS-PRU.WS
LEEMAESTROS.WS
LEEMAESTROSLEY.WS
LEEMAESTROSNEW.WS
LEEMAESTROSRMB.WS



REMARK*LEEMAESTROS.WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
REMARK* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
REMARK* AMNISTIA (AMNISTIA21.WS).
REMARK********************************************************************
REMARK* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
REMARK* G.JIMENEZ  *ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
REMARK* MAY 18/2009**
REMARK**********************************************************************
REMARK* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
REMARK* G.JIMENEZ  *BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
REMARK* AGO 25/2009*NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
REMARK**PES,ETC) SI LAS DEBEN TENER EN CUENTA*
REMARK**********************************************************************
XXXXXX COPY BDAMATCH.WS.
COPY AMNISTIA21.WS.
COPY VALNOM.WS.
COPY DIRECC.WS.


REMARK********************************************************************
REMARK* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
REMARK* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
01  HACERMATCH-LEEMSTRSPIC 9(01)  VALUE 1.
01  AMNISTIA21-LEEMSTRSPIC 9(01)  VALUE 1./ide-tipo-bdamatch1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"
IF AMNISTIA21-LEEMSTRS = 1PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENESBDAMATCH.PROC
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC


REMARK*BDAMATCH-WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS
REMARK* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE
REMARK**MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO
REMARK********************************************************************
REMARK* RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *
REMARK********************************************************************
NOMB01 01 VARIABLES-MAQ.RMB0003
NOMB01     03 I-MAQPIC 9(03)  VALUE 0.RMB0003
NOMB01     03 J-MAQPIC 9(03)  VALUE 0.RMB0003
NOMB01     03 SW-BORRAR-MAQPIC 9(03)  VALUE 0.RMB0003
NOMB01     03 NOMBRE-INPMAQ-ORIPIC X(45)  VALUE SPACES.RMB0003
NOMB01     03 NOMBRE-OUTMAQ-OKPIC X(45)  VALUE SPACES.RMB0003
NOMB01     03 NOMBRE-INPMAQ-X.RMB0003
NOMB0104 FILLERPIC X(02)  VALUE "A ".RMB0003
NOMB0104 NOMBRE-INPMAQPIC X(45)  VALUE SPACES.RMB0003
NOMB01     03 PARTICULAS-INPMAQ.RMB0003
NOMB0104 BASURA-INPMAQPIC X(45).RMB0003
NOMB0104 P1-INPMAQPIC X(45).RMB0003/02  COD-CTA-AUX11-BDAMATCH    PIC 9(02).02  NUM-CTA-AUX11-BDAMATCH    PIC X(18).
01 LLAVE-AUX13-BDAMATCH.02  TIPO-ID-AUX13-BDAMATCH    PIC 9(01).02  NUM-ID-AUX13-BDAMATCH     PIC 9(13).02  COD-SUS-AUX13-BDAMATCH    PIC 9(06).02  COD-CTA-AUX13-BDAMATCH    PIC 9(02).02  NUM-CTA-AUX13-BDAMATCH    PIC X(18).
01 VARIABLES-BDAMATCH.
PESO01    02 I2-BDAMATCHPIC 9(2).RMB0003
PESO01    02 TIPCTA-BDAMATCH.RMB0003
PESO01*******2=CK,1=CR,2=BS,3=CC,4=OT,9=INVALIDORMB0003
PESO0103 FILLER PIC X(30) VALUE "211422244444224442444433442444".RMB0003
PESO0103 FILLER PIC X(30) VALUE "444444444444444444442999999999".RMB0003
PESO0103 FILLER PIC X(30) VALUE "999999999999999999999999999999".RMB0003
PESO0103 FILLER PIC X(10) VALUE "9999999999".RMB0003
PESO01    02 FILLER REDEFINES TIPCTA-BDAMATCH.RMB0003
PESO0103 V-TIPCTA-BDAMATCH  OCCURS 100 TIMES PIC 9.RMB0003
PESO01    02 APELLIDO-INPUT-BDAMATCH    PIC X(60) VALUE SPACES.RMB0003
PESO01    02 ENT-FIN-PORT-BDAMATCHPIC 9(3)  VALUE 0.RMB0003
PESO01    02 ENT-UNICAS-PORT-BDAMATCH   PIC 9(3)  VALUE 0.RMB0003
PESO01    02 ENT-FIN-MEJ-PORT-BDAMATCH  PIC 9(3)  VALUE 0.RMB0003
VIGE01    02 FALLECIDO-BDAMATCHPIC 9(01) VALUE 0.RMB000202 IDE-TIPO-BDAMATCHPIC 9(01) VALUE 0.02 ABIERTO-BDAMATCHPIC 9(01) VALUE 0.02 PROCESAR-BDAMATCHPIC 9(01) VALUE 0.02 FIN-BDAMATCHPIC 9(01) VALUE 0.02 NUM-IDE-INPUT-BDAMATCH     PIC 9(11).02 TIP-IDE-INPUT-BDAMATCH     PIC 9(01).02 I-GRU-BDAMATCHPIC 9(5) VALUE 0.02 GRU-NOM-BDAMATCHPIC 9(5) VALUE 0.02 MOVIDO-BDAMATCHPIC 9(1) VALUE 0.02 BUSCADO-D-BDAMATCH.03 BUSCADO-BDAMATCHPIC 9(3) VALUE 0.03 FILLERPIC X(1) VALUE " ".02 PORINSERTAR-D-BDAMATCH.03 PORINSERTAR-BDAMATCH    PIC 9(03) VALUE 0.03 FILLERPIC X(1) VALUE " ".02 EXISTE-BDAMATCHPIC 9(05) VALUE 0.02 MEJOR-PORTAFOLIO-BDAMATCH  PIC 9(05) VALUE 0.02 GRU-ANT-BDAMATCHPIC 9(05) VALUE 0.02 MAX-CUENTAS-BDAMATCHPIC 9(05) VALUE 5.02 MAX-REL-BDAMATCHPIC 9(05) VALUE 5.02 MAXREL-PER-BDAMATCHPIC 9(05) VALUE 0.02 FIN-FUENTE-BDAMATCHPIC 9(05) VALUE 0.02 FIL-BUS-BDAMATCHPIC 9(05) VALUE 0.02 COL-BUS-BDAMATCHPIC 9(05) VALUE 0.02 FIN-BUSCADO-BDAMATCHPIC 9(05) VALUE 0.02 LIBRE-BUSCADO-BDAMATCH     PIC 9(05) VALUE 0./REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHEND-IF.
INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVINVALID KEY
MOVE 1 TO FIN-BDAMATCHNOT INVALID KEY
READ BDACSV IGNORE LOCK NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READEND-START.
PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
NUM-IDE-INPUT-BDAMATCH  OR
TIPO-ID-BDACSV  NOT =
TIP-IDE-INPUT-BDAMATCH/MOVE 1 TO FIN-BDAMATCHEND-READ
LIMI01IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
LIMI01MOVE 1 TO FIN-BDAMATCH*> SE ABLIGA A TIPRMB0004
LIMI01MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y   RMB0004
LIMI01MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
LIMI01END-IFRMB0004END-PERFORM.
IF MAX-CUENTAS-BDAMATCH > 0
APEL01IF APELLIDO-INPUT-BDAMATCH <> SPACES ANDRMB0004
APEL01MAX-CUENTAS-BDAMATCH > 1RMB0004
APEL01PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004
APEL01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
APEL01PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004
APEL01END-IFRMB0004PERFORM 9000-U-REALIZAR-BDAMATCH
NOMB01IF NOM-OUTPUT-BDAMATCH <> SPACES ANDRMB0004
NOMB01(TIP-IDE-INPUT-BDAMATCH = 1 OR 4)RMB0004
NOMB01MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004
NOMB01PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004
NOMB01MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004
NOMB01END-IFRMB0004IF NOM-OUTPUT-BDAMATCH <> SPACESMOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF.
NOMB01 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004
NOMB01     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
NOMB01     MOVE 0 TO I-MAQRMB0004
NOMB01     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
NOMB01INITIAL "Y/O"RMB0004
NOMB01OR"Y\O"RMB0004
NOMB01OR" Y/OTRO "RMB0004
NOMB01OR" Y/OTRA "RMB0004
NOMB01OR" Y\OTRO "RMB0004
NOMB01OR" Y\OTRA "RMB0004
NOMB01OR" Y OTRO "RMB0004
NOMB01OR" Y OTRA "RMB0004
NOMB01     IF I-MAQ < 45 AND I-MAQ > 2RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01     ELSERMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)RMB0004
NOMB01END-IFRMB0004
NOMB01     END-IFRMB0004
NOMB01     MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01     MOVE 1 TO I-MAQ.RMB0004/IF DIRLAB-DIRECC NOT = SPACESMOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELLAB-DIRECC > 0 ANDTELLAB-DIRECC < 9999999999MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIUCOR-DIRECC NOT = SPACES ANDDIRCOR-DIRECC NOT = SPACESMOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF.8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9MOVE 0 TO IND-BLOQUEO-ABD07END-IF
END-IF.8000-U-VER-CTAABD06-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD06-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9MOVE 0 TO IND-BLOQUEO-ABD06END-IF
END-IF.

REMARK*======================================================================
1000-U-INICIALIZAR-BDAMATCH.
REMARK********************************************************************//1000-LEE-ICMCRE-SECUENCIAL.
REMARK******************************************************************
REMARK*1000-LEE-ICMCRE-SECUENCIAL.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
REMARK*    ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR O FIN ARCHIVO
REMARK* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
REMARK* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT ENDMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS ANDNUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR(TIPO-ID-LEEMSTRS = ZEROS ANDNRO-ID-LEEMSTRS  = ZEROS)
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"
IF AMNISTIA21-LEEMSTRS = 1PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES/REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
/LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002PERFORM 200900-APLICAR-ART13-REGISTROGJC0002
LEY002END-IFGJC0002
$END
IF SW-AMNIST21 = 1
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
/LEY002IF HACERMATCH-LEEMSTRS = 1GJC0002
LEY002PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002
LEY002END-IFGJC0002
LEY002END-IFGJC0002
LEY002IF AMNISTIA21-LEEMSTRS = 1GJC0002
LEY002PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*ELSEGJC0002
LEY002*PERFORM 200850-AMNISTIA-REGISTROSGJC0002
LEY002*END-IFGJC0002
END-IF
ELSE
IF IDE-TIPO-BDAMATCH = 1
/NOV048MOR-EST-CTA-AMNIST21GJC0002
NOV048PERFORM 500000-RECONSTRUCCION-HISTORIAGJC0002
NOV048END-IFGJC0002END-IF.
BBVA01     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.GJC00032000-LEE-ICMCRE-DINAMICO.
REMARK******************************************************************
REMARK*2000-LEE-ICMCRE-DINAMICO.
REMARK*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
REMARK*    DEL ARCHIVO:
REMARK*    SW-LECTURA-MAESTROS  0: LECTURA OK
REMARK*1: LECTURA CON ERROR
REMARK******************************************************************MOVE 0 TO SW-LECTURA-MAESTROSREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 1 TO SW-LECTURA-MAESTROSEND-READ
IF SW-LECTURA-MAESTROS = 0
$IF HACERMATCH = "SI"IF HACERMATCH-LEEMSTRS = 1IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS ORNUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRSMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO TIP-IDE-ANT-LEEMSTRSMOVE 0 TO NUM-IDE-ANT-LEEMSTRS
NEWBL1IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  ANDGJC0004
NEWBL1CONSECUTIVO-ABD07 = 01GJC0004PERFORM 7000-GUARDAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCHMOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 8000-RECUPERAR-REG-INICIALESMOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRSMOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRSEND-IF
END-IF
END-IF
$END
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
$IF AMNISTIA21 = "SI"
IF AMNISTIA21-LEEMSTRS = 1PERFORM 200700-AMNISTIA-CLIENTES
REMARK* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES/REMARK* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
BBVA01IF SW-ELIMINA-BBVA-LEEMSTRS = 1GJC0003
BBVA01IF COD-SUS-ABD07 = 020050 OR 030050 ORGJC0003
BBVA01050050 OR 130050GJC0003
BBVA01MOVE 4 TO IND-BLOQUEO-ABD07GJC0003
BBVA01END-IFGJC0003
BBVA01END-IFGJC0003
END-IF
LEY002IF SW-ART13-AMNIST21 = 1GJC0002
LEY002IF IDE-TIPO-BDAMATCH = 1GJC0002
:
"qqq" 1899 lines, 116880 characters /d/iccol/desarrollo/copys>^D
