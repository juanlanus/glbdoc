=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.12 17:45:59 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Thu Jun 12 08:22:32 2014 from 172.16.10.26
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>ls -l *JURA*
-rw-rw-r--   1 icrmbd   icdatacr 1577399 Dec 19 18:57 ICGCONJURAD.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1781276 Dec 19 19:08 ICGCPLJURAD.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun  3 15:20 ICGCPLV258.CBL-JURAD
-rw-rw-r--   1 icdgd    icdatacr   72860 Jun 12 15:42 JURADCAR.CBL
/d/iccol/desarrollo/fuentes>^[[A  /d/iccol/desarrollo/fuentes>ls -l *JURA*            ls -l *JURA*ls -l *JUR* 
-rw-rw-r--   1 icrmbd   icdatacr   17397 Dec 20 18:14 ACTALEJUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr   22016 Dec 20 18:17 ACTALEJUR.int
-rw-rw-r--   1 icjlud   icdatacr   74096 Jun 11 18:30 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   67480 Jun 12 10:35 CARGAJUR.CBL
-rw-rw-r--   1 icjlud   icdatacr  194152 Jun 12 10:33 CARGAJURZZZ.CBL
-rw-rw-r--   1 icvhfd   icdatacr 1383756 Sep  6  2010 ICGCON-JUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1577399 Dec 19 18:57 ICGCONJURAD.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1781276 Dec 19 19:08 ICGCPLJURAD.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun  3 15:20 ICGCPLV258.CBL-JURAD
-rw-rw-r--   1 icdgd    icdatacr   72860 Jun 12 15:42 JURADCAR.CBL
/d/iccol/desarrollo/fuentes>vi 

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~APPEND MODEsdiff -w 170 JURADCAR.CBL CARGAJUR.CBL


!sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL>  sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
 >
 >
      $SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
 IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
 PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
      ************************************************************************************************************************************
      * Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
      * por Jurad* por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.* el archivo ERRS.
      ************************************************************************************************************************************
 AUTHOR.Globant JL.AUTHOR.Globant JL.
 DATE-WRITTEN.DATE-WRITTEN.
 DATE-COMPILED.DATE-COMPILED.
 CONFIGURATION section.CONFIGURATION section.
 SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
 OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
 INPUT-OUTPUT section.INPUT-OUTPUT section.
 FILE-CONTROL.FILE-CONTROL.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 select JURAD assign to P-file-pathselect JURAD assign to P-file-path
 organization is line sequentialorganization is line sequential
 file status is JURAD-fs.file status is JURAD-fs.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-name
 organization is line sequentialorganization is line sequential
 file status is ERRS-fs.file status is ERRS-fs.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIREGI.FS.copy BDIIREGI.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIDIAN.FS.copy BDIIDIAN.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIDAS.FS.copy BDIIDAS.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
1754 more lines/  [|<>]///
************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.<

>01  OPEN-DIRPIC 9 value 0.
>
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).///




/
*01  REG-VALIDAS.|01  REG-VALIDAS. *01  REG-VALIDAS.|01  REG-VALIDAS.*    03 TIP-VALPIC 9.|03 TIP-VALPIC 9.
*    03 CED-VALPIC 9(11).|03 CED-VALPIC 9(11).
*    03 NOM-VALPIC X(45).|03 NOM-VALPIC X(45).
*    03 FEC-EXP-VALPIC 9(08).|03 FEC-EXP-VALPIC 9(08).
*    03 MUN-EXP-VALPIC X(15).|03 MUN-EXP-VALPIC X(15).
*    03 DEP-EXP-VALPIC X(15).|03 DEP-EXP-VALPIC X(15).
*    03 VIG-VALPIC X(02).|03 VIG-VALPIC X(02).
*    03 GENERO-VALPIC X(01).|03 GENERO-VALPIC X(01).
*    03 EDAD-VALPIC X(03).|03 EDAD-VALPIC X(03).
*    03 EDAD-RANGOPIC X(05).|03 EDAD-RANGOPIC X(05).
*    03 FILLER-2-VALPIC X(51).|03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
>01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************/
















//* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.<
  <<*****************************************************************<
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.<
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.*copy LEEMAESTROS.WS.<************************************************************************************************************************************






//*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.////03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente".|"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente".|"Eliminación de alerta que no existe".
>03 pic x(11) value "19 0000000 ".
>03 pic x(59) value
>"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS./////************************************************************************************************************************************PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"<
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"<
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo//



/********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registro
read JURADread JURAD
evaluate JURAD-fsevaluate JURAD-fs
when "00"when "00"
Ddisplay " "<
Ddisplay " "<Ddisplay " "<Ddisplay JURAD-reg<
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
D    display "4000-PROCESAR-REGISTRO-2"<
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos

/
/end-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
D    display "4100-VALIDACION-FORMAL"<
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"
//move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
D    display "4200-VALIDACION-SEMANTICA"<
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
>*    parámetros para las rutinas de validación en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
|*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
|*    switches de opciones de validaciónmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3|if TIP-IDE-BDIIVIDE = 2 or 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE|move 1 to SW-DIGCHEQUEO-BDIIVIDEEND-IF|end-ifMOVE 2 TO NUM-BLOQUES-BDIIVIDE|move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de|*    Valida el número de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe/////////*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"<
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORADD 1 TO NO-COINCIDE-REGIS|elseELSE<
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERRORADD 1 TO NO-COINCIDE-DIAN|end-if.END-IF.<4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
D    display "4222-VALIDA-NOMBRE-COINCIDE"<
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALE/////////start BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEY
move 1 TO SW-BDIIALEmove 1 TO SW-BDIIALE
not invalid keynot invalid key
move 0 to SW-BDIIALEmove 0 to SW-BDIIALE
read BDIIALE next recordread BDIIALE next record
at endat end
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-readend-read
end-startend-start

perform until SW-BDIIALE = 1perform until SW-BDIIALE = 1
or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE
or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003
/if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003
and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD
and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD
and BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
>*encontrado
/move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-ifend-if
if SW-BDIIALE = 0if SW-BDIIALE = 0
read BDIIALE next record at endread BDIIALE next record at end
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-readend-read
end-ifend-if
end-perform.end-perform.

if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1
if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1
move 07 to CODIGO-ERRORmove 07 to CODIGO-ERROR
ADD   1   TO NO-COINCIDE-REGIS<move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORADD   1   TO NO-COINCIDE-REGIS<elseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSelse<add 1 to reg-correctos<end-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
D    display "4240-CONTAR-TIPO-CUENTA"<
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS<ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDO<ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOS<END-IFEND-IFEND-IF.END-IF.

/////4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.D    display "4210-VALIDACION-ID-NO-FIGURA"<************************************************************************************************************************************* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSV


//IF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0
IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédula
MOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERROR
ADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGIS
elseelse
*no es una cédula*no es una cédula
MOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROR
ADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIAN
END-IFEND-IF
END-IF.END-IF.


4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
D    display "4300-MODIFICAR-BDIIALE"<
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************
initialize REG-BDIIALEinitialize REG-BDIIALE

*    si hay demandas*    si hay demandas
if JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zero
or JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zero
move "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandas
move JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentes
move JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminados
string "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultima
delimited size into D-fecha-ultimadelimited size into D-fecha-ultima
perform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOS
end-if.end-if.
*    si hay embargos*    si hay embargos
if JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zero
or JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zero
move "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargos
move JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentes
move JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminados
string "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimo
delimited size into D-fecha-ultimadelimited size into D-fecha-ultima
perform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOS
end-if.end-if.



4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
D    display "4300-MODIFICAR-BDIIALE-DATOS"<
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"
perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM

*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M E
evaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedad
when "I"when "I"
add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OK
perform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-I
when "M"when "M"
add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-M
when "E"when "E"
add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OK
perform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-E
when otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anterior
display "error de logica: tipo-novedad="display "error de logica: tipo-novedad="
JURAD-tipo-novedad " reg num: " N-reg-leidosJURAD-tipo-novedad " reg num: " N-reg-leidos
display "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-reg
perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMA
end-evaluate.end-evaluate.


4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
D    display "4300-MODIFICAR-BDIIALE-I"<
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un error
if EST-BDIIALE = "00"if EST-BDIIALE = "00"
display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores
" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALE
display "Registro de input: "<
display JURAD-reg<
display "Datos en la alerta: " INF-DATAHOST-BDIIALE<
add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraph
end-ifend-if

*    completa los datos del registro*    completa los datos del registro
initialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALE
move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE/4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.D    display "4300-MODIFICAR-BDIIALE-I"<
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
D    display "4300-MODIFICAR-BDIIALE-M"<
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores



add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraphend-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
D    display "4300-MODIFICAR-BDIIALE-E"<
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existe<call "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existeend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
D    display "4333-LEER-BDIIALE-RANDOM"<
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
D    display "4333-GRABAR-BDIIALE"<
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
D    display "4333-REGRABAR-BDIIALE"<4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.D    display "4333-REGRABAR-BDIIALE"<
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
D    display "4333-ELIMINAR-BDIIALE"<
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
D    display "4800-PROCESO-REG-T"<
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorN-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
D    display "4900-GRABAR-ERROR"<
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
D    display "4320-ARMAR-TEXTO-ALERTA"<
****************************************************************<D    display "4320-ARMAR-TEXTO-ALERTA"<****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<move LA-numx(9:12) to LA-valor(2)<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
D    display "1000-RUTINA-INICIAL"<
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINE
D    move "9999991000905140104.txt 2 " to P-command-line<display "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2
* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.gobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.<
D    display "1000-NOT-USED"<
******************************************************************<
* Aunque tengo instrucciones de dejar los textos de alertas en<
* blanco, me parece que se debería cargar, aunque sea de manera<
* precaria, por si justo cae una consulta para uno de los IDs<
* involucrados. La persona que consulta va a ver <spaces>, hasta<
* que se ejecute el programa que genera los textos.<
******************************************************************<
* >>>> esto da un error de compilacion que no puedo resolver<
* >>>> por ahora esta anulado<* >>>> esto da un error de compilacion que no puedo resolver<* >>>> por ahora esta anulado<
******************************************************************<
* Carga de los templates para armar el texto de alertas<
* TODO: por ahora los templates son literales<set LAx to 0<move high-values to LA-templates<perform varying LAm from 1 by 1<until LA-modelo(LAm) = high-values<set LAx up by 1<perform varying LAy from 1 by 1 until LAy > 10<inspect LA-parte(LAx, LAy) replacing trailing<spaces by high-values<inspect LA-parte(LAx, LAy) replacing first<high-value by space<end-perform<end-perform.<
<
<
1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
D    display "1001-ELIMINAR-TODO"<
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
>*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEread BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
D    display "7000-RUTINA-FINAL"<
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* >>>> esto da un error de compilacion que no puedo resolver<* >>>> por ahora esta anulado<
******************************************************************<
* Carga de los templates para armar el texto de alertas<
* TODO: por ahora los templates son literales<set LAx to 0<move high-values to LA-templates<perform varying LAm from 1 by 1<until LA-modelo(LAm) = high-values<set LAx up by 1<perform varying LAy from 1 by 1 until LAy > 10<inspect LA-parte(LAx, LAy) replacing trailing<spaces by high-values<inspect LA-parte(LAx, LAy) replacing first<high-value by space<end-perform<end-perform.<
<
<
1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
D    display "1001-ELIMINAR-TODO"<
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
>*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEread BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
D    display "7000-RUTINA-FINAL"<
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNO
|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"display N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
D    display "9000-CANCELAR-PROGRAMA"<
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
D    display "513-VALIDA-EN-CSV"<
D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E<
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OK
Ddisplay "el num de ID está dentro de su rango"<IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion|*Se recorre toda la estructura bdacsv para la
*buscada. En caso de hallar registros se procede a realizar el    |*identificacion buscada. En caso de hallar
*match|*registros se procede a realizar el match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH<
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH<
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH<
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH<PERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH<
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH<
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH<
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH<
*MOVE 1 TO HACERMATCH-LEEMSTRS<IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM
Ddisplay "10000-MATCH-NOMBRES-VALNOM"<
Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM<
D" " NOM-OUTPUT-BDAMATCH<IF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCHEND-IFEND-IFEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1
*MOVE TIPOID-E TO TIP-VAL|MOVE TIPOID-E TO TIP-VAL
*MOVE NUMID-E TO CED-VAL|MOVE NUMID-E TO CED-VAL
*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA|MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1*MOVE TIPOID-E TO TIP-VAL|MOVE TIPOID-E TO TIP-VAL
*MOVE NUMID-E TO CED-VAL|MOVE NUMID-E TO CED-VAL
*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA|MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
*PERFORM 9800-FILTRAR-ALFABETICO|PERFORM 9800-FILTRAR-ALFABETICO
*MOVE CADENA-SALE TO  NOM-VAL|MOVE CADENA-SALE TO  NOM-VAL
*MOVE ZEROS TO FEC-EXP-VAL|MOVE ZEROS TO FEC-EXP-VAL
*MOVE SPACES TO MUN-EXP-VAL|MOVE SPACES TO MUN-EXP-VAL
*MOVE SPACES TO DEP-EXP-VAL|MOVE SPACES TO DEP-EXP-VAL
*MOVE SPACES TO VIG-VAL|MOVE SPACES TO VIG-VAL
*MOVE SPACES TO GENERO-VAL|MOVE SPACES TO GENERO-VAL
*MOVE SPACES TO EDAD-VAL|MOVE SPACES TO EDAD-VAL
*MOVE SPACES TO EDAD-RANGO|MOVE SPACES TO EDAD-RANGO
*MOVE "A"TO ORIGEN-VAL<ADD 1 TO REG-CORRECTOS<ADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
D    display "9800-FILTRAR-ALFABETICO"<
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.////////////////*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program JURADCAR.|end program CARGAJUR.************************************************************************************************************************************
************************************************************************************************************************************
>/




/


!ls -l JURADCAR*-rw-rw-r--   1 icdgd    icdatacr   72860 Jun 12 15:48 JURADCAR.CBL

!ls -l JURADCAR*

!ls -l JURADCAR*

!ls -l JURADCAR*sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
>  sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
>
>
$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".

************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.<

>01  OPEN-DIRPIC 9 value 0.
>
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).*01  REG-VALIDAS.|01  REG-VALIDAS.
*    03 TIP-VALPIC 9.|03 TIP-VALPIC 9.
*    03 CED-VALPIC 9(11).|03 CED-VALPIC 9(11).
*    03 NOM-VALPIC X(45).|03 NOM-VALPIC X(45).
*    03 FEC-EXP-VALPIC 9(08).|03 FEC-EXP-VALPIC 9(08).
*    03 MUN-EXP-VALPIC X(15).|03 MUN-EXP-VALPIC X(15).
*    03 DEP-EXP-VALPIC X(15).|03 DEP-EXP-VALPIC X(15).
*    03 VIG-VALPIC X(02).|03 VIG-VALPIC X(02).
*    03 GENERO-VALPIC X(01).|03 GENERO-VALPIC X(01).
*    03 EDAD-VALPIC X(03).|03 EDAD-VALPIC X(03).
*    03 EDAD-RANGOPIC X(05).|03 EDAD-RANGOPIC X(05).
*    03 FILLER-2-VALPIC X(51).|03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".



************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.<

>01  OPEN-DIRPIC 9 value 0.
>
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).*01  REG-VALIDAS.|01  REG-VALIDAS.
*    03 TIP-VALPIC 9.|03 TIP-VALPIC 9.
*    03 CED-VALPIC 9(11).|03 CED-VALPIC 9(11).
*    03 NOM-VALPIC X(45).|03 NOM-VALPIC X(45).
*    03 FEC-EXP-VALPIC 9(08).|03 FEC-EXP-VALPIC 9(08).
*    03 MUN-EXP-VALPIC X(15).|03 MUN-EXP-VALPIC X(15).
*    03 DEP-EXP-VALPIC X(15).|03 DEP-EXP-VALPIC X(15).
*    03 VIG-VALPIC X(02).|03 VIG-VALPIC X(02).
*    03 GENERO-VALPIC X(01).|03 GENERO-VALPIC X(01).
*    03 EDAD-VALPIC X(03).|03 EDAD-VALPIC X(03).
*    03 EDAD-RANGOPIC X(05).|03 EDAD-RANGOPIC X(05).
*    03 FILLER-2-VALPIC X(51).|03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
>01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.<
<
*****************************************************************<
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.<
************************************************************************************************************************************<************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente".|"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente".|"Eliminación de alerta que no existe".
>03 pic x(11) value "19 0000000 ".
>03 pic x(59) value
>"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"<
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totales*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"<
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
Ddisplay " "<
Ddisplay " "<
Ddisplay JURAD-reg<
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
D    display "4000-PROCESAR-REGISTRO-2"<
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"<
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totales:g/^      D/dEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1
*MOVE TIPOID-E TO TIP-VAL|MOVE TIPOID-E TO TIP-VAL
*MOVE NUMID-E TO CED-VAL|MOVE NUMID-E TO CED-VAL
*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA|MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
*PERFORM 9800-FILTRAR-ALFABETICO|PERFORM 9800-FILTRAR-ALFABETICO
*MOVE CADENA-SALE TO  NOM-VAL|MOVE CADENA-SALE TO  NOM-VAL
*MOVE ZEROS TO FEC-EXP-VAL|MOVE ZEROS TO FEC-EXP-VAL
*MOVE SPACES TO MUN-EXP-VAL|MOVE SPACES TO MUN-EXP-VAL
*MOVE SPACES TO DEP-EXP-VAL|MOVE SPACES TO DEP-EXP-VAL
*MOVE SPACES TO VIG-VAL|MOVE SPACES TO VIG-VAL
*MOVE SPACES TO GENERO-VAL|MOVE SPACES TO GENERO-VAL
*MOVE SPACES TO EDAD-VAL|MOVE SPACES TO EDAD-VAL
*MOVE SPACES TO EDAD-RANGO|MOVE SPACES TO EDAD-RANGO
*MOVE "A"TO ORIGEN-VAL<ADD 1 TO REG-CORRECTOS<ADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.*    COPY LEEMAESTROS.PROC.<

<
//
45 fewer lines02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacion/Address search hit BOTTOM without matching pattern/Address search hit BOTTOM without matching pattern/   [|><]No file  line 646 of 1711 --37%-- end-ifend-if*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.call "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
>*    parámetros para las rutinas de validación en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
|*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
|*    switches de opciones de validaciónmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3|if TIP-IDE-BDIIVIDE = 2 or 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE|move 1 to SW-DIGCHEQUEO-BDIIVIDEEND-IF|end-ifMOVE 2 TO NUM-BLOQUES-BDIIVIDE|move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de|*    Valida el número de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.

4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORADD 1 TO NO-COINCIDE-REGIS|elseELSE<
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERRORADD 1 TO NO-COINCIDE-DIAN|end-if.END-IF.<4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
>*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0end-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORADD   1   TO NO-COINCIDE-REGIS<elseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSelse<add 1 to reg-correctos<end-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS<ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDO<ELSEELSENo file  line 801 of 1711 --46%-- 








97%-- ************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS<ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDO<ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOS<END-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
>*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORADD   1   TO NO-COINCIDE-REGIS<elseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSelse<add 1 to reg-correctos<end-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS<ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDO<ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOS<END-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE/////*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidosJURAD-tipo-novedad " reg num: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraphend-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existe<call "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existeend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasJURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen othercontinuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<move LA-numx(9:12) to LA-valor(2)<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"evaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.<
******************************************************************<
* Aunque tengo instrucciones de dejar los textos de alertas en<******************************************************************<* Aunque tengo instrucciones de dejar los textos de alertas en<
* blanco, me parece que se debería cargar, aunque sea de manera<
* precaria, por si justo cae una consulta para uno de los IDs<
* involucrados. La persona que consulta va a ver <spaces>, hasta<
* que se ejecute el programa que genera los textos.<
******************************************************************<
* >>>> esto da un error de compilacion que no puedo resolver<
* >>>> por ahora esta anulado<
******************************************************************<
* Carga de los templates para armar el texto de alertas<
* TODO: por ahora los templates son literales<set LAx to 0<move high-values to LA-templates<perform varying LAm from 1 by 1<until LA-modelo(LAm) = high-values<set LAx up by 1<perform varying LAy from 1 by 1 until LAy > 10<inspect LA-parte(LAx, LAy) replacing trailing<spaces by high-values<inspect LA-parte(LAx, LAy) replacing first<high-value by space<end-perform<end-perform.<
<
<
1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
>*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.exit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"******************************************************************<* Aunque tengo instrucciones de dejar los textos de alertas en<
* blanco, me parece que se debería cargar, aunque sea de manera<
* precaria, por si justo cae una consulta para uno de los IDs<
* involucrados. La persona que consulta va a ver <spaces>, hasta<
* que se ejecute el programa que genera los textos.<
******************************************************************<
* >>>> esto da un error de compilacion que no puedo resolver<
* >>>> por ahora esta anulado<
******************************************************************<
* Carga de los templates para armar el texto de alertas<
* TODO: por ahora los templates son literales<set LAx to 0<move high-values to LA-templates<perform varying LAm from 1 by 1<until LA-modelo(LAm) = high-values<set LAx up by 1<perform varying LAy from 1 by 1 until LAy > 10<inspect LA-parte(LAx, LAy) replacing trailing<spaces by high-values<inspect LA-parte(LAx, LAy) replacing first<high-value by space<end-perform<end-perform.<
<
<
1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
>*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.evaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.<
******************************************************************<
* Aunque tengo instrucciones de dejar los textos de alertas en<
* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"evaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.<
******************************************************************<
* Aunque tengo instrucciones de dejar los textos de alertas en<******************************************************************<* Aunque tengo instrucciones de dejar los textos de alertas en<
* blanco, me parece que se debería cargar, aunque sea de manera<
* precaria, por si justo cae una consulta para uno de los IDs<
* involucrados. La persona que consulta va a ver <spaces>, hasta<
* que se ejecute el programa que genera los textos.<
******************************************************************<
* >>>> esto da un error de compilacion que no puedo resolver<
* >>>> por ahora esta anulado<
******************************************************************<
* Carga de los templates para armar el texto de alertas<
* TODO: por ahora los templates son literales<set LAx to 0<move high-values to LA-templates<perform varying LAm from 1 by 1<until LA-modelo(LAm) = high-values<set LAx up by 1<perform varying LAy from 1 by 1 until LAy > 10<inspect LA-parte(LAx, LAy) replacing trailing<spaces by high-values<inspect LA-parte(LAx, LAy) replacing first<high-value by space<end-perform<end-perform.<
<
<
1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
>*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.exit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNO
|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"move N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNO
|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"move N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentroMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion|*Se recorre toda la estructura bdacsv para la
*buscada. En caso de hallar registros se procede a realizar el    |*identificacion buscada. En caso de hallar
*match|*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
*MOVE 1 TO HACERMATCH-LEEMSTRS<IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCHEND-IFEND-IFEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1
*MOVE TIPOID-E TO TIP-VAL|MOVE TIPOID-E TO TIP-VAL
*MOVE NUMID-E TO CED-VAL|MOVE NUMID-E TO CED-VAL
*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA|MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
*PERFORM 9800-FILTRAR-ALFABETICO|PERFORM 9800-FILTRAR-ALFABETICO
*MOVE CADENA-SALE TO  NOM-VAL|MOVE CADENA-SALE TO  NOM-VAL
*MOVE ZEROS TO FEC-EXP-VAL|MOVE ZEROS TO FEC-EXP-VAL
*MOVE SPACES TO MUN-EXP-VAL|MOVE SPACES TO MUN-EXP-VAL
*MOVE SPACES TO DEP-EXP-VAL|MOVE SPACES TO DEP-EXP-VAL
*MOVE SPACES TO VIG-VAL|MOVE SPACES TO VIG-VAL
*MOVE SPACES TO GENERO-VAL|MOVE SPACES TO GENERO-VAL
*MOVE SPACES TO EDAD-VAL|MOVE SPACES TO EDAD-VAL
*MOVE SPACES TO EDAD-RANGO|MOVE SPACES TO EDAD-RANGO
*MOVE "A"TO ORIGEN-VAL<No file  line 1572 of 1711 --91%-- ADD 1 TO REG-CORRECTOS<
ADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSV
END-IFEND-IF
END-IFEND-IF
END-IF.END-IF.

9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************
MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA
INITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-searchdisplay "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program JURADCAR.|end program CARGAJUR.************************************************************************************************************************************
************************************************************************************************************************************
-rw-rw-r--   1 icdgd    icdatacr   72860 Jun 12 15:48 JURADCAR.CBL

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~!ls -l JURADCAR*-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:04 JURADCAR.CBL               display "Error " cod-error " " E-descripcion(Ex)   display "Error " cod-error " " E-descripcion(Ex)!ls -l JURADCAR*-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:04 JURADCAR.CBL
OPEN MODE




!ls -l JURADCAR*-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:04 JURADCAR.CBL
-rw-rw-r--   1 icdgd    icdatacr     792 Jun 12 16:06 JURADCAR.CBL.err




:r JURADCAR.CBL.err"JURADCAR.CBL.err" 8 lines, 792 characters move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program JURADCAR.|end program CARGAJUR.************************************************************************************************************************************
************************************************************************************************************************************
-rw-rw-r--   1 icdgd    icdatacr   72860 Jun 12 15:48 JURADCAR.CBL
-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:04 JURADCAR.CBL
-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:04 JURADCAR.CBL
-rw-rw-r--   1 icdgd    icdatacr     792 Jun 12 16:06 JURADCAR.CBL.err




* Rejected - OPT
  3019ADD 1 TO ESTADO12-BDIIREGI854
*  12-S*************************************(   0)**857
**    Operand ESTADO12-BDIIREGI is not declared857
  3635     DISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGI1470
*  12-S****************************************************************(  53)**1471
**    Operand ESTADO12-BDIIREGI is not declared1471
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/JURADCAR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~~
~
~
~
~
~
~
~8 fewer lines!ls -l JURADCAR*-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:07 JURADCAR.CBL
-rw-rw-r--   1 icdgd    icdatacr     792 Jun 12 16:06 JURADCAR.CBL.err


:r JURADCAR.CBL.err"JURADCAR.CBL.err" 8 lines, 792 characters * Rejected - OPT
  3019ADD 1 TO ESTADO12-BDIIREGI854
*  12-S*************************************(   0)**857
**    Operand ESTADO12-BDIIREGI is not declared857
  3635     DISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGI1470
*  12-S****************************************************************(  53)**1471
**    Operand ESTADO12-BDIIREGI is not declared1471
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/JURADCAR.CBL
~
~
~
~
~
~
~
~
8 fewer lines~
~
~
~
~
~
~
~
~9 lines deletedsdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
>  sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
>
>
$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************>APPEND MODE................................................................................:%s/\(................................................................................\).*//1555 substitutions ~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~................................................................................$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.:%s/\(................................................................................\).*/\11555 substitutions display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program JURADCAR.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~................................................................................$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************:%s/  *$//1553 substitutions display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program JURADCAR.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:w file JURADCARZ.ctrol"JURADCARZ.ctrol" [Not edited] [Modified] line 1705 of 1705 --100%-- :w  JURADCARZ.ctrol"JURADCARZ.ctrol" [New file] 1705 lines, 70439 characters :q/d/iccol/desarrollo/fuentes>vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
OPEN MODE










!grep  JURADCARZ.ctrol  JURADCARZ.ctrol.CBL     Incomplete shell escape command - use 'shell' to get a shell!sdiff -w 170  JURADCARZ.ctrol JURADCAR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.PROGRAM-ID.    JURADCAR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
1766 more lines/  [    ><]  WORKING-STORAGE section.WORKING-STORAGE section.************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".01  pgmpic x(10) value "JURADCAR".************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.*01  W-BLOQUESPIC 9(01) VALUE ZEROS.<
<
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).*01  REG-VALIDAS.*01  REG-VALIDAS.
*    03 TIP-VALPIC 9.*    03 TIP-VALPIC 9.
*    03 CED-VALPIC 9(11).*    03 CED-VALPIC 9(11).
*    03 NOM-VALPIC X(45).*    03 NOM-VALPIC X(45).
*    03 FEC-EXP-VALPIC 9(08).*    03 FEC-EXP-VALPIC 9(08).
*    03 MUN-EXP-VALPIC X(15).*    03 MUN-EXP-VALPIC X(15).
*    03 DEP-EXP-VALPIC X(15).*    03 DEP-EXP-VALPIC X(15).
*    03 VIG-VALPIC X(02).*    03 VIG-VALPIC X(02).
*    03 GENERO-VALPIC X(01).*    03 GENERO-VALPIC X(01).
*    03 EDAD-VALPIC X(03).*    03 EDAD-VALPIC X(03).
*    03 EDAD-RANGOPIC X(05).*    03 EDAD-RANGOPIC X(05).
*    03 FILLER-2-VALPIC X(51).*    03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.//
01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
<<01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
>01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
>01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.*copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres* Variables validacion de nombres
**********************************************************************************************************************************copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo///03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente"."Modificación de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente"."Eliminación de alerta inexistente".
<
<
<
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.///*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
>D    display "0000-PROGRAMA-PRINCIPAL"
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
>D    display "4000-PROCESAR-REGISTRO"
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
>Ddisplay " "
>Ddisplay " "
>Ddisplay JURAD-reg
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
>D    display "4000-PROCESAR-REGISTRO-2"
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datos
*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
>D    display "4100-VALIDACION-FORMAL"
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosend-ifend-if*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
>D    display "4200-VALIDACION-SEMANTICA"
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IFEND-IFMOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
>D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 02 TO CODIGO-ERRORMOVE 02 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSEADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERRORMOVE 01 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANEND-IF.END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
>D    display "4222-VALIDA-NOMBRE-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORif ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGISelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSelseelseadd 1 to reg-correctosadd 1 to reg-correctosend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
>D    display "4240-CONTAR-TIPO-CUENTA"
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS|IF CODIGO-ERROR = 01
>ADD 1 TO NO-COINCIDE-DIAN
>END-IF
>IF CODIGO-ERROR = 02
>ADD 1 TO NO-COINCIDE-REGIS
>END-IF
>IF CODIGO-ERROR = 06
>ADD 1 TO ESTADO21-BDIIREGI
>END-IF
>IF CODIGO-ERROR = 07
>ADD 1 TO ESTADO12-BDIIREGI
>END-IF
>*ADD 1 TO REG-CORRECTOSELSEELSEADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERRORMOVE 01 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANEND-IF.END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
>D    display "4222-VALIDA-NOMBRE-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IFEND-IFMOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
>D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 02 TO CODIGO-ERRORMOVE 02 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSEADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERRORMOVE 01 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANEND-IF.END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
>D    display "4222-VALIDA-NOMBRE-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORif ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGISelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSelseelseadd 1 to reg-correctosadd 1 to reg-correctosend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
>D    display "4240-CONTAR-TIPO-CUENTA"
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS|IF CODIGO-ERROR = 01
>ADD 1 TO NO-COINCIDE-DIAN
>END-IF
>IF CODIGO-ERROR = 02
>ADD 1 TO NO-COINCIDE-REGIS
>END-IF
>IF CODIGO-ERROR = 06
>ADD 1 TO ESTADO21-BDIIREGI
>END-IF
>IF CODIGO-ERROR = 07
>ADD 1 TO ESTADO12-BDIIREGI
>END-IF
>*ADD 1 TO REG-CORRECTOSELSEELSEADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERRORMOVE 01 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANEND-IF.END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
>D    display "4222-VALIDA-NOMBRE-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERROR
ADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGIS
elseelse
if ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERRORmove 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGIS
add 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOS
elseelse
add 1 to reg-correctosadd 1 to reg-correctos
end-ifend-if
end-ifend-if
end-if.end-if.


4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
>D    display "4240-CONTAR-TIPO-CUENTA"
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07
ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6
ADD 1 TO REG-CORRECTOS|IF CODIGO-ERROR = 01
>ADD 1 TO NO-COINCIDE-DIAN
>END-IF
>IF CODIGO-ERROR = 02
>ADD 1 TO NO-COINCIDE-REGIS
>END-IF
>IF CODIGO-ERROR = 06
>ADD 1 TO ESTADO21-BDIIREGI
>END-IF
>IF CODIGO-ERROR = 07
>ADD 1 TO ESTADO12-BDIIREGI
>END-IF
>*ADD 1 TO REG-CORRECTOS
ELSEELSE
IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05
ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7

ADD 1 TO TIPO-ID-INVALIDOADD 1 TO TIPO-ID-INVALIDO


ELSEELSE



*registros correctos, repetidos o no*registros correctos, repetidos o no




ADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOSADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.>D    display "4210-VALIDACION-ID-NO-FIGURA"************************************************************************************************************************************>D    display "4210-VALIDACION-ID-NO-FIGURA"************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
>D    display "4300-MODIFICAR-BDIIALE"
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
>D    display "4300-MODIFICAR-BDIIALE-DATOS"
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidosJURAD-tipo-novedad " reg num: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
>D    display "4300-MODIFICAR-BDIIALE-I"
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "if EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
<end-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
>D    display "4300-MODIFICAR-BDIIALE-M"
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
<
<
<end-ifend-if
<
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
>D    display "4300-MODIFICAR-BDIIALE-E"
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
<
<end-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
>D    display "4333-LEER-BDIIALE-RANDOM"
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
>D    display "4333-GRABAR-BDIIALE"
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
>D    display "4333-REGRABAR-BDIIALE"
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
>D    display "4333-ELIMINAR-BDIIALE"
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
>D    display "4800-PROCESO-REG-T"
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosdisplay "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if<
<
<
<
<
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
<
<
<
<
<
<
<
<
<
<
<if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "elseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
>D    display "4900-GRABAR-ERROR"
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
>D    display "4320-ARMAR-TEXTO-ALERTA"
********************************************************************************************************************************
* Hace el reemplazo de los valores adecuados en los templates* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde* de las linea de alerta que corresponde
********************************************************************************************************************************
*    segun se trate de demandas o embargos*    segun se trate de demandas o embargosif JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-nummove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-nummove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)end-if.end-if.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
>D    display "1000-RUTINA-INICIAL"
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINE
>D    move "9999991000905140104.txt 2 " to P-command-linedisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filename
* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-nummove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-nummove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)end-if.end-if.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
>D    display "1000-RUTINA-INICIAL"
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINE
>D    move "9999991000905140104.txt 2 " to P-command-linedisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filename
* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"evaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
>D    display "1000-NOT-USED"
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se debería cargar, aunque sea de manera* blanco, me parece que se debería cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1perform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
>D    display "1001-ELIMINAR-TODO"
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
<evaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"delete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
>D    display "7000-RUTINA-FINAL"
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNODISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS LEIDOS:" REG-LEIDOS
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
>DISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGI
>DISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDODISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
>D    display "9000-CANCELAR-PROGRAMA"
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
>D    display "513-VALIDA-EN-CSV"
>D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OK
>Ddisplay "el num de ID está dentro de su rango"IF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el*buscada. En caso de hallar registros se procede a realizar el
*match*match
>Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
>D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
>D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
>D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
>Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
>D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
>D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
>D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
*MOVE 1 TO HACERMATCH-LEEMSTRS*MOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM
>Ddisplay "10000-MATCH-NOMBRES-VALNOM"
>Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM
>D" " NOM-OUTPUT-BDAMATCHIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCHEND-IFEND-IFEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1
*MOVE TIPOID-E TO TIP-VAL*MOVE TIPOID-E TO TIP-VAL
*MOVE NUMID-E TO CED-VAL*MOVE NUMID-E TO CED-VAL
*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
*PERFORM 9800-FILTRAR-ALFABETICO*PERFORM 9800-FILTRAR-ALFABETICO
*MOVE CADENA-SALE TO  NOM-VAL*MOVE CADENA-SALE TO  NOM-VAL
*MOVE ZEROS TO FEC-EXP-VAL*MOVE ZEROS TO FEC-EXP-VAL
*MOVE SPACES TO MUN-EXP-VAL*MOVE SPACES TO MUN-EXP-VAL
*MOVE SPACES TO DEP-EXP-VAL*MOVE SPACES TO DEP-EXP-VAL*MOVE SPACES TO MUN-EXP-VAL*MOVE SPACES TO MUN-EXP-VAL*MOVE SPACES TO DEP-EXP-VAL*MOVE SPACES TO DEP-EXP-VAL
*MOVE SPACES TO VIG-VAL*MOVE SPACES TO VIG-VAL
*MOVE SPACES TO GENERO-VAL*MOVE SPACES TO GENERO-VAL
*MOVE SPACES TO EDAD-VAL*MOVE SPACES TO EDAD-VAL
*MOVE SPACES TO EDAD-RANGO*MOVE SPACES TO EDAD-RANGO
*MOVE "A"TO ORIGEN-VAL*MOVE "A"TO ORIGEN-VALADD 1 TO REG-CORRECTOSADD 1 TO REG-CORRECTOSADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
>D    display "9800-FILTRAR-ALFABETICO"
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.*    COPY LEEMAESTROS.PROC.*    COPY LEEMAESTROS.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputdisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program JURADCAR.end program JURADCAR.************************************************************************************************************************************
************************************************************************************************************************************
>



~
~
~
~
~
~
~$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.PROGRAM-ID.    JURADCAR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".01  pgmpic x(10) value "JURADCAR".************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.*01  W-BLOQUESPIC 9(01) VALUE ZEROS.<
<
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).*01  REG-VALIDAS.*01  REG-VALIDAS.
*    03 TIP-VALPIC 9.*    03 TIP-VALPIC 9.
*    03 CED-VALPIC 9(11).*    03 CED-VALPIC 9(11).
*    03 NOM-VALPIC X(45).*    03 NOM-VALPIC X(45).
*    03 FEC-EXP-VALPIC 9(08).*    03 FEC-EXP-VALPIC 9(08).
*    03 MUN-EXP-VALPIC X(15).*    03 MUN-EXP-VALPIC X(15).
*    03 DEP-EXP-VALPIC X(15).*    03 DEP-EXP-VALPIC X(15).
*    03 VIG-VALPIC X(02).*    03 VIG-VALPIC X(02).
*    03 GENERO-VALPIC X(01).*    03 GENERO-VALPIC X(01).
*    03 EDAD-VALPIC X(03).*    03 EDAD-VALPIC X(03).
*    03 EDAD-RANGOPIC X(05).*    03 EDAD-RANGOPIC X(05).
*    03 FILLER-2-VALPIC X(51).*    03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
<
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
>01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
>01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.*copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres* Variables validacion de nombres
**********************************************************************************************************************************copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7).03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente"."Modificación de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente"."Eliminación de alerta inexistente".
<
<
<
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
>D    display "0000-PROGRAMA-PRINCIPAL"
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
>D    display "4000-PROCESAR-REGISTRO"
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
>Ddisplay " "
>Ddisplay " "
>Ddisplay JURAD-reg
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
>D    display "4000-PROCESAR-REGISTRO-2"
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
>D    display "4100-VALIDACION-FORMAL"
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************* Validacion formal de los datos del input* Validacion formal de los datos del input************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numeric*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
>D    display "4200-VALIDACION-SEMANTICA"
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IFEND-IFMOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternadisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
>D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 02 TO CODIGO-ERRORMOVE 02 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE
*no es una cédula*no es una cédulaMOVE 01 TO CODIGO-ERRORMOVE 01 TO CODIGO-ERRORADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANEND-IF.END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
>D    display "4222-VALIDA-NOMBRE-COINCIDE"
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORADD   1   TO NO-COINCIDE-REGISADD   1   TO NO-COINCIDE-REGISelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSelseelseadd 1 to reg-correctosadd 1 to reg-correctosend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
>D    display "4240-CONTAR-TIPO-CUENTA"
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ADD 1 TO REG-CORRECTOS|IF CODIGO-ERROR = 01
>ADD 1 TO NO-COINCIDE-DIAN
>END-IF
>IF CODIGO-ERROR = 02
>ADD 1 TO NO-COINCIDE-REGIS
>END-IF
>IF CODIGO-ERROR = 06
>ADD 1 TO ESTADO21-BDIIREGI
>END-IF
>IF CODIGO-ERROR = 07
>ADD 1 TO ESTADO12-BDIIREGI
>END-IF
>*ADD 1 TO REG-CORRECTOSELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOADD 1 TO TIPO-ID-INVALIDOELSEELSE
*registros correctos, repetidos o no*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOSADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
>D    display "4210-VALIDACION-ID-NO-FIGURA"
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
>D    display "4300-MODIFICAR-BDIIALE"
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
>D    display "4300-MODIFICAR-BDIIALE-DATOS"
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion************************************************************************************************************************************* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidosJURAD-tipo-novedad " reg num: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
>D    display "4300-MODIFICAR-BDIIALE-I"
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
<end-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
>D    display "4300-MODIFICAR-BDIIALE-M"
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
<
<
<end-ifend-if
<
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.

4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
>D    display "4300-MODIFICAR-BDIIALE-E"
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
<
<end-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
>D    display "4333-LEER-BDIIALE-RANDOM"
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriordisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
>D    display "4333-GRABAR-BDIIALE"
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
>D    display "4333-REGRABAR-BDIIALE"
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.end-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
>D    display "4333-ELIMINAR-BDIIALE"
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
>D    display "4800-PROCESO-REG-T"
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if<
<
<
<
<
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
<
<<
<
<
<
<
<
<
<
<
<
<if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAdisplay "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
>D    display "4900-GRABAR-ERROR"
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
>D    display "4320-ARMAR-TEXTO-ALERTA"
********************************************************************************************************************************
* Hace el reemplazo de los valores adecuados en los templates* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde* de las linea de alerta que corresponde
********************************************************************************************************************************
*    segun se trate de demandas o embargos*    segun se trate de demandas o embargosif JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-nummove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-nummove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)end-if.end-if.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
>D    display "1000-RUTINA-INICIAL"
************************************************************************************************************************************$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.PROGRAM-ID.    JURADCAR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************REPLACE 1 CHAReeSEREPLACE 1 CHARd
OPEN MODE el primer día cuando dije que un programa era una porqueríau************************************************************************************************************************************No file  line 1 of 1770 --0%-- :q!/d/iccol/desarrollo/fuentes>vi JURADCAR.CBL
"JURADCAR.CBL" 1734 lines, 73559 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"JURADCAR.CBL" 1734 lines, 73559 characters:wq/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi JURADCAR.CBLvi             vils -l *JUR*
-rw-rw-r--   1 icrmbd   icdatacr   17397 Dec 20 18:14 ACTALEJUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr   22016 Dec 20 18:17 ACTALEJUR.int
-rw-rw-r--   1 icjlud   icdatacr   74096 Jun 11 18:30 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   67480 Jun 12 10:35 CARGAJUR.CBL
-rw-rw-r--   1 icjlud   icdatacr  194152 Jun 12 10:33 CARGAJURZZZ.CBL
-rw-rw-r--   1 icvhfd   icdatacr 1383756 Sep  6  2010 ICGCON-JUR.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1577399 Dec 19 18:57 ICGCONJURAD.CBL
-rw-rw-r--   1 icrmbd   icdatacr 1781276 Dec 19 19:08 ICGCPLJURAD.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun  3 15:20 ICGCPLV258.CBL-JURAD
-rw-rw-r--   1 icdgd    icdatacr   73559 Jun 12 16:07 JURADCAR.CBL
-rw-rw-r--   1 icjlud   icdatacr   70439 Jun 12 16:12 JURADCARZ.ctrol
/d/iccol/desarrollo/fuentes>vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~!sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL>  sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
>
>
$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on record
1770 more lines:qNo write since last change (:quit! overrides):q!/d/iccol/desarrollo/fuentes>vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~!sdiff -w 170 CARGAJUR.CBL JURADCAR.CBLsdiff -w 170 JURADCAR.CBL CARGAJUR.CBL<
<
<
$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.|PROGRAM-ID.    JURADCAR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on record
1765 more lines************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".|01  pgmpic x(10) value "JURADCAR".************************************************************************************************************************************
************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
>*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  OPEN-DIRPIC 9 value 0.<
<
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.|*01  REG-VALIDAS.03 TIP-VALPIC 9.|*    03 TIP-VALPIC 9.03 CED-VALPIC 9(11).|*    03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).|*    03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).|*    03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).|*    03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).|*    03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).|*    03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).|*    03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).|*    03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).|*    03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).|*    03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.<
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
>01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
>01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************
copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************
copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
>*copy LEEMAESTROS.WS.
>
>*****************************************************************
>* Variables validacion de nombres
>*****************************************************************
copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************
copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.>
>
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7) value zero.|03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7) value zero.|03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7) value zero.|03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7) value zero.|03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertaroccurs 10 indexed LAv.occurs 10 indexed LAv.*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta que no existe".|"Modificación de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta que no existe".|"Eliminación de alerta inexistente".03 pic x(11) value "19 0000000 ".<03 pic x(59) value<"Inserción de alerta que ya existe".<
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
>*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
>D    display "0000-PROGRAMA-PRINCIPAL"
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hastaperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
>D    display "4000-PROCESAR-REGISTRO"
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
>Ddisplay " "
>Ddisplay " "
>Ddisplay JURAD-reg
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
>D    display "4000-PROCESAR-REGISTRO-2"
********************************************************************************************************************************/>>       />        D:v//d>D    display "4800-PROCESO-REG-T"
>D    display "4900-GRABAR-ERROR"
>D    display "4320-ARMAR-TEXTO-ALERTA"
>D    display "1000-RUTINA-INICIAL"
>D    move "9999991000905140104.txt 2 " to P-command-line
>D    display "1000-NOT-USED"
>D    display "1001-ELIMINAR-TODO"
>D    display "7000-RUTINA-FINAL"
>D    display "9000-CANCELAR-PROGRAMA"
>D    display "513-VALIDA-EN-CSV"
>D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E
>Ddisplay "el num de ID está dentro de su rango"
>Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
>D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
>D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
>D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
>Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
>D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
>D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
>D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
>Ddisplay "10000-MATCH-NOMBRES-VALNOM"
>Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM
>D" " NOM-OUTPUT-BDAMATCH
>D    display "9800-FILTRAR-ALFABETICO"
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1721 fewer lines>D    display "0000-PROGRAMA-PRINCIPAL"
>D    display "4000-PROCESAR-REGISTRO"
>Ddisplay " "
>Ddisplay " "
>Ddisplay JURAD-reg
>D    display "4000-PROCESAR-REGISTRO-2"
>D    display "4100-VALIDACION-FORMAL"
>D    display "4200-VALIDACION-SEMANTICA"
>D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"
>D    display "4222-VALIDA-NOMBRE-COINCIDE"
>D    display "4240-CONTAR-TIPO-CUENTA"
>D    display "4210-VALIDACION-ID-NO-FIGURA"
>D    display "4300-MODIFICAR-BDIIALE"
>D    display "4300-MODIFICAR-BDIIALE-DATOS"
>D    display "4300-MODIFICAR-BDIIALE-I"
>D    display "4300-MODIFICAR-BDIIALE-M"
>D    display "4300-MODIFICAR-BDIIALE-E"
>D    display "4333-LEER-BDIIALE-RANDOM"
>D    display "4333-GRABAR-BDIIALE"
>D    display "4333-REGRABAR-BDIIALE"
>D    display "4333-ELIMINAR-BDIIALE"
>D    display "4800-PROCESO-REG-T"
>D    display "4900-GRABAR-ERROR"
>D    display "4320-ARMAR-TEXTO-ALERTA"
>D    display "1000-RUTINA-INICIAL"
>D    move "9999991000905140104.txt 2 " to P-command-line
>D    display "1000-NOT-USED"
>D    display "1001-ELIMINAR-TODO"
>D    display "7000-RUTINA-FINAL"
>D    display "9000-CANCELAR-PROGRAMA"
>D    display "513-VALIDA-EN-CSV"
>D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E
>Ddisplay "el num de ID está dentro de su rango"
>Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
>D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
>D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
>D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
>Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
>D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
>D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
>D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
>Ddisplay "10000-MATCH-NOMBRES-VALNOM"
>Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM
>D" " NOM-OUTPUT-BDAMATCH
>D    display "9800-FILTRAR-ALFABETICO"
~
~
~
~
0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
>D    display "0000-PROGRAMA-PRINCIPAL"
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
>D    display "4000-PROCESAR-REGISTRO"
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
>Ddisplay " "
>Ddisplay " "
>Ddisplay JURAD-reg
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
1721 more lines:g//dEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VAL|*MOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VAL|*MOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA|*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICO|*PERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VAL|*MOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VAL|*MOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VAL|*MOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VAL|*MOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VAL|*MOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VAL|*MOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VAL|*MOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGO|*MOVE SPACES TO EDAD-RANGO
>*MOVE "A"TO ORIGEN-VAL
>ADD 1 TO REG-CORRECTOSADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.>*    COPY LEEMAESTROS.PROC.>
//
45 fewer linessdiff -w 170 JURADCAR.CBL CARGAJUR.CBL<
<
<
$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.|PROGRAM-ID.    JURADCAR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on record************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".|01  pgmpic x(10) value "JURADCAR".************************************************************************************************************************************
************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
>*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  OPEN-DIRPIC 9 value 0.<
<
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.|*01  REG-VALIDAS.03 TIP-VALPIC 9.|*    03 TIP-VALPIC 9.03 CED-VALPIC 9(11).|*    03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).|*    03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).|*    03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).|*    03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).|*    03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).|*    03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).|*    03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).|*    03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).|*    03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).|*    03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".|01  pgmpic x(10) value "JURADCAR".************************************************************************************************************************************
************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
>*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  OPEN-DIRPIC 9 value 0.<
<
01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.|*01  REG-VALIDAS.03 TIP-VALPIC 9.|*    03 TIP-VALPIC 9.03 CED-VALPIC 9(11).|*    03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).|*    03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).|*    03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).|*    03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).|*    03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).|*    03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).|*    03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).|*    03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).|*    03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).|*    03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.


 







    





01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.<
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
    



01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
>01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
>01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.

13 lines deleted      ************************************************************************************************************************************




    01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.                                                                                    >     01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************
copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************
copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
>*copy LEEMAESTROS.WS.
>
>*****************************************************************
>* Variables validacion de nombres
>*****************************************************************
copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************
copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.>
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".
6 lines deleted           88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7) value zero.|03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7) value zero.|03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7) value zero.|03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7) value zero.|03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 "."Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta que no existe".|"Modificación de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta que no existe".|"Eliminación de alerta inexistente".03 pic x(11) value "19 0000000 ".<03 pic x(59) value<"Inserción de alerta que ya existe".<*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------
03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".
03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".
03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.
03pic xx.03pic xx.
03pic x(300).03pic x(300).
03pic 9(8).03pic 9(8).
03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.
05 E-codigopic xx.05 E-codigopic xx.
05pic x.05pic x.
05 E-contadorpic 9(7).05 E-contadorpic 9(7).
05pic x.05pic x.
05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B."Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta que no existe".|"Modificación de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta que no existe".|"Eliminación de alerta inexistente".03 pic x(11) value "19 0000000 ".<03 pic x(59) value<"Inserción de alerta que ya existe".<
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
>*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:No file  line 510 of 1693 --30%--       *        esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes*fin del archivo de input:*fin del archivo de input:*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraph*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualización de BDIIALE|*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-ifcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
*    parámetros para las rutinas de validación en BDIIVIDE<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datos|move JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validación|move 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3|IF TIP-IDE-BDIIVIDE = 2 OR 3*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualización de BDIIALE|*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-ifcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
*    parámetros para las rutinas de validación en BDIIVIDE<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datos|move JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validación|move 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3|IF TIP-IDE-BDIIVIDE = 2 OR 34200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
*    parámetros para las rutinas de validación en BDIIVIDE<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datos|move JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validación|move 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3|IF TIP-IDE-BDIIVIDE = 2 OR 3move 1 to SW-DIGCHEQUEO-BDIIVIDE|MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEend-if|END-IFmove 2 to NUM-BLOQUES-BDIIVIDE|MOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el número de identificación contra las bases de|*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************/Address search hit BOTTOM without matching pattern/  [|<>] ///* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideif TIP-IDE-BDIIVIDE = 1|IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulamove 02 to CODIGO-ERROR|MOVE 02 TO CODIGO-ERRORelse|ADD 1 TO NO-COINCIDE-REGIS
>ELSE
*no es una cédula*no es una cédulamove 01 to CODIGO-ERROR|MOVE 01 TO CODIGO-ERRORend-if.|ADD 1 TO NO-COINCIDE-DIAN
>END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor FUENTE-BDIIALE > 990003<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-if
4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor FUENTE-BDIIALE > 990003<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERROR
>ADD   1   TO NO-COINCIDE-REGISelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOS
>else
>add 1 to reg-correctosend-ifend-if
if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERROR
>ADD   1   TO NO-COINCIDE-REGISelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOS
>else
>add 1 to reg-correctosend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6
>IF CODIGO-ERROR = 01
>ADD 1 TO NO-COINCIDE-DIAN
>END-IF
>IF CODIGO-ERROR = 02
>ADD 1 TO NO-COINCIDE-REGIS
>END-IF
>IF CODIGO-ERROR = 06
>ADD 1 TO ESTADO21-BDIIREGI
>END-IF
>IF CODIGO-ERROR = 07
>ADD 1 TO ESTADO12-BDIIREGI
>END-IF
>*ADD 1 TO REG-CORRECTOSELSEELSE
    
    
IF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05
    
    


ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7
>ADD 1 TO TIPO-ID-INVALIDO




4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6
>IF CODIGO-ERROR = 01
>ADD 1 TO NO-COINCIDE-DIAN
>END-IF
>IF CODIGO-ERROR = 02
>ADD 1 TO NO-COINCIDE-REGIS
>END-IF
>IF CODIGO-ERROR = 06
>ADD 1 TO ESTADO21-BDIIREGI
>END-IF
>IF CODIGO-ERROR = 07
>ADD 1 TO ESTADO12-BDIIREGI
>END-IF
>*ADD 1 TO REG-CORRECTOSELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7
>ADD 1 TO TIPO-ID-INVALIDOELSEELSE
*es 00: registros correctos|*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IF
>ADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.

     
    

>IF CODIGO-ERROR = 01                                                                            IF CODIGO-ERROR = 01                                                                                    > IF CODIGO-ERROR = 01
ADD 1 TO NO-COINCIDE-DIAN
END-IF
IF CODIGO-ERROR = 02
ADD 1 TO NO-COINCIDE-REGIS
END-IF
IF CODIGO-ERROR = 06
ADD 1 TO ESTADO21-BDIIREGI
END-IF
IF CODIGO-ERROR = 07
ADD 1 TO ESTADO12-BDIIREGI
END-IF
*ADD 1 TO REG-CORRECTOS************************************************************************************************************************************










>ADD 1 TO REG-CORRECTOS                                                                            ADD 1 TO REG-CORRECTOS/ADD 1 TO TIPO-ID-INVALIDO                                                                                    > ADD 1 TO TIPO-ID-INVALIDOADD 1 TO TIPO-ID-INVALIDOELSEELSE
*es 00: registros correctos|*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zero//*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidosJURAD-tipo-novedad " reg num: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
>* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"call "PONERR" using "19" JURAD-reg E-errores|display "Insercion de alerta nueva que ya existe "display "llave: " LLAVE-BDIIALE|" key: " LLAVE-BDIIALE
>display "Registro de input: "
>display JURAD-reg
>display "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeexit paragraph<end-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove spaces to LINEAS-BDIIALE|perform 4320-ARMAR-TEXTO-ALERTAperform 4333-GRABAR-BDIIALE.|if EST-BDIIALE = "00"
>perform 4333-REGRABAR-BDIIALE
>else
>perform 4333-GRABAR-BDIIALE
>end-if.
>*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
>*    " fs:" EST-BDIIALE./

 4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente>* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un error
if EST-BDIIALE not = "00"if EST-BDIIALE not = "00"
call "PONERR" using "17" JURAD-reg E-errores|display "Modificacion de alerta inexistente "
"llave: " LLAVE-BDIIALE|" key: " LLAVE-BDIIALE
>display "Registro de input: "
>display JURAD-reg
>display "Datos en la alerta: " INF-DATAHOST-BDIIALE
add 1 to N-ale-no-existeadd 1 to N-ale-no-existe
exit paragraph|call "PONERR" using "17" JURAD-reg E-errores
end-ifend-if
<
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valores
move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE
move D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALE
move spaces to LINEAS-BDIIALE|perform 4320-ARMAR-TEXTO-ALERTA
perform 4333-REGRABAR-BDIIALE.|if EST-BDIIALE = "00"
>perform 4333-REGRABAR-BDIIALE
>else
>perform 4333-GRABAR-BDIIALE
>end-if.

/

 >*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
>*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
6 lines deleted




      * Eliminacion de una alerta* Eliminacion de una alerta>* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    elimina el registro*    elimina el registro
if EST-BDIIALE = "00"if EST-BDIIALE = "00"
perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALE
elseelse
call "PONERR" using "18" JURAD-reg E-errores|display "Eliminacion de alerta inexistente "
"llave: " LLAVE-BDIIALE|" key: " LLAVE-BDIIALE
>display "Registro de input: "
>display JURAD-reg
add 1 to N-ale-no-existeadd 1 to N-ale-no-existe
>call "PONERR" using "18" JURAD-reg E-errores
end-if.end-if.
>*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
>*    " fs:" EST-BDIIALE.
 4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.************************************************************************************************************************************* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"************************************************************************************************************************************




move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALE








move 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
6 lines deleted




               continuecontinuewhen "23"when "23"
continuecontinue
when otherwhen other
display "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE
" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALE
display "Ultimo registro procesado: "display "Ultimo registro procesado: "
display JURAD-reg-anteriordisplay JURAD-reg-anterior
perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMA
end-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.


4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-if






write REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALE
when "00"when "00"
add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen other

4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if*    Esta parte está anulada por falta de definición sobre el<
*    formato del registro "T"<exit paragraph.<
<
4800-PROCESO-REG-T-anulado.<*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
if function numval(JURADT-demandas-vigentes)<
= N-demandas-vigentes<
continue<
else<
display " "<
display "No coincide total de demandas vigentes:"<
JURADT-demandas-vigentes " con el calculado:"<
N-demandas-vigentes<
move "SI" to E-hay-error<
end-if<
<
if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)
= N-demandas-terminadas= N-demandas-terminadas
continuecontinueelseelse
display " "display " "
display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"
JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"
N-demandas-terminadasN-demandas-terminadas
move "SI" to E-hay-errormove "SI" to E-hay-error
end-ifend-if

if function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)
= N-embargos-vigentes= N-embargos-vigentes
continuecontinue
elseelse
display " "display " "
display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"
JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if

*    Esta parte está anulada por falta de definición sobre el<
*    formato del registro "T"<
exit paragraph.<d-ifREPLACE 1 CHAR.No file  line 1085 of 1662 --65%-- display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.>4320-ARMAR-TEXTO-ALERTA.
>****************************************************************
>* Hace el reemplazo de los valores adecuados en los templates
>* de las linea de alerta que corresponde
>****************************************************************
>*    segun se trate de demandas o embargos
>if JURAD-demandas-vigentes not = 0
>or JURAD-demandas-terminadas not = 0
>set LAx to 1perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.>4320-ARMAR-TEXTO-ALERTA.
>****************************************************************
>* Hace el reemplazo de los valores adecuados en los templates
>* de las linea de alerta que corresponde
>****************************************************************
>*    segun se trate de demandas o embargos
>if JURAD-demandas-vigentes not = 0
>or JURAD-demandas-terminadas not = 0
>set LAx to 1
>move high-values to LA-valores
>move JURAD-demandas-vigentes to LA-num
>move LA-numx(9:12) to LA-valor(1)
>move JURAD-demandas-terminadas to LA-num
>move LA-numx(9:12) to LA-valor(2)
>end-if.
>
>
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMA








end-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
18 lines deletedOPEN MODE" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.open input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.>1000-NOT-USED.
>******************************************************************
>* Aunque tengo instrucciones de dejar los textos de alertas en
>* blanco, me parece que se debería cargar, aunque sea de manera
>* precaria, por si justo cae una consulta para uno de los IDs
>* involucrados. La persona que consulta va a ver <spaces>, hasta
>* que se ejecute el programa que genera los textos.
>******************************************************************
>* >>>> esto da un error de compilacion que no puedo resolver
>* >>>> por ahora esta anulado
>******************************************************************
>* Carga de los templates para armar el texto de alertas
>* TODO: por ahora los templates son literales
>set LAx to 0
>move high-values to LA-templates
>perform varying LAm from 1 by 1
>until LA-modelo(LAm) = high-values
>set LAx up by 1
>perform varying LAy from 1 by 1 until LAy > 10
>inspect LA-parte(LAx, LAy) replacing trailing
>spaces by high-values
>inspect LA-parte(LAx, LAy) replacing first
>high-value by space
>end-perform
>end-perform.
>
>
1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE<evaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALE










when "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALE
27 lines deleted"online""online"display "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6|DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7|DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS
>DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
>DISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS
>DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN
>DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS
>DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
>DISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGI
>DISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGI
>DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"

*    cantidad de registros con error*    cantidad de registros con error
move E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-error
move N-reg-con-error to N-editmove N-reg-con-error to N-edit
display N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadas
if P-tipo-proceso = "04"if P-tipo-proceso = "04"
move N-ale-borradas to N-editmove N-ale-borradas to N-edit
display N-editdisplay N-edit
"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"



     



     



     
DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6|DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS
DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7|DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS

OPEN MODE
EGISTROS LEIDOS                :" REG-LEIDOS
EGISTROS CORRECTOS             :" REG-CORRECTOS
DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS
DISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS
DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN
DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS
DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN
DISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGI
DISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGI
DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO

display " "display " "
if P-tipo-proceso = "04"if P-tipo-proceso = "04"*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la|*Se recorre toda la estructura bdacsv para la identificacion
*identificacion buscada. En caso de hallar|*buscada. En caso de hallar registros se procede a realizar el
*registros se procede a realizar el match|*matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
>*MOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCHEND-IFEND-IFEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VAL|*MOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VAL|*MOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA|*MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICO|*PERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VAL|*MOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VAL|*MOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VAL|*MOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VAL|*MOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VAL|*MOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VAL|*MOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VAL|*MOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGO|*MOVE SPACES TO EDAD-RANGO
>*MOVE "A"TO ORIGEN-VAL
>ADD 1 TO REG-CORRECTOSADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

    ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.

12 lines deleted                >*    COPY LEEMAESTROS.PROC.ADD 1 TO REG-CORRECTOS   

>
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************






LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registro
*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program CARGAJUR.|end program JURADCAR.************************************************************************************************************************************
************************************************************************************************************************************
<

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL<
<
<
$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.|PROGRAM-ID.    JURADCAR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".|01  pgmpic x(10) value "JURADCAR".************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************
copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************
copy BDIIALE.WS.copy BDIIALE.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************
copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.copy BDAMATCH.WS.************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7) value zero.|03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7) value zero.|03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7) value zero.|03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7) value zero.|03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7) value zero.|03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7) value zero.|03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7) value zero.|03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7) value zero.|03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 "."Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta que no existe".|"Modificación de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta que no existe".|"Eliminación de alerta inexistente".03 pic x(11) value "19 0000000 ".<03 pic x(59) value<"Inserción de alerta que ya existe".<
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.goback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualización de BDIIALE|*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-if
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.
goback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que señalar el fin de proceso*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualización de BDIIALE|*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numeric*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
*    parámetros para las rutinas de validación en BDIIVIDE<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datos|move JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validación|move 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3|IF TIP-IDE-BDIIVIDE = 2 OR 3move 1 to SW-DIGCHEQUEO-BDIIVIDE|MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEend-if|END-IFmove 2 to NUM-BLOQUES-BDIIVIDE|MOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el número de identificación contra las bases de|*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
*    parámetros para las rutinas de validación en BDIIVIDE<move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datos|move JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validación|move 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3|IF TIP-IDE-BDIIVIDE = 2 OR 3move 1 to SW-DIGCHEQUEO-BDIIVIDE|MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEend-if|END-IFmove 2 to NUM-BLOQUES-BDIIVIDE|MOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el número de identificación contra las bases de|*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideif TIP-IDE-BDIIVIDE = 1|IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulamove 02 to CODIGO-ERROR|MOVE 02 TO CODIGO-ERRORelse|ADD 1 TO NO-COINCIDE-REGIS
>ELSE
*no es una cédula*no es una cédula4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideif TIP-IDE-BDIIVIDE = 1|IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulamove 02 to CODIGO-ERROR|MOVE 02 TO CODIGO-ERRORelse|ADD 1 TO NO-COINCIDE-REGIS
>ELSE
*no es una cédula*no es una cédulamove 01 to CODIGO-ERROR|MOVE 01 TO CODIGO-ERRORend-if.|ADD 1 TO NO-COINCIDE-DIAN
>END-IF.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor FUENTE-BDIIALE > 990003<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERROR
elseelsemove 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6IF CODIGO-ERROR = 01
ADD 1 TO NO-COINCIDE-DIANEND-IF
IF CODIGO-ERROR = 02
ADD 1 TO NO-COINCIDE-REGISEND-IF
IF CODIGO-ERROR = 06
ADD 1 TO ESTADO21-BDIIREGIEND-IF
IF CODIGO-ERROR = 07
ADD 1 TO ESTADO12-BDIIREGIEND-IF
ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSEELSE
*es 00: registros correctos|*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.END-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6IF CODIGO-ERROR = 01
ADD 1 TO NO-COINCIDE-DIANEND-IF
IF CODIGO-ERROR = 02
ADD 1 TO NO-COINCIDE-REGISEND-IF
IF CODIGO-ERROR = 06
ADD 1 TO ESTADO21-BDIIREGIEND-IF
IF CODIGO-ERROR = 07
ADD 1 TO ESTADO12-BDIIREGIEND-IF
ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSEELSE
*es 00: registros correctos|*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideif TIP-IDE-BDIIVIDE = 1|IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulamove 02 to CODIGO-ERROR|MOVE 02 TO CODIGO-ERRORelse|ADD 1 TO NO-COINCIDE-REGIS
>ELSE
*no es una cédula*no es una cédulamove 01 to CODIGO-ERROR|MOVE 01 TO CODIGO-ERRORend-if.|ADD 1 TO NO-COINCIDE-DIAN4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor FUENTE-BDIIALE > 990003<if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado<move 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelse
if ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERRORmove 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGIS
add 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOS
end-ifend-if
end-ifend-if
end-if.end-if.


4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6IF CODIGO-ERROR = 01
ADD 1 TO NO-COINCIDE-DIANEND-IF
IF CODIGO-ERROR = 02
ADD 1 TO NO-COINCIDE-REGISEND-IF
IF CODIGO-ERROR = 06
ADD 1 TO ESTADO21-BDIIREGIEND-IF
IF CODIGO-ERROR = 07
ADD 1 TO ESTADO12-BDIIREGIEND-IF
ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSEELSE
*es 00: registros correctos|*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFADD 1 TO REG-CORRECTOSEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0
















     
    
$CHANGE MODEevaluate CODIGO-ERROR
OPEN MODEwhen 01

IF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0$CHANGE MODEwhen 02


$when 06


$when 07IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1*es una cédula*es una cédula



$CHANGE MODEend-evaluateIF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidosJURAD-tipo-novedad " reg num: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"call "PONERR" using "19" JURAD-reg E-errores|display "Insercion de alerta nueva que ya existe "display "llave: " LLAVE-BDIIALE|" key: " LLAVE-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeexit paragraph<end-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove spaces to LINEAS-BDIIALE|perform 4320-ARMAR-TEXTO-ALERTAperform 4333-GRABAR-BDIIALE.|if EST-BDIIALE = "00"4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"call "PONERR" using "17" JURAD-reg E-errores|display "Modificacion de alerta inexistente ""llave: " LLAVE-BDIIALE|" key: " LLAVE-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existeexit paragraph|call "PONERR" using "17" JURAD-reg E-erroresend-ifend-if<
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valores
move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE
move D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALE
move spaces to LINEAS-BDIIALE|perform 4320-ARMAR-TEXTO-ALERTA
perform 4333-REGRABAR-BDIIALE.|if EST-BDIIALE = "00"


4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
************************************************************************************************************************************* Eliminacion de una alerta* Eliminacion de una alerta************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsecall "PONERR" using "18" JURAD-reg E-errores|display "Eliminacion de alerta inexistente ""llave: " LLAVE-BDIIALE|" key: " LLAVE-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existeend-if.end-if.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if<
4800-PROCESO-REG-T-anulado.<
*    Esta parte está anulada por falta de definición sobre el<
*    formato del registro "T"<exit paragraph.<
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-vigentes)<= N-demandas-vigentes<continue<else<display " "<display "No coincide total de demandas vigentes:"<JURADT-demandas-vigentes " con el calculado:"<N-demandas-vigentes<move "SI" to E-hay-error<end-if<
<if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminados" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueOPEN MODE*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if<
4800-PROCESO-REG-T-anulado.<
*    Esta parte está anulada por falta de definición sobre el<
*    formato del registro "T"<exit paragraph.<
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-vigentes)<= N-demandas-vigentes<continue<else<display " "<display "No coincide total de demandas vigentes:"<JURADT-demandas-vigentes " con el calculado:"<N-demandas-vigentes<move "SI" to E-hay-error<end-if<
<if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if<
4800-PROCESO-REG-T-anulado.<
*    Esta parte está anulada por falta de definición sobre el<
*    formato del registro "T"<exit paragraph.<
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-vigentes)<= N-demandas-vigentes<continue<else<display " "<display "No coincide total de demandas vigentes:"<JURADT-demandas-vigentes " con el calculado:"<N-demandas-vigentes<move "SI" to E-hay-error<end-if<
<if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"
N-embargos-terminadosN-embargos-terminados
move "SI" to E-hay-errormove "SI" to E-hay-error
end-if.end-if.
*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el proceso
if E-hay-error = "SI"if E-hay-error = "SI"
display "Error en registro T de totales de control"display "Error en registro T de totales de control"
display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-name
perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2
* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2
* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"evaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivo*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNOdisplay " "display " "* Totales tipo PESVNO* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6|DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7|DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSdisplay " "display " "DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROSMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la|*Se recorre toda la estructura bdacsv para la identificacion
*identificacion buscada. En caso de hallar|*buscada. En caso de hallar registros se procede a realizar el
*registros se procede a realizar el match|*matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCHEND-IFEND-IFEND-IFEND-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC.COPY VALNOM.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************* el registro erroneo* el registro erroneo************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program CARGAJUR.|end program JURADCAR.************************************************************************************************************************************
************************************************************************************************************************************
<

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~APPEND MODE................................................................................:%s/\(................................................................................\).*/\11425 substitutions 






























~sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.No file  line 1 of 1598 --0%-- :w CARGAJUR.CBL"CARGAJUR.CBL" File exists - use "w! CARGAJUR.CBL" to overwrite:w!"CARGAJUR.CBL" 1598 lines, 116598 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************[1] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>/des-cdes-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                /x CARGAx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2      
0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO
 
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000958212
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I300600003115xxxxxx                                       0150542014010600400320120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163598xxxxxx                                       0330432013101002204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
T 00000000028                                             772774        787861        
4000-PROCESAR-REGISTRO-2
4800-PROCESO-REG-T
7000-RUTINA-FINAL
Fecha de proceso: 20140104
 
Totales de registros:
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
    64.3 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      18 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.11s
user    0m0.02s
sys     0m0.02s

Inicio de Programa:  2014/06/12 17:38:21
Fin de Programa:     2014/06/12 17:38:21

/d/iccol/desarrollo/fuentes>find / -name CARGAJUR*           "CARGAJUR*" -ls
find: cannot read dir /var/tmp/cobAAAZeayYU: Permission denied
find: cannot read dir /var/tmp/cobAAAZDaaoc: Permission denied
find: cannot read dir /var/tmp/cobAAATRaOY0: Permission denied
find: cannot read dir /var/tmp/cobAAAt_aOc3: Permission denied
find: cannot read dir /var/tmp/cobAAAQuaOrt: Permission denied
find: cannot read dir /var/tmp/cobAAAk6aGaA: Permission denied
find: cannot read dir /var/tmp/cobAAA9GaOKd: Permission denied
find: cannot read dir /var/tmp/cobAAA8Uai02: Permission denied
find: cannot read dir /var/spool/mqueue: Permission denied
find: cannot read dir /var/spool/clientmqueue: Permission denied
find: cannot read dir /var/sma_snmp: Permission denied
find: cannot read dir /var/sadm/pkg/TSIpgxw/save: Permission denied
find: cannot read dir /var/sadm/pkg/TSIpgx/save: Permission denied
find: cannot read dir /var/sadm/pkg/TSBWvplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/TSBWvplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzuluw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzulur/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzuluc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzulu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzsh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzoneu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzoner/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzlib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfskr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsgu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzebrau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzebrar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWypu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWypr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwxst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwxft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwsvr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwsrv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwsrc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwslb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwrtl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwplt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwopt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwoft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwmod/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwkey/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwinc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwice/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwhl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwfs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwfnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwfa/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdxm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwcsl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwcft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwacx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxvnc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxscreensaver-hacks/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxscreensaver-hacks-gl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-xkb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-tsol-module/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-headers/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-graphics-ddx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-doc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-devel-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-compatlinks/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-clientlibs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-client-programs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-client-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-cfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilvl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilrl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxildh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxi18n/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcursor-themes/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcu6/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcu4t/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcu4/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwsrv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwsr2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsa/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwgetu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwgetr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwebminu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwebminr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbsup/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbpro/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbcou/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbcor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtsts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtsmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvolu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvolr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvncviewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvldu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvld/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuxlcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusbu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusbs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusbccid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWus/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuprl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWupdatemgru/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWupdatemgrr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWulcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWukspfw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuksp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuium/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWugenu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWugen/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuedg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudaplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudapltu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudapltr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudaplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWucbt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuacm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtxfnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtoo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnfd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnfc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnetr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnetd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnetc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnamr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnamd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtltkm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtltkd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtltk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtlsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtlsd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtls/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTiff/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTiff-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTiff-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWthunderbirdl10n-fr-FR/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWthunderbirdl10n-es-ES/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWthunderbird/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-xagent/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tstripe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsoljdsselmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsoljdslabel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsoljdsdevmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsol-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsol-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-l10n-ui-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-l10n-ui-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtftpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtftp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtexi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtecla/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcsh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcatu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcatr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtavor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWswupclr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWswupcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWswmt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstsfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstsf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsthwreg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-xsltfilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-writer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-w4wfilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-sunsearchtoolbar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-ooofonts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-menuintegration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-math/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-lngutils/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-javafilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-impress/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-graphicfilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-gnome-integration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-gallery/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsrh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-fr-res/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-fr-help/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-es-res/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-es-help/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-draw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core09/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core08/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core07/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core06/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core05/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core04/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core03/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core02/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core01/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-calc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWssad/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsra/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsprot/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWspnego/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWspl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsolnm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsneep/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsndmu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsndmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmcmd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmbau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmbar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmbac/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmagt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWslpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWslpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsior/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfwhea/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfwdemo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfinf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfdrr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWses/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWserweb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWservicetagr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWservicetagu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWseru/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWserr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsensorr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsensor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscsip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscsa1394/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscplp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnsomr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnsom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnprmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnprm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscn-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscn-base-r/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscmhdlr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsckmu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsckmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsckm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscgui/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsbp2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsasnm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsasm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsamr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsam/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsadml/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsadmi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsacom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs9brandu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs9brandr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs8brandu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs8brandr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrtvcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrtvcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrtvc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsmo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsgk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrpm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrpcib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWroute/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmwbu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmwbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmui/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmodu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrealplayer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrealplayer-l10n-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrealplayer-l10n-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrds/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcmds/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcmdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcmdc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcapu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcapr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqusu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqus/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqosu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqos/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqlcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqlc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqfedu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqfed/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWPython/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWPython-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWPython-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsutils/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpstl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsm-lpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsm-ipp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsdpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWproduct-registry-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWprd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpprou/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWppror/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWppro-plugin-sunos-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWppm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppdt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostrun/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostrun-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-upgrade/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-tcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-server-data/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-pl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-jdbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-contrib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-tcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-server-data-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-pl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-contrib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-client/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-tcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-server-data-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-pl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-jdbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-contrib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-client/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpoolr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpool/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpng/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpng-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpng-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmowu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmowr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmowm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmdbi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmdbdpg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpltlk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWplowr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWplow1/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWplow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5v/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5u/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5p/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5m/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpkgcmdsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpkgcmdsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpiclu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpiclr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpiclh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWphx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpgadmin3/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl584usr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl584man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl584core/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl-xml-parser/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl-xml-parser-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpdas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcser/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcsclite/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcsclite-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcmem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcmcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcmci/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcelx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpamsc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWowbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWosdem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensslr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-libraries/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-include/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-commands/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWolrte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWogg-vorbis/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWogg-vorbis-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWogg-vorbis-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWodtts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocfh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocfd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnxge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWntpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWntpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnisu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnisr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfssu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfssr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfsskr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfscu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfscr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfsckr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWncft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWncau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWncar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnamow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnamos/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnamdt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmysqlu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmysqlt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmysqlr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpsvplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpathadmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpathadm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpapir/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozspell/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozpsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznss-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznspr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznspr-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozmail/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozjs-debugger/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozilla/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozilla-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozgm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozdom-inspector/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozchat/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozapoc-adapter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmkcd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmipu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmipr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmibii/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmgts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmgapp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmga/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmfrun/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmfman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmfdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmddr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdbdm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmcex/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmcdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmccom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmcc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64xr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64w/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64cf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxsl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxsl-python/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxml/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxml-python/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlvmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlvmg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlvma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluzone/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxopr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxop/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlur/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlucfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlpmsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocaledefsrc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWloc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocalecreator/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocalecreator-l10n-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocalecreator-l10n-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlldap/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWllcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWllc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibusbugen/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibusb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibsasl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibpopt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibpopt-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibpopt-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibmsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibms/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibgcrypt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibgcrypt-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibexif/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibexif-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibCf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibC/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlexpt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWless/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlccom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWladm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkxmft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkxfnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkvm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkrbu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkrbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkoi8f/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkmp2r/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkey/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkdcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkdcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjxmft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjxcft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjsnmp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjre-config/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjre-config-plugin/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjpg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjpg-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjpg-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjmfmp3/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjmf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjmail/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfcau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfca/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdsver/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdsrm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjds-registration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdmk-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdic/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjcom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjavaapps/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjai/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjai-imageio/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjaf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5rtx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5rt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dvx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dmx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dmo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5cfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3rtx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3rt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3irt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3dvx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3dmo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3dev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3cfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWixgbe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWixgb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWisolc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWislcc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsiu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsitgtu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsitgtr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsir/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqum/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiquc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqjx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqfs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWippcore/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipoib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipmir/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipmi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipfu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipfh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiopc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWinttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWintgige/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWinstall-patch-utils-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWinst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiniu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWimagick/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiiimu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiiimr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWigb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifph/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidnu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidnl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidnd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWicud/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWicu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWibsdpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWibsdpib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWibsdp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi9rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi8rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi7rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi5rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi4rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi2rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi2cr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhmd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi1of/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi1cs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi15rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi15cs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi13rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhpijs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhmdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhermon/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhea/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgzip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWGtku/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWGtkr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgtar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgssk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgssdh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgssc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgsfst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgsfot/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgscr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgpch/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnutls/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrdis/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnutls-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-xml-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-xml-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-utility-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-utility-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-utility-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-user-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ui-designer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ui-designer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-themes/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-themes-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sys-suspend/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sys-suspend-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-spell/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-spell-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sound-recorder/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sound-recorder-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sound-recorder-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-session/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-session-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-session-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-search-tool/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-search-tool-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-search-tool-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-removable-media/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-removable-media-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ps-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ps-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-jdshelp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ps-viewer-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-perf-meter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-perf-meter-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-perf-meter-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pdf-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pdf-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pdf-viewer-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-mm-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-mm-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-mm-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgcmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-player/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-player-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-player-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10nmessages-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10nmessages-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10ndocument-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10ndocument-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-jdshelp-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-intranet-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-intranet-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-intranet-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-internet-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-internet-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-internet-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-viewer-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-camera-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-im-client/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-im-client-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-help-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-help-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-games/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-games-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-games-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fun-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fun-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fun-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-freedb-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-freedb-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-freedb-libs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fonts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dtlogin-integration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-display-mgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-display-mgr-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-display-mgr-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dictionary/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dictionary-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dictionary-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dialog/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dialog-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-config-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-component/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-component-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-component-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-component-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-common-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-common-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-character-map/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-character-map-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-cd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-cd-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-cd-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-cd-burner/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-cd-burner-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-cd-burner-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-camera/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-camera-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-calculator/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-calculator-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-calculator-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-base-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-base-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-base-libs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-base-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-base-libs-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-audio/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-audio-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-audio-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-audio-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-audio-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-archive-mgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-archive-mgr-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-archive-mgr-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-speech/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-speech-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-speech-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-reader/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-reader-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-reader-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-reader-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-poke/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-poke-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-libs-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-gok/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-gok-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-gok-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-base-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-base-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-a11y-base-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgmake/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgm4/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWglt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWglrt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWglow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWglmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWGlib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWglh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgldoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgimpprint/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWggrp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgfbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgedu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWged/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgccruntime/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgcc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfzfsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfxplt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwflash/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwdcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwdcd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwdc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfwacx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfupdatemgru/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWftpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWftpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWftltk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWftduu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWftdur/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfswupcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsmgtu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsmgtr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsfw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsexam/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrdma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsexam-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfscgu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfsadl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrxwsvr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrwsv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrws2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrwm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrwbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfruip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfruid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrspl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrsmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrpmw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfros/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrmui/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrmoz/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrlu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrhez/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrhev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrhed/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrhe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfreetype2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrdte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrdst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrbas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfpprou/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfppd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfpdas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWforte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfontconfig/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfontconfig-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfontconfig-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfmgp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfmdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfmd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWflvmg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWflvma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWflexruntime/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWflexlex/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWflash-player-plugin/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfladm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfirefoxl10n-fr-FR/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfirefoxl10n-es-ES/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfirefox/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfirefox-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWewacx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfirefox-apoc-adapter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWffiltersu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWffiltersr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWffdl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWffbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWffbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWffb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfdl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfdhcm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfdcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfctl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfcsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfcprt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfcmdb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfcip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfchbar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfchba/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfbrg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfac/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWezfsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWexplt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWewdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-socs-connect/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-socs-connect-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-exchange/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-exchange-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-exchange-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWevolution-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeuxwe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeurf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeupdatemgru/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeuodf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeuluf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeuhed/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeuhe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeuezt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudmg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudlg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudiv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudis/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudhs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudhr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudda/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudbd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeudba/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeu8os/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeu8df/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWetltk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesxwsvr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeswupcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeswsv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesws2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeswm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeswbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesspl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcry/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWessmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWespmw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesos/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesmoz/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeslu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeshez/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeshev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeshed/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeshe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesfw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesdte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesdst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesdma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesdis/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWescgu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesbas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWesadl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWermui/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWerid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWepprou/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWepdas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeorte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWemlxu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWemlxs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWemgp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWelvmg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWelvma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWeladm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWefdl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWefcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWefcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWefcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWefc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWedhcm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWedcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWebrg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdvdrw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtwm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdttsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdttsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdttshelp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtscm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtrp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtrc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtmaz/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtmad/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtlog/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtjxt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtinc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdticn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdthez/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdthev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdthed/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdthe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtezt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtdte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtdst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtdmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtdmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtdem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtct/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtcor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtbas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdtab/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdscpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdscpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdrr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdrcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdpl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdmgtu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdmgtr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdialh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdial/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdhcsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdhcsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdhcsb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdhcm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdfbh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdcsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdcsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdclnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdcar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWdcaf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcxmft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcvcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcvc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWctpls/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWctlu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcti2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcstl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcsmauth/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcslr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcsl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcsd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcryr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcrman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcpp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcpcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcpc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcnsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcnsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcnetr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWckr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWciu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWchxge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcg6h/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcg6/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcfplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcfpl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcfclr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcfcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcedu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWced/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcea/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcdrw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcctpx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccsign/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccinv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccfwctrl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccfw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccccrr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccccr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWccccfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcakr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcacaort/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWcacaodtrace/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbzip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbtool/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbrgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbrg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbnuu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbnur/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbison/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbipr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbinutils/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbindr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbind/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbdbj/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbdb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbash/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWbart/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWav1394/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWautoef/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaudit/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaudh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaudf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaudd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWauda/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWatfsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWatfsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasut/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWastfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWastfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWast/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaspell/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaspell-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaspell-en/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaspell-en-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaspell-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasjdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasjavadb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasdem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWascmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWasac/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWarrf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWarcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWarc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWarbel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapoc-adapter-gconf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapmsc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapdc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapdc-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapct/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapcj/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapchu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapchr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapchd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapch2u/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapch2r/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapch2d/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWapbas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWant/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaled/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWale/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWafbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWafbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWafbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWafb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmlib-sysid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmj/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmfw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWadmap/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWacroread/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWacroread-plugin/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaclg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaccu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaccr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWaac/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWa2psu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWa2psr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNW5xmft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNW5ttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNW1394h/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNW1394/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNW1251f/save: Permission denied
find: cannot read dir /var/sadm/pkg/SMEvplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SMEvplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SMClintl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SMCliconv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SMCcvs/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVxwpsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVvplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVvplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVs9brandr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVs8brandr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVpiclu/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVmdbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVmdb/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVhea/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVglrt/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVfmd/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVcsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVcryr/save: Permission denied
find: cannot read dir /var/sadm/pkg/FJSVcpcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/BFAgent/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRSsrvinv/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRSsmf/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRSnsclt/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRSiragent/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRSinv/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRScta/save: Permission denied
find: cannot read dir /var/sadm/pkg/ATRSbth/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstosreg/save: Permission denied
find: cannot read dir /var/sadm/pkg/rsync/save: Permission denied
find: cannot read dir /var/sadm/patch/119254-88/: Permission denied
find: cannot read dir /var/run/smc898: Permission denied
find: cannot read dir /var/preserve/icvnudd: Permission denied
find: cannot read dir /var/preserve/icvhfd: Permission denied
find: cannot read dir /var/preserve/icrmbd: Permission denied
find: cannot read dir /var/preserve/icrgd: Permission denied
find: cannot read dir /var/preserve/icnudd: Permission denied
find: cannot read dir /var/preserve/iclagd: Permission denied
find: cannot read dir /var/preserve/icjmld: Permission denied
find: cannot read dir /var/preserve/icjdld: Permission denied
find: cannot read dir /var/preserve/icjcld: Permission denied
find: cannot read dir /var/preserve/icjcad: Permission denied
find: cannot read dir /var/preserve/icjamd: Permission denied
find: cannot read dir /var/preserve/icjaad: Permission denied
find: cannot read dir /var/preserve/icimsd: Permission denied
find: cannot read dir /var/preserve/ichqd: Permission denied
find: cannot read dir /var/preserve/icgjcd: Permission denied
find: cannot read dir /var/preserve/icgavd: Permission denied
find: cannot read dir /var/preserve/icfgcd: Permission denied
find: cannot read dir /var/preserve/icfard: Permission denied
find: cannot read dir /var/preserve/icfactur: Permission denied
find: cannot read dir /var/preserve/icfacd: Permission denied
find: cannot read dir /var/preserve/icehad: Permission denied
find: cannot read dir /var/preserve/iccavd: Permission denied
find: cannot read dir /var/preserve/icjjmd: Permission denied
find: cannot read dir /var/preserve/icgasd: Permission denied
find: cannot read dir /var/preserve/icdgd: Permission denied
find: cannot read dir /var/preserve/icnagd: Permission denied
find: cannot read dir /var/postgres/8.3/data_64: Permission denied
find: cannot read dir /var/postgres/8.3/data: Permission denied
find: cannot read dir /var/postgres/8.3/backups: Permission denied
find: cannot read dir /var/postgres/8.2/data: Permission denied
find: cannot read dir /var/postgres/8.2/backups: Permission denied
find: cannot read dir /var/mysql: Permission denied
find: cannot read dir /var/lib/log/gdm: Permission denied
find: cannot read dir /var/lib/gdm: Permission denied
find: cannot read dir /var/krb5/rcache/root: Permission denied
find: cannot read dir /var/fm/fmd/xprt: Permission denied
find: cannot read dir /var/fm/fmd/rsrc: Permission denied
find: cannot read dir /var/fm/fmd/ckpt: Permission denied
find: cannot read dir /var/dt/sdtlogin: Permission denied
^C/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -lsfind / -name "CARGAJUR*" -ls  2> /DEV/null        dev/null
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.s
45034  200 -rw-rw-r--   1 icjlud   icdatacr   194152 Jun 12 10:33 /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL
 7608  128 -rw-rw-r--   1 icdgd    icdatacr   116598 Jun 12 17:37 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.s
45034  200 -rw-rw-r--   1 icjlud   icdatacr   194152 Jun 12 10:33 /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL
 7608  128 -rw-rw-r--   1 icdgd    icdatacr   116598 Jun 12 17:37 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>find / -name "*" -ls  2> /dev/null        J*" -ls  2> /dev/nullU*" -ls  2> /dev/nullR*" -ls  2> /dev/nullA*" -ls  2> /dev/nullD*" -ls  2> /dev/nullC*" -ls  2> /dev/nullA*" -ls  2> /dev/nullR*" -ls  2> /dev/null
123899   90 -rw-rw-r--   1 icdgd    icdatacr    91648 Jun 12 16:09 /d/iccol/desarrollo/objetos/JURADCAR.int
123774  128 -rw-rw-r--   1 icdgd    icdatacr   116684 Jun 12 16:09 /d/iccol/desarrollo/objetos/JURADCAR.gnt
123524  960 -rw-rw-r--   1 icdgd    icdatacr   967983 Jun 12 16:09 /d/iccol/desarrollo/objetos/JURADCAR.lst
123594  368 -rw-rw-r--   1 icdgd    icdatacr   365056 Jun 12 16:09 /d/iccol/desarrollo/objetos/JURADCAR.idy
123773  872 -rw-rw-r--   1 icdgd    icdatacr   877533 Jun 12 16:09 /d/iccol/desarrollo/objetos/JURADCAR.s
44986   72 -rw-rw-r--   1 icdgd    icdatacr    73559 Jun 12 16:07 /d/iccol/desarrollo/fuentes/JURADCAR.CBL
45050   69 -rw-rw-r--   1 icjlud   icdatacr    70439 Jun 12 16:12 /d/iccol/desarrollo/fuentes/JURADCARZ.ctrol
/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/iccol/desarrollo/objetos/JURADCAR.gnt  /d/iccol/desarrollo/objetos/JURADCAR.idy /d/iccol/desarrollo/objetos/JURADCAR.s
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls              /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO
 
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000958212
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I300600003115xxxxxx                                       0150542014010600400320120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163598xxxxxx                                       0330432013101002204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
T 00000000028                                             772774        787861        
4000-PROCESAR-REGISTRO-2
4800-PROCESO-REG-T
7000-RUTINA-FINAL
Fecha de proceso: 20140104
 
Totales de registros:
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
    64.3 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      18 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.04s
user    0m0.01s
sys     0m0.02s

Inicio de Programa:  2014/06/12 17:47:09
Fin de Programa:     2014/06/12 17:47:09

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/objetos/JURADCAR.int: No such file or directory
/d/iccol/desarrollo/objetos/JURADCAR.gnt: No such file or directory
/d/iccol/desarrollo/objetos/JURADCAR.idy: No such file or directory
/d/iccol/desarrollo/objetos/JURADCAR.s: No such file or directory
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2              /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>
123524  960 -rw-rw-r--   1 icdgd    icdatacr   967983 Jun 12 16:09 /d/iccol/desarrollo/objetos/JURADCAR.lst
44986   72 -rw-rw-r--   1 icdgd    icdatacr    73559 Jun 12 16:07 /d/iccol/desarrollo/fuentes/JURADCAR.CBL
45050   69 -rw-rw-r--   1 icjlud   icdatacr    70439 Jun 12 16:12 /d/iccol/desarrollo/fuentes/JURADCARZ.ctrol
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2              /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.s
45034  200 -rw-rw-r--   1 icjlud   icdatacr   194152 Jun 12 10:33 /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL
 7608  128 -rw-rw-r--   1 icdgd    icdatacr   116598 Jun 12 17:37 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/fuentes>rm  /d/iccol/desarrollo/objetos/CARGAJUR.idy /d/iccol/desarrollo/objetos/CARGAJUR.int /d/iccol/desarrollo/objetos/CARGAJUR.gnt /d/iccol/desarrollo/objetos/CARGAJUR.s
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm  /d/iccol/desarrollo/objetos/CARGAJUR.idy /d/i>/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 17:37 /d/iccol/desarrollo/objetos/CARGAJUR.lst
45034  200 -rw-rw-r--   1 icjlud   icdatacr   194152 Jun 12 10:33 /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL
 7608  128 -rw-rw-r--   1 icdgd    icdatacr   116598 Jun 12 17:37 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>rm  /d/iccol/desarrollo/objetos/CARGAJUR.idy /d/i>/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2              /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls              /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                    /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfind / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 17:49 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 17:49 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 17:49 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 17:49 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 17:49 /d/iccol/desarrollo/objetos/CARGAJUR.s
45034  200 -rw-rw-r--   1 icjlud   icdatacr   194152 Jun 12 10:33 /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL
 7608  128 -rw-rw-r--   1 icdgd    icdatacr   116598 Jun 12 17:37 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                          /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>rm  /d/iccol/desarrollo/objetos/CARGAJUR.idy /d/i>/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null        /d/iccol/desarrollo/fuentes>find / -name "JURADCAR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/JURADCAR.int /d/ic>/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2              /d/iccol/desarrollo/fuentes>
0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO
 
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000958212
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I300600003115xxxxxx                                       0150542014010600400320120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163598xxxxxx                                       0330432013101002204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
T 00000000028                                             772774        787861        
4000-PROCESAR-REGISTRO-2
4800-PROCESO-REG-T
7000-RUTINA-FINAL
Fecha de proceso: 20140104
 
Totales de registros:
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
    64.3 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      18 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.05s
user    0m0.01s
sys     0m0.02s

Inicio de Programa:  2014/06/12 17:50:34
Fin de Programa:     2014/06/12 17:50:34

/d/iccol/desarrollo/fuentes>fg
vi
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************[1] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>te
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>tefgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/temporales>
0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO
 
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000958212
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I300600003115xxxxxx                                       0150542014010600400320120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
 
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO
 
 
I400000163598xxxxxx                                       0330432013101002204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
 
 
T 00000000028                                             772774        787861        
4000-PROCESAR-REGISTRO-2
4800-PROCESO-REG-T
7000-RUTINA-FINAL
Fecha de proceso: 20140104
 
Totales de registros:
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
    64.3 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      18 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.05s
user    0m0.01s
sys     0m0.02s

Inicio de Programa:  2014/06/12 17:51:16
Fin de Programa:     2014/06/12 17:51:16

/d/iccol/desarrollo/temporales>cob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P -C sourceasm $FUENTES/CARGAJUR.CBL
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Rejected - OPT
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
  3577                 MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM                                                     1465
*  12-S****************************************************            (   0)**                                 1466
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                               1466
  3578                 MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM                                          1466
*  12-S*************************************************************** (  63)**                                 1467
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                               1467
  3579                 MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM                                                    1467
*  12-S*****************************************************           (  63)**                                 1468
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                               1468
  3580                 MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                                        1468
*  12-S****************************************************************(  63)**                                 1469
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                              1469
  3582                 IF MATCH-OK-OUT-VALNOM = 1                                                               1470
*  12-S**************************************                          (  63)**                                 1470
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                               1470
  3592     END-IF.                                                                                              1480
* 564-S**********                                                      (  63)**                                 1480
**    A scope-delimiter did not have a matching verb and was discarded.                                         1480
  3652    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM                                    BDIIVIDE      40
* 301-S*********************************************************       (  64)**                                   42
**    Unrecognized verb                                                                                           42
  3683          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM                                        BDIIVIDE      71
*  12-S*****************************************************           (  65)**                                   72
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 72
  3684          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM                                         BDIIVIDE      72
*  12-S****************************************************            (  65)**                                   73
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                 73
  3685          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM                                        BDIIVIDE      73
*  12-S*****************************************************           (  65)**                                   74
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                 74
  3689                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                             BDIIVIDE      77
*  12-S****************************************************************(  65)**                                   78
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                78
  3690             ELSE IF TIP-ID-INPUT-VALNOM = 1                                                  BDIIVIDE      78
*  12-S***************************************                         (  65)**                                   78
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 78
  3691                     MOVE 2 TO BLOQUES-INPUT-VALNOM                                           BDIIVIDE      79
*  12-S**************************************************              (  66)**                                   80
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                80
  3692                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM                                         BDIIVIDE      80
*  12-S****************************************************            (  66)**                                   82
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                82
  3696             IF MATCH-OK-OUT-VALNOM = 0                                                       BDIIVIDE      84
*  12-S**********************************                              (  66)**                                   84
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                 84
  3701      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002                     BDIIVIDE      89
* 562-S*********                                                       (  66)**                                   89
**    An "ELSE" phrase did not have a matching IF and was discarded.                                              89
  3704      END-IF                                                      FAC0002                     BDIIVIDE      92
* 564-S***********                                                     (  66)**                                   93
**    A scope-delimiter did not have a matching verb and was discarded.                                           93
  3706    END-IF.                                                                                   BDIIVIDE      94
* 564-S*********                                                       (  66)**                                   94
**    A scope-delimiter did not have a matching verb and was discarded.                                           94
".............COMPILANDO BDLDIR SIN MATCH **********
  6882       MOVE 0 TO MATCH-OK-OUT-VALNOM                                                          BDAMATCH     727
*  12-S***********************************                             (  66)**                                  728
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                728
  6885               OR MATCH-OK-OUT-VALNOM = 1                                                     BDAMATCH     730
*  12-S************************************                            ( 121)**                                  730
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                730
  6887              NOMBRE-INPUT-VALNOM                                                             BDAMATCH     732
*  12-S********************************                                ( 121)**                                  733
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                733
  6889              NOMBOK-INPUT-VALNOM                                                             BDAMATCH     734
*  12-S********************************                                ( 121)**                                  735
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                735
  6893               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     738
*  12-S*******************************************                     ( 121)**                                  739
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                739
  6894               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     739
*  12-S********************************************                    ( 121)**                                  741
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               741
  6896               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     741
*  12-S*******************************************                     ( 121)**                                  742
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                742
  6897               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     742
*  12-S********************************************                    ( 121)**                                  744
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               744
  6900            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004                     BDAMATCH     745
*  12-S****************************************                        ( 121)**                                  746
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                746
  6901            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     746
*  12-S*****************************************                       ( 121)**                                  748
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               748
  6903         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004                     BDAMATCH     748
*  12-S******************************                                  ( 121)**                                  748
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                748
  6905            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     750
*  12-S*****************************************                       ( 121)**                                  752
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               752
  6906         END-IF                                                   RMB0004                     BDAMATCH     751
* 564-S**************                                                  ( 122)**                                  752
**    A scope-delimiter did not have a matching verb and was discarded.                                          752
  6908         IF MATCH-OK-OUT-VALNOM = 1                                                           BDAMATCH     753
*  12-S******************************                                  ( 122)**                                  753
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                753
  6915            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004                     BDAMATCH     760
*  12-S**********************************                              ( 122)**                                  760
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               760
  6917            END-IF                                                RMB0004                     BDAMATCH     762
* 564-S*****************                                               ( 122)**                                  763
**    A scope-delimiter did not have a matching verb and was discarded.                                          763
  6930         END-IF                                                                               BDAMATCH     775
* 564-S**************                                                  ( 122)**                                  776
**    A scope-delimiter did not have a matching verb and was discarded.                                          776
  6933       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO                                             BDAMATCH     778
*  12-S****************************                                    ( 122)**                                  778
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                778
  6952       ELSE                                                    *>                             BDAMATCH     797
* 562-S**********                                                      ( 122)**                                  797
**    An "ELSE" phrase did not have a matching IF and was discarded.                                             797
  6955       END-IF                                                                                 BDAMATCH     800
* 564-S************                                                    ( 123)**                                  801
**    A scope-delimiter did not have a matching verb and was discarded.                                          801
  6957     END-PERFORM.                                                                             BDAMATCH     802
* 564-S***************                                                 ( 123)**                                  802
**    A scope-delimiter did not have a matching verb and was discarded.                                          802
  7399     MOVE 0 TO MATCH-OK-OUT-VALNOM.                                                           VALNOM        42
*  12-S*********************************                               ( 123)**                                   42
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                 42
  7400     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM        43
*  12-S****************************                                    ( 130)**                                   43
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                 43
  7401     IF TIP-ID-INPUT-VALNOM  = 2                                                              VALNOM        44
*  12-S**************************                                      ( 130)**                                   44
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 44
  7402         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                              VALNOM        45
*  12-S*********************************                               ( 130)**                                   45
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   45
  7413         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM        56
*  12-S*********************************                               ( 131)**                                   56
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   56
  7424         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        67
*  12-S*********************************                               ( 131)**                                   67
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   67
  7428         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        71
*  12-S*********************************                               ( 131)**                                   71
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   71
  7432         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM                                        VALNOM        75
*  12-S******************************                                  ( 131)**                                   75
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   75
  7434        INSPECT CADENA-VALNOM    REPLACING ALL                                                VALNOM        77
*  12-S****************************                                    ( 131)**                                   77
**    Operand CADENA-VALNOM is not declared                                                                       77
  7440        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002                     VALNOM        83
*  12-S****************************                                    ( 131)**                                   83
**    Operand CADENA-VALNOM is not declared                                                                       83
  7446                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM        89
*  12-S***************************************                         ( 131)**                                   89
**    Operand I-VALNOM is not declared                                                                            89
  7448                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM        91
*  12-S***********************************                             ( 132)**                                   91
**    Operand VNOM-AUX-VALNOM is not declared                                                                     91
  7450                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM        93
*  12-S***********************************************                 ( 132)**                                   93
**    Operand VNOM-AUX-VALNOM is not declared                                                                     93
  7451                  END-IF                                                                      VALNOM        94
* 564-S***********************                                         ( 132)**                                   95
**    A scope-delimiter did not have a matching verb and was discarded.                                           95
  7452                END-PERFORM                                                                   VALNOM        95
* 564-S**************************                                      ( 132)**                                   96
**    A scope-delimiter did not have a matching verb and was discarded.                                           96
  7453     END-IF.                                                                                  VALNOM        96
* 564-S**********                                                      ( 132)**                                   96
**    A scope-delimiter did not have a matching verb and was discarded.                                           96
  7454     MOVE SPACES TO VECTOR-INPUT-VALNOM.                                                      VALNOM        97
*  12-S**************************************                          ( 132)**                                   97
**    Operand VECTOR-INPUT-VALNOM is not declared                                                                 97
  7455     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM        98
*  12-S**************************                                      ( 132)**                                   98
**    Operand CADENA-VALNOM is not declared                                                                       98
  7468     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM       111
*  12-S****************************                                    ( 132)**                                  111
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                111
  7469     IF TIP-ID-INPUT-VALNOM  NOT = 2                                                          VALNOM       112
*  12-S**************************                                      ( 132)**                                  112
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                112
  7470        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                               VALNOM       113
*  12-S********************************                                ( 132)**                                  113
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  113
  7474                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM       117
*  12-S***************************************                         ( 132)**                                  117
**    Operand I-VALNOM is not declared                                                                           117
  7476                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM       119
*  12-S***********************************                             ( 132)**                                  119
**    Operand VNOM-AUX-VALNOM is not declared                                                                    119
  7478                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM       121
*  12-S***********************************************                 ( 132)**                                  121
**    Operand VNOM-AUX-VALNOM is not declared                                                                    121
  7479                  END-IF                                                                      VALNOM       122
* 564-S***********************                                         ( 133)**                                  123
**    A scope-delimiter did not have a matching verb and was discarded.                                          123
  7480                END-PERFORM                                                                   VALNOM       123
* 564-S**************************                                      ( 133)**                                  124
**    A scope-delimiter did not have a matching verb and was discarded.                                          124
  7482         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       125
*  12-S*********************************                               ( 133)**                                  125
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  125
  7493         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       136
*  12-S*********************************                               ( 133)**                                  136
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  136
  7504        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003                     VALNOM       147
*  12-S********************************                                ( 133)**                                  147
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  147
  7508         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM                                        VALNOM       151
*  12-S******************************                                  ( 133)**                                  151
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  151
  7509     END-IF.                                                                                  VALNOM       152
* 564-S**********                                                      ( 133)**                                  152
**    A scope-delimiter did not have a matching verb and was discarded.                                          152
  7510     MOVE SPACES TO VECTOR-OK-VALNOM.                                                         VALNOM       153
*  12-S***********************************                             ( 133)**                                  153
**    Operand VECTOR-OK-VALNOM is not declared                                                                   153
  7511     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM       154
*  12-S**************************                                      ( 133)**                                  154
**    Operand CADENA-VALNOM is not declared                                                                      154
  7522     MOVE 1 TO I-VALNOM.                                                                      VALNOM       165
*  12-S**********************                                          ( 133)**                                  165
**    Operand I-VALNOM is not declared                                                                           165
  7523     MOVE 0 TO BLOQOK-AUX-VALNOM.                                                             VALNOM       166
*  12-S*******************************                                 ( 134)**                                  166
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  166
  7524     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES                                         VALNOM       167
*  12-S*********************************                               ( 134)**                                  167
**    Operand VM-INPUT-VALNOM is not declared                                                                    167
  7525       MOVE 1 TO J-VALNOM                                                                     VALNOM       168
*  12-S************************                                        ( 134)**                                  169
**    Operand J-VALNOM is not declared                                                                           169
  7526       PERFORM UNTIL J-VALNOM > 20                                                            VALNOM       169
*  12-S****************************                                    ( 134)**                                  169
**    Operand J-VALNOM is not declared                                                                           169
  7527         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)                                VALNOM       170
*  12-S**************************                                      ( 134)**                                  170
**    Operand VM-INPUT-VALNOM is not declared                                                                    170
  7528            ADD 1 TO BLOQOK-AUX-VALNOM                                                        VALNOM       171
*  12-S*************************************                           ( 134)**                                  172
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  172
  7529            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                             VALNOM       172
*  12-S**************************************                          ( 134)**                                  172
**    Operand VM-OK-VALNOM is not declared                                                                       172
  7531            MOVE 21 TO J-VALNOM                                                               VALNOM       174
*  12-S******************************                                  ( 134)**                                  176
**    Operand J-VALNOM is not declared                                                                           176
  7533            MOVE 0 TO M-VALNOM                                                                VALNOM       176
*  12-S*****************************                                   ( 134)**                                  177
**    Operand M-VALNOM is not declared                                                                           177
  7534            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                                  VALNOM       177
*  12-S*******************************                                 ( 134)**                                  177
**    Operand VM-OK-VALNOM is not declared                                                                       177
  7536            IF M-VALNOM >= 15                                                                 VALNOM       179
*  12-S**********************                                          ( 134)**                                  179
**    Operand M-VALNOM is not declared                                                                           179
  7537               MOVE 0 TO M-VALNOM                                                             VALNOM       180
*  12-S********************************                                ( 134)**                                  181
**    Operand M-VALNOM is not declared                                                                           181
  7538               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                               VALNOM       181
*  12-S**********************************                              ( 134)**                                  181
**    Operand VM-OK-VALNOM is not declared                                                                       181
  7540            END-IF                                                                            VALNOM       183
* 564-S*****************                                               ( 134)**                                  184
**    A scope-delimiter did not have a matching verb and was discarded.                                          184
  7541            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20                                        VALNOM       184
*  12-S**********************                                          ( 134)**                                  184
**    Operand M-VALNOM is not declared                                                                           184
  7543               COMPUTE INI-VALNOM = M-VALNOM + 2                                              VALNOM       186
*  12-S********************************                                ( 134)**                                  186
**    Operand INI-VALNOM is not declared                                                                         186
  7544               COMPUTE LON-VALNOM = 14 - M-VALNOM                                             VALNOM       187
*  12-S********************************                                ( 135)**                                  187
**    Operand LON-VALNOM is not declared                                                                         187
  7545               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM                                   VALNOM       188
*  12-S*******************************                                 ( 135)**                                  188
**    Operand VM-OK-VALNOM is not declared                                                                       188
  7546               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =                                      VALNOM       189
*  12-S******************************                                  ( 135)**                                  189
**    Operand PEDAZO-VALNOM is not declared                                                                      189
  7550                  ADD 1 TO BLOQOK-AUX-VALNOM                                                  VALNOM       193
*  12-S*******************************************                     ( 135)**                                  194
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  194
  7551                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                       VALNOM       194
*  12-S********************************************                    ( 135)**                                  194
**    Operand VM-OK-VALNOM is not declared                                                                       194
  7553                  MOVE 21 TO J-VALNOM                                                         VALNOM       196
*  12-S************************************                            ( 135)**                                  197
**    Operand J-VALNOM is not declared                                                                           197
  7554                  ADD 1 TO I-VALNOM                                                           VALNOM       197
*  12-S**********************************                              ( 135)**                                  198
**    Operand I-VALNOM is not declared                                                                           198
  7555                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)                                    VALNOM       198
*  12-S***********************************************                 ( 135)**                                  198
**    Operand VM-INPUT-VALNOM is not declared                                                                    198
  7556               END-IF                                                                         VALNOM       199
* 564-S********************                                            ( 135)**                                  200
**    A scope-delimiter did not have a matching verb and was discarded.                                          200
  7557            END-IF                                                                            VALNOM       200
* 564-S*****************                                               ( 135)**                                  201
**    A scope-delimiter did not have a matching verb and was discarded.                                          201
  7558         END-IF                                                                               VALNOM       201
* 564-S**************                                                  ( 135)**                                  202
**    A scope-delimiter did not have a matching verb and was discarded.                                          202
  7559         ADD 1 TO J-VALNOM                                                                    VALNOM       202
*  12-S*************************                                       ( 135)**                                  204
**    Operand J-VALNOM is not declared                                                                           204
  7560       END-PERFORM                                                                            VALNOM       203
* 564-S*****************                                               ( 135)**                                  204
**    A scope-delimiter did not have a matching verb and was discarded.                                          204
  7561       ADD 1 TO I-VALNOM                                                                      VALNOM       204
*  12-S***********************                                         ( 135)**                                  205
**    Operand I-VALNOM is not declared                                                                           205
  7562       IF I-VALNOM = 21                                                                       VALNOM       205
*  12-S*****************                                               ( 135)**                                  205
**    Operand I-VALNOM is not declared                                                                           205
  7564       END-IF                                                                                 VALNOM       207
* 564-S************                                                    ( 135)**                                  208
**    A scope-delimiter did not have a matching verb and was discarded.                                          208
  7565     END-PERFORM.                                                                             VALNOM       208
* 564-S***************                                                 ( 135)**                                  208
**    A scope-delimiter did not have a matching verb and was discarded.                                          208
  7566     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                             VALNOM       209
*  12-S************************                                        ( 136)**                                  209
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  209
  7567        MOVE 1 TO MATCH-OK-OUT-VALNOM                                                         VALNOM       210
*  12-S************************************                            ( 136)**                                  212
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                212
  7569        IF TIP-ID-INPUT-VALNOM <> 2                                                           VALNOM       212
*  12-S*****************************                                   ( 136)**                                  212
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                212
  7571        ELSE                                                                                  VALNOM       214
* 562-S***********                                                     ( 136)**                                  215
**    An "ELSE" phrase did not have a matching IF and was discarded.                                             215
  7573        END-IF                                                                                VALNOM       216
* 564-S*************                                                   ( 136)**                                  217
**    A scope-delimiter did not have a matching verb and was discarded.                                          217
  7574        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                          VALNOM       217
*  12-S***************************                                     ( 136)**                                  217
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  217
  7575           MOVE 1 TO MATCH-OK-OUT-VALNOM                                                      VALNOM       218
*  12-S***************************************                         ( 136)**                                  220
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                220
  7576        END-IF                                                                                VALNOM       219
* 564-S*************                                                   ( 136)**                                  220
**    A scope-delimiter did not have a matching verb and was discarded.                                          220
  7577     END-IF.                                                                                  VALNOM       220
* 564-S**********                                                      ( 136)**                                  220
**    A scope-delimiter did not have a matching verb and was discarded.                                          220
  7585     IF BLOQOK-AUX-VALNOM > 0                                                                 VALNOM       228
*  12-S************************                                        ( 136)**                                  228
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  228
  7586        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       229
*  12-S**********************************                              ( 136)**                                  230
**    Operand APROX-TOT-VALNOM is not declared                                                                   230
  7588        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       231
*  12-S**********************************                              ( 136)**                                  232
**    Operand APROX-TOT-VALNOM is not declared                                                                   232
  7589     END-IF                                                                                   VALNOM       232
* 564-S**********                                                      ( 136)**                                  233
**    A scope-delimiter did not have a matching verb and was discarded.                                          233
  7590     MOVE 1 TO I-VALNOM.                                                                      VALNOM       233
*  12-S**********************                                          ( 136)**                                  233
**    Operand I-VALNOM is not declared                                                                           233
  7591     PERFORM UNTIL I-VALNOM > 10                                                              VALNOM       234
*  12-S**************************                                      ( 136)**                                  234
**    Operand I-VALNOM is not declared                                                                           234
  7592       MOVE 1 TO J-VALNOM                                                                     VALNOM       235
*  12-S************************                                        ( 136)**                                  236
**    Operand J-VALNOM is not declared                                                                           236
  7593       PERFORM UNTIL J-VALNOM > 10                                                            VALNOM       236
*  12-S****************************                                    ( 137)**                                  236
**    Operand J-VALNOM is not declared                                                                           236
  7594         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM                                         VALNOM       237
*  12-S**********************************                              ( 137)**                                  238
**    Operand LETRAS-OK-VALNOM is not declared                                                                   238
  7595         MOVE 1 TO K-VALNOM                                                                   VALNOM       238
*  12-S**************************                                      ( 137)**                                  239
**    Operand K-VALNOM is not declared                                                                           239
  7596         MOVE 1 TO L-VALNOM                                                                   VALNOM       239
*  12-S**************************                                      ( 137)**                                  240
**    Operand L-VALNOM is not declared                                                                           240
  7597         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND                                        VALNOM       240
*  12-S**************************                                      ( 137)**                                  240
**    Operand VM-INPUT-VALNOM is not declared                                                                    240
  7599            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       242
*  12-S*********************************                               ( 137)**                                  242
**    Operand K-VALNOM is not declared                                                                           242
  7600              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       243
*  12-S********************************                                ( 137)**                                  243
**    Operand VMM-INPUT-VALNOM is not declared                                                                   243
  7605                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES                             VALNOM       248
*  12-S********************************                                ( 137)**                                  248
**    Operand VMM-OK-VALNOM is not declared                                                                      248
  7606                    ADD 1 TO LETRAS-OK-VALNOM                                                 VALNOM       249
*  12-S********************************************                    ( 137)**                                  250
**    Operand LETRAS-OK-VALNOM is not declared                                                                   250
  7607                    ADD 1 TO K-VALNOM                                                         VALNOM       250
*  12-S************************************                            ( 137)**                                  251
**    Operand K-VALNOM is not declared                                                                           251
  7608                    ADD 1 TO L-VALNOM                                                         VALNOM       251
*  12-S************************************                            ( 137)**                                  253
**    Operand L-VALNOM is not declared                                                                           253
  7610                    MOVE 19 TO K-VALNOM                                                       VALNOM       253
*  12-S**************************************                          ( 137)**                                  255
**    Operand K-VALNOM is not declared                                                                           255
  7611                 END-IF                                                                       VALNOM       254
* 564-S**********************                                          ( 137)**                                  255
**    A scope-delimiter did not have a matching verb and was discarded.                                          255
  7613                 ADD 1   TO K-VALNOM                                                          VALNOM       256
*  12-S***********************************                             ( 137)**                                  257
**    Operand K-VALNOM is not declared                                                                           257
  7614                 IF K-VALNOM <= 15 AND L-VALNOM < 15                                          VALNOM       257
*  12-S***************************                                     ( 137)**                                  257
**    Operand K-VALNOM is not declared                                                                           257
  7615                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =                              VALNOM       258
*  12-S**************************************                          ( 137)**                                  258
**    Operand VMM-INPUT-VALNOM is not declared                                                                   258
  7617                       ADD 1 TO L-VALNOM                                                      VALNOM       260
*  12-S***************************************                         ( 137)**                                  262
**    Operand L-VALNOM is not declared                                                                           262
  7618                    END-IF                                                                    VALNOM       261
* 564-S*************************                                       ( 138)**                                  262
**    A scope-delimiter did not have a matching verb and was discarded.                                          262
  7619                 END-IF                                                                       VALNOM       262
* 564-S**********************                                          ( 138)**                                  263
**    A scope-delimiter did not have a matching verb and was discarded.                                          263
  7620              END-IF                                                                          VALNOM       263
* 564-S*******************                                             ( 138)**                                  264
**    A scope-delimiter did not have a matching verb and was discarded.                                          264
  7621            END-PERFORM                                                                       VALNOM       264
* 564-S**********************                                          ( 138)**                                  265
**    A scope-delimiter did not have a matching verb and was discarded.                                          265
  7622            MOVE 1 TO K-VALNOM                                                                VALNOM       265
*  12-S*****************************                                   ( 138)**                                  266
**    Operand K-VALNOM is not declared                                                                           266
  7623            MOVE 1 TO L-VALNOM                                                                VALNOM       266
*  12-S*****************************                                   ( 138)**                                  267
**    Operand L-VALNOM is not declared                                                                           267
  7624            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       267
*  12-S*********************************                               ( 138)**                                  267
**    Operand K-VALNOM is not declared                                                                           267
  7625              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       268
*  12-S********************************                                ( 138)**                                  268
**    Operand VMM-INPUT-VALNOM is not declared                                                                   268
  7630                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES                            VALNOM       273
*  12-S********************************                                ( 138)**                                  273
**    Operand VMM-OK-VALNOM is not declared                                                                      273
  7631                    ADD 1 TO LETRAS-OK2-VALNOM                                                VALNOM       274
*  12-S*********************************************                   ( 138)**                                  275
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  275
  7632                    ADD 1 TO K-VALNOM                                                         VALNOM       275
*  12-S************************************                            ( 138)**                                  276
**    Operand K-VALNOM is not declared                                                                           276
  7633                    ADD 1 TO L-VALNOM                                                         VALNOM       276
*  12-S************************************                            ( 138)**                                  278
**    Operand L-VALNOM is not declared                                                                           278
  7635                    MOVE 19 TO K-VALNOM                                                       VALNOM       278
*  12-S**************************************                          ( 138)**                                  280
**    Operand K-VALNOM is not declared                                                                           280
  7636                 END-IF                                                                       VALNOM       279
* 564-S**********************                                          ( 138)**                                  280
**    A scope-delimiter did not have a matching verb and was discarded.                                          280
  7638                 ADD 1   TO L-VALNOM                                                          VALNOM       281
*  12-S***********************************                             ( 138)**                                  282
**    Operand L-VALNOM is not declared                                                                           282
  7639                 IF L-VALNOM <= 15 AND K-VALNOM < 15                                          VALNOM       282
*  12-S***************************                                     ( 138)**                                  282
**    Operand L-VALNOM is not declared                                                                           282
  7640                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                  VALNOM       283
*  12-S**************************************                          ( 138)**                                  283
**    Operand VMM-INPUT-VALNOM is not declared                                                                   283
  7642                       ADD 1 TO K-VALNOM                                                      VALNOM       285
*  12-S***************************************                         ( 139)**                                  287
**    Operand K-VALNOM is not declared                                                                           287
  7643                    END-IF                                                                    VALNOM       286
* 564-S*************************                                       ( 139)**                                  287
**    A scope-delimiter did not have a matching verb and was discarded.                                          287
  7644                 END-IF                                                                       VALNOM       287
* 564-S**********************                                          ( 139)**                                  288
**    A scope-delimiter did not have a matching verb and was discarded.                                          288
  7645              END-IF                                                                          VALNOM       288
* 564-S*******************                                             ( 139)**                                  289
**    A scope-delimiter did not have a matching verb and was discarded.                                          289
  7646            END-PERFORM                                                                       VALNOM       289
* 564-S**********************                                          ( 139)**                                  290
**    A scope-delimiter did not have a matching verb and was discarded.                                          290
  7647         END-IF                                                                               VALNOM       290
* 564-S**************                                                  ( 139)**                                  291
**    A scope-delimiter did not have a matching verb and was discarded.                                          291
  7648         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM                                              VALNOM       291
*  12-S****************************                                    ( 139)**                                  291
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  291
  7649            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM                                        VALNOM       292
*  12-S*********************************                               ( 139)**                                  292
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  292
  7650         END-IF                                                                               VALNOM       293
* 564-S**************                                                  ( 139)**                                  294
**    A scope-delimiter did not have a matching verb and was discarded.                                          294
  7651         IF LETRAS-OK-VALNOM > 0                                                              VALNOM       294
*  12-S***************************                                     ( 139)**                                  294
**    Operand LETRAS-OK-VALNOM is not declared                                                                   294
  7652            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM                                      VALNOM       295
*  12-S**************************************                          ( 139)**                                  296
**    Operand TOTLET-INP-VALNOM is not declared                                                                  296
  7653            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING                                        VALNOM       296
*  12-S**********************************                              ( 139)**                                  296
**    Operand VM-INPUT-VALNOM is not declared                                                                    296
  7656            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING                                        VALNOM       299
*  12-S*******************************                                 ( 139)**                                  299
**    Operand VM-OK-VALNOM is not declared                                                                       299
  7659            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM                                          VALNOM       302
*  12-S***********************************                             ( 139)**                                  303
**    Operand POR-TOT-VALNOM is not declared                                                                     303
  7660            IF TOTLET-OK-VALNOM >= 3                                                          VALNOM       303
*  12-S******************************                                  ( 139)**                                  303
**    Operand TOTLET-OK-VALNOM is not declared                                                                   303
  7661               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       304
*  12-S************************************                            ( 139)**                                  304
**    Operand POR-TOT-VALNOM is not declared                                                                     304
  7663            END-IF                                                                            VALNOM       306
* 564-S*****************                                               ( 139)**                                  307
**    A scope-delimiter did not have a matching verb and was discarded.                                          307
  7664            IF TOTLET-INP-VALNOM >= 3                                                         VALNOM       307
*  12-S*******************************                                 ( 140)**                                  307
**    Operand TOTLET-INP-VALNOM is not declared                                                                  307
  7665               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       308
*  12-S************************************                            ( 140)**                                  308
**    Operand POR-INP-VALNOM is not declared                                                                     308
  7667            END-IF                                                                            VALNOM       310
* 564-S*****************                                               ( 140)**                                  311
**    A scope-delimiter did not have a matching verb and was discarded.                                          311
  7668            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM                                           VALNOM       311
*  12-S******************************                                  ( 140)**                                  311
**    Operand TOTLET-OK-VALNOM is not declared                                                                   311
  7669               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /                                   VALNOM       312
*  12-S******************************                                  ( 140)**                                  312
**    Operand A-VALNOM is not declared                                                                           312
  7672               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /                                   VALNOM       315
*  12-S******************************                                  ( 140)**                                  315
**    Operand A-VALNOM is not declared                                                                           315
  7674            END-IF                                                                            VALNOM       317
* 564-S*****************                                               ( 140)**                                  318
**    A scope-delimiter did not have a matching verb and was discarded.                                          318
  7675            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=                                        VALNOM       318
*  12-S******************************                                  ( 140)**                                  318
**    Operand POR-TOT-VALNOM is not declared                                                                     318
  7685               ADD 1 TO BLOQOK-AUX-VALNOM                                                     VALNOM       328
*  12-S****************************************                        ( 140)**                                  329
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  329
  7686               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                          VALNOM       329
*  12-S*****************************************                       ( 140)**                                  329
**    Operand VM-OK-VALNOM is not declared                                                                       329
  7688            END-IF                                                                            VALNOM       331
* 564-S*****************                                               ( 140)**                                  332
**    A scope-delimiter did not have a matching verb and was discarded.                                          332
  7689         END-IF                                                                               VALNOM       332
* 564-S**************                                                  ( 140)**                                  333
**    A scope-delimiter did not have a matching verb and was discarded.                                          333
  7690         ADD 1 TO J-VALNOM                                                                    VALNOM       333
*  12-S*************************                                       ( 140)**                                  335
**    Operand J-VALNOM is not declared                                                                           335
  7691       END-PERFORM                                                                            VALNOM       334
* 564-S*****************                                               ( 140)**                                  335
**    A scope-delimiter did not have a matching verb and was discarded.                                          335
  7692       ADD 1 TO I-VALNOM                                                                      VALNOM       335
*  12-S***********************                                         ( 140)**                                  336
**    Operand I-VALNOM is not declared                                                                           336
  7693     END-PERFORM.                                                                             VALNOM       336
* 564-S***************                                                 ( 141)**                                  336
**    A scope-delimiter did not have a matching verb and was discarded.                                          336
  7701   MOVE ZEROS TO TOTLET-INP-VALNOM                                                            VALNOM       344
*  12-S*********************************                               ( 141)**                                  345
**    Operand TOTLET-INP-VALNOM is not declared                                                                  345
  7702   MOVE ZEROS TO LETRAS-OK2-VALNOM                                                            VALNOM       345
*  12-S*********************************                               ( 141)**                                  346
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  346
  7703    MOVE ZEROS TO A-VALNOM                                        GJC0003                     VALNOM       346
*  12-S*************************                                       ( 141)**                                  347
**    Operand A-VALNOM is not declared                                                                           347
  7704   MOVE 1 TO K-VALNOM                                                                         VALNOM       347
*  12-S********************                                            ( 141)**                                  348
**    Operand K-VALNOM is not declared                                                                           348
  7705   PERFORM UNTIL K-VALNOM > 65                                                                VALNOM       348
*  12-S************************                                        ( 141)**                                  348
**    Operand K-VALNOM is not declared                                                                           348
  7706     MOVE K-VALNOM  TO I-VALNOM                                                               VALNOM       349
*  12-S*****************                                               ( 141)**                                  349
**    Operand K-VALNOM is not declared                                                                           349
  7707     MOVE 1       TO J-VALNOM                                                                 VALNOM       350
*  12-S****************************                                    ( 141)**                                  351
**    Operand J-VALNOM is not declared                                                                           351
  7708     MOVE ZEROS TO LETRAS-OK-VALNOM                                                           VALNOM       351
*  12-S**********************************                              ( 141)**                                  352
**    Operand LETRAS-OK-VALNOM is not declared                                                                   352
  7709     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65                                             VALNOM       352
*  12-S**************************                                      ( 141)**                                  352
**    Operand J-VALNOM is not declared                                                                           352
  7710        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                            VALNOM       353
*  12-S*************************                                       ( 141)**                                  353
**    Operand V-NOMBRE-VALNOM is not declared                                                                    353
  7712           IF V-NOMBRE-VALNOM(I-VALNOM) =                                                     VALNOM       355
*  12-S****************************                                    ( 141)**                                  355
**    Operand V-NOMBRE-VALNOM is not declared                                                                    355
  7714              ADD 1 TO LETRAS-OK-VALNOM                                                       VALNOM       357
*  12-S**************************************                          ( 141)**                                  358
**    Operand LETRAS-OK-VALNOM is not declared                                                                   358
  7715              ADD 1 TO I-VALNOM                                                               VALNOM       358
*  12-S******************************                                  ( 141)**                                  359
**    Operand I-VALNOM is not declared                                                                           359
  7716              ADD 1 TO J-VALNOM                                                               VALNOM       359
*  12-S******************************                                  ( 141)**                                  361
**    Operand J-VALNOM is not declared                                                                           361
  7718              ADD 1 TO J-VALNOM                                                               VALNOM       361
*  12-S******************************                                  ( 141)**                                  363
**    Operand J-VALNOM is not declared                                                                           363
  7719           END-IF                                                                             VALNOM       362
* 564-S****************                                                ( 142)**                                  363
**    A scope-delimiter did not have a matching verb and was discarded.                                          363
  7721           ADD 1 TO I-VALNOM                                                                  VALNOM       364
*  12-S***************************                                     ( 142)**                                  366
**    Operand I-VALNOM is not declared                                                                           366
  7722        END-IF                                                                                VALNOM       365
* 564-S*************                                                   ( 142)**                                  366
**    A scope-delimiter did not have a matching verb and was discarded.                                          366
  7723     END-PERFORM                                                                              VALNOM       366
* 564-S***************                                                 ( 142)**                                  367
**    A scope-delimiter did not have a matching verb and was discarded.                                          367
  7724     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM                                                  VALNOM       367
*  12-S***********************                                         ( 142)**                                  367
**    Operand LETRAS-OK-VALNOM is not declared                                                                   367
  7725        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM                                            VALNOM       368
*  12-S****************************                                    ( 142)**                                  368
**    Operand LETRAS-OK-VALNOM is not declared                                                                   368
  7726     END-IF                                                                                   VALNOM       369
* 564-S**********                                                      ( 142)**                                  370
**    A scope-delimiter did not have a matching verb and was discarded.                                          370
  7727     ADD 1 TO K-VALNOM                                                                        VALNOM       370
*  12-S*********************                                           ( 142)**                                  371
**    Operand K-VALNOM is not declared                                                                           371
  7728   END-PERFORM.                                                                               VALNOM       371
* 564-S*************                                                   ( 142)**                                  371
**    A scope-delimiter did not have a matching verb and was discarded.                                          371
  7729   MOVE 1 TO I-VALNOM                                                                         VALNOM       372
*  12-S********************                                            ( 142)**                                  373
**    Operand I-VALNOM is not declared                                                                           373
  7730   PERFORM UNTIL I-VALNOM > 65                                                                VALNOM       373
*  12-S************************                                        ( 142)**                                  373
**    Operand I-VALNOM is not declared                                                                           373
  7731     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                               VALNOM       374
*  12-S**********************                                          ( 142)**                                  374
**    Operand V-NOMBRE-VALNOM is not declared                                                                    374
  7733        ADD 1 TO TOTLET-INP-VALNOM                                                            VALNOM       376
*  12-S*********************************                               ( 142)**                                  378
**    Operand TOTLET-INP-VALNOM is not declared                                                                  378
  7734     END-IF                                                                                   VALNOM       377
* 564-S**********                                                      ( 142)**                                  378
**    A scope-delimiter did not have a matching verb and was discarded.                                          378
  7735     ADD 1 TO I-VALNOM                                                                        VALNOM       378
*  12-S*********************                                           ( 142)**                                  379
**    Operand I-VALNOM is not declared                                                                           379
  7736   END-PERFORM.                                                                               VALNOM       379
* 564-S*************                                                   ( 142)**                                  379
**    A scope-delimiter did not have a matching verb and was discarded.                                          379
  7737   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /                                               VALNOM       380
*  12-S******************                                              ( 142)**                                  380
**    Operand A-VALNOM is not declared                                                                           380
  7739   IF A-VALNOM >= 75                                                                          VALNOM       382
*  12-S*************                                                   ( 142)**                                  382
**    Operand A-VALNOM is not declared                                                                           382
  7740       ADD 1 TO BLOQOK-AUX-VALNOM                                                             VALNOM       383
*  12-S********************************                                ( 143)**                                  384
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  384
  7741   END-IF.                                                                                    VALNOM       384
* 564-S********                                                        ( 143)**                                  384
**    A scope-delimiter did not have a matching verb and was discarded.                                          384
  7742    MOVE 0 TO K-VALNOM                                            GJC0003                     VALNOM       385
*  12-S*********************                                           ( 143)**                                  386
**    Operand K-VALNOM is not declared                                                                           386
  7743   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003                     VALNOM       386
*  12-S**********************                                          ( 143)**                                  386
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  386
  7744      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003                     VALNOM       387
*  12-S************************                                        ( 143)**                                  387
**    Operand A-VALNOM is not declared                                                                           387
  7745      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003                     VALNOM       388
*  12-S*****************************                                   ( 143)**                                  388
**    Operand J-VALNOM is not declared                                                                           388
  7746               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       389
*  12-S********************************                                ( 143)**                                  389
**    Operand V-NOMBRE-VALNOM is not declared                                                                    389
  7747                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003                     VALNOM       390
*  12-S*************************************************               ( 143)**                                  390
**    Operand V-NOMBRE-VALNOM is not declared                                                                    390
  7749                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003                     VALNOM       392
*  12-S**********************************************                  ( 143)**                                  392
**    Operand CONT-LET-INPUT-VALNOM is not declared                                                              392
  7750              END-IF                                              GJC0003                     VALNOM       393
* 564-S*******************                                             ( 143)**                                  394
**    A scope-delimiter did not have a matching verb and was discarded.                                          394
  7751               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       394
*  12-S********************************                                ( 143)**                                  394
**    Operand V-NOMBOK-VALNOM is not declared                                                                    394
  7752                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003                     VALNOM       395
*  12-S*************************************************               ( 143)**                                  395
**    Operand V-NOMBOK-VALNOM is not declared                                                                    395
  7754                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003                     VALNOM       397
*  12-S*******************************************                     ( 143)**                                  397
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 397
  7755              END-IF                                              GJC0003                     VALNOM       398
* 564-S*******************                                             ( 143)**                                  399
**    A scope-delimiter did not have a matching verb and was discarded.                                          399
  7756      END-PERFORM                                                 GJC0003                     VALNOM       399
* 564-S****************                                                ( 143)**                                  400
**    A scope-delimiter did not have a matching verb and was discarded.                                          400
  7757      MOVE 0 TO I-VALNOM                                          GJC0003                     VALNOM       400
*  12-S***********************                                         ( 143)**                                  401
**    Operand I-VALNOM is not declared                                                                           401
  7758       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003                     VALNOM       401
*  12-S******************************                                  ( 143)**                                  401
**    Operand J-VALNOM is not declared                                                                           401
  7759         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003                     VALNOM       402
*  12-S*****************************                                   ( 143)**                                  402
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 402
  7760            ADD 1 TO I-VALNOM                                     GJC0003                     VALNOM       403
*  12-S****************************                                    ( 143)**                                  404
**    Operand I-VALNOM is not declared                                                                           404
  7761            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003                     VALNOM       404
*  12-S********************************                                ( 144)**                                  404
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 404
  7763               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003                     VALNOM       406
*  12-S******************************                                  ( 144)**                                  406
**    Operand L-VALNOM is not declared                                                                           406
  7765               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003                     VALNOM       408
*  12-S******************************                                  ( 144)**                                  408
**    Operand L-VALNOM is not declared                                                                           408
  7768            END-IF                                                GJC0003                     VALNOM       411
* 564-S*****************                                               ( 144)**                                  412
**    A scope-delimiter did not have a matching verb and was discarded.                                          412
  7769         END-IF                                                   GJC0003                     VALNOM       412
* 564-S**************                                                  ( 144)**                                  413
**    A scope-delimiter did not have a matching verb and was discarded.                                          413
  7770      END-PERFORM                                                 GJC0003                     VALNOM       413
* 564-S****************                                                ( 144)**                                  414
**    A scope-delimiter did not have a matching verb and was discarded.                                          414
  7771      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003                     VALNOM       414
*  12-S*********************                                           ( 144)**                                  414
**    Operand K-VALNOM is not declared                                                                           414
  7772       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003                     VALNOM       415
*  12-S******************                                              ( 144)**                                  415
**    Operand A-VALNOM is not declared                                                                           415
  7775         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003                     VALNOM       418
*  12-S**********************************                              ( 144)**                                  420
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  420
  7776       END-IF                                                     GJC0003                     VALNOM       419
* 564-S************                                                    ( 144)**                                  420
**    A scope-delimiter did not have a matching verb and was discarded.                                          420
  7777   END-IF.                                                        GJC0003                     VALNOM       420
* 564-S********                                                        ( 144)**                                  420
**    A scope-delimiter did not have a matching verb and was discarded.                                          420
* Total Messages:   252
* Unrecoverable :     0                    Severe  :   252
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1421908     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>fg
vi
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD
******************************************************************
FD JURAD.
01  JURAD-reg.
* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.
*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-embargos-fecha-ultimo pic x(8).*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.:%s/  *$//1422 substitutions add 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:w"CARGAJUR.CBL" 1598 lines, 66868 characters [1] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fufgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
  3577                 MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM                                                     1465
*  12-S****************************************************            (   0)**                                 1466
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                               1466
  3578                 MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM                                          1466
*  12-S*************************************************************** (  63)**                                 1467
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                               1467
  3579                 MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM                                                    1467
*  12-S*****************************************************           (  63)**                                 1468
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                               1468
  3580                 MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                                        1468
*  12-S****************************************************************(  63)**                                 1469
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                              1469
  3582                 IF MATCH-OK-OUT-VALNOM = 1                                                               1470
*  12-S**************************************                          (  63)**                                 1470
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                               1470
  3592     END-IF.                                                                                              1480
* 564-S**********                                                      (  63)**                                 1480
**    A scope-delimiter did not have a matching verb and was discarded.                                         1480
  3652    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM                                    BDIIVIDE      40
* 301-S*********************************************************       (  64)**                                   42
**    Unrecognized verb                                                                                           42
  3683          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM                                        BDIIVIDE      71
*  12-S*****************************************************           (  65)**                                   72
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 72
  3684          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM                                         BDIIVIDE      72
*  12-S****************************************************            (  65)**                                   73
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                 73
  3685          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM                                        BDIIVIDE      73
*  12-S*****************************************************           (  65)**                                   74
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                 74
  3689                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                             BDIIVIDE      77
*  12-S****************************************************************(  65)**                                   78
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                78
  3690             ELSE IF TIP-ID-INPUT-VALNOM = 1                                                  BDIIVIDE      78
*  12-S***************************************                         (  65)**                                   78
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 78
  3691                     MOVE 2 TO BLOQUES-INPUT-VALNOM                                           BDIIVIDE      79
*  12-S**************************************************              (  66)**                                   80
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                80
  3692                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM                                         BDIIVIDE      80
*  12-S****************************************************            (  66)**                                   82
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                82
  3696             IF MATCH-OK-OUT-VALNOM = 0                                                       BDIIVIDE      84
*  12-S**********************************                              (  66)**                                   84
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                 84
  3701      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002                     BDIIVIDE      89
* 562-S*********                                                       (  66)**                                   89
**    An "ELSE" phrase did not have a matching IF and was discarded.                                              89
  3704      END-IF                                                      FAC0002                     BDIIVIDE      92
* 564-S***********                                                     (  66)**                                   93
**    A scope-delimiter did not have a matching verb and was discarded.                                           93
  3706    END-IF.                                                                                   BDIIVIDE      94
* 564-S*********                                                       (  66)**                                   94
**    A scope-delimiter did not have a matching verb and was discarded.                                           94
".............COMPILANDO BDLDIR SIN MATCH **********
  6882       MOVE 0 TO MATCH-OK-OUT-VALNOM                                                          BDAMATCH     727
*  12-S***********************************                             (  66)**                                  728
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                728
  6885               OR MATCH-OK-OUT-VALNOM = 1                                                     BDAMATCH     730
*  12-S************************************                            ( 121)**                                  730
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                730
  6887              NOMBRE-INPUT-VALNOM                                                             BDAMATCH     732
*  12-S********************************                                ( 121)**                                  733
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                733
  6889              NOMBOK-INPUT-VALNOM                                                             BDAMATCH     734
*  12-S********************************                                ( 121)**                                  735
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                735
  6893               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     738
*  12-S*******************************************                     ( 121)**                                  739
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                739
  6894               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     739
*  12-S********************************************                    ( 121)**                                  741
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               741
  6896               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     741
*  12-S*******************************************                     ( 121)**                                  742
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                742
  6897               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     742
*  12-S********************************************                    ( 121)**                                  744
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               744
  6900            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004                     BDAMATCH     745
*  12-S****************************************                        ( 121)**                                  746
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                746
  6901            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     746
*  12-S*****************************************                       ( 121)**                                  748
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               748
  6903         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004                     BDAMATCH     748
*  12-S******************************                                  ( 121)**                                  748
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                748
  6905            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     750
*  12-S*****************************************                       ( 121)**                                  752
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               752
  6906         END-IF                                                   RMB0004                     BDAMATCH     751
* 564-S**************                                                  ( 122)**                                  752
**    A scope-delimiter did not have a matching verb and was discarded.                                          752
  6908         IF MATCH-OK-OUT-VALNOM = 1                                                           BDAMATCH     753
*  12-S******************************                                  ( 122)**                                  753
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                753
  6915            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004                     BDAMATCH     760
*  12-S**********************************                              ( 122)**                                  760
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               760
  6917            END-IF                                                RMB0004                     BDAMATCH     762
* 564-S*****************                                               ( 122)**                                  763
**    A scope-delimiter did not have a matching verb and was discarded.                                          763
  6930         END-IF                                                                               BDAMATCH     775
* 564-S**************                                                  ( 122)**                                  776
**    A scope-delimiter did not have a matching verb and was discarded.                                          776
  6933       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO                                             BDAMATCH     778
*  12-S****************************                                    ( 122)**                                  778
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                778
  6952       ELSE                                                    *>                             BDAMATCH     797
* 562-S**********                                                      ( 122)**                                  797
**    An "ELSE" phrase did not have a matching IF and was discarded.                                             797
  6955       END-IF                                                                                 BDAMATCH     800
* 564-S************                                                    ( 123)**                                  801
**    A scope-delimiter did not have a matching verb and was discarded.                                          801
  6957     END-PERFORM.                                                                             BDAMATCH     802
* 564-S***************                                                 ( 123)**                                  802
**    A scope-delimiter did not have a matching verb and was discarded.                                          802
  7399     MOVE 0 TO MATCH-OK-OUT-VALNOM.                                                           VALNOM        42
*  12-S*********************************                               ( 123)**                                   42
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                 42
  7400     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM        43
*  12-S****************************                                    ( 130)**                                   43
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                 43
  7401     IF TIP-ID-INPUT-VALNOM  = 2                                                              VALNOM        44
*  12-S**************************                                      ( 130)**                                   44
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 44
  7402         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                              VALNOM        45
*  12-S*********************************                               ( 130)**                                   45
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   45
  7413         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM        56
*  12-S*********************************                               ( 131)**                                   56
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   56
  7424         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        67
*  12-S*********************************                               ( 131)**                                   67
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   67
  7428         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        71
*  12-S*********************************                               ( 131)**                                   71
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   71
  7432         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM                                        VALNOM        75
*  12-S******************************                                  ( 131)**                                   75
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   75
  7434        INSPECT CADENA-VALNOM    REPLACING ALL                                                VALNOM        77
*  12-S****************************                                    ( 131)**                                   77
**    Operand CADENA-VALNOM is not declared                                                                       77
  7440        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002                     VALNOM        83
*  12-S****************************                                    ( 131)**                                   83
**    Operand CADENA-VALNOM is not declared                                                                       83
  7446                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM        89
*  12-S***************************************                         ( 131)**                                   89
**    Operand I-VALNOM is not declared                                                                            89
  7448                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM        91
*  12-S***********************************                             ( 132)**                                   91
**    Operand VNOM-AUX-VALNOM is not declared                                                                     91
  7450                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM        93
*  12-S***********************************************                 ( 132)**                                   93
**    Operand VNOM-AUX-VALNOM is not declared                                                                     93
  7451                  END-IF                                                                      VALNOM        94
* 564-S***********************                                         ( 132)**                                   95
**    A scope-delimiter did not have a matching verb and was discarded.                                           95
  7452                END-PERFORM                                                                   VALNOM        95
* 564-S**************************                                      ( 132)**                                   96
**    A scope-delimiter did not have a matching verb and was discarded.                                           96
  7453     END-IF.                                                                                  VALNOM        96
* 564-S**********                                                      ( 132)**                                   96
**    A scope-delimiter did not have a matching verb and was discarded.                                           96
  7454     MOVE SPACES TO VECTOR-INPUT-VALNOM.                                                      VALNOM        97
*  12-S**************************************                          ( 132)**                                   97
**    Operand VECTOR-INPUT-VALNOM is not declared                                                                 97
  7455     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM        98
*  12-S**************************                                      ( 132)**                                   98
**    Operand CADENA-VALNOM is not declared                                                                       98
  7468     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM       111
*  12-S****************************                                    ( 132)**                                  111
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                111
  7469     IF TIP-ID-INPUT-VALNOM  NOT = 2                                                          VALNOM       112
*  12-S**************************                                      ( 132)**                                  112
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                112
  7470        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                               VALNOM       113
*  12-S********************************                                ( 132)**                                  113
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  113
  7474                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM       117
*  12-S***************************************                         ( 132)**                                  117
**    Operand I-VALNOM is not declared                                                                           117
  7476                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM       119
*  12-S***********************************                             ( 132)**                                  119
**    Operand VNOM-AUX-VALNOM is not declared                                                                    119
  7478                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM       121
*  12-S***********************************************                 ( 132)**                                  121
**    Operand VNOM-AUX-VALNOM is not declared                                                                    121
  7479                  END-IF                                                                      VALNOM       122
* 564-S***********************                                         ( 133)**                                  123
**    A scope-delimiter did not have a matching verb and was discarded.                                          123
  7480                END-PERFORM                                                                   VALNOM       123
* 564-S**************************                                      ( 133)**                                  124
**    A scope-delimiter did not have a matching verb and was discarded.                                          124
  7482         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       125
*  12-S*********************************                               ( 133)**                                  125
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  125
  7493         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       136
*  12-S*********************************                               ( 133)**                                  136
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  136
  7504        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003                     VALNOM       147
*  12-S********************************                                ( 133)**                                  147
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  147
  7508         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM                                        VALNOM       151
*  12-S******************************                                  ( 133)**                                  151
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  151
  7509     END-IF.                                                                                  VALNOM       152
* 564-S**********                                                      ( 133)**                                  152
**    A scope-delimiter did not have a matching verb and was discarded.                                          152
  7510     MOVE SPACES TO VECTOR-OK-VALNOM.                                                         VALNOM       153
*  12-S***********************************                             ( 133)**                                  153
**    Operand VECTOR-OK-VALNOM is not declared                                                                   153
  7511     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM       154
*  12-S**************************                                      ( 133)**                                  154
**    Operand CADENA-VALNOM is not declared                                                                      154
  7522     MOVE 1 TO I-VALNOM.                                                                      VALNOM       165
*  12-S**********************                                          ( 133)**                                  165
**    Operand I-VALNOM is not declared                                                                           165
  7523     MOVE 0 TO BLOQOK-AUX-VALNOM.                                                             VALNOM       166
*  12-S*******************************                                 ( 134)**                                  166
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  166
  7524     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES                                         VALNOM       167
*  12-S*********************************                               ( 134)**                                  167
**    Operand VM-INPUT-VALNOM is not declared                                                                    167
  7525       MOVE 1 TO J-VALNOM                                                                     VALNOM       168
*  12-S************************                                        ( 134)**                                  169
**    Operand J-VALNOM is not declared                                                                           169
  7526       PERFORM UNTIL J-VALNOM > 20                                                            VALNOM       169
*  12-S****************************                                    ( 134)**                                  169
**    Operand J-VALNOM is not declared                                                                           169
  7527         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)                                VALNOM       170
*  12-S**************************                                      ( 134)**                                  170
**    Operand VM-INPUT-VALNOM is not declared                                                                    170
  7528            ADD 1 TO BLOQOK-AUX-VALNOM                                                        VALNOM       171
*  12-S*************************************                           ( 134)**                                  172
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  172
  7529            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                             VALNOM       172
*  12-S**************************************                          ( 134)**                                  172
**    Operand VM-OK-VALNOM is not declared                                                                       172
  7531            MOVE 21 TO J-VALNOM                                                               VALNOM       174
*  12-S******************************                                  ( 134)**                                  176
**    Operand J-VALNOM is not declared                                                                           176
  7533            MOVE 0 TO M-VALNOM                                                                VALNOM       176
*  12-S*****************************                                   ( 134)**                                  177
**    Operand M-VALNOM is not declared                                                                           177
  7534            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                                  VALNOM       177
*  12-S*******************************                                 ( 134)**                                  177
**    Operand VM-OK-VALNOM is not declared                                                                       177
  7536            IF M-VALNOM >= 15                                                                 VALNOM       179
*  12-S**********************                                          ( 134)**                                  179
**    Operand M-VALNOM is not declared                                                                           179
  7537               MOVE 0 TO M-VALNOM                                                             VALNOM       180
*  12-S********************************                                ( 134)**                                  181
**    Operand M-VALNOM is not declared                                                                           181
  7538               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                               VALNOM       181
*  12-S**********************************                              ( 134)**                                  181
**    Operand VM-OK-VALNOM is not declared                                                                       181
  7540            END-IF                                                                            VALNOM       183
* 564-S*****************                                               ( 134)**                                  184
**    A scope-delimiter did not have a matching verb and was discarded.                                          184
  7541            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20                                        VALNOM       184
*  12-S**********************                                          ( 134)**                                  184
**    Operand M-VALNOM is not declared                                                                           184
  7543               COMPUTE INI-VALNOM = M-VALNOM + 2                                              VALNOM       186
*  12-S********************************                                ( 134)**                                  186
**    Operand INI-VALNOM is not declared                                                                         186
  7544               COMPUTE LON-VALNOM = 14 - M-VALNOM                                             VALNOM       187
*  12-S********************************                                ( 135)**                                  187
**    Operand LON-VALNOM is not declared                                                                         187
  7545               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM                                   VALNOM       188
*  12-S*******************************                                 ( 135)**                                  188
**    Operand VM-OK-VALNOM is not declared                                                                       188
  7546               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =                                      VALNOM       189
*  12-S******************************                                  ( 135)**                                  189
**    Operand PEDAZO-VALNOM is not declared                                                                      189
  7550                  ADD 1 TO BLOQOK-AUX-VALNOM                                                  VALNOM       193
*  12-S*******************************************                     ( 135)**                                  194
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  194
  7551                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                       VALNOM       194
*  12-S********************************************                    ( 135)**                                  194
**    Operand VM-OK-VALNOM is not declared                                                                       194
  7553                  MOVE 21 TO J-VALNOM                                                         VALNOM       196
*  12-S************************************                            ( 135)**                                  197
**    Operand J-VALNOM is not declared                                                                           197
  7554                  ADD 1 TO I-VALNOM                                                           VALNOM       197
*  12-S**********************************                              ( 135)**                                  198
**    Operand I-VALNOM is not declared                                                                           198
  7555                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)                                    VALNOM       198
*  12-S***********************************************                 ( 135)**                                  198
**    Operand VM-INPUT-VALNOM is not declared                                                                    198
  7556               END-IF                                                                         VALNOM       199
* 564-S********************                                            ( 135)**                                  200
**    A scope-delimiter did not have a matching verb and was discarded.                                          200
  7557            END-IF                                                                            VALNOM       200
* 564-S*****************                                               ( 135)**                                  201
**    A scope-delimiter did not have a matching verb and was discarded.                                          201
  7558         END-IF                                                                               VALNOM       201
* 564-S**************                                                  ( 135)**                                  202
**    A scope-delimiter did not have a matching verb and was discarded.                                          202
  7559         ADD 1 TO J-VALNOM                                                                    VALNOM       202
*  12-S*************************                                       ( 135)**                                  204
**    Operand J-VALNOM is not declared                                                                           204
  7560       END-PERFORM                                                                            VALNOM       203
* 564-S*****************                                               ( 135)**                                  204
**    A scope-delimiter did not have a matching verb and was discarded.                                          204
  7561       ADD 1 TO I-VALNOM                                                                      VALNOM       204
*  12-S***********************                                         ( 135)**                                  205
**    Operand I-VALNOM is not declared                                                                           205
  7562       IF I-VALNOM = 21                                                                       VALNOM       205
*  12-S*****************                                               ( 135)**                                  205
**    Operand I-VALNOM is not declared                                                                           205
  7564       END-IF                                                                                 VALNOM       207
* 564-S************                                                    ( 135)**                                  208
**    A scope-delimiter did not have a matching verb and was discarded.                                          208
  7565     END-PERFORM.                                                                             VALNOM       208
* 564-S***************                                                 ( 135)**                                  208
**    A scope-delimiter did not have a matching verb and was discarded.                                          208
  7566     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                             VALNOM       209
*  12-S************************                                        ( 136)**                                  209
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  209
  7567        MOVE 1 TO MATCH-OK-OUT-VALNOM                                                         VALNOM       210
*  12-S************************************                            ( 136)**                                  212
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                212
  7569        IF TIP-ID-INPUT-VALNOM <> 2                                                           VALNOM       212
*  12-S*****************************                                   ( 136)**                                  212
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                212
  7571        ELSE                                                                                  VALNOM       214
* 562-S***********                                                     ( 136)**                                  215
**    An "ELSE" phrase did not have a matching IF and was discarded.                                             215
  7573        END-IF                                                                                VALNOM       216
* 564-S*************                                                   ( 136)**                                  217
**    A scope-delimiter did not have a matching verb and was discarded.                                          217
  7574        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                          VALNOM       217
*  12-S***************************                                     ( 136)**                                  217
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  217
  7575           MOVE 1 TO MATCH-OK-OUT-VALNOM                                                      VALNOM       218
*  12-S***************************************                         ( 136)**                                  220
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                220
  7576        END-IF                                                                                VALNOM       219
* 564-S*************                                                   ( 136)**                                  220
**    A scope-delimiter did not have a matching verb and was discarded.                                          220
  7577     END-IF.                                                                                  VALNOM       220
* 564-S**********                                                      ( 136)**                                  220
**    A scope-delimiter did not have a matching verb and was discarded.                                          220
  7585     IF BLOQOK-AUX-VALNOM > 0                                                                 VALNOM       228
*  12-S************************                                        ( 136)**                                  228
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  228
  7586        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       229
*  12-S**********************************                              ( 136)**                                  230
**    Operand APROX-TOT-VALNOM is not declared                                                                   230
  7588        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       231
*  12-S**********************************                              ( 136)**                                  232
**    Operand APROX-TOT-VALNOM is not declared                                                                   232
  7589     END-IF                                                                                   VALNOM       232
* 564-S**********                                                      ( 136)**                                  233
**    A scope-delimiter did not have a matching verb and was discarded.                                          233
  7590     MOVE 1 TO I-VALNOM.                                                                      VALNOM       233
*  12-S**********************                                          ( 136)**                                  233
**    Operand I-VALNOM is not declared                                                                           233
  7591     PERFORM UNTIL I-VALNOM > 10                                                              VALNOM       234
*  12-S**************************                                      ( 136)**                                  234
**    Operand I-VALNOM is not declared                                                                           234
  7592       MOVE 1 TO J-VALNOM                                                                     VALNOM       235
*  12-S************************                                        ( 136)**                                  236
**    Operand J-VALNOM is not declared                                                                           236
  7593       PERFORM UNTIL J-VALNOM > 10                                                            VALNOM       236
*  12-S****************************                                    ( 137)**                                  236
**    Operand J-VALNOM is not declared                                                                           236
  7594         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM                                         VALNOM       237
*  12-S**********************************                              ( 137)**                                  238
**    Operand LETRAS-OK-VALNOM is not declared                                                                   238
  7595         MOVE 1 TO K-VALNOM                                                                   VALNOM       238
*  12-S**************************                                      ( 137)**                                  239
**    Operand K-VALNOM is not declared                                                                           239
  7596         MOVE 1 TO L-VALNOM                                                                   VALNOM       239
*  12-S**************************                                      ( 137)**                                  240
**    Operand L-VALNOM is not declared                                                                           240
  7597         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND                                        VALNOM       240
*  12-S**************************                                      ( 137)**                                  240
**    Operand VM-INPUT-VALNOM is not declared                                                                    240
  7599            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       242
*  12-S*********************************                               ( 137)**                                  242
**    Operand K-VALNOM is not declared                                                                           242
  7600              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       243
*  12-S********************************                                ( 137)**                                  243
**    Operand VMM-INPUT-VALNOM is not declared                                                                   243
  7605                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES                             VALNOM       248
*  12-S********************************                                ( 137)**                                  248
**    Operand VMM-OK-VALNOM is not declared                                                                      248
  7606                    ADD 1 TO LETRAS-OK-VALNOM                                                 VALNOM       249
*  12-S********************************************                    ( 137)**                                  250
**    Operand LETRAS-OK-VALNOM is not declared                                                                   250
  7607                    ADD 1 TO K-VALNOM                                                         VALNOM       250
*  12-S************************************                            ( 137)**                                  251
**    Operand K-VALNOM is not declared                                                                           251
  7608                    ADD 1 TO L-VALNOM                                                         VALNOM       251
*  12-S************************************                            ( 137)**                                  253
**    Operand L-VALNOM is not declared                                                                           253
  7610                    MOVE 19 TO K-VALNOM                                                       VALNOM       253
*  12-S**************************************                          ( 137)**                                  255
**    Operand K-VALNOM is not declared                                                                           255
  7611                 END-IF                                                                       VALNOM       254
* 564-S**********************                                          ( 137)**                                  255
**    A scope-delimiter did not have a matching verb and was discarded.                                          255
  7613                 ADD 1   TO K-VALNOM                                                          VALNOM       256
*  12-S***********************************                             ( 137)**                                  257
**    Operand K-VALNOM is not declared                                                                           257
  7614                 IF K-VALNOM <= 15 AND L-VALNOM < 15                                          VALNOM       257
*  12-S***************************                                     ( 137)**                                  257
**    Operand K-VALNOM is not declared                                                                           257
  7615                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =                              VALNOM       258
*  12-S**************************************                          ( 137)**                                  258
**    Operand VMM-INPUT-VALNOM is not declared                                                                   258
  7617                       ADD 1 TO L-VALNOM                                                      VALNOM       260
*  12-S***************************************                         ( 137)**                                  262
**    Operand L-VALNOM is not declared                                                                           262
  7618                    END-IF                                                                    VALNOM       261
* 564-S*************************                                       ( 138)**                                  262
**    A scope-delimiter did not have a matching verb and was discarded.                                          262
  7619                 END-IF                                                                       VALNOM       262
* 564-S**********************                                          ( 138)**                                  263
**    A scope-delimiter did not have a matching verb and was discarded.                                          263
  7620              END-IF                                                                          VALNOM       263
* 564-S*******************                                             ( 138)**                                  264
**    A scope-delimiter did not have a matching verb and was discarded.                                          264
  7621            END-PERFORM                                                                       VALNOM       264
* 564-S**********************                                          ( 138)**                                  265
**    A scope-delimiter did not have a matching verb and was discarded.                                          265
  7622            MOVE 1 TO K-VALNOM                                                                VALNOM       265
*  12-S*****************************                                   ( 138)**                                  266
**    Operand K-VALNOM is not declared                                                                           266
  7623            MOVE 1 TO L-VALNOM                                                                VALNOM       266
*  12-S*****************************                                   ( 138)**                                  267
**    Operand L-VALNOM is not declared                                                                           267
  7624            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       267
*  12-S*********************************                               ( 138)**                                  267
**    Operand K-VALNOM is not declared                                                                           267
  7625              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       268
*  12-S********************************                                ( 138)**                                  268
**    Operand VMM-INPUT-VALNOM is not declared                                                                   268
  7630                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES                            VALNOM       273
*  12-S********************************                                ( 138)**                                  273
**    Operand VMM-OK-VALNOM is not declared                                                                      273
  7631                    ADD 1 TO LETRAS-OK2-VALNOM                                                VALNOM       274
*  12-S*********************************************                   ( 138)**                                  275
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  275
  7632                    ADD 1 TO K-VALNOM                                                         VALNOM       275
*  12-S************************************                            ( 138)**                                  276
**    Operand K-VALNOM is not declared                                                                           276
  7633                    ADD 1 TO L-VALNOM                                                         VALNOM       276
*  12-S************************************                            ( 138)**                                  278
**    Operand L-VALNOM is not declared                                                                           278
  7635                    MOVE 19 TO K-VALNOM                                                       VALNOM       278
*  12-S**************************************                          ( 138)**                                  280
**    Operand K-VALNOM is not declared                                                                           280
  7636                 END-IF                                                                       VALNOM       279
* 564-S**********************                                          ( 138)**                                  280
**    A scope-delimiter did not have a matching verb and was discarded.                                          280
  7638                 ADD 1   TO L-VALNOM                                                          VALNOM       281
*  12-S***********************************                             ( 138)**                                  282
**    Operand L-VALNOM is not declared                                                                           282
  7639                 IF L-VALNOM <= 15 AND K-VALNOM < 15                                          VALNOM       282
*  12-S***************************                                     ( 138)**                                  282
**    Operand L-VALNOM is not declared                                                                           282
  7640                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                  VALNOM       283
*  12-S**************************************                          ( 138)**                                  283
**    Operand VMM-INPUT-VALNOM is not declared                                                                   283
  7642                       ADD 1 TO K-VALNOM                                                      VALNOM       285
*  12-S***************************************                         ( 139)**                                  287
**    Operand K-VALNOM is not declared                                                                           287
  7643                    END-IF                                                                    VALNOM       286
* 564-S*************************                                       ( 139)**                                  287
**    A scope-delimiter did not have a matching verb and was discarded.                                          287
  7644                 END-IF                                                                       VALNOM       287
* 564-S**********************                                          ( 139)**                                  288
**    A scope-delimiter did not have a matching verb and was discarded.                                          288
  7645              END-IF                                                                          VALNOM       288
* 564-S*******************                                             ( 139)**                                  289
**    A scope-delimiter did not have a matching verb and was discarded.                                          289
  7646            END-PERFORM                                                                       VALNOM       289
* 564-S**********************                                          ( 139)**                                  290
**    A scope-delimiter did not have a matching verb and was discarded.                                          290
  7647         END-IF                                                                               VALNOM       290
* 564-S**************                                                  ( 139)**                                  291
**    A scope-delimiter did not have a matching verb and was discarded.                                          291
  7648         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM                                              VALNOM       291
*  12-S****************************                                    ( 139)**                                  291
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  291
  7649            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM                                        VALNOM       292
*  12-S*********************************                               ( 139)**                                  292
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  292
  7650         END-IF                                                                               VALNOM       293
* 564-S**************                                                  ( 139)**                                  294
**    A scope-delimiter did not have a matching verb and was discarded.                                          294
  7651         IF LETRAS-OK-VALNOM > 0                                                              VALNOM       294
*  12-S***************************                                     ( 139)**                                  294
**    Operand LETRAS-OK-VALNOM is not declared                                                                   294
  7652            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM                                      VALNOM       295
*  12-S**************************************                          ( 139)**                                  296
**    Operand TOTLET-INP-VALNOM is not declared                                                                  296
  7653            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING                                        VALNOM       296
*  12-S**********************************                              ( 139)**                                  296
**    Operand VM-INPUT-VALNOM is not declared                                                                    296
  7656            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING                                        VALNOM       299
*  12-S*******************************                                 ( 139)**                                  299
**    Operand VM-OK-VALNOM is not declared                                                                       299
  7659            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM                                          VALNOM       302
*  12-S***********************************                             ( 139)**                                  303
**    Operand POR-TOT-VALNOM is not declared                                                                     303
  7660            IF TOTLET-OK-VALNOM >= 3                                                          VALNOM       303
*  12-S******************************                                  ( 139)**                                  303
**    Operand TOTLET-OK-VALNOM is not declared                                                                   303
  7661               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       304
*  12-S************************************                            ( 139)**                                  304
**    Operand POR-TOT-VALNOM is not declared                                                                     304
  7663            END-IF                                                                            VALNOM       306
* 564-S*****************                                               ( 139)**                                  307
**    A scope-delimiter did not have a matching verb and was discarded.                                          307
  7664            IF TOTLET-INP-VALNOM >= 3                                                         VALNOM       307
*  12-S*******************************                                 ( 140)**                                  307
**    Operand TOTLET-INP-VALNOM is not declared                                                                  307
  7665               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       308
*  12-S************************************                            ( 140)**                                  308
**    Operand POR-INP-VALNOM is not declared                                                                     308
  7667            END-IF                                                                            VALNOM       310
* 564-S*****************                                               ( 140)**                                  311
**    A scope-delimiter did not have a matching verb and was discarded.                                          311
  7668            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM                                           VALNOM       311
*  12-S******************************                                  ( 140)**                                  311
**    Operand TOTLET-OK-VALNOM is not declared                                                                   311
  7669               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /                                   VALNOM       312
*  12-S******************************                                  ( 140)**                                  312
**    Operand A-VALNOM is not declared                                                                           312
  7672               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /                                   VALNOM       315
*  12-S******************************                                  ( 140)**                                  315
**    Operand A-VALNOM is not declared                                                                           315
  7674            END-IF                                                                            VALNOM       317
* 564-S*****************                                               ( 140)**                                  318
**    A scope-delimiter did not have a matching verb and was discarded.                                          318
  7675            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=                                        VALNOM       318
*  12-S******************************                                  ( 140)**                                  318
**    Operand POR-TOT-VALNOM is not declared                                                                     318
  7685               ADD 1 TO BLOQOK-AUX-VALNOM                                                     VALNOM       328
*  12-S****************************************                        ( 140)**                                  329
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  329
  7686               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                          VALNOM       329
*  12-S*****************************************                       ( 140)**                                  329
**    Operand VM-OK-VALNOM is not declared                                                                       329
  7688            END-IF                                                                            VALNOM       331
* 564-S*****************                                               ( 140)**                                  332
**    A scope-delimiter did not have a matching verb and was discarded.                                          332
  7689         END-IF                                                                               VALNOM       332
* 564-S**************                                                  ( 140)**                                  333
**    A scope-delimiter did not have a matching verb and was discarded.                                          333
  7690         ADD 1 TO J-VALNOM                                                                    VALNOM       333
*  12-S*************************                                       ( 140)**                                  335
**    Operand J-VALNOM is not declared                                                                           335
  7691       END-PERFORM                                                                            VALNOM       334
* 564-S*****************                                               ( 140)**                                  335
**    A scope-delimiter did not have a matching verb and was discarded.                                          335
  7692       ADD 1 TO I-VALNOM                                                                      VALNOM       335
*  12-S***********************                                         ( 140)**                                  336
**    Operand I-VALNOM is not declared                                                                           336
  7693     END-PERFORM.                                                                             VALNOM       336
* 564-S***************                                                 ( 141)**                                  336
**    A scope-delimiter did not have a matching verb and was discarded.                                          336
  7701   MOVE ZEROS TO TOTLET-INP-VALNOM                                                            VALNOM       344
*  12-S*********************************                               ( 141)**                                  345
**    Operand TOTLET-INP-VALNOM is not declared                                                                  345
  7702   MOVE ZEROS TO LETRAS-OK2-VALNOM                                                            VALNOM       345
*  12-S*********************************                               ( 141)**                                  346
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  346
  7703    MOVE ZEROS TO A-VALNOM                                        GJC0003                     VALNOM       346
*  12-S*************************                                       ( 141)**                                  347
**    Operand A-VALNOM is not declared                                                                           347
  7704   MOVE 1 TO K-VALNOM                                                                         VALNOM       347
*  12-S********************                                            ( 141)**                                  348
**    Operand K-VALNOM is not declared                                                                           348
  7705   PERFORM UNTIL K-VALNOM > 65                                                                VALNOM       348
*  12-S************************                                        ( 141)**                                  348
**    Operand K-VALNOM is not declared                                                                           348
  7706     MOVE K-VALNOM  TO I-VALNOM                                                               VALNOM       349
*  12-S*****************                                               ( 141)**                                  349
**    Operand K-VALNOM is not declared                                                                           349
  7707     MOVE 1       TO J-VALNOM                                                                 VALNOM       350
*  12-S****************************                                    ( 141)**                                  351
**    Operand J-VALNOM is not declared                                                                           351
  7708     MOVE ZEROS TO LETRAS-OK-VALNOM                                                           VALNOM       351
*  12-S**********************************                              ( 141)**                                  352
**    Operand LETRAS-OK-VALNOM is not declared                                                                   352
  7709     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65                                             VALNOM       352
*  12-S**************************                                      ( 141)**                                  352
**    Operand J-VALNOM is not declared                                                                           352
  7710        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                            VALNOM       353
*  12-S*************************                                       ( 141)**                                  353
**    Operand V-NOMBRE-VALNOM is not declared                                                                    353
  7712           IF V-NOMBRE-VALNOM(I-VALNOM) =                                                     VALNOM       355
*  12-S****************************                                    ( 141)**                                  355
**    Operand V-NOMBRE-VALNOM is not declared                                                                    355
  7714              ADD 1 TO LETRAS-OK-VALNOM                                                       VALNOM       357
*  12-S**************************************                          ( 141)**                                  358
**    Operand LETRAS-OK-VALNOM is not declared                                                                   358
  7715              ADD 1 TO I-VALNOM                                                               VALNOM       358
*  12-S******************************                                  ( 141)**                                  359
**    Operand I-VALNOM is not declared                                                                           359
  7716              ADD 1 TO J-VALNOM                                                               VALNOM       359
*  12-S******************************                                  ( 141)**                                  361
**    Operand J-VALNOM is not declared                                                                           361
  7718              ADD 1 TO J-VALNOM                                                               VALNOM       361
*  12-S******************************                                  ( 141)**                                  363
**    Operand J-VALNOM is not declared                                                                           363
  7719           END-IF                                                                             VALNOM       362
* 564-S****************                                                ( 142)**                                  363
**    A scope-delimiter did not have a matching verb and was discarded.                                          363
  7721           ADD 1 TO I-VALNOM                                                                  VALNOM       364
*  12-S***************************                                     ( 142)**                                  366
**    Operand I-VALNOM is not declared                                                                           366
  7722        END-IF                                                                                VALNOM       365
* 564-S*************                                                   ( 142)**                                  366
**    A scope-delimiter did not have a matching verb and was discarded.                                          366
  7723     END-PERFORM                                                                              VALNOM       366
* 564-S***************                                                 ( 142)**                                  367
**    A scope-delimiter did not have a matching verb and was discarded.                                          367
  7724     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM                                                  VALNOM       367
*  12-S***********************                                         ( 142)**                                  367
**    Operand LETRAS-OK-VALNOM is not declared                                                                   367
  7725        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM                                            VALNOM       368
*  12-S****************************                                    ( 142)**                                  368
**    Operand LETRAS-OK-VALNOM is not declared                                                                   368
  7726     END-IF                                                                                   VALNOM       369
* 564-S**********                                                      ( 142)**                                  370
**    A scope-delimiter did not have a matching verb and was discarded.                                          370
  7727     ADD 1 TO K-VALNOM                                                                        VALNOM       370
*  12-S*********************                                           ( 142)**                                  371
**    Operand K-VALNOM is not declared                                                                           371
  7728   END-PERFORM.                                                                               VALNOM       371
* 564-S*************                                                   ( 142)**                                  371
**    A scope-delimiter did not have a matching verb and was discarded.                                          371
  7729   MOVE 1 TO I-VALNOM                                                                         VALNOM       372
*  12-S********************                                            ( 142)**                                  373
**    Operand I-VALNOM is not declared                                                                           373
  7730   PERFORM UNTIL I-VALNOM > 65                                                                VALNOM       373
*  12-S************************                                        ( 142)**                                  373
**    Operand I-VALNOM is not declared                                                                           373
  7731     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                               VALNOM       374
*  12-S**********************                                          ( 142)**                                  374
**    Operand V-NOMBRE-VALNOM is not declared                                                                    374
  7733        ADD 1 TO TOTLET-INP-VALNOM                                                            VALNOM       376
*  12-S*********************************                               ( 142)**                                  378
**    Operand TOTLET-INP-VALNOM is not declared                                                                  378
  7734     END-IF                                                                                   VALNOM       377
* 564-S**********                                                      ( 142)**                                  378
**    A scope-delimiter did not have a matching verb and was discarded.                                          378
  7735     ADD 1 TO I-VALNOM                                                                        VALNOM       378
*  12-S*********************                                           ( 142)**                                  379
**    Operand I-VALNOM is not declared                                                                           379
  7736   END-PERFORM.                                                                               VALNOM       379
* 564-S*************                                                   ( 142)**                                  379
**    A scope-delimiter did not have a matching verb and was discarded.                                          379
  7737   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /                                               VALNOM       380
*  12-S******************                                              ( 142)**                                  380
**    Operand A-VALNOM is not declared                                                                           380
  7739   IF A-VALNOM >= 75                                                                          VALNOM       382
*  12-S*************                                                   ( 142)**                                  382
**    Operand A-VALNOM is not declared                                                                           382
  7740       ADD 1 TO BLOQOK-AUX-VALNOM                                                             VALNOM       383
*  12-S********************************                                ( 143)**                                  384
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  384
  7741   END-IF.                                                                                    VALNOM       384
* 564-S********                                                        ( 143)**                                  384
**    A scope-delimiter did not have a matching verb and was discarded.                                          384
  7742    MOVE 0 TO K-VALNOM                                            GJC0003                     VALNOM       385
*  12-S*********************                                           ( 143)**                                  386
**    Operand K-VALNOM is not declared                                                                           386
  7743   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003                     VALNOM       386
*  12-S**********************                                          ( 143)**                                  386
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  386
  7744      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003                     VALNOM       387
*  12-S************************                                        ( 143)**                                  387
**    Operand A-VALNOM is not declared                                                                           387
  7745      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003                     VALNOM       388
*  12-S*****************************                                   ( 143)**                                  388
**    Operand J-VALNOM is not declared                                                                           388
  7746               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       389
*  12-S********************************                                ( 143)**                                  389
**    Operand V-NOMBRE-VALNOM is not declared                                                                    389
  7747                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003                     VALNOM       390
*  12-S*************************************************               ( 143)**                                  390
**    Operand V-NOMBRE-VALNOM is not declared                                                                    390
  7749                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003                     VALNOM       392
*  12-S**********************************************                  ( 143)**                                  392
**    Operand CONT-LET-INPUT-VALNOM is not declared                                                              392
  7750              END-IF                                              GJC0003                     VALNOM       393
* 564-S*******************                                             ( 143)**                                  394
**    A scope-delimiter did not have a matching verb and was discarded.                                          394
  7751               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       394
*  12-S********************************                                ( 143)**                                  394
**    Operand V-NOMBOK-VALNOM is not declared                                                                    394
  7752                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003                     VALNOM       395
*  12-S*************************************************               ( 143)**                                  395
**    Operand V-NOMBOK-VALNOM is not declared                                                                    395
  7754                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003                     VALNOM       397
*  12-S*******************************************                     ( 143)**                                  397
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 397
  7755              END-IF                                              GJC0003                     VALNOM       398
* 564-S*******************                                             ( 143)**                                  399
**    A scope-delimiter did not have a matching verb and was discarded.                                          399
  7756      END-PERFORM                                                 GJC0003                     VALNOM       399
* 564-S****************                                                ( 143)**                                  400
**    A scope-delimiter did not have a matching verb and was discarded.                                          400
  7757      MOVE 0 TO I-VALNOM                                          GJC0003                     VALNOM       400
*  12-S***********************                                         ( 143)**                                  401
**    Operand I-VALNOM is not declared                                                                           401
  7758       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003                     VALNOM       401
*  12-S******************************                                  ( 143)**                                  401
**    Operand J-VALNOM is not declared                                                                           401
  7759         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003                     VALNOM       402
*  12-S*****************************                                   ( 143)**                                  402
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 402
  7760            ADD 1 TO I-VALNOM                                     GJC0003                     VALNOM       403
*  12-S****************************                                    ( 143)**                                  404
**    Operand I-VALNOM is not declared                                                                           404
  7761            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003                     VALNOM       404
*  12-S********************************                                ( 144)**                                  404
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 404
  7763               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003                     VALNOM       406
*  12-S******************************                                  ( 144)**                                  406
**    Operand L-VALNOM is not declared                                                                           406
  7765               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003                     VALNOM       408
*  12-S******************************                                  ( 144)**                                  408
**    Operand L-VALNOM is not declared                                                                           408
  7768            END-IF                                                GJC0003                     VALNOM       411
* 564-S*****************                                               ( 144)**                                  412
**    A scope-delimiter did not have a matching verb and was discarded.                                          412
  7769         END-IF                                                   GJC0003                     VALNOM       412
* 564-S**************                                                  ( 144)**                                  413
**    A scope-delimiter did not have a matching verb and was discarded.                                          413
  7770      END-PERFORM                                                 GJC0003                     VALNOM       413
* 564-S****************                                                ( 144)**                                  414
**    A scope-delimiter did not have a matching verb and was discarded.                                          414
  7771      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003                     VALNOM       414
*  12-S*********************                                           ( 144)**                                  414
**    Operand K-VALNOM is not declared                                                                           414
  7772       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003                     VALNOM       415
*  12-S******************                                              ( 144)**                                  415
**    Operand A-VALNOM is not declared                                                                           415
  7775         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003                     VALNOM       418
*  12-S**********************************                              ( 144)**                                  420
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  420
  7776       END-IF                                                     GJC0003                     VALNOM       419
* 564-S************                                                    ( 144)**                                  420
**    A scope-delimiter did not have a matching verb and was discarded.                                          420
  7777   END-IF.                                                        GJC0003                     VALNOM       420
* 564-S********                                                        ( 144)**                                  420
**    A scope-delimiter did not have a matching verb and was discarded.                                          420
* Total Messages:   252
* Unrecoverable :     0                    Severe  :   252
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1421908     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>fu                                                /d/iccol/desarrollo/fuentes>fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2              /d/iccol/desarrollo/fuentes>te                                  /d/iccol/desarrollo/fuentes>fgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                          /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>fg
vi
add 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
 

OPEN MODEiuywer.******************************************************************









 










 $CHANGE MODEZZZ:w"CARGAJUR.CBL" 1598 lines, 66870 characters [1] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgdes-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURdes-c-v .CARGAJUR/CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/./CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/./CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE ./CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>find / -^[  /d/iccol/desarrollo/fuentes>find / -des-c-v ./CARGAJURdes-c-v CARGAJUR  fg              des-c-v CARGAJURcob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>fu                                                /d/iccol/desarrollo/fuentes>fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2              /d/iccol/desarrollo/fuentes>te                                  /d/iccol/desarrollo/fuentes>fgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 17:55 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 17:55 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211202 Jun 12 17:55 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 17:55 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 17:55 /d/iccol/desarrollo/objetos/CARGAJUR.s
45034  200 -rw-rw-r--   1 icjlud   icdatacr   194152 Jun 12 10:33 /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL
 7608   66 -rw-rw-r--   1 icdgd    icdatacr    66870 Jun 12 17:54 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
45055  992 -rw-rw-r--   1 icjlud   icdatacr  1006330 Jun 12 17:53 /d/iccol/desarrollo/fuentes/CARGAJUR.lst
45056  328 -rw-rw-r--   1 icjlud   icdatacr   326144 Jun 12 17:53 /d/iccol/desarrollo/fuentes/CARGAJUR.idy
123726  992 -rw-rw-r--   1 icjlud   icdatacr  1006327 Jun 12 17:52 /d/iccol/desarrollo/temporales/CARGAJUR.lst
123773  328 -rw-rw-r--   1 icjlud   icdatacr   326144 Jun 12 17:52 /d/iccol/desarrollo/temporales/CARGAJUR.idy
/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/objetos/CARGAJUR.idy /d/iccol/desarrollo/objetos/CARGAJUR.int /d/iccol/desarrollo/objetos/CARGAJUR.lst /d/iccol/desarrollo/objetos/CARGAJUR.gnt /d/iccol/desarrollo/objetos/CARGAJUR.s /d/iccol/desarrollo/fuentes/CARGAJURZZZ.CBL /d/icco^C
/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^C
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>find / -name "CARGAJUR*" -ls  2> /dev/null/d/iccol/desarrollo/fuentes>                                          /d/iccol/desarrollo/fuentes>