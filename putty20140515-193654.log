=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.15 19:36:54 =~=~=~=~=~=~=~=~=~=~=~=
login as: icdgd
Using keyboard-interactive authentication.
Password: 
Last login: Thu May 15 17:30:24 2014 from 172.16.10.38
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icdgd@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo $fu
/d/iccol/desarrollo $vi CARGAJUR.CBL
"CARGAJUR.CBL" 1656 lines, 75586 characters $SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI"CARGAJUR.CBL" 1656 lines, 75586 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1656 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    ACTALEJUR.



      ******************************************************************
      * Actualización del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-name
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.
      * TODO: debe compilar con file status

      ******************************************************************
      ******************************************************************
       copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
       copy BDIIDAS.FS.


      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record

              file status is EST-BDIIALE.==.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(6).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(6).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con las alertas del sistema

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres de VALNOM.PROC

APPEND MODE      ******************************************************************

APPEND MODE       copy VALNOM.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE       01 VARIABLES-INPUT.

APPEND MODE          03 TIPO-IDE-INP               pic 9.

APPEND MODE          03 NUM-IDE-INP                pic 9(11).

APPEND MODE          03 NOMBRES-INP                pic X(30).

APPEND MODE          03 APELLIDO-PAT-INP           pic X(30).

APPEND MODE          03 APELLIDO-MAT-INP           pic X(30).

APPEND MODE          03 NUM-DEMA-VIG-INP           pic 9(05).

APPEND MODE          03 NUM-DEMA-TER-INP           pic 9(05).

APPEND MODE          03 FEC-DEMA-VIG-INP           pic 9(08).

APPEND MODE          03 TIPO-IDE-INP-X             pic X.

APPEND MODE          03 NUM-IDE-INP-X              pic X(11).

APPEND MODE          03 NUM-DEMA-VIG-INP-X         pic X(05).

APPEND MODE          03 NUM-DEMA-TER-INP-X         pic X(05).

APPEND MODE          03 FEC-DEMA-VIG-INP-X         pic X(08).

APPEND MODE       01 M-ERRORES.

APPEND MODE          03 V-ERR occurs 50 TIMES      pic 9(1).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "SI" para activar 

APPEND MODE      * TODO: fijo en "NO" para pruebas

APPEND MODE           03 P-proceso-real            pic xx value "NO".

APPEND MODE           88 PROCESO-REAL              value "SI".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Código de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Inserción de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificación o eliminación de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un 

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5 

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo: 

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos. 

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamaño del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50) 

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un código de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 80

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificación invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE          02 ANO-VAL-X                   pic 9(04).

APPEND MODE             88 ANO-VAL  value 1900 thru 2050.

APPEND MODE          02 MES-VAL-X                   pic 9(02).

APPEND MODE             88 MES-VAL  value 01   thru 12.

APPEND MODE          02 DIA-VAL-X                   pic 9(02).

APPEND MODE             88 DIA-VAL  value 01   thru 31.

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    6000-SACAR-RESUMEN

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La información está leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T" 

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validación formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    actualizacion de BDIIALE o grabacion en arch ERRS de defectos

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               add 1 to N-reg-con-error

APPEND MODE           else

APPEND MODE               perform 4300-MODIFICAR-BDIIALE

APPEND MODE               add 1 to N-reg-OK

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-demandas-fecha-ultima(1:2) > "50"

APPEND MODE               string "19" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-embargos-fecha-ultimo(1:2) > "50"

APPEND MODE               string "19" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a " 

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones, 

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y 

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero 

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima 

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero 

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyó OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserción de una alerta nueva

APPEND MODE      * Si ya exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro exist\055a es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE 

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificación de una alerta existente

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no exist\055a es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminación de una alerta

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "20" thru "29"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: >>>> implementar la grabación del archivo ERRS

APPEND MODE           display "NO GRABA ERRS".

APPEND MODE 

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    según se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0 

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE               unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE               delimited by all spaces

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE               unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE               delimited by all spaces

APPEND MODE               string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE               LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE               LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE               LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE               LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE               LA-parte(LAx, 10) LA-valor(10)

APPEND MODE               delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso

APPEND MODE           display "Carga de archivo JURAD"

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "command line: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01" *> 01 Envio Original - Carga TOTAL 1a vez

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02" *> 02 Archivo Semanal - Carga PARCIAL

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03" *> 03 Archivo Mensual - Carga PARCIAL

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04" *> 04 Refresque Total - Carga TOTAL

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *       valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD 

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size 

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una decha 50 años posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo jurad "

APPEND MODE                   display "Nombre del archivo: " P-file-name

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string P-file-name(1:19) "_ERRORES.txt" into

APPEND MODE           ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1 

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE               unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE               LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE               LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE               LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE               delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE invalid key

APPEND MODE      *        no hay registros

APPEND MODE               exit paragraph

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas. 

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time.

APPEND MODE      *    leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display "Proceso cancelado"

APPEND MODE           goback.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(80) value low-values.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input                    pic x(80).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input(1:80) not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display reg-input(1:80)

APPEND MODE               move reg-input(1:80) to reg-input-anterior

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program ACTALEJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * De aqu\055 para abajo se puede eliminar, son recortes del programa

APPEND MODE      * ejemplo

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE      *6000-SACAR-RESUMEN.

APPEND MODE      ****************************************************************

APPEND MODE      ****************************************************************

APPEND MODE      *    display "==============[ RESUMEN del PROCESO ]============"

APPEND MODE      *    display "TIPO DE PROCESO             = "   COMANDO(1:10)

APPEND MODE      *    display "DEMANDADOS LEIDOS           = " CONT-LEIDOS

APPEND MODE      *    display "  DEMANDADOS VALIDOS        = " CONT-REGISTROS-OK

APPEND MODE      *    display "    DEMANDADOS CREADOS      = " CONT-WRITE-OK

APPEND MODE      *    display "    DEMANDADOS ACTUALIZADOS = " CONT-REWRITE-OK

APPEND MODE      *    display "    DEMANDADOS ERR CREAR    = " CONT-WRITE-ERR

APPEND MODE      *    display "    DEMANDADOS ERR ACTUALIZ = " CONT-REWRITE-ERR

APPEND MODE      *    display "  DEMANDADOS NO VALIDOS     = " CONT-REGISTROS-ERR

APPEND MODE      *    display "=================================================".

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $vi CARGAJUR.CBLfu             . visetvi CARGAJUR.cblvi CARGAJUR.lstpwd            fu pwd. visetfg     vi ARGAJUR.lstfg            :qvi CARGAJUR.lstls -la CARGAJUR*cob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIREGI SIN status.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN status.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN status.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDIIALE SIN status.........."
  2122         delimited by all spaces
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  2125         delimited by all spaces
* 301-S*****************                                               (  38)**
**    Unrecognized verb
  2127         string LA-parte(LAx, 2) LA-valor(2)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2128         string LA-parte(LAx, 3) LA-valor(3)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2129         string LA-parte(LAx, 4) LA-valor(4)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2130         string LA-parte(LAx, 5) LA-valor(5)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2131         string LA-parte(LAx, 6) LA-valor(6)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2132         string LA-parte(LAx, 7) LA-valor(7)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2133         string LA-parte(LAx, 8) LA-valor(8)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2134         string LA-parte(LAx, 9) LA-valor(9)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2135         string LA-parte(LAx, 10) LA-valor(10)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2137     end-if.
*  14-S**********                                                      (  39)**
**    Invalid operand
  2248         delimited by all "&"
* 301-S*****************                                               (  39)**
**    Unrecognized verb
  3149    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM
*  12-S****************************************                        (  41)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3151    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
*  12-S***************************                                     (  56)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3152    IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  56)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3153       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  57)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3154    END-IF                                                        FAC0002
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3155    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  57)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3156       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  57)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3157    END-IF                                                        FAC0002
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3158    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3159       MOVE ZEROS TO SW-VALTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3160    END-IF                                                        FAC0002
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3161    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERIC                         FAC0003
*  12-S****************************                                    (  57)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3162       MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDE                       FAC0003
*  12-S******************************************                      (  57)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3163    END-IF                                                        FAC0003
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3164    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
*  12-S**********************                                          (  57)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3165      IF SW-ASGTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  57)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3167      END-IF                                                      FAC0002
* 564-S***********                                                     (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3168      IF SW-VALTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3170      END-IF                                                      FAC0002
* 564-S***********                                                     (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3171      IF SW-DIGCHEQUEO-BDIIVIDE = 1                               FAC0004
*  12-S******************************                                  (  57)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3173      END-IF                                                      FAC0004
* 564-S***********                                                     (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3174      IF SW-VALTIPID-BDIIVIDE = 0 OR                              FAC0004
*  12-S****************************                                    (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3177       INITIALIZE NOM-VAL-BDIIVIDE
*  12-S*********************************                               (  58)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3178       MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE
*  12-S*****************************                                   (  58)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3179       IF SW-VERIFNOM-BDIIVIDE = 1
*  12-S*****************************                                   (  58)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3180          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM
*  12-S******************************                                  (  58)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3181          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM
*  12-S*****************************                                   (  58)**
**    Operand NOMBRE-BDIIVIDE is not declared
  3182          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  58)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3183          IF SW-ID-BDIIVIDE = 0
*  12-S**************************                                      (  58)**
**    Operand SW-ID-BDIIVIDE is not declared
  3184             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND
*  12-S***********************************                             (  58)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3186                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
*  12-S****************************************                        (  58)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3187             ELSE IF TIP-ID-INPUT-VALNOM = 1
*  12-S***************************************                         (  58)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3188                     MOVE 2 TO BLOQUES-INPUT-VALNOM
*  12-S**************************************************              (  58)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3189                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM
*  12-S****************************************************            (  58)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3190                  END-IF
* 564-S***********************                                         (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3191             END-IF
* 564-S******************                                              (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3193             IF MATCH-OK-OUT-VALNOM = 0
*  12-S**********************************                              (  58)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3194                MOVE 1 TO SW-NOMBRES-BDIIVIDE
*  12-S********************************************                    (  58)**
**    Operand SW-NOMBRES-BDIIVIDE is not declared
  3195             END-IF
* 564-S******************                                              (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3196          END-IF
* 564-S***************                                                 (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3197       END-IF
* 564-S************                                                    (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3198      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  59)**
**    Operand SW-TID-BDIIVIDE is not declared
  3199              MOVE 1 TO SW-ID-BDIIVIDE                            FAC0002
*  12-S*************************************                           (  59)**
**    Operand SW-ID-BDIIVIDE is not declared
  3200           END-IF                                                 FAC0002
* 564-S****************                                                (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3201      END-IF                                                      FAC0002
* 564-S***********                                                     (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3202    ELSE MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  59)**
**    Operand SW-ID-BDIIVIDE is not declared
  3203    END-IF.
* 564-S*********                                                       (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3213     EVALUATE TIP-IDE-BDIIVIDE
*  12-S*****************************                                   (  59)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3216       WHEN 2
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3218       WHEN 3
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3220       WHEN 4
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3222       WHEN OTHER
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3223         MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  59)**
**    Operand SW-ID-BDIIVIDE is not declared
  3224     END-EVALUATE.
* 564-S****************                                                (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3232    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002
*  12-S****************************************                        (  60)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3233    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  60)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3234      IF (NUM-IDE-BDIIVIDE-R >= 1 AND                             FAC0002
*  12-S***************************                                     (  60)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3238         MOVE 1 TO TIP-IDE-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3240        IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002
*  12-S*****************************                                   (  60)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3244           MOVE 2 TO TIP-IDE-BDIIVIDE                             FAC0002
*  12-S************************************                            (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3250          IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002
*  12-S*******************************                                 (  60)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3254             MOVE 3 TO TIP-IDE-BDIIVIDE                           FAC0002
*  12-S**************************************                          (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3255          ELSE MOVE 4 TO TIP-IDE-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3256          END-IF.                                                 FAC0002
* 564-S***************                                                 (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3266    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3267    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3268    EVALUATE TIP-IDE-BDIIVIDE                                     FAC0002
*  12-S****************************                                    (  61)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3270       IF NUM-IDE-BDIIVIDE-R > 9999999999                         FAC0002
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3271          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3272       END-IF                                                     FAC0002
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3274       IF NUM-IDE-BDIIVIDE-R >  9999999999 OR                     FAC006C
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3276          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3277       END-IF                                                     FAC0002
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3279       IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000           FAC0005
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3280          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3281       END-IF                                                     FAC0002
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3282    END-EVALUATE.                                                 FAC0002
* 564-S***************                                                 (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3290      IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                     FAC0004
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3294          MOVE 3 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  61)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3295      END-IF                                                      FAC0004
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3296      IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                     FAC0004
*  12-S***************************                                     (  62)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3300          MOVE 2 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3301      END-IF                                                      FAC0004
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3302      IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004
*  12-S*************************                                       (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3309          MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDE            FAC0004
*  12-S******************************                                  (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3310          MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R          FAC0004
*  12-S*********************************                               (  62)**
**    Operand NUM-ID-W10-BDIIVIDE is not declared
  3311      END-IF                                                      FAC0004
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3312      INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".          FAC0004
*  12-S*****************************                                   (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3320     MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI
*  12-S*************************                                       (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3321     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI
*  12-S*************************                                       (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3322     READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  62)**
**    Operand BDIIREGI is not declared
*  12-S******************************************************          (  62)**
**    Operand SW-ID-BDIIVIDE is not declared
  3323     END-READ
* 564-S************                                                    (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3324     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  63)**
**    Operand SW-ID-BDIIVIDE is not declared
  3325        MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  63)**
**    Operand APELLIDO1-BDIIREGI is not declared
  3326        MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  63)**
**    Operand APELLIDO2-BDIIREGI is not declared
  3327        MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE
*  12-S********************************                                (  63)**
**    Operand DES-NOMBRE2-BDIIREGI is not declared
  3328        MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE
*  12-S********************************                                (  63)**
**    Operand DES-NOMBRE1-BDIIREGI is not declared
  3329        IF ESTADO-CIVIL-BDIIREGI = 0
*  12-S*******************************                                 (  63)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3331             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  63)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3338         END-IF
* 564-S**************                                                  (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3339         IF ESTADO-CIVIL-BDIIREGI = 1
*  12-S********************************                                (  63)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3343             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  63)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3350         END-IF
* 564-S**************                                                  (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3351         IF ESTADO-CIVIL-BDIIREGI = 2
*  12-S********************************                                (  63)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3355             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  63)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3362         END-IF
* 564-S**************                                                  (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3363         STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S***************************************                         (  64)**
**    Operand PRIMER-APELLIDO-BDIIVIDE is not declared
  3369         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "
*  12-S********************************                                (  64)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3370         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "
*  12-S********************************                                (  64)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3371         INITIALIZE NOM-LEIDO-BDIIVIDE
*  12-S*************************************                           (  64)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3372         MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.
*  12-S*****************************                                   (  64)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3379     MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN
*  12-S*************************                                       (  64)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3380     READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  64)**
**    Operand BDIIDIAN is not declared
*  12-S******************************************************          (  64)**
**    Operand SW-ID-BDIIVIDE is not declared
  3381     END-READ
* 564-S************                                                    (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3382     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  64)**
**    Operand SW-ID-BDIIVIDE is not declared
  3383        MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE
*  12-S********************************                                (  64)**
**    Operand DESCRIPCION-BDIIDIAN is not declared
  3384     END-IF.
* 564-S**********                                                      (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3391     MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS
*  12-S*************************                                       (  65)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3392     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS
*  12-S*************************                                       (  65)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3393     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S****************                                                (  65)**
**    Operand BDIIDAS is not declared
*  12-S*****************************************************           (  65)**
**    Operand SW-ID-BDIIVIDE is not declared
  3394     END-READ
* 564-S************                                                    (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3395     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  65)**
**    Operand SW-ID-BDIIVIDE is not declared
  3396        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.
*  12-S**************************                                      (  65)**
**    Operand NOMBRE-BDIIDAS is not declared
  3439     MOVE 0 TO MATCH-OK-OUT-VALNOM.
*  12-S*********************************                               (  65)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3440     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  66)**
**    Operand NOMBRE-INPUT-VALNOM is not declared
  3441     IF TIP-ID-INPUT-VALNOM  = 2
*  12-S**************************                                      (  66)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3442         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3453         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3464         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3468         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3472         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
*  12-S******************************                                  (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3474        INSPECT CADENA-VALNOM    REPLACING ALL
*  12-S****************************                                    (  67)**
**    Operand CADENA-VALNOM is not declared
  3480        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
*  12-S****************************                                    (  67)**
**    Operand CADENA-VALNOM is not declared
  3486                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  67)**
**    Operand I-VALNOM is not declared
  3488                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  67)**
**    Operand VNOM-AUX-VALNOM is not declared
  3490                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  67)**
**    Operand VNOM-AUX-VALNOM is not declared
  3491                  END-IF
* 564-S***********************                                         (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3492                END-PERFORM
* 564-S**************************                                      (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3493     END-IF.
* 564-S**********                                                      (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3494     MOVE SPACES TO VECTOR-INPUT-VALNOM.
*  12-S**************************************                          (  67)**
**    Operand VECTOR-INPUT-VALNOM is not declared
  3495     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  67)**
**    Operand CADENA-VALNOM is not declared
  3508     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  67)**
**    Operand NOMBOK-INPUT-VALNOM is not declared
  3509     IF TIP-ID-INPUT-VALNOM  NOT = 2
*  12-S**************************                                      (  68)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3510        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S********************************                                (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3514                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  68)**
**    Operand I-VALNOM is not declared
  3516                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  68)**
**    Operand VNOM-AUX-VALNOM is not declared
  3518                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  68)**
**    Operand VNOM-AUX-VALNOM is not declared
  3519                  END-IF
* 564-S***********************                                         (  68)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3520                END-PERFORM
* 564-S**************************                                      (  68)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3522         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3533         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3544        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
*  12-S********************************                                (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3548         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  69)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3549     END-IF.
* 564-S**********                                                      (  69)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3550     MOVE SPACES TO VECTOR-OK-VALNOM.
*  12-S***********************************                             (  69)**
**    Operand VECTOR-OK-VALNOM is not declared
  3551     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  69)**
**    Operand CADENA-VALNOM is not declared
  3562     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  69)**
**    Operand I-VALNOM is not declared
  3563     MOVE 0 TO BLOQOK-AUX-VALNOM.
*  12-S*******************************                                 (  69)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3564     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
*  12-S*********************************                               (  69)**
**    Operand VM-INPUT-VALNOM is not declared
  3565       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  69)**
**    Operand J-VALNOM is not declared
  3566       PERFORM UNTIL J-VALNOM > 20
*  12-S****************************                                    (  69)**
**    Operand J-VALNOM is not declared
  3567         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
*  12-S**************************                                      (  69)**
**    Operand VM-INPUT-VALNOM is not declared
  3568            ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*************************************                           (  69)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3569            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S**************************************                          (  69)**
**    Operand VM-OK-VALNOM is not declared
  3571            MOVE 21 TO J-VALNOM
*  12-S******************************                                  (  69)**
**    Operand J-VALNOM is not declared
  3573            MOVE 0 TO M-VALNOM
*  12-S*****************************                                   (  69)**
**    Operand M-VALNOM is not declared
  3574            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S*******************************                                 (  69)**
**    Operand VM-OK-VALNOM is not declared
  3576            IF M-VALNOM >= 15
*  12-S**********************                                          (  70)**
**    Operand M-VALNOM is not declared
  3577               MOVE 0 TO M-VALNOM
*  12-S********************************                                (  70)**
**    Operand M-VALNOM is not declared
  3578               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S**********************************                              (  70)**
**    Operand VM-OK-VALNOM is not declared
  3580            END-IF
* 564-S*****************                                               (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3581            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
*  12-S**********************                                          (  70)**
**    Operand M-VALNOM is not declared
  3583               COMPUTE INI-VALNOM = M-VALNOM + 2
*  12-S********************************                                (  70)**
**    Operand INI-VALNOM is not declared
  3584               COMPUTE LON-VALNOM = 14 - M-VALNOM
*  12-S********************************                                (  70)**
**    Operand LON-VALNOM is not declared
  3585               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
*  12-S*******************************                                 (  70)**
**    Operand VM-OK-VALNOM is not declared
  3586               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
*  12-S******************************                                  (  70)**
**    Operand PEDAZO-VALNOM is not declared
  3590                  ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*******************************************                     (  70)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3591                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S********************************************                    (  70)**
**    Operand VM-OK-VALNOM is not declared
  3593                  MOVE 21 TO J-VALNOM
*  12-S************************************                            (  70)**
**    Operand J-VALNOM is not declared
  3594                  ADD 1 TO I-VALNOM
*  12-S**********************************                              (  70)**
**    Operand I-VALNOM is not declared
  3595                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  70)**
**    Operand VM-INPUT-VALNOM is not declared
  3596               END-IF
* 564-S********************                                            (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3597            END-IF
* 564-S*****************                                               (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3598         END-IF
* 564-S**************                                                  (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3599         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  71)**
**    Operand J-VALNOM is not declared
  3600       END-PERFORM
* 564-S*****************                                               (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3601       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  71)**
**    Operand I-VALNOM is not declared
  3602       IF I-VALNOM = 21
*  12-S*****************                                               (  71)**
**    Operand I-VALNOM is not declared
  3604       END-IF
* 564-S************                                                    (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3605     END-PERFORM.
* 564-S***************                                                 (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3606     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S************************                                        (  71)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3607        MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S************************************                            (  71)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3609        IF TIP-ID-INPUT-VALNOM <> 2
*  12-S*****************************                                   (  71)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3611        ELSE
* 562-S***********                                                     (  71)**
**    An "ELSE" phrase did not have a matching IF and was discarded.
  3613        END-IF
* 564-S*************                                                   (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3614        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S***************************                                     (  71)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3615           MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S***************************************                         (  71)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3616        END-IF
* 564-S*************                                                   (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3617     END-IF.
* 564-S**********                                                      (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3625     IF BLOQOK-AUX-VALNOM > 0
*  12-S************************                                        (  71)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3626        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  72)**
**    Operand APROX-TOT-VALNOM is not declared
  3628        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  72)**
**    Operand APROX-TOT-VALNOM is not declared
  3629     END-IF
* 564-S**********                                                      (  72)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3630     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  72)**
**    Operand I-VALNOM is not declared
  3631     PERFORM UNTIL I-VALNOM > 10
*  12-S**************************                                      (  72)**
**    Operand I-VALNOM is not declared
  3632       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  72)**
**    Operand J-VALNOM is not declared
  3633       PERFORM UNTIL J-VALNOM > 10
*  12-S****************************                                    (  72)**
**    Operand J-VALNOM is not declared
  3634         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
*  12-S**********************************                              (  72)**
**    Operand LETRAS-OK-VALNOM is not declared
  3635         MOVE 1 TO K-VALNOM
*  12-S**************************                                      (  72)**
**    Operand K-VALNOM is not declared
  3636         MOVE 1 TO L-VALNOM
*  12-S**************************                                      (  72)**
**    Operand L-VALNOM is not declared
  3637         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
*  12-S**************************                                      (  72)**
**    Operand VM-INPUT-VALNOM is not declared
  3639            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  72)**
**    Operand K-VALNOM is not declared
  3640              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  72)**
**    Operand VMM-INPUT-VALNOM is not declared
  3645                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
*  12-S********************************                                (  72)**
**    Operand VMM-OK-VALNOM is not declared
  3646                    ADD 1 TO LETRAS-OK-VALNOM
*  12-S********************************************                    (  72)**
**    Operand LETRAS-OK-VALNOM is not declared
  3647                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  72)**
**    Operand K-VALNOM is not declared
  3648                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  72)**
**    Operand L-VALNOM is not declared
  3650                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  73)**
**    Operand K-VALNOM is not declared
  3651                 END-IF
* 564-S**********************                                          (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3653                 ADD 1   TO K-VALNOM
*  12-S***********************************                             (  73)**
**    Operand K-VALNOM is not declared
  3654                 IF K-VALNOM <= 15 AND L-VALNOM < 15
*  12-S***************************                                     (  73)**
**    Operand K-VALNOM is not declared
  3655                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
*  12-S**************************************                          (  73)**
**    Operand VMM-INPUT-VALNOM is not declared
  3657                       ADD 1 TO L-VALNOM
*  12-S***************************************                         (  73)**
**    Operand L-VALNOM is not declared
  3658                    END-IF
* 564-S*************************                                       (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3659                 END-IF
* 564-S**********************                                          (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3660              END-IF
* 564-S*******************                                             (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3661            END-PERFORM
* 564-S**********************                                          (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3662            MOVE 1 TO K-VALNOM
*  12-S*****************************                                   (  73)**
**    Operand K-VALNOM is not declared
  3663            MOVE 1 TO L-VALNOM
*  12-S*****************************                                   (  73)**
**    Operand L-VALNOM is not declared
  3664            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  73)**
**    Operand K-VALNOM is not declared
  3665              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  73)**
**    Operand VMM-INPUT-VALNOM is not declared
  3670                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
*  12-S********************************                                (  73)**
**    Operand VMM-OK-VALNOM is not declared
  3671                    ADD 1 TO LETRAS-OK2-VALNOM
*  12-S*********************************************                   (  73)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3672                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  73)**
**    Operand K-VALNOM is not declared
  3673                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  74)**
**    Operand L-VALNOM is not declared
  3675                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  74)**
**    Operand K-VALNOM is not declared
  3676                 END-IF
* 564-S**********************                                          (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3678                 ADD 1   TO L-VALNOM
*  12-S***********************************                             (  74)**
**    Operand L-VALNOM is not declared
  3679                 IF L-VALNOM <= 15 AND K-VALNOM < 15
*  12-S***************************                                     (  74)**
**    Operand L-VALNOM is not declared
  3680                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S**************************************                          (  74)**
**    Operand VMM-INPUT-VALNOM is not declared
  3682                       ADD 1 TO K-VALNOM
*  12-S***************************************                         (  74)**
**    Operand K-VALNOM is not declared
  3683                    END-IF
* 564-S*************************                                       (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3684                 END-IF
* 564-S**********************                                          (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3685              END-IF
* 564-S*******************                                             (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3686            END-PERFORM
* 564-S**********************                                          (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3687         END-IF
* 564-S**************                                                  (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3688         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
*  12-S****************************                                    (  74)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3689            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
*  12-S*********************************                               (  74)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3690         END-IF
* 564-S**************                                                  (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3691         IF LETRAS-OK-VALNOM > 0
*  12-S***************************                                     (  74)**
**    Operand LETRAS-OK-VALNOM is not declared
  3692            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
*  12-S**************************************                          (  74)**
**    Operand TOTLET-INP-VALNOM is not declared
  3693            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
*  12-S**********************************                              (  74)**
**    Operand VM-INPUT-VALNOM is not declared
  3696            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
*  12-S*******************************                                 (  75)**
**    Operand VM-OK-VALNOM is not declared
  3699            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
*  12-S***********************************                             (  75)**
**    Operand POR-TOT-VALNOM is not declared
  3700            IF TOTLET-OK-VALNOM >= 3
*  12-S******************************                                  (  75)**
**    Operand TOTLET-OK-VALNOM is not declared
  3701               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  75)**
**    Operand POR-TOT-VALNOM is not declared
  3703            END-IF
* 564-S*****************                                               (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3704            IF TOTLET-INP-VALNOM >= 3
*  12-S*******************************                                 (  75)**
**    Operand TOTLET-INP-VALNOM is not declared
  3705               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  75)**
**    Operand POR-INP-VALNOM is not declared
  3707            END-IF
* 564-S*****************                                               (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3708            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
*  12-S******************************                                  (  75)**
**    Operand TOTLET-OK-VALNOM is not declared
  3709               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
*  12-S******************************                                  (  75)**
**    Operand A-VALNOM is not declared
  3712               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
*  12-S******************************                                  (  75)**
**    Operand A-VALNOM is not declared
  3714            END-IF
* 564-S*****************                                               (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3715            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
*  12-S******************************                                  (  75)**
**    Operand POR-TOT-VALNOM is not declared
  3725               ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S****************************************                        (  75)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3726               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S*****************************************                       (  76)**
**    Operand VM-OK-VALNOM is not declared
  3728            END-IF
* 564-S*****************                                               (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3729         END-IF
* 564-S**************                                                  (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3730         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  76)**
**    Operand J-VALNOM is not declared
  3731       END-PERFORM
* 564-S*****************                                               (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3732       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  76)**
**    Operand I-VALNOM is not declared
  3733     END-PERFORM.
* 564-S***************                                                 (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3741   MOVE ZEROS TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  76)**
**    Operand TOTLET-INP-VALNOM is not declared
  3742   MOVE ZEROS TO LETRAS-OK2-VALNOM
*  12-S*********************************                               (  76)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3743    MOVE ZEROS TO A-VALNOM                                        GJC0003
*  12-S*************************                                       (  76)**
**    Operand A-VALNOM is not declared
  3744   MOVE 1 TO K-VALNOM
*  12-S********************                                            (  76)**
**    Operand K-VALNOM is not declared
  3745   PERFORM UNTIL K-VALNOM > 65
*  12-S************************                                        (  76)**
**    Operand K-VALNOM is not declared
  3746     MOVE K-VALNOM  TO I-VALNOM
*  12-S*****************                                               (  76)**
**    Operand K-VALNOM is not declared
  3747     MOVE 1       TO J-VALNOM
*  12-S****************************                                    (  76)**
**    Operand J-VALNOM is not declared
  3748     MOVE ZEROS TO LETRAS-OK-VALNOM
*  12-S**********************************                              (  76)**
**    Operand LETRAS-OK-VALNOM is not declared
  3749     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
*  12-S**************************                                      (  76)**
**    Operand J-VALNOM is not declared
  3750        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S*************************                                       (  77)**
**    Operand V-NOMBRE-VALNOM is not declared
  3752           IF V-NOMBRE-VALNOM(I-VALNOM) =
*  12-S****************************                                    (  77)**
**    Operand V-NOMBRE-VALNOM is not declared
  3754              ADD 1 TO LETRAS-OK-VALNOM
*  12-S**************************************                          (  77)**
**    Operand LETRAS-OK-VALNOM is not declared
  3755              ADD 1 TO I-VALNOM
*  12-S******************************                                  (  77)**
**    Operand I-VALNOM is not declared
  3756              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  77)**
**    Operand J-VALNOM is not declared
  3758              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  77)**
**    Operand J-VALNOM is not declared
  3759           END-IF
* 564-S****************                                                (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3761           ADD 1 TO I-VALNOM
*  12-S***************************                                     (  77)**
**    Operand I-VALNOM is not declared
  3762        END-IF
* 564-S*************                                                   (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3763     END-PERFORM
* 564-S***************                                                 (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3764     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
*  12-S***********************                                         (  77)**
**    Operand LETRAS-OK-VALNOM is not declared
  3765        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
*  12-S****************************                                    (  77)**
**    Operand LETRAS-OK-VALNOM is not declared
  3766     END-IF
* 564-S**********                                                      (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3767     ADD 1 TO K-VALNOM
*  12-S*********************                                           (  77)**
**    Operand K-VALNOM is not declared
  3768   END-PERFORM.
* 564-S*************                                                   (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3769   MOVE 1 TO I-VALNOM
*  12-S********************                                            (  77)**
**    Operand I-VALNOM is not declared
  3770   PERFORM UNTIL I-VALNOM > 65
*  12-S************************                                        (  77)**
**    Operand I-VALNOM is not declared
  3771     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S**********************                                          (  77)**
**    Operand V-NOMBRE-VALNOM is not declared
  3773        ADD 1 TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  78)**
**    Operand TOTLET-INP-VALNOM is not declared
  3774     END-IF
* 564-S**********                                                      (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3775     ADD 1 TO I-VALNOM
*  12-S*********************                                           (  78)**
**    Operand I-VALNOM is not declared
  3776   END-PERFORM.
* 564-S*************                                                   (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3777   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
*  12-S******************                                              (  78)**
**    Operand A-VALNOM is not declared
  3779   IF A-VALNOM >= 75
*  12-S*************                                                   (  78)**
**    Operand A-VALNOM is not declared
  3780       ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S********************************                                (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3781   END-IF.
* 564-S********                                                        (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3782    MOVE 0 TO K-VALNOM                                            GJC0003
*  12-S*********************                                           (  78)**
**    Operand K-VALNOM is not declared
  3783   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
*  12-S**********************                                          (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3784      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
*  12-S************************                                        (  78)**
**    Operand A-VALNOM is not declared
  3785      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
*  12-S*****************************                                   (  78)**
**    Operand J-VALNOM is not declared
  3786               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  78)**
**    Operand V-NOMBRE-VALNOM is not declared
  3787                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  78)**
**    Operand V-NOMBRE-VALNOM is not declared
  3789                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
*  12-S**********************************************                  (  78)**
**    Operand CONT-LET-INPUT-VALNOM is not declared
  3790              END-IF                                              GJC0003
* 564-S*******************                                             (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3791               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  78)**
**    Operand V-NOMBOK-VALNOM is not declared
  3792                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  78)**
**    Operand V-NOMBOK-VALNOM is not declared
  3794                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
*  12-S*******************************************                     (  79)**
**    Operand CONT-LET-OK-VALNOM is not declared
  3795              END-IF                                              GJC0003
* 564-S*******************                                             (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3796      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3797      MOVE 0 TO I-VALNOM                                          GJC0003
*  12-S***********************                                         (  79)**
**    Operand I-VALNOM is not declared
  3798       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
*  12-S******************************                                  (  79)**
**    Operand J-VALNOM is not declared
  3799         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
*  12-S*****************************                                   (  79)**
**    Operand CONT-LET-OK-VALNOM is not declared
  3800            ADD 1 TO I-VALNOM                                     GJC0003
*  12-S****************************                                    (  79)**
**    Operand I-VALNOM is not declared
  3801            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
*  12-S********************************                                (  79)**
**    Operand CONT-LET-OK-VALNOM is not declared
  3803               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
*  12-S******************************                                  (  79)**
**    Operand L-VALNOM is not declared
  3805               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
*  12-S******************************                                  (  79)**
**    Operand L-VALNOM is not declared
  3808            END-IF                                                GJC0003
* 564-S*****************                                               (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3809         END-IF                                                   GJC0003
* 564-S**************                                                  (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3810      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3811      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
*  12-S*********************                                           (  79)**
**    Operand K-VALNOM is not declared
  3812       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
*  12-S******************                                              (  79)**
**    Operand A-VALNOM is not declared
  3815         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
*  12-S**********************************                              (  79)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3816       END-IF                                                     GJC0003
* 564-S************                                                    (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3817   END-IF.                                                        GJC0003
* 564-S********                                                        (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
* Total Messages:   352
* Unrecoverable :     0                    Severe  :   352
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23748     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchexit program.end program PONERR.end program ACTALEJUR.******************************************************************
* De aqu\055 para abajo se puede eliminar, son recortes del programa
* ejemplo
******************************************************************
******************************************************************
******************************************************************
******************************************************************
******************************************************************
*******************************************************************6000-SACAR-RESUMEN.
****************************************************************
****************************************************************
*    display "==============[ RESUMEN del PROCESO ]============"
*    display "TIPO DE PROCESO= "   COMANDO(1:10)
*    display "DEMANDADOS LEIDOS= " CONT-LEIDOS
*    display "  DEMANDADOS VALIDOS= " CONT-REGISTROS-OK
*    display "    DEMANDADOS CREADOS= " CONT-WRITE-OK
*    display "    DEMANDADOS ACTUALIZADOS = " CONT-REWRITE-OK
*    display "    DEMANDADOS ERR CREAR    = " CONT-WRITE-ERR
*    display "    DEMANDADOS ERR ACTUALIZ = " CONT-REWRITE-ERR
*    display "  DEMANDADOS NO VALIDOS     = " CONT-REGISTROS-ERR
*    display "=================================================".$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status******************************************************************
******************************************************************
copy BDIIDIAN.FS.******************************************************************
******************************************************************
copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==./delimited by all spaces

4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-numunstring LA-numX into LA-descarte LA-valor(1)delimited by all spacesmove JURAD-demandas-terminadas to LA-numunstring LA-numX into LA-descarte LA-valor(2)delimited by all spacesstring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from timeDDd

:w"CARGAJUR.CBL" 1174 lines, 50416 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1617         delimited by all space
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  1620         delimited by all space
* 301-S*****************                                               (  29)**
**    Unrecognized verb
  1628     end-if.
*  14-S**********                                                      (  29)**
**    Invalid operand
  1739         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     4
* Unrecoverable :     0                    Severe  :     4
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $cls
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $clscob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1617         delimited by all space
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  1620         delimited by all space
* 301-S*****************                                               (  29)**
**    Unrecognized verb
  1628     end-if.
*  14-S**********                                                      (  29)**
**    Invalid operand
  1739         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     4
* Unrecoverable :     0                    Severe  :     4
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $vi CARGAJUR.lst
"CARGAJUR.lst" 2786 lines, 153322 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 17:44 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"CARGAJUR.lst" 2786 lines, 153322 characters^/delimited by all space  1594
  1595
  1596 4900-GRABAR-ERROR.
  1597******************************************************************
  1598* El registro de JURAD tiene error: se graba en el archivo ERRS
  1599* con indicacion del error detectado
  1600******************************************************************
  1601* TODO: >>>> implementar la grabación del archivo ERRS
  1602     display "NO GRABA ERRS".
  1603
  1604
  1605 4320-ARMAR-TEXTO-ALERTA.
  1606****************************************************************
  1607* Hace el reemplazo de los valores adecuados en los templates
  1608* de las linea de alerta que corresponde
  1609****************************************************************
  1610*    según se trate de demandas o embargos
  1611     if JURAD-demandas-vigentes not = 0
  1612     or JURAD-demandas-terminadas not = 0
  1613set LAx to 1
  1614move high-values to LA-valores
  1615move JURAD-demandas-vigentes to LA-num
  1616unstring LA-numX into LA-descarte LA-valor(1)
  1617delimited by all space
* 301-S*****************(   0)**
**    Unrecognized verb
  1618move JURAD-demandas-terminadas to LA-num
  1619unstring LA-numX into LA-descarte LA-valor(2)
  1620delimited by all space
* 301-S*****************(  29)**
**    Unrecognized verb
  1621string LA-parte(LAx, 1) LA-valor(1)
  1622LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
  1623LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
  1624LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
  1625LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
  1626LA-parte(LAx, 10) LA-valor(10)
  1627delimited by high-value
  1628     end-if.
*  14-S**********(  29)**
**    Invalid operand
  1629
  1630
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 17:44 Page  30
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1631 1000-RUTINA-INICIAL.
  1632******************************************************************
  1633* Todas las operaciones que se realizan una sola vez, al comienzo
  1634* del programa::q/d/iccol/desarrollo $fg
vi CARGAJUR.CBL


4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-numunstring LA-numX into LA-descarte LA-valor(1)delimited by all spacemove JURAD-demandas-terminadas to LA-numunstring LA-numX into LA-descarte LA-valor(2)delimited by all spacestring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from timeeAPPEND MODE end-unstringe end-unstring/la-descarte$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status******************************************************************
******************************************************************
copy BDIIDIAN.FS.******************************************************************
******************************************************************
copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==./*    Cada template consiste en hasta 10 frases fijas con*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamaño del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un código de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 80
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificación invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificación invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificación debe ser mayor que cero".03 pic x(11) value "05 0000000 "./end-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-numunstring LA-numX into LA-descarte LA-valor(1)delimited by all space end-unstringmove JURAD-demandas-terminadas to LA-numunstring LA-numX into LA-descarte LA-valor(2)delimited by all space end-unstringstring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time/:w"CARGAJUR.CBL" 1174 lines, 50442 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgvi CARGAJUR.lstcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1617         delimited by all space end-unstring
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  1620         delimited by all space end-unstring
* 301-S*****************                                               (  29)**
**    Unrecognized verb
  1628     end-if.
*  14-S**********                                                      (  29)**
**    Invalid operand
  1739         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     4
* Unrecoverable :     0                    Severe  :     4
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
end-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-numunstring LA-numX into LA-descarte LA-valor(1)delimited by all space end-unstringmove JURAD-demandas-terminadas to LA-numunstring LA-numX into LA-descarte LA-valor(2)delimited by all space end-unstringstring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from timeby :w"CARGAJUR.CBL" 1174 lines, 50434 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1617         delimited by space end-unstring
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  1620         delimited by space end-unstring
* 301-S*****************                                               (  29)**
**    Unrecognized verb
  1628     end-if.
*  14-S**********                                                      (  29)**
**    Invalid operand
  1739         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     4
* Unrecoverable :     0                    Severe  :     4
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
end-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-numunstring LA-numX into LA-descarte LA-valor(1)delimited by space end-unstringmove JURAD-demandas-terminadas to LA-numunstring LA-numX into LA-descarte LA-valor(2)delimited by space end-unstringstring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from timeall space end-unstring


by INSERT MODEall 

2)REPLACE 1 CHAR
LA-parte(LAx, 3) LA-valor(3)INSERT MODE                ^?^
(4)$CHANGE MODE
LA-parte(LAx, 5) LA-valor(5)CHANGE MODE               
 lor(6)$
LA-parte(LAx, 7) LA-valor(7)               
 8)$
LA-parte(LAx, 9) LA-valor(9)               "CARGAJUR.CBL" [Modified] line 875 of 1178 --74%-- :w"CARGAJUR.CBL" 1178 lines, 50502 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1617         delimited by all space end-unstring
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  1620         delimited by all space end-unstring
* 301-S*****************                                               (  29)**
**    Unrecognized verb
  1632     end-if.
*  14-S**********                                                      (  29)**
**    Invalid operand
  1743         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     4
* Unrecoverable :     0                    Severe  :     4
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
end-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-numunstring LA-numX into LA-descarte LA-valor(1)delimited by all space end-unstringmove JURAD-demandas-terminadas to LA-numunstring LA-numX into LA-descarte LA-valor(2)delimited by all space end-unstringstring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2)LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4)LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6)LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8)LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos

 REPLACE 1 CHAR*
*

*
*:w"CARGAJUR.CBL" 1178 lines, 50502 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[v  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1632     end-if.
*  14-S**********                                                      (   0)**
**    Invalid operand
  1743         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     2
* Unrecoverable :     0                    Severe  :     2
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
end-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all space end-unstringmove JURAD-demandas-terminadas to LA-num
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all space end-unstringstring LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2)LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4)LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6)LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8)LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status******************************************************************
******************************************************************
copy BDIIDIAN.FS.******************************************************************
******************************************************************
copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1178 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    ACTALEJUR.



      ******************************************************************
      * Actualización del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-name
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.
      * TODO: debe compilar con file status

      ******************************************************************
      ******************************************************************
       copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
       copy BDIIDAS.FS.


      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record

              file status is EST-BDIIALE.==.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(6).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(6).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con las alertas del sistema

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres de VALNOM.PROC

APPEND MODE      ******************************************************************

APPEND MODE       copy VALNOM.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE       01 VARIABLES-INPUT.

APPEND MODE          03 TIPO-IDE-INP               pic 9.

APPEND MODE          03 NUM-IDE-INP                pic 9(11).

APPEND MODE          03 NOMBRES-INP                pic X(30).

APPEND MODE          03 APELLIDO-PAT-INP           pic X(30).

APPEND MODE          03 APELLIDO-MAT-INP           pic X(30).

APPEND MODE          03 NUM-DEMA-VIG-INP           pic 9(05).

APPEND MODE          03 NUM-DEMA-TER-INP           pic 9(05).

APPEND MODE          03 FEC-DEMA-VIG-INP           pic 9(08).

APPEND MODE          03 TIPO-IDE-INP-X             pic X.

APPEND MODE          03 NUM-IDE-INP-X              pic X(11).

APPEND MODE          03 NUM-DEMA-VIG-INP-X         pic X(05).

APPEND MODE          03 NUM-DEMA-TER-INP-X         pic X(05).

APPEND MODE          03 FEC-DEMA-VIG-INP-X         pic X(08).

APPEND MODE       01 M-ERRORES.

APPEND MODE          03 V-ERR occurs 50 TIMES      pic 9(1).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "SI" para activar 

APPEND MODE      * TODO: fijo en "NO" para pruebas

APPEND MODE           03 P-proceso-real            pic xx value "NO".

APPEND MODE           88 PROCESO-REAL              value "SI".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Código de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Inserción de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificación o eliminación de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un 

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5 

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo: 

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos. 

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamaño del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50) 

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un código de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 80

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificación invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE          02 ANO-VAL-X                   pic 9(04).

APPEND MODE             88 ANO-VAL  value 1900 thru 2050.

APPEND MODE          02 MES-VAL-X                   pic 9(02).

APPEND MODE             88 MES-VAL  value 01   thru 12.

APPEND MODE          02 DIA-VAL-X                   pic 9(02).

APPEND MODE             88 DIA-VAL  value 01   thru 31.

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    6000-SACAR-RESUMEN

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La información está leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T" 

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validación formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    actualizacion de BDIIALE o grabacion en arch ERRS de defectos

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               add 1 to N-reg-con-error

APPEND MODE           else

APPEND MODE               perform 4300-MODIFICAR-BDIIALE

APPEND MODE               add 1 to N-reg-OK

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-demandas-fecha-ultima(1:2) > "50"

APPEND MODE               string "19" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-embargos-fecha-ultimo(1:2) > "50"

APPEND MODE               string "19" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a " 

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones, 

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y 

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero 

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima 

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero 

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyó OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserción de una alerta nueva

APPEND MODE      * Si ya exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro exist\055a es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE 

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificación de una alerta existente

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no exist\055a es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminación de una alerta

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "20" thru "29"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: >>>> implementar la grabación del archivo ERRS

APPEND MODE           display "NO GRABA ERRS".

APPEND MODE 

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    según se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0 

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE               string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE               LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE               LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE               LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE               LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE               LA-parte(LAx, 10) LA-valor(10)

APPEND MODE               delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso

APPEND MODE           display "Carga de archivo JURAD"

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "command line: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01" *> 01 Envio Original - Carga TOTAL 1a vez

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02" *> 02 Archivo Semanal - Carga PARCIAL

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03" *> 03 Archivo Mensual - Carga PARCIAL

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04" *> 04 Refresque Total - Carga TOTAL

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *       valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD 

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size 

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una decha 50 años posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo jurad "

APPEND MODE                   display "Nombre del archivo: " P-file-name

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string P-file-name(1:19) "_ERRORES.txt" into

APPEND MODE           ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      * >>>> esto da un error de compilación que no puedo resolver

APPEND MODE      * >>>> por ahora está anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1 

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE invalid key

APPEND MODE      *        no hay registros

APPEND MODE               exit paragraph

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas. 

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time.

APPEND MODE      *    leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display "Proceso cancelado"

APPEND MODE           goback.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(80) value low-values.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input                    pic x(80).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input(1:80) not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display reg-input(1:80)

APPEND MODE               move reg-input(1:80) to reg-input-anterior

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program ACTALEJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * De aqu\055 para abajo se puede eliminar, son recortes del programa

APPEND MODE      * ejemplo

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE      *6000-SACAR-RESUMEN.

APPEND MODE      ****************************************************************

APPEND MODE      ****************************************************************

APPEND MODE      *    display "==============[ RESUMEN del PROCESO ]============"

APPEND MODE      *    display "TIPO DE PROCESO             = "   COMANDO(1:10)

APPEND MODE      *    display "DEMANDADOS LEIDOS           = " CONT-LEIDOS

APPEND MODE      *    display "  DEMANDADOS VALIDOS        = " CONT-REGISTROS-OK

APPEND MODE      *    display "    DEMANDADOS CREADOS      = " CONT-WRITE-OK

APPEND MODE      *    display "    DEMANDADOS ACTUALIZADOS = " CONT-REWRITE-OK

APPEND MODE      *    display "    DEMANDADOS ERR CREAR    = " CONT-WRITE-ERR

APPEND MODE      *    display "    DEMANDADOS ERR ACTUALIZ = " CONT-REWRITE-ERR

APPEND MODE      *    display "  DEMANDADOS NO VALIDOS     = " CONT-REGISTROS-ERR

APPEND MODE      *    display "=================================================".

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE

[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1632     end-if.
*  14-S**********                                                      (   0)**
**    Invalid operand
  1743         delimited by all "&"
* 301-S*****************                                               (  29)**
**    Unrecognized verb
* Total Messages:     2
* Unrecoverable :     0                    Severe  :     2
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchexit program.end program PONERR.end program ACTALEJUR.******************************************************************
* De aqu\055 para abajo se puede eliminar, son recortes del programa
* ejemplo
******************************************************************
******************************************************************
******************************************************************
******************************************************************
******************************************************************
*******************************************************************6000-SACAR-RESUMEN.
****************************************************************
****************************************************************
*    display "==============[ RESUMEN del PROCESO ]============"
*    display "TIPO DE PROCESO= "   COMANDO(1:10)
*    display "DEMANDADOS LEIDOS= " CONT-LEIDOS
*    display "  DEMANDADOS VALIDOS= " CONT-REGISTROS-OK
*    display "    DEMANDADOS CREADOS= " CONT-WRITE-OK
*    display "    DEMANDADOS ACTUALIZADOS = " CONT-REWRITE-OK
*    display "    DEMANDADOS ERR CREAR    = " CONT-WRITE-ERR
*    display "    DEMANDADOS ERR ACTUALIZ = " CONT-REWRITE-ERR
*    display "  DEMANDADOS NO VALIDOS     = " CONT-REGISTROS-ERR
*    display "=================================================".
/delimited by all "."Address search hit BOTTOM without matching pattern
?
* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE invalid key
*no hay registros?end-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso)accept P-command-line from COMMAND-LINEdisplay "command line: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real
* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01" *> 01 Envio Original - Carga TOTAL 1a vezdisplay "01 Envio Original - Carga TOTAL 1a vez"when "02" *> 02 Archivo Semanal - Carga PARCIALdisplay "02 Archivo Semanal - Carga PARCIAL"when "03" *> 03 Archivo Mensual - Carga PARCIALdisplay "03 Archivo Mensual - Carga PARCIAL"when "04" *> 04 Refresque Total - Carga TOTALdisplay "04 Refresque Total - Carga TOTAL"when other
*valor invalido
display "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAend-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD
string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDD* Calcula una decha 50 años posterior a la de proceso?Address search hit TOP without matching pattern/
* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE invalid key
*no hay registros/Address search hit BOTTOM without matching pattern[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $vi CARGAJUR.lst
"CARGAJUR.lst" 2786 lines, 153200 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"CARGAJUR.lst" 2786 lines, 153200 characters^/delimited  *by *all *"."  1634
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page  30
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1635 1000-RUTINA-INICIAL.
  1636******************************************************************
  1637* Todas las operaciones que se realizan una sola vez, al comienzo
  1638* del programa:
  1639*   - obtencion de los parametros
  1640*   - apertura del archivo de entrada
  1641*   - apertura de todos los demas archivos
  1642*   - eliminacion de datos existentes si es refresque completo
  1643******************************************************************
  1644* Registra hora de inicio
  1645     accept W-hora-inicio from time
  1646
  1647* El programa se anuncia en la consola
  1648* TODO: se usa un anuncio mas vistoso
  1649     display "Carga de archivo JURAD"
  1650
  1651* Obtiene informacion sobre la corrida de la linea de comando: el
  1652* nombre del archivo de entrada (que contiene el tipo de proceso)
  1653     accept P-command-line from COMMAND-LINE
  1654     display "command line: " P-command-line
  1655     unstring P-command-line delimited by all " " into
  1656     P-file-name P-proceso-real
  1657* TODO: controlar los componentes del filename
  1658     evaluate P-tipo-proceso
  1659     when "01" *> 01 Envio Original - Carga TOTAL 1a vez
  1660display "01 Envio Original - Carga TOTAL 1a vez"
  1661     when "02" *> 02 Archivo Semanal - Carga PARCIAL
  1662display "02 Archivo Semanal - Carga PARCIAL"
  1663     when "03" *> 03 Archivo Mensual - Carga PARCIAL
  1664display "03 Archivo Mensual - Carga PARCIAL"
  1665     when "04" *> 04 Refresque Total - Carga TOTAL
  1666display "04 Refresque Total - Carga TOTAL"
  1667     when other
  1668*valor invalido
  1669display "El tipo de proceso " P-tipo-proceso
  1670" es invalido (debe ser 01 02 03 o 04)"
  1671perform 9000-CANCELAR-PROGRAMA
  1672     end-evaluate.
  1673
  1674* Edita la fecha de proceso DDMMAA del parametro en formato
  1675* YYYYMMDD
  1676     string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
  1677     P-fecha-proceso(1:2) delimited size
  1678     into P-fecha-proceso-YYYYMMDD
  1679
  1680* Calcula una decha 50 años posterior a la de proceso/  1720open i-o BDIIALE
  1721     else
  1722open input BDIIALE
  1723     end-if.
  1724
  1725* Si es un refresque total (codigo 04) se eliminan los registros
  1726* de Jurad existentes
  1727     if P-tipo-proceso = "04" and PROCESO-REAL
  1728perform 1001-ELIMINAR-TODO
  1729     end-if.
  1730
  1731* Carga de los templates para armar el texto de alertas
  1732* TODO: por ahora los templates son literales
  1733     set LAx to 0
  1734     move high-values to LA-templates
  1735     perform varying LAm from 1 by 1
  1736     until LA-modelo(LAm) = high-values
  1737set LAx up by 1
  1738*separa las partes de la linea
  1739unstring LA-modelo(LAm) into LA-parte(LAx, 1)
  1740LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
  1741LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
  1742LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
  1743delimited by all "&"
* 301-S*****************(  29)**
**    Unrecognized verb
  1744*prepara para omitir los espacios al final de c/parte
  1745perform varying LAy from 1 by 1 until LAy > 10
  1746inspect LA-parte(LAx, LAy) replacing trailing
  1747spaces by high-values
  1748inspect LA-parte(LAx, LAy) replacing first
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page  32
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1749high-value by space
  1750end-perform
  1751     end-perform.
  1752
  1753
  1754
  1755 1001-ELIMINAR-TODO.
  1756******************************************************************
  1757* Elimina los registros de alertas existentes en el archivo de
  1758* alertas en linea, previo a un refresque total
  1759******************************************************************
  1760     display "Eliminando toda la informacion con fuente JURAD"
  1761*    posiciona en el primer reg de JURAD
  1762     move zero to TIP-IDE-BDIIALE
  1763     move zero to NUM-IDE-BDIIALE
  1764     move P-cod-suscriptor to FUENTE-BDIIALE/  2187MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
  2188     ELSE
  2189INSPECT CADENA-VALNOM    REPLACING ALL
  2190"." BY " ","-" BY " ", "," BY " ",
  2191"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  2192"Y" BY "G","H" BY "G","I" BY "G",
  2193" DE " BY "    "," LA " BY "    ",
  2194" DEL " BY "     "
  2195INSPECT CADENA-VALNOM    REPLACING ALLRMB0002
  2196"." BY " ","-" BY " ", "," BY " ",
  2197"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002
  2198"Y" BY "G","H" BY "G","I" BY "G",RMB0002
  2199" DE " BY "    "," LA " BY "    ",RMB0002
  2200" DEL " BY "     "RMB0002
  2201PERFORM VARYING I-VALNOM FROM 1 BY 1
  2202UNTIL I-VALNOM >= 66
  2203IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  2204AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  2205MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  2206END-IF
  2207END-PERFORM
  2208     END-IF.
  2209     MOVE SPACES TO VECTOR-INPUT-VALNOM.
  2210     UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO
  2211BASURA-VALNOM
  2212VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page  40
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  2213VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)
  2214VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)
  2215VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)
  2216VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)
  2217VM-INPUT-VALNOM(14)
  2218VM-INPUT-VALNOM(15)
  2219VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)
  2220VM-INPUT-VALNOM(19)
  2221VM-INPUT-VALNOM(20)
  2222******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********
  2223     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  2224     IF TIP-ID-INPUT-VALNOM  NOT = 2
  2225INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  2226"." BY " ","-" BY " ","," BY " ",
  2227"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  2228"Y" BY "G","H" BY "G","I" BY "G"
  2229PERFORM VARYING I-VALNOM FROM 1 BY 1
  2230UNTIL I-VALNOM >= 66
  2231IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  2232AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  2233MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)/  2243" EMPRESA " BY "",RMB0002
  2244" CORPORACION " BY "",RMB0002
  2245" DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  2246" S " BY "   ", " A " BY "   "RMB0002
  2247" Y " BY "   "GJC0003
  2248INSPECT NOMBRE-AUX-VALNOM REPLACING ALLRMB0002
  2249" S.A. " BY "",RMB0002
  2250"." BY " ", " LTDA " BY "",RMB0002
  2251" LIMITADA " BY "",RMB0002
  2252" CIA " BY "     ", " COMPA/IA " BY "",RMB0002
  2253" INVERSIONES " BY "",RMB0002
  2254" EMPRESA " BY "",RMB0002
  2255" CORPORACION " BY "",RMB0002
  2256" DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  2257" S " BY "   ", " A " BY "   "RMB0002
  2258" Y " BY "   "GJC0003
  2259INSPECT NOMBRE-AUX-VALNOM REPLACING ALLGJC0003
  2260"." BY " ","-" BY " ",GJC0003
  2261"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",GJC0003
  2262"Y" BY "G","H" BY "G","I" BY "G"GJC0003
  2263MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
  2264     END-IF.
  2265     MOVE SPACES TO VECTOR-OK-VALNOM.
  2266     UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO
  2267BASURA-VALNOM
  2268VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)
  2269VM-OK-VALNOM(4) VM-OK-VALNOM(5)
  2270VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page  41
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  2271VM-OK-VALNOM(9) VM-OK-VALNOM(10)
  2272VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)
  2273VM-OK-VALNOM(14) VM-OK-VALNOM(15)
  2274VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)
  2275VM-OK-VALNOM(19) VM-OK-VALNOM(20).
  2276***********HACE LA VALIDACION BLOQUE A BLOQUE********************
  2277     MOVE 1 TO I-VALNOM.
  2278     MOVE 0 TO BLOQOK-AUX-VALNOM.
  2279     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
  2280MOVE 1 TO J-VALNOM
  2281PERFORM UNTIL J-VALNOM > 20
  2282IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
  2283ADD 1 TO BLOQOK-AUX-VALNOM
  2284MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  2285VM-INPUT-VALNOM(I-VALNOM)
  2286MOVE 21 TO J-VALNOM
  2287ELSE
  2288MOVE 0 TO M-VALNOM
  2289INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM/Address search hit BOTTOM without matching pattern?  2187MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
  2188     ELSE
  2189INSPECT CADENA-VALNOM    REPLACING ALL
  2190"." BY " ","-" BY " ", "," BY " ",
  2191"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  2192"Y" BY "G","H" BY "G","I" BY "G",
  2193" DE " BY "    "," LA " BY "    ",
  2194" DEL " BY "     "
  2195INSPECT CADENA-VALNOM    REPLACING ALLRMB0002
  2196"." BY " ","-" BY " ", "," BY " ",
  2197"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",RMB0002
  2198"Y" BY "G","H" BY "G","I" BY "G",RMB0002
  2199" DE " BY "    "," LA " BY "    ",RMB0002
  2200" DEL " BY "     "RMB0002
  2201PERFORM VARYING I-VALNOM FROM 1 BY 1
  2202UNTIL I-VALNOM >= 66
  2203IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  2204AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  2205MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  2206END-IF
  2207END-PERFORM
  2208     END-IF.
  2209     MOVE SPACES TO VECTOR-INPUT-VALNOM.
  2210     UNSTRING CADENA-VALNOMDELIMITED BY ALL " " INTO
  2211BASURA-VALNOM
  2212VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page  40
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  2213VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)
  2214VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)
  2215VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)
  2216VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)
  2217VM-INPUT-VALNOM(14)
  2218VM-INPUT-VALNOM(15)
  2219VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)
  2220VM-INPUT-VALNOM(19)
  2221VM-INPUT-VALNOM(20)
  2222******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********
  2223     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  2224     IF TIP-ID-INPUT-VALNOM  NOT = 2
  2225INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  2226"." BY " ","-" BY " ","," BY " ",
  2227"C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  2228"Y" BY "G","H" BY "G","I" BY "G"
  2229PERFORM VARYING I-VALNOM FROM 1 BY 1
  2230UNTIL I-VALNOM >= 66
  2231IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  2232AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  2233MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)?  1720open i-o BDIIALE
  1721     else
  1722open input BDIIALE
  1723     end-if.
  1724
  1725* Si es un refresque total (codigo 04) se eliminan los registros
  1726* de Jurad existentes
  1727     if P-tipo-proceso = "04" and PROCESO-REAL
  1728perform 1001-ELIMINAR-TODO
  1729     end-if.
  1730
  1731* Carga de los templates para armar el texto de alertas
  1732* TODO: por ahora los templates son literales
  1733     set LAx to 0
  1734     move high-values to LA-templates
  1735     perform varying LAm from 1 by 1
  1736     until LA-modelo(LAm) = high-values
  1737set LAx up by 1
  1738*separa las partes de la linea
  1739unstring LA-modelo(LAm) into LA-parte(LAx, 1)
  1740LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
  1741LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
  1742LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
  1743delimited by all "&"
* 301-S*****************(  29)**
**    Unrecognized verb
  1744*prepara para omitir los espacios al final de c/parte
  1745perform varying LAy from 1 by 1 until LAy > 10
  1746inspect LA-parte(LAx, LAy) replacing trailing
  1747spaces by high-values
  1748inspect LA-parte(LAx, LAy) replacing first
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 18:09 Page  32
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1749high-value by space
  1750end-perform
  1751     end-perform.
  1752
  1753
  1754
  1755 1001-ELIMINAR-TODO.
  1756******************************************************************
  1757* Elimina los registros de alertas existentes en el archivo de
  1758* alertas en linea, previo a un refresque total
  1759******************************************************************
  1760     display "Eliminando toda la informacion con fuente JURAD"
  1761*    posiciona en el primer reg de JURAD
  1762     move zero to TIP-IDE-BDIIALE
  1763     move zero to NUM-IDE-BDIIALE
  1764     move P-cod-suscriptor to FUENTE-BDIIALE:q/d/iccol/desarrollo $fg
vi CARGAJUR.CBL

* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE invalid key
*no hay registros//Address search hit BOTTOM without matching pattern?end-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso)accept P-command-line from COMMAND-LINEdisplay "command line: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real
* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01" *> 01 Envio Original - Carga TOTAL 1a vezdisplay "01 Envio Original - Carga TOTAL 1a vez"when "02" *> 02 Archivo Semanal - Carga PARCIALdisplay "02 Archivo Semanal - Carga PARCIAL"when "03" *> 03 Archivo Mensual - Carga PARCIALdisplay "03 Archivo Mensual - Carga PARCIAL"when "04" *> 04 Refresque Total - Carga TOTALdisplay "04 Refresque Total - Carga TOTAL"when other
*valor invalido
display "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAend-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD
string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDD* Calcula una decha 50 años posterior a la de proceso?Address search hit TOP without matching pattern/
* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE invalid key
*no hay registros/Address search hit BOTTOM without matching pattern"CARGAJUR.CBL" [Modified] line 991 of 1180 --83%-- :w"CARGAJUR.CBL" 1180 lines, 50714 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $exitfg  vi CARGAJUR.lstfg             cob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1630     end-if.
*  14-S**********                                                      (   0)**
**    Invalid operand
* Total Messages:     1
* Unrecoverable :     0                    Severe  :     1
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL

* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE invalid key
*no hay registros/end.ifmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE invalid key
*no hay registros
exit paragraph*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivoperform until EST-BDIIALE not = "00"read BDIIALE next recordevaluate EST-BDIIALEwhen "00"
if FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD
delete BDIIALE
if EST-BDIIALE = "00"
add 1 to N-ale-borradaselse
*error en la eliminacion
display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAend-if
end-if
when "10"
*fin de archivo: sale normalmentecontinue
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time.
*    leer JURAD a ver si hay registros despues del "T"9000-CANCELAR-PROGRAMA.
******************************************************************//03 E-hay-errorpic xx.*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input(1:80) not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay reg-input(1:80)move reg-input(1:80) to reg-input-anteriorend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchexit program.end program PONERR.end program ACTALEJUR.******************************************************************
* De aqu\055 para abajo se puede eliminar, son recortes del programa
* ejemplo
******************************************************************/Address search hit BOTTOM without matching pattern?start BDIIALE key > LLAVE-BDIIALE invalid key*no hay registros
exit paragraph*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivoperform until EST-BDIIALE not = "00"read BDIIALE next recordevaluate EST-BDIIALEwhen "00"
if FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD
delete BDIIALE
if EST-BDIIALE = "00"
add 1 to N-ale-borradaselse
*error en la eliminacion
display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAend-if
end-if
when "10"
*fin de archivo: sale normalmentecontinue
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time.
*    leer JURAD a ver si hay registros despues del "T"9000-CANCELAR-PROGRAMA.
******************************************************************
* Procedimiento standard de cancelacion de programa batch??display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-perform??* Hace el reemplazo de los valores adecuados en los templates* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-num
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all spacemove LA-numx(9:12) to LA-valor(2)string LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso)accept P-command-line from COMMAND-LINEdisplay "command line: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real
* TODO: controlar los componentes del filename
OPEN MODE                      $CHANGE MODEend-string:w"CARGAJUR.CBL" 1181 lines, 50740 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
  1630         end-string
*  14-S******************                                              (   0)**
**    Invalid operand
* Total Messages:     1
* Unrecoverable :     0                    Severe  :     1
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23580     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
* Hace el reemplazo de los valores adecuados en los templates* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-num
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all spacemove LA-numx(9:12) to LA-valor(2)string LA-parte(LAx, 1) LA-valor(1)LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)LA-parte(LAx, 10) LA-valor(10)delimited by high-valueend-stringend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso)accept P-command-line from COMMAND-LINEdisplay "command line: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real* TODO: controlar los componentes del filename
REPLACE 1 CHAR*
*
*
*
*
*
*OPEN MODE      * >>>> esto está anulado por que no se cómo hacer para que lo compileREPLACE 1 CHARREPLACE 1 CHARe****************************************************************4320-ARMAR-TEXTO-ALERTA.
OPEN MODE      * >>>> da error en el end-if
OPEN MODE* nombre del archivo de entrada (que contiene el tipo de proceso)
* >>>> esto está anulado por que no ee cómo hacer para que lo compile* >>>> esto está anulado por que no ee cómo hacer para que lo compile noREPLACE 1 CHARs





s* >>>> esto está anulado por que nosee cómo hacer para que lo compile:w"CARGAJUR.CBL" 1184 lines, 50983 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       23800     Code:       22127
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:     23536  Code:     44244  Literals:      1592  Dynamic:   1458176
/d/iccol/desarrollo $cd^H^H      
/d/iccol/desarrollo $te 
/d/iccol/desarrollo $x CARGAJUR

Load error : file 'CARGAJUR'
error code: 173, pc=0, call=1, seg=0
173     Called program file not found in drive/directory 


real    0m0.02s
user    0m0.00s
sys     0m0.00s

Inicio de Programa:  2014/05/15 18:20:41
Fin de Programa:     2014/05/15 18:20:41

/d/iccol/desarrollo $fu
/d/iccol/desarrollo $x CARGAJUR

Load error : file 'CARGAJUR'
error code: 173, pc=0, call=1, seg=0
173     Called program file not found in drive/directory 


real    0m0.02s
user    0m0.00s
sys     0m0.00s

Inicio de Programa:  2014/05/15 18:21:16
Fin de Programa:     2014/05/15 18:21:16

/d/iccol/desarrollo $which x
/d/iccol/desarrollo/macros/x
/d/iccol/desarrollo $view /d/iccol/desarrollo/macros/x
"/d/iccol/desarrollo/macros/x" [Read only] 61 lines, 1423 characters :
# x.v.02.0001
# Macro para ejecucion de programas COBOL.
#


#*******************
# Manejo de senales
#*******************
maneja_senal() {
   fecha=`date '+%Y/%m/%d %H:%M:%S'`
   senal=`echo $senal | awk '{ printf("%5d", $1) }'`
   echo "$fecha $fecha $maquina $usuario trap $senal $pid $params" >> $archivo
}


#******************
# Modulo principal
#******************

trap "senal=1 ; maneja_senal" 1
trap "senal=2 ; maneja_senal" 2
trap "senal=3 ; maneja_senal" 3
trap "senal=4 ; maneja_senal" 4
trap "senal=5 ; maneja_senal" 5
trap "senal=6 ; maneja_senal" 6
trap "senal=7 ; maneja_senal" 7
trap "senal=8 ; maneja_senal" 8
trap "senal=9 ; maneja_senal" 9
trap "senal=10 ; maneja_senal" 10
#trap "senal=11 ; maneja_senal" 11
trap "senal=12 ; maneja_senal" 12
trap "senal=13 ; maneja_senal" 13
trap "senal=14 ; maneja_senal" 14
trap "senal=15 ; maneja_senal" 15

archivo=$TEMPORALES/.LOG-X
usuario=$LOGNAME
maquina=`uname -n`
pid=`echo $$ | awk '{ printf("%5d", $1) }'`
params=$*

fecha=`date '+%Y/%m/%d %H:%M:%S'`
echo "$fecha $maquina $usuario start "xxxx" $pid $params" >> $archivo
fec_ini=$fecha

time cobrun $*

ret_code=$?"/d/iccol/desarrollo/macros/x" [Read only] 61 lines, 1423 characters
ret_code=$?
ret_code=`echo $ret_code | awk '{ printf("%5d", $1) }'`

fecha=`date '+%Y/%m/%d %H:%M:%S'`
echo "$fecha $maquina $usuario stop $ret_code $pid $params" >> $archivo
fec_fin=$fecha

echo
echo "Inicio de Programa: " $fec_ini
echo "Fin de Programa:    " $fec_fin
echo

exit $ret_code
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:
# x.v.02.0001
# Macro para ejecucion de programas COBOL.
#


#*******************
# Manejo de senales
#*******************
maneja_senal() {
   fecha=`date '+%Y/%m/%d %H:%M:%S'`
   senal=`echo $senal | awk '{ printf("%5d", $1) }'`
   echo "$fecha $fecha $maquina $usuario trap $senal $pid $params" >> $archivo
}


#******************
# Modulo principal
#******************

trap "senal=1 ; maneja_senal" 1
trap "senal=2 ; maneja_senal" 2
trap "senal=3 ; maneja_senal" 3
trap "senal=4 ; maneja_senal" 4
trap "senal=5 ; maneja_senal" 5
trap "senal=6 ; maneja_senal" 6
trap "senal=7 ; maneja_senal" 7
trap "senal=8 ; maneja_senal" 8
trap "senal=9 ; maneja_senal" 9
trap "senal=10 ; maneja_senal" 10
#trap "senal=11 ; maneja_senal" 11
trap "senal=12 ; maneja_senal" 12
trap "senal=13 ; maneja_senal" 13
trap "senal=14 ; maneja_senal" 14
trap "senal=15 ; maneja_senal" 15

archivo=$TEMPORALES/.LOG-X
usuario=$LOGNAME
maquina=`uname -n`
pid=`echo $$ | awk '{ printf("%5d", $1) }'`
params=$*

fecha=`date '+%Y/%m/%d %H:%M:%S'`
echo "$fecha $maquina $usuario start "xxxx" $pid $params" >> $archivo
fec_ini=$fecha

time cobrun $*

ret_code=$?"/d/iccol/desarrollo/macros/x" [Read only] line 1 of 61 --1%-- :q/d/iccol/desarrollo $fu
/d/iccol/desarrollo $des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       23800     Code:       22127
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:     23536  Code:     42772  Literals:      1520  Dynamic:   1392640

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo $x CARGAJUR
Carga de archivo JURAD
command line:                                                                                 
El tipo de proceso    es invalido (debe ser 01 02 03 o 04)
Proceso cancelado

real    0m0.02s
user    0m0.00s
sys     0m0.01s

Inicio de Programa:  2014/05/15 18:37:34
Fin de Programa:     2014/05/15 18:37:34

/d/iccol/desarrollo $fg
vi CARGAJUR.CBL

4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
* >>>> esto está anulado por que nosee cómo hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-num
* >>>> esto está anulado por que nosee cómo hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all spacemove LA-numx(9:12) to LA-valor(2)
* >>>> esto está anulado por que no ee cómo hacer para que lo compile
* >>>> da error en el end-if
*string LA-parte(LAx, 1) LA-valor(1)
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status******************************************************************
******************************************************************
copy BDIIDIAN.FS.******************************************************************
******************************************************************
copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==./real************************************************************************************************************************************
******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.
05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).
******************************************************************
* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.
01 P-parametros.
*    Proceso real: contiene "SI" para activar
* TODO: fijo en "NO" para pruebas03 P-proceso-realpic xx value "NO".88 PROCESO-REALvalue "SI".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Código de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt/proceso-real//

1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso)accept P-command-line from COMMAND-LINEdisplay "command line: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real
* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01" *> 01 Envio Original - Carga TOTAL 1a vezdisplay "01 Envio Original - Carga TOTAL 1a vez"when "02" *> 02 Archivo Semanal - Carga PARCIALdisplay "02 Archivo Semanal - Carga PARCIAL"when "03" *> 03 Archivo Mensual - Carga PARCIALdisplay "03 Archivo Mensual - Carga PARCIAL"when "04" *> 04 Refresque Total - Carga TOTALdisplay "04 Refresque Total - Carga TOTAL"when other
*valor invalido
display "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAend-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD
string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDD* Calcula una decha 50 años posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50/
* Apertura del archivo de erroresstring P-file-name(1:19) "_ERRORES.txt" intoERRS-file-nameopen output ERRSevaluate ERRS-fs
when "00"
continue
when other
display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
* >>>> esto da un error de compilación que no puedo resolver
* >>>> por ahora está anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)//Address search hit BOTTOM without matching patterndisplay "Carga de archivo JURAD"* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso)accept P-command-line from COMMAND-LINEdisplay "command line: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real
* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01" *> 01 Envio Original - Carga TOTAL 1a vezdisplay "01 Envio Original - Carga TOTAL 1a vez"when "02" *> 02 Archivo Semanal - Carga PARCIALdisplay "02 Archivo Semanal - Carga PARCIAL"when "03" *> 03 Archivo Mensual - Carga PARCIALdisplay "03 Archivo Mensual - Carga PARCIAL"when "04" *> 04 Refresque Total - Carga TOTALdisplay "04 Refresque Total - Carga TOTAL"when other
*valor invalido
display "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAend-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD
string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDD* Calcula una decha 50 años posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entradaopen input JURADevaluate JURAD-fs
when "00"
continue
when other
display "Error en open del archivo jurad "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura del archivo de errores
4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
* >>>> esto está anulado por que nosee cómo hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-num
* >>>> esto está anulado por que nosee cómo hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all spacemove LA-numx(9:12) to LA-valor(2)
* >>>> esto está anulado por que no ee cómo hacer para que lo compile
* >>>> da error en el end-if
*string LA-parte(LAx, 1) LA-valor(1)
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistosodisplay "Carga de archivo JURAD"
display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-ELIMINAR-BDIIALE.
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.else
display "Eliminación de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEread BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "20" thru "29"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificación de una alerta existente
* Si no exist\055a muestra un mensaje y continúa
******************************************************************
*    si el registro no exist\055a es un errorif EST-BDIIALE not = "00"display "Modificación de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeend-if
*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.4300-MODIFICAR-BDIIALE-E.
******************************************************************
* Eliminación de una alerta
* Si no exist\055a muestra un mensaje y continúa
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
display "Eliminación de alerta inexistente "
/write\|deleteAddress search hit BOTTOM without matching pattern
?Address search hit TOP without matching pattern
/writemove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEread BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "20" thru "29"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALE* Modificación de una alerta existente* Si no exist\055a muestra un mensaje y continúa
******************************************************************
*    si el registro no exist\055a es un errorif EST-BDIIALE not = "00"display "Modificación de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeend-if
*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.4300-MODIFICAR-BDIIALE-E.
******************************************************************
* Eliminación de una alerta
* Si no exist\055a muestra un mensaje y continúa
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
display "Eliminación de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEwhen "I"
perform 4300-MODIFICAR-BDIIALE-Iwhen "M"
perform 4300-MODIFICAR-BDIIALE-Mwhen "E"
perform 4300-MODIFICAR-BDIIALE-Ewhen other
*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg n°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
******************************************************************
* Inserción de una alerta nueva
* Si ya exist\055a muestra un mensaje y continúa
******************************************************************
*    si el registro exist\055a es un errorif EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificación de una alerta existente
* Si no exist\055a muestra un mensaje y continúa
xistREPLACE 1 CHARii\05

istr\05INSERT MODEimove "J002" to LLASEC-BDIIALE*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.4300-MODIFICAR-BDIIALE-DATOS.
******************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
******************************************************************
*    completa la clave e intenta leer la alerta, si se leyó OK
*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadwhen "I"
perform 4300-MODIFICAR-BDIIALE-Iwhen "M"
perform 4300-MODIFICAR-BDIIALE-Mwhen "E"
perform 4300-MODIFICAR-BDIIALE-Ewhen other
*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg n°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
******************************************************************
* Inserción de una alerta nueva
* Si ya existia muestra un mensaje y continúa
******************************************************************
*    si el registro existia es un errorif EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadwhen "I"
perform 4300-MODIFICAR-BDIIALE-Iwhen "M"
perform 4300-MODIFICAR-BDIIALE-Mwhen "E"
perform 4300-MODIFICAR-BDIIALE-Ewhen other
*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg n°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
******************************************************************
* Inserción de una alerta nueva
* Si ya existia muestra un mensaje y continúa
******************************************************************
*    si el registro existia es un errorif EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.

4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificación de una alerta existente
* Si no exist\055a muestra un mensaje y continúa
******************************************************************
*    si el registro no exist\055a es un errorif EST-BDIIALE not = "00"display "Modificación de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeend-if
*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.4300-MODIFICAR-BDIIALE-E.
******************************************************************
* Eliminación de una alerta
* Si no exist\055a muestra un mensaje y continúa
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
display "Eliminación de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Usa los datos del reg input, excepto LLASEC que esta precargado* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEread BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "20" thru "29"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other


     OPEN MODE           if not PROCESO-REAL 
OPEN MODE               exit paragraph
OPEN MODE           end ifREPLACE 1 CHAR-******************************************************************* Regraba un registro modificado en BDIIALE
******************************************************************rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-ELIMINAR-BDIIALE.
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    según se trate de demandas o embargosif JURAD-demandas-vigentes not = 0


if not PROCESO-REAL
exit paragraph
end-ifif not PROCESO-REAL
exit paragraph
end-if:w"CARGAJUR.CBL" 1193 lines, 51221 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fgx CARGAJURdes-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       23800     Code:       22190
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:     23536  Code:     42964  Literals:      1520  Dynamic:   1409024

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo $  
/d/iccol/desarrollo $x CARGAJUR
Carga de archivo JURAD
command line:                                                                                 
El tipo de proceso    es invalido (debe ser 01 02 03 o 04)
Proceso cancelado

real    0m0.03s
user    0m0.00s
sys     0m0.00s

Inicio de Programa:  2014/05/15 18:48:56
Fin de Programa:     2014/05/15 18:48:56

/d/iccol/desarrollo $^[  /d/iccol/desarrollo $x CARGAJURx CARGAJUR 9999990010101.txt
Carga de archivo JURAD
command line: 9999990010101.txt                                                               
El tipo de proceso    es invalido (debe ser 01 02 03 o 04)
Proceso cancelado

real    0m0.02s
user    0m0.00s
sys     0m0.00s

Inicio de Programa:  2014/05/15 18:49:41
Fin de Programa:     2014/05/15 18:49:41

/d/iccol/desarrollo $^[  /d/iccol/desarrollo $x CARGAJUR 9999990010101.txt/d/iccol/desarrollo $x CARGAJUR .txt             9.txt9.txt9.txt9.txt9.txt9.txt1.txt0.txt0.txt1.txt5.txt0.txt5.txt1.txt4.txt0.txt1.txt0.txt2.txt
Carga de archivo JURAD
command line: 9999991001505140102.txt                                                         
02 Archivo Semanal - Carga PARCIAL
Error en open del archivo jurad 
Nombre del archivo: 9999991001505140102.txt                                                         
File status: 35
Proceso cancelado

real    0m0.02s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/05/15 18:50:45
Fin de Programa:     2014/05/15 18:50:45

/d/iccol/desarrollo $vi 9999991000905140101.txt
"9999991000905140101.txt" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999991000905140101.txt" [New file]APPEND MODEI100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411

I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406


I100000958212LUIS GUILLERMO AVENDA\221O RODR                 0020442013050603302020000406



I100001327130GONZALO PATI\221O MORENO                        0030062013010604407619984069
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
I100002859753ERNESTO RICO                                 0050672013040602206720100435
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
I100003044362MANUEL CASTRO MU\221ETON                        0070rt2011010605300120130406
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
I200830067928C I GLOMA S A                                0110432044040601203220100406
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
I200860024151COMPUTEC SA                                  0330332011140604500120110402
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
I300600003115xxxxxx                                       0150542014010600400320120406
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
I400000163598xxxxxx                                       0330432013101002204520120406
T 00000000027                                             772774        787861        :w"9999991000905140101.txt" [New file] 28 lines, 2439 characters /d/iccol/desarrollo $^[  /d/iccol/desarrollo $vi 9999991000905140101.txt/d/iccol/desarrollo $x CARGAJUR 9999991001505140102.txt/d/iccol/desarrollo $x CARGAJUR                        9999991000905140101.txt
Carga de archivo JURAD
command line: 9999991000905140101.txt                                                         
01 Envio Original - Carga TOTAL 1a vez
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 002044201305060330202
Error 06 Numero de demandas vigentes: debe ser numerico             
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
6                                                                               
Error 01 Tipo de movimiento invalido, debe ser I M E T              
Error 02 Tipo de identificación invalido, debe ser 1 2 3 4         
Error 03 Numero de identificación invalido, debe ser numerico      
Error 04 Tipo de identificación debe ser mayor que cero            
Error 05 Falta el nombre o denominacion                             
Error 06 Numero de demandas vigentes: debe ser numerico             
Error 07 Numero de demandas terminadas: debe ser numerico           
Error 08 Fecha ultima demanda vigente YYMMDD: debe ser numerica     
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 10 Numero de embargos vigentes: debe ser numerico             
Error 11 Numero de embargos terminados: debe ser numerico           
Error 12 Fecha ultimo embargo vigente YYMMDD: debe ser numerica     
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100001327130GONZALO PATIÑO MORENO                        003006201301060440761
Error 06 Numero de demandas vigentes: debe ser numerico             
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
9                                                                               
Error 01 Tipo de movimiento invalido, debe ser I M E T              
Error 02 Tipo de identificación invalido, debe ser 1 2 3 4         
Error 03 Numero de identificación invalido, debe ser numerico      
Error 04 Tipo de identificación debe ser mayor que cero            
Error 05 Falta el nombre o denominacion                             
Error 06 Numero de demandas vigentes: debe ser numerico             
Error 07 Numero de demandas terminadas: debe ser numerico           
Error 08 Fecha ultima demanda vigente YYMMDD: debe ser numerica     
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 10 Numero de embargos vigentes: debe ser numerico             
Error 11 Numero de embargos terminados: debe ser numerico           
Error 12 Fecha ultimo embargo vigente YYMMDD: debe ser numerica     
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100002859753ERNESTO RICO                                 0050672013040602206720
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100003044362MANUEL CASTRO MUÑETON                        0070rt201101060530012
Error 06 Numero de demandas vigentes: debe ser numerico             
Error 07 Numero de demandas terminadas: debe ser numerico           
Error 08 Fecha ultima demanda vigente YYMMDD: debe ser numerica     
6                                                                               
Error 01 Tipo de movimiento invalido, debe ser I M E T              
Error 02 Tipo de identificación invalido, debe ser 1 2 3 4         
Error 03 Numero de identificación invalido, debe ser numerico      
Error 04 Tipo de identificación debe ser mayor que cero            
Error 05 Falta el nombre o denominacion                             
Error 06 Numero de demandas vigentes: debe ser numerico             
Error 07 Numero de demandas terminadas: debe ser numerico           
Error 08 Fecha ultima demanda vigente YYMMDD: debe ser numerica     
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 10 Numero de embargos vigentes: debe ser numerico             
Error 11 Numero de embargos terminados: debe ser numerico           
Error 12 Fecha ultimo embargo vigente YYMMDD: debe ser numerica     
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100003295380HENRY REY BARBOSA                            0080452013011123200220
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200811046741SALUD AXIAL LTDA                             0440761998406903400219
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200830067928C I GLOMA S A                                0110432044040601203220
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200860024151COMPUTEC SA                                  0330332011140604500120
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I300600003115xxxxxx                                       0150542014010600400320
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I400000266423SIMONE MARTINEZ                              033002201312060070rt20
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 12 Fecha ultimo embargo vigente YYMMDD: debe ser numerica     
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I400000136711ARIAS NILO RIESCO                            0110232011041100905720
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        
I400000163598xxxxxx                                       0330432013101002204520
Error 09 Fecha ultima demanda vigente YYMMDD: fuera de rango        
Error 13 Fecha ultimo embargo vigente YYMMDD: fuera de rango        

real    0m0.03s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/05/15 18:55:12
Fin de Programa:     2014/05/15 18:55:12

/d/iccol/desarrollo $^DYou have stopped jobs
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
******************************************************************* Regraba un registro modificado en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-ELIMINAR-BDIIALE.
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************
* TODO: >>>> implementar la grabación del archivo ERRSdisplay "NO GRABA ERRS".4320-ARMAR-TEXTO-ALERTA.:q/d/iccol/desarrollo $^D
