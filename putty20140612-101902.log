=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.12 10:19:02 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Wed Jun 11 13:37:14 2014 from 172.16.10.105
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>/vi \$F         vi $FUENTES/CARGAJUR.CBL
"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL" 1648 lines, 69538 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL" 1648 lines, 69538 characters[1] + Stopped (SIGTSTP)        vi $FUENTES/CARGAJUR.CBL
/d/iccol/desarrollo>te
/d/iccol/desarrollo/temporales>vi qq
"qq" [Incomplete last line] 47 lines, 3545 characters ^[)0^[[0m^O^O^[[0m^O^[)0^[[?7h^[[>^[[?1l^[ F^[[?4l^[[H^[[J^[[47B^[[K
^[[K^[[2A^[[K^[[3B^[[K^[[H^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
^[[K
@
@
@^"qq" [Incomplete last line] 47 lines, 3545 characters^
^[[K^[[H^[[J^[[H^[[J^[[H^[[J^[[H^[[J^[[H^[[J^[[H^[[J^[[49B^[[K^[[H^[[C^[[C3238^[[K^[[2;3H3239 0000-PROGRAMA-PRINCIPAL.^[[K^[[3;3H3240D^[[4C^[[1mdisplay "0000-PROG
RAMA-PRINCIPAL"^[[0m^O^[[K^[[4;3H3241******************************************************************^[[K^[[5;3H3242*^[[4Cinicializa el ambiente y abre los arch
ivos^[[K^[[6;3H3243^[[5Cperform 1000-RUTINA-INICIAL^[[K^[[7;3H3244*^[[4Cprocesa cada uno de los registros del archivo JURAD hasta^[[K^[[8;3H3245*^[[4Cencontrar el
 registro "T" de totales^[[K^[[9;3H3246^[[5Cperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"^[[K^[[10;3H3247*^[[4Ccierra archivos y produce el reporte
final^[[K^[[11;3H3248^[[5Cperform 7000-RUTINA-FINAL^[[K^[[12;3H3249^[[5Cgoback.^[[K^[[13;3H3250^[[K^[[14;3H3251 4000-PROCESAR-REGISTRO.^[[K^[[15;3H3252D^[[4Cdispl
ay "4000-PROCESAR-REGISTRO"^[[K^[[16;3H3253****************************************************************^[[K^[[17;3H3254* Proceso de un registro del archivo de
 entrada JURAD^[[K^[[18;3H3255* Lectura y control del file status del archivo^[[K^[[19;3H3256****************************************************************^[[K^
[[20;3H3257*^[[4Clectura del proximo registro^[[K^[[21;3H3258^[[5Cread JURAD^[[K^[[22;3H3259^[[5Cevaluate JURAD-fs^[[K^[[23;3H3260^[[5Cwhen "00"^[[K^[[24;3H3261D^
[[8Cdisplay " "^[[K^[[25;3H3262D^[[8Cdisplay " "^[[K^[[26;3H3263D^[[8Cdisplay JURAD-reg^[[K^[[27;3H3264*^[[8Ccontrola el reg y lo aplica si es OK^[[K^[[28;3H3265^
[[9Cperform 4000-PROCESAR-REGISTRO-2^[[K^[[29;3H3266^[[9Cmove JURAD-reg to JURAD-reg-anterior^[[K^[[30;3H3267^[[9Cadd 1 to REG-LEIDOS^[[K^[[31;3H3268^[[5Cwhen "10
"^[[K^[[32;3H3269*^[[8Cfin del archivo de input:^[[K^[[33;3H3270*^[[8Cesto es un error, no se encontro el registro "T" antes^[[K^[[34;3H3271*^[[8Cde que se termin
ara el archivo^[[K^[[35;3H3272^[[9Cdisplay "Falta el reg de totales del archivo JURAD "^[[K^[[36;3H3273^[[9Cdisplay "Nombre del archivo: " P-file-name^[[K^[[37;3H
3274^[[9Cdisplay "File status: " JURAD-fs^[[K^[[38;3H3275^[[9Cdisplay "Ultimo registro leido: " N-reg-leidos^[[K^[[39;3H3276^[[9Cdisplay JURAD-reg-anterior^[[K^[[
40;3H3277^[[9Cperform 9000-CANCELAR-PROGRAMA^[[K^[[41;3H3278^[[5Cwhen other^[[K^[[42;3H3279*^[[8Cerror de lectura: cancelacion del proceso^[[K^[[43;3H3280^[[9Cdis
play "Error en lectura del archivo JURAD "^[[K^[[44;3H3281^[[9Cdisplay "Nombre del archivo: " P-file-name^[[K^[[45;3H3282^[[9Cdisplay "File status: " JURAD-fs^[[K
^[[46;3H3283^[[9Cdisplay "Ultimo registro leido: " N-reg-leidos^[[K^[[3;12H^[[47;1HAnimate^Nq^O^[[0m^OCARGAJUR.gnt/.o/.exe^Nqqqqqqqqqqqqqqqq^O^[[0m^OLevel=**^Nq^O
^[[0m^OSpeed=5^Nq^O^[[0m^OIns^Nq^O^[[0m^OCaps^Nq^O^[[0m^ONum^Nq^O^[[0m^OScroll   ^[E^[[47;62H^[[1mIns^[[0m^O^Nq^O^[[0m^O^[[1mCaps^[[0m^O^Nq^O^[[0m^O^[[1mNum^[[0m^
O^Nq^O^[[0m^O^[[1mScroll^[[0m^O   ^[E^[[1mF1^[[0m^O=help ^[[1mF2^[[0m^O=view ^[[1mF3^[[0m^O=align ^[[1mF4^[[0m^O=exchange ^[[1mF5^[[0m^O=where ^[[1mF6^[[0m^O=look
-up  ^[[1mF9^[[0m^O/^[[1mF10^[[0m^O=word-^[[1m<^[[0m^O/^[[1m>^[[0m^O ^[[1mEsc^[[0m^Oape   ^[E^[[1mS^[[0m^Otep ^[[1mG^[[0m^Oo ^[[1mZ^[[0m^Ooom ^[[1mP^[[0m^Oerform
^[[1mR^[[0m^Oeset ^[[1mB^[[0m^Oreak ^[[1mE^[[0m^Onv ^[[1mQ^[[0m^Ouery ^[[1mF^[[0m^Oind ^[[1mL^[[0m^Oocate ^[[1mT^[[0m^Oext Do View-threads ^[[1mM^[[0m^Oore   ^[E^
[[3;12H^[[48;81H   ^[EExit from animator ?  ^[[1mY^[[0m^Oes/^[[1mN^[[0m^Oo/^[[1mD^[[0m^Oetach^[[K^[[3;12H^[[48;81H   ^[E^[[1mS^[[0m^Otep ^[[1mG^[[0m^Oo ^[[1mZ^[[0
m^Ooom ^[[1mP^[[0m^Oerform ^[[1mR^[[0m^Oeset ^[[1mB^[[0m^Oreak ^[[1mE^[[0m^Onv ^[[1mQ^[[0m^Ouery ^[[1mF^[[0m^Oind ^[[1mL^[[0m^Oocate ^[[1mT^[[0m^Oext Do View-thre
ads ^[[1mM^[[0m^Oore   ^[E^[[3;12H^[[50;1H^[[H^[[J^[[0m^O^[[49B^[E:q/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>vi qqte   vi $FUENTES/CARGAJUR.CBL. viset                 fu     jobsvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.05s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>ls -l qq
-rw-rw-r--   1 icjlud   icdatacr   20270 Jun 12 08:29 qq
/d/iccol/desarrollo/temporales>des^[[A  /d/iccol/desarrollo/temporales>dessls -l qq        /des-des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>des-c-v CARGAJURls -l qq        vi qq   x CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.05s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>fg
vi $FUENTES/CARGAJUR.CBL
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/procedure03pic x(300).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************
PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL
*    1000-NOT-USED
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.[1] + Stopped (SIGTSTP)        vi $FUENTES/CARGAJUR.CBL
/d/iccol/desarrollo/temporales>ls -l CARGAJUR*
-rw-rw-r--   1 icjlud   icdatacr    2413 Jun 11 17:54 CARGAJUR.aif
-rw-rw-r--   1 icjlud   icdatacr  125544 Jun 11 12:11 CARGAJUR.gnt
-rw-rw-r--   1 icjlud   icdatacr  444160 Jun 11 12:11 CARGAJUR.idy
-rw-rw-r--   1 icjlud   icdatacr  110080 Jun 11 12:11 CARGAJUR.int
-rw-rw-r--   1 icjlud   icdatacr 1211198 Jun 11 12:11 CARGAJUR.lst
-rw-rw-r--   1 icjlud   icdatacr  955505 Jun 11 12:11 CARGAJUR.s
/d/iccol/desarrollo/temporales>rm  CARGAJUR.aif CARGAJUR.gnt  CARGAJUR.idy CARGAJUR.int CARGAJUR.s
/d/iccol/desarrollo/temporales>^[[A  /d/iccol/desarrollo/temporales>rm  CARGAJUR.aif CARGAJUR.gnt  CARGAJUR.idy CA>/d/iccol/desarrollo/temporales>ls -l CARGAJUR*                                /d/iccol/desarrollo/temporales>
-rw-rw-r--   1 icjlud   icdatacr 1211198 Jun 11 12:11 CARGAJUR.lst
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>ls -l CARGAJUR*rm  CARGAJUR.aif CARGAJUR.gnt  CARGAJUR.idy CA>/d/iccol/desarrollo/temporales>ls -l CARGAJUR*                                /d/iccol/desarrollo/temporales>fg             vi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.06s
user    0m0.02s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>fg
vi $FUENTES/CARGAJUR.CBL
*    7000-RUTINA-FINAL*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.****************************************************************** mmiiccrrooffooccuuss$CHANGE MODE.:w"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL" 1648 lines, 69518 characters [1] + Stopped (SIGTSTP)        vi $FUENTES/CARGAJUR.CBL
/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fufgvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/fuentes>ls -l CARGAJUR*                           /d/iccol/desarrollo/fuentes>rm  CARGAJUR.aif CARGAJUR.gnt  CARGAJUR.idy CARGA>/d/iccol/desarrollo/fuentes>ls -l CARGAJUR*                                   /d/iccol/desarrollo/fuentes>fg             vi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                          /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>te
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>tedes-c-v CARGAJURfu              fgvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.04s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>rm qq
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>rm qqvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.04s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>ls -l qq
-rw-rw-r--   1 icjlud   icdatacr   20270 Jun 12 08:35 qq
/d/iccol/desarrollo/temporales>which CARGAJUR
no CARGAJUR in /usr/j2se/jre/sh /usr/j2se/sh /usr/j2se/bin /usr/j2se/jre/bin /opt/mfocus/des/cobol/lib /opt/mfocus/des/cobol/bin /usr/bin /bin /usr/bin /d/iccol/desarrollo/macros /d/iccol/desarrollo/utiles /opt/bin /usr/sbin /usr/lib /usr/ccs/bin /opt/SUNWspro/bin /usr/jdk/latest/bin /usr/local/bin /usr/j2se/bin /usr/openwin/bin . /export/home/db2inst1/sqllib/bin /export/home/db2inst1/sqllib/adm /export/home/db2inst1/sqllib/misc
/d/iccol/desarrollo/temporales>env | RM  grep RM
TERMINALES=/d/iccol/desarrollo/terminales
TERM=vt220
/d/iccol/desarrollo/temporales>which x
/d/iccol/desarrollo/macros/x
/d/iccol/desarrollo/temporales>cat /d/iccol/desarrollo/macros/x
:
# x.v.02.0001
# Macro para ejecucion de programas COBOL.
#


#*******************
# Manejo de senales
#*******************
maneja_senal() {
   fecha=`date '+%Y/%m/%d %H:%M:%S'`
   senal=`echo $senal | awk '{ printf("%5d", $1) }'`
   echo "$fecha $fecha $maquina $usuario trap $senal $pid $params" >> $archivo
}


#******************
# Modulo principal
#******************

trap "senal=1 ; maneja_senal" 1 
trap "senal=2 ; maneja_senal" 2 
trap "senal=3 ; maneja_senal" 3 
trap "senal=4 ; maneja_senal" 4 
trap "senal=5 ; maneja_senal" 5 
trap "senal=6 ; maneja_senal" 6 
trap "senal=7 ; maneja_senal" 7 
trap "senal=8 ; maneja_senal" 8 
trap "senal=9 ; maneja_senal" 9 
trap "senal=10 ; maneja_senal" 10
#trap "senal=11 ; maneja_senal" 11
trap "senal=12 ; maneja_senal" 12
trap "senal=13 ; maneja_senal" 13
trap "senal=14 ; maneja_senal" 14
trap "senal=15 ; maneja_senal" 15

archivo=$TEMPORALES/.LOG-X
usuario=$LOGNAME
maquina=`uname -n`
pid=`echo $$ | awk '{ printf("%5d", $1) }'`
params=$*

fecha=`date '+%Y/%m/%d %H:%M:%S'`
echo "$fecha $maquina $usuario start "xxxx" $pid $params" >> $archivo
fec_ini=$fecha

time cobrun $*

ret_code=$?
ret_code=`echo $ret_code | awk '{ printf("%5d", $1) }'`

fecha=`date '+%Y/%m/%d %H:%M:%S'`
echo "$fecha $maquina $usuario stop $ret_code $pid $params" >> $archivo
fec_fin=$fecha

echo
echo "Inicio de Programa: " $fec_ini
echo "Fin de Programa:    " $fec_fin
echo

exit $ret_code
/d/iccol/desarrollo/temporales>L find / -name "CARGAJUR*" -print
find: cannot read dir /var/tmp/cobAAAZeayYU: Permission denied
find: cannot read dir /var/tmp/cobAAAZDaaoc: Permission denied
find: cannot read dir /var/tmp/cobAAATRaOY0: Permission denied
find: cannot read dir /var/tmp/cobAAAt_aOc3: Permission denied
find: cannot read dir /var/tmp/cobAAAQuaOrt: Permission denied
find: cannot read dir /var/tmp/cobAAAk6aGaA: Permission denied
find: cannot read dir /var/tmp/cobAAA9GaOKd: Permission denied
find: cannot read dir /var/tmp/cobAAA8Uai02: Permission denied
find: cannot read dir /var/spool/mqueue: Permission denied
find: cannot read dir /var/spool/clientmqueue: Permission denied
find: cannot read dir /var/sma_snmp: Permission denied
find: cannot read dir /var/sadm/pkg/TSIpgxw/save: Permission denied
find: cannot read dir /var/sadm/pkg/TSIpgx/save: Permission denied
find: cannot read dir /var/sadm/pkg/TSBWvplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/TSBWvplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzuluw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzulur/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzuluc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzulu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzsh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzoneu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzoner/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzlib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfskr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsgu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzfsgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzebrau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWzebrar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWypu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWypr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwxst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwxft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwsvr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwsrv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwsrc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwslb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwrtl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwplt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwpft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwopt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwoft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwmod/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwkey/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwinc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwice/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwhl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwfs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwfnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwfa/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdxm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwdem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwcsl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwcft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxwacx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxvnc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxscreensaver-hacks/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxscreensaver-hacks-gl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-xkb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-tsol-module/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-headers/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-graphics-ddx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-doc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-devel-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-compatlinks/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-clientlibs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-client-programs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-client-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxorg-cfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxim/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilvl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilrl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxilh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxildh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxi18n/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcursor-themes/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcu6/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcu4t/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWxcu4/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwsrv/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwsr2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwrsa/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwgetu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwgetr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwebminu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwebminr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbsup/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbpro/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbcou/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbcor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWwbapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtsts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvtsmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvolu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvolr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvncviewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvldu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvld/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWvid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuxlcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusbu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusbs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusbccid/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWusb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWus/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuprl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWupdatemgru/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWupdatemgrr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWulcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWukspfw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuksp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuium/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWugenu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWugen/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuedg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudaplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudapltu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudapltr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWudaplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWucbt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWuacm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtxfnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtoo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnfd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnfc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnetr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnetd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnetc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnamr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtnamd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtltkm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtltkd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtltk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtlsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtlsd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtls/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTiff/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTiff-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTiff-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWthunderbirdl10n-fr-FR/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWthunderbirdl10n-es-ES/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWthunderbird/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-xagent/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tstripe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsoljdsselmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsoljdslabel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsoljdsdevmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsol-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-tsol-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-l10n-ui-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtgnome-l10n-ui-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtftpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtftp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtexi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtecla/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcsh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWTcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcatu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtcatr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWtavor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWswupclr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWswupcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWswmt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstsfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstsf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsthwreg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-xsltfilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-writer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-w4wfilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-sunsearchtoolbar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-ooofonts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-menuintegration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-math/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-lngutils/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-javafilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-impress/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-graphicfilter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-gnome-integration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-gallery/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsrh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-fr-res/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-fr-help/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-es-res/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-es-help/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-draw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core09/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core08/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core07/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core06/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core05/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core04/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core03/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core02/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-core01/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-calc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWstaroffice-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsshcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWssad/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsra/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsprot/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWspnego/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWspl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsolnm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsneep/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsndmu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsndmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmcmd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmbau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmbar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmbac/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsmagt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWslpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWslpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsior/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfwhea/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfwdemo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfinf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfdrr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsfdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWses/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWserweb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWservicetagr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWservicetagu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWseru/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWserr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsensorr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsensor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscsip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscsa1394/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscplp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnsomr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnsom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnprmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscnprm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscn-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscn-base-r/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscmhdlr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsckmu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsckmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsckm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscgui/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWscbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsbp2/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsasnm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsasm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsamr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsam/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsadml/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsadmi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWsacom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs9brandu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs9brandr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs8brandu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWs8brandr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrtvcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrtvcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrtvc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsmo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsgk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrpm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrpcib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWroute/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmwbu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmwbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmui/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrmodu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrealplayer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrealplayer-l10n-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrealplayer-l10n-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrds/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcmds/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcmdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcmdc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcapu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWrcapr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqusu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqus/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqosu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqos/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqlcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqlc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqfedu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWqfed/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWPython/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWPython-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWPython-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsutils/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpstl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsm-lpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsm-ipp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpsdpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWproduct-registry-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWprd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpprou/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWppror/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWppro-plugin-sunos-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWppm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppdt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpppd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostrun/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostrun-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-upgrade/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-tcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-server-data/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-pl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-jdbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-contrib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-tcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-server-data-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-pl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-contrib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-83-client/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-tcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-server/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-server-data-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-pl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-jdbc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-contrib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpostgr-82-client/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpoolr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpool/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpng/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpng-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpng-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmowu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmowr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmowm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmdbi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpmdbdpg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpltlk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWplowr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWplow1/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWplow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5v/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5u/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5p/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpl5m/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpkgcmdsu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpkgcmdsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpiclu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpiclr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpiclh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWphx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpgadmin3/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl584usr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl584man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl584core/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl-xml-parser/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWperl-xml-parser-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpdas/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcser/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcsclite/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcsclite-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcmem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcmcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcmci/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpcelx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWpamsc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWowbcp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWosdem/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensslr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-libraries/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-include/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenssl-commands/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopensp-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWopenjade-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWolrte/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWogg-vorbis/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWogg-vorbis-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWogg-vorbis-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWodtts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocfh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocfd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWocf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnxge/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWntpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWntpr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnisu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnisr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfssu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfssr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfsskr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfscu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfscr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfsckr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWncft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWncau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWncar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnamow/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnamos/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWnamdt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmysqlu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmysqlt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmysqlr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpsvplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpathadmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpathadm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpapir/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmpapi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozspell/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozpsm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznss-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznspr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmoznspr-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozmail/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozjs-debugger/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozilla/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozilla-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozgm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozdom-inspector/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozchat/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmozapoc-adapter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlibe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmlib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmkcd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmipu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmipr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmibii/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmgts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmgapp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmga/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmfrun/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmfman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmfdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmddr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdbdm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmdar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmcex/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmcdev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmccom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmcc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWmc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWman/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64xr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64w/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64cf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWm64/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxsl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxsl-python/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxml/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlxml-python/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlvmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlvmg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlvma/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluzone/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxopr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxop/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluxd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWluu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlur/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlucfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlpmsg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocaledefsrc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWloc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocalecreator/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocalecreator-l10n-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlocalecreator-l10n-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlldap/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWllcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWllc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibusbugen/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibusb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibsasl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibpopt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibpopt-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibpopt-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibmsr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibms/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibmr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibgcrypt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibgcrypt-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibexif/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibexif-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibCf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlibC/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlexpt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWless/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlcl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWlccom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWladm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkxmft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkxfnt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkvm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkrbu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkrbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkoi8f/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkmp2r/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkey/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkdcu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWkdcr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjxmft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjxcft/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjsnmp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjre-config/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjre-config-plugin/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjpg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjpg-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjpg-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjmfmp3/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjmf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjmail/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfcau/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfca/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjfb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdsver/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdsrm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjds-registration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdmk-base/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjdic/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjcom/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjavaapps/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjai/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjai-imageio/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWjaf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5rtx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5rt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dvx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dmx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dmo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5dev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj5cfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3rtx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3rt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3man/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3irt/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3dvx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3dmo/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3dev/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWj3cfg/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWixgbe/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWixgb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWisolc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWislcc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsiu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsitgtu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsitgtr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiscsir/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqum/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiquc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqjx/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqfs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiqdoc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipplu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipplr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWippcore/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipoib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipmir/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipmi/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipfu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipfr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipfh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWipc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiopc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWinttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWintgige/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWinstall-patch-utils-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWinst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiniu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWimagick/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiiimu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWiiimr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWigb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifph/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifbw/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifbr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifbcf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWifb/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidnu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidnl/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidnd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWidn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWicud/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWicu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWibsdpu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWibsdpib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWibsdp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWib/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi9rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi8rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi7rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi5rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi4rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi2rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi2cr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhmd/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi1of/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi1cs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi15rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi15cs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWi13rf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhpijs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhmdu/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhiu8/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhermon/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWhea/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgzip/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgttf/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWGtku/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWGtkr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgtar/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgssk/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgssdh/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgssc/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgss/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgsfst/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgsfot/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgscr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgpch/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnutls/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWfrdis/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnutls-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-xml-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-xml-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-wm-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-vfs-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-utility-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-utility-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-utility-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-user-docs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ui-designer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ui-designer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-themes/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-themes-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-text-editor-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-terminal-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sys-suspend/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sys-suspend-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-spell/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-spell-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sound-recorder/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sound-recorder-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-sound-recorder-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-session/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-session-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-session-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-search-tool/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-search-tool-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-search-tool-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-removable-media/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-removable-media-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ps-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ps-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-jdshelp/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-ps-viewer-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-project-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-print-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pilot-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-perf-meter/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-perf-meter-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-perf-meter-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pdf-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pdf-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-pdf-viewer-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-panel-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-mm-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-mm-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-mm-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgcmn/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-player/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-player-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-player-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-media-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-libs-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10nmessages-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10nmessages-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10ndocument-fr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-l10ndocument-es/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-jdshelp-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-intranet-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-intranet-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-intranet-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-internet-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-internet-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-internet-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-viewer-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-camera-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-img-editor-devel-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-im-client/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-im-client-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-hex-editor-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-help-viewer/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-help-viewer-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-games/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-games-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-games-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fun-applets/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fun-applets-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fun-applets-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-freedb-libs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-freedb-libs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-freedb-libs-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-fonts/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-file-mgr-devel/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dtlogin-integration/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-display-mgr/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-display-mgr-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-display-mgr-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dictionary/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dictionary-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dictionary-root/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dialog/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-dialog-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs-share/save: Permission denied
find: cannot read dir /var/sadm/pkg/SUNWgnome-desktop-prefs-root/save: Permission denied
^C/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^C
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>find / -name "CARGAJUR*" -printfind / -name "CARGAJUR*" -print 2> /dev/null
/d/iccol/desarrollo/objetos/CARGAJUR2.int
/d/iccol/desarrollo/objetos/CARGAJUR2.gnt
/d/iccol/desarrollo/objetos/CARGAJUR2.lst
/d/iccol/desarrollo/objetos/CARGAJUR2.idy
/d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo/objetos/CARGAJUR.idy
/d/iccol/desarrollo/objetos/CARGAJUR.s
/d/iccol/desarrollo/objetos/CARGAJUR.gnt
/d/iccol/desarrollo/objetos/CARGAJUR.int
/d/iccol/desarrollo/objetos/CARGAJUR2.s
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes/CARGAJUR.cbl
/d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/temporales>vi    ^[  /d/iccol/desarrollo/temporales>find / -name "CARGAJUR*" -print 2> /dev/null/d/iccol/desarrollo/temporales>find / -name "CARGAJUR*" - 2> /dev/null     l 2> /dev/nulls 2> /dev/null
117277   32 -rw-rw-r--   1 icjlud   icdatacr    32768 May 22 09:16 /d/iccol/desarrollo/objetos/CARGAJUR2.int
119395   56 -rw-rw-r--   1 icdgd    icdatacr    56723 May 22 09:16 /d/iccol/desarrollo/objetos/CARGAJUR2.gnt
119384  168 -rw-rw-r--   1 icdgd    icdatacr   158844 May 22 09:16 /d/iccol/desarrollo/objetos/CARGAJUR2.lst
119390  152 -rw-rw-r--   1 icdgd    icdatacr   144896 May 22 09:16 /d/iccol/desarrollo/objetos/CARGAJUR2.idy
122591 1192 -rw-rw-r--   1 icdgd    icdatacr  1211198 Jun 12 08:34 /d/iccol/desarrollo/objetos/CARGAJUR.lst
122593  448 -rw-rw-r--   1 icdgd    icdatacr   444160 Jun 12 08:34 /d/iccol/desarrollo/objetos/CARGAJUR.idy
122594  944 -rw-rw-r--   1 icdgd    icdatacr   955505 Jun 12 08:34 /d/iccol/desarrollo/objetos/CARGAJUR.s
122595  136 -rw-rw-r--   1 icdgd    icdatacr   125544 Jun 12 08:34 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
123332  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 08:34 /d/iccol/desarrollo/objetos/CARGAJUR.int
119394  408 -rw-rw-r--   1 icdgd    icdatacr   407481 May 22 09:16 /d/iccol/desarrollo/objetos/CARGAJUR2.s
 7608   68 -rw-rw-r--   1 icdgd    icdatacr    69518 Jun 12 08:33 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/temporales>fg
vi $FUENTES/CARGAJUR.CBL
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD
******************************************************************
FD JURAD.
01  JURAD-reg.
* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.
*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuación no está confirmedo, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-embargos-fecha-ultimo pic x(8).*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00./ina-fin*    0000-PROGRAMA-PRINCIPAL*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL
*    1000-NOT-USED
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OK//display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAend-if
end-if
when "10"
*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"N-ale-leidas
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error7000-RUTINA-FINAL.******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadas:q/d/iccol/desarrollo/temporales>vi 

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~/d/iccol/desarrollo/objetos/CARGAJUR2.intAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR2.gntAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR2.lstAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR2.idyAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR.lstAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR.idyAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR.sAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR.gntAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR.intAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/objetos/CARGAJUR2.sAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/fuentes/CARGAJUR.CBLAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/fuentes/CARGAJUR.cblAddress search hit BOTTOM without matching pattern/d/iccol/desarrollo/temporales/CARGAJUR.lstAddress search hit BOTTOM without matching patternAPPEND MODE/d/iccol/desarrollo/objetos/CARGAJUR2.int

/d/iccol/desarrollo/objetos/CARGAJUR2.gnt


/d/iccol/desarrollo/objetos/CARGAJUR2.lst



/d/iccol/desarrollo/objetos/CARGAJUR2.idy
/d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo/objetos/CARGAJUR.idy
/d/iccol/desarrollo/objetos/CARGAJUR.s
/d/iccol/desarrollo/objetos/CARGAJUR.gnt
/d/iccol/desarrollo/objetos/CARGAJUR.int
/d/iccol/desarrollo/objetos/CARGAJUR2.s
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes/CARGAJUR.cbl
/d/iccol/desarrollo/temporales/CARGAJUR.lstINSERT MODErm rm 
rm 
rm 
rm 
rm 
rm 
rm 
rm 
rm 
rm 


~
~
~!Incomplete shell escape command - use 'shell' to get a shell[1] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.int
rm /d/iccol/desarrollo/objetos/CARGAJUR2.gnt
/d/iccol/desarrollo/temporales>/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.gnt
/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.lst
/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.idy
rm /d/iccol/desarrollo/objetos/CARGAJUR.lst
rm /d/iccol/desarrollo/objetos/CARGAJUR.idy
/d/iccol/desarrollo/temporales>/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo/temporales>/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.idy
/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.s
rm /d/iccol/desarrollo/objetos/CARGAJUR.gnt
/d/iccol/desarrollo/temporales>/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.gnt
/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.int
rm /d/iccol/desarrollo/objetos/CARGAJUR2.s
/d/iccol/desarrollo/temporales>/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.s
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.s/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.int/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.gnt/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.s  /d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.idy/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.idy/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.lst/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.gnt/d/iccol/desarrollo/temporales>rm /d/iccol/desarrollo/objetos/CARGAJUR2.int/d/iccol/desarrollo/temporales>vi                                          /d/iccol/desarrollo/temporales>fgfind / -name "CARGAJUR*" -ls 2> /dev/null/d/iccol/desarrollo/temporales>
 7608   68 -rw-rw-r--   1 icdgd    icdatacr    69518 Jun 12 08:33 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>/x CARx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

Load error : file 'CARGAJUR'
error code: 173, pc=0, call=1, seg=0
173     Called program file not found in drive/directory 


real    0m0.02s
user    0m0.00s
sys     0m0.00s
/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>/des-des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92341
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107860  Literals:      3744  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>te
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>tedes-c-v CARGAJURfu              x CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.06s
user    0m0.02s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>rm qq
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>rm qqvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.04s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:
el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV"qq" 562 lines, 20270 characters:q/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>vi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>rm qq                                     /d/iccol/desarrollo/temporales>vi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>te                                        /d/iccol/desarrollo/temporales>des-c-v CARGAJURfu              x CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>find / -name "CARGAJUR*" -ls 2> /dev/null /d/iccol/desarrollo/temporales>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.s
 7608   68 -rw-rw-r--   1 icdgd    icdatacr    69518 Jun 12 08:33 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/temporales>clear
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>clearfind / -name "CARGAJUR*" -ls 2> /dev/null/d/iccol/desarrollo/temporales>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.s
 7608   68 -rw-rw-r--   1 icdgd    icdatacr    69518 Jun 12 08:33 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>find / -name "CARGAJUR*" -ls 2> /dev/null/d/iccol/desarrollo/temporales>
119390  448 -rw-rw-r--   1 icjlud   icdatacr   444160 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.idy
119384  120 -rw-rw-r--   1 icjlud   icdatacr   110080 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.int
117277 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.lst
119395  136 -rw-rw-r--   1 icjlud   icdatacr   125544 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.gnt
119394  944 -rw-rw-r--   1 icjlud   icdatacr   955505 Jun 12 08:48 /d/iccol/desarrollo/objetos/CARGAJUR.s
 7608   68 -rw-rw-r--   1 icdgd    icdatacr    69518 Jun 12 08:33 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
45006   73 -rw-rw-r--   1 icjlud   icdatacr    74096 Jun 11 18:30 /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
123726 1192 -rw-rw-r--   1 icjlud   icdatacr  1211198 Jun 11 12:11 /d/iccol/desarrollo/temporales/CARGAJUR.lst
/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>ls -l   | grep "Jun 11"
-rw-rw-r--   1 227      icdatacr   21569 Jun 11  2003 ACTDAS.CBL
-rw-rw-r--   1 icjjmd   icdatacr   40329 Jun 11 14:33 BDAPLSUS.CBL
-rw-rw-r--   1 icrmbd   icdatacr    1663 Jun 11 11:35 BDLDI2.aif
-rw-rw-r--   1 icrmbd   icdatacr   19938 Jun 11 17:03 CARACTPER-PER11-CQ10994.CBL.err
-rw-rw-r--   1 icrmbd   icdatacr   11417 Jun 11 17:14 CARACTPER-PER11-CQ20201.CBL
-rw-rw-r--   1 icjlud   icdatacr   74096 Jun 11 18:30 CARGAJUR.cbl
-rw-rw-r--   1 icgjcd   icdatacr   63653 Jun 11 17:04 ccierr.log
drwxrwxr-x   2 icgjcd   icdatacr     512 Jun 11  2013 cobol-db2
-rw-rw-r--   1 icdgd    icdatacr   13674 Jun 11 17:34 COLASCOLST.CBL
-rw-rw-r--   1 icjjmd   icdatacr   86888 Jun 11 08:40 CVCIFDCRE-HSBC.CBL
-rw-rw-r--   1 icjjmd   icdatacr   86888 Jun 11 08:22 CVCIFDCRE-HSBC.CBL-jjmr
-rw-rw-r--   1 ichlgd   icdatacr 1766092905 Jun 11 23:14 DESARROLLO.zip
-rw-rw-r--   1 icrmbd   icdatacr   20213 Jun 11  2010 FRAESTPRU.CBL
-rw-rw-r--   1 icrmbd   icdatacr    2487 Jun 11 09:57 ICGCON-V256.aif
-rw-rw-r--   1 icrmbd   icdatacr 1626728 Jun 11 10:18 ICGCON.CBL
-rw-rw-r--   1 icgasd   icdatacr 1626728 Jun 11 11:10 ICGCON.CBL_20140611
-rw-rw-r--   1 icehad   icdatacr 1811138 Jun 11 11:42 ICGCPL.CBL
-rw-rw-r--   1 icgasd   icdatacr 1811138 Jun 11 11:26 ICGCPLPB.CBL
-rw-rw-r--   1 icehad   icdatacr 1810418 Jun 11 11:03 ICGCPLV258-201406141.CBL
-rw-rw-r--   1 icehad   icdatacr 1811138 Jun 11 11:39 ICGCPLV258.CBL
-rw-rw-r--   1 icehad   icdatacr 1772414 Jun 11 11:39 ICGCPLV258.CBL-FECHATEC
-rw-rw-r--   1 icehad   icdatacr 1812392 Jun 11 11:35 ICGCPLV259.CBL
-rw-r--r--   1 icrmbd   icdatacr  370871 Jun 11  2013 ICGDIRSSS.CBL
-rw-rw-r--   1 icimsd   icdatacr   19252 Jun 11 15:55 ICGKAR.CBL.err
-rw-rw-r--   1 icvhfd   icdatacr 1318718 Jun 11 17:29 ICGMDF.CBL
-rw-rw-r--   1 icjjmd   icdatacr   60626 Jun 11 15:10 ICNEBF.CBL
-rw-rw-r--   1 icdgd    icdatacr   74175 Jun 11 18:16 JURADCAR.CBL
-rw-rw-r--   1 ichbgd   icdatacr   15647 Jun 11 23:59 LOGTRANS-20140611-002
-rwxrwxr-x   1 icvhfd   icdatacr      68 Jun 11 16:02 nohup.out
-rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL
-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL
-rw-rw-r--   1 icjlud   icdatacr   20270 Jun 11 18:45 qq
-rw-rw-r--   1 icjdld   icdatacr  175537 Jun 11 16:54 SCOTBATCH-V15.CBL
-rw-rw-r--   1 1395     icdatacr  175537 Jun 11 16:06 SCOTBATCH.CBL
-rw-rw-r--   1 icjdld   icdatacr   99148 Jun 11 16:49 SCOTBATCHRMB.CBL.err
-rw-rw-r--   1 227      icdatacr    4352 Jun 11  2002 terminal.html
-rw-rw-r--   1 227      icdatacr    4404 Jun 11  2002 terminal2o.html
-rw-rw-r--   1 227      icdatacr    1688 Jun 11  2002 terminalc.c
-rw-rw-r--   1 227      icdatacr    4345 Jun 11  2002 terminalo.html
-rw-rw-r--   1 icvhfd   icdatacr 5529105 Jun 11 15:16 UTLADINOM.20140611.core
----------   1 icjdld   icdatacr   25964 Jun 11  2010 UTLCITREP.CBL-OK1
----------   1 icjdld   icdatacr   27805 Jun 11  2010 UTLCITREP.CBL-OK2
-rw-rw-r--   1 1391     icdatacr   32930 Jun 11  2009 UTLUMIGVAL.CBL-110609
-rw-rw-r--   1 1366     icdatacr   28857 Jun 11  2008 VALCTECIFINJ.CBL
/d/iccol/desarrollo/fuentes>view JURADCAR.CBL
"JURADCAR.CBL" [Read only] 1739 lines, 74175 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"JURADCAR.CBL" [Read only] 1739 lines, 74175 characters/\ 
******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD
******************************************************************
FD JURAD.
01  JURAD-reg.
* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.
*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuaciï¿½n no está £onfirmedo, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-embargos-fecha-ultimo pic x(8).*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "JURADCAR".******************************************************************
* Datos para la bï¿½squeda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  W-DERECHOSPIC 9 value 0.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"Ã\221".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  REG-VALIDAS.
03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validaciï¿½n de nombres
******************************************************************
*copy LEEMAESTROS.WS.*****************************************************************
* Variables validacion de nombres
*****************************************************************copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************copy ICFILE.WS.*****************************************************************
* Variables validacion cuentas si validar
*****************************************************************copy BDAMATCH.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.
05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).
******************************************************************
* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.
01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aï¿½os
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7).******************************************************************
* Armado de las lineas de alerta******************************************************************* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(59) value"Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(59) value"Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(59) value"El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(59) value"El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(59) value"Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(59) value"Modificaciï¿½n de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(59) value"Eliminaciï¿½n de alerta inexistente".
*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.03pic xx.03pic x(300).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************/***********************************************************************************************************************************
PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL
*    1000-NOT-USED
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"
****************************************************************
* Proceso de un registro del archivo de entrada JURAD***************************************************************** Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
Ddisplay " "
Ddisplay " "
Ddisplay JURAD-reg
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4000-PROCESAR-REGISTRO-2.
D    display "4000-PROCESAR-REGISTRO-2"
****************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg
****************************************************************move "NO" to E-hay-error*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-erroresend-if/ina-findisplay "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAend-if
end-if
when "10"
*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leí¤¯s:"N-ale-leidas
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
D    display "7000-RUTINA-FINAL"
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos má³\212close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDODISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-RDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN:q/d/iccol/desarrollo/fuentes>vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~APPEND MODEsdiff -7 170 -w 170 JURADCAR.CBL CARGAJUR.CBL





sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
!Incomplete shell escape command - use 'shell' to get a shell
!sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL
      $SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
      ************************************************************************************************************************************
      * Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
      * por Jurad* por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.* el archivo ERRS.
      ************************************************************************************************************************************
 AUTHOR.Globant JL.AUTHOR.Globant JL.
 DATE-WRITTEN.DATE-WRITTEN.
 DATE-COMPILED.DATE-COMPILED.
 CONFIGURATION section.CONFIGURATION section.
 SOURCE-COMPUTER. MICROFOCUS with debugging mode.|SOURCE-COMPUTER. microfocus.
 OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
 INPUT-OUTPUT section.INPUT-OUTPUT section.
 FILE-CONTROL.FILE-CONTROL.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 select JURAD assign to P-file-pathselect JURAD assign to P-file-path
 organization is line sequentialorganization is line sequential
 file status is JURAD-fs.file status is JURAD-fs.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-name
 organization is line sequentialorganization is line sequential
 file status is ERRS-fs.file status is ERRS-fs.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIREGI.FS.copy BDIIREGI.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIDIAN.FS.copy BDIIDIAN.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIDAS.FS.copy BDIIDAS.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on record
 file status is EST-BDIIALE.==.file status is EST-BDIIALE.==.

      ************************************************************************************************************************************
      * Archivos de base alterna* Archivos de base alterna
      ************************************************************************************************************************************
 copy BDACSV.FS.copy BDACSV.FS.
 copy ICBDIR.FS.copy ICBDIR.FS.
 copy BDLCLI.FS.copy BDLCLI.FS.
 COPY ICBSUS.FS.COPY ICBSUS.FS.
1781 more linescopy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuaciï¿½n no está £onfirmedo, no se usa|* $$$$ El formato a continuación no está confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alternacopy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuaciï¿½n no está £onfirmedo, no se usa|* $$$$ El formato a continuación no está confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validaciï¿½n de nombres|* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validaciï¿½n de nombres|* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validaciï¿½n de nombres|* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.No file  line 217 of 1785 --12%-- ************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validaciï¿½n de nombres|* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.************************************************************************************************************************************* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validaciï¿½n de nombres|* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.*****************************************************************<
* Variables validacion cuentas si validar<
*****************************************************************<copy BDAMATCH.WS.<
<
<
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aï¿½os|* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta************************************************************************************************************************************* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificaciï¿½n de alerta inexistente".|"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminaciï¿½n de alerta inexistente".|"Eliminación de alerta que no existe".
>03 pic x(11) value "19 0000000 ".
>03 pic x(59) value
>"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"<
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"<
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
Ddisplay " "<
Ddisplay " "<
Ddisplay JURAD-reg<
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del proceso:g/^......D/d*ELSE|ELSE*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<END-IFEND-IFEND-IFEND-IF
>END-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGOMOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.|COPY LEEMAESTROS.PROC.COPY VALNOM.PROC.<*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
45 fewer lines01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriordisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que seï¿½alar el fin de proceso|*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriordisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que seï¿½alar el fin de proceso|*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input************************************************************************************************************************************* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.call "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
>*    parámetros para las rutinas de validación en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
|*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
|*    switches de opciones de validaciónmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3|if TIP-IDE-BDIIVIDE = 2 or 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE|move 1 to SW-DIGCHEQUEO-BDIIVIDEEND-IF|end-ifMOVE 2 TO NUM-BLOQUES-BDIIVIDE|move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificaciï¿½n contra las bases de|*    Valida el número de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id invá¬©do|*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validaciï¿½n en base alterna|*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre no coincide|* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédula4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre no coincide|* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORELSE|else
*no es una cé¤µla|*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERROREND-IF.|end-if.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre coincide|* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21elseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del cï¿½digo|*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide|*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna|*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21|*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12|*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validaciï¿½n de IDs que no figuran en las bases normales|* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificaciï¿½n está ¥n la base de datos alterna|*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre no coincide|* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORELSE|else
*no es una cé¤µla|*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERROREND-IF.|end-if.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre coincide|* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21elseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del cï¿½digo|*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide|*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna|*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21|*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12|*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validaciï¿½n de IDs que no figuran en las bases normales|* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificaciï¿½n está ¥n la base de datos alterna|*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<MOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<elseelse
*no es una cé¤µla|*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIAN<END-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedad*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosJURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente************************************************************************************************************************************* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraphend-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existe<call "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existeend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE************************************************************************************************************************************* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué °reviamente cargado con J001 o J002|*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberí¡ ser el ultimo del archivo|* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos>4800-PROCESO-REG-T-anulado.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************end-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberí¡ ser el ultimo del archivo|* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos>4800-PROCESO-REG-T-anulado.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************4900-GRABAR-ERROR.4900-GRABAR-ERROR.************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<
*delimited by high-value<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.<1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDD4900-GRABAR-ERROR.4900-GRABAR-ERROR.************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<
*delimited by high-value<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicio
accept W-hora-inicio from timeaccept W-hora-inicio from time

* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)
accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINE
display "Parametros: " P-command-linedisplay "Parametros: " P-command-line
unstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " into
P-file-name P-proceso-realP-file-name P-proceso-real

* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?
if PROCESO-REALif PROCESO-REAL
display pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"
elseelse
display pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"
end-ifend-if
end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fsopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deberí¡® cargar, aunque sea de manera|* blanco, me parece que se deberían cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasdisplay "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leí¤¯s:"|display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos má³\212close JURAD ERRS BDIIREG   |* $$$$ se agregaron varios archivos más
>close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDO|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R<DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leí¤¯s (excluí¤¯ el registro "T")|*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leí¤¯s:"|display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos má³\212close JURAD ERRS BDIIREG   |* $$$$ se agregaron varios archivos más
>close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDO|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R<DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leí¤¯s (excluí¤¯ el registro "T")|*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?************************************************************************************************************************************* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificaciï¿½n está ¥n la base de datos alterna|* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está ¤entro|*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROS
>*abre archivos y carga la tabla de direcciones
>*estandar, solo la primera vez
>IF OPEN-DIR = ZEROS
>OPEN INPUT MAESTRO-DIRECC
>OPEN INPUT BDLCLI
>OPEN INPUT SUSCRIPTOR
>OPEN INPUT MAESTRO-CREDIT
>OPEN INPUT MAESTRO-CHECK
>PERFORM 06000-U-CARGAR-TABLA-DIRESTAN
>MOVE 1 TO OPEN-DIR
>END-IF
>*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el*buscada. En caso de hallar registros se procede a realizar el
*match*matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
*MOVE 1 TO HACERMATCH-LEEMSTRS<IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCH*ELSE|ELSE*IF W-BLOQUES > 0|IF W-BLOQUES > 0*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH*END-IF<END-IFEND-IFEND-IFEND-IF>END-IF513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
END-IFEND-IFEND-IFEND-IF
>END-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGOMOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.|COPY LEEMAESTROS.PROC.COPY VALNOM.PROC.<*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de errores
*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program JURADCAR.|end program CARGAJUR.************************************************************************************************************************************
************************************************************************************************************************************




~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresEND-IFEND-IFEND-IFEND-IF
>END-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGOMOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.|COPY LEEMAESTROS.PROC.COPY VALNOM.PROC.<*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.****************************************************************************************************************************
* Valida si la identificaciï¿½n está ¥n la base de datos alterna|* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está ¤entro|*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROS
>*abre archivos y carga la tabla de direcciones
>*estandar, solo la primera vez
>IF OPEN-DIR = ZEROS
>OPEN INPUT MAESTRO-DIRECC
>OPEN INPUT BDLCLI
>OPEN INPUT SUSCRIPTOR
>OPEN INPUT MAESTRO-CREDIT
>OPEN INPUT MAESTRO-CHECK
>PERFORM 06000-U-CARGAR-TABLA-DIRESTAN
>MOVE 1 TO OPEN-DIR
>END-IF
>*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el*buscada. En caso de hallar registros se procede a realizar el
*match*matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
*MOVE 1 TO HACERMATCH-LEEMSTRS<IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCH
*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<END-IFEND-IFEND-IFEND-IFdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************display "Fin de los registros a eliminar - leí¤¯s:"|display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos má³\212close JURAD ERRS BDIIREG   |* $$$$ se agregaron varios archivos más
>close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDO|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R<DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leí¤¯s (excluí¤¯ el registro "T")|*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"
high-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leí¤¯s:"|display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidasdisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deberí¡® cargar, aunque sea de manera|* blanco, me parece que se deberían cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retorna*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<
*delimited by high-value<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if
if function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales* de control, y deberí¡ ser el ultimo del archivo|* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoswrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberí¡ ser el ultimo del archivo|* de control, y debería ser el ultimo del archivo*************************************************************************************************************************************    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existe<call "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existeend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué °reviamente cargado con J001 o J002|*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALE
*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraphend-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registromove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosJURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registro*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validaciï¿½n de IDs que no figuran en las bases normales|* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificaciï¿½n está ¥n la base de datos alterna|*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<elseelse
*no es una cé¤µla|*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIAN<END-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del cï¿½digo|*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide|*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna|*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21|*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12|*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3if SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1*es un id invá¬©do|*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validaciï¿½n en base alterna|*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre no coincide|* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORELSE|else
*no es una cé¤µla|*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERROREND-IF.|end-if.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre coincide|* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontradomove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-ifend-ifif SW-BDIIALE = 0if SW-BDIIALE = 0read BDIIALE next record at endread BDIIALE next record at endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-ifend-ifend-perform.end-perform.if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORmove 07 to CODIGO-ERRORelseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del cï¿½digo|*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide|*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna|*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21|*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12|*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validaciï¿½n de IDs que no figuran en las bases normales|* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificaciï¿½n está ¥n la base de datos alterna|*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<elseelse
*no es una cé¤µla|*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIAN<END-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosJURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registro
*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraphend-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registro*************************************************************************************************************************************    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existe<call "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existeend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué °reviamente cargado con J001 o J002|*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberí¡ ser el ultimo del archivo|* de control, y debería ser el ultimo del archivo* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales* de control, y deberí¡ ser el ultimo del archivo|* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadosif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<
*delimited by high-value<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornadisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deberí¡® cargar, aunque sea de manera|* blanco, me parece que se deberían cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performhigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leí¤¯s:"|display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidasdisplay "Fin de los registros a eliminar - leí¤¯s:"|display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos má³\212close JURAD ERRS BDIIREG   |* $$$$ se agregaron varios archivos más
>close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDO|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R<DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leí¤¯s (excluí¤¯ el registro "T")|*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.|SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS./codigo-error* Archivos de base alterna* Archivos de base alterna************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).//perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que seï¿½alar el fin de proceso|*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}//if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"
call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-errores
move 05 to codigo-errormove 05 to codigo-error
/
/*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id invá¬©do|*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validaciï¿½n en base alterna|*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDEelseelseperform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre no coincide|* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERRORELSE|else
*no es una cé¤µla|*no es una cédulaMOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERROREND-IF.|end-if.4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre coincide|* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEmove 1 TO SW-BDIIALEnot invalid keynot invalid keymove 0 to SW-BDIIALEmove 0 to SW-BDIIALEread BDIIALE next recordread BDIIALE next recordat endat endmove 1 to SW-BDIIALEmove 1 to SW-BDIIALEend-readend-readend-startend-startperform until SW-BDIIALE = 1perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE////>or FUENTE-BDIIALE > 990003
if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003
and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD
and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD
and BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontrado
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-ifend-if
if SW-BDIIALE = 0if SW-BDIIALE = 0
read BDIIALE next record at endread BDIIALE next record at end
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-readend-read
end-ifend-if
end-perform.end-perform.

if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1
if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1
move 07 to CODIGO-ERRORmove 07 to CODIGO-ERROR
/
/elseelse
if ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERRORmove 06 to CODIGO-ERROR
/
/elseelseif ESTADO-VIG-BDIIREGI = 21if ESTADO-VIG-BDIIREGI = 21move 06 to CODIGO-ERRORmove 06 to CODIGO-ERRORadd 1 to NO-COINCIDE-REGISadd 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSadd 1 to CONT-FALLECIDOSend-ifend-ifend-ifend-ifend-if.end-if.4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.
************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del cï¿½digo|*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide|*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna|*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21|*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12|*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validaciï¿½n de IDs que no figuran en las bases normales|* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificaciï¿½n está ¥n la base de datos alterna|*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla|*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<////

/

/elseelse
*no es una cé¤µla|*no es una cédula
MOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROR
/
/Address search hit BOTTOM without matching pattern
/Address search hit BOTTOM without matching patternsdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.|SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.[2] + Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/fuentes>ob
/d/iccol/desarrollo/objetos>ls -l | gre  p "Jun [ 1[12]"
-rw-rw-r--   1 icrmbd   icdatacr  312090 Jun 11 10:47 BDIIALEDB2.gnt
-rw-rw-r--   1 icrmbd   icdatacr  638720 Jun 11 10:47 BDIIALEDB2.idy
-rw-rw-r--   1 icrmbd   icdatacr  156416 Jun 11 10:47 BDIIALEDB2.int
-rw-rw-r--   1 icrmbd   icdatacr  911590 Jun 11 10:47 BDIIALEDB2.lst
-rw-rw-r--   1 icrmbd   icdatacr 2491680 Jun 11 10:47 BDIIALEDB2.s
-rw-rw-r--   1 icrmbd   icdatacr  291664 Jun 12 07:49 BDLDI2.gnt
-rw-rw-r--   1 icrmbd   icdatacr  497664 Jun 12 07:49 BDLDI2.idy
-rw-rw-r--   1 icrmbd   icdatacr  122880 Jun 12 07:49 BDLDI2.int
-rw-rw-r--   1 icrmbd   icdatacr  706718 Jun 12 07:49 BDLDI2.lst
-rw-rw-r--   1 icrmbd   icdatacr 2289192 Jun 12 07:49 BDLDI2.s
-rw-rw-r--   1 icrmbd   icdatacr 4256512 Jun 11 17:03 CARACTPER-PER11-CQ10994.idy
-rw-rw-r--   1 icrmbd   icdatacr 6070037 Jun 11 17:03 CARACTPER-PER11-CQ10994.lst
-rw-rw-r--   1 icrmbd   icdatacr 3130293 Jun 11 17:14 CARACTPER-PER11-CQ20201.gnt
-rw-rw-r--   1 icrmbd   icdatacr 4952832 Jun 11 17:14 CARACTPER-PER11-CQ20201.idy
-rw-rw-r--   1 icrmbd   icdatacr 1237760 Jun 11 17:14 CARACTPER-PER11-CQ20201.int
-rw-rw-r--   1 icrmbd   icdatacr 6075777 Jun 11 17:14 CARACTPER-PER11-CQ20201.lst
-rw-rw-r--   1 icrmbd   icdatacr 24926062 Jun 11 17:14 CARACTPER-PER11-CQ20201.s
-rw-rw-r--   1 icjlud   icdatacr  125544 Jun 12 08:48 CARGAJUR.gnt
-rw-rw-r--   1 icjlud   icdatacr  444160 Jun 12 08:48 CARGAJUR.idy
-rw-rw-r--   1 icjlud   icdatacr  110080 Jun 12 08:48 CARGAJUR.int
-rw-rw-r--   1 icjlud   icdatacr 1211198 Jun 12 08:48 CARGAJUR.lst
-rw-rw-r--   1 icjlud   icdatacr  955505 Jun 12 08:48 CARGAJUR.s
-rw-rw-r--   1 icdgd    icdatacr   16475 Jun 11 17:35 COLASCOLST.gnt
-rw-rw-r--   1 icdgd    icdatacr  719872 Jun 11 17:35 COLASCOLST.idy
-rw-rw-r--   1 icdgd    icdatacr   41984 Jun 11 17:35 COLASCOLST.int
-rw-rw-r--   1 icdgd    icdatacr  673461 Jun 11 17:35 COLASCOLST.lst
-rw-rw-r--   1 icdgd    icdatacr   71376 Jun 11 17:35 COLASCOLST.s
-rw-rw-r--   1 icjjmd   icdatacr   33399 Jun 11 09:01 CVCIFDCRE-HSBC.gnt
-rw-rw-r--   1 icjjmd   icdatacr  128000 Jun 11 09:01 CVCIFDCRE-HSBC.idy
-rw-rw-r--   1 icjjmd   icdatacr   22016 Jun 11 09:01 CVCIFDCRE-HSBC.int
-rw-rw-r--   1 icjjmd   icdatacr   92830 Jun 11 09:01 CVCIFDCRE-HSBC.lst
-rw-rw-r--   1 icjjmd   icdatacr  247125 Jun 11 09:01 CVCIFDCRE-HSBC.s
-rw-rw-r--   1 icrmbd   icdatacr    1817 Jun 11 10:18 ICGCON.aif
-rw-rw-r--   1 icrmbd   icdatacr 2914955 Jun 11 11:21 ICGCON.gnt
-rw-rw-r--   1 icrmbd   icdatacr 5346048 Jun 11 11:21 ICGCON.idy
-rw-rw-r--   1 icgjcd   icdatacr  938496 Jun 11 11:21 ICGCON.int
-rw-rw-r--   1 icrmbd   icdatacr 6607155 Jun 11 11:21 ICGCON.lst
-rw-rw-r--   1 icrmbd   icdatacr 20829648 Jun 11 11:21 ICGCON.s
-rw-rw-r--   1 icrmbd   icdatacr 2950143 Jun 12 08:23 ICGCONV258.gnt
-rw-rw-r--   1 icrmbd   icdatacr 5403392 Jun 12 08:23 ICGCONV258.idy
-rw-rw-r--   1 icrmbd   icdatacr  947200 Jun 12 08:23 ICGCONV258.int
-rw-rw-r--   1 icrmbd   icdatacr 6661876 Jun 12 08:23 ICGCONV258.lst
-rw-rw-r--   1 icrmbd   icdatacr 21090195 Jun 12 08:23 ICGCONV258.s
-rw-rw-r--   1 icehad   icdatacr 2992242 Jun 11 11:42 ICGCPL.gnt
-rw-rw-r--   1 icehad   icdatacr 5546240 Jun 11 11:42 ICGCPL.idy
-rw-rw-r--   1 icehad   icdatacr  963328 Jun 11 11:42 ICGCPL.int
-rw-rw-r--   1 icehad   icdatacr 6822303 Jun 11 11:42 ICGCPL.lst
-rw-rw-r--   1 icehad   icdatacr 21389467 Jun 11 11:42 ICGCPL.s
-rw-rw-r--   1 icehad   icdatacr 2992244 Jun 11 11:27 ICGCPLPB.gnt
-rw-rw-r--   1 icehad   icdatacr 5546240 Jun 11 11:27 ICGCPLPB.idy
-rw-rw-r--   1 icgjcd   icdatacr  963328 Jun 11 11:27 ICGCPLPB.int
-rw-rw-r--   1 icehad   icdatacr 6822367 Jun 11 11:27 ICGCPLPB.lst
-rw-rw-r--   1 icehad   icdatacr 21396975 Jun 11 11:27 ICGCPLPB.s
-rw-rw-r--   1 icehad   icdatacr 2992918 Jun 11 11:40 ICGCPLV259.gnt
-rw-rw-r--   1 icehad   icdatacr 5547008 Jun 11 11:40 ICGCPLV259.idy
-rw-rw-r--   1 icehad   icdatacr  963584 Jun 11 11:40 ICGCPLV259.int
-rw-rw-r--   1 icehad   icdatacr 6823635 Jun 11 11:40 ICGCPLV259.lst
-rw-rw-r--   1 icehad   icdatacr 21409333 Jun 11 11:40 ICGCPLV259.s
-rw-rw-r--   1 icjdld   icdatacr 1479421 Jun 11 09:59 ICGD38V12.gnt
-rw-rw-r--   1 icjdld   icdatacr 3678720 Jun 11 09:59 ICGD38V12.idy
-rw-rw-r--   1 icjdld   icdatacr  662272 Jun 11 09:59 ICGD38V12.int
-rw-rw-r--   1 icjdld   icdatacr 4269363 Jun 11 09:59 ICGD38V12.lst
-rw-rw-r--   1 icjdld   icdatacr 10343190 Jun 11 09:59 ICGD38V12.s
-rw-rw-r--   1 icrgd    icdatacr 1479453 Jun 11 11:20 ICGD38V13.gnt
-rw-rw-r--   1 icrgd    icdatacr 3678720 Jun 11 11:20 ICGD38V13.idy
-rw-rw-r--   1 icrgd    icdatacr  662272 Jun 11 11:20 ICGD38V13.int
-rw-rw-r--   1 icrgd    icdatacr 4269637 Jun 11 11:20 ICGD38V13.lst
-rw-rw-r--   1 icrgd    icdatacr 10343505 Jun 11 11:20 ICGD38V13.s
-rw-rw-r--   1 icrgd    icdatacr 1480195 Jun 11 09:59 ICGD38V14.gnt
-rw-rw-r--   1 icrgd    icdatacr 3681536 Jun 11 09:59 ICGD38V14.idy
-rw-rw-r--   1 icrgd    icdatacr  663040 Jun 11 09:59 ICGD38V14.int
-rw-rw-r--   1 icrgd    icdatacr 4275702 Jun 11 09:59 ICGD38V14.lst
-rw-rw-r--   1 icrgd    icdatacr 10353843 Jun 11 09:59 ICGD38V14.s
-rw-rw-r--   1 icimsd   icdatacr 6629376 Jun 11 15:55 ICGKAR.idy
-rw-rw-r--   1 icimsd   icdatacr 9477201 Jun 11 15:55 ICGKAR.lst
-rwxrwxr-x   1 icvhfd   icdatacr  706068 Jun 11 17:03 ICGMDF
-rw-rw-r--   1 icvhfd   icdatacr 1498880 Jun 11 17:03 ICGMDF.idy
-rw-rw-r--   1 icvhfd   icdatacr  269056 Jun 11 17:03 ICGMDF.int
-rw-rw-r--   1 icvhfd   icdatacr 2210215 Jun 11 17:03 ICGMDF.lst
-rw-rw-r--   1 icvhfd   icdatacr  779896 Jun 11 17:03 ICGMDF.o
-rw-rw-r--   1 icdgd    icdatacr  118720 Jun 11 18:18 JURADCAR.gnt
-rw-rw-r--   1 icdgd    icdatacr  368128 Jun 11 18:18 JURADCAR.idy
-rw-rw-r--   1 icdgd    icdatacr   92416 Jun 11 18:18 JURADCAR.int
-rw-rw-r--   1 icdgd    icdatacr  969008 Jun 11 18:18 JURADCAR.lst
-rw-rw-r--   1 icdgd    icdatacr  903313 Jun 11 18:18 JURADCAR.s
-rw-rw-r--   1 icjdld   icdatacr 1850907 Jun 11 16:54 SCOTBATCH-V15.gnt
-rw-rw-r--   1 icjdld   icdatacr 3636224 Jun 11 16:54 SCOTBATCH-V15.idy
-rw-rw-r--   1 icjdld   icdatacr  847104 Jun 11 16:54 SCOTBATCH-V15.int
-rw-rw-r--   1 icjdld   icdatacr 4048981 Jun 11 16:54 SCOTBATCH-V15.lst
-rw-rw-r--   1 icjdld   icdatacr 14909017 Jun 11 16:54 SCOTBATCH-V15.s
-rw-rw-r--   1 icrmbd   icdatacr 3185664 Jun 11 16:49 SCOTBATCHRMB.idy
-rw-rw-r--   1 icrmbd   icdatacr 4129039 Jun 11 16:49 SCOTBATCHRMB.lst
-rw-rw-r--   1 icvhfd   icdatacr    7314 Jun 11 15:15 UTLADINOM.gnt
-rw-rw-r--   1 icvhfd   icdatacr   58880 Jun 11 15:15 UTLADINOM.idy
-rw-rw-r--   1 icvhfd   icdatacr    7424 Jun 11 15:15 UTLADINOM.int
-rw-rw-r--   1 icvhfd   icdatacr   40367 Jun 11 15:15 UTLADINOM.lst
-rw-rw-r--   1 icvhfd   icdatacr   34563 Jun 11 15:15 UTLADINOM.s
/d/iccol/desarrollo/objetos>^[[A  /d/iccol/desarrollo/objetos>ls -l | grep "Jun 1[12]"ls -l | grep "Jun 1[12]" | grep icgdg
/d/iccol/desarrollo/objetos>^[[A  /d/iccol/desarrollo/objetos>ls -l | grep "Jun 1[12]" | grep icgdg/d/iccol/desarrollo/objetos>ls -l | grep "Jun 1[12]" | grep icgd     icdgd
-rw-rw-r--   1 icdgd    icdatacr   16475 Jun 11 17:35 COLASCOLST.gnt
-rw-rw-r--   1 icdgd    icdatacr  719872 Jun 11 17:35 COLASCOLST.idy
-rw-rw-r--   1 icdgd    icdatacr   41984 Jun 11 17:35 COLASCOLST.int
-rw-rw-r--   1 icdgd    icdatacr  673461 Jun 11 17:35 COLASCOLST.lst
-rw-rw-r--   1 icdgd    icdatacr   71376 Jun 11 17:35 COLASCOLST.s
-rw-rw-r--   1 icdgd    icdatacr  118720 Jun 11 18:18 JURADCAR.gnt
-rw-rw-r--   1 icdgd    icdatacr  368128 Jun 11 18:18 JURADCAR.idy
-rw-rw-r--   1 icdgd    icdatacr   92416 Jun 11 18:18 JURADCAR.int
-rw-rw-r--   1 icdgd    icdatacr  969008 Jun 11 18:18 JURADCAR.lst
-rw-rw-r--   1 icdgd    icdatacr  903313 Jun 11 18:18 JURADCAR.s
/d/iccol/desarrollo/objetos>grep -i CARGAJUR JURAD*
/d/iccol/desarrollo/objetos>^[[A  /d/iccol/desarrollo/objetos>grep -i CARGAJUR JURAD*grep -i CARGAJUR t JURADCAR.lst JURADCAR.s                        <k grep -i CARGAJUR JURAD*                           /d/iccol/desarrollo/objetos>grep -i CARGAJUR       *int *gnt
CARGAJUR.int:CARGAJUR@                      14061208481288       
/d/iccol/desarrollo/objetos>ls -l CARGAJUR*
-rw-rw-r--   1 icjlud   icdatacr  125544 Jun 12 08:48 CARGAJUR.gnt
-rw-rw-r--   1 icjlud   icdatacr  444160 Jun 12 08:48 CARGAJUR.idy
-rw-rw-r--   1 icjlud   icdatacr  110080 Jun 12 08:48 CARGAJUR.int
-rw-rw-r--   1 icjlud   icdatacr 1211198 Jun 12 08:48 CARGAJUR.lst
-rw-rw-r--   1 icjlud   icdatacr  955505 Jun 12 08:48 CARGAJUR.s
/d/iccol/desarrollo/objetos>jobs
[2] + Stopped (SIGTSTP)        vi
[1] - Stopped (SIGTSTP)        vi
/d/iccol/desarrollo/objetos>fg %1
vi
rm /d/iccol/desarrollo/objetos/CARGAJUR2.int
rm /d/iccol/desarrollo/objetos/CARGAJUR2.gnt
rm /d/iccol/desarrollo/objetos/CARGAJUR2.lst
rm /d/iccol/desarrollo/objetos/CARGAJUR2.idy
rm /d/iccol/desarrollo/objetos/CARGAJUR.lst
rm /d/iccol/desarrollo/objetos/CARGAJUR.idy
rm /d/iccol/desarrollo/objetos/CARGAJUR.s
rm /d/iccol/desarrollo/objetos/CARGAJUR.gnt
rm /d/iccol/desarrollo/objetos/CARGAJUR.int
rm /d/iccol/desarrollo/objetos/CARGAJUR2.s
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q!/d/iccol/desarrollo/objetos>fg
vi
sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.|SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS./Ñ
************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS./ind-alfabetico
IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGOMOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.|COPY LEEMAESTROS.PROC.COPY VALNOM.PROC.<*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.//Address search hit BOTTOM without matching pattern??COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la bï¿½squeda en base alterna|* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ã\221".|"Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).01  REG-VALIDAS.01  REG-VALIDAS.03 TIP-VALPIC 9.03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.?sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.|SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.copy ICBDIR.FS.copy ICBDIR.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.copy BDLCLI.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.COPY BDLNEWDIRBOG.FS.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuaciï¿½n no está £onfirmedo, no se usa|* $$$$ El formato a continuación no está confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7)./ï¿½:%s//ó15 substitutions move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificación está ¥n la base de datos alterna|* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está ¤entro|*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROS
>*abre archivos y carga la tabla de direcciones
>*estandar, solo la primera vez
>IF OPEN-DIR = ZEROS
>OPEN INPUT MAESTRO-DIRECC
>OPEN INPUT BDLCLI
>OPEN INPUT SUSCRIPTOR
>OPEN INPUT MAESTRO-CREDIT
>OPEN INPUT MAESTRO-CHECK
>PERFORM 06000-U-CARGAR-TABLA-DIRESTAN
>MOVE 1 TO OPEN-DIR
>END-IF
>*abre archivos y carga la tabla de direcciones*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está £onfirmedo, no se usa|* $$$$ El formato a continuación no está confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.* $$$$ El formato a contin/áá / £Address search hit BOTTOM without matching pattern? REPLACE 1 CHARc:q!/d/iccol/desarrollo/objetos>^[  /d/iccol/desarrollo/objetos>fgfg %1jobs ls -l CARGAJUR*grep -i CARGAJUR *int *gntls -l CARGAJUR*           jobs           fg %1fg       vi JURADCAR.CBL
"JURADCAR.CBL" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"JURADCAR.CBL" [New file]:q/d/iccol/desarrollo/objetos>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fuvi JURADCAR.CBL
"JURADCAR.CBL" 1739 lines, 74175 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS."JURADCAR.CBL" 1739 lines, 74175 characters/i..n\>move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all spacemove LA-numx(9:12) to LA-valor(2)* >>>> esto esta anulado x que no se como hacer para que lo compile
* >>>> da error en el end-if
*string LA-parte(LAx, 1) LA-valor(1)
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-valueend-if.1000-RUTINA-INICIAL.
D    display "1000-RUTINA-INICIAL"
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINE
D    move "9999991000905140104.txt 2 " to P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?if PROCESO-REAL
display pgm " Carga de archivo JURAD - proceso REAL"else
display pgm " Carga de archivo JURAD - proceso en falso"end-if* El indicador de proceso real debe ser 1 o 2$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS. mmiiccrrooffooccuuss$CHANGE MODE.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD
******************************************************************
FD JURAD.
01  JURAD-reg.
* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.
*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuaciï¿½n no está £onfirmedo, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuaciï¿½n no está £onfirmedo, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************




$ El a ac/ï¿½ï¿$CHANGE MODEó/
******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "JURADCAR".******************************************************************
* Datos para la bï¿½squeda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"Ã\221".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  REG-VALIDAS.
03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).ï¿$óï¿½/01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validaciï¿½n de nombres
******************************************************************
*copy LEEMAESTROS.WS.*****************************************************************
* Variables validacion de nombres
*****************************************************************copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************copy ICFILE.WS.*****************************************************************
* Variables validacion cuentas si validar
*****************************************************************copy BDAMATCH.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.ï¿$ó/
*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aï¿½os
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total/"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(59) value"Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(59) value"Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(59) value"El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(59) value"El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(59) value"Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(59) value"Modificaciï¿½n de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(59) value"Eliminaciï¿½n de alerta inexistente".
*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.03pic xx.03pic x(300).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.ï¿$ó/ï¿$ó/display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4000-PROCESAR-REGISTRO-2.
D    display "4000-PROCESAR-REGISTRO-2"
****************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg
****************************************************************move "NO" to E-hay-error*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-erroresend-if*    si es el registro "T" hay que seï¿½alar el fin de procesoif JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosmove 0 to codigo-errorperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE/end-if
move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-erroresend-if.4200-VALIDACION-SEMANTICA.
D    display "4200-VALIDACION-SEMANTICA"
****************************************************************
* Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IF
MOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificaciï¿½n contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id invá¬©docall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validaciï¿½n en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"
******************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre no coincideï¿$ó/ï¿$ó/ï¿$ó
/******************************************************************
*    nombre no coincide
IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla
MOVE 02 TO CODIGO-ERROR
ELSE
*no es una cé¤µla
MOVE 01 TO CODIGO-ERROR
END-IF.


4222-VALIDA-NOMBRE-COINCIDE.
D    display "4222-VALIDA-NOMBRE-COINCIDE"
******************************************************************
* Validaciï¿½n de IDs que figuran OK pero el nombre coincideï¿$ó
/and BLOQUEO-BDIIALE = 0*encontrado
move 1 to SW-BDIIALEend-if
if SW-BDIIALE = 0
read BDIIALE next record at endmove 1 to SW-BDIIALEend-read
end-if
end-perform.if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORelse
if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSend-if
end-if
end-if.4240-CONTAR-TIPO-CUENTA.
D    display "4240-CONTAR-TIPO-CUENTA"
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cï¿½digo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide
*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna
*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.ï¿$ó/

4210-VALIDACION-ID-NO-FIGURA.
D    display "4210-VALIDACION-ID-NO-FIGURA"
******************************************************************
* Validaciï¿½n de IDs que no figuran en las bases normalesï¿$ó
/******************************************************************
MOVE 0 TO HACER-MATCH
MOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificaciï¿½n está ¥n la base de datos alternaï¿$ó
/* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
D    display "9000-CANCELAR-PROGRAMA"
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
D    display "513-VALIDA-EN-CSV"
D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E
**************************************************************
* Valida si la identificaciï¿½n está ¥n la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está ¤entro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OK
Ddisplay "el nï¿½ de ID está ¤entro de su rango"IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el
*match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCHï¿$ó/ï¿$óï¿½/Address search hit BOTTOM without matching pattern*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuación no está £onfirmedo, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999./
******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "JURADCAR".******************************************************************
* Datos para la bï¿½squeda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"Ã\221".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  REG-VALIDAS.
03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).ï¿$CHANGE MODEú/
*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aï¿½os
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque totalï¿$CHANGE MODEñ/display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4000-PROCESAR-REGISTRO-2.
D    display "4000-PROCESAR-REGISTRO-2"
****************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg
****************************************************************move "NO" to E-hay-error*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-erroresend-if*    si es el registro "T" hay que seï¿½alar el fin de procesoif JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosmove 0 to codigo-errorperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALEï¿$ñ/******************************************************************* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
D    display "513-VALIDA-EN-CSV"
D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E
**************************************************************
* Valida si la identificación está ¥n la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está ¤entro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OK
Ddisplay "el nï¿½ de ID está ¤entro de su rango"IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el
*match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
*MOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM
Ddisplay "10000-MATCH-NOMBRES-VALNOM"
Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOMï¿$CHANGE MODEumm de ID está REPLACE 1 CHARd/Address search hit BOTTOM without matching pattern*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuación no está £onfirmedo, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999./^[a-zA-Z0-9*}{][,.:;)(=$"'Missing ]/[^a-zA-Z0-9*$="}{\][|#%/?><,.;:-_]/[^a-zA-Z0-9*$="}{\][|#%/?><,.;:-_] ]/[^a-zA-Z0-9*$="}{\][|#%/?><,.;:-_] áéíóúñÑ] $CHANGE MODE cconfirmREPLACE 1 CHARa///[^a-zA-Z0-9*$="}{\][|#%/?><,.;:-_ áéíóúñÑ]:\-_áéíóúñÑ] /[^a-zA-Z0-9*$="}{\][|#%/?><,.;:\-_áéíóúñÑ] ]/[ ^a-zA-Z0-9*$="}{\][|#%/?><,.;:\-_áéíóúñÑ)(]//// ///[ ^a-zA-Z0-9*$="}{\][|#%/?><,.;:\-_áéíóúñÑ)(] ]/[^ a-zA-Z0-9*$="}{\][|#%/?><,.;:\-_áéíóúñÑ)(]
******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "JURADCAR".******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"Ã\221".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  REG-VALIDAS.
03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).\22$CHANGE MODEÑ"./
*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total/03 N-ale-borradaspic 9(8) value zero.*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7).******************************************************************
* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea///////
///
/4200-VALIDACION-SEMANTICA.D    display "4200-VALIDACION-SEMANTICA"
****************************************************************
* Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IF
MOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id invá¬©docall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"
******************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide
******************************************************************
*    nombre no coincideIF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla
MOVE 02 TO CODIGO-ERRORELSE
*no es una cé¤µla¬$CHANGE MODEli/REPLACE 1 CHARd



/REPLACE 1 CHARu



/REPLACE MODEdu
/if SW-BDIIALE = 0
read BDIIALE next record at endmove 1 to SW-BDIIALEend-read
end-if
end-perform.if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORelse
if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSend-if
end-if
end-if.4240-CONTAR-TIPO-CUENTA.
D    display "4240-CONTAR-TIPO-CUENTA"
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del código
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cé¤µla OK, nombre no coincide
*    03=NIT no figura
*    04=cé¤µla no figura pero está ¥n base alterna
*    05=tipo id no es 1|2|3|4
*    06=cé¤µla ... ESTADO-VIG-BDIIREGI = 21
*    07=cé¤µla ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
D    display "4210-VALIDACION-ID-NO-FIGURA"du/du/ REPLACE 1 CHARe/REPLACE MODEdu/du"JURADCAR.CBL" [Modified] line 831 of 1739 --47%-- /******************************************************************
* Validación de IDs que no figuran en las bases normales
******************************************************************
MOVE 0 TO HACER-MATCH
MOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está ¥n la base de datos alterna REPLACE 1 CHARe
"JURADCAR.CBL" [Modified] line 860 of 1739 --49%-- *    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cé¤µla
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISelse
*no es una cé¤µla
MOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANEND-IF
END-IF.4300-MODIFICAR-BDIIALE.
D    display "4300-MODIFICAR-BDIIALE"
******************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y
* embargos
******************************************************************initialize REG-BDIIALE*    si hay demandasif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALE
*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.*    si hay embargosif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALE
*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.4300-MODIFICAR-BDIIALE-DATOS.
D    display "4300-MODIFICAR-BDIIALE-DATOS"
******************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"//eREPLACE MODEdu/du/

4300-MODIFICAR-BDIIALE-DATOS.
D    display "4300-MODIFICAR-BDIIALE-DATOS"
******************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
******************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadwhen "I"
add 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iwhen "M"
add 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mwhen "E"
add 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Ewhen other
*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
D    display "4300-MODIFICAR-BDIIALE-I"
******************************************************************
* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua
******************************************************************
*    si el registro existia es un errorif EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEÂ$CHANGE MODEnum/*******************************************************************    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-erroresend-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.
D    display "4333-LEER-BDIIALE-RANDOM"
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué °reviamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
D    display "4333-GRABAR-BDIIALE"
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEREPLACE 1 CHAR  REPLACE 1 CHARp/end-evaluate.4333-ELIMINAR-BDIIALE.
D    display "4333-ELIMINAR-BDIIALE"
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4800-PROCESO-REG-T.
D    display "4800-PROCESO-REG-T"
******************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberí¡ ser el ultimo del archivo
******************************************************************
* Control de los totales calculados contra los esperadosmove "NO" to E-hay-error
*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidoscontinue
else
display " "
display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errorend-if*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-terminadas)= N-demandas-terminadascontinue
else
display " "
display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasmove "SI" to E-hay-errorend-if

if function numval(JURADT-embargos-vigentes)= N-embargos-vigentescontinueREPLACE 1 CHARa/REPLACE 1 CHAR /gobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1000-NOT-USED.
D    display "1000-NOT-USED"
******************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deberí¡® cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.
******************************************************************
* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.REPLACE MODEíaa//end-evaluate.*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivoperform until EST-BDIIALE not = "00"read BDIIALE next recordevaluate EST-BDIIALEwhen "00"
*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE
if FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD
delete BDIIALE
if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradaselse
*error en la eliminacion
display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAend-if
end-if
when "10"
*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leí¤¯s:"N-ale-leidas
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
D    display "7000-RUTINA-FINAL"
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos má³\212close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"REPLACE MODEdo/³\21$CHANGE MODEssAPPEND MODE





close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.APPEND MODEi  close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
display "Totales de registros:"REPLACE 1 CHAR





close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.     close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.INSERT MODE  close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDODISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-RDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros leí¤¯s (excluí¤¯ el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"/REPLACE MODEdoos/REPLACE MODEdo /* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
D    display "9000-CANCELAR-PROGRAMA"
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
D    display "513-VALIDA-EN-CSV"
D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E
**************************************************************
* Valida si la identificación está ¥n la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está ¤entro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OK
Ddisplay "el num de ID está dentro de su rango"IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el
*match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH REPLACE 1 CHARe/ REPLACE 1 CHARd/REPLACE 1 CHAR /Address search hit BOTTOM without matching pattern??/REPLACE 1 CHAR /Address search hit BOTTOM without matching pattern
? ?end-if
when "10"
*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"N-ale-leidas
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
D    display "7000-RUTINA-FINAL"
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDODISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-RDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"$CHANGE MODE    /Address search hit BOTTOM without matching pattern?$    ?end-if.1000-NOT-USED.
D    display "1000-NOT-USED"
******************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se debería cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.
******************************************************************
* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado
******************************************************************
* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literalesset LAx to 0
move high-values to LA-templatesperform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesset LAx up by 1
*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"
*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
D    display "1001-ELIMINAR-TODO"
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEwhen "00"
*posicionado?*    cuenta tipo 5: sin error*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*registros correctos, repetidos o noADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
D    display "4210-VALIDACION-ID-NO-FIGURA"
******************************************************************
* Validación de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cédula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISelse
*no es una cédula
MOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANEND-IF
END-IF.4300-MODIFICAR-BDIIALE.
D    display "4300-MODIFICAR-BDIIALE"
******************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y
* embargos
******************************************************************initialize REG-BDIIALE*    si hay demandasif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALE
*arma datos de demandasREPLACE 1 CHAR ?**    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    05=tipo id no es 1|2|3|4*    04=cédula no figura pero está en base alterna ?03 N-embargos-terminados     pic 9(7).******************************************************************
* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error?????/?
*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total?Address search hit TOP without matching pattern:w"JURADCAR.CBL" 1740 lines, 74122 characters * Fecha de proceso + 50 años01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7).******************************************************************:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi JURADCAR.CBL JURADCAR.CBL  c JURADCAR.CBLp JURADCAR.CBLp JURADCAR.CBL JURADCAR.cbl
/d/iccol/desarrollo/fuentes>vi 

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~APPEND MODEsdiff -w 170 JURADCAR.CBL CARGAJUR.CBL


!sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
 IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
 PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
      *********************************************************************************************************************************
***
      * Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
      * por Jurad* por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK us
a
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba
en
      * el archivo ERRS.* el archivo ERRS.
      *********************************************************************************************************************************
***
 AUTHOR.Globant JL.AUTHOR.Globant JL.
 DATE-WRITTEN.DATE-WRITTEN.
 DATE-COMPILED.DATE-COMPILED.
 CONFIGURATION section.CONFIGURATION section.
 SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
 OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
 INPUT-OUTPUT section.INPUT-OUTPUT section.
 FILE-CONTROL.FILE-CONTROL.

      *********************************************************************************************************************************
***
      *********************************************************************************************************************************
***
 select JURAD assign to P-file-pathselect JURAD assign to P-file-path
 organization is line sequentialorganization is line sequential
 file status is JURAD-fs.file status is JURAD-fs.

      *********************************************************************************************************************************
***
      *********************************************************************************************************************************
***
 select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-name
 organization is line sequentialorganization is line sequential
 file status is ERRS-fs.file status is ERRS-fs.

      *********************************************************************************************************************************
***
      *********************************************************************************************************************************
***
 copy BDIIREGI.FS.copy BDIIREGI.FS.

      *********************************************************************************************************************************
***
@
1781 more lines$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************/    [|<>]/*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa|* $$$$ El formato a continuación no está confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos            * $$$$ El a no está no se usa onfirmREPLACE 1 CHARaREPLACE 1 CHAR /
************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".
*01  W-BLOQUESPIC 9(01) VALUE ZEROS.|01  OPEN-DIRPIC 9 value 0.
>01  W-BLOQUESPIC 9 value 2.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45)./01  REG-VALIDAS.01  REG-VALIDAS.
03 TIP-VALPIC 9.03 TIP-VALPIC 9.
03 CED-VALPIC 9(11).03 CED-VALPIC 9(11).
03 NOM-VALPIC X(45).03 NOM-VALPIC X(45).
03 FEC-EXP-VALPIC 9(08).03 FEC-EXP-VALPIC 9(08).
03 MUN-EXP-VALPIC X(15).03 MUN-EXP-VALPIC X(15).
03 DEP-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).
03 VIG-VALPIC X(02).03 VIG-VALPIC X(02).
03 GENERO-VALPIC X(01).03 GENERO-VALPIC X(01).
03 EDAD-VALPIC X(03).03 EDAD-VALPIC X(03).
03 EDAD-RANGOPIC X(05).03 EDAD-RANGOPIC X(05).
03 FILLER-2-VALPIC X(51).03 FILLER-2-VALPIC X(51).

01  W-CONTADORES.01  W-CONTADORES.
03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.
03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.
03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.
03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.
03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.

01  SUSCRIPTOR-AUXPIC 9(06).01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS.    OPEN MODE/    REPLACE 1 CHAR 
 01  REG-LEIDOSPIC 9(07) VALUE ZEROS.01  REG-LEIDOSPIC 9(07) VALUE ZEROS./01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.*****************************************************************<
* Variables validacion cuentas si validar<
*****************************************************************<copy BDAMATCH.WS.<
<
<
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.?
************************************************************************************************************************************
* Archivos de base alterna* Archivos de base alterna
************************************************************************************************************************************copy BDACSV.FD.copy BDACSV.FD.COPY ICBDIR0001.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.COPY BDLNEWDIRBOG.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "JURADCAR".|01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Datos para la búsqueda en base alterna* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F""G" "H" "I" "J" "K" "L" "M""G" "H" "I" "J" "K" "L" "M""N" "/" "O" "P" "Q" "R" "S""N" "/" "O" "P" "Q" "R" "S""T" "U" "V" "W" "X" "Y" "Z""T" "U" "V" "W" "X" "Y" "Z""Ñ"."Ñ".*01  W-BLOQUESPIC 9(01) VALUE ZEROS.01  OPEN-DIRPIC 9 value 0.01  DATOS-E.01  DATOS-E.03 TIPOID-Epic 9.03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).03 NOMBRE-Epic x(45).    REPLACE 1 CHAR /01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.01 MAS-DATOS.03 IPIC 9(02) VALUE ZERO.03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY  BDLDIR.WS.************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.|copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Variables validacion de nombres<
*****************************************************************<copy VALNOM.WS.<
<
*****************************************************************<
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.*****************************************************************<
* Variables validacion cuentas si validar<
*****************************************************************<copy BDAMATCH.WS.<
<
<
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).************************************************************************************************************************************* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando




?LEEM$CHANGE MODEVALNOM.WS.REPLACE 1 CHAR 




     

      * La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".

     


     


**********************************************************************************************************************************


**********************************************************************************************************************************
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto

03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".            <  * Variables validacion cuentas si validar                               <        * Variables validacion cuentas si validar                                * Variables validacion cuentas si validar                         

      <             copy BDAMATCH.WS.                                                        copy BDAMATCH.WS.                                            />*estandar, solo la primera vez
>IF OPEN-DIR = ZEROS
>OPEN INPUT MAESTRO-DIRECC
>OPEN INPUT BDLCLI
>OPEN INPUT SUSCRIPTOR
>OPEN INPUT MAESTRO-CREDIT
>OPEN INPUT MAESTRO-CHECK
>PERFORM 06000-U-CARGAR-TABLA-DIRESTAN
>MOVE 1 TO OPEN-DIR
>END-IF
>*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion*Se recorre toda la estructura bdacsv para la identific
acion
 *buscada. En caso de hallar registros se procede a realizar el*buscada. En caso de hallar registros se procede a real
izar el
*match*match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH<
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH<
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH<
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH<PERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH|MOVE 1 TO HACERMATCH-LEEMSTRS
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH<
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH<
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH<
*MOVE 1 TO HACERMATCH-LEEMSTRS<IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IFMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM
Ddisplay "10000-MATCH-NOMBRES-VALNOM"<
Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM<
D" " NOM-OUTPUT-BDAMATCH<IF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCH
*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<END-IFEND-IFEND-IFEND-IF************************************************************************************************************************************* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validación de nombres* Datos para las rutinas de validación de nombres
************************************************************************************************************************************
*copy LEEMAESTROS.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************copy ICFILE.WS.copy ICFILE.WS.**********************************************************************************************************************************
* Variables validacion cuentas si validar<* Variables validacion cuentas si validar
**********************************************************************************************************************************copy BDAMATCH.WS.<copy BDAMATCH.WS.
<
<
************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2"./   [|<>]REPLACE MODE    

REPLACE 1 CHAR 
 
           88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1"./*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).|03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7).|03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7).|03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7).|03 N-embargos-terminados     pic 9(7) value zero.************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.   REPLACE 1 CHAR 
 
 
  /03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificación de alerta inexistente".|"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminación de alerta inexistente".|"Eliminación de alerta que no existe".
>03 pic x(11) value "19 0000000 ".
>03 pic x(59) value
>"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.    


 
 
 
 No file  line 489 of 1777 --27%-- /************************************************************************************************************************************PROCEDURE DIVISION.PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA<
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"<
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"<
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo  ********************************************************************************************************************************/:g/^      D/dEND-IFEND-IFEND-IFEND-IF
>END-IFIF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-VALMOVE SPACES TO EDAD-RANGOMOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVADD 1 TO SI-EXISTE-CSVEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.|COPY LEEMAESTROS.PROC.COPY VALNOM.PROC.<*    COPY LEEMAESTROS.PROC.<

<
//
45 fewer lines*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4220-VALIDA-NOMBRE-NO-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1000-NOT-USED*    1000-NOT-USED
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSadd 1 to REG-LEIDOSwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:/Address search hit BOTTOM without matching pattern/  [|><]end-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTA*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifperform 4240-CONTAR-TIPO-CUENTAperform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE|*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraph  REPLACE 1 CHAR /*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************
>*    parámetros para las rutinas de validación en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDE
|*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-Emove JURAD-nombre to NOMBRE-E
|*    switches de opciones de validaciónmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3|if TIP-IDE-BDIIVIDE = 2 or 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE|move 1 to SW-DIGCHEQUEO-BDIIVIDEEND-IF|end-ifMOVE 2 TO NUM-BLOQUES-BDIIVIDE|move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificación contra las bases de|*    Valida el número de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id inválido*es un id inválidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURA   



 



 


 
 
 
 
 elseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincide
if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
call "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-errores
display "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombre
display "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alterna*validación en base alterna
perform 4220-VALIDA-NOMBRE-NO-COINCIDEperform 4220-VALIDA-NOMBRE-NO-COINCIDE
elseelse
perform 4222-VALIDA-NOMBRE-COINCIDEperform 4222-VALIDA-NOMBRE-COINCIDE
end-ifend-if
end-if.end-if.


4220-VALIDA-NOMBRE-NO-COINCIDE.4220-VALIDA-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide* Validación de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
*    nombre no coincide*    nombre no coincide
IF TIP-IDE-BDIIVIDE = 1|if TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédula
MOVE 02 TO CODIGO-ERROR|move 02 to CODIGO-ERROR
ELSE|else
*no es una cédula*no es una cédula
MOVE 01 TO CODIGO-ERROR|move 01 to CODIGO-ERROR
END-IF.|end-if.


4222-VALIDA-NOMBRE-COINCIDE.4222-VALIDA-NOMBRE-COINCIDE.
************************************************************************************************************************************
* Validación de IDs que figuran OK pero el nombre coincide* Validación de IDs que figuran OK pero el nombre coincide
************************************************************************************************************************************
*    nombre coincide: busca ID en BDIIALE*    nombre coincide: busca ID en BDIIALE/   

 
 

 
 initialize LLAVE-BDIIALEinitialize LLAVE-BDIIALE
move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE
move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE
move 990003 to FUENTE-BDIIALEmove 990003 to FUENTE-BDIIALE
start BDIIALE key not < LLAVE-BDIIALE INVALID KEYstart BDIIALE key not < LLAVE-BDIIALE INVALID KEY
move 1 TO SW-BDIIALEmove 1 TO SW-BDIIALE
not invalid keynot invalid key
move 0 to SW-BDIIALEmove 0 to SW-BDIIALE
read BDIIALE next recordread BDIIALE next record
at endat end
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-readend-read
end-startend-start

perform until SW-BDIIALE = 1perform until SW-BDIIALE = 1
or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE
or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
>or FUENTE-BDIIALE > 990003
if FUENTE-BDIIALE = 990003if FUENTE-BDIIALE = 990003
and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD
and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD
and BLOQUEO-BDIIALE = 0and BLOQUEO-BDIIALE = 0
*encontrado*encontrado
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-ifend-if
if SW-BDIIALE = 0if SW-BDIIALE = 0
read BDIIALE next record at endread BDIIALE next record at end
move 1 to SW-BDIIALEmove 1 to SW-BDIIALE
end-readend-read
end-ifend-if
end-perform.end-perform.

if TIP-IDE-BDIIVIDE = 1if TIP-IDE-BDIIVIDE = 1/  REPLACE 1 CHAR No file  line 781 of 1731 --45%-- /4240-CONTAR-TIPO-CUENTA.4240-CONTAR-TIPO-CUENTA.************************************************************************************************************************************
*    Conteo de los registros por "tipo", dependiendo del código*    Conteo de los registros por "tipo", dependiendo del código
*    de error:*    de error:
*    00=OK*    00=OK
*    01=NIT OK, nombre no coincide*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide*    02=cédula OK, nombre no coincide
*    03=NIT no figura*    03=NIT no figura
*    04=cédula no figura pero está en base alterna*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
**
*    cuenta tipo 5: sin error*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05*    cuenta tipo 7: 03 04 05
************************************************************************************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ADD 1 TO W-CONT-TIPO-6ELSEELSEIF CODIGO-ERROR = 03 OR 04 OR 05IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO W-CONT-TIPO-7ELSEELSE
*registros correctos, repetidos o no|*es 00: registros correctosADD 1 TO W-CONT-TIPO-5ADD 1 TO W-CONT-TIPO-5
*si es una empresa*si es una empresaIF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<elseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROR   /  



ADD   1 TO  NO-EXISTE-DIAN<
END-IFEND-IF
END-IF.END-IF.


4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************
initialize REG-BDIIALEinitialize REG-BDIIALE

*    si hay demandas*    si hay demandas
if JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zero
or JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zero
move "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandas
move JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentes
move JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminados
string "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultima
delimited size into D-fecha-ultimadelimited size into D-fecha-ultima<                     ADD  1  TO NO-EXISTE-REGIS                            APPEND MODE                    ADD  1  TO NO-EXISTE-REGIS                           




    <                     ADD   1 TO  NO-EXISTE-DIAN                            APPEND MODE                    ADD   1 TO  NO-EXISTE-DIAN                           /************************************************************************************************************************************* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidos|JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALE?IF TIPOID-E = 2 OR 3IF TIPOID-E = 2 OR 3ADD 1 TO W-CONT-TIPO-5-PJADD 1 TO W-CONT-TIPO-5-PJEND-IFEND-IFEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validación de IDs que no figuran en las bases normales* Validación de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alterna*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cédula*es una cédulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS<ADD  1  TO NO-EXISTE-REGISelseelse
*no es una cédula*no es una cédulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIAN<ADD   1 TO  NO-EXISTE-DIANEND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargos?  REPLACE 1 CHAR 



 /************************************************************************************************************************************* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidos|JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALE   nREPLACE MODEum " reg num: "/ move P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALE4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "|call "PONERR" using "19" JURAD-reg E-errores" key: " LLAVE-BDIIALE|display "llave: " LLAVE-BDIIALEdisplay "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-ya-existeadd 1 to N-ale-ya-existe
>exit paragraphend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-GRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraph/  REPLACE 1 CHAR 
 
 end-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valores
/  REPLACE 1 CHAR /  REPLACE 1 CHAR 
 
 move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<
6 lines deleted/ perform 4333-GRABAR-BDIIALE<4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<display "Datos en la alerta: " INF-DATAHOST-BDIIALE<add 1 to N-ale-no-existe<call "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existe
>exit paragraphend-ifend-if
>
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTA|move spaces to LINEAS-BDIIALEif EST-BDIIALE = "00"|perform 4333-REGRABAR-BDIIALE.perform 4333-REGRABAR-BDIIALE<else<perform 4333-GRABAR-BDIIALE<end-if.<
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua<
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "<" key: " LLAVE-BDIIALE<display "Registro de input: "<display JURAD-reg<add 1 to N-ale-no-existe<call "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-errores
>"llave: " LLAVE-BDIIALE
>add 1 to N-ale-no-existeend-if.end-if./      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE<
*    " fs:" EST-BDIIALE.<4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
6 lines deleted/  REPLACE 1 CHAR 
REPLACE 1 CHAR 
 

 



 
 
      * Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALE
6 lines deleted/move P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALE
move 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002

read BDIIALEread BDIIALE
evaluate EST-BDIIALEevaluate EST-BDIIALE
when "00"when "00"
continuecontinue
when "23"when "23"
continuecontinue
when otherwhen other
display "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE
" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALE
display "Ultimo registro procesado: "display "Ultimo registro procesado: "  display JURAD-reg-anteriordisplay JURAD-reg-anterior/   perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE./  REPLACE 1 CHAR 
 


4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.No file  line 981 of 1700 --57%-- /" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if>*    Esta parte está anulada por falta de definición sobre el
>*    formato del registro "T"
>exit paragraph.
>
>4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
>if function numval(JURADT-demandas-vigentes)
>= N-demandas-vigentes
>continue
>else
>display " "
>display "No coincide total de demandas vigentes:"
>JURADT-demandas-vigentes " con el calculado:"
>N-demandas-vigentes
>move "SI" to E-hay-error
>end-if
>if function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if

if function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)
= N-embargos-vigentes= N-embargos-vigentes
continuecontinue
elseelse
display " "display " "  REPLACE 1 CHAR 
 
 
 
 

 
 
 
 
 
 
 
 
 
 
 /
4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
4320-ARMAR-TEXTO-ALERTA.<
****************************************************************<
* Hace el reemplazo de los valores adecuados en los templates<
* de las linea de alerta que corresponde<
****************************************************************<
*    segun se trate de demandas o embargos<if JURAD-demandas-vigentes not = 0<or JURAD-demandas-terminadas not = 0<set LAx to 1<move high-values to LA-valores<move JURAD-demandas-vigentes to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(1)<
*delimited by all space<move LA-numx(9:12) to LA-valor(1)<move JURAD-demandas-terminadas to LA-num<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
*unstring LA-numX into LA-descarte LA-valor(2)<
*delimited by all space<move LA-numx(9:12) to LA-valor(2)<
<
* >>>> esto esta anulado x que no se como hacer para que lo compile<
* >>>> da error en el end-if<
*string LA-parte(LAx, 1) LA-valor(1)<
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)<
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)<
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)<
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)<
*LA-parte(LAx, 10) LA-valor(10)<
*delimited by high-value<end-if.<
<
<
1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),







     

REPLACE 1 CHAR * el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalido
33 lines deleted/* Apertura de los archivos maestros* Apertura de los archivos maestros* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se debería cargar, aunque sea de manera|* blanco, me parece que se deberían cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing first high-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.

 1001-ELIMINAR-TODO.                                               1001-ELIMINAR-TODO.
**********************************************************************************************************************************
Elimina los registros de alertas existentes en el archivo de  Elimina los registros de alertas existentes en el archivo de
alertas en linea, previo a un refresque total              alertas en linea, previo a un refresque total
**********************************************************************************************************************************
     display "Eliminando toda la informacion con fuente JURAD"     display "Eliminando toda la informacion con fuente JURAD"
    posiciona en el primer reg de JURAD                              posiciona en el primer reg de JURAD
     move zero to TIP-IDE-BDIIALE                                move zero to TIP-IDE-BDIIALE
     move zero to NUM-IDE-BDIIALE     move zero to NUM-IDE-BDIIALE
     move P-cod-suscriptor to FUENTE-BDIIALE                           move P-cod-suscriptor to FUENTE-BDIIALE
     move zeros to COD-ALERTA-BDIIALE                       move zeros to COD-ALERTA-BDIIALE
     move low-values to LLASEC-BDIIALE            move low-values to LLASEC-BDIIALEtart BDIIALE key > LLAVE-BDIIALEtart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALE           evaluate EST-BDIIALEwhen "00"                         when "00"
*posicionado    *posicionado
 continue                      continue
     when other                                            when otherno hay registros                                  no hay registros
 display "No hay registros a eliminar fs:" EST-BDIIALE display "No hay registros a eliminar fs:" EST-BDIIALE
 exit paragraph                                      exit paragraph
     end-evaluate.                end-evaluate.

*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo                             *    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next record                      read BDIIALE next recordevaluate EST-BDIIALE   evaluate EST-BDIIALEwhen "00"  when "00"
*            display "BDIIALE leido fs:" EST-BDIIALE*            display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALE
33 lines deleted                   if FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor/end-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivos
* $$$$ se agregaron varios archivos más* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
* Totales tipo PESVNO* Totales tipo PESVNOmove W-CONT-TIPO-7  to TIPO-ID-INVALIDO|DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "REGISTROS LEIDOS:" REG-LEIDOS|DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOS|DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R<DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS<DISPLAY "  REGISTROS DE FALLECIDOS:" CONT-FALLECIDOS<DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN<DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS<DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN<DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO<display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la  REPLACE 1 CHAR 
 
 
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"
7 lines deleted/display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.513-VALIDA-EN-CSV.513-VALIDA-EN-CSV.
****************************************************************************************************************************
* Valida si la identificación está en la base de datos alterna* Valida si la identificación está en la base de datos alterna
****************************************************************************************************************************
*    hace validacion de tipo de identificacion*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de id*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDEdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0IF SW-TID-BDIIVIDE = 0
*el tipo de id es OK*el tipo de id es OKIF HACER-MATCH = ZEROSIF HACER-MATCH = ZEROS
>*abre archivos y carga la tabla de direcciones
>*estandar, solo la primera vez
>IF OPEN-DIR = ZEROS
>OPEN INPUT MAESTRO-DIRECC
>OPEN INPUT BDLCLI
>OPEN INPUT SUSCRIPTOR
>OPEN INPUT MAESTRO-CREDIT
>OPEN INPUT MAESTRO-CHECK
>PERFORM 06000-U-CARGAR-TABLA-DIRESTAN
>MOVE 1 TO OPEN-DIR
>END-IF
>*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion*Se recorre toda la estructura bdacsv para la identific
acion
 *buscada. En caso de hallar registros se procede a realizar el*buscada. En caso de hallar registros se procede a real
izar el
*match*matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
*MOVE 1 TO HACERMATCH-LEEMSTRS<IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4IF TIPOID-E = 1 OR 4INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLINSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " ""," BY " ", ";" BY " "END-IFEND-IF










MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1IF MATCH-OK-OUT-VALNOM = 1MOVE 1 TO IDE-TIPO-BDAMATCHMOVE 1 TO IDE-TIPO-BDAMATCH
*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<END-IFEND-IF
12 lines deleted

la
                   END-IFEND-IF
 
li
ad
ee
rn
 t
ai
 f
ei
dc
ea
cc
oi
ro
pn
 s
>END-IF
registros se procede a realizar elINSERT MODE IF IDE-TIPO-BDAMATCH = 1IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE TIPOID-E TO TIP-VALMOVE NUMID-E TO CED-VALMOVE NUMID-E TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOPERFORM 9800-FILTRAR-ALFABETICO


















MOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VAL*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF< 



MOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VAL*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<MOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VAL
*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<MOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VAL
*ELSE|ELSE
*IF W-BLOQUES > 0|IF W-BLOQUES > 0
*MOVE 0 TO IDE-TIPO-BDAMATCH|MOVE 0 TO IDE-TIPO-BDAMATCH
*END-IF<MOVE CADENA-SALE TO  NOM-VALMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO DEP-EXP-VAL
MOVE SPACES TO VIG-VALMOVE SPACES TO VIG-VAL? MOVE SPACES TO GENERO-VALMOVE SPACES TO GENERO-VAL/  REPLACE 1 CHAR /END-IFEND-IFEND-IF.END-IF.9800-FILTRAR-ALFABETICO.9800-FILTRAR-ALFABETICO.
************************************************************************************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
************************************************************************************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAMOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEINITIALIZE CADENA-SALEMOVE 1 TO JMOVE 1 TO JPERFORM VARYING I FROM 1 BY 1 UNTIL I > 60PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOMOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICOIF SI-ALFABETICOMOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO JADD 1 TO JEND-IFEND-IFEND-PERFORM.END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy BDLDIR.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.|COPY LEEMAESTROS.PROC.COPY VALNOM.PROC.<*    COPY LEEMAESTROS.PROC.<

<
//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************  COPY BDAMATCH.PROC.LEEMAESTROS.PROC.COPY BDAMATCHBDAMATCHH.PROC.?  REPLACE 1 CHAR 
                COPY VALNOM.PROC.                                             APPEND MODEp APPEND MODEp            COPY VALNOM.PROC.                                            
 LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
REPLACE 1 CHAR /display "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program JURADCAR.|end program CARGAJUR.************************************************************************************************************************************
************************************************************************************************************************************


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~  REPLACE 1 CHAR ?sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    JURADCAR.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.   /Address search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern
REPLACE 1 CHAR.....     REPLACE 1 CHAR......      
OPEN MODE

APPEND MODE
.......................................................................................


OPEN MODE

.......................................................................................:%s/w CARGAJURZZZ.CBL"CARGAJURZZZ.CBL" [New file] 1608 lines, 194152 characters 
:%s/.......................................................................................//1456 substitutions display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~*sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL$SET LIST SETTING LISTWIDTH"120"
IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on record******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD
******************************************************************
FD JURAD.
01  JURAD-reg.
* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.
*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-terminados pic 999.*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuación no está confirmado, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"Ñ".01  OPEN-DIRPIC 9 value 0.01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  REG-VALIDAS.
03 TIP-VALPIC 9.03 CED-VALPIC 9(11).03 NOM-VALPIC X(45).03 FEC-EXP-VALPIC 9(08).03 MUN-EXP-VALPIC X(15).03 DEP-EXP-VALPIC X(15).03 VIG-VALPIC X(02).03 GENERO-VALPIC X(01).03 EDAD-VALPIC X(03).03 EDAD-RANGOPIC X(05).03 FILLER-2-VALPIC X(51).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************
copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************
copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validación de nombres
******************************************************************
copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************
copy ICFILE.WS.*****************************************************************
* Variables validacion cuentas si validar
*****************************************************************copy BDAMATCH.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.
05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).
******************************************************************
* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.
01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************03pic x(4).******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7) value zero.******************************************************************
* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un01 LA-lineas-alerta.*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Errores de consistencia del input* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(59) value"Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(59) value"Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(11) value "13 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(59) value"El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(59) value"El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(59) value"Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(59) value"Modificación de alerta que no existe".03 pic x(11) value "18 0000000 ".03 pic x(59) value"Eliminación de alerta que no existe".03 pic x(11) value "19 0000000 ".03 pic x(59) value"Inserción de alerta que ya existe".
*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.03pic xx.03pic x(300).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
/*****************************************************************
******************************************************************
PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL
*    1000-NOT-USED
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
***************************************************************** Lectura y control del file status del archivo****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4000-PROCESAR-REGISTRO-2.
****************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg
****************************************************************move "NO" to E-hay-error*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-erroresend-if*    si es el registro "T" hay que señalar el fin de procesoif JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosmove 0 to codigo-errorperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualización de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errorend-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    si el movimiento es una eliminacion los datos subsiguientes*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidosif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-erroresend-if
*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-erroresend-if
*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-erroresend-if
*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-erroresend-if
move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-erroresend-if
*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-erroresend-if
*    Numero de embargos terminadosif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-erroresend-if
*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-erroresend-if
move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-erroresend-if.4200-VALIDACION-SEMANTICA.
****************************************************************
* Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************
*    parámetros para las rutinas de validación en BDIIVIDE*****************************************************************    parámetros para las rutinas de validación en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validaciónmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3move 1 to SW-DIGCHEQUEO-BDIIVIDEend-if
move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el número de identificación contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id inválidocall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validación en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
******************************************************************
* Validación de IDs que figuran OK pero el nombre no coincide
******************************************************************
*    nombre no coincideif TIP-IDE-BDIIVIDE = 1
*es una cédula
move 02 to CODIGO-ERROR*es una cédula
move 02 to CODIGO-ERRORelse
*no es una cédula
move 01 to CODIGO-ERRORend-if.4222-VALIDA-NOMBRE-COINCIDE.
******************************************************************
* Validación de IDs que figuran OK pero el nombre coincide
******************************************************************
*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEnot invalid key
move 0 to SW-BDIIALEread BDIIALE next recordat end
move 1 to SW-BDIIALEend-read
end-start

perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0
*encontrado
move 1 to SW-BDIIALEend-if
if SW-BDIIALE = 0
read BDIIALE next record at endmove 1 to SW-BDIIALEend-read
end-if
end-perform.if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORelsemove 07 to CODIGO-ERRORelse
if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSend-if
end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del código
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cédula OK, nombre no coincide
*    03=NIT no figura
*    04=cédula no figura pero está en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cédula ... ESTADO-VIG-BDIIREGI = 21
*    07=cédula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validación de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCH******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificación está en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cédula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISelse
*no es una cédula
MOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANEND-IF
END-IF.4300-MODIFICAR-BDIIALE.
******************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y
* embargos
******************************************************************initialize REG-BDIIALE*    si hay demandasif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALE
*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.*    si hay embargosif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALE
*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.perform 4300-MODIFICAR-BDIIALE-DATOSend-if.4300-MODIFICAR-BDIIALE-DATOS.
******************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
******************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadwhen "I"
add 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iwhen "M"
add 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mwhen "E"
add 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Ewhen other
*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="JURAD-tipo-novedad " reg num: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAend-evaluate.4300-MODIFICAR-BDIIALE-I.
******************************************************************
* Insercion de una alerta nueva
******************************************************************
*    si el registro existia es un errorif EST-BDIIALE = "00"call "PONERR" using "19" JURAD-reg E-erroresdisplay "llave: " LLAVE-BDIIALEadd 1 to N-ale-ya-existeexit paragraphend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALE*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove spaces to LINEAS-BDIIALEperform 4333-GRABAR-BDIIALE.4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificacion de una alerta existente
******************************************************************
*    si el registro no existia es un errorif EST-BDIIALE not = "00"call "PONERR" using "17" JURAD-reg E-errores"llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeexit paragraphend-if*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove spaces to LINEAS-BDIIALEperform 4333-REGRABAR-BDIIALE.4300-MODIFICAR-BDIIALE-E.
******************************************************************
* Eliminacion de una alerta
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
call "PONERR" using "18" JURAD-reg E-errores"llave: " LLAVE-BDIIALEadd 1 to N-ale-no-existeend-if.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Usa los datos del reg input, excepto LLASEC que esta precargado* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE******************************************************************* Regraba un registro modificado en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
rewrite REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-modificadaswhen other
display "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-ELIMINAR-BDIIALE.
******************************************************************
* Elimina un registro de BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
delete BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-eliminadaswhen other
display "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4800-PROCESO-REG-T.
******************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo
******************************************************************
* Control de los totales calculados contra los esperadosmove "NO" to E-hay-error
*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidoscontinue
elsecontinueelse
display " "
display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errorend-if*    Esta parte está anulada por falta de definición sobre el
*    formato del registro "T"exit paragraph.4800-PROCESO-REG-T-anulado.
*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-vigentes)= N-demandas-vigentescontinue
else
display " "
display "No coincide total de demandas vigentes:"JURADT-demandas-vigentes " con el calculado:"N-demandas-vigentesmove "SI" to E-hay-errorend-if

if function numval(JURADT-demandas-terminadas)= N-demandas-terminadascontinue
else
display " "
display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasmove "SI" to E-hay-errorend-if

if function numval(JURADT-embargos-vigentes)= N-embargos-vigentescontinue
else
display " "
display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesmove "SI" to E-hay-errorend-if

if function numval(JURADT-embargos-terminados)= N-embargos-terminadosif function numval(JURADT-embargos-terminados)= N-embargos-terminadoscontinue
else
display " "
display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosmove "SI" to E-hay-errorend-if.*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAend-if.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************move JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazowrite ERRS-regevaluate ERRS-fs
when "00"
continue
when other
display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAgobackend-evaluate.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - apertura de todos los demas archivos*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?if PROCESO-REAL
display pgm " Carga de archivo JURAD - proceso REAL"else
display pgm " Carga de archivo JURAD - proceso en falso"end-if* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAend-if* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01"
display "01 Envio Original - Carga TOTAL 1a vez"when "02"
display "02 Archivo Semanal - Carga PARCIAL"when "03"
display "03 Archivo Mensual - Carga PARCIAL"when "04"
display "04 Refresque Total - Carga TOTAL"when other
*valor invalido
display "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAend-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* Edita la fecha de proceso DDMMAA del parametro en formato* YYYYMMDD
string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADevaluate JURAD-fs
when "00"
continue
when other
display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameopen output ERRSevaluate ERRS-fs
when "00"
continue
when other
display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOend-if.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEwhen "00"
*posicionado
continue
when other
*no hay registros
display "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphend-evaluate.*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivoperform until EST-BDIIALE not = "00"read BDIIALE next recordevaluate EST-BDIIALEwhen "00"
*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE
if FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD
delete BDIIALE
if EST-BDIIALE = "00"delete BDIIALE
if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradaselse
*error en la eliminacion
display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAend-if
end-if
when "10"
*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"N-ale-leidas
when other
*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos másclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
**************************************************************
* Valida si la identificación está en la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros leídos (excluído el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
**************************************************************
* Valida si la identificación está en la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4IF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
MOVE TIPOID-E TO TIP-VAL
MOVE NUMID-E TO CED-VAL
MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS TO FEC-EXP-VALMOVE SPACES TO MUN-EXP-VALMOVE SPACES TO DEP-EXP-VALMOVE SPACES TO VIG-VAL
MOVE SPACES TO GENERO-VALMOVE SPACES TO EDAD-VAL
MOVE SPACES TO EDAD-RANGOADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
************************************************************************************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC.COPY VALNOM.PROC./
IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.
******************************************************************
* Rutina de conveniencia para procesar un error detectado en un
* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo
******************************************************************
ENVIRONMENT DIVISION.
DATA DIVISION.
WORKING-STORAGE SECTION.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.
******************************************************************LINKAGE SECTION.
******************************************************************
* Codigo del error detectado
01  cod-errorpic xx.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).
******************************************************************
* Tabla de errores de consistencia del input
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx.
*    errores del registro actual03 E-errores-regpic x(300).
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.

end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"CARGAJURZZZ.CBL" [Modified] line 1599 of 1608 --99%-- :w! CARGAJUR.CBL"CARGAJUR.CBL" 1608 lines, 67480 characters 

end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>clear
/d/iccol/desarrollo/fuentes>cat CARGAJUR.CBL
sdiff -w 170 JURADCAR.CBL CARGAJUR.CBL


      $SET LIST SETTING LISTWIDTH"120"
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    CARGAJUR.
      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.

      ******************************************************************
      * Archivos de base alterna
      ******************************************************************
           copy BDACSV.FS.
           copy ICBDIR.FS.
           copy BDLCLI.FS.                         
           COPY ICBSUS.FS.
           COPY ICBCHK.FS.
           COPY ICBCRE.FS.
           COPY BDLSTDCIU.FS.
           COPY DIREST.FS.
           COPY BDLNEWDIRBOG.FS.

      ******************************************************************
      ******************************************************************
       DATA DIVISION.
       FILE section.

      ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************
       FD JURAD.
       01  JURAD-reg.
      * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-tipo-novedad        pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-id-tipo             pic x.
      *    Numero de identificacion
           03 JURAD-id-numeroX          pic x(11).
           03 JURAD-id-numero           redefines JURAD-id-numeroX
                                        pic 9(11).
      *    Nombres y Apellidos
           03 JURAD-nombre              pic x(45).
      *    Numero de demandas vigentes
           03 JURAD-demandas-vigentes   pic 999.
      *    Numero de demandas terminadas
           03 JURAD-demandas-terminadas pic 999.
      *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 JURAD-embargos-vigentes   pic 999.
      *    Numero de embargos terminados
           03 JURAD-embargos-terminados pic 999.
      *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-embargos-fecha-ultimo pic x(8).

       01  JURADT-reg.
      * Registro de totales de control T
      *    Tipo de Novedad = "T"
           03 JURADT-tipo-novedad       pic x.
           03                           pic x.
      *    Cantidad de registros
           03 JURADT-registros          pic 9(11).
           03                           pic x.
      * $$$$ El formato a continuación no está confirmado, no se usa
      *    Total numero de demandas vigentes
           03 JURADT-demandas-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de demandas terminadas
           03 JURADT-demandas-terminadas pic 9(7).
           03                           pic x.
      *    Total numero de embargos vigentes
           03 JURADT-embargos-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de embargos terminados
           03 JURADT-embargos-terminados pic 9(7).
           03                           pic x(41).

      ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************
       FD ERRS.
       01  ERRS-reg.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-tipo-novedad         pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-id-tipo              pic x.
      *    Numero de identificacion
           03 ERRS-id-numero            pic x(11).
      *    Nombres y Apellidos
           03 ERRS-nombre               pic x(45).
      *    Numero de demandas vigentes
           03 ERRS-demandas-vigentes    pic 999.
      *    Numero de demandas terminadas
           03 ERRS-demandas-terminadas  pic 999.
      *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 ERRS-embargos-vigentes    pic 999.
      *    Numero de embargos terminados
           03 ERRS-embargos-terminados  pic 999.
      *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-embargos-fecha-ultimo pic x(8).
      *    Causa del rechazo
           03 ERRS-causa-rechazo        pic x(61).

      ******************************************************************
      * Contiene los ids y nombres de personas
      ******************************************************************
       copy BDIIREGI.FD.

      ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN
      ******************************************************************
       copy BDIIDIAN.FD.

      ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************
       copy BDIIDAS.FD.

      ******************************************************************
      * Archivos de base alterna
      ******************************************************************
           copy BDACSV.FD.
           COPY ICBDIR0001.FD.
           copy BDLCLI.FD.                         
           COPY ICBSUS.FD.
           COPY ICBCHK.FD.
           COPY ICBCRE.FD.
           COPY BDLSTDCIU.FD.
           COPY DIREST.FD.
           COPY BDLNEWDIRBOG.FD.

      ******************************************************************
      * Maestro de alertas reportadas por suscriptores
      ******************************************************************
       copy BDIIALE.FD.

      ******************************************************************
       WORKING-STORAGE section.
      ******************************************************************
      * Nombre del programa
       01  pgm                          pic x(10) value "CARGAJUR".


      ******************************************************************
      * Datos para la búsqueda en base alterna
       01  W-DERECHOS                   PIC 9 value 0.
       01  CODIGO-ERROR                 pic 99 value 00.

       01  SW-BDIIALE                   pic 9 value 0.
       01  HACER-MATCH                  PIC 9 value 0.
       01  CADENA-ENTRA                 PIC X(60).
       01  CADENA-SALE                  PIC X(60).
       01  IND-ALFABETICO              PIC  X(01).                      
           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"
                                            "G" "H" "I" "J" "K" "L" "M"
                                            "N" "/" "O" "P" "Q" "R" "S"
                                            "T" "U" "V" "W" "X" "Y" "Z"
                                            "Ñ".

       01  OPEN-DIR                     PIC 9 value 0.

       01  DATOS-E.
           03 TIPOID-E                  pic 9.
           03 NUMID-E                   pic 9(11).
           03 NOMBRE-E                  pic x(45).

       01  REG-VALIDAS.                           
           03 TIP-VAL                   PIC 9.   
           03 CED-VAL                   PIC 9(11).
           03 NOM-VAL                   PIC X(45).
           03 FEC-EXP-VAL               PIC 9(08).
           03 MUN-EXP-VAL               PIC X(15).
           03 DEP-EXP-VAL               PIC X(15).
           03 VIG-VAL                   PIC X(02).
           03 GENERO-VAL                PIC X(01).
           03 EDAD-VAL                  PIC X(03).
           03 EDAD-RANGO                PIC X(05).
           03 FILLER-2-VAL              PIC X(51).

       01  W-CONTADORES.
           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.
           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.
           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.
           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.
           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

       01  SUSCRIPTOR-AUX               PIC 9(06).            
       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.
       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.
       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.
       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.
       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.
       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.
       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.
       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.
       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.
       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

       01 MAS-DATOS.
           03 I                         PIC 9(02) VALUE ZERO.
           03 J                         PIC 9(02) VALUE ZERO.

           COPY  BDLDIR.WS.

      ******************************************************************
      * Variables para rutina de validacion de identificaciones
      ******************************************************************
       copy BDIIVIDE.WS.

      ******************************************************************
      * Variables relacionadas con la la base BDIIALE de alertas online
      ******************************************************************
       copy BDIIALE.WS.

      ******************************************************************
      * Datos para las rutinas de validación de nombres
      ******************************************************************
       copy VALNOM.WS.

      *****************************************************************
      * Direcciones de los archivos en el file system
      *****************************************************************
       copy ICFILE.WS.

      *****************************************************************
      * Variables validacion cuentas si validar                         
      *****************************************************************
           copy BDAMATCH.WS.                                            

      ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)
       01  IND-fin-proceso              pic xx value "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-reg-anterior           pic x(100) value "(vacio)".
       01  JURAD-fs                     pic xx value spaces.

       01  ERRS-fs                      pic xx value spaces.

      * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-datahost.
           05 D-vigentes                pic 9(5).
           05 D-terminados              pic 9(5).
           05 D-fecha-ultima            pic x(8).
      ******************************************************************
      * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros
       01 P-command-line                pic x(80) value spaces.
       01 P-parametros.
      *    Proceso real: contiene "1" para activar, "2" por defecto
           03 P-proceso-real            pic x value "2".
           88 PROCESO-REAL              value "1".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-file-name               pic x(80) value spaces.
           03 P-file-name-R             redefines P-file-name.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-cod-suscriptor      pic 9(6).
      *        aaa = Codificacion del producto ("100")
               05 P-producto            pic xxx.
      *        DDMMAA = Fecha de proceso
               05 P-fecha-proceso       pic x(6).
      *        bb =  01 a CI
               05 P-ci-bi               pic xx.
      *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL
               05 P-tipo-proceso        pic xx.
      *        extension del archivo ".txt"
               05 P-extension           pic x(4).
               05                       pic x(57).
           03 P-file-path               pic x(80) value spaces.
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
          03 ERRS-file-name             pic x(80) value spaces.

      * Fecha de proceso editada YYYYMMDD
       01 P-fecha-proceso-YYYYMMDD      pic x(8).
      * Fecha de proceso + 50 años
       01 P-fecha-proceso-50.
           03  P-fecha-proceso-50YYYY   pic 9999.
           03                           pic x(4).
      ******************************************************************
      * Datos para el reporte final
       01 W-tiempo.
           03 W-hora-inicio             pic 9(8).
           03 W-hora-fin                pic 9(8).
       01 N-edit                        pic z(8)B.
       01 N-editp100                    redefines N-edit
                                        pic z(5)9.9B.
       01 N-contadores.
      *    Registros en el archivo de entrada
           03 N-reg-leidos              pic 9(8) value zero.
      *    Registros procesados sin error
           03 N-reg-OK                  pic 9(8) value zero.
      *    Registros con error
           03 N-reg-con-error           pic 9(8) value zero.

      *    Cantidades de registros por tipo de novedad
           03 N-reg-tipo-I-OK           pic 9(8) value zero.
           03 N-reg-tipo-M-OK           pic 9(8) value zero.
           03 N-reg-tipo-E-OK           pic 9(8) value zero.
           03 N-reg-tipo-I-err          pic 9(8) value zero.
           03 N-reg-tipo-M-err          pic 9(8) value zero.
           03 N-reg-tipo-E-err          pic 9(8) value zero.

      *    Alertas borradas previo al refresque total
           03 N-ale-leidas              pic 9(8) value zero.
           03 N-ale-borradas            pic 9(8) value zero.
      *    Alertas insertadas
           03 N-ale-insertadas          pic 9(8) value zero.
      *    Alertas modificadas
           03 N-ale-modificadas         pic 9(8) value zero.
      *    Alertas eliminadas
           03 N-ale-eliminadas          pic 9(8) value zero.
      *    Insercion de alerta existente
           03 N-ale-ya-existe           pic 9(8) value zero.
      *    Modificacion o eliminacion de alerta inexistente
           03 N-ale-no-existe           pic 9(8) value zero.

      *    Sumas de cantidades de demandas y embargos
           03 N-demandas-vigentes       pic 9(7) value zero.
           03 N-demandas-terminadas     pic 9(7) value zero.
           03 N-embargos-vigentes       pic 9(7) value zero.
           03 N-embargos-terminados     pic 9(7) value zero.

      ******************************************************************
      * Armado de las lineas de alerta
       01 LA-lineas-alerta.
      *    Los modelos a continuacion deberan obtenerse de un
      *    archivo, como BDIIALE-ALERTAS
           03 LAend                     pic 999 comp value 0.
           03 LA-modelos.
      *         12345678901234567890123456789012345678901234567890
               05 pic x(50) value
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
               05 pic x(50) value
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
               05 pic x(50) value
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
               05 pic x(50) value
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
               05 pic x(50) value high-values. *> end marker
           03 LA-modelos2               redefines LA-modelos.
               05 LA-modelo             pic x(50) occurs 5
                                        indexed LAm.
      *    Funcionamiento de los templates.
      *    Hay dos templates por de alerta, uno por linea.
      *    Cada template consiste en hasta 10 frases fijas con
      *    ampersands (&) donde se van a reemplazar los valores.
      *    Por ejemplo:
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
      *    tiene 3 frases fijas y 2 reemplazos.
      *    La cantidad de ampersands es irrelevante, pero parece
      *    conveniente que informe sobre el tamanio del contenido.
           03 LA-templates.
               05 LA-template           occurs 4 indexed LAx.
                   07 LA-parte          pic x(50)
                                        occurs 10 indexed LAy.
      *    Las dos lineas armadas
           03 LA-lineas.
               05 LA-linea1             pic x(50).
               05 LA-linea2             pic x(50).
      *    Los valores a insertar en una linea
           03 LA-valores.
               05 LA-valor              pic x(50)
                                        occurs 10 indexed LAv.
      *    Datos para editar valores a insertar
           03 LA-num                    pic -(11)0.
           03 LA-numX                   redefines LA-num
                                        pic x(12).
           03 LA-descarte               pic x(50).


      ******************************************************************
      * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx value "NO".
      *    errores del registro actual
           03 E-errores-reg             pic x(300) value spaces.
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8) value zero.
      *    tabla de errores
           03 pic x(11) value "01 0000000 ".
           03 pic x(59) value
           "Tipo de movimiento invalido, debe ser I M E T".
           03 pic x(11) value "02 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion invalido, debe ser 1 2 3 4".
           03 pic x(11) value "03 0000000 ".
           03 pic x(59) value
           "Numero de identificacion invalido, debe ser numerico".
           03 pic x(11) value "04 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion debe ser mayor que cero".
           03 pic x(11) value "05 0000000 ".
           03 pic x(59) value
           "Falta el nombre o denominacion".
           03 pic x(11) value "06 0000000 ".
           03 pic x(59) value
           "Numero de demandas vigentes: debe ser numerico".
           03 pic x(11) value "07 0000000 ".
           03 pic x(59) value
           "Numero de demandas terminadas: debe ser numerico".
           03 pic x(11) value "08 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "09 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "10 0000000 ".
           03 pic x(59) value
           "Numero de embargos vigentes: debe ser numerico".
           03 pic x(11) value "11 0000000 ".
           03 pic x(59) value
           "Numero de embargos terminados: debe ser numerico".
           03 pic x(11) value "12 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "13 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "14 0000000 ".
           03 pic x(59) value
           "El numero de id no se encuentra en el archivo maestro".
           03 pic x(11) value "15 0000000 ".
           03 pic x(59) value
           "El nombre en el input no coincide con el registrado".
           03 pic x(11) value "16 0000000 ".
           03 pic x(59) value
           "Numero de id fuera del rango del tipo de id informado".
           03 pic x(11) value "17 0000000 ".
           03 pic x(59) value
           "Modificación de alerta que no existe".
           03 pic x(11) value "18 0000000 ".
           03 pic x(59) value
           "Eliminación de alerta que no existe".
           03 pic x(11) value "19 0000000 ".
           03 pic x(59) value
           "Inserción de alerta que ya existe".
      *----------------- insertar nuevos items aqui -------------------
           03 pic x(11) value "00 0000000 ".
           03 pic x(59) value "--- fin de la lista (cod 00) ---".
           03                           pic x(3500). *> los 50 items
       01 E-errores-2                   redefines E-errores.
           03                           pic xx.
           03                           pic x(300).
           03                           pic 9(8).
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).
       01 E-edit                        pic z(8)B.

      ******************************************************************
      * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 pic 9(04).
              88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 pic 9(02).
              88 MES-VAL                value 01   thru 12.
           02 DIA-VAL-X                 pic 9(02).
              88 DIA-VAL                value 01   thru 31.


      /*****************************************************************
      ******************************************************************
       PROCEDURE DIVISION.

      *    0000-PROGRAMA-PRINCIPAL
      *    4000-PROCESAR-REGISTRO
      *    4000-PROCESAR-REGISTRO-2
      *    4100-VALIDACION-FORMAL
      *    4200-VALIDACION-SEMANTICA
      *    4220-VALIDA-NOMBRE-NO-COINCIDE
      *    4222-VALIDA-NOMBRE-COINCIDE
      *    4240-CONTAR-TIPO-CUENTA
      *    4210-VALIDACION-ID-NO-FIGURA
      *    4300-MODIFICAR-BDIIALE
      *    4300-MODIFICAR-BDIIALE-DATOS
      *    4300-MODIFICAR-BDIIALE-I
      *    4300-MODIFICAR-BDIIALE-M
      *    4300-MODIFICAR-BDIIALE-E
      *    4333-LEER-BDIIALE-RANDOM
      *    4333-GRABAR-BDIIALE
      *    4333-REGRABAR-BDIIALE
      *    4333-ELIMINAR-BDIIALE
      *    4800-PROCESO-REG-T
      *    4900-GRABAR-ERROR
      *    1000-RUTINA-INICIAL
      *    1000-NOT-USED
      *    1001-ELIMINAR-TODO
      *    7000-RUTINA-FINAL
      *    9000-CANCELAR-PROGRAMA
      *    9800-FILTRAR-ALFABETICO


       0000-PROGRAMA-PRINCIPAL.
      ******************************************************************
      *    inicializa el ambiente y abre los archivos
           perform 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta
      *    encontrar el registro "T" de totales
           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
      *    cierra archivos y produce el reporte final
           perform 7000-RUTINA-FINAL
           goback.

       4000-PROCESAR-REGISTRO.
      ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo
      ****************************************************************
      *    lectura del proximo registro
           read JURAD
           evaluate JURAD-fs
           when "00"
      *        controla el reg y lo aplica si es OK
               perform 4000-PROCESAR-REGISTRO-2
               move JURAD-reg to JURAD-reg-anterior
               add 1 to REG-LEIDOS
           when "10"
      *        fin del archivo de input:
      *        esto es un error, no se encontro el registro "T" antes
      *        de que se terminara el archivo
               display "Falta el reg de totales del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           when other
      *        error de lectura: cancelacion del proceso
               display "Error en lectura del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4000-PROCESAR-REGISTRO-2.
      ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg
      ****************************************************************
           move "NO" to E-hay-error

      *    validacion del tipo de movimiento
           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"
               call "PONERR" using "01" JURAD-reg E-errores
           end-if

      *    si es el registro "T" hay que señalar el fin de proceso
           if JURAD-tipo-novedad = "T"
               move "SI" to IND-fin-proceso
               perform 4800-PROCESO-REG-T
               exit paragraph
           end-if

           add 1 to N-reg-leidos

      *    validacion formal de los datos
           move 0 to codigo-error
           perform 4100-VALIDACION-FORMAL
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
*******        perform 4240-CONTAR-TIPO-CUENTA
               exit paragraph
           end-if

      *    si la validacion formal dio OK se hace validacion semantica
           perform 4200-VALIDACION-SEMANTICA
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               perform 4240-CONTAR-TIPO-CUENTA
               exit paragraph
           end-if

           perform 4240-CONTAR-TIPO-CUENTA

      *    intento de actualización de BDIIALE
           perform 4300-MODIFICAR-BDIIALE
           add 1 to N-reg-OK.



       4100-VALIDACION-FORMAL.
      ******************************************************************
      * Validacion formal de los datos del input
      ******************************************************************
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           if JURAD-id-tipo not = "1" and "2" and "3" and "4"
               call "PONERR" using "02" JURAD-reg E-errores
               move 05 to codigo-error
           end-if
      *    Numero de identificacion
           if JURAD-id-numeroX is not numeric
               call "PONERR" using "03" JURAD-reg E-errores
           end-if
           if JURAD-id-numero not > 0
               call "PONERR" using "04" JURAD-reg E-errores
           end-if
      *    si el movimiento es una eliminacion los datos subsiguientes
      *    no se controlan
           if JURAD-tipo-novedad = "E"
               exit paragraph
           end-if
      *    Nombres y Apellidos
           if JURAD-nombre = spaces
               call "PONERR" using "05" JURAD-reg E-errores
           end-if
      *    Numero de demandas vigentes
           if JURAD-demandas-vigentes is not numeric
               call "PONERR" using "06" JURAD-reg E-errores
           end-if
      *    Numero de demandas terminadas
           if JURAD-demandas-terminadas is not numeric
               call "PONERR" using "07" JURAD-reg E-errores
           end-if
      *    Fecha ultima demanda vigente YYMMDD
           if JURAD-demandas-fecha-ultima is not numeric
               call "PONERR" using "08" JURAD-reg E-errores
           end-if
           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "09" JURAD-reg E-errores
           end-if
      *    Numero de embargos vigentes
           if JURAD-embargos-vigentes not numeric
               call "PONERR" using "10" JURAD-reg E-errores
           end-if
      *    Numero de embargos terminados
           if JURAD-embargos-terminados not numeric
               call "PONERR" using "11" JURAD-reg E-errores
           end-if
      *    Fecha ultimo embargo vigente YYMMDD
           if JURAD-embargos-fecha-ultimo is not numeric
               call "PONERR" using "12" JURAD-reg E-errores
           end-if
           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "13" JURAD-reg E-errores
           end-if.


       4200-VALIDACION-SEMANTICA.
      ****************************************************************
      * Validacion del numero de identificacion y de su relacion con
      * el nombre
      ****************************************************************
      *    parámetros para las rutinas de validación en BDIIVIDE
           move JURAD-id-tipo to TIP-IDE-BDIIVIDE
           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
           move JURAD-nombre to NOMBRE-BDIIVIDE
      *    algunas rutinas de COPYs usan estos datos
           move JURAD-id-tipo to TIPOID-E
           move JURAD-id-numero to NUMID-E
           move JURAD-nombre to NOMBRE-E
      *    switches de opciones de validación
           move 1 to SW-VERIFNOM-BDIIVIDE
           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
           if TIP-IDE-BDIIVIDE = 2 or 3
               move 1 to SW-DIGCHEQUEO-BDIIVIDE
           end-if
           move 2 to NUM-BLOQUES-BDIIVIDE
      *    Valida el número de identificación contra las bases de
      *    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
      *    del nombre reportado
      *    Retorna SW-ID-BDIIVIDE=1 si hay error
           perform 80100-VALIDAR-IDENTIFICACION
      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
           if SW-ID-BDIIVIDE = 1
      *        es un id inválido
               call "PONERR" using "14" JURAD-reg E-errores
      *        valida contra la base alterna
               perform 4210-VALIDACION-ID-NO-FIGURA
           else
      *        existe id, a ver si el nombre coincide
               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
                   call "PONERR" using "15" JURAD-reg E-errores
                   display "novedad:  " JURAD-nombre
                   display "registro: " NOM-LEIDO-BDIIVIDE
      *            validación en base alterna
                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE
               else
                   perform 4222-VALIDA-NOMBRE-COINCIDE
               end-if
           end-if.


       4220-VALIDA-NOMBRE-NO-COINCIDE.
      ******************************************************************
      * Validación de IDs que figuran OK pero el nombre no coincide
      ******************************************************************
      *    nombre no coincide
           if TIP-IDE-BDIIVIDE = 1
      *        es una cédula
               move 02 to CODIGO-ERROR
           else
      *        no es una cédula
               move 01 to CODIGO-ERROR
           end-if.


       4222-VALIDA-NOMBRE-COINCIDE.
      ******************************************************************
      * Validación de IDs que figuran OK pero el nombre coincide
      ******************************************************************
      *    nombre coincide: busca ID en BDIIALE
           initialize LLAVE-BDIIALE
           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE
           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE
           move 990003 to FUENTE-BDIIALE
           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY
               move 1 TO SW-BDIIALE
           not invalid key
               move 0 to SW-BDIIALE
               read BDIIALE next record
               at end
                   move 1 to SW-BDIIALE
               end-read
           end-start

           perform until SW-BDIIALE = 1
           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE
           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE
           or FUENTE-BDIIALE > 990003
               if FUENTE-BDIIALE = 990003
               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD
               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD
               and BLOQUEO-BDIIALE = 0
      *             encontrado
                    move 1 to SW-BDIIALE
               end-if
               if SW-BDIIALE = 0
                   read BDIIALE next record at end
                       move 1 to SW-BDIIALE
                   end-read
               end-if
           end-perform.

           if TIP-IDE-BDIIVIDE = 1
               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1
                   move 07 to CODIGO-ERROR
               else
                   if ESTADO-VIG-BDIIREGI = 21
                       move 06 to CODIGO-ERROR
                       add 1 to NO-COINCIDE-REGIS
                       add 1 to CONT-FALLECIDOS
                   end-if
               end-if
           end-if.


       4240-CONTAR-TIPO-CUENTA.
      ******************************************************************
      *    Conteo de los registros por "tipo", dependiendo del código
      *    de error:
      *    00=OK
      *    01=NIT OK, nombre no coincide
      *    02=cédula OK, nombre no coincide
      *    03=NIT no figura
      *    04=cédula no figura pero está en base alterna
      *    05=tipo id no es 1|2|3|4
      *    06=cédula ... ESTADO-VIG-BDIIREGI = 21
      *    07=cédula ... ESTADO-VIG-BDIIREGI = 12
      *
      *    cuenta tipo 5: sin error
      *    cuenta tipo 6: 01 02 06 07
      *    cuenta tipo 7: 03 04 05
      ******************************************************************
           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07
               ADD 1 TO W-CONT-TIPO-6
           ELSE
               IF CODIGO-ERROR = 03 OR 04 OR 05
                   ADD 1 TO W-CONT-TIPO-7
               ELSE
      *            es 00: registros correctos
                   ADD 1 TO W-CONT-TIPO-5
      *            si es una empresa
                   IF TIPOID-E = 2 OR 3
                       ADD 1 TO W-CONT-TIPO-5-PJ
                   END-IF
               END-IF
           END-IF.


       4210-VALIDACION-ID-NO-FIGURA.
      ******************************************************************
      * Validación de IDs que no figuran en las bases normales
      ******************************************************************
           MOVE 0 TO HACER-MATCH
           MOVE 0 TO IDE-TIPO-BDAMATCH
      *    valida si la identificación está en la base de datos alterna
           PERFORM 513-VALIDA-EN-CSV
           IF IDE-TIPO-BDAMATCH = 0
               IF TIP-IDE-BDIIVIDE = 1
      *            es una cédula
                   MOVE 04 TO CODIGO-ERROR
                   ADD  1  TO NO-EXISTE-REGIS                           
               else
      *            no es una cédula
                   MOVE 03 TO CODIGO-ERROR
                   ADD   1 TO  NO-EXISTE-DIAN                           
               END-IF
           END-IF.


       4300-MODIFICAR-BDIIALE.
      ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones,
      * modificaciones o eliminaciones segun haya o no demandas y
      * embargos
      ******************************************************************
           initialize REG-BDIIALE

      *    si hay demandas
           if JURAD-demandas-vigentes > zero
           or JURAD-demandas-terminadas > zero
               move "J001" to LLASEC-BDIIALE
      *        arma datos de demandas
               move JURAD-demandas-vigentes to D-vigentes
               move JURAD-demandas-terminadas to D-terminados
               string "20" JURAD-demandas-fecha-ultima
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS
           end-if.

      *    si hay embargos
           if JURAD-embargos-vigentes > zero
           or JURAD-embargos-terminados > zero
               move "J002" to LLASEC-BDIIALE
      *        arma datos de embargos
               move JURAD-embargos-vigentes to D-vigentes
               move JURAD-embargos-terminados to D-terminados
               string "20" JURAD-embargos-fecha-ultimo
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS
           end-if.



       4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************
      * Parte de la carga de datos en el registro BDIIALE y grabacion
      * del mismo que es comun a demandas y embargos
      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
      ******************************************************************
      *    completa la clave e intenta leer la alerta, si se leyo OK
      *    el file status de BDIIALE queda con "00"
           perform 4333-LEER-BDIIALE-RANDOM

      *    procesa segun el tipo de novedad I M E
           evaluate JURAD-tipo-novedad
           when "I"
               add 1 to N-reg-tipo-I-OK
               perform 4300-MODIFICAR-BDIIALE-I
           when "M"
               add 1 to N-reg-tipo-M-OK
               perform 4300-MODIFICAR-BDIIALE-M
           when "E"
               add 1 to N-reg-tipo-E-OK
               perform 4300-MODIFICAR-BDIIALE-E
           when other
      *        esto es "imposible" por control de consistencia anterior
               display "error de logica: tipo-novedad="
               JURAD-tipo-novedad " reg num: " N-reg-leidos
               display "Registro de JURAD: " display JURAD-reg
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4300-MODIFICAR-BDIIALE-I.
      ******************************************************************
      * Insercion de una alerta nueva
      ******************************************************************
      *    si el registro existia es un error
           if EST-BDIIALE = "00"
               call "PONERR" using "19" JURAD-reg E-errores
               display "llave: " LLAVE-BDIIALE
               add 1 to N-ale-ya-existe
               exit paragraph
           end-if

      *    completa los datos del registro
           initialize ENCABEZADO-BDIIALE
           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
           FEC-REP-BDIIALE
           move P-fecha-proceso-50 to FEC-VEN-BDIIALE
           move 0 to BLOQUEO-BDIIALE
           move D-datahost to INF-DATAHOST-BDIIALE
           move spaces to LINEAS-BDIIALE
           perform 4333-GRABAR-BDIIALE.


       4300-MODIFICAR-BDIIALE-M.
      ******************************************************************
      * Modificacion de una alerta existente
      ******************************************************************
      *    si el registro no existia es un error
           if EST-BDIIALE not = "00"
               call "PONERR" using "17" JURAD-reg E-errores
               "llave: " LLAVE-BDIIALE
               add 1 to N-ale-no-existe
               exit paragraph
           end-if

      *    reemplaza la fecha de reporte y los valores
           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE
           move D-datahost to INF-DATAHOST-BDIIALE
           move spaces to LINEAS-BDIIALE
           perform 4333-REGRABAR-BDIIALE.


       4300-MODIFICAR-BDIIALE-E.
      ******************************************************************
      * Eliminacion de una alerta
      ******************************************************************
      *    elimina el registro
           if EST-BDIIALE = "00"
               perform 4333-ELIMINAR-BDIIALE
           else
               call "PONERR" using "18" JURAD-reg E-errores
               "llave: " LLAVE-BDIIALE
               add 1 to N-ale-no-existe
           end-if.


       4333-LEER-BDIIALE-RANDOM.
      ******************************************************************
      * Arma clave exacta y lee un registro de BDIIALE
      * Usa los datos del reg input, excepto LLASEC que esta precargado
      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
      ******************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIALE
           move JURAD-id-numero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move 000 to COD-ALERTA-BDIIALE
      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

           read BDIIALE
           evaluate EST-BDIIALE
           when "00"
               continue
           when "23"
               continue
           when other
               display "Error al leer BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Ultimo registro procesado: "
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.
      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-GRABAR-BDIIALE.
      ******************************************************************
      * Inserta un registro nuevo en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           write REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-insertadas
           when other
               display "Error al grabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-REGRABAR-BDIIALE.
      ******************************************************************
      * Regraba un registro modificado en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           rewrite REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-modificadas
           when other
               display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-ELIMINAR-BDIIALE.
      ******************************************************************
      * Elimina un registro de BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           delete BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-eliminadas
           when other
               display "Error al deletear BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

       4800-PROCESO-REG-T.
      ******************************************************************
      * El registro leido en el archivo JURAD es tipo "T" con totales
      * de control, y debería ser el ultimo del archivo
      ******************************************************************
      * Control de los totales calculados contra los esperados
           move "NO" to E-hay-error
      *    cantidad de registros I M E
           if function numval(JURADT-registros) = N-reg-leidos
               continue
           else
               display " "
               display "No coincide la cantidad de registros:"
               JURADT-registros " con los leidos:" N-reg-leidos
               move "SI" to E-hay-error
           end-if

      *    Esta parte está anulada por falta de definición sobre el
      *    formato del registro "T"
           exit paragraph.

       4800-PROCESO-REG-T-anulado.
      *    Sumas de cantidades de demandas y embargos
           if function numval(JURADT-demandas-vigentes)
           = N-demandas-vigentes
               continue
           else
               display " "
               display "No coincide total de demandas vigentes:"
               JURADT-demandas-vigentes " con el calculado:"
               N-demandas-vigentes
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-demandas-terminadas)
           = N-demandas-terminadas
               continue
           else
               display " "
               display "No coincide total de demandas terminadas:"
               JURADT-demandas-terminadas " con el calculado:"
               N-demandas-terminadas
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-vigentes)
           = N-embargos-vigentes
               continue
           else
               display " "
               display "No coincide total de embargos vigentes:"
               JURADT-embargos-vigentes " con el calculado:"
               N-embargos-vigentes
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-terminados)
           = N-embargos-terminados
               continue
           else
               display " "
               display "No coincide total de embargos terminados:"
               JURADT-embargos-terminados " con el calculado:"
               N-embargos-terminados
               move "SI" to E-hay-error
           end-if.

      *    si hubo cualquier cosa se invalida el proceso
           if E-hay-error = "SI"
               display "Error en registro T de totales de control"
               display "Nombre del archivo: " ERRS-file-name
               perform 9000-CANCELAR-PROGRAMA
           end-if.


       4900-GRABAR-ERROR.
      ******************************************************************
      * El registro de JURAD tiene error: se graba en el archivo ERRS
      * con indicacion del error detectado
      ******************************************************************
           move JURAD-reg to ERRS-reg
           move E-errores-reg to ERRS-causa-rechazo
      *    lista de los codigos de los errores del registro
           move E-errores-reg to ERRS-causa-rechazo
           write ERRS-reg
           evaluate ERRS-fs
               when "00"
                   continue
               when other
                   display "Error al grabar el archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA
                   goback
           end-evaluate.


       1000-RUTINA-INICIAL.
      ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:
      *   - obtencion de los parametros
      *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo
      *   - carga en memoria de los IDs de inconsistentes
      ******************************************************************
      * Registra hora de inicio
           accept W-hora-inicio from time

      * Obtiene informacion sobre la corrida de la linea de comando: el
      * nombre del archivo de entrada (que contiene el tipo de proceso),
      * el indicador de proceso real o en falso (default)
           accept P-command-line from COMMAND-LINE
           display "Parametros: " P-command-line
           unstring P-command-line delimited by all " " into
           P-file-name P-proceso-real

      * El programa se anuncia en la consola
      * TODO: se usa un anuncio mas vistoso?
           if PROCESO-REAL
               display pgm " Carga de archivo JURAD - proceso REAL"
           else
               display pgm " Carga de archivo JURAD - proceso en falso"
           end-if

      * El indicador de proceso real debe ser 1 o 2
           if P-proceso-real not = "1" and "2"
               display "El indicador de proceso real es invalido"
               display "debe ser 1 o 2"
               perform 9000-CANCELAR-PROGRAMA
           end-if

      * TODO: controlar los componentes del filename
           evaluate P-tipo-proceso
           when "01"
               display "01 Envio Original - Carga TOTAL 1a vez"
           when "02"
               display "02 Archivo Semanal - Carga PARCIAL"
           when "03"
               display "03 Archivo Mensual - Carga PARCIAL"
           when "04"
               display "04 Refresque Total - Carga TOTAL"
           when other
      *        valor invalido
               display "El tipo de proceso " P-tipo-proceso
               " es invalido (debe ser 01 02 03 o 04)"
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

      * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD
           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
           P-fecha-proceso(1:2) delimited size
           into P-fecha-proceso-YYYYMMDD
           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

      * Calcula una fecha 50 anios posterior a la de proceso
           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
           add 50 to P-fecha-proceso-50YYYY

      * Apertura del archivo de entrada
           string "$TEMPORALES/" P-file-name into P-file-path
           open input JURAD
           evaluate JURAD-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo JURAD "
                   display "Path del archivo: " P-file-path
                   display "File status: " JURAD-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura del archivo de errores
           string "$TEMPORALES/" P-file-name(1:19) ".errs"
           into ERRS-file-name
           open output ERRS
           evaluate ERRS-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura de los archivos maestros
      * TODO: falta capturar el status de estas operaciones?
           open input BDIIREGI
           open input BDIIDIAN
           open input BDIIDAS.

      * Apertura del archivo de alertas en linea
           if PROCESO-REAL
               open i-o BDIIALE
           else
               open input BDIIALE
           end-if.

      * Si es un refresque total (codigo 04) se eliminan los registros
      * de Jurad existentes
           if P-tipo-proceso = "04" and PROCESO-REAL
               perform 1001-ELIMINAR-TODO
           end-if.


       1001-ELIMINAR-TODO.
      ******************************************************************
      * Elimina los registros de alertas existentes en el archivo de
      * alertas en linea, previo a un refresque total
      ******************************************************************
           display "Eliminando toda la informacion con fuente JURAD"
      *    posiciona en el primer reg de JURAD
           move zero to TIP-IDE-BDIIALE
           move zero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move zeros to COD-ALERTA-BDIIALE
           move low-values to LLASEC-BDIIALE
           start BDIIALE key > LLAVE-BDIIALE
      *    display "Start BDIIALE k:" LLAVE-BDIIALE
           evaluate EST-BDIIALE
           when "00"
      *        posicionado
               continue
           when other
      *        no hay registros
               display "No hay registros a eliminar fs:" EST-BDIIALE
               exit paragraph
           end-evaluate.

      *    lee secuencialmente y elimina los registros de JURAD
      *    hasta el fin del archivo
           perform until EST-BDIIALE not = "00"
               read BDIIALE next record
               evaluate EST-BDIIALE
               when "00"
      *            display "BDIIALE leido fs:" EST-BDIIALE
      *            " k:" LLAVE-BDIIALE
                   if FUENTE-BDIIALE = P-cod-suscriptor
      *                es un alerta de JURAD
                       delete BDIIALE
                       if EST-BDIIALE = "00"
      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE
                           add 1 to N-ale-borradas
                       else
      *                    error en la eliminacion
                           display "Error al eliminar un registro de "
                           "BDIIALE vaciando los datos"
                           display "Clave: " LLAVE-BDIIALE
                           display "Reg borrados: " N-ale-borradas
                           perform 9000-CANCELAR-PROGRAMA
                       end-if
                   end-if
               when "10"
      *            fin de archivo: sale normalmente
                   display "Fin de los registros a eliminar - leídos:"
                   N-ale-leidas
               when other
      *            lectura anormal: cancelacion del programa
                   display "Error en lectura del archivo de alertas "
                   "online"
                   display "File status: " EST-BDIIALE
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
               end-evaluate
           end-perform.
           display "Termino la eliminacion total de JURAD"
           display "Reg borrados: " N-ale-borradas.


       7000-RUTINA-FINAL.
      ******************************************************************
      * Registra hora de finalizacion
           accept W-hora-fin from time

      * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos
      * $$$$ se agregaron varios archivos más
           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
      * Emision de contadores de registros
           display " "
           display "Totales de registros:"
           display " "
      * Totales tipo PESVNO
           DISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5
           DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6
           DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7
           display " "
      *    porcentaje registros procesados OK
           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos
           display N-editp100 "% de registros correctos"
      *    porcentaje registros inconsistentes
           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
           / N-reg-leidos
           display N-editp100 "% de registros inconsistentes"
      *    cantidad de registros leídos (excluído el registro "T")
           move N-reg-leidos to N-edit
           display N-edit "Registros IME en el archivo de entrada"
      *    cantidad de registros procesados sin error
           move N-reg-OK to N-edit
           display N-edit "Registros procesados sin error"

      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
      * definicion de estos contadores
      *    move N-reg-tipo-I-OK to N-edit
      *    display N-edit "Registros tipo I aceptados"
      *    move N-reg-tipo-M-OK to N-edit
      *    display N-edit "Registros tipo M aceptados"
      *    move N-reg-tipo-E-OK to N-edit
      *    display N-edit "Registros tipo E aceptados"

      *    cantidad de registros con error
           move E-cont-regs-con-error to N-reg-con-error
           move N-reg-con-error to N-edit
           display N-edit "Registros con error"
      *    cantidades de alertas afectadas
           if P-tipo-proceso = "04"
               move N-ale-borradas to N-edit
               display N-edit
               "Alertas borradas previo al refresque total"
           end-if
           move N-ale-insertadas to N-edit
           display N-edit "Alertas insertadas"
           move N-ale-modificadas to N-edit
           display N-edit "Alertas modificadas"
           move N-ale-eliminadas to N-edit
           display N-edit "Alertas eliminadas"
           move N-ale-ya-existe to N-edit
           display N-edit "Insercion de alerta existente"
           move N-ale-no-existe to N-edit
           display N-edit "Modif o elim de alerta inexistente".

      * Emision del reporte de errores
           display " "
           display "Totales por tipo de error detectado:"
           perform varying Ex from 1 by 1 until Ex > 50
           or E-codigo(Ex) = "00"
               if E-contador(Ex) not = 0
                   move E-contador(ex) to E-edit
                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
               end-if
           end-perform.


       9000-CANCELAR-PROGRAMA.
      ******************************************************************
      * Procedimiento standard de cancelacion de programa batch
      ******************************************************************
      * TODO: hay un standard para comunicar una cancelacion de proceso?
           display " "
           display pgm " - proceso cancelado"
           goback returning 99.


       513-VALIDA-EN-CSV.
      **************************************************************
      * Valida si la identificación está en la base de datos alterna
      **************************************************************
      *    hace validacion de tipo de identificacion
           MOVE TIPOID-E TO TIP-IDE-BDIIVIDE
           MOVE NUMID-E TO NUM-IDE-BDIIVIDE
      *    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro
      *    del rango que corresponde al tipo de id
           display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE
           " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE
           " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE
           PERFORM 80400-VALIDAR-TIPO-ID
           display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE
           " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE
           " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE
           IF SW-TID-BDIIVIDE = 0
      *        el tipo de id es OK
               IF HACER-MATCH = ZEROS
                   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH
                   MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
      *            Se recorre toda la estructura bdacsv para la
      *            identificacion buscada. En caso de hallar 
      *            registros se procede a realizar el match
                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH
                   IF IDE-TIPO-BDAMATCH = 1
                       IF TIPOID-E = 1 OR 4
                           INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL
                           "," BY " ", ";" BY " "
                       END-IF
                       MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM
                       MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM
                       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM
                       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
                       PERFORM 10000-MATCH-NOMBRES-VALNOM
                       IF MATCH-OK-OUT-VALNOM = 1
                           MOVE 1 TO IDE-TIPO-BDAMATCH
                       END-IF
                   END-IF

                   IF IDE-TIPO-BDAMATCH = 1
                       MOVE TIPOID-E TO TIP-VAL
                       MOVE NUMID-E TO CED-VAL
                       MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
                       PERFORM 9800-FILTRAR-ALFABETICO
                       MOVE CADENA-SALE TO  NOM-VAL
                       MOVE ZEROS TO FEC-EXP-VAL
                       MOVE SPACES TO MUN-EXP-VAL
                       MOVE SPACES TO DEP-EXP-VAL
                       MOVE SPACES TO VIG-VAL
                       MOVE SPACES TO GENERO-VAL
                       MOVE SPACES TO EDAD-VAL
                       MOVE SPACES TO EDAD-RANGO
                       ADD 1 TO SI-EXISTE-CSV
                   END-IF
               END-IF
           END-IF.

       9800-FILTRAR-ALFABETICO.
      ******************************************************************
      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
      ******************************************************************
           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA
           INITIALIZE CADENA-SALE
           MOVE 1 TO J
           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60
              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO
              IF SI-ALFABETICO
                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)
                 ADD 1 TO J
              END-IF
           END-PERFORM.
      ******************************************************************



           copy BDIIVIDE.PROC.
           copy BDLDIR.PROC.
           COPY BDAMATCH.PROC.
           COPY VALNOM.PROC.                                            


      /
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.
      ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un
      * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo
      ******************************************************************
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input-anterior           pic x(86) value low-values.
      * Posicion del proximo error en la lista de errores del reg
       01  errIndex                     pic 999 comp.
      ******************************************************************

       LINKAGE SECTION.
      ******************************************************************
      * Codigo del error detectado
       01  cod-error                    pic xx.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input                    pic x(86).
      ******************************************************************
      * Tabla de errores de consistencia del input
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx.
      *    errores del registro actual
           03 E-errores-reg             pic x(300).
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8).
      *    tabla de errores
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).

      ******************************************************************

       PROCEDURE DIVISION using cod-error reg-input E-errores.
       00.
      *    marca al reg actual como erroneo
           move "SI" to E-hay-error

      *    cuenta y muestra el registro de input
           if reg-input not = reg-input-anterior
               add 1 to E-cont-regs-con-error
               display " "
               display reg-input
               move reg-input to reg-input-anterior
               move spaces to E-errores-reg
               move 2 to errIndex
           end-if

      *    contabiliza el error en la tabla de errores
           set Ex to 1
           search E-error varying Ex
           at end
               display "--- falla en la tabla de errores ---" cod-error
           when E-codigo(Ex) = "00"
               add 1 to E-contador(Ex)
               display "--- error tipo exotico: " cod-error
               add 1 to E-contador(Ex)
           when E-codigo(Ex) = cod-error
               add 1 to E-contador(Ex)
               display "Error " cod-error " " E-descripcion(Ex)
           end-search

      *    agrega a la lista de errores del registro
           if errIndex < (300 - 59 - 3)
               move cod-error to E-errores-reg(errIndex:2)
               add 3 to errIndex
               move E-descripcion(Ex) to E-errores-reg(errIndex:59)
               add 59 to errIndex
           end-if

           exit program.


       end program PONERR.

       end program CARGAJUR.

      ******************************************************************
      ******************************************************************


/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>jobs
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>date
Thursday, June 12, 2014 11:31:44 AM COT
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
shell will timeout in 60 seconds due to inactivity

/d/iccol/desarrollo/fuentes>date
Thursday, June 12, 2014 12:01:51 PM COT
/d/iccol/desarrollo/fuentes>^[   /d/iccol/desarrollo/fuentes>
shell will timeout in 60 seconds due to inactivity
ksh: timed out waiting for input
