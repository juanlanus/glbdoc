=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.12 20:21:13 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Thu Jun 12 18:00:25 2014 from 172.16.10.26
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fu. visetvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:   252
* Unrecoverable :     0                    Severe  :   252
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1421908     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>vi    clear
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cleardes-c-v CARGAJURfu              . visetvi CARGAJUR.CBL.errdes-c-v CARGAJUR   vi CARGAJUR.CBL.err CARGAJUR.CBL.err  c CARGAJUR.CBL.erra CARGAJUR.CBL.errt CARGAJUR.CBL.err
* Rejected - OPT
  3577                 MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM                                                     1465
*  12-S****************************************************            (   0)**                                 1466
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                               1466
  3578                 MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM                                          1466
*  12-S*************************************************************** (  63)**                                 1467
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                               1467
  3579                 MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM                                                    1467
*  12-S*****************************************************           (  63)**                                 1468
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                               1468
  3580                 MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                                        1468
*  12-S****************************************************************(  63)**                                 1469
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                              1469
  3582                 IF MATCH-OK-OUT-VALNOM = 1                                                               1470
*  12-S**************************************                          (  63)**                                 1470
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                               1470
  3592     END-IF.                                                                                              1480
* 564-S**********                                                      (  63)**                                 1480
**    A scope-delimiter did not have a matching verb and was discarded.                                         1480
  3652    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM                                    BDIIVIDE      40
* 301-S*********************************************************       (  64)**                                   42
**    Unrecognized verb                                                                                           42
  3683          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM                                        BDIIVIDE      71
*  12-S*****************************************************           (  65)**                                   72
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 72
  3684          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM                                         BDIIVIDE      72
*  12-S****************************************************            (  65)**                                   73
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                 73
  3685          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM                                        BDIIVIDE      73
*  12-S*****************************************************           (  65)**                                   74
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                 74
  3689                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                             BDIIVIDE      77
*  12-S****************************************************************(  65)**                                   78
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                78
  3690             ELSE IF TIP-ID-INPUT-VALNOM = 1                                                  BDIIVIDE      78
*  12-S***************************************                         (  65)**                                   78
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 78
  3691                     MOVE 2 TO BLOQUES-INPUT-VALNOM                                           BDIIVIDE      79
*  12-S**************************************************              (  66)**                                   80
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                80
  3692                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM                                         BDIIVIDE      80
*  12-S****************************************************            (  66)**                                   82
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                                82
  3696             IF MATCH-OK-OUT-VALNOM = 0                                                       BDIIVIDE      84
*  12-S**********************************                              (  66)**                                   84
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                 84
  3701      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002                     BDIIVIDE      89
* 562-S*********                                                       (  66)**                                   89
**    An "ELSE" phrase did not have a matching IF and was discarded.                                              89
  3704      END-IF                                                      FAC0002                     BDIIVIDE      92
* 564-S***********                                                     (  66)**                                   93
**    A scope-delimiter did not have a matching verb and was discarded.                                           93
  3706    END-IF.                                                                                   BDIIVIDE      94
* 564-S*********                                                       (  66)**                                   94
**    A scope-delimiter did not have a matching verb and was discarded.                                           94
  6882       MOVE 0 TO MATCH-OK-OUT-VALNOM                                                          BDAMATCH     727
*  12-S***********************************                             (  66)**                                  728
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                728
  6885               OR MATCH-OK-OUT-VALNOM = 1                                                     BDAMATCH     730
*  12-S************************************                            ( 121)**                                  730
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                730
  6887              NOMBRE-INPUT-VALNOM                                                             BDAMATCH     732
*  12-S********************************                                ( 121)**                                  733
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                733
  6889              NOMBOK-INPUT-VALNOM                                                             BDAMATCH     734
*  12-S********************************                                ( 121)**                                  735
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                735
  6893               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     738
*  12-S*******************************************                     ( 121)**                                  739
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                739
  6894               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     739
*  12-S********************************************                    ( 121)**                                  741
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               741
  6896               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     741
*  12-S*******************************************                     ( 121)**                                  742
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                742
  6897               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     742
*  12-S********************************************                    ( 121)**                                  744
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               744
  6900            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004                     BDAMATCH     745
*  12-S****************************************                        ( 121)**                                  746
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                746
  6901            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     746
*  12-S*****************************************                       ( 121)**                                  748
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               748
  6903         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004                     BDAMATCH     748
*  12-S******************************                                  ( 121)**                                  748
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                748
  6905            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     750
*  12-S*****************************************                       ( 121)**                                  752
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               752
  6906         END-IF                                                   RMB0004                     BDAMATCH     751
* 564-S**************                                                  ( 122)**                                  752
**    A scope-delimiter did not have a matching verb and was discarded.                                          752
  6908         IF MATCH-OK-OUT-VALNOM = 1                                                           BDAMATCH     753
*  12-S******************************                                  ( 122)**                                  753
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                753
  6915            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004                     BDAMATCH     760
*  12-S**********************************                              ( 122)**                                  760
**    Operand BLOQUES-INPUT-VALNOM is not declared                                                               760
  6917            END-IF                                                RMB0004                     BDAMATCH     762
* 564-S*****************                                               ( 122)**                                  763
**    A scope-delimiter did not have a matching verb and was discarded.                                          763
  6930         END-IF                                                                               BDAMATCH     775
* 564-S**************                                                  ( 122)**                                  776
**    A scope-delimiter did not have a matching verb and was discarded.                                          776
  6933       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO                                             BDAMATCH     778
*  12-S****************************                                    ( 122)**                                  778
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                778
  6952       ELSE                                                    *>                             BDAMATCH     797
* 562-S**********                                                      ( 122)**                                  797
**    An "ELSE" phrase did not have a matching IF and was discarded.                                             797
  6955       END-IF                                                                                 BDAMATCH     800
* 564-S************                                                    ( 123)**                                  801
**    A scope-delimiter did not have a matching verb and was discarded.                                          801
  6957     END-PERFORM.                                                                             BDAMATCH     802
* 564-S***************                                                 ( 123)**                                  802
**    A scope-delimiter did not have a matching verb and was discarded.                                          802
  7399     MOVE 0 TO MATCH-OK-OUT-VALNOM.                                                           VALNOM        42
*  12-S*********************************                               ( 123)**                                   42
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                 42
  7400     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM        43
*  12-S****************************                                    ( 130)**                                   43
**    Operand NOMBRE-INPUT-VALNOM is not declared                                                                 43
  7401     IF TIP-ID-INPUT-VALNOM  = 2                                                              VALNOM        44
*  12-S**************************                                      ( 130)**                                   44
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                 44
  7402         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                              VALNOM        45
*  12-S*********************************                               ( 130)**                                   45
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   45
  7413         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM        56
*  12-S*********************************                               ( 131)**                                   56
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   56
  7424         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        67
*  12-S*********************************                               ( 131)**                                   67
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   67
  7428         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        71
*  12-S*********************************                               ( 131)**                                   71
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   71
  7432         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM                                        VALNOM        75
*  12-S******************************                                  ( 131)**                                   75
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                   75
  7434        INSPECT CADENA-VALNOM    REPLACING ALL                                                VALNOM        77
*  12-S****************************                                    ( 131)**                                   77
**    Operand CADENA-VALNOM is not declared                                                                       77
  7440        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002                     VALNOM        83
*  12-S****************************                                    ( 131)**                                   83
**    Operand CADENA-VALNOM is not declared                                                                       83
  7446                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM        89
*  12-S***************************************                         ( 131)**                                   89
**    Operand I-VALNOM is not declared                                                                            89
  7448                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM        91
*  12-S***********************************                             ( 132)**                                   91
**    Operand VNOM-AUX-VALNOM is not declared                                                                     91
  7450                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM        93
*  12-S***********************************************                 ( 132)**                                   93
**    Operand VNOM-AUX-VALNOM is not declared                                                                     93
  7451                  END-IF                                                                      VALNOM        94
* 564-S***********************                                         ( 132)**                                   95
**    A scope-delimiter did not have a matching verb and was discarded.                                           95
  7452                END-PERFORM                                                                   VALNOM        95
* 564-S**************************                                      ( 132)**                                   96
**    A scope-delimiter did not have a matching verb and was discarded.                                           96
  7453     END-IF.                                                                                  VALNOM        96
* 564-S**********                                                      ( 132)**                                   96
**    A scope-delimiter did not have a matching verb and was discarded.                                           96
  7454     MOVE SPACES TO VECTOR-INPUT-VALNOM.                                                      VALNOM        97
*  12-S**************************************                          ( 132)**                                   97
**    Operand VECTOR-INPUT-VALNOM is not declared                                                                 97
  7455     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM        98
*  12-S**************************                                      ( 132)**                                   98
**    Operand CADENA-VALNOM is not declared                                                                       98
  7468     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM       111
*  12-S****************************                                    ( 132)**                                  111
**    Operand NOMBOK-INPUT-VALNOM is not declared                                                                111
  7469     IF TIP-ID-INPUT-VALNOM  NOT = 2                                                          VALNOM       112
*  12-S**************************                                      ( 132)**                                  112
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                112
  7470        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                               VALNOM       113
*  12-S********************************                                ( 132)**                                  113
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  113
  7474                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM       117
*  12-S***************************************                         ( 132)**                                  117
**    Operand I-VALNOM is not declared                                                                           117
  7476                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM       119
*  12-S***********************************                             ( 132)**                                  119
**    Operand VNOM-AUX-VALNOM is not declared                                                                    119
  7478                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM       121
*  12-S***********************************************                 ( 132)**                                  121
**    Operand VNOM-AUX-VALNOM is not declared                                                                    121
  7479                  END-IF                                                                      VALNOM       122
* 564-S***********************                                         ( 133)**                                  123
**    A scope-delimiter did not have a matching verb and was discarded.                                          123
  7480                END-PERFORM                                                                   VALNOM       123
* 564-S**************************                                      ( 133)**                                  124
**    A scope-delimiter did not have a matching verb and was discarded.                                          124
  7482         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       125
*  12-S*********************************                               ( 133)**                                  125
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  125
  7493         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       136
*  12-S*********************************                               ( 133)**                                  136
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  136
  7504        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003                     VALNOM       147
*  12-S********************************                                ( 133)**                                  147
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  147
  7508         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM                                        VALNOM       151
*  12-S******************************                                  ( 133)**                                  151
**    Operand NOMBRE-AUX-VALNOM is not declared                                                                  151
  7509     END-IF.                                                                                  VALNOM       152
* 564-S**********                                                      ( 133)**                                  152
**    A scope-delimiter did not have a matching verb and was discarded.                                          152
  7510     MOVE SPACES TO VECTOR-OK-VALNOM.                                                         VALNOM       153
*  12-S***********************************                             ( 133)**                                  153
**    Operand VECTOR-OK-VALNOM is not declared                                                                   153
  7511     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM       154
*  12-S**************************                                      ( 133)**                                  154
**    Operand CADENA-VALNOM is not declared                                                                      154
  7522     MOVE 1 TO I-VALNOM.                                                                      VALNOM       165
*  12-S**********************                                          ( 133)**                                  165
**    Operand I-VALNOM is not declared                                                                           165
  7523     MOVE 0 TO BLOQOK-AUX-VALNOM.                                                             VALNOM       166
*  12-S*******************************                                 ( 134)**                                  166
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  166
  7524     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES                                         VALNOM       167
*  12-S*********************************                               ( 134)**                                  167
**    Operand VM-INPUT-VALNOM is not declared                                                                    167
  7525       MOVE 1 TO J-VALNOM                                                                     VALNOM       168
*  12-S************************                                        ( 134)**                                  169
**    Operand J-VALNOM is not declared                                                                           169
  7526       PERFORM UNTIL J-VALNOM > 20                                                            VALNOM       169
*  12-S****************************                                    ( 134)**                                  169
**    Operand J-VALNOM is not declared                                                                           169
  7527         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)                                VALNOM       170
*  12-S**************************                                      ( 134)**                                  170
**    Operand VM-INPUT-VALNOM is not declared                                                                    170
  7528            ADD 1 TO BLOQOK-AUX-VALNOM                                                        VALNOM       171
*  12-S*************************************                           ( 134)**                                  172
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  172
  7529            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                             VALNOM       172
*  12-S**************************************                          ( 134)**                                  172
**    Operand VM-OK-VALNOM is not declared                                                                       172
  7531            MOVE 21 TO J-VALNOM                                                               VALNOM       174
*  12-S******************************                                  ( 134)**                                  176
**    Operand J-VALNOM is not declared                                                                           176
  7533            MOVE 0 TO M-VALNOM                                                                VALNOM       176
*  12-S*****************************                                   ( 134)**                                  177
**    Operand M-VALNOM is not declared                                                                           177
  7534            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                                  VALNOM       177
*  12-S*******************************                                 ( 134)**                                  177
**    Operand VM-OK-VALNOM is not declared                                                                       177
  7536            IF M-VALNOM >= 15                                                                 VALNOM       179
*  12-S**********************                                          ( 134)**                                  179
**    Operand M-VALNOM is not declared                                                                           179
  7537               MOVE 0 TO M-VALNOM                                                             VALNOM       180
*  12-S********************************                                ( 134)**                                  181
**    Operand M-VALNOM is not declared                                                                           181
  7538               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                               VALNOM       181
*  12-S**********************************                              ( 134)**                                  181
**    Operand VM-OK-VALNOM is not declared                                                                       181
  7540            END-IF                                                                            VALNOM       183
* 564-S*****************                                               ( 134)**                                  184
**    A scope-delimiter did not have a matching verb and was discarded.                                          184
  7541            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20                                        VALNOM       184
*  12-S**********************                                          ( 134)**                                  184
**    Operand M-VALNOM is not declared                                                                           184
  7543               COMPUTE INI-VALNOM = M-VALNOM + 2                                              VALNOM       186
*  12-S********************************                                ( 134)**                                  186
**    Operand INI-VALNOM is not declared                                                                         186
  7544               COMPUTE LON-VALNOM = 14 - M-VALNOM                                             VALNOM       187
*  12-S********************************                                ( 135)**                                  187
**    Operand LON-VALNOM is not declared                                                                         187
  7545               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM                                   VALNOM       188
*  12-S*******************************                                 ( 135)**                                  188
**    Operand VM-OK-VALNOM is not declared                                                                       188
  7546               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =                                      VALNOM       189
*  12-S******************************                                  ( 135)**                                  189
**    Operand PEDAZO-VALNOM is not declared                                                                      189
  7550                  ADD 1 TO BLOQOK-AUX-VALNOM                                                  VALNOM       193
*  12-S*******************************************                     ( 135)**                                  194
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  194
  7551                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                       VALNOM       194
*  12-S********************************************                    ( 135)**                                  194
**    Operand VM-OK-VALNOM is not declared                                                                       194
  7553                  MOVE 21 TO J-VALNOM                                                         VALNOM       196
*  12-S************************************                            ( 135)**                                  197
**    Operand J-VALNOM is not declared                                                                           197
  7554                  ADD 1 TO I-VALNOM                                                           VALNOM       197
*  12-S**********************************                              ( 135)**                                  198
**    Operand I-VALNOM is not declared                                                                           198
  7555                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)                                    VALNOM       198
*  12-S***********************************************                 ( 135)**                                  198
**    Operand VM-INPUT-VALNOM is not declared                                                                    198
  7556               END-IF                                                                         VALNOM       199
* 564-S********************                                            ( 135)**                                  200
**    A scope-delimiter did not have a matching verb and was discarded.                                          200
  7557            END-IF                                                                            VALNOM       200
* 564-S*****************                                               ( 135)**                                  201
**    A scope-delimiter did not have a matching verb and was discarded.                                          201
  7558         END-IF                                                                               VALNOM       201
* 564-S**************                                                  ( 135)**                                  202
**    A scope-delimiter did not have a matching verb and was discarded.                                          202
  7559         ADD 1 TO J-VALNOM                                                                    VALNOM       202
*  12-S*************************                                       ( 135)**                                  204
**    Operand J-VALNOM is not declared                                                                           204
  7560       END-PERFORM                                                                            VALNOM       203
* 564-S*****************                                               ( 135)**                                  204
**    A scope-delimiter did not have a matching verb and was discarded.                                          204
  7561       ADD 1 TO I-VALNOM                                                                      VALNOM       204
*  12-S***********************                                         ( 135)**                                  205
**    Operand I-VALNOM is not declared                                                                           205
  7562       IF I-VALNOM = 21                                                                       VALNOM       205
*  12-S*****************                                               ( 135)**                                  205
**    Operand I-VALNOM is not declared                                                                           205
  7564       END-IF                                                                                 VALNOM       207
* 564-S************                                                    ( 135)**                                  208
**    A scope-delimiter did not have a matching verb and was discarded.                                          208
  7565     END-PERFORM.                                                                             VALNOM       208
* 564-S***************                                                 ( 135)**                                  208
**    A scope-delimiter did not have a matching verb and was discarded.                                          208
  7566     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                             VALNOM       209
*  12-S************************                                        ( 136)**                                  209
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  209
  7567        MOVE 1 TO MATCH-OK-OUT-VALNOM                                                         VALNOM       210
*  12-S************************************                            ( 136)**                                  212
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                212
  7569        IF TIP-ID-INPUT-VALNOM <> 2                                                           VALNOM       212
*  12-S*****************************                                   ( 136)**                                  212
**    Operand TIP-ID-INPUT-VALNOM is not declared                                                                212
  7571        ELSE                                                                                  VALNOM       214
* 562-S***********                                                     ( 136)**                                  215
**    An "ELSE" phrase did not have a matching IF and was discarded.                                             215
  7573        END-IF                                                                                VALNOM       216
* 564-S*************                                                   ( 136)**                                  217
**    A scope-delimiter did not have a matching verb and was discarded.                                          217
  7574        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                          VALNOM       217
*  12-S***************************                                     ( 136)**                                  217
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  217
  7575           MOVE 1 TO MATCH-OK-OUT-VALNOM                                                      VALNOM       218
*  12-S***************************************                         ( 136)**                                  220
**    Operand MATCH-OK-OUT-VALNOM is not declared                                                                220
  7576        END-IF                                                                                VALNOM       219
* 564-S*************                                                   ( 136)**                                  220
**    A scope-delimiter did not have a matching verb and was discarded.                                          220
  7577     END-IF.                                                                                  VALNOM       220
* 564-S**********                                                      ( 136)**                                  220
**    A scope-delimiter did not have a matching verb and was discarded.                                          220
  7585     IF BLOQOK-AUX-VALNOM > 0                                                                 VALNOM       228
*  12-S************************                                        ( 136)**                                  228
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  228
  7586        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       229
*  12-S**********************************                              ( 136)**                                  230
**    Operand APROX-TOT-VALNOM is not declared                                                                   230
  7588        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       231
*  12-S**********************************                              ( 136)**                                  232
**    Operand APROX-TOT-VALNOM is not declared                                                                   232
  7589     END-IF                                                                                   VALNOM       232
* 564-S**********                                                      ( 136)**                                  233
**    A scope-delimiter did not have a matching verb and was discarded.                                          233
  7590     MOVE 1 TO I-VALNOM.                                                                      VALNOM       233
*  12-S**********************                                          ( 136)**                                  233
**    Operand I-VALNOM is not declared                                                                           233
  7591     PERFORM UNTIL I-VALNOM > 10                                                              VALNOM       234
*  12-S**************************                                      ( 136)**                                  234
**    Operand I-VALNOM is not declared                                                                           234
  7592       MOVE 1 TO J-VALNOM                                                                     VALNOM       235
*  12-S************************                                        ( 136)**                                  236
**    Operand J-VALNOM is not declared                                                                           236
  7593       PERFORM UNTIL J-VALNOM > 10                                                            VALNOM       236
*  12-S****************************                                    ( 137)**                                  236
**    Operand J-VALNOM is not declared                                                                           236
  7594         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM                                         VALNOM       237
*  12-S**********************************                              ( 137)**                                  238
**    Operand LETRAS-OK-VALNOM is not declared                                                                   238
  7595         MOVE 1 TO K-VALNOM                                                                   VALNOM       238
*  12-S**************************                                      ( 137)**                                  239
**    Operand K-VALNOM is not declared                                                                           239
  7596         MOVE 1 TO L-VALNOM                                                                   VALNOM       239
*  12-S**************************                                      ( 137)**                                  240
**    Operand L-VALNOM is not declared                                                                           240
  7597         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND                                        VALNOM       240
*  12-S**************************                                      ( 137)**                                  240
**    Operand VM-INPUT-VALNOM is not declared                                                                    240
  7599            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       242
*  12-S*********************************                               ( 137)**                                  242
**    Operand K-VALNOM is not declared                                                                           242
  7600              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       243
*  12-S********************************                                ( 137)**                                  243
**    Operand VMM-INPUT-VALNOM is not declared                                                                   243
  7605                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES                             VALNOM       248
*  12-S********************************                                ( 137)**                                  248
**    Operand VMM-OK-VALNOM is not declared                                                                      248
  7606                    ADD 1 TO LETRAS-OK-VALNOM                                                 VALNOM       249
*  12-S********************************************                    ( 137)**                                  250
**    Operand LETRAS-OK-VALNOM is not declared                                                                   250
  7607                    ADD 1 TO K-VALNOM                                                         VALNOM       250
*  12-S************************************                            ( 137)**                                  251
**    Operand K-VALNOM is not declared                                                                           251
  7608                    ADD 1 TO L-VALNOM                                                         VALNOM       251
*  12-S************************************                            ( 137)**                                  253
**    Operand L-VALNOM is not declared                                                                           253
  7610                    MOVE 19 TO K-VALNOM                                                       VALNOM       253
*  12-S**************************************                          ( 137)**                                  255
**    Operand K-VALNOM is not declared                                                                           255
  7611                 END-IF                                                                       VALNOM       254
* 564-S**********************                                          ( 137)**                                  255
**    A scope-delimiter did not have a matching verb and was discarded.                                          255
  7613                 ADD 1   TO K-VALNOM                                                          VALNOM       256
*  12-S***********************************                             ( 137)**                                  257
**    Operand K-VALNOM is not declared                                                                           257
  7614                 IF K-VALNOM <= 15 AND L-VALNOM < 15                                          VALNOM       257
*  12-S***************************                                     ( 137)**                                  257
**    Operand K-VALNOM is not declared                                                                           257
  7615                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =                              VALNOM       258
*  12-S**************************************                          ( 137)**                                  258
**    Operand VMM-INPUT-VALNOM is not declared                                                                   258
  7617                       ADD 1 TO L-VALNOM                                                      VALNOM       260
*  12-S***************************************                         ( 137)**                                  262
**    Operand L-VALNOM is not declared                                                                           262
  7618                    END-IF                                                                    VALNOM       261
* 564-S*************************                                       ( 138)**                                  262
**    A scope-delimiter did not have a matching verb and was discarded.                                          262
  7619                 END-IF                                                                       VALNOM       262
* 564-S**********************                                          ( 138)**                                  263
**    A scope-delimiter did not have a matching verb and was discarded.                                          263
  7620              END-IF                                                                          VALNOM       263
* 564-S*******************                                             ( 138)**                                  264
**    A scope-delimiter did not have a matching verb and was discarded.                                          264
  7621            END-PERFORM                                                                       VALNOM       264
* 564-S**********************                                          ( 138)**                                  265
**    A scope-delimiter did not have a matching verb and was discarded.                                          265
  7622            MOVE 1 TO K-VALNOM                                                                VALNOM       265
*  12-S*****************************                                   ( 138)**                                  266
**    Operand K-VALNOM is not declared                                                                           266
  7623            MOVE 1 TO L-VALNOM                                                                VALNOM       266
*  12-S*****************************                                   ( 138)**                                  267
**    Operand L-VALNOM is not declared                                                                           267
  7624            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       267
*  12-S*********************************                               ( 138)**                                  267
**    Operand K-VALNOM is not declared                                                                           267
  7625              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       268
*  12-S********************************                                ( 138)**                                  268
**    Operand VMM-INPUT-VALNOM is not declared                                                                   268
  7630                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES                            VALNOM       273
*  12-S********************************                                ( 138)**                                  273
**    Operand VMM-OK-VALNOM is not declared                                                                      273
  7631                    ADD 1 TO LETRAS-OK2-VALNOM                                                VALNOM       274
*  12-S*********************************************                   ( 138)**                                  275
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  275
  7632                    ADD 1 TO K-VALNOM                                                         VALNOM       275
*  12-S************************************                            ( 138)**                                  276
**    Operand K-VALNOM is not declared                                                                           276
  7633                    ADD 1 TO L-VALNOM                                                         VALNOM       276
*  12-S************************************                            ( 138)**                                  278
**    Operand L-VALNOM is not declared                                                                           278
  7635                    MOVE 19 TO K-VALNOM                                                       VALNOM       278
*  12-S**************************************                          ( 138)**                                  280
**    Operand K-VALNOM is not declared                                                                           280
  7636                 END-IF                                                                       VALNOM       279
* 564-S**********************                                          ( 138)**                                  280
**    A scope-delimiter did not have a matching verb and was discarded.                                          280
  7638                 ADD 1   TO L-VALNOM                                                          VALNOM       281
*  12-S***********************************                             ( 138)**                                  282
**    Operand L-VALNOM is not declared                                                                           282
  7639                 IF L-VALNOM <= 15 AND K-VALNOM < 15                                          VALNOM       282
*  12-S***************************                                     ( 138)**                                  282
**    Operand L-VALNOM is not declared                                                                           282
  7640                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                  VALNOM       283
*  12-S**************************************                          ( 138)**                                  283
**    Operand VMM-INPUT-VALNOM is not declared                                                                   283
  7642                       ADD 1 TO K-VALNOM                                                      VALNOM       285
*  12-S***************************************                         ( 139)**                                  287
**    Operand K-VALNOM is not declared                                                                           287
  7643                    END-IF                                                                    VALNOM       286
* 564-S*************************                                       ( 139)**                                  287
**    A scope-delimiter did not have a matching verb and was discarded.                                          287
  7644                 END-IF                                                                       VALNOM       287
* 564-S**********************                                          ( 139)**                                  288
**    A scope-delimiter did not have a matching verb and was discarded.                                          288
  7645              END-IF                                                                          VALNOM       288
* 564-S*******************                                             ( 139)**                                  289
**    A scope-delimiter did not have a matching verb and was discarded.                                          289
  7646            END-PERFORM                                                                       VALNOM       289
* 564-S**********************                                          ( 139)**                                  290
**    A scope-delimiter did not have a matching verb and was discarded.                                          290
  7647         END-IF                                                                               VALNOM       290
* 564-S**************                                                  ( 139)**                                  291
**    A scope-delimiter did not have a matching verb and was discarded.                                          291
  7648         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM                                              VALNOM       291
*  12-S****************************                                    ( 139)**                                  291
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  291
  7649            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM                                        VALNOM       292
*  12-S*********************************                               ( 139)**                                  292
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  292
  7650         END-IF                                                                               VALNOM       293
* 564-S**************                                                  ( 139)**                                  294
**    A scope-delimiter did not have a matching verb and was discarded.                                          294
  7651         IF LETRAS-OK-VALNOM > 0                                                              VALNOM       294
*  12-S***************************                                     ( 139)**                                  294
**    Operand LETRAS-OK-VALNOM is not declared                                                                   294
  7652            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM                                      VALNOM       295
*  12-S**************************************                          ( 139)**                                  296
**    Operand TOTLET-INP-VALNOM is not declared                                                                  296
  7653            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING                                        VALNOM       296
*  12-S**********************************                              ( 139)**                                  296
**    Operand VM-INPUT-VALNOM is not declared                                                                    296
  7656            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING                                        VALNOM       299
*  12-S*******************************                                 ( 139)**                                  299
**    Operand VM-OK-VALNOM is not declared                                                                       299
  7659            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM                                          VALNOM       302
*  12-S***********************************                             ( 139)**                                  303
**    Operand POR-TOT-VALNOM is not declared                                                                     303
  7660            IF TOTLET-OK-VALNOM >= 3                                                          VALNOM       303
*  12-S******************************                                  ( 139)**                                  303
**    Operand TOTLET-OK-VALNOM is not declared                                                                   303
  7661               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       304
*  12-S************************************                            ( 139)**                                  304
**    Operand POR-TOT-VALNOM is not declared                                                                     304
  7663            END-IF                                                                            VALNOM       306
* 564-S*****************                                               ( 139)**                                  307
**    A scope-delimiter did not have a matching verb and was discarded.                                          307
  7664            IF TOTLET-INP-VALNOM >= 3                                                         VALNOM       307
*  12-S*******************************                                 ( 140)**                                  307
**    Operand TOTLET-INP-VALNOM is not declared                                                                  307
  7665               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       308
*  12-S************************************                            ( 140)**                                  308
**    Operand POR-INP-VALNOM is not declared                                                                     308
  7667            END-IF                                                                            VALNOM       310
* 564-S*****************                                               ( 140)**                                  311
**    A scope-delimiter did not have a matching verb and was discarded.                                          311
  7668            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM                                           VALNOM       311
*  12-S******************************                                  ( 140)**                                  311
**    Operand TOTLET-OK-VALNOM is not declared                                                                   311
  7669               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /                                   VALNOM       312
*  12-S******************************                                  ( 140)**                                  312
**    Operand A-VALNOM is not declared                                                                           312
  7672               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /                                   VALNOM       315
*  12-S******************************                                  ( 140)**                                  315
**    Operand A-VALNOM is not declared                                                                           315
  7674            END-IF                                                                            VALNOM       317
* 564-S*****************                                               ( 140)**                                  318
**    A scope-delimiter did not have a matching verb and was discarded.                                          318
  7675            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=                                        VALNOM       318
*  12-S******************************                                  ( 140)**                                  318
**    Operand POR-TOT-VALNOM is not declared                                                                     318
  7685               ADD 1 TO BLOQOK-AUX-VALNOM                                                     VALNOM       328
*  12-S****************************************                        ( 140)**                                  329
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  329
  7686               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                          VALNOM       329
*  12-S*****************************************                       ( 140)**                                  329
**    Operand VM-OK-VALNOM is not declared                                                                       329
  7688            END-IF                                                                            VALNOM       331
* 564-S*****************                                               ( 140)**                                  332
**    A scope-delimiter did not have a matching verb and was discarded.                                          332
  7689         END-IF                                                                               VALNOM       332
* 564-S**************                                                  ( 140)**                                  333
**    A scope-delimiter did not have a matching verb and was discarded.                                          333
  7690         ADD 1 TO J-VALNOM                                                                    VALNOM       333
*  12-S*************************                                       ( 140)**                                  335
**    Operand J-VALNOM is not declared                                                                           335
  7691       END-PERFORM                                                                            VALNOM       334
* 564-S*****************                                               ( 140)**                                  335
**    A scope-delimiter did not have a matching verb and was discarded.                                          335
  7692       ADD 1 TO I-VALNOM                                                                      VALNOM       335
*  12-S***********************                                         ( 140)**                                  336
**    Operand I-VALNOM is not declared                                                                           336
  7693     END-PERFORM.                                                                             VALNOM       336
* 564-S***************                                                 ( 141)**                                  336
**    A scope-delimiter did not have a matching verb and was discarded.                                          336
  7701   MOVE ZEROS TO TOTLET-INP-VALNOM                                                            VALNOM       344
*  12-S*********************************                               ( 141)**                                  345
**    Operand TOTLET-INP-VALNOM is not declared                                                                  345
  7702   MOVE ZEROS TO LETRAS-OK2-VALNOM                                                            VALNOM       345
*  12-S*********************************                               ( 141)**                                  346
**    Operand LETRAS-OK2-VALNOM is not declared                                                                  346
  7703    MOVE ZEROS TO A-VALNOM                                        GJC0003                     VALNOM       346
*  12-S*************************                                       ( 141)**                                  347
**    Operand A-VALNOM is not declared                                                                           347
  7704   MOVE 1 TO K-VALNOM                                                                         VALNOM       347
*  12-S********************                                            ( 141)**                                  348
**    Operand K-VALNOM is not declared                                                                           348
  7705   PERFORM UNTIL K-VALNOM > 65                                                                VALNOM       348
*  12-S************************                                        ( 141)**                                  348
**    Operand K-VALNOM is not declared                                                                           348
  7706     MOVE K-VALNOM  TO I-VALNOM                                                               VALNOM       349
*  12-S*****************                                               ( 141)**                                  349
**    Operand K-VALNOM is not declared                                                                           349
  7707     MOVE 1       TO J-VALNOM                                                                 VALNOM       350
*  12-S****************************                                    ( 141)**                                  351
**    Operand J-VALNOM is not declared                                                                           351
  7708     MOVE ZEROS TO LETRAS-OK-VALNOM                                                           VALNOM       351
*  12-S**********************************                              ( 141)**                                  352
**    Operand LETRAS-OK-VALNOM is not declared                                                                   352
  7709     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65                                             VALNOM       352
*  12-S**************************                                      ( 141)**                                  352
**    Operand J-VALNOM is not declared                                                                           352
  7710        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                            VALNOM       353
*  12-S*************************                                       ( 141)**                                  353
**    Operand V-NOMBRE-VALNOM is not declared                                                                    353
  7712           IF V-NOMBRE-VALNOM(I-VALNOM) =                                                     VALNOM       355
*  12-S****************************                                    ( 141)**                                  355
**    Operand V-NOMBRE-VALNOM is not declared                                                                    355
  7714              ADD 1 TO LETRAS-OK-VALNOM                                                       VALNOM       357
*  12-S**************************************                          ( 141)**                                  358
**    Operand LETRAS-OK-VALNOM is not declared                                                                   358
  7715              ADD 1 TO I-VALNOM                                                               VALNOM       358
*  12-S******************************                                  ( 141)**                                  359
**    Operand I-VALNOM is not declared                                                                           359
  7716              ADD 1 TO J-VALNOM                                                               VALNOM       359
*  12-S******************************                                  ( 141)**                                  361
**    Operand J-VALNOM is not declared                                                                           361
  7718              ADD 1 TO J-VALNOM                                                               VALNOM       361
*  12-S******************************                                  ( 141)**                                  363
**    Operand J-VALNOM is not declared                                                                           363
  7719           END-IF                                                                             VALNOM       362
* 564-S****************                                                ( 142)**                                  363
**    A scope-delimiter did not have a matching verb and was discarded.                                          363
  7721           ADD 1 TO I-VALNOM                                                                  VALNOM       364
*  12-S***************************                                     ( 142)**                                  366
**    Operand I-VALNOM is not declared                                                                           366
  7722        END-IF                                                                                VALNOM       365
* 564-S*************                                                   ( 142)**                                  366
**    A scope-delimiter did not have a matching verb and was discarded.                                          366
  7723     END-PERFORM                                                                              VALNOM       366
* 564-S***************                                                 ( 142)**                                  367
**    A scope-delimiter did not have a matching verb and was discarded.                                          367
  7724     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM                                                  VALNOM       367
*  12-S***********************                                         ( 142)**                                  367
**    Operand LETRAS-OK-VALNOM is not declared                                                                   367
  7725        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM                                            VALNOM       368
*  12-S****************************                                    ( 142)**                                  368
**    Operand LETRAS-OK-VALNOM is not declared                                                                   368
  7726     END-IF                                                                                   VALNOM       369
* 564-S**********                                                      ( 142)**                                  370
**    A scope-delimiter did not have a matching verb and was discarded.                                          370
  7727     ADD 1 TO K-VALNOM                                                                        VALNOM       370
*  12-S*********************                                           ( 142)**                                  371
**    Operand K-VALNOM is not declared                                                                           371
  7728   END-PERFORM.                                                                               VALNOM       371
* 564-S*************                                                   ( 142)**                                  371
**    A scope-delimiter did not have a matching verb and was discarded.                                          371
  7729   MOVE 1 TO I-VALNOM                                                                         VALNOM       372
*  12-S********************                                            ( 142)**                                  373
**    Operand I-VALNOM is not declared                                                                           373
  7730   PERFORM UNTIL I-VALNOM > 65                                                                VALNOM       373
*  12-S************************                                        ( 142)**                                  373
**    Operand I-VALNOM is not declared                                                                           373
  7731     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                               VALNOM       374
*  12-S**********************                                          ( 142)**                                  374
**    Operand V-NOMBRE-VALNOM is not declared                                                                    374
  7733        ADD 1 TO TOTLET-INP-VALNOM                                                            VALNOM       376
*  12-S*********************************                               ( 142)**                                  378
**    Operand TOTLET-INP-VALNOM is not declared                                                                  378
  7734     END-IF                                                                                   VALNOM       377
* 564-S**********                                                      ( 142)**                                  378
**    A scope-delimiter did not have a matching verb and was discarded.                                          378
  7735     ADD 1 TO I-VALNOM                                                                        VALNOM       378
*  12-S*********************                                           ( 142)**                                  379
**    Operand I-VALNOM is not declared                                                                           379
  7736   END-PERFORM.                                                                               VALNOM       379
* 564-S*************                                                   ( 142)**                                  379
**    A scope-delimiter did not have a matching verb and was discarded.                                          379
  7737   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /                                               VALNOM       380
*  12-S******************                                              ( 142)**                                  380
**    Operand A-VALNOM is not declared                                                                           380
  7739   IF A-VALNOM >= 75                                                                          VALNOM       382
*  12-S*************                                                   ( 142)**                                  382
**    Operand A-VALNOM is not declared                                                                           382
  7740       ADD 1 TO BLOQOK-AUX-VALNOM                                                             VALNOM       383
*  12-S********************************                                ( 143)**                                  384
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  384
  7741   END-IF.                                                                                    VALNOM       384
* 564-S********                                                        ( 143)**                                  384
**    A scope-delimiter did not have a matching verb and was discarded.                                          384
  7742    MOVE 0 TO K-VALNOM                                            GJC0003                     VALNOM       385
*  12-S*********************                                           ( 143)**                                  386
**    Operand K-VALNOM is not declared                                                                           386
  7743   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003                     VALNOM       386
*  12-S**********************                                          ( 143)**                                  386
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  386
  7744      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003                     VALNOM       387
*  12-S************************                                        ( 143)**                                  387
**    Operand A-VALNOM is not declared                                                                           387
  7745      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003                     VALNOM       388
*  12-S*****************************                                   ( 143)**                                  388
**    Operand J-VALNOM is not declared                                                                           388
  7746               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       389
*  12-S********************************                                ( 143)**                                  389
**    Operand V-NOMBRE-VALNOM is not declared                                                                    389
  7747                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003                     VALNOM       390
*  12-S*************************************************               ( 143)**                                  390
**    Operand V-NOMBRE-VALNOM is not declared                                                                    390
  7749                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003                     VALNOM       392
*  12-S**********************************************                  ( 143)**                                  392
**    Operand CONT-LET-INPUT-VALNOM is not declared                                                              392
  7750              END-IF                                              GJC0003                     VALNOM       393
* 564-S*******************                                             ( 143)**                                  394
**    A scope-delimiter did not have a matching verb and was discarded.                                          394
  7751               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       394
*  12-S********************************                                ( 143)**                                  394
**    Operand V-NOMBOK-VALNOM is not declared                                                                    394
  7752                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003                     VALNOM       395
*  12-S*************************************************               ( 143)**                                  395
**    Operand V-NOMBOK-VALNOM is not declared                                                                    395
  7754                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003                     VALNOM       397
*  12-S*******************************************                     ( 143)**                                  397
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 397
  7755              END-IF                                              GJC0003                     VALNOM       398
* 564-S*******************                                             ( 143)**                                  399
**    A scope-delimiter did not have a matching verb and was discarded.                                          399
  7756      END-PERFORM                                                 GJC0003                     VALNOM       399
* 564-S****************                                                ( 143)**                                  400
**    A scope-delimiter did not have a matching verb and was discarded.                                          400
  7757      MOVE 0 TO I-VALNOM                                          GJC0003                     VALNOM       400
*  12-S***********************                                         ( 143)**                                  401
**    Operand I-VALNOM is not declared                                                                           401
  7758       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003                     VALNOM       401
*  12-S******************************                                  ( 143)**                                  401
**    Operand J-VALNOM is not declared                                                                           401
  7759         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003                     VALNOM       402
*  12-S*****************************                                   ( 143)**                                  402
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 402
  7760            ADD 1 TO I-VALNOM                                     GJC0003                     VALNOM       403
*  12-S****************************                                    ( 143)**                                  404
**    Operand I-VALNOM is not declared                                                                           404
  7761            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003                     VALNOM       404
*  12-S********************************                                ( 144)**                                  404
**    Operand CONT-LET-OK-VALNOM is not declared                                                                 404
  7763               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003                     VALNOM       406
*  12-S******************************                                  ( 144)**                                  406
**    Operand L-VALNOM is not declared                                                                           406
  7765               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003                     VALNOM       408
*  12-S******************************                                  ( 144)**                                  408
**    Operand L-VALNOM is not declared                                                                           408
  7768            END-IF                                                GJC0003                     VALNOM       411
* 564-S*****************                                               ( 144)**                                  412
**    A scope-delimiter did not have a matching verb and was discarded.                                          412
  7769         END-IF                                                   GJC0003                     VALNOM       412
* 564-S**************                                                  ( 144)**                                  413
**    A scope-delimiter did not have a matching verb and was discarded.                                          413
  7770      END-PERFORM                                                 GJC0003                     VALNOM       413
* 564-S****************                                                ( 144)**                                  414
**    A scope-delimiter did not have a matching verb and was discarded.                                          414
  7771      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003                     VALNOM       414
*  12-S*********************                                           ( 144)**                                  414
**    Operand K-VALNOM is not declared                                                                           414
  7772       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003                     VALNOM       415
*  12-S******************                                              ( 144)**                                  415
**    Operand A-VALNOM is not declared                                                                           415
  7775         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003                     VALNOM       418
*  12-S**********************************                              ( 144)**                                  420
**    Operand BLOQOK-AUX-VALNOM is not declared                                                                  420
  7776       END-IF                                                     GJC0003                     VALNOM       419
* 564-S************                                                    ( 144)**                                  420
**    A scope-delimiter did not have a matching verb and was discarded.                                          420
  7777   END-IF.                                                        GJC0003                     VALNOM       420
* 564-S********                                                        ( 144)**                                  420
**    A scope-delimiter did not have a matching verb and was discarded.                                          420
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cat CARGAJUR.CBL.err
"/tmp/sh8468.2" 1 line, 21 characters cat CARGAJUR.CBL.err
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"/tmp/sh8468.2" 1 line, 21 charactersc"/tmp/sh8468.2" 0 lines, 0 characters /d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>kkcat CARGAJUR.CBL.errclear                    /vi CARvi CARGAJUR.CBL.err                   vi CARGAJUR.CBL
"CARGAJUR.CBL" 1598 lines, 66868 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"CARGAJUR.CBL" 1598 lines, 66868 characters/valnom*    retorna SW-TID-BDIIVIDE=0 si el num id no est dentro*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO?Address search hit TOP without matching pattern$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/bdiiale/



/


/bdiiale.ws01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************
copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************
copy BDIIALE.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************
copy ICFILE.WS.*****************************************************************
* Variables validacion cuentas si validar
*****************************************************************copy BDAMATCH.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.
05 D-vigentespic 9(5).

OPEN MODE      ******************************************************************
OPEN MODE      * Datos para las rutinas de validacin de nombres
OPEN MODE      ******************************************************************
OPEN MODE       copy VALNOM.WS.
OPEN MODE
OPEN MODE                  INSERT MODE  
        $CHANGE MODE           *
  $CHANGE MODE                    copy VALNOM.WS.              

 INSERT MODE    




     /   $CHANGE MODE    /end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07ADD 1 TO W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.$    /$    /$    /Address search hit BOTTOM without matching pattern$    /Address search hit BOTTOM without matching pattern$    /Address search hit BOTTOM without matching patternwhen 01   /   $CHANGE MODE    /$    /$    /Address search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern

    aadddd  11  ttoo:w"CARGAJUR.CBL" 1604 lines, 67116 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi CARGAJUR.CBLcat CARGAJUR.CBL.errclear               des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     0
* Data:     1424560     Code:       76669
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1423784  Code:    100900  Literals:      2688  Dynamic:   2342912

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURvi CARGAJUR.CBL cat CARGAJUR.CBL.errclear               des-c-v CARGAJURfu              . visetvi CARGAJUR.CBL.errdes-c-v CARGAJUR   vi CARGAJUR.CBL fg             vi CARGAJUR.CBL.errdes-c-v CARGAJUR   des-c-v ./CARGAJURfu                rm  /d/iccol/desarrollo/temporales/CARGAJUR.lst/d/iccol/desarrollo/fuentes>                                               /d/iccol/desarrollo/fuentes>/x CARx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000004
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000001
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000004
 
    35.7 % de registros correctos
   100.0 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      28 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

real    0m0.05s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/06/12 18:29:26
Fin de Programa:     2014/06/12 18:29:26

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>CARGAJUR 9999991000905140104.txt 2  /d/iccol/desarrollo/fuentes> 9999991000905140104.txt 2        /d/iccol/desarrollo/fuentes>c 9999991000905140104.txt 2a 9999991000905140104.txt 2t 9999991000905140104.txt 2t 9999991000905140104.txt  
cat: cannot open 9999991000905140104.txt
/d/iccol/desarrollo/fuentes>^[k  /d/iccol/desarrollo/fuentes>cat 9999991000905140104.txtcat $9999991000905140104.txtT9999991000905140104.txtE9999991000905140104.txtM9999991000905140104.txtP9999991000905140104.txtO9999991000905140104.txtR9999991000905140104.txtA9999991000905140104.txtL9999991000905140104.txtE9999991000905140104.txtS9999991000905140104.txt/9999991000905140104.txt
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
I100002859753ERNESTO RICO                                 0050672013040602206720100435
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
I200830067928C I GLOMA S A                                0110432044040601203220100406
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
I200860024151COMPUTEC SA                                  0330332011140604500120110402
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
I300600003115xxxxxx                                       0150542014010600400320120406
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
I400000163598xxxxxx                                       0330432013101002204520120406
T 00000000028                                             772774        787861 /d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.


   

   

   

   


    
    
/tipo-id-invalido?01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validacin de nombres
******************************************************************copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system/*    05=tipo id no es 1|2|3|4*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validacin de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin est en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cdula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS/* Close todos los archivos* $$$$ se agregaron varios archivos msclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error?*    05=tipo id no es 1|2|3|4*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validacin de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin est en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cdula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/valida.*semanti05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************
PROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4220-VALIDA-NOMBRE-NO-COINCIDE
*    4222-VALIDA-NOMBRE-COINCIDE
*    4240-CONTAR-TIPO-CUENTA
*    4210-VALIDACION-ID-NO-FIGURA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4800-PROCESO-REG-T
*    4900-GRABAR-ERROR
*    1000-RUTINA-INICIAL
*    1000-NOT-USED
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA
*    9800-FILTRAR-ALFABETICO0000-PROGRAMA-PRINCIPAL.
******************************************************************/*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-erroresend-if*    si es el registro "T" hay que sealar el fin de procesoif JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosmove 0 to codigo-errorperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errorend-if
*    Numero de identificacion*    05=tipo id no es 1|2|3|4*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validacin de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin est en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cdula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS/id-bdiividemove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
**************************************************************
* Valida si la identificacin est en la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no est dentro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM?* el nombre****************************************************************
*    parmetros para las rutinas de validacin en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validacinmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3move 1 to SW-DIGCHEQUEO-BDIIVIDEend-if
move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el nmero de identificacin contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id invlidocall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
******************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide
******************************************************************
*    nombre no coincideif TIP-IDE-BDIIVIDE = 1
*es una cdula?/tip-id-bdiivideAddress search hit BOTTOM without matching pattern/tip-id-bdiivideAddress search hit BOTTOM without matching pattern* el nombre****************************************************************
*    parmetros para las rutinas de validacin en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validacinmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3move 1 to SW-DIGCHEQUEO-BDIIVIDEend-if
move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el nmero de identificacin contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id invlidocall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
******************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide
******************************************************************
*    nombre no coincideif TIP-IDE-BDIIVIDE = 1
*es una cdula*    05=tipo id no es 1|2|3|4*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validacin de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin est en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cdula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGIS$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/codigo-errorcopy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la bsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"".01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06)./4000-PROCESAR-REGISTRO-2.****************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg
****************************************************************move "NO" to E-hay-error*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-erroresend-if*    si es el registro "T" hay que sealar el fin de procesoif JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosmove 0 to codigo-errorperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************/* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}
if JURAD-id-tipo not = "1" and "2" and "3" and "4"
call "PONERR" using "02" JURAD-reg E-errores
move 05 to codigo-error
end-if

*    Numero de identificacion


if JURAD-id-numeroX is not numeric



call "PONERR" using "03" JURAD-reg E-errores




end-ifif JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if/*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
******************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide
******************************************************************
*    nombre no coincideif TIP-IDE-BDIIVIDE = 1
*es una cdula
move 02 to CODIGO-ERRORelse*no es una cdula
move 01 to CODIGO-ERRORend-if.4222-VALIDA-NOMBRE-COINCIDE.
******************************************************************
* Validacin de IDs que figuran OK pero el nombre coincide
******************************************************************
*    nombre coincide: busca ID en BDIIALEinitialize LLAVE-BDIIALEmove TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALEmove NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALEmove 990003 to FUENTE-BDIIALEstart BDIIALE key not < LLAVE-BDIIALE INVALID KEYmove 1 TO SW-BDIIALEnot invalid key
move 0 to SW-BDIIALEread BDIIALE next recordat end
move 1 to SW-BDIIALEend-read
end-start///end-readend-start

perform until SW-BDIIALE = 1or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALEor NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALEor FUENTE-BDIIALE > 990003if FUENTE-BDIIALE = 990003and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDDand FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDDand BLOQUEO-BDIIALE = 0
*encontrado
move 1 to SW-BDIIALEend-if
if SW-BDIIALE = 0
read BDIIALE next record at endmove 1 to SW-BDIIALEend-read
end-if
end-perform.if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORelse
if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSend-if
end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07//*    cuenta tipo 7: 03 04 05
******************************************************************
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validacin de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin est en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cdula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISelse
*no es una cdula
MOVE 03 TO CODIGO-ERRORADD   1 TO  NO-EXISTE-DIANEND-IF
END-IF./ADD 1 TO TIPO-ID-INVALIDOAddress search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern
    


   

   

   

   


    
    
evaluate CODIGO-ERROR
when 01
ADD 1 TO NO-COINCIDE-DIAN
when 02    evaluate CODIGO-ERROR    when 01
    ADD 1 TO NO-COINCIDE-DIAN    when 02
REPLACE 1 CHAR5
aadddd  11  ttoo  nnoo--cc$CHANGE MODETIPO-ID-INVALIDO$CHANGE MODEend-evaluate/03.*codigo-error

END-IF


END-IF.








4300-MODIFICAR-BDIIALE.******************************************************************* Se impacta el archivo BDIIALE con una o dos inserciones,* modificaciones o eliminaciones segun haya o no demandas y/en beddiiregidiiregi7000-RUTINA-FINAL.******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos msclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit/no-coincide-regis/Address search hit BOTTOM without matching pattern/NO-COINCIDE-DIAN/Address search hit BOTTOM without matching pattern?

4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6evaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluateELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7evaluate CODIGO-ERRORwhen 05
add 1 to TIPO-ID-INVALIDOend-evaluate
ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
ADD 1 TO REG-CORRECTOSEND-IF
END-IF.

   

   

   

   

IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07
add 1 to W-CONT-TIPO-6
    

    
    

   
4210-VALIDACION-ID-NO-FIGURA.
******************************************************************

 



 
when 05
add 1 to TIPO-ID-INVALIDOwhen 05
add 1 to TIPO-ID-INVALIDOevaluate CODIGO-ERRORwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate12 lines <<ed

    

 



       4210-VALIDACION-ID-NO-FIGURA.
OPEN MODEwhen 00
OPEN MODE   add 1 to REG-CORRECTOS/reg-correctos?01  CADENA-SALEPIC X(60).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"".01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS./end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF/
7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos msclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores/IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC. REPLACE 1 CHAR*$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/01  CADENA-SALEPIC X(60).01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"".01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS./end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF/
7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos msclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores/IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC./Address search hit BOTTOM without matching pattern?
7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos msclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores?end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF/
7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos
* $$$$ se agregaron varios archivos msclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores/IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC.rrRmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
**************************************************************
* Valida si la identificacin est en la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no est dentro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH




513-VALIDA-EN-CSV.**************************************************************
* Valida si la identificacin est en la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDE
*    retorna SW-TID-BDIIVIDE=0 si el num id no est dentro
*    del rango que corresponde al tipo de iddisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDdisplay "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE" SW-NOMBRES:" SW-NOMBRES-BDIIVIDE" SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDEIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************/si-existe-csv/Address search hit BOTTOM without matching pattern?"T" "U" "V" "W" "X" "Y" "Z"
"".01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validacin de nombres
******************************************************************copy VALNOM.WS.?Address search hit TOP without matching pattern/MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC./Address search hit BOTTOM without matching pattern:w"CARGAJUR.CBL" 1606 lines, 67045 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgcat $TEMPORALES/9999991000905140104.txt/d/iccol/desarrollo/fuentes>cat 9999991000905140104.txt            /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                    /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     2
* Unrecoverable :     0                    Severe  :     2
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1423828     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              cat $TEMPORALES/9999991000905140104.txt/d/iccol/desarrollo/fuentes>cat 9999991000905140104.txt            /d/iccol/desarrollo/fuentes>cat $TEMPORALES/9999991000905140104.txt/d/iccol/desarrollo/fuentes>cat 9999991000905140104.txt            /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000004
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000001
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000004
 
    35.7 % de registros correctos
   100.0 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      28 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

real    0m0.04s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/06/12 18:56:17
Fin de Programa:     2014/06/12 18:56:17

/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC.COPY BDAMATCH.PROC./% de registrosAddress search hit BOTTOM without matching pattern?display " "* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"/e-cont-regs-con$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"./display " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-edit//WORKING-STORAGE SECTION.******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.
******************************************************************LINKAGE SECTION.
******************************************************************
* Codigo del error detectado
01  cod-errorpic xx.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).
******************************************************************
* Tabla de errores de consistencia del input
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx.
*    errores del registro actual03 E-errores-regpic x(300).
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if?compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0/WORKING-STORAGE SECTION.******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.
******************************************************************LINKAGE SECTION.
******************************************************************
* Codigo del error detectado
01  cod-errorpic xx.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).
******************************************************************
* Tabla de errores de consistencia del input
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx.
*    errores del registro actual03 E-errores-regpic x(300).
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if//Address search hit BOTTOM without matching pattern??compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0??05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"./display " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-edit//WORKING-STORAGE SECTION.******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.
******************************************************************LINKAGE SECTION.
******************************************************************
* Codigo del error detectado
01  cod-errorpic xx.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).
******************************************************************
* Tabla de errores de consistencia del input
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx.
*    errores del registro actual03 E-errores-regpic x(300).
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if//Address search hit BOTTOM without matching pattern??compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0??05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"./display " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-edit//WORKING-STORAGE SECTION.******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.
******************************************************************LINKAGE SECTION.
******************************************************************
* Codigo del error detectado
01  cod-errorpic xx.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).
******************************************************************
* Tabla de errores de consistencia del input
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx.
*    errores del registro actual03 E-errores-regpic x(300).
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if/??compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0??05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"./display " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-edit//WORKING-STORAGE SECTION.******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.
******************************************************************LINKAGE SECTION.
******************************************************************
* Codigo del error detectado
01  cod-errorpic xx.
******************************************************************
* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).
******************************************************************
* Tabla de errores de consistencia del input
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx.
*    errores del registro actual03 E-errores-regpic x(300).
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if/??compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0??05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(59) value"Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(59) value"Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(59) value"Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(59) value"Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(59) value"Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"./display " "
display "Totales de registros:"display " "
* Totales tipo PESVNODISPLAY "Registros Tipo 5   ==> " W-CONT-TIPO-5DISPLAY "Registros Tipo 6   ==> " W-CONT-TIPO-6DISPLAY "Registros Tipo 7   ==> " W-CONT-TIPO-7display " "
DISPLAY "REGISTROS LEIDOS:" REG-LEIDOSDISPLAY "REGISTROS CORRECTOS:" REG-CORRECTOSDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-edit      REPLACE 1 CHAR*
*
*

*
*





display N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"
9 lines deletedmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".
REPLACE 1 CHAR*
*
** Emision del reporte de erroresdisplay " "display "Totales por tipo de error detectado:"/TIPO-ID-INVALIDOAddress search hit BOTTOM without matching pattern??*    cuenta tipo 5: sin error*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ADD 1 TO TIPO-ID-INVALIDOELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************
* Validacin de IDs que no figuran en las bases normales
******************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin est en la base de datos alternaPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1
*es una cdula
MOVE 04 TO CODIGO-ERRORADD  1  TO NO-EXISTE-REGISelse*no es una cdula??01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validacin de nombres
******************************************************************copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system:w"CARGAJUR.CBL" 1596 lines, 66597 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                    /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     2
* Unrecoverable :     0                    Severe  :     2
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1423828     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>cat CARGAJUR.CBL.err
* Rejected - OPT
  3639 *               ADD 1 TO REG-CORRECTOS                                                                   1474
*  14-S*******************                                             (   0)**                                 1474
**    Invalid operand                                                                                           1474
  3643     END-IF.                                                                                              1478
* 564-S**********                                                      (  64)**                                 1478
**    A scope-delimiter did not have a matching verb and was discarded.                                         1478
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validacin de nombres
******************************************************************copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system/add 1 to reg-correctosend-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF./IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC.REPLACE 1 CHAR**REPLACE 1 CHAR :w"CARGAJUR.CBL" 1596 lines, 66597 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgcat CARGAJUR.CBL.errdes-c-v CARGAJUR    
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     0
* Data:     1424560     Code:       76525
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1423784  Code:    100596  Literals:      2624  Dynamic:   2342912

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              cat CARGAJUR.CBL.errdes-c-v CARGAJUR    fg              x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000004
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000001
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
      10 Registros procesados sin error
      10 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

real    0m0.04s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/06/12 19:09:16
Fin de Programa:     2014/06/12 19:09:17

/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
IF HACER-MATCH = ZEROS
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la
*identificacion buscada. En caso de hallar
*registros se procede a realizar el matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
*ADD 1 TO REG-CORRECTOS
ADD 1 TO SI-EXISTE-CSVEND-IF
END-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
******************************************************************copy BDIIVIDE.PROC.copy BDLDIR.PROC.add 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSend-if
end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJ/

   

   

   $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FS.copy ICBDIR.FS.copy BDLCLI.FS.COPY ICBSUS.FS.COPY ICBCHK.FS.COPY ICBCRE.FS.COPY BDLSTDCIU.FS.COPY DIREST.FS.COPY BDLNEWDIRBOG.FS.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD
******************************************************************
FD JURAD.
01  JURAD-reg.
* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.
*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX
pic 9(11).
*    Nombres y Apellidos03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.
01  JURADT-reg.
* Registro de totales de control T
*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
* $$$$ El formato a continuacin no est confirmado, no se usa
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-embargos-fecha-ultimo pic x(8).*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la bsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.01  W-DERECHOSPIC 9 value 0.01  CODIGO-ERRORpic 99 value 00.01  SW-BDIIALEpic 9 value 0.
01  HACER-MATCHPIC 9 value 0.
01  CADENA-ENTRAPIC X(60).
01  CADENA-SALEPIC X(60).
01  IND-ALFABETICOPIC  X(01).88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"
"G" "H" "I" "J" "K" "L" "M"
"N" "/" "O" "P" "Q" "R" "S"
"T" "U" "V" "W" "X" "Y" "Z"
"".01  DATOS-E.
03 TIPOID-Epic 9.03 NUMID-Epic 9(11).03 NOMBRE-Epic x(45).01  W-CONTADORES.03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  ESTADO21-BDIIREGIPIC 9(07) VALUE ZEROS.
01  ESTADO12-BDIIREGIPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************copy BDIIVIDE.WS.******************************************************************copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validacin de nombres
******************************************************************copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************
copy ICFILE.WS.*****************************************************************
* Variables validacion cuentas si validar
*****************************************************************copy BDAMATCH.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.
05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).
******************************************************************
* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.
01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aos
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad
*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7) value zero.03 N-demandas-terminadas     pic 9(7) value zero.03 N-embargos-vigentespic 9(7) value zero.03 N-embargos-terminados     pic 9(7) value zero.******************************************************************
* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
05 LA-valorpic x(50)
occurs 10 indexed LAv.
*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numXredefines LA-num
pic x(12).03 LA-descartepic x(50).******************************************************************
* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.
*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".
*    errores del registro actual03 E-errores-regpic x(300) value spaces.
*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 "./ponerr.*02
*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errorend-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidosif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-erroresend-if
*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-erroresend-if
*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errores

    

*    Tipo de identificacion Numero {1, 2, 3, 4}*    $CHANGE MODE    Ceste rroerror se procesa ...add 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************
INSERT MODE" to E-hay-error''
perform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-error
*este error se procesa ...end-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidosif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-erroresend-if
*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-erroresend-if
*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-erroresend-if
OPEN MODE          Tipo de identificacion Numero {1, 2, 3, 4} APPEND MODEmove "SI" to E-hay-errorREPLACE MODENO:w"CARGAJUR.CBL" 1598 lines, 66669 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                    /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     0
* Data:     1424560     Code:       76537
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1423784  Code:    100612  Literals:      2624  Dynamic:   2342912

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000005
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000002
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
      10 Registros procesados sin error
      10 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       5 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

real    0m0.04s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/06/12 19:13:25
Fin de Programa:     2014/06/12 19:13:25

/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
perform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-error
*este error se procesa ...move "NO" to E-hay-errorend-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidosif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-erroresend-if
*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-erroresend-if
*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errores

    



end-if
*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-erroresend-if
move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VAL
7 lines deletedmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-erroresend-if
*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-erroresend-if
*    Numero de embargos terminadosif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-erroresend-if
*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-erroresend-if
move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-erroresend-if.4200-VALIDACION-SEMANTICA.
****************************************************************
* Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************
*    parmetros para las rutinas de validacin en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validacinmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3move 1 to SW-DIGCHEQUEO-BDIIVIDEend-if
move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el nmero de identificacin contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 14200-VALIDACION-SEMANTICA.****************************************************************
* Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************
*    parmetros para las rutinas de validacin en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validacinmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3move 1 to SW-DIGCHEQUEO-BDIIVIDEend-if
move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el nmero de identificacin contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id invlidocall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
******************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide
******************************************************************



exit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-error
*este error se procesa ...move "NO" to E-hay-errorend-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidosif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-erroresend-if
*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errores
7 more linesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-erroresend-if
*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-erroresend-if
*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-erroresend-if
move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-erroresend-if
*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-erroresend-if
*    Numero de embargos terminadosif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-erroresend-if
*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-erroresend-if
move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-erroresend-if.4200-VALIDACION-SEMANTICA.
****************************************************************
* Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************
*    parmetros para las rutinas de validacin en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validacinmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE***************************************************************** Validacion del numero de identificacion y de su relacion con
* el nombre
****************************************************************
*    parmetros para las rutinas de validacin en BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDE
*    algunas rutinas de COPYs usan estos datosmove JURAD-id-tipo to TIPOID-Emove JURAD-id-numero to NUMID-Emove JURAD-nombre to NOMBRE-E
*    switches de opciones de validacinmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEif TIP-IDE-BDIIVIDE = 2 or 3move 1 to SW-DIGCHEQUEO-BDIIVIDEend-if
move 2 to NUM-BLOQUES-BDIIVIDE
*    Valida el nmero de identificacin contra las bases de
*    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia
*    del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACION
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1
*es un id invlidocall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alternaperform 4210-VALIDACION-ID-NO-FIGURAelse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alternaperform 4220-VALIDA-NOMBRE-NO-COINCIDEelse
perform 4222-VALIDA-NOMBRE-COINCIDEend-if
end-if.4220-VALIDA-NOMBRE-NO-COINCIDE.
******************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide
******************************************************************
*    nombre no coincide4200-VALIDACION-SEMANTICA.end-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidosif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-erroresend-if
*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-erroresend-if
*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-erroresend-if
*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-erroresend-if
move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-erroresend-if
*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-erroresend-if
*    Numero de embargos terminadosif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-erroresend-if
*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-erroresend-if
move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-erroresend-if.4200-VALIDACION-SEMANTICA.
****************************************************************if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosmove 0 to codigo-errorperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERROR
*******perform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4240-CONTAR-TIPO-CUENTAexit paragraphend-if

perform 4240-CONTAR-TIPO-CUENTA*    intento de actualizacin de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-error
*este error se procesa ...move "NO" to E-hay-errorend-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0
OPEN MODE $CHANGE MODE   4240-CONTAR-TIPO-CUENTAINSERT MODEperform 
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errores/4240-CONTAR-TIPO-CUENTA*encontrado
move 1 to SW-BDIIALEend-if
if SW-BDIIALE = 0
read BDIIALE next record at endmove 1 to SW-BDIIALEend-read
end-if
end-perform.if TIP-IDE-BDIIVIDE = 1if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1move 07 to CODIGO-ERRORelse
if ESTADO-VIG-BDIIREGI = 21
move 06 to CODIGO-ERROR
add 1 to NO-COINCIDE-REGISadd 1 to CONT-FALLECIDOSend-if
end-if
end-if.4240-CONTAR-TIPO-CUENTA.
******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDO4240-CONTAR-TIPO-CUENTA.******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************:w"CARGAJUR.CBL" 1597 lines, 66635 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                    /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     0
* Data:     1424560     Code:       76529
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1423784  Code:    100596  Literals:      2624  Dynamic:   2342912

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000005
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000001
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000001
 
    35.7 % de registros correctos
      10 Registros procesados sin error
      10 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

real    0m0.03s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/06/12 19:20:31
Fin de Programa:     2014/06/12 19:20:32

/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
4240-CONTAR-TIPO-CUENTA.******************************************************************
*    Conteo de los registros por "tipo", dependiendo del cdigo
*    de error:
*    00=OK
*    01=NIT OK, nombre no coincide
*    02=cdula OK, nombre no coincide
*    03=NIT no figura
*    04=cdula no figura pero est en base alterna
*    05=tipo id no es 1|2|3|4
*    06=cdula ... ESTADO-VIG-BDIIREGI = 21
*    07=cdula ... ESTADO-VIG-BDIIREGI = 12
*
*    cuenta tipo 5: sin error
*    cuenta tipo 6: 01 02 06 07
*    cuenta tipo 7: 03 04 05
******************************************************************evaluate CODIGO-ERRORwhen 00
add 1 to REG-CORRECTOSwhen 01
ADD 1 TO NO-COINCIDE-DIANwhen 02
ADD 1 TO NO-COINCIDE-REGISwhen 05
add 1 to TIPO-ID-INVALIDOwhen 06
ADD 1 TO ESTADO21-BDIIREGIwhen 07
ADD 1 TO ESTADO12-BDIIREGIend-evaluate
IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07add 1 to W-CONT-TIPO-6ELSE
IF CODIGO-ERROR = 03 OR 04 OR 05ADD 1 TO W-CONT-TIPO-7ELSE
*es 00: registros correctosADD 1 TO W-CONT-TIPO-5
*si es una empresa
IF TIPOID-E = 2 OR 3
ADD 1 TO W-CONT-TIPO-5-PJEND-IF
END-IF
END-IF.4210-VALIDACION-ID-NO-FIGURA.
******************************************************************/registros con errorDISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes
*    compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
*    / N-reg-leidos
*    display N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")
*    move N-reg-leidos to N-edit
*    display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"*    cantidad de registros con error
*    move E-cont-regs-con-error to N-reg-con-error
*    move N-reg-con-error to N-editdisplay N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"


INSERT MODE*:w"CARGAJUR.CBL" 1597 lines, 66636 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                    /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:     0
* Data:     1424560     Code:       76497
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1423784  Code:    100548  Literals:      2608  Dynamic:   2359296

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000005
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000001
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000001
 
    35.7 % de registros correctos
      10 Registros procesados sin error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

real    0m0.04s
user    0m0.01s
sys     0m0.01s

Inicio de Programa:  2014/06/12 19:21:37
Fin de Programa:     2014/06/12 19:21:38

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/fuentes>x CARGAJUR 9999991000905140104.txt 2 >| qq  $TEMPOPRA/d/iccol/desarrollo/fuentes>40104.txt 2 >| $TEMPOPRAL                        <ES/qq
ksh: /qq: cannot create
/d/iccol/desarrollo/fuentes>te
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>tex CARGAJUR 9999991000905140104.txt 2 >| $TEMPO>/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2 >|        qq

real    0m0.03s
user    0m0.01s
sys     0m0.01s
/d/iccol/desarrollo/temporales>cat qq
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100000958212LUIS GUILLERMO AVENDAO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I100001327130GONZALO PATIO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100002249789999999000J002    
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 100003295380999999000J002    
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800002194999999000J002    
 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200800178009999999000J002    
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200830067928999999000J002    
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890934264999999000J002    
 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 200890107487999999000J002    
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 300611000446999999000J002    
 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000163597999999000J002    
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:                                                                 
 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J001    
Error 19 Insercin de alerta que ya existe                          
llave: 400000136711999999000J002    
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
Registros Tipo 5   ==> 000009
Registros Tipo 6   ==> 000003
Registros Tipo 7   ==> 000005
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000009
REGISTROS NO COINCIDEN BDIIREGI :0000001
REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000002
REGISTROS NO EXISTEN   BDIIREGI :0000003
REGISTROS NO EXISTEN   BDIIDIAN :0000001
REGISTROS ID BDIIREGI ESTADO 21 :0000001
REGISTROS ID BDIIREGI ESTADO 12 :0000000
TIPO IDENTIFICACION INVALIDO    :0000001
 
    35.7 % de registros correctos
      10 Registros procesados sin error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        
      20 19-Insercin de alerta que ya existe                          

Inicio de Programa:  2014/06/12 19:22:45
Fin de Programa:     2014/06/12 19:22:45

/d/iccol/desarrollo/temporales>^[k  /d/iccol/desarrollo/temporales>cat qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>                                          /d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>^DYou have stopped jobs
/d/iccol/desarrollo/temporales>gf
ksh: gf:  not found
/d/iccol/desarrollo/temporales>fg
vi CARGAJUR.CBL
DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGISDISPLAY "REGISTROS DE FALLECIDOS:" CONT-FALLECIDOSDISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIANDISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGISDISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIANDISPLAY "REGISTROS ID BDIIREGI ESTADO 21 :" ESTADO21-BDIIREGIDISPLAY "REGISTROS ID BDIIREGI ESTADO 12 :" ESTADO12-BDIIREGIDISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDOdisplay " "
*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes
*    compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
*    / N-reg-leidos
*    display N-editp100 "% de registros inconsistentes"
*    cantidad de registros ledos (excludo el registro "T")
*    move N-reg-leidos to N-edit
*    display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin errormove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"*    cantidad de registros con error
*    move E-cont-regs-con-error to N-reg-con-error
*    move N-reg-con-error to N-edit
*    display N-edit "Registros con error"
*    cantidades de alertas afectadasif P-tipo-proceso = "04"move N-ale-borradas to N-editdisplay N-edit
"Alertas borradas previo al refresque total"end-if
move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de erroresdisplay " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00""CARGAJUR.CBL" line 1394 of 1597 --87%-- /d/iccol/desarrollo/temporales>^D
