=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.04 18:34:38 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Wed Jun  4 13:12:22 2014 from 172.16.10.88
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>ls -l CARGAJUR*
-rw-rw-r--   1 icjlud   icdatacr   56035 May 22 10:01 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   56024 May 22 14:41 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
/d/iccol/desarrollo/fuentes>sdiff -w 170 CARGAJUR.cbl CARGAJUR.CBL > qqq
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 1324 lines, 159981 characters $SET LIST SETTING$SET LIST SET
TING
   IDENTIFICATION DIVISION.IDENTIFICATI
ON DIVISION.
PROGRAM-ID.    CARGAJUR2.|PROGRAM-ID.
   CARGAJUR.
*******************************************************************************
*****************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizaci
on del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el
archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos p
ara actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo
ERRS.
 *******************************************************************************
*****************************************************
AUTHOR.Globant JL.AUTHOR.
   Globant JL.
DATE-WRITTEN.DATE-WRITTEN
.
DATE-COMPILED.DATE-COMPILE
D.
     CONFIGURATION section.CONFIGURATIO
N section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPU
TER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPU
TER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT
 section.
FILE-CONTROL.FILE-CONTROL
.*******************************************************************************
*****************************************************
*******************************************************************************
*****************************************************
select JURAD assign to P-file-pathselect JURAD
 assign to P-file-path
organization is line sequentialorganiza
tion is line sequential
file status is JURAD-fs.file sta
tus is JURAD-fs.*******************************************************************************
*****************************************************"qqq" 1324 lines, 159981 characters$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(300).03 ERRS-causa-rechazopic x(300).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************
copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
************************************************************************************************************************************
* Variables relacionadas con las alertas del sistema* Variables relacionadas con las alertas del sistema
************************************************************************************************************************************
copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validacion de nombres de VALNOM.PROC* Datos para las rutinas de validacion de nombres de VALNOM.PROC
************************************************************************************************************************************
copy VALNOM.WS.copy VALNOM.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************
copy ICFILE.WS.copy ICFILE.WS.************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic xx value "2".03 P-proceso-realpic xx value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años* Fecha de proceso + 50 años
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos
*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(5).03 N-demandas-vigentespic 9(5).03 N-demandas-terminadas     pic 9(5).03 N-demandas-terminadas     pic 9(5).03 N-embargos-vigentespic 9(5).03 N-embargos-vigentespic 9(5).03 N-embargos-terminados     pic 9(5).03 N-embargos-terminados     pic 9(5).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 "."El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.
*    0000-PROGRAMA-PRINCIPAL*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA*    7000-RUTINA-FINAL*    7000-RUTINA-FINAL*    9000-CANCELAR-PROGRAMA*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anteriorwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-errormove "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que senialar el fin de proceso*    si es el registro "T" hay que senialar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORexit paragraphexit paragraphend-ifend-if*    intento de actualizacion de BDIIALE*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-ifexit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    a ver si la validacion cambio el tipo de ide*    a ver si la validacion cambio el tipo de ideif JURAD-id-tipo not = TIP-IDE-BDIIVIDEif JURAD-id-tipo not = TIP-IDE-BDIIVIDEcall "PONERR" using "16" JURAD-reg E-errorescall "PONERR" using "16" JURAD-reg E-erroresdisplay "Tipo ide cambiado de " JURAD-id-tipo " a "display "Tipo ide cambiado de " JURAD-id-tipo " a "TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroTIP-IDE-BDIIVIDE " num ide: " JURAD-id-numerodisplay "Tipo ide cambiado de " JURAD-id-tipo " a "display "Tipo ide cambiado de " JURAD-id-tipo " a "TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroTIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroend-ifend-if
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1call "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-erroreselseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDEend-ifend-ifend-if.end-if.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg nÂ°: " N-reg-leidosJURAD-tipo-novedad " reg nÂ°: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existeend-ifend-if
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regadd 1 to N-ale-no-existeadd 1 to N-ale-no-existeend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y debería ser el ultimo del archivo* de control, y debería ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasJURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.end-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
********************************************************************************************************************************
* Hace el reemplazo de los valores adecuados en los templates* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde* de las linea de alerta que corresponde
********************************************************************************************************************************
*    segun se trate de demandas o embargos*    segun se trate de demandas o embargosif JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all space*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all space*delimited by all spacemove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
* >>>> da error en el end-if* >>>> da error en el end-if
*string LA-parte(LAx, 1) LA-valor(1)*string LA-parte(LAx, 1) LA-valor(1)
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-value*delimited by high-valueend-if.end-if.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-realP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornadisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name delimited space ".errs"|string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasdisplay "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - leídos:"display "Fin de los registros a eliminar - leídos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "compute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"display N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.copy VALNOM.PROC.copy VALNOM.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program CARGAJUR2.end program CARGAJUR2.************************************************************************************************************************************
************************************************************************************************************************************


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~










/^...........................................................................\S\S\S\S\S\S\S\S\S\SAddress search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************/     [|<>]    /
* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name delimited space ".errs"|string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentes/Address search hit BOTTOM without matching pattern?$SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.|PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************/
* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name delimited space ".errs"|string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentes:q/d/iccol/desarrollo/fuentes>rm qqq
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm qqqvi qqqsdiff -w 170 CARGAJUR.cbl CARGAJUR.CBL > qqq/d/iccol/desarrollo/fuentes>ls -l CARGAJUR*                             /d/iccol/desarrollo/fuentes>
-rw-rw-r--   1 icjlud   icdatacr   56035 May 22 10:01 CARGAJUR.cbl
-rw-rw-r--   1 icdgd    icdatacr   56024 May 22 14:41 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>ls -l CARGAJUR*rm qqq         vi qqqsdiff -w 170 CARGAJUR.cbl CARGAJUR.CBL > qqq/d/iccol/desarrollo/fuentes>sdiff -w 170 CARGAJUR.cbl CARGAJUR.CBL. > qqqo > qqql > qqqd > qqq
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 1327 lines, 156997 characters $SET LIST SETTING$SET LIST SETTINGIDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.|PROGRAM-ID.    ACTALEJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.|AUTHOR.GLOBANT JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.|CONFIGURATION SECTION.
SOURCE-COMPUTER. microfocus.|SOURCE-COMPUTER. MICROFOCUS.
OBJECT-COMPUTER. microfocus.|OBJECT-COMPUTER. MICROFOCUS.
INPUT-OUTPUT section.|INPUT-OUTPUT SECTION.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-path|SELECT JURAD ASSIGN TO P-FILE-PATHorganization is line sequential|ORGANIZATION IS LINE SEQUENTIALfile status is JURAD-fs.|FILE STATUS IS JURAD-FS.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-name|SELECT ERRS ASSIGN TO ERRS-FILE-NAMEorganization is line sequential|ORGANIZATION IS LINE SEQUENTIALfile status is ERRS-fs.|FILE STATUS IS ERRS-FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.|COPY BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.|COPY BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.|COPY BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on record|COPY BDIIALE.FS REPLACING == ON RECORD.== BY == ON RECORDfile status is EST-BDIIALE.==.|FILE STATUS IS EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.|FILE SECTION.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************"qqq" 1327 lines, 156997 characters:q/d/iccol/desarrollo/fuentes>rm qqq
/d/iccol/desarrollo/fuentes>clear
/d/iccol/desarrollo/fuentes>cat CARGAJUR.cbl
      $SET LIST SETTING 
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    CARGAJUR2.
      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.

      ******************************************************************
      ******************************************************************
       DATA DIVISION.
       FILE section.

      ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************
       FD JURAD.
       01  JURAD-reg.
      * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-tipo-novedad        pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-id-tipo             pic x.
      *    Numero de identificacion
           03 JURAD-id-numeroX          pic x(11).
           03 JURAD-id-numero           redefines JURAD-id-numeroX
                                        pic 9(11).
      *    Nombres y Apellidos
           03 JURAD-nombre              pic x(45).
      *    Numero de demandas vigentes
           03 JURAD-demandas-vigentes   pic 999.
      *    Numero de demandas terminadas
           03 JURAD-demandas-terminadas pic 999.
      *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 JURAD-embargos-vigentes   pic 999.
      *    Numero de embargos terminados
           03 JURAD-embargos-terminados pic 999.
      *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-embargos-fecha-ultimo pic x(8).

       01  JURADT-reg.
      * Registro de totales de control T
      *    Tipo de Novedad = "T"
           03 JURADT-tipo-novedad       pic x.
           03                           pic x.
      *    Cantidad de registros
           03 JURADT-registros          pic 9(11).
           03                           pic x.
      *    Total numero de demandas vigentes
           03 JURADT-demandas-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de demandas terminadas
           03 JURADT-demandas-terminadas pic 9(7).
           03                           pic x.
      *    Total numero de embargos vigentes
           03 JURADT-embargos-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de embargos terminados
           03 JURADT-embargos-terminados pic 9(7).
           03                           pic x(41).

      ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************
       FD ERRS.
       01  ERRS-reg.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-tipo-novedad         pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-id-tipo              pic x.
      *    Numero de identificacion
           03 ERRS-id-numero            pic x(11).
      *    Nombres y Apellidos
           03 ERRS-nombre               pic x(45).
      *    Numero de demandas vigentes
           03 ERRS-demandas-vigentes    pic 999.
      *    Numero de demandas terminadas
           03 ERRS-demandas-terminadas  pic 999.
      *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 ERRS-embargos-vigentes    pic 999.
      *    Numero de embargos terminados
           03 ERRS-embargos-terminados  pic 999.
      *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-embargos-fecha-ultimo pic x(8).
      *    Causa del rechazo
           03 ERRS-causa-rechazo        pic x(300).

      ******************************************************************
      * Contiene los ids y nombres de personas
      ******************************************************************
       copy BDIIREGI.FD.

      ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN
      ******************************************************************
       copy BDIIDIAN.FD.

      ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************
       copy BDIIDAS.FD.

      ******************************************************************
      * Maestro de alertas reportadas por suscriptores
      ******************************************************************
       copy BDIIALE.FD.

      ******************************************************************
       WORKING-STORAGE section.
      ******************************************************************
      * Nombre del programa
       01  pgm                          pic x(10) value "CARGAJUR".

      ******************************************************************
      * Variables para rutina de validacion de identificaciones
      ******************************************************************
       copy BDIIVIDE.WS.

      ******************************************************************
      * Variables relacionadas con las alertas del sistema
      ******************************************************************
       copy BDIIALE.WS.

      ******************************************************************
      * Datos para las rutinas de validacion de nombres de VALNOM.PROC
      ******************************************************************
       copy VALNOM.WS.

      *****************************************************************
      * Direcciones de los archivos en el file system
      *****************************************************************
       copy ICFILE.WS.

      ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)
       01  IND-fin-proceso              pic xx value "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-reg-anterior           pic x(100) value "(vacio)".
       01  JURAD-fs                     pic xx value spaces.

       01  ERRS-fs                      pic xx value spaces.

      * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-datahost.
           05 D-vigentes                pic 9(5).
           05 D-terminados              pic 9(5).
           05 D-fecha-ultima            pic x(8).
      ******************************************************************
      * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros
       01 P-command-line                pic x(80) value spaces.
       01 P-parametros.
      *    Proceso real: contiene "1" para activar, "2" por defecto
           03 P-proceso-real            pic xx value "2".
           88 PROCESO-REAL              value "1".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-file-name               pic x(80) value spaces.
           03 P-file-name-R             redefines P-file-name.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-cod-suscriptor      pic 9(6).
      *        aaa = Codificacion del producto ("100")
               05 P-producto            pic xxx.
      *        DDMMAA = Fecha de proceso
               05 P-fecha-proceso       pic x(6).
      *        bb =  01 a CI
               05 P-ci-bi               pic xx.
      *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL
               05 P-tipo-proceso        pic xx.
      *        extension del archivo ".txt"
               05 P-extension           pic x(4).
               05                       pic x(57).
           03 P-file-path               pic x(80) value spaces.
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
           03 ERRS-file-name            pic x(80) value spaces.

      * Fecha de proceso editada YYYYMMDD
       01 P-fecha-proceso-YYYYMMDD      pic x(8).
      * Fecha de proceso + 50 años
       01 P-fecha-proceso-50.
           03  P-fecha-proceso-50YYYY   pic 9999.
           03                           pic x(4).
      ******************************************************************
      * Datos para el reporte final
       01 W-tiempo.
           03 W-hora-inicio             pic 9(8).
           03 W-hora-fin                pic 9(8).
       01 N-edit                        pic z(8)B.
       01 N-editp100                    redefines N-edit
                                        pic z(5)9.9B.
       01 N-contadores.
      *    Registros en el archivo de entrada
           03 N-reg-leidos              pic 9(8) value zero.
      *    Registros procesados sin error
           03 N-reg-OK                  pic 9(8) value zero.
      *    Registros con error
           03 N-reg-con-error           pic 9(8) value zero.

      *    Cantidades de registros por tipo de novedad
           03 N-reg-tipo-I-OK           pic 9(8) value zero.
           03 N-reg-tipo-M-OK           pic 9(8) value zero.
           03 N-reg-tipo-E-OK           pic 9(8) value zero.
           03 N-reg-tipo-I-err          pic 9(8) value zero.
           03 N-reg-tipo-M-err          pic 9(8) value zero.
           03 N-reg-tipo-E-err          pic 9(8) value zero.

      *    Alertas borradas previo al refresque total
           03 N-ale-leidas              pic 9(8) value zero.
           03 N-ale-borradas            pic 9(8) value zero.
      *    Alertas insertadas
           03 N-ale-insertadas          pic 9(8) value zero.
      *    Alertas modificadas
           03 N-ale-modificadas         pic 9(8) value zero.
      *    Alertas eliminadas
           03 N-ale-eliminadas          pic 9(8) value zero.
      *    Insercion de alerta existente
           03 N-ale-ya-existe           pic 9(8) value zero.
      *    Modificacion o eliminacion de alerta inexistente
           03 N-ale-no-existe           pic 9(8) value zero.

      *    Sumas de cantidades de demandas y embargos
           03 N-demandas-vigentes       pic 9(5).
           03 N-demandas-terminadas     pic 9(5).
           03 N-embargos-vigentes       pic 9(5).
           03 N-embargos-terminados     pic 9(5).

      ******************************************************************
      * Armado de las lineas de alerta
       01 LA-lineas-alerta.
      *    Los modelos a continuacion deberan obtenerse de un 
      *    archivo, como BDIIALE-ALERTAS
           03 LAend                     pic 999 comp value 0.
           03 LA-modelos.
      *         12345678901234567890123456789012345678901234567890
               05 pic x(50) value
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
               05 pic x(50) value
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
               05 pic x(50) value
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
               05 pic x(50) value
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
               05 pic x(50) value high-values. *> end marker
           03 LA-modelos2               redefines LA-modelos.
               05 LA-modelo             pic x(50) occurs 5 
                                        indexed LAm.
      *    Funcionamiento de los templates.
      *    Hay dos templates por de alerta, uno por linea.
      *    Cada template consiste en hasta 10 frases fijas con
      *    ampersands (&) donde se van a reemplazar los valores.
      *    Por ejemplo: 
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
      *    tiene 3 frases fijas y 2 reemplazos. 
      *    La cantidad de ampersands es irrelevante, pero parece
      *    conveniente que informe sobre el tamanio del contenido.
           03 LA-templates.
               05 LA-template           occurs 4 indexed LAx.
                   07 LA-parte          pic x(50)
                                        occurs 10 indexed LAy.
      *    Las dos lineas armadas
           03 LA-lineas.
               05 LA-linea1             pic x(50).
               05 LA-linea2             pic x(50).
      *    Los valores a insertar en una linea
           03 LA-valores.
               05 LA-valor              pic x(50) 
                                        occurs 10 indexed LAv.
      *    Datos para editar valores a insertar
           03 LA-num                    pic -(11)0.
           03 LA-numX                   redefines LA-num
                                        pic x(12).
           03 LA-descarte               pic x(50).


      ******************************************************************
      * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx value "NO".
      *    errores del registro actual
           03 E-errores-reg             pic x(300) value spaces.
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8) value zero.
      *    tabla de errores
           03 pic x(11) value "01 0000000 ".
           03 pic x(59) value
           "Tipo de movimiento invalido, debe ser I M E T".
           03 pic x(11) value "02 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion invalido, debe ser 1 2 3 4".
           03 pic x(11) value "03 0000000 ".
           03 pic x(59) value
           "Numero de identificacion invalido, debe ser numerico".
           03 pic x(11) value "04 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion debe ser mayor que cero".
           03 pic x(11) value "05 0000000 ".
           03 pic x(59) value
           "Falta el nombre o denominacion".
           03 pic x(11) value "06 0000000 ".
           03 pic x(59) value
           "Numero de demandas vigentes: debe ser numerico".
           03 pic x(11) value "07 0000000 ".
           03 pic x(59) value
           "Numero de demandas terminadas: debe ser numerico".
           03 pic x(11) value "08 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "09 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "10 0000000 ".
           03 pic x(59) value
           "Numero de embargos vigentes: debe ser numerico".
           03 pic x(11) value "11 0000000 ".
           03 pic x(59) value
           "Numero de embargos terminados: debe ser numerico".
           03 pic x(11) value "12 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "13 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "14 0000000 ".
           03 pic x(59) value
           "El numero de id no se encuentra en el archivo maestro".
           03 pic x(11) value "15 0000000 ".
           03 pic x(59) value
           "El nombre en el input no coincide con el registrado".
           03 pic x(11) value "16 0000000 ".
           03 pic x(59) value
           "Numero de id fuera del rango del tipo de id informado".
      *----------------- insertar nuevos items aqui -------------------
           03 pic x(11) value "00 0000000 ".
           03 pic x(59) value "--- fin de la lista (cod 00) ---".
           03                           pic x(3500). *> los 50 items
       01 E-errores-2                   redefines E-errores.
           03                           pic xx.
           03                           pic x(300).
           03                           pic 9(8).
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).
       01 E-edit                        pic z(8)B.

      ******************************************************************
      * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 pic 9(04).
              88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 pic 9(02).
              88 MES-VAL                value 01   thru 12.
           02 DIA-VAL-X                 pic 9(02).
              88 DIA-VAL                value 01   thru 31.

      /*****************************************************************
      ******************************************************************
       PROCEDURE DIVISION.
      *    0000-PROGRAMA-PRINCIPAL
      *    4000-PROCESAR-REGISTRO
      *    4000-PROCESAR-REGISTRO-2
      *    4100-VALIDACION-FORMAL
      *    4200-VALIDACION-SEMANTICA
      *    4300-MODIFICAR-BDIIALE
      *    4300-MODIFICAR-BDIIALE-DATOS
      *    4300-MODIFICAR-BDIIALE-I
      *    4300-MODIFICAR-BDIIALE-M
      *    4300-MODIFICAR-BDIIALE-E
      *    4333-LEER-BDIIALE-RANDOM
      *    4333-GRABAR-BDIIALE
      *    4333-REGRABAR-BDIIALE
      *    4333-ELIMINAR-BDIIALE
      *    4900-GRABAR-ERROR
      *    4320-ARMAR-TEXTO-ALERTA
      *    1000-RUTINA-INICIAL
      *    1001-ELIMINAR-TODO
      *    7000-RUTINA-FINAL
      *    9000-CANCELAR-PROGRAMA


       0000-PROGRAMA-PRINCIPAL.
      ******************************************************************
      *    inicializa el ambiente y abre los archivos
           perform 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta
      *    encontrar el registro "T" de totales
           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
      *    cierra archivos y produce el reporte final
           perform 7000-RUTINA-FINAL
           goback.

       4000-PROCESAR-REGISTRO.
      ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo
      ****************************************************************
      *    lectura del proximo registro
           read JURAD
           evaluate JURAD-fs
           when "00"
      *        controla el reg y lo aplica si es OK
               perform 4000-PROCESAR-REGISTRO-2
               move JURAD-reg to JURAD-reg-anterior
           when "10"
      *        fin del archivo de input:
      *        esto es un error, no se encontro el registro "T" antes
      *        de que se terminara el archivo
               display "Falta el reg de totales del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           when other
      *        error de lectura: cancelacion del proceso
               display "Error en lectura del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4000-PROCESAR-REGISTRO-2.
      ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg
      ****************************************************************
           move "NO" to E-hay-error

      *    validacion del tipo de movimiento
           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 
               call "PONERR" using "01" JURAD-reg E-errores
           end-if

      *    si es el registro "T" hay que senialar el fin de proceso
           if JURAD-tipo-novedad = "T" 
               move "SI" to IND-fin-proceso
               perform 4800-PROCESO-REG-T
               exit paragraph
           end-if

           add 1 to N-reg-leidos

      *    validacion formal de los datos
           perform 4100-VALIDACION-FORMAL
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               exit paragraph
           end-if

      *    si la validacion formal dio OK se hace validacion semantica
           perform 4200-VALIDACION-SEMANTICA
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               exit paragraph
           end-if

      *    intento de actualizacion de BDIIALE
           perform 4300-MODIFICAR-BDIIALE
           add 1 to N-reg-OK.



       4100-VALIDACION-FORMAL.
      ******************************************************************
      * Validacion formal de los datos del input
      ******************************************************************
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           if JURAD-id-tipo not = "1" and "2" and "3" and "4"
               call "PONERR" using "02" JURAD-reg E-errores
           end-if
      *    Numero de identificacion
           if JURAD-id-numeroX is not numeric
               call "PONERR" using "03" JURAD-reg E-errores
           end-if
           if JURAD-id-numero not > 0
               call "PONERR" using "04" JURAD-reg E-errores
           end-if
      *    si el movimiento es una eliminacion los datos subsiguientes
      *    no se controlan
           if JURAD-tipo-novedad = "E"
               exit paragraph
           end-if
      *    Nombres y Apellidos
           if JURAD-nombre = spaces
               call "PONERR" using "05" JURAD-reg E-errores
           end-if
      *    Numero de demandas vigentes
           if JURAD-demandas-vigentes is not numeric
               call "PONERR" using "06" JURAD-reg E-errores
           end-if
      *    Numero de demandas terminadas
           if JURAD-demandas-terminadas is not numeric
               call "PONERR" using "07" JURAD-reg E-errores
           end-if
      *    Fecha ultima demanda vigente YYMMDD
           if JURAD-demandas-fecha-ultima is not numeric
               call "PONERR" using "08" JURAD-reg E-errores
           end-if
           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "09" JURAD-reg E-errores
           end-if
      *    Numero de embargos vigentes
           if JURAD-embargos-vigentes not numeric
               call "PONERR" using "10" JURAD-reg E-errores
           end-if
      *    Numero de embargos terminados
           if JURAD-embargos-terminados not numeric
               call "PONERR" using "11" JURAD-reg E-errores
           end-if
      *    Fecha ultimo embargo vigente YYMMDD
           if JURAD-embargos-fecha-ultimo is not numeric
               call "PONERR" using "12" JURAD-reg E-errores
           end-if
           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "13" JURAD-reg E-errores
           end-if.


       4200-VALIDACION-SEMANTICA.
      ****************************************************************
      * Validacion del numero de identificacion y de su relacion con
      * el nombre
      ****************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIVIDE
           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
           move JURAD-nombre to NOMBRE-BDIIVIDE
           move 1 to SW-VERIFNOM-BDIIVIDE
           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
           perform 80100-VALIDAR-IDENTIFICACION
      *    a ver si la validacion cambio el tipo de ide
           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE
               call "PONERR" using "16" JURAD-reg E-errores
               display "Tipo ide cambiado de " JURAD-id-tipo " a " 
               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero
           end-if
      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
           if SW-ID-BDIIVIDE = 1
               call "PONERR" using "14" JURAD-reg E-errores
           else
      *        existe id, a ver si el nombre coincide
               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
                   call "PONERR" using "15" JURAD-reg E-errores
                   display "novedad:  " JURAD-nombre
                   display "registro: " NOM-LEIDO-BDIIVIDE
               end-if
           end-if.


       4300-MODIFICAR-BDIIALE.
      ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones, 
      * modificaciones o eliminaciones segun haya o no demandas y 
      * embargos
      ******************************************************************
           initialize REG-BDIIALE

      *    si hay demandas
           if JURAD-demandas-vigentes > zero
           or JURAD-demandas-terminadas > zero 
               move "J001" to LLASEC-BDIIALE
      *        arma datos de demandas
               move JURAD-demandas-vigentes to D-vigentes
               move JURAD-demandas-terminadas to D-terminados
               string "20" JURAD-demandas-fecha-ultima 
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS 
           end-if.

      *    si hay embargos
           if JURAD-embargos-vigentes > zero
           or JURAD-embargos-terminados > zero 
               move "J002" to LLASEC-BDIIALE
      *        arma datos de embargos
               move JURAD-embargos-vigentes to D-vigentes
               move JURAD-embargos-terminados to D-terminados
               string "20" JURAD-embargos-fecha-ultimo
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS 
           end-if.



       4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************
      * Parte de la carga de datos en el registro BDIIALE y grabacion
      * del mismo que es comun a demandas y embargos
      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
      ******************************************************************
      *    completa la clave e intenta leer la alerta, si se leyo OK
      *    el file status de BDIIALE queda con "00"
           perform 4333-LEER-BDIIALE-RANDOM

      *    procesa segun el tipo de novedad I M E
           evaluate JURAD-tipo-novedad
           when "I"
               add 1 to N-reg-tipo-I-OK
               perform 4300-MODIFICAR-BDIIALE-I
           when "M"
               add 1 to N-reg-tipo-M-OK
               perform 4300-MODIFICAR-BDIIALE-M
           when "E"
               add 1 to N-reg-tipo-E-OK
               perform 4300-MODIFICAR-BDIIALE-E
           when other
      *        esto es "imposible" por control de consistencia anterior
               display "error de logica: tipo-novedad="
               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos
               display "Registro de JURAD: " display JURAD-reg
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4300-MODIFICAR-BDIIALE-I.
      ******************************************************************
      * Insercion de una alerta nueva
      * Si ya existia muestra un mensaje y continua
      ******************************************************************
      *    si el registro existia es un error
           if EST-BDIIALE = "00"
               display "Insercion de alerta nueva que ya existe "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               add 1 to N-ale-ya-existe
           end-if

      *    completa los datos del registro
           initialize ENCABEZADO-BDIIALE
           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
           FEC-REP-BDIIALE 
           move P-fecha-proceso-50 to FEC-VEN-BDIIALE
           move 0 to BLOQUEO-BDIIALE
           move D-datahost to INF-DATAHOST-BDIIALE
           perform 4320-ARMAR-TEXTO-ALERTA
           if EST-BDIIALE = "00"
               perform 4333-REGRABAR-BDIIALE
           else
               perform 4333-GRABAR-BDIIALE
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4300-MODIFICAR-BDIIALE-M.
      ******************************************************************
      * Modificacion de una alerta existente
      * Si no existia muestra un mensaje y continua
      ******************************************************************
      *    si el registro no existia es un error
           if EST-BDIIALE not = "00"
               display "Modificacion de alerta inexistente "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               add 1 to N-ale-no-existe
           end-if
      *    reemplaza la fecha de reporte y los valores
           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 
           move D-datahost to INF-DATAHOST-BDIIALE
           perform 4320-ARMAR-TEXTO-ALERTA
           if EST-BDIIALE = "00"
               perform 4333-REGRABAR-BDIIALE
           else
               perform 4333-GRABAR-BDIIALE
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4300-MODIFICAR-BDIIALE-E.
      ******************************************************************
      * Eliminacion de una alerta
      * Si no existia muestra un mensaje y continua
      ******************************************************************
      *    elimina el registro
           if EST-BDIIALE = "00"
               perform 4333-ELIMINAR-BDIIALE
           else
               display "Eliminacion de alerta inexistente "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               add 1 to N-ale-no-existe
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-LEER-BDIIALE-RANDOM.
      ******************************************************************
      * Arma clave exacta y lee un registro de BDIIALE
      * Usa los datos del reg input, excepto LLASEC que esta precargado
      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
      ******************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIALE
           move JURAD-id-numero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move 000 to COD-ALERTA-BDIIALE
      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

           read BDIIALE
           evaluate EST-BDIIALE
           when "00"
               continue
           when "23"
               continue
           when other
               display "Error al leer BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Ultimo registro procesado: "
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.
      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-GRABAR-BDIIALE.
      ******************************************************************
      * Inserta un registro nuevo en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           write REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-insertadas
           when other
               display "Error al grabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-REGRABAR-BDIIALE.
      ******************************************************************
      * Regraba un registro modificado en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           rewrite REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-modificadas
           when other
               display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-ELIMINAR-BDIIALE.
      ******************************************************************
      * Elimina un registro de BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           delete BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-eliminadas
           when other
               display "Error al deletear BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

       4800-PROCESO-REG-T.
      ******************************************************************
      * El registro leido en el archivo JURAD es tipo "T" con totales
      * de control, y debería ser el ultimo del archivo
      ******************************************************************
      * Control de los totales calculados contra los esperados
           move "NO" to E-hay-error
      *    cantidad de registros I M E
           if function numval(JURADT-registros) = N-reg-leidos
               continue
           else
               display " "
               display "No coincide la cantidad de registros:"
               JURADT-registros " con los leidos:" N-reg-leidos
               move "SI" to E-hay-error
           end-if

      *    Sumas de cantidades de demandas y embargos
           if function numval(JURADT-demandas-terminadas)
           = N-demandas-terminadas
               continue
           else
               display " "
               display "No coincide total de demandas terminadas:"
               JURADT-demandas-terminadas " con el calculado:"
               N-demandas-terminadas
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-vigentes)
           = N-embargos-vigentes
               continue
           else
               display " "
               display "No coincide total de embargos vigentes:"
               JURADT-embargos-vigentes " con el calculado:"
               N-embargos-vigentes
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-terminados)
           = N-embargos-terminados
               continue
           else
               display " "
               display "No coincide total de embargos terminados:"
               JURADT-embargos-terminados " con el calculado:"
               N-embargos-terminados
               move "SI" to E-hay-error
           end-if.

      *    si hubo cualquier cosa se invalida el proceso
           if E-hay-error = "SI"
               display "Error en registro T de totales de control"
               display "Nombre del archivo: " ERRS-file-name
               perform 9000-CANCELAR-PROGRAMA
           end-if.


       4900-GRABAR-ERROR.
      ******************************************************************
      * El registro de JURAD tiene error: se graba en el archivo ERRS
      * con indicacion del error detectado
      ******************************************************************
           move JURAD-reg to ERRS-reg
           move E-errores-reg to ERRS-causa-rechazo
      *    lista de los codigos de los errores del registro
           move E-errores-reg to ERRS-causa-rechazo
           write ERRS-reg
           evaluate ERRS-fs
               when "00"
                   continue
               when other
                   display "Error al grabar el archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA
                   goback
           end-evaluate.
 

       4320-ARMAR-TEXTO-ALERTA.
      ****************************************************************
      * Hace el reemplazo de los valores adecuados en los templates
      * de las linea de alerta que corresponde
      ****************************************************************
      *    segun se trate de demandas o embargos
           if JURAD-demandas-vigentes not = 0 
           or JURAD-demandas-terminadas not = 0
               set LAx to 1
               move high-values to LA-valores
               move JURAD-demandas-vigentes to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(1)
      *        delimited by all space
               move LA-numx(9:12) to LA-valor(1)
               move JURAD-demandas-terminadas to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(2)
      *        delimited by all space
               move LA-numx(9:12) to LA-valor(2)

      * >>>> esto esta anulado x que no se como hacer para que lo compile
      * >>>> da error en el end-if
      *        string LA-parte(LAx, 1) LA-valor(1)
      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
      *        LA-parte(LAx, 10) LA-valor(10)
      *        delimited by high-value
           end-if.


       1000-RUTINA-INICIAL.
      ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:
      *   - obtencion de los parametros
      *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo
      ******************************************************************
      * Registra hora de inicio
           accept W-hora-inicio from time

      * Obtiene informacion sobre la corrida de la linea de comando: el
      * nombre del archivo de entrada (que contiene el tipo de proceso),
      * el indicador de proceso real o en falso (default)
           accept P-command-line from COMMAND-LINE
           display "Parametros: " P-command-line
           unstring P-command-line delimited by all " " into
           P-file-name P-proceso-real

      * El programa se anuncia en la consola
      * TODO: se usa un anuncio mas vistoso?
           if PROCESO-REAL
               display pgm " Carga de archivo JURAD - proceso REAL"
           else
               display pgm " Carga de archivo JURAD - proceso en falso"
           end-if

      * El indicador de proceso real debe ser 1 o 2
           if P-proceso-real not = "1" and "2"
               display "El indicador de proceso real es invalido"
               display "debe ser 1 o 2"
               perform 9000-CANCELAR-PROGRAMA
           end-if

      * TODO: controlar los componentes del filename
           evaluate P-tipo-proceso
           when "01"
               display "01 Envio Original - Carga TOTAL 1a vez"
           when "02"
               display "02 Archivo Semanal - Carga PARCIAL"
           when "03"
               display "03 Archivo Mensual - Carga PARCIAL"
           when "04"
               display "04 Refresque Total - Carga TOTAL"
           when other
      *        valor invalido
               display "El tipo de proceso " P-tipo-proceso
               " es invalido (debe ser 01 02 03 o 04)"
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

      * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD 
           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
           P-fecha-proceso(1:2) delimited size 
           into P-fecha-proceso-YYYYMMDD
           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

      * Calcula una fecha 50 anios posterior a la de proceso
           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
           add 50 to P-fecha-proceso-50YYYY

      * Apertura del archivo de entrada
           string "$TEMPORALES/" P-file-name into P-file-path
           open input JURAD
           evaluate JURAD-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo JURAD "
                   display "Path del archivo: " P-file-path
                   display "File status: " JURAD-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura del archivo de errores
           string "$TEMPORALES/" P-file-name delimited space ".errs"
           into ERRS-file-name
           open output ERRS
           evaluate ERRS-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura de los archivos maestros
      * TODO: falta capturar el status de estas operaciones?
           open input BDIIREGI
           open input BDIIDIAN
           open input BDIIDAS.

      * Apertura del archivo de alertas en linea
           if PROCESO-REAL
               open i-o BDIIALE
           else
               open input BDIIALE
           end-if.

      * Si es un refresque total (codigo 04) se eliminan los registros
      * de Jurad existentes
           if P-tipo-proceso = "04" and PROCESO-REAL
               perform 1001-ELIMINAR-TODO
           end-if.

       1000-NOT-USED.
      * >>>> esto da un error de compilacion que no puedo resolver
      * >>>> por ahora esta anulado
      ******************************************************************
      * Carga de los templates para armar el texto de alertas
      * TODO: por ahora los templates son literales
           set LAx to 0
           move high-values to LA-templates
           perform varying LAm from 1 by 1 
           until LA-modelo(LAm) = high-values
               set LAx up by 1
      *        separa las partes de la linea
      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)
      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
      *        delimited by all "&"
      *        prepara para omitir los espacios al final de c/parte
               perform varying LAy from 1 by 1 until LAy > 10
                   inspect LA-parte(LAx, LAy) replacing trailing
                   spaces by high-values
                   inspect LA-parte(LAx, LAy) replacing first
                   high-value by space
               end-perform
           end-perform.


       1001-ELIMINAR-TODO.
      ******************************************************************
      * Elimina los registros de alertas existentes en el archivo de
      * alertas en linea, previo a un refresque total
      ******************************************************************
           display "Eliminando toda la informacion con fuente JURAD"
      *    posiciona en el primer reg de JURAD
           move zero to TIP-IDE-BDIIALE
           move zero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move zeros to COD-ALERTA-BDIIALE
           move low-values to LLASEC-BDIIALE
           start BDIIALE key > LLAVE-BDIIALE
      *    display "Start BDIIALE k:" LLAVE-BDIIALE
           evaluate EST-BDIIALE
           when "00"
      *        posicionado
               continue
           when other
      *        no hay registros
               display "No hay registros a eliminar fs:" EST-BDIIALE
               exit paragraph
           end-evaluate.

      *    lee secuencialmente y elimina los registros de JURAD
      *    hasta el fin del archivo
           perform until EST-BDIIALE not = "00"
               read BDIIALE next record
               evaluate EST-BDIIALE
               when "00"
      *            display "BDIIALE leido fs:" EST-BDIIALE
      *            " k:" LLAVE-BDIIALE
                   if FUENTE-BDIIALE = P-cod-suscriptor
      *                es un alerta de JURAD
                       delete BDIIALE
                       if EST-BDIIALE = "00"
      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE
                           add 1 to N-ale-borradas
                       else
      *                    error en la eliminacion
                           display "Error al eliminar un registro de "
                           "BDIIALE vaciando los datos"
                           display "Clave: " LLAVE-BDIIALE
                           display "Reg borrados: " N-ale-borradas
                           perform 9000-CANCELAR-PROGRAMA
                       end-if
                   end-if
               when "10"
      *            fin de archivo: sale normalmente
                   display "Fin de los registros a eliminar - leídos:"
                   N-ale-leidas
               when other
      *            lectura anormal: cancelacion del programa
                   display "Error en lectura del archivo de alertas "
                   "online"
                   display "File status: " EST-BDIIALE
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
               end-evaluate
           end-perform.
           display "Termino la eliminacion total de JURAD"
           display "Reg borrados: " N-ale-borradas.


       7000-RUTINA-FINAL.
      ******************************************************************
      * Registra hora de finalizacion
           accept W-hora-fin from time

      * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos
           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
      
      * Emision de contadores de registros
           display " "
           display "Totales de registros:"
           display " "
           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
           / N-reg-leidos
           display N-editp100 "% de registros inconsistentes" 
           move N-reg-leidos to N-edit 
           display N-edit "Registros IME en el archivo de entrada"
           move N-reg-OK to N-edit 
           display N-edit "Registros procesados sin error"

      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
      * definicion de estos contadores
      *    move N-reg-tipo-I-OK to N-edit
      *    display N-edit "Registros tipo I aceptados"
      *    move N-reg-tipo-M-OK to N-edit
      *    display N-edit "Registros tipo M aceptados"
      *    move N-reg-tipo-E-OK to N-edit
      *    display N-edit "Registros tipo E aceptados"

           move E-cont-regs-con-error to N-reg-con-error
           move N-reg-con-error to N-edit 
           display N-edit "Registros con error"
           move N-ale-borradas to N-edit 
           display N-edit "Alertas borradas previo al refresque total"
           move N-ale-insertadas to N-edit 
           display N-edit "Alertas insertadas"
           move N-ale-modificadas to N-edit 
           display N-edit "Alertas modificadas"
           move N-ale-eliminadas to N-edit 
           display N-edit "Alertas eliminadas"
           move N-ale-ya-existe to N-edit 
           display N-edit "Insercion de alerta existente"
           move N-ale-no-existe to N-edit 
           display N-edit "Modif o elim de alerta inexistente".

      * Emision del reporte de errores
           display " "
           display "Totales por tipo de error detectado:"
           perform varying Ex from 1 by 1 until Ex > 50
           or E-codigo(Ex) = "00"
               if E-contador(Ex) not = 0 
                   move E-contador(ex) to E-edit
                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
               end-if
           end-perform.


       9000-CANCELAR-PROGRAMA.
      ******************************************************************
      * Procedimiento standard de cancelacion de programa batch
      ******************************************************************
      * TODO: hay un standard para comunicar una cancelacion de proceso?
           display " "
           display pgm " - proceso cancelado"
           goback returning 99.


           copy BDIIVIDE.PROC.


           copy VALNOM.PROC.


      /
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.
      ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un
      * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo
      ******************************************************************
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input-anterior           pic x(86) value low-values.
      * Posicion del proximo error en la lista de errores del reg
       01  errIndex                     pic 999 comp.
      ******************************************************************

       LINKAGE SECTION.
      ******************************************************************
      * Codigo del error detectado
       01  cod-error                    pic xx.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input                    pic x(86).
      ******************************************************************
      * Tabla de errores de consistencia del input
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx.
      *    errores del registro actual
           03 E-errores-reg             pic x(300).
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8).
      *    tabla de errores
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).

      ******************************************************************

       PROCEDURE DIVISION using cod-error reg-input E-errores.
       00.
      *    marca al reg actual como erroneo
           move "SI" to E-hay-error

      *    cuenta y muestra el registro de input
           if reg-input not = reg-input-anterior
               add 1 to E-cont-regs-con-error
               display " "
               display reg-input
               move reg-input to reg-input-anterior
               move spaces to E-errores-reg
               move 2 to errIndex
           end-if

      *    contabiliza el error en la tabla de errores
           set Ex to 1
           search E-error varying Ex
           at end
               display "--- falla en la tabla de errores ---" cod-error
           when E-codigo(Ex) = "00"
               add 1 to E-contador(Ex)
               display "--- error tipo exotico: " cod-error
               add 1 to E-contador(Ex)
           when E-codigo(Ex) = cod-error
               add 1 to E-contador(Ex)
               display "Error " cod-error " " E-descripcion(Ex)
           end-search

      *    agrega a la lista de errores del registro
           if errIndex < (300 - 59 - 3)
               move cod-error to E-errores-reg(errIndex:2)
               add 3 to errIndex
               move E-descripcion(Ex) to E-errores-reg(errIndex:59)
               add 59 to errIndex
           end-if

           exit program.


       end program PONERR.

       end program CARGAJUR2.

      ******************************************************************
      ******************************************************************


/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>ma
/d/iccol/desarrollo/macros>vi JL-inle    padinput
"JL-padinput" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"JL-padinput" [New file]APPEND MODE#! /bin/mksh




DATE_IN=$( date +%Y%M%d )



inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
    # must pad the new value with the remaining chars
        echo $LOld" > "$LNew" - must pad"
 fi
 
     fi   # must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi    # must pad the new value with the remaining chars    :w"JL-padinput" [New file] 20 lines, 343 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>chmod +x JL-padinput
/d/iccol/desarrollo/macros>JL-padinput
ksh: JL-padinput:  not found
/d/iccol/desarrollo/macros>./JL-padinput
ksh: ./JL-padinput:  not found
/d/iccol/desarrollo/macros>ll JL*
ksh: ll:  not found
/d/iccol/desarrollo/macros>fg
vi JL-padinput
#! /bin/mksh

DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"JL-padinput" line 16 of 20 --80%-- :w"JL-padinput" 20 lines, 343 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>ls JL*
JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>ls JL*fg    ll JL*./JL-padinputJL-padinput  lJL-padinputsJL-padinput JL-padinput-JL-padinputlJL-padinput JL-padinput
-rwxrwxr-x   1 icjlud   icdatacr     343 Jun  4 16:58 JL-padinput
/d/iccol/desarrollo/macros>JL-padinput
ksh: JL-padinput:  not found
/d/iccol/desarrollo/macros>sh JL-padinput
JL-padinput: syntax error at line 3: `DATE_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
#! /bin/mksh

DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~

[1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>$( date +%Y%M%d )^[  /d/iccol/desarrollo/macros>$( date +%Y%M%d )$( date +%Y%M%d ) o( date +%Y%M%d ) ( date +%Y%M%d )$( date +%Y%M%d )                  echo $( date +%Y%M%d )
20140104
/d/iccol/desarrollo/macros>A=$( date +%Y%M%d )
/d/iccol/desarrollo/macros>echo $A
20140104
/d/iccol/desarrollo/macros>fg
vi JL-padinput
#! /bin/mksh

DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~

#! /bin~:w"JL-padinput" 19 lines, 330 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgecho $AA=$( date +%Y%M%d )echo $( date +%Y%M%d )fg                    sh JL-padinput
JL-padinput: syntax error at line 2: `DATE_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput

DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:r sh-PE-Ripley"sh-PE-Ripley" 761 lines, 27087 characters 
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#sh-PE-Ripley.V.1.0001
#*******************************************************************************
#SHELL-ID:     sh-PE-Ripley
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:Globant - JL
#*******************************************************************************
# Definición de constantes
    debug=0        # cero para producción, 1 para test
    doCuu="1"   # reposicionar el cursor luego de un error
    NOHUP=""          # contiene "nohup" en producción, null para test
    cancelado="0"# las funciones ponen "1" para cancelar todo
    P_SERVER_DEV="codes"            # hostname de la máquina de develop
    raya="----------------------------------------------------------------------"
    ASCIIBanner="
######  #######    ######
#     # ##     # # #####  ####### #   #
 #     # ##     # # #    # ### #
 ######  ###########  # #    # ######    #
 ###   #   # #####  ###
 ###    #  # ####
 ########    #     # # ####### ######   #
"

# Parámetros y sus valores iniciales
    FECHA_PROC=$(date '+%Y%m%d')
#   "I": la lista de IDs es interna  "E": provista x cliente
    BASE="E"
#si BASE="E": archivo y estructura ("1": 1-11 o "2": 1-11-45)
 NOM_ARCHIVO=" "
 TIPO_ARCHIVO="2"
#si BASE="I": "N": extracción x NIT  "C": por cod suscriptor
 TIPO_EXTRACT="N"
#si TIPO_EXTRACT="C": NIT (9) o Cod Suscriptor (6), según TIPO_EXTRACT
 ID_EXTRACT=" "
#   Tipo de proceso "A": actual  "H": histórico
    TIPO_PROC="A"
#Si TIPO_PROC="H": la fecha inicio de proceso histórico
 FECHA_INICIO=" "

readBASE() {
#*******************************************************************************
# Lee el valor de BASE hasta que es OK {I|C} o el ope cancela
#*******************************************************************************
    loopEnd="0"
    while [[ $loopEnd = "0" ]]
    do








#*******************************************************************************
#*******************************************************************************
#*******************************************************************************
DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi




















~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
750 lines deleted~
#s$#CHANGE MODE
#JL.-padinput

    s$CHANGE MODEJL_-padinput"JL-padinput" [Modified] line 4 of 29 --13%-- 





#JL
~
~~:w"JL-padinput" 26 lines, 652 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: syntax error at line 9: `DATE_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
INSERT MODEtypeset :w"JL-padinput" 26 lines, 660 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: syntax error at line 9: `(' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
typeset DATE_IN=$( date +%Y%M%d )
inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
typeset  DATE_ININSERT MODE="aaa"  # :w"JL-padinput" 26 lines, 678 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: typeset: not found
JL-padinput: typeset: not found

dfssdfsdf
 
Data entered:dfssdfsdf
JL-padinput: bad substitution
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
typeset DATE_IN="aaa"  # =$( date +%Y%M%d )
typeset inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~$CHANGE MODElet
$let:w"JL-padinput" 26 lines, 670 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: let: not found
JL-padinput: let: not found

20140101
 
Data entered:20140101
JL-padinput: bad substitution
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
let DATE_IN="aaa"  # =$( date +%Y%M%d )
let inputPrompt="Enter date:"
echo "$inputPrompt$DATE_IN"
tput cuu 1
echo "${inputPrompt}\c"
read DATE_INnew
echo " "
echo "Data entered:$DATE_INnew"

LNew=${#DATE_INnew}
LOld=${#DATE_IN}
if [[ LNew -lt LOld ]]
then
# must pad the new value with the remaining chars
    echo $LOld" > "$LNew" - must pad"
fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
    # /d/iccol/desarrollo/macros/sh-PE-Ripley
    #JL-padinput.V.1.0001
    #****
    #SHELL-ID:     JL-padinput
    #DATE-WRITTEN: 2014/05/23
    #LAST-UPDATE:  2014/05/23
    #AUTHOR:       JL
    #****
    DATE_IN="aaa"  # =$( date +%Y%M%d )9 lines >>ed# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#****
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:       JL
#****
DATE_IN="aaa"  # =$( date +%Y%M%d )








    inputPrompt="Enter date:"
    echo "$inputPrompt$DATE_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATE_INnew
    echo " "
    echo "Data entered:$DATE_INnew"

    LNew=${#DATE_INnew}
    LOld=${#DATE_IN}
    if [[ LNew -lt LOld ]]
    then
    # must pad the new value with the remaining chars
        echo $LOld" > "$LNew" - must pad"
    fi17 lines >>ed    DATE_IN="aaa"  # =$( date +%Y%M%d )    :w"JL-padinput" 26 lines, 677 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
Enter date:aaa
Enter date:20140101
 
Data entered:20140101
JL-padinput: bad substitution
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
    DATE_IN="aaa"  # =$( date +%Y%M%d )
    inputPrompt="Enter date:"
    echo "$inputPrompt$DATE_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATE_INnew
    echo " "
    echo "Data entered:$DATE_INnew"LNew=${#DATE_INnew}
    LOld=${#DATE_IN}
    if [[ LNew -lt LOld ]]
    then
# must pad the new value with the remaining chars
echo $LOld" > "$LNew" - must pad"
    fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~DATE_IN=:w"JL-padinput" 26 lines, 667 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: syntax error at line 9: `DATE_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
    DATE_IN=$( date +%Y%M%d )
    inputPrompt="Enter date:"
    echo "$inputPrompt$DATE_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATE_INnew
    echo " "
    echo "Data entered:$DATE_INnew"LNew=${#DATE_INnew}
    LOld=${#DATE_IN}
    if [[ LNew -lt LOld ]]
    then
# must pad the new value with the remaining chars
echo $LOld" > "$LNew" - must pad"
    fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~~
    DATE_IN=$( date +%Y%M%d ):w"JL-padinput" 26 lines, 667 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: syntax error at line 10: `DATE_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
    inputPrompt="Enter date:"
    DATE_IN=$( date +%Y%M%d )
    echo "$inputPrompt$DATE_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATE_INnew
    echo " "
    echo "Data entered:$DATE_INnew"LNew=${#DATE_INnew}
    LOld=${#DATE_IN}
    if [[ LNew -lt LOld ]]
    then
# must pad the new value with the remaining chars
echo $LOld" > "$LNew" - must pad"
    fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~/DATE?REPLACE MODEDATO//DATO/DATO/DATO/DATO/DATO/Address search hit BOTTOM without matching pattern:w"JL-padinput" 26 lines, 667 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: syntax error at line 10: `DATO_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
    inputPrompt="Enter date:"
    DATO_IN=$( date +%Y%M%d )
    echo "$inputPrompt$DATO_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATO_INnew
    echo " "
    echo "Data entered:$DATO_INnew"LNew=${#DATO_INnew}
    LOld=${#DATO_IN}
    if [[ LNew -lt LOld ]]
    then
# must pad the new value with the remaining chars
echo $LOld" > "$LNew" - must pad"
    fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~date:w"JL-padinput" 26 lines, 665 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
JL-padinput: syntax error at line 10: `DATO_IN=$' unexpected
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
    inputPrompt="Enter date:"
    DATO_IN=$(date +%Y%M%d)
    echo "$inputPrompt$DATO_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATO_INnew
    echo " "
    echo "Data entered:$DATO_INnew"LNew=${#DATO_INnew}
    LOld=${#DATO_IN}
    if [[ LNew -lt LOld ]]
    then
# must pad the new value with the remaining chars
echo $LOld" > "$LNew" - must pad"
    fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~)APPEND MODE"=":w"JL-padinput" 26 lines, 667 characters [1] + Stopped (SIGTSTP)        vi JL-padinput
/d/iccol/desarrollo/macros>^[  /d/iccol/desarrollo/macros>fgsh JL-padinput
Enter date:$(date +%Y%M%d)
Enter date:20140101
 
Data entered:20140101
JL-padinput: bad substitution
/d/iccol/desarrollo/macros>fg
vi JL-padinput
# /d/iccol/desarrollo/macros/sh-PE-Ripley
#JL-padinput.V.1.0001
#*******************************************************************************
#SHELL-ID:     JL-padinput
#DATE-WRITTEN: 2014/05/23
#LAST-UPDATE:  2014/05/23
#AUTHOR:JL
#*******************************************************************************
    inputPrompt="Enter date:"
    DATO_IN="$(date +%Y%M%d)"
    echo "$inputPrompt$DATO_IN"
    tput cuu 1
    echo "${inputPrompt}\c"
    read DATO_INnew
    echo " "
    echo "Data entered:$DATO_INnew"LNew=${#DATO_INnew}
    LOld=${#DATO_IN}
    if [[ LNew -lt LOld ]]
    then
# must pad the new value with the remaining chars
echo $LOld" > "$LNew" - must pad"
    fi


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/macros>cd
/d/iccol/desarrollo>
/d/iccol/desarrollo>
/d/iccol/desarrollo>cd $DATABASE
/d/iccol/desarrollo/database/prunovedat>vire ICBSUS
ksh: vire:  not found
/d/iccol/desarrollo/database/prunovedat>view ICBSUS
"ICBSUS" [Read only] 15354 lines, 3086154 characters (293687 null) 001801/U.A.E. DIRECCION DE IMPUESTOS Y ADUANAS NACIONALESD.I.A.N.1^O^A^O^_^_Y_^O
Y_\200^A\227&\217000000000000000Q\231_10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001802/SUPERINTENDENCIA FINANCIERA DE COLOMBIASUPERBANCARIA1^O^A^P^O^_^_Y_
^OY_\211    \231^E^?000000000000000Q\231_10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001803/DEPARTAMENTO ADMINISTRATIVO DE SEGURIDAD SECCIONAL ANTIOD.A.S.1^O^A^O^_^_^A
  _^O^A _\200^A x\217000000000000000^A^A\231_10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001804/PROCURADURIA GENERAL DE LA NACIONPROCURADURIA1^O^A^O^_^_Y^?^
OY^?\211\231\231^Q\237000000000Q\231^?10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001805^_BOGOTA DISTRITO CAPITALBOGOTA DISTRITO CAPITAL     2^O^A^O^_^_)\2
37^O)\237\211\231\231^F^_000000000000000!\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001806/FISCALIA GENERAL DE LA NACIONFISCALIAGENERAL2^O^A^O^_^_I\23
7^OI\237\200^ARx?000000000000000A\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001807^_DIRECCION DE INTELIGENCIA POLICIALDIJIN1^O^A^O^_^_i\2
37^Oi\237\203   ^?000000000000000a\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001808/CAMARA DE COMERCIO DE BOGOTACAMARA DE     COMERCIO BTA. 2^O^P^O^O^_ ^_^
O ^_\206^G2/000000000"^_00^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001809_CENTRAL DE INVERSIONES LTDACISA1^O^A^O^_^_ ^_^
O ^_\211^A^F^AO000220010"^_00^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001810/DUN & BRADSTREET.DUN &BRADSTREET    2^O^A^O^_^_^A^Y
\237^O^A^Y\237^_000000000^A^Q\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001811/UNIDAD DE INFORMACION Y ANALISIS FINANCIEROU I A F1^O^A^O^_^_\200
_^O^O\203h^GO000000000000000\202_00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001812/BYNGTON?????????BYINGTON1^O^A^O^_^_@^O^
O@^O^_000000000B^O10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001813/CONTRALORIA GENERAL DE LA REPUBLICACONTRALORIA1^O^A^O^_^_ /^O
^O\211\231\231^F^?000000000"/00^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001814/EJERCITO NACIONAL CENTRAL INTELIGENCIA MILITARCIME1^O^A^O^_^_\220
O^O^O\200^A1)/000000000000000\222O00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001815/EJERCITO NACIONAL CENTRAL INTELIGENCIA MILITARCECIM1^O^A^O^_^_ _^O
^O\200^A1)/000000000"_00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001816/SUPERINTENDENCIA FINANCIERA DE COLOMBIASUPERINTENDEN.FINAN. DE COL.2^O^A^O^_^_P^?^
O^O\211 \231^E^?000000000000000R^?00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001820/FONDO DE EDUCACION Y SEGURIDAD VIAL EN LIQUIDACIONFONDATT1^O^A^O^_^_\200
\217^O^O\200u%o000000000000000\202\21700^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001821/SUPERINTENDENCIA DE INDUSTRIA Y COMERCIOSIC1^O^A^P^O^_^_A^
_^O^O\200^Av^H\237500000000000000B^A^_00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
004321/BANCO DAVIVIENDA S.A.DAVIVIENDA    DINERS CLUB D 2^O^A^O^_^O^O^O
^O\20641?500000000000001a\230^_11^O00000PN00000000^B\220^?00NNSN^O1S0N1SSSSSSS0N
010001^_BANCO DAVIVIENDA S.A.DAVIVIENDA1\202^_^A^O^_^
_)^?^OPo\20641?200000000000001!\231^?10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010002^_BANCO FALABELLA S AB. FALABELLA  CTA CTE2\202^A?^P^O/^
_^A^A^O^O1O\220G\230^_200000000000000^A^B^A^O10^O00000MN01000000^B^A1/01NNSS^A"^A?1S1N120131002SSSSSSS0N

010003^_BANCO COOMEVA S.ABANCOOMEVA1B^A^_^A^O^_^_
1^_^OAO\220^D^F^U^O2000000000000002^A^_00^O00000MN00000000^B^A@^_00NNSS^R^AO1S1N1SSSSSSS0N
010004^_BANCO DE OCCIDENTECTEOCCIDENTE1^A^R^A^_^A^P^
O^_^_^A^Q^_^OAO\211^C'\237200000000000000^A^R^A^_00^O00000MN00000000^O00NNSS^R^AO1S1N1SSSSSSS0N

@"ICBSUS" [Read only] 15354 lines, 3086154 characters (293687 null)001801/U.A.E. DIRECCION DE IMPUESTOS Y ADUANAS NACIONALESD.I.A.N.1^O^A^O^_^_Y_^OY_\200^A\227&\217000000000000000Q\231_10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001802/SUPERINTENDENCIA FINANCIERA DE COLOMBIASUPERBANCARIA1^O^A^P^O^_^_Y_^OY_\211  \231^E^?000000000000000Q\231_10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001803/DEPARTAMENTO ADMINISTRATIVO DE SEGURIDAD SECCIONAL ANTIOD.A.S.1^O^A^O^_^_^A    _^O^A   _\200^A x\217000000000000000^A^A\231_10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N

001804/PROCURADURIA GENERAL DE LA NACIONPROCURADURIA1^O^A^O^_^_Y^?^OY^?\211\231\231^Q\237000000000Q\231^?10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001805^_BOGOTA DISTRITO CAPITALBOGOTA DISTRITO CAPITAL     2^O^A^O^_^_)\237^O)\237\211\231\231^F^_000000000000000!\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N

001806/FISCALIA GENERAL DE LA NACIONFISCALIAGENERAL2^O^A^O^_^_I\237^OI\237\200^ARx?000000000000000A\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001807^_DIRECCION DE INTELIGENCIA POLICIALDIJIN1^O^A^O^_^_i\237^Oi\237\203 ^?000000000000000a\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001808/CAMARA DE COMERCIO DE BOGOTACAMARA DE     COMERCIO BTA. 2^O^P^O^O^_ ^_^O ^_\206^G2/000000000"^_00^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001809_CENTRAL DE INVERSIONES LTDACISA1^O^A^O^_^_ ^_^O ^_\211^A^F^AO000220010"^_00^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001810/DUN & BRADSTREET.DUN &BRADSTREET    2^O^A^O^_^_^A^Y\237^O^A^Y\237^_000000000^A^Q\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001811/UNIDAD DE INFORMACION Y ANALISIS FINANCIEROU I A F1^O^A^O^_^_\200_^O^O\203h^GO000000000000000\202_00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001812/BYNGTON?????????BYINGTON1^O^A^O^_^_@^O^O@^O^_000000000B^O10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001813/CONTRALORIA GENERAL DE LA REPUBLICACONTRALORIA1^O^A^O^_^_ /^O^O\211\231\231^F^?000000000"/00^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
001814/EJERCITO NACIONAL CENTRAL INTELIGENCIA MILITARCIME1^O^A^O^_^_\220O^O^O\200^A1)/000000000000000\222O00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001815/EJERCITO NACIONAL CENTRAL INTELIGENCIA MILITARCECIM1^O^A^O^_^_ _^O^O\200^A1)/000000000"_00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001816/SUPERINTENDENCIA FINANCIERA DE COLOMBIASUPERINTENDEN.FINAN. DE COL.2^O^A^O^_^_P^?^O^O\211   \231^E^?000000000000000R^?00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001820/FONDO DE EDUCACION Y SEGURIDAD VIAL EN LIQUIDACIONFONDATT1^O^A^O^_^_\200\217^O^O\200u%o000000000000000\202\21700^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
001821/SUPERINTENDENCIA DE INDUSTRIA Y COMERCIOSIC1^O^A^P^O^_^_A^_^O^O\200^Av^H\237500000000000000B^A^_00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
004321/BANCO DAVIVIENDA S.A.DAVIVIENDA    DINERS CLUB D 2^O^A^O^_^O^O^O^O\20641?500000000000001a\230^_11^O00000PN00000000^B\220^?00NNSN^O1S0N1SSSSSSS0N
010001^_BANCO DAVIVIENDA S.A.DAVIVIENDA1\202^_^A^O^_^_)^?^OPo\20641?200000000000001!\231^?10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010002^_BANCO FALABELLA S AB. FALABELLA  CTA CTE2\202^A?^P^O/^_^A^A^O^O1O\220G\230^_200000000000000^A^B^A^O10^O00000MN01000000^B^A1/01NNSS^A"^A?1S1N120131002SSSSSS
S0N
010003^_BANCO COOMEVA S.ABANCOOMEVA1B^A^_^A^O^_^_1^_^OAO\220^D^F^U^O2000000000000002^A^_00^O00000MN00000000^B^A@^_00NNSS^R^AO1S1N1SSSSSSS0N

010004^_BANCO DE OCCIDENTECTEOCCIDENTE1^A^R^A^_^A^P^O^_^_^A^Q^_^OAO\211^C'\237200000000000000^A^R^A^_00^O00000MN00000000^O00NNSS^R^AO1S1N1SSSSSSS
0N
010005^_BANCO WWB S.A.BANCOWWB2^O^A^O^_^_^A^Q^_^O^O\220^Cx!/500000000000000^A^R^A^_00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
010006^_BCSC S ABC CAJA SOCIALBCSC2\202^_^A^O^_^_i?^OAO\206^G3_200000000000001a\231?10^O00000PN01000000^B^A@^_00NNSS^R^AO1S0N1SSSSSSS0N
010007^_CITIBANK COLOMBIACITIBANK1^O^A^O^_^_\200^?^O^O\206Q^S_000000000000000\202^?00^O00000MN01000000^O00NNSN^O0S0N1SSSSSSS0N
010008^_BANCO COLPATRIA RED MULTIBANCA COLPATRIA S.A.BCO COLPATRIA1\202^_^A^O^_^_^A^Y\237^OAO\2064YO200000000000001^A^Q\231\23710^O00000PN01000000^B^A@^_02NNSS^R^AO1S0N1SSSS
SSS0N
010009^_BANCO ANDINO COLOMBIA S.A. EN LIQUIDACIONBCO ANDINO1^O^A^O^_^OI\217^O^O\206^C^B?000000000000000A\231\21712^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010010^_BANCO UNION COLOMBIANOBCO. OCCIDENTE/UNION2\202^_^A^O^_^Oy\217^O\200o\206P\222?200000000000000q\231\21712^O00000PN00000000^B`\21700NNSN^O0S0N1SSSSSSS
0N
010011^_BANCO  PROCREDIT  COLOMBIA  S.A.BANCOPROCREDIT     2^A^R^A^_^A^P^O^_^_^A!^_^OAO\220^B\226^O200000000000000^A"^A^_00^O00000MN00000000^B^A@^_00NNSS^R^AO1S1N1SSS
SSSS0N
010012^_BANCO SANTANDER COLOMBIA S ABANCOCORPBANCA     2r^_^A^O^_^_yo^OAO\211  ^C\223^?200000000000001q\231o10^O00000PN00000000^B^A@^_00NNSS^R^AO1S0N120121030SSSSSSS0N

010013^_BANCO PICHINCHA S.ABCO PICHINCHA1R^A/^P^O/^_Q/^OAO\211^Buo200000000000000R^A/00^O00000MN00000000^B^A@^_00NNSS^R^AO1S1N1SSSSSSS0N
010014^_BANCO POPULAR S. A.BCO POPULAR1b^_^A^O^_^_`^_^O^A!/\206^Gs\217200000000000001b^_00^O00000PN00000000^B^A!/00NNSS^A"^A/1S0N1SSSSSSS0N
010016^_BANCO GNB SUDAMERIS S AGNB SUDAMERIS1r^_^A^O^_^_I\237^OAO\206Pu^O200000000000000A\231\23710^O00000PN00000000^O00NNSS^R^AO1S0N1SSSSSSS0N
010017^_BANCO GNB SUDAMERIS S AGNB SUDAMERIS1\202^_^A^O^_^_I\237^O^A_\206Pu^O200000000000000A\231\23710^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010020^_BANCO DE BOGOTA S. A.BCO DE BOGOTA1\202^_^A^O^_^_\231_^OAO\206^B\226O200000000000001\221\231_10^O00000PN00000000^B^A@^_00NNSS^R^AO1S0N3SSSSSS
S0N
010021^_HELM BANK S AHELM BANK S.A1^A^B^_^P^O/^_0^O^OAO\206^Gf^O2000000000000002^O10^O00000MN00000000^O00NNSS^A"^A?1S0N1SSSSSSS0N
010024^_BANCO AGRARIO DE COLOMBIA S.A.BCO AGRARIO1\202/^A^O^_^_\200/^OAO\2007\200^O200000000000001\202/00^O00000PN00000000^B^A@^_00NNSS^R^AO1S0N1SSSSSSS0N

010026^_BANCO STANDARD CHARTERED COLOMBIABCO STANDARD  CHARTERED     2\202^_^A^O^_^O^Y/^O`/\206^E^Fd\217200000000^Q\231/12^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010029^_BANCO INTERCONTINENTAL S A EN LIQUIDACIONBCO INTERBANCOEN LIQUIDACION2^O^A^O^_^O^A)_^O\231o\200^B^S\230O000000000000000^A!\231_12^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010031^_BANCO ALIADAS S.ABCO ALIADAS1^O^A^O^_^O ?^O^O\211   !^R\237000000000000000"?02^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
010039^_HSBC COLOMBIA S AHSBC COLOMBIA S.A.2\202^A^O^P^O/^_^P\237^OAO\206P\223^O200000000000000^R\23710^O00000 N00000000^O00NNSN^O1S0N1SSSSSSS0N
010042^_BANCO DAVIVIENDA S.A.DAVIVIENDA /  GRANBANCO     2^O^A^O^_^O^O^O^O\20641?200000000000001^Q\226\21711^O00000PN00000000^B\220o00NNSN^O0S0N1SSSSSSS0N
010046^_CITIBANK COLOMBIACITIBANKCOLOMBIA2\202^_^A^O^_^_^A)/^OAO\206Q^S_200000000000000^A!\231/10^O00000PN00000000^B^A@^_00NNSS^R^AO1S0N120130312SSSSSSS0N/jurad100121^A^OLATIN AMERICAN BOOK COMPANY S.A.S.LATIN AMERICANBOOK2\222^A^_^A^P^O^_^_\201^_^O1O\220^C^P\201\237500320140000000\202^A^_00^O00000MN00000000^B^A0\23700NNSS\222^A^_1S1
N1SSSSSSS0N
100122^A^OALTA TECNOLOGIA EN EL APRENDIZAJE S.AALTATECNOLOGIA S.A2^A^R^A^_^A^P^O^_^_\221^_^O^A!/\203^A^H\237501220120000000\222^A^_00^O00000MN00000000^B^A!/00NNSS^A^R^A^_1S1N1SSSSSSS0N
100123^A^OPUBLIMETRO COLOMBIA S.A.S.PUBLIMETRO    S.A.S22^A/^A^P^O^_^_^A^A^_^OAO\220^D8^SO500420140000000^A^B^A^_00^O00000MN00000000^O00NNSS2^A/1S1N1SSSSSSS0N

100124^A^OCREAR DISTRIBUCIONES LTDACREAR DISTRIBU1^O^A^P^O^_^O\220^?^O^O\200P#t?000000000000000\222^?02^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
100125^A^OIMPRESORA FERIVA S.A.FERIVA S A1b\217^P^O/^O \217^O!/\211^C^Gr^?500220120000000"\21702^O00000MN00000000^B^A^Q/00NNSS^A^B\2371S0N1SSSSSSS
0N
100126^A^OCARVAJAL EDUCACION S.A.SCARVAJALEDUCACION SAS 2^O^A^P^O^_^_^A^A^_^O^O\200\231\220?500000000000000^A^B^A^_00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N

100127^A^OPASSPORT ACADEMICS LLCPASSPORTACADEMICS LLC 2"^A/^A^P^O^_^O^A!^_^OAO\203\223F^O500420140000000^A"^A^_00^O00000MN00000000^B^A1^_00NNSS"^A/1S1N1SSSSSSS
0N
100128^A^ONANO E.U.NANO E.U1B^A/^A^P^O^_^_^Q/^OA/\220^Avw^O500420120000000^R^A/00^O00000MN00000000^O00NNSSB^A/1S1N1SSSSSSS0N
100129^A^OCOMERCIALIZADORA P & L S.AP&L COMERCIAL1^O^A^P^O^_^O^A^P^?^O^O\220\2066\217000000000000000^A^R^?02^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
100130^A^OINDUPRINT  S.A.S.INDUPRINT SAS1b^A/^A^P^O^_^O!/^Oa/\203^E^V_500620120000000"^A/04^O00000MN00000000^B^A o00NNSSb^A/1S1N120130723SSSSSSS0N
100131^A^OSANCHEZ HEREDIA CARLOS ARTURODISCARSAN1R^A/^A^P^O^_^O!/^Oa/^G\231^QY_500620120000000"^A/01^O00000MN00000000^B^A o00NNSSR^A/1S1N1SSSSSSS0N
100132^A^OMEDIA CONSULTING GROUP S A SGROUP SAS1r^A/^A^P^O^_^O1/^Oq/\220^Bxx\2375007201200000002^A/01^O00000MN00000000^B^A ^?00NNSSr^A/1S1N1SSSSSSS0N

100133^A^OEDICIONES ZAMORA DE OCCIDENTE LTDAEDIC. ZAMORA  DE OCCIDENTE  2^A^R/^A^O^_^O^P?^OP\217\211^C b_500520080000000\222/02^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
100134^A^OEDITORIAL NORMA S.A.EDITORIAL     NORMA2\202^_^A^O^_^O^A)o^O^A^Po\211^C^H\223^_501120060000000^A!\231o12^O00000PN00000000^B`^?00NNSN^O0S0N1SSSSS
SS0N
100135^A^OINTERAMERICAN LANGUAGES SASINTERAMERICAN1B^A/^A^P^O^_^_A/^OAO\220^DE\211?500420140000000B^A/00^O00000MN00000000^B^A@^_00NNSSB^A/1S1N1SSSSSSS0N

100136^A^OTUTOR EDITORA AP SASTUTOR EDITORA1B^A/^A^P^O^_^_A/^OAO\220^D5&\237500420140000000B^A/00^O00000MN00000000^B^A1/00NNSSB^A/1S1N1SSSSSSS0N

100137^A^OCASA EDITORIAL MUNDO DE NINOS LIMITADAMUNDO DE NIÑOS1b^A?^A^P^O^_^_Q/^OAO\203YT\217500420140000000R^A/00^O00000MN00000000^B^A0o00NNSSb^A?1S1N120131028SSSSSSS0N
100138^A^ODISTRIBUIDORA DE PAPEL JURADO TORRES SASLEONARDOJURADO2^O^P^O/^_a/^O^O\220^S^P/500000000000000b^A/00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
100139^A^OSRM GROUP E.U.SRM1^O^P^O/^_q/^O^O\203i5_500000000000000r^A/00^O00000MN00000000^O00NNSN^O0S1N120131227SSSSSSS0N
100140^A^OSOLUCIONES GRAFIKAS S.A.S.SOLUCIONES    GRAFIKAS2^O^P^O/^Oq/^O^O\220^Bx\206\237500000000000000r^A/02^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
100141^A^OESCUELA INTERNACIONAL DE LIDERAZGO LTDAESCUELAINTERNANCIONAL2r^A/^P^O/^Oa/^O^A!/\220^C^Q^U\237501220120000000b^A/02^O00000MN00000000^B^A!/00NNSSr^A/1S1N120130905SSSSSSS0N

100142^A^OGIRALDO MEDELLIN ESNEYDA YULIETHJ.D. EDICIONES1\222^A/^P^O/^_\201/^O1O^C^C7F\237500320140000000\202^A/00^O00000MN00000000^B^A0\23700NNSS\222^A/1S1N120121107SSS
SSSS0N
100143^A^OLITOGAL LIMITADALITOGAL EDITOR1^O^P^O/^O\201/^O^O\203Fp_500000000000000\202^A/02^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
100144^A^OCENTRO AMERCIANO DE LIDERAZGO SASCENTRO AMERICADE LIDERAZGO  2\202^A/^P^O/^O\201/^O1O\220^Drxo500320140000000\202^A/04^O00000MN00000000^B^A1^_00NNSS\202^A/0S1N120140128SSSSSS
S0N
100145^A^OMATEUS OLARTE LUIS ALIRIOEDICIONES MEGA1R^A?^P^O/^O\221/^O!O^A9W@/500220140000000\222^A/00^O00000MN00000000^B^A0_00NNSSR^A?1S1N120130704SSSSSSS0N
100146^A^OPRO OFFSET EDITORIAL S APRO OFFSET    EDITORIAL S A 2^O^P^O/^O\221/^O^O\206x3o500000000000000\222^A/02^O00000MN00000000^O00NNSN^O0S1N120120927SSSSSSS0N
100147^A^OMONSALVE RIOS SERGIOMONSALVE RIOS1B^A?^P^O/^O^A!/^O^A!?    ^R\206\202?501220130000000^A"^A/00^O00000MN00000000^B^A1^_00NNSSB^A?1S1N120130626SSSSSS
S0N
100148^A^OEDUCAR S AEDUCAR SA1b^A?^P^O/^O\220/^O\221?\206e0/500920130000000\222/01^O00000MN00000000^B^A0\23700NNSSb^A?1S1N120131218SSSSSSS0N

100149^A^OCIRCULO DEL LIBRO SASCIRCULO DEL LI1B^A?^P^O/^O1?^O!O\220^E\204e?5002201400000002^A?00^O00000MN00000000^B^A1^_00NNSSB^A?1S1N120130604SSSSSSS0N
100150^A^OEL PAIS S.A.EL PAIS S A1^O^P^O/^_^A^P^?^O^O\211^C^Au/000000000000000^A^R^?00^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
100151^A^ODELGADO RANGEL ESPERANZACERVANTES EDIC12^A?^P^O/^_1?^OAO^Cx\220\225^_5004201400000002^A?00^O00000MN00000000^B^A0\23700NNSS2^A?1S1N120130430SSSSSSS0N

100153^A^OLEGISLACION ECONOMICA S.A. LEGIS S.A.LEGIS S.A.1^O^A^O^_^_^P^O^O^P^O\206^AI\217000000000^R^O10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
100159^A^OARTE MODERNO S.A.ARTE MODERNO1r^_^A^O^_^O0^_^O@O\211^C^A^U\237500420040000000r^O12^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
100163^A^OPUBLICAR S.A.PUBLICAR S.A.1^O^A^O^_^OP^_^OP^_\206^A1^?000000000000000R^_02^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
100164^A^OPUBLICAR DE COLOMBIA S.A.PUBLICAR DE   COLOMBIA2^O^A^O^_^O0?^O^O\203\201\221/0000000000000002?02^O00000MN00000000^O00NNSN^O0S0N1SSSSSSS0N
100165^A^OENGLISH NET LTDAENGLISH NET1^O^A^O^_^OP^_^O^O\200P^U\226?500000000000000R^_02^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
100166^A^OTARJETAS EXCLUSIVAS MU?OZ Y COMPA?IA LIMITADATAR EXCLUSIVASMUÑOZ & CIA   22/^A^P^O^_^O0/^OP\237\200@E/500520090000000"/02^O00000PN00000000^B\220/00NNSN^O0S0N1SSSSSSS0N
100200^A^OSIERRA HERRERA FRANCISCO ARTUROCOLMUSICA1^O^A^P^O^_^O \237^O^O^G^A\2209^_000000000000000"\23702^O00000MN00000000^B\201/00NNSN^O0S0N1SSSSSSS0N

@//130008^A?BANCO COLPATRIA RED MULTIBANCA COLPATRIA S.A.BCO COLPATRIA1R^_^A^O^_^_^A^Y\237^OAO\2064YO500420140000001^A^Q\231\23710^O00000PN00000000^B\220\23700NNSS^A^R\2371S0N1
SSSSSSS0N
130009^A?HSBC COLOMBIA S AHSBC VIVIENDA1\202^A^O^P^O/^_a^O^OAO\206P\223^O500420140000000b^A^O00^O00000MN00000000^B^A1/00NNSS\202^A^O1S0N1SSSSSSS0
N
130010^A?VALENCIA DE LA CALLE ADRIANA MARIAMASTERRENT-A-CAR    2^O^A^P^O^_^Oa^O^O^O^D73W/000000000000000b^A^O02^O00000MN00000000^B^A?00NNSS^A^B\2370S0N1SSSSSSS0N
130011^A?MESA MADRID MELQUISEDECLUBRICANTES ELMELKIS2^O^A^P^O^_^O\201^O^O^O^G^W%F?000000000000000\202^A^O02^O00000MN00000000^B^A^?00NNSS\222\2370S0N1SSSSSSS0N

130012^A?COOPERATIVA DE EMPLEADOS Y JUBILADOS DEL INSTITUTO NACIOCOOINEM1^O^A^P^O^_^O^A^Q^O^O^O\200^B5^O000000000000000^A^R^A^O02^O00000MN00000000^B^A?00NNSS^A^B\2370S1N1SSSSSSS0
N
130013^A?ESTACION DE SERVICIO UNIVERSIDAD  SAESD UNIVERSIDAD SA22^A^_^A^P^O^_^_!^_^OAO\201^P  qo500420140000000"^A^_00^O00000MN00000000^B^A0\23700NNSS2^A^_1S1N1SSSSSSS0N

130014^A?BANCO POPULAR S. A.BCO POPULAR1^O^A^O^_^_9o^O9o\206^Gs\2170000000001\231o10^O00000PN00000000^O00NNSN^O0S0N1SSSSSSS0N
130015^A?COOPERATIVA DE TRANSPORTADORES AEROPUERTOS Y PUERTOS    COOPEAN1r^A^_^A^P^O^_^_A^_^Oq^_\201^P'^F\217500720110000000B^A^_00^O00000MN00000000^B^A^P^?00NNSSr^A^_1S1N1SSSSSS
S0N
130016^A?INVERSIONES INMOBILIARIAS EL PRADO S A SINVERSIONES INARIAS EL PRADO2^O^A^P^O^_^Oa^_^O^O\220^Cvb^O500000000000000b^A^_02^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
130017^A?DIPROMURO COLOMBIA S.A.S.DIPROMURO     COLOMBIA S.A.S2\202^A^_^A^P^O^_^Oq^_^OA/\220^C3I\237500420120000000r^A^_02^O00000MN00000000^B^A /00NNSS\202^A^_1S1N1SSSS
SSS0N
130018^A?FONDO NACIONAL DE AHORROFONDO NACIONALDEL AHORRO    2^A^B\217^A^O^_^_ /^O1O\211\231\231(O500320140000000"/10^O00000MN00000000^B^A@^_00NNSS\222\2371S0N1SSSSSSS
0N
130019^A?BANCO SANTANDER COLOMBIA S ABCO CORPBANCA HIPOTECARIO   2^O^P^O/^_\201^_^O^O\211   ^C\223^?500000000000000\202^A^_00^O00000MN00000000^O00NNSN^O1S1N120121030SSSSSSS0N
130020^A?BANCO DE BOGOTA S. A.BCO DE BOGOTA1^R_^A^O^_^_io^OAO\206^B\226O500420140000000a\231o10^O00000MN00000000^B^A1^_00NNSS^A^B\2371S0N3SSSSSSS0N

130021^A?PARRA ARANGO Y CIA. S.A.PARRA ARANGO  & CIA S.A.    2^O^A^P^O^_^O\201^_^O^O\206^E^H\223o500000000000000\202^A^_02^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N

130022^A?CARIBE MOTOR DE MEDELLIN S.A.CERIBE MOTOR  DE MEDELLIN SA2^O^A^P^O^_^O\201^_^O^O\211    ^Q\207\217500000000000000\202^A^_02^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0
N
130023^A?INVERSIONES MAX TIRES S.A.S.MAX TIRES     S.A.S.2^O^A^P^O^_^O\221^_^O^O\220^C9e\237500000000000000\222^A^_02^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
130024^A?VALENCIA JURADO ANDRESAUTOSAMARILLOS     2^O^A^P^O^_^_\221^_^O^O^G^Wtx/500000000000000\222^A^_00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
130025^A?TRANSPORTES LINEA BUENAVENTURA  S. ATRAN LINEA    BUENAVENTIRA  2^A^B^A^_^A^P^O^_^O^A^A^_^O^A^A^_\200^At\227\217501020110000000^A^B^A^_02^O00000MN00000000^O00NNSS^A^B^A^_1S1N1SSSSSSS0N
130026^A?EQUIPOS Y SERVICIOS DE LOS ANDES S.A.S.EQUIPOSY SERVICIOS   2^O^A^P^O^_^_^A^Q^_^O^O\220^C\225^P^O500000000000000^A^R^A^_00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N

130027^A?COOPERATIVA DE AHORRO Y CREDITO SAN MIGUELCOOFISAMVIVIENDA2^O^A^P^O^_^_!/^O^O\211^Q^G\237500000000000000"^A/00^O00000MN00000000^O00NNSN^O0S1N1SSSSSSS0N
130028^A?HELM BANK S AHELM BANK     CART HIPOTECAR2R^A/^P^O/^_!/^OAO\206^Gf^O500420140000000"^A/00^O00000MN00000000^O00NNSSR^A/1S1N1SSSSSSS0N
130029^A?BANCO COOMEVA S.A.BANCOOMEVA1"^A/^P^O/^_^A^Y_^OAO\220^D^F^U^O500420140000000^A^Q\231_00^O00000MN00000000^B^A@^_00NNSS"^A/1S1N120121120SSSSSSS0
N
130030^A?FONDO DE EMPLEADOS VISION SOCIALFE VISION SOCIAL2^R^AO^A^P^O^_^_1/^OAO\220^DB"\2175004201400000002^A/00^O00000MN00000000^B^A@^_00NNSS^R^AO0S1N1SSSSSSS0N

130031^A?CONFIAR COOPERATIVA FINANCIERACONFIAR COOP1^A"^A/^A^O^_^_\231_^OAO\211   \2019_500420140000000\221\231_00^O00000MN00000000^B^A@^_00NNSS^A"^A/1S1N120130114SS
SSSSS0N
130032^A?COOPERATIVA MULTIACTIVA DE COMERCIO Y SERVICIOS DE COLOMCOOPSERVICOL1"^A?^P^O/^_^A!/^O^A!?\220^C^DCo501220130000000^A"^A/00^O00000MN00000000^B^A1^_00NNSS"^A?1S1N120131122SSSSSSS0N

130033^A?CREDIFAMILIA COMPA?IA DE FINANCIAMIENTO S.A.CREDIFAMILIA12^A?^A^O^_^_1^_^OAO\220^D^FG/5004201400000002^A^_00^O00000MN00000000^B^A@^_00NNSS2^A?1S1N120130416SSSSSSS0N
130034^A?COOPERATIVA MULTIACTIVA DE DESARROLLO Y SERVICIOS LTDA  COPDYSER1B^A?^P^O/^O1?^O!O\203^AFb^?5002201400000002^A?01^O00000MN00000000^B^A1^_00NNSSB^A?0S1N120140128SSSSSSS0N
130035^A?FONDO DE EMPLEADOS Y AYUDA MUTUA DE LA UNIDAD DE ORIENTAFONORIENTAME1^O^P^O/^_1?^O^O\206^E0V\2175000000000000002^A?00^O00000MN00000000^O00NNSN^O0S1N120130326SSSSSSS0N
130040^A?BANCO DE LAS MICROFINANZAS - BANCAMIA S.A.BANCAMIAVIVIENDA2^R^A/^P^O/^_^P\237^OAO\220^B^U^G^_500420140000000^R\23700^O00000 N01000000^B^A1^_00NNSS^R^A/1S0N1SSSSSSS0
N
130049^A?BANCO DE LAS MICROFINANZAS - BANCAMIA S.A.BANCAMIAVIVIENDA2^O^A^P^O^_^_0\237^O^O\220^B^U^G^_0000000000000002\23700^O00000 N01000000^O00NNSN^O0S0N1SSSSSSS0N
130050^A?BANCO BILBAO VIZCAYA ARGENTARIA COLOMBIA S.A.BBVACOLOMBIA2^R\217^A^O^_^_^P\217^O1O\206^C^B^O500320140000001!\231O10^O00000PN00000000^B^A1/00NNSN^O0S0N1SSSSSSS0N

130053^A?BANCOLOMBIA S.A.BANCOLOMBIA1^O^A^O^_^_`?^O^O\211  ^C\223\217000000000000000b?00^O00000MN01000000^O00NNSN^O0S0N1SSSSSSS0N
130060^A?BANCO COMERCIAL AV VILLAS S.A.BCO AVVILLAS  HIPOTECARIO   2\202^_^A^O^_^_\211O^OAO\2065\202^?500420140000001\201\231O10^O00000MN00000000^B^A@^_00NNSS^A^B\2371S0N1SS
SSSSS0N
130061^A?FONDO NACIONAL DE AHORROFNA ORIGEN    VOLUNTARIO    2R^A^O^P^O/^_ /^O1O\211\231\231(O500320140000000"/00^O00000MN00000000^B^A@^_00NNSSR^A^O1S0N1SSSSSSS0N
130101^A?BCSC S ARED BANCO CAJASOCIAL BCSC   2^A^R^?^A^O^_^_I?^OAO\206^G3_500420140000001A\231?10^O00000PN01100000^B^A1/00NNSS^A^B\2371S0N1SSSSSSS0N/110433^A^_COBRANZA NACIONAL DE CREDITOS LIMITADACONALCREDITOS LTDA2^O^P^O/^_^A^A?^O^O\200^B^Yf\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
323302^C/COLARE TRADING COMPANY LIMITADACOLARE TRADINGCOMPA2^O^P^O/^_^A^A?^O^O\200^A!\221\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
323304^C/PRODUCTOS PLASTICOS JAC SASPRODUCTOS     PLASTICOS     2^O^P^O/^O^A^A?^O^O\220^F^G\222\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
110432^A^_IDEAR NEGOCIOS SASIDEARNEGOCIOS2^O^P^O/^_^A^A?^O^O\220^FT9_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
110434^A^_INVERSIONES MERC S.A.S.INVERSIONES   MERC SAS2^O^P^O/^_^A^A?^O^O\220^C8\204_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
190082^A\237MONTES GIRALDO ARISTIDESLA RONDA DEL  MUEBLE2^O^P^O/^_^A^A?^O^O^R6x\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323307^C/PRODEHOGAR  LTDAPRODEHOGAR    LTDA2^O^P^O/^_^A^A?^O^O\200^A6\226^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323308^C/AGRO REPUESTOS S.A.AGRO REPUESTOS1^O^P^O/^_^A^A?^O^O\211^C^Fr^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
090423\237CASTELLANOS GUARGUATI GERARDOCASTELLANOS   GUARGUAT2^O^P^O/^_^A^A?^O^O   ^QP^Ro500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280159^B\217AVELLANEDA CHIPATECUA HECTOR JOSECOLBISAGRAS1^O^P^O/^_^A^A?^O^O^B0\230^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
420169^D/TRANSMODAL EXPRESS S.A.S.TRASMODAL     EXPRESS2^A^R^A?^P^O/^_^A^A?^OAO\220^D^Y$^?500420140000000^A^B^A?00^O00000MN00000000^B^A@^_00NNSS^A^R^A?0S1N120131028SSSSS
SS0N
323310^C/PEREZ CORTES NELSON ANDRESALMACENES     ESPUMADOS     2^O^P^O/^_^A^A?^O^O^A^R^XRy^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280158^B\217INTERBOLSA SA SOCIEDAD ADMINISTRADORA DE INVERSIONINTERBOLSA SA1^O^P^O/^_^A^A?^O^O\201^P^U"^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323309^C/TITADSU SASTITADSO SAS1^O^P^O/^_^A^A?^O^O\220^A^Ue\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280157^B\217MAS FONDO SASMAS FONDO1^O^P^O/^_^A^A?^O^O\220^FU?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
160196^AoTERRANUM CORPORATIVO SASTERRANUM1^O^P^O/^_^A^A?^O^O\220^Av\220_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323313^C/PELAEZ ARIAS FABIO NELSONFERRETERIA LA REINA2^O^P^O/^_^A^A?^O^O^A^B\221%/500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323305^C/AGRICOMERCIAL SASAGRICOMERCIAL SAS2^O^P^O/^_^A^A?^O^O\220^E8cO500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323306^C/AYC SOLUCIONES INTELIGENTES SASA&C SOLUCIONESINTEL2^O^P^O/^_^A^A?^O^O\220^F^D^QO500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
190083^A\237FABRICLOSET Y COCINAS NEW CONCEPT SASFABRICLOSET1^O^P^O/^_^A^A?^O^O\220^DbuO500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323312^C/RODRIGUEZ GRACIA DIEGO ARMANDODIEGO ARODRIGUEZ     2^O^P^O/^_^A^A?^O^O^A^RuI?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
310117^C^_BURGOS ESTEBAN OMARPROALICOBURGOS1^O^P^O/^_^A^A?^O^O^H^Bii/500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323311^C/FANTASIA ELECTRONICA LTDAFANE SAS1^O^P^O/^_^A^A?^O^O\200^A\2024_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280160^B\217BANCOLOMBIA S.A.BANCOLOMBIA   VALORES2^O^P^O/^_^A^A?^O^O\211 ^C\223\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N

000001/JURIDICAL ADVISER COLOMBIA S.A.S.JURAD1^O^P^O/^_^A^A?^O^O\220^C^E"^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N320131028SSSSSSS2N
090424\237TODO COMERCIO DE CONFECCIONES S.ACONFE ESTUDIO MODA2^R^AO^P^O/^_^A^A?^O1O\200\2277?500320140000000^A^B^A?00^O00000MN00000000^B^A@^_00NNSS^R^AO0S1N120131028SSSSSSS0N

080286\217FONDO DE EMPLEADOS DENTSPLYFONDON DE     EMPLEADOS     2^O^P^O/^_^A^A?^O^O\203e^Y_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
220173^B/TRIANA LOZADA MARIA EUCARISQUINDIELECTRICOS ARS2^O^P^O/^_^A^A?^O^O^D^Y    \201^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323303^C/PRODUCTOS DIFFER S.A.PRODUCTOS     DIFFER S.A    2^O^P^O/^_^A^A?^O^O\220r\221O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323299^C/PINILLOS IBANEZ JHON ALEXANDERAARMONIA Y    DECORACIO     2^O^P^O/^_^A^A?^O^O^A^C^Bp\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323314^C/YEPES RENDON RODRIGOTIENDA ATIENDA SURT   2^O^P^O/^_^A^A?^O^O^A^Cf^F\225\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323316^C/BARRIOS SANTOFIMIO CESAR AUGUSTOCREDIBARRIOS1^A^B^A?^P^O/^_^A^A?^O^A^A?^Aa\207&\237501020130000000^A^B^A?00^O00000MN00000000^B^A1^O00NNSS^A^B^A?0S1N120131028S
SSSSSS0N
350140^C_MAKELO INVERSIONES S.A.SMAKELOINVERSIONES   2^O^P^O/^_^A^A?^O^O\220^ChE\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
110435^A^_OBRAJE S.A.S.OBRAJE SAS1^O^P^O/^_^A^A?^O^O\220^CU^A^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323315^C/LINEAL DE INVERSIONES SASLINEAL DE     INVERSIONE    22^AO^P^O/^_^A^A?^O1O\220^F^F1O500320140000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
110436^A^_ASERRIO MADECOL S.A.S.ASERRIOMADECOL SAS   2^O^P^O/^_^A^A?^O^O\220^C56_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323317^C/KOSBELL SASKOSBELL1^O^P^O/^_^A^A?^O^O\220^DG\202o500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
110438^A^_COBI COBERTURA INSTITUCIONAL S.A.SCOBI1^O^P^O/^_^A^A?^O^O\220^C\223t^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
380641^C\217MEDICAL SUPPLIES CORP S.A.SMEDICALSUPPLIES2^O^P^O/^_^A^A?^O^O\220^C^DUo500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
200043^B^OIH ADMINISTRACIONES Y SEGUROS S.A.S.IH ADMINISTRACIONES2B^AO^P^O/^_^A^A?^OAO\220^D^QG^?500420140000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
323322^C/INSUGRAS S.A.S.INSUGRAS SAS1^O^P^O/^_^A^A?^O^O\200P^V\211o500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
090426\237GONGORA GONZALEZ JAIRDKALIDADORIGINAL2^O^P^O/^_^A^A?^O^O^G\224\225\205^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
040328OLABORATORIO GLOBAL DIESEL J.L. EU.LABORATORIO   GLOBAL D2^O^P^O/^_^A^A?^O^O\220^B)w^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
110439^A^_AGENCIA DE ADUANAS PETRO CIA LTDA NIVEL 2PETROCIA LTDA1^O^P^O/^_^A^A?^O^O\203I\230?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
190084^A\237ARVANITIS S A SARVANITIS SAS1^O^P^O/^_^A^A?^O^O\220^D^X4^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
060583oASOCIACION COOPERATIVA DE LOS SUBOFICIALES DE LAS FUERZAACOOLSURE1^O^P^O/^_^A^A?^O^O\200e`^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
323327^C/CASTILLO GUTIERREZ LIMITADACAST GUTI SAS1^A^B^A?^P^O/^_^A^A?^OAO\200^P)\217500420140000000^A^B^A?00^O00000MN00000000^B^A1^O00NNSS^A^B^A?0S1N120131029SSSSS
SS0N
040329OVARGAS PUIN JOHON JAIRORINES Y LLANTAS BOYA2^O^P^O/^_^A^A?^O^O^A^B#7'\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
150279^A_CORPORACION PARA LA INVESTIGACION Y APLICACION DE CIENCICORCIENCIAS1^O^P^O/^O^A^A?^O^O\2010^Q&^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
430322^D?GRUPO EMPRESARIAL GUGA C.I. S.A.S.GRUPO EMPRESA RIAL GU2^O^P^O/^_^A^A?^O^O\220^CY\230\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
323319^C/MUNDIAL DE ALUMINIOS S.A.MUNDIAL DE    ALUMINIOS     2^O^P^O/^_^A^A?^O^O\206V&\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N/324188^C/HMY YUDIGAR COLOMBIA SASHMYYUDIGAR2^O^P^O/^_QO^O^O\220^F\2200o500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
110738^A^_BOTERO SALAZAR HECTOR FABIOCREDITOSPIEDRAHITA    2^O^P^O/^_QO^O^OCVc/500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
110739^A^_CORPORACION CLUB CAMPESTRECLUBCAMPESTRE     2^O^P^O/^_QO^O^O\211  \201\224^?500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
324192^C/GRUPO FORTIA SASGRUPO FORTIA1^O^P^O/^_QO^O^O\220^Fc5?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
430479^D?YAZO CASTA?EDA ANA LUCRECIACOLEGIOCARDENAL DUQUE2^O^P^O/^_QO^O^O^B \223Y_500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
110740^A^_INACE SASINACE SAS1^O^P^O/^_QO^O^O\220^D\220\237500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
324202^C/COMERCIAL AGRICOLA COAGRO SASCOAGRO SAS1^O^P^O/^_QO^O^O\220^D\211A?500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
160261^AoCRECIMIENTO INMOBILIARIO SASCRECIMIENTO   INMOBILIARIO  2^O^P^O/^_QO^O^O\220^DQo500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
324177^C/ELDORADO BUSINESS CENTER SASELDORADOBUSINESS2^O^P^O/^_QO^O^O\220^Ef^X\217500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
324175^C/CONSTRUEQUIPOS FRANCO SASCONSTRUEQUIPOSFRANCO2^O^P^O/^_QO^O^O\220^E\225Eo500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
324201^C/HERNANDEZ DE FLOREZ FANNYLA ESPAÑOLA1^O^P^O/^_QO^O^O^B\2055^QO500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140520SSSSSSS0N
324205^C/SERVICIO DE REPARACION J J   TORRES EMPRESA UNIPERSONAL J J TORRES1^O^P^O/^_QO^O^O\203R&O500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
061084oCOOPERATIVA  MULTIACTIVA  DE  SERVICIOS  COOPGAMARR     COOPGAMARR1^O^P^O/^_QO^O^O\220^Cht?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
324204^C/BEJARANO CASTRO EDGAR AUGUSTOGRAFI GLASS1^O^P^O/^_QO^O^O^G\224V\221^_500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
310141^C^_FRUTIDELICIAS Y COMPA?IA  S A SFRUTIDELICIAS Y CIA2^O^P^O/^_QO^O^O\200)\203o500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
324203^C/MURILLO SAEZ ELIZABETHCOMERCIALIZADORA BGB  2^O^P^O/^_QO^O^O^FV\226R^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140520SSSSSSS0N
430477^D?ACADEMIA DE ESTUDIOS TECNICOS Y CRIMINALISTICOS SCOTLANDACADEMIASCOTLAND YARD 2^O^P^O/^_QO^O^O\200P)\203_500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140521SSSSSSS0N
324206^C/PROGRESO FINANCIERO COLOMBIA S A SDIEGO CRISTIAN1^O^P^O/^_QO^O^O\220^G^W#/500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140521SSSSSSS0N
324210^C/TECNIFORMAS PLASTICAS LTDATECNIFORMAS   PLASTICAS     2^O^P^O/^_QO^O^O\220^B2\201^O500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140521SSSSSSS0N
324213^C/RODRIGUEZ ACERO CARLOS ALBERTOELECTROMUEBLES FUNZA 2^O^P^O/^_QO^O^O^H^FUvO500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140521SSSSSSS0N
324209^C/ALVIS LOPEZ ALBA NANCYINSUMOS Y SERVCACAYAL2^O^P^O/^_QO^O^O^D^CV\211O500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140521SSSSSSS0N
324211^C/CHEVROLET E ISUZU 580 LTDACHEVROLET E   ISUZU 580 LTDA2^O^P^O/^_QO^O^O\200^Aug_500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140521SSSSSSS0N
324214^C/RODRIGUEZ LEON WILSONCOMERCIALI    ZADORA CRECER 2^O^P^O/^_QO^O^O^G\230Er?500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140521SSSSSSS0N
324212^C/ALMACENADORA INTERNACIONAL DE CARGA ALMINCARGA S.A.     ALMINCARGA SA1^O^P^O/^_QO^O^O\200^Adxo500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140521SSSSSSS0N
220214^B/PEREZ SANCHEZ LUIS RAFAELELECTRODOMEST LADIMAR2^O^P^O/^_QO^O^OB^Pqo500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140521SSSSSSS0N
324208^C/FABRIFOLDER S.A.S.FABRIFOLDER1^O^P^O/^_QO^O^O\200^AY7o500000000000000R^AO00^O00000MN00000000^O00NNSS2^A^O0S1N320140521SSSSSSS0N
061085oCOOPERATIVA DE TRABAJO ASOCIADO DE VIGILANCIA Y SEGURIDACOOVICOMBEIMA1^O^P^O/^_QO^O^O\200^Ay!\217500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324215^C/NARVAEZ JURADO ROSA MARIACABRERAHERMANOS2^O^P^O/^_QO^O^O^BrC^P\217500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324216^C/LEON URQUIJO HECTOR MANUELHM LEONMUEBLES2^O^P^O/^_QO^O^O^A\222Xs/500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324219^C/TRUJILLO GONZALEZ JESUS ANDRESATGDISTRIBUCIONES2^O^P^O/^_QO^O^O^H^A^X^So500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
270351^B^?GRUPO EMPRESARIAL SINERGIAS SASSYNERGIES SAS1^O^P^O/^_QO^O^O\220^F9a\237500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
110741^A^_GRUPO JURIDICO ALIANZA ESTRATEGICA SASALIANZAESTRATEGICA   2^O^P^O/^_QO^O^O\220^G^TuO500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
110742^A^_GESTION FIDUCIARIA S.A.FAPCATESORAR2^O^P^O/^OQO^O^O\220^C"3\237500000000000000R^AO02^O00000MN00000000^O00NNSN^O0S1N120140524SSSSSSS0N
324221^C/NATUR PRODUKT LTDANATURPRODUKT2^O^P^O/^_QO^O^O\200P^R    ^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324218^C/INDUSTRIA DE RUEDAS LIMITADAINDUSTRIA DE  RUEDAS LTDA   2^O^P^O/^_QO^O^O\211^B^G\225o500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
080439\217FONDO DE EMPLEADOS DE FLORES TIBA S.A.  FEFLORALFEFLORAL1^O^P^O/^_QO^O^O\206^E$^C?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324217^C/OPCIONES TECNOLOGICAS LTDAOPCIONESTECNOLOGICAS  2^O^P^O/^_QO^O^O\220X0o500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324220^C/HERRERA LOZANO HUGO GERMANRUANATEX1^O^P^O/^_QO^O^O^At^Rw^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
430481^D?HOLGUIN PALACIOS ANA YOLIMACOLEGIOAVENTURAS     2^O^P^O/^_QO^O^O^D^Sf ^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324222^C/GRAN DISTRIBUIDORA CONTINENTAL S A SGRAN DISTRIBUIDOR CONTINENTA2^O^P^O/^_QO^O^O\220^A7\203o500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
430482^D?VARGAS GARCIA MARGARITA ROSACHIQUIPLAY1^O^P^O/^_QO^O^O^E!^RY^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324223^C/SANABRIA ORJUELA MIGUEL ANGELINSUMOS AGRICOLAS BIOCAMPO  2^O^P^O/^_QO^O^O^H#\2223\217500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324224^C/SURTICAMPO S.A.SURTICAMPO1^O^P^O/^_QO^O^O\2004aO500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
310142^C^_JANNA FOODS SASJANNA FOODS   SAS2^O^P^O/^_QO^O^O\220^D)2O500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324225^C/BONILLA ROCHA DIEGO FERNANDOINMOBILIARIA  DIEGO BONILLA 2^O^P^O/^_QO^O^OX(w\217500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324226^C/MINIMARKET SALUD LTDAMINIMARKET    SALUD LTDA    2^O^P^O/^_QO^O^O\220^AF&O500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324227^C/TIPOGRAFIA Y LITOGRAFIA ARTE CLASICO SASTIPOGRAFIA Y  LITOGRAFIA    2^O^P^O/^_QO^O^O\220^G&5^O500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
440322^DOALIANZAS EFECTIVAS SASALIANZASEFECTIVAS SAS 2^O^P^O/^_QO^O^O\220^E5X^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140522SSSSSSS0N
324171^C/CLIP CLAP S.A.S.CLIP CLAP1^O^P^O/^_QO^O^O\220^G^HEO500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
150314^A_LIVIANOS S.A.SLIVIANOS SAS1^O^P^O/^_QO^O^O\220^D^Xa^_500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
430483^D?DANIES TORRES INGRID MARINACOLEGIOGIMNASIO JEAN 2^O^P^O/^_QO^O^O^CecR_500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
160263^AoCENTRO INTELIGENTE DE NEGOCIOS "OFFINET" SASOFFINET SAS1^O^P^O/^_QO^O^O\220^D$\210\237500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
110743^A^_SERVICIOS A FUNCIONARIOS DE COLOMBIA SASSERFUNCOL1^O^P^O/^_QO^O^O\220^G'e\217500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
061086oCOOPERATIVA MULTIACTIVA DE PENSIONADOS DE TELECARTAGENA COOTRATELCAR1^O^P^O/^_QO^O^O\211^D\200A/500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
340075^COOZALID S.A.OZALID SAS1^O^P^O/^_QO^O^O\206^E^V4\217500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N
324231^C/PARRA CARDE?O DARIO ALFONSOQUIMICOSDEL CARIBE    2^O^P^O/^_QO^O^O\202\201I^?500000000000000R^AO00^O00000MN00000000^O00NNSN^O0S1N120140523SSSSSSS0N/Address search hit BOTTOM without matching pattern?110433^A^_COBRANZA NACIONAL DE CREDITOS LIMITADACONALCREDITOS LTDA2^O^P^O/^_^A^A?^O^O\200^B^Yf\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
323302^C/COLARE TRADING COMPANY LIMITADACOLARE TRADINGCOMPA2^O^P^O/^_^A^A?^O^O\200^A!\221\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
323304^C/PRODUCTOS PLASTICOS JAC SASPRODUCTOS     PLASTICOS     2^O^P^O/^O^A^A?^O^O\220^F^G\222\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
110432^A^_IDEAR NEGOCIOS SASIDEARNEGOCIOS2^O^P^O/^_^A^A?^O^O\220^FT9_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131026SSSSSSS0N
110434^A^_INVERSIONES MERC S.A.S.INVERSIONES   MERC SAS2^O^P^O/^_^A^A?^O^O\220^C8\204_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
190082^A\237MONTES GIRALDO ARISTIDESLA RONDA DEL  MUEBLE2^O^P^O/^_^A^A?^O^O^R6x\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323307^C/PRODEHOGAR  LTDAPRODEHOGAR    LTDA2^O^P^O/^_^A^A?^O^O\200^A6\226^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323308^C/AGRO REPUESTOS S.A.AGRO REPUESTOS1^O^P^O/^_^A^A?^O^O\211^C^Fr^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
090423\237CASTELLANOS GUARGUATI GERARDOCASTELLANOS   GUARGUAT2^O^P^O/^_^A^A?^O^O   ^QP^Ro500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280159^B\217AVELLANEDA CHIPATECUA HECTOR JOSECOLBISAGRAS1^O^P^O/^_^A^A?^O^O^B0\230^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
420169^D/TRANSMODAL EXPRESS S.A.S.TRASMODAL     EXPRESS2^A^R^A?^P^O/^_^A^A?^OAO\220^D^Y$^?500420140000000^A^B^A?00^O00000MN00000000^B^A@^_00NNSS^A^R^A?0S1N120131028SSSSS
SS0N
323310^C/PEREZ CORTES NELSON ANDRESALMACENES     ESPUMADOS     2^O^P^O/^_^A^A?^O^O^A^R^XRy^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280158^B\217INTERBOLSA SA SOCIEDAD ADMINISTRADORA DE INVERSIONINTERBOLSA SA1^O^P^O/^_^A^A?^O^O\201^P^U"^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323309^C/TITADSU SASTITADSO SAS1^O^P^O/^_^A^A?^O^O\220^A^Ue\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280157^B\217MAS FONDO SASMAS FONDO1^O^P^O/^_^A^A?^O^O\220^FU?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
160196^AoTERRANUM CORPORATIVO SASTERRANUM1^O^P^O/^_^A^A?^O^O\220^Av\220_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323313^C/PELAEZ ARIAS FABIO NELSONFERRETERIA LA REINA2^O^P^O/^_^A^A?^O^O^A^B\221%/500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323305^C/AGRICOMERCIAL SASAGRICOMERCIAL SAS2^O^P^O/^_^A^A?^O^O\220^E8cO500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323306^C/AYC SOLUCIONES INTELIGENTES SASA&C SOLUCIONESINTEL2^O^P^O/^_^A^A?^O^O\220^F^D^QO500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
190083^A\237FABRICLOSET Y COCINAS NEW CONCEPT SASFABRICLOSET1^O^P^O/^_^A^A?^O^O\220^DbuO500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323312^C/RODRIGUEZ GRACIA DIEGO ARMANDODIEGO ARODRIGUEZ     2^O^P^O/^_^A^A?^O^O^A^RuI?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
310117^C^_BURGOS ESTEBAN OMARPROALICOBURGOS1^O^P^O/^_^A^A?^O^O^H^Bii/500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323311^C/FANTASIA ELECTRONICA LTDAFANE SAS1^O^P^O/^_^A^A?^O^O\200^A\2024_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
280160^B\217BANCOLOMBIA S.A.BANCOLOMBIA   VALORES2^O^P^O/^_^A^A?^O^O\211 ^C\223\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N

000001/JURIDICAL ADVISER COLOMBIA S.A.S.JURAD1^O^P^O/^_^A^A?^O^O\220^C^E"^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N320131028SSSSSSS2N
090424\237TODO COMERCIO DE CONFECCIONES S.ACONFE ESTUDIO MODA2^R^AO^P^O/^_^A^A?^O1O\200\2277?500320140000000^A^B^A?00^O00000MN00000000^B^A@^_00NNSS^R^AO0S1N120131028SSSSSSS0N

080286\217FONDO DE EMPLEADOS DENTSPLYFONDON DE     EMPLEADOS     2^O^P^O/^_^A^A?^O^O\203e^Y_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
220173^B/TRIANA LOZADA MARIA EUCARISQUINDIELECTRICOS ARS2^O^P^O/^_^A^A?^O^O^D^Y    \201^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323303^C/PRODUCTOS DIFFER S.A.PRODUCTOS     DIFFER S.A    2^O^P^O/^_^A^A?^O^O\220r\221O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323299^C/PINILLOS IBANEZ JHON ALEXANDERAARMONIA Y    DECORACIO     2^O^P^O/^_^A^A?^O^O^A^C^Bp\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323314^C/YEPES RENDON RODRIGOTIENDA ATIENDA SURT   2^O^P^O/^_^A^A?^O^O^A^Cf^F\225\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323316^C/BARRIOS SANTOFIMIO CESAR AUGUSTOCREDIBARRIOS1^A^B^A?^P^O/^_^A^A?^O^A^A?^Aa\207&\237501020130000000^A^B^A?00^O00000MN00000000^B^A1^O00NNSS^A^B^A?0S1N120131028S
SSSSSS0N
350140^C_MAKELO INVERSIONES S.A.SMAKELOINVERSIONES   2^O^P^O/^_^A^A?^O^O\220^ChE\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
110435^A^_OBRAJE S.A.S.OBRAJE SAS1^O^P^O/^_^A^A?^O^O\220^CU^A^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323315^C/LINEAL DE INVERSIONES SASLINEAL DE     INVERSIONE    22^AO^P^O/^_^A^A?^O1O\220^F^F1O500320140000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
110436^A^_ASERRIO MADECOL S.A.S.ASERRIOMADECOL SAS   2^O^P^O/^_^A^A?^O^O\220^C56_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
323317^C/KOSBELL SASKOSBELL1^O^P^O/^_^A^A?^O^O\220^DG\202o500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131028SSSSSSS0N
110438^A^_COBI COBERTURA INSTITUCIONAL S.A.SCOBI1^O^P^O/^_^A^A?^O^O\220^C\223t^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
380641^C\217MEDICAL SUPPLIES CORP S.A.SMEDICALSUPPLIES2^O^P^O/^_^A^A?^O^O\220^C^DUo500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
200043^B^OIH ADMINISTRACIONES Y SEGUROS S.A.S.IH ADMINISTRACIONES2B^AO^P^O/^_^A^A?^OAO\220^D^QG^?500420140000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
323322^C/INSUGRAS S.A.S.INSUGRAS SAS1^O^P^O/^_^A^A?^O^O\200P^V\211o500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
090426\237GONGORA GONZALEZ JAIRDKALIDADORIGINAL2^O^P^O/^_^A^A?^O^O^G\224\225\205^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
040328OLABORATORIO GLOBAL DIESEL J.L. EU.LABORATORIO   GLOBAL D2^O^P^O/^_^A^A?^O^O\220^B)w^O500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
110439^A^_AGENCIA DE ADUANAS PETRO CIA LTDA NIVEL 2PETROCIA LTDA1^O^P^O/^_^A^A?^O^O\203I\230?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
190084^A\237ARVANITIS S A SARVANITIS SAS1^O^P^O/^_^A^A?^O^O\220^D^X4^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
060583oASOCIACION COOPERATIVA DE LOS SUBOFICIALES DE LAS FUERZAACOOLSURE1^O^P^O/^_^A^A?^O^O\200e`^?500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
323327^C/CASTILLO GUTIERREZ LIMITADACAST GUTI SAS1^A^B^A?^P^O/^_^A^A?^OAO\200^P)\217500420140000000^A^B^A?00^O00000MN00000000^B^A1^O00NNSS^A^B^A?0S1N120131029SSSSS
SS0N
040329OVARGAS PUIN JOHON JAIRORINES Y LLANTAS BOYA2^O^P^O/^_^A^A?^O^O^A^B#7'\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
150279^A_CORPORACION PARA LA INVESTIGACION Y APLICACION DE CIENCICORCIENCIAS1^O^P^O/^O^A^A?^O^O\2010^Q&^_500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
430322^D?GRUPO EMPRESARIAL GUGA C.I. S.A.S.GRUPO EMPRESA RIAL GU2^O^P^O/^_^A^A?^O^O\220^CY\230\217500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N
323319^C/MUNDIAL DE ALUMINIOS S.A.MUNDIAL DE    ALUMINIOS     2^O^P^O/^_^A^A?^O^O\206V&\237500000000000000^A^B^A?00^O00000MN00000000^O00NNSN^O0S1N120131029SSSSSSS0N:q/d/iccol/desarrollo/database/prunovedat>^D
