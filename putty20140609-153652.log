=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.09 15:36:52 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Mon Jun  9 09:24:24 2014 from 172.16.10.15
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ .viset
ksh: .viset:  not found
icjlud@codes /d/iccol/desarrollo
$ co
icjlud@codes /d/iccol/desarrollo/copys
$ vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~!grep -il 1000-U-RECORRER-CSV-BDAMATCH *.PROC *.procBDAMATCH.PROC
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC24 more lines:w ^?^?"^?^?" [New file] 25 lines, 473 characters :r BDAMATCH.PROC"BDAMATCH.PROC" 1201 lines, 77406 characters 
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK*             *MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK*             *NUM-CTAS-OUTPUT-BDAMATCH
REMARK*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK*             *BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK*             *DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************

 1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************
 MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
C BDAMATCH.PROC/1000-U-RECORRER-CSV-BDAMATCH1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHEND-IF.
INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVINVALID KEY
MOVE 1 TO FIN-BDAMATCHNOT INVALID KEY
READ BDACSV IGNORE LOCK NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READEND-START.
PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
NUM-IDE-INPUT-BDAMATCH  OR
TIPO-ID-BDACSV  NOT =
TIP-IDE-INPUT-BDAMATCHMOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDAMATCHNOT INVALID KEY
FUEN01MOVE 1 TO PROCESAR-BDAMATCHRMB0004END-READ
BLOQ01IF PROCESAR-BDAMATCH = 1RMB0004
BLOQ01IF ESTADO-ABD02 = 1RMB0004
BLOQ01IF IND-BLOQUEO-BDACSV <> "B"RMB0004
BLOQ01MOVE 1 TO PROCESAR-BDAMATCHRMB0004
FUEN01IF FUENTE-REG-BDACSV <= 01RMB0004
FUEN01PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004
FUEN01ELSERMB0004
FUEN01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
FUEN01END-IFRMB000411FUEN01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
FUEN01END-IFRMB0004
FUEN01ELSERMB0004
BLOQ01MOVE 0 TO PROCESAR-BDAMATCHRMB0004
BLOQ01END-IFRMB0004
BLOQ01ELSERMB0004
BLOQ01MOVE 0 TO PROCESAR-BDAMATCHRMB0004
BLOQ01END-IFRMB0004
BLOQ01END-IFRMB0004IF PROCESAR-BDAMATCH = 1PERFORM 1200-PROC-REG-CSV-BDAMATCHEND-IF
READ BDACSV IGNORE LOCK   NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READ
LIMI01IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
LIMI01MOVE 1 TO FIN-BDAMATCH*> SE ABLIGA A TIPRMB0004
LIMI01MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y   RMB0004
LIMI01MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
LIMI01END-IFRMB0004END-PERFORM.
IF MAX-CUENTAS-BDAMATCH > 0
APEL01IF APELLIDO-INPUT-BDAMATCH <> SPACES ANDRMB0004
APEL01MAX-CUENTAS-BDAMATCH > 1RMB0004
APEL01PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004
APEL01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
APEL01PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004
APEL01END-IFRMB0004PERFORM 9000-U-REALIZAR-BDAMATCH
NOMB01IF NOM-OUTPUT-BDAMATCH <> SPACES ANDRMB0004
NOMB01(TIP-IDE-INPUT-BDAMATCH = 1 OR 4)RMB0004
NOMB01MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004
NOMB01PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004
NOMB01MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004
NOMB01END-IFRMB0004IF NOM-OUTPUT-BDAMATCH <> SPACESMOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF.
NOMB01 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004
NOMB01     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
NOMB01     MOVE 0 TO I-MAQRMB0004
NOMB01     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
NOMB01INITIAL "Y/O"RMB0004
NOMB01OR"Y\O"RMB0004
NOMB01OR" Y/OTRO "RMB0004
NOMB01OR" Y/OTRA "RMB0004
NOMB01OR" Y\OTRO "RMB0004NOMB01OR" Y/OTRA "RMB0004
NOMB01OR" Y\OTRO "RMB0004
NOMB01OR" Y\OTRA "RMB0004
NOMB01OR" Y OTRO "RMB0004
NOMB01OR" Y OTRA "RMB0004
NOMB01     IF I-MAQ < 45 AND I-MAQ > 2RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01     ELSERMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)RMB0004
NOMB01END-IFRMB0004
NOMB01     END-IFRMB0004
NOMB01     MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01     MOVE 1 TO I-MAQ.RMB0004
NOMB01     PERFORM UNTIL I-MAQ > 45RMB0004
NOMB01MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQRMB0004
NOMB01IF TILDE-MAQRMB0004
NOMB01PERFORM 1000-CAMBIAR-TILDE-MAQRMB0004
NOMB01MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)RMB0004
NOMB01END-IFRMB0004
NOMB01IF FUNCTION ORD(ACTUAL-MAQ) < 31RMB0004
NOMB01MOVE "." TO ACTUAL-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01MOVE " " TO ANT-MAQRMB0004
NOMB01IF I-MAQ > 1RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ - 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01MOVE " " TO SIG-MAQRMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01IF ACTUAL-MAQ = ")"RMB0004
NOMB01MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01IF SW-BORRAR-MAQ = 0RMB0004
NOMB01IF ELIMINAR-MAQRMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01IF I-MAQ > 1RMB0004
NOMB01MOVE 1 TO SW-BORRAR-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01IF BORRAR-MAQRMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01ELSERMB0004
NOMB01IF QUITAR-MAQRMB0004NOMB01ELSERMB0004
NOMB01IF QUITAR-MAQRMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01COMPUTE I-MAQ = I-MAQ - 1RMB0004
NOMB01ELSERMB0004
NOMB01IF VALIDO-MAQRMB0004
NOMB01CONTINUERMB0004
NOMB01ELSERMB0004
NOMB01IF ANT-MAQ = "N" AND SIG-VOCAL-MAQRMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01COMPUTE I-MAQ = I-MAQ - 1RMB0004
NOMB01ELSERMB0004
NOMB01IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
NOMB01(ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
NOMB01IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01ELSERMB0004
NOMB01MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01IF NOT ANT-VOCAL-MAQ ANDRMB0004
NOMB01SIG-VOCAL-MAQRMB0004
NOMB01MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01ELSERMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01END-IFRMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01     END-PERFORM.RMB0004
NOMB01     INITIALIZE PARTICULAS-INPMAQRMB0004
NOMB01     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "RMB0004
NOMB01INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
NOMB01P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
NOMB01P10-INPMAQRMB0004
NOMB01     MOVE SPACES TO NOMBRE-OUTMAQ-OKRMB0004NOMB01P10-INPMAQRMB0004
NOMB01     MOVE SPACES TO NOMBRE-OUTMAQ-OKRMB0004
NOMB01     STRING P1-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P2-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P3-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P4-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P5-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P6-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P7-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P8-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P9-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P10-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01INTO NOMBRE-OUTMAQ-OK.RMB0004
NOMB01INSPECT NOMBRE-OUTMAQ-OKRMB0004
NOMB01REPLACING ALL  " PE A " BY " PENA ".RMB0004
NOMB01  1000-CAMBIAR-TILDE-MAQ.RMB0004
NOMB01EVALUATE ACTUAL-MAQRMB0004
NOMB01WHEN "Á"RMB0004
NOMB01MOVE "A" TO ACTUAL-MAQRMB0004
NOMB01WHEN "É"RMB0004
NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Í"RMB0004
NOMB01MOVE "I" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ó"RMB0004
NOMB01MOVE "O" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ú"RMB0004
NOMB01MOVE "U" TO ACTUAL-MAQRMB0004
NOMB01WHEN "á"RMB0004
NOMB01MOVE "A" TO ACTUAL-MAQRMB0004
NOMB01WHEN "é"RMB0004
NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "í"RMB0004
NOMB01MOVE "I" TO ACTUAL-MAQRMB0004
NOMB01WHEN "ó"RMB0004
NOMB01MOVE "O" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ú"RMB0004
NOMB01MOVE "U" TO ACTUAL-MAQRMB0004
NOMB01END-EVALUATE.RMB0004
APEL01 1100-LLENAR-CSV-APE-BDAMATCH.RMB0004NOMB01END-EVALUATE.RMB0004
APEL01 1100-LLENAR-CSV-APE-BDAMATCH.RMB0004
APEL01     INITIALIZE REG-BDACSVRMB0004
APEL01     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSVRMB0004
APEL01     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSVRMB0004
APEL01     MOVE 980001TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
APEL01     MOVE 02TO  COD-CTA-BDACSVRMB0004
APEL01     MOVE "APELLID-01"   TO  NUM-CTA-BDACSVRMB0004
APEL01     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSVRMB0004
APEL01     MOVE ".-,"TO  NOMBRE-BDACSV(43:3)RMB0004
APEL01     MOVE 20110801TO  FECHA-CREA-BDACSVRMB0004
APEL01     MOVE 0TO  NUM-PORTAF-BDACSVRMB0004
APEL01     MOVE 0TO  IND-NOMBRE-BDACSVRMB0004
APEL01     MOVE 0TO  MEJOR-PORTAF-BDACSVRMB0004
APEL01     MOVE 0TO  IND-ACTUALIZ-BDACSVRMB0004
APEL01     MOVE 01TO  FUENTE-REG-BDACSV.RMB0004
APEL01 1100-LLENAR-AUX-BDAMATCH.RMB0004
REMARK***********************************************************************
REMARK*1100-LLENAR-AUX-BDAMATCH.
REMARK* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE
REMARK* TAMAÑO
REMARK***********************************************************************
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE 0 TO FALLECIDO-BDAMATCH.RMB0004
1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
REMARK* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
REMARK***********************************************************************MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
VIGE01     MOVE 0 TO FALLECIDO-BDAMATCHRMB0003IF COD-CTA-BDACSV = 01 OR 51MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECKREAD MAESTRO-CHECK IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
BLOQ01IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)RMB0004
SINBLQAND CONSECUTIVO-ABD06 = 1
VIGE01IF ADJETIVO-ABD06 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
SINBLQELSERMB0003
SINBLQMOVE 0 TO PROCESAR-BDAMATCHRMB0003
SINBLQEND-IFRMB0003
SINBLQEND-READ
ELSE
MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDITREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
BLOQ01IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)RMB0004
SINBLQAND CONSECUTIVO-ABD07 = 1
VIGE01IF ADJETIVO1-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO2-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO3-ABD07 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
SINBLQELSERMB0003
SINBLQMOVE 0 TO PROCESAR-BDAMATCHRMB0003
VIGE01END-IFRMB0003END-READ
END-IF.1200-PROC-REG-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1200-PROC-REG-CSV-BDAMATCH.
REMARK* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
REMARK* SI LO HAY
REMARK***********************************************************************IF MAX-CUENTAS-BDAMATCH = 0PERFORM 1000-U-INICIALIZAR-BDAMATCHEND-IF.
MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLMPERFORM 2000-U-INSERTAR-CTA-BDAMATCH.MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.READ MAESTRO-DIRECC IGNORE LOCK
MEJO01*NOT INVALID KEYRMB0004
MEJO01*PERFORM 1210-DIRTEL-BDACSV-BDAMATCHRMB0004
MEJO01INVALID KEYRMB0004
MEJO01MOVE SPACES TO LLAVE-DIRECCRMB0004END-READ.
MEJO01     IF LLAVE-DIRECC <> SPACESRMB0004
MEJO01PERFORM 1210-DIRTEL-BDACSV-BDAMATCHRMB0004
MEJO01     END-IF.RMB00041210-DIRTEL-BDACSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.
REMARK* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
REMARK* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
REMARK***********************************************************************IF CIURES-DIRECC NOT = SPACESIF DIRRES-DIRECC NOT = SPACESMOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELRES-DIRECC > 0 ANDTELRES-DIRECC < 9999999999MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIULAB-DIRECC NOT = SPACESIF DIRLAB-DIRECC NOT = SPACESMOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELLAB-DIRECC > 0 ANDTELLAB-DIRECC < 9999999999MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIUCOR-DIRECC NOT = SPACES ANDDIRCOR-DIRECC NOT = SPACESMOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF.8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9MOVE 0 TO IND-BLOQUEO-ABD07END-IF
END-IF.8000-U-VER-CTAABD06-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD06-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9MOVE 0 TO IND-BLOQUEO-ABD06END-IF
END-IF.

REMARK*======================================================================
1000-U-INICIALIZAR-BDAMATCH.
REMARK********************************************************************
REMARK*1000-U-INICIALIZAR-BDAMATCH.
REMARK* INPUT = VACIO
REMARK* OUTPUT= VACIO
REMARK* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
REMARK* DEl MATCH.
REMARK********************************************************************MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.MOVE 0 TO I-CTA-BDAMATCH.
PESO01     INITIALIZE TABLA-CUENTAS-BDAMATCH.RMB0004INITIALIZE TABLA-DIR-BDAMATCH.INITIALIZE TABLA-TEL-BDAMATCH.INITIALIZE TABLA-NOM-BDAMATCH.INITIALIZE TABLA-GRUNOM-BDAMATCH.INITIALIZE V-INTERRELAC-BDAMATCH.MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.2000-U-INSERTAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-DIR-BDAMATCH.
REMARK* INPUT = DIR-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
REMARK* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
REMARK* LA DIRECCION CONTENGA ALGUN NUMERO
REMARK********************************************************************MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.MOVE 1 TO I-BDAMATCHMOVE 0 TO J-BDAMATCHMOVE " " TO CAR-ANT-BDAMATCHINITIALIZE T-CARTOT-BDAMATCH
CARTOT     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10CAV0002IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERICMOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCHIF CAR-ANT-BDAMATCH   NUMERICCOMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)= V-CARTOT-BDAMATCH  (J-BDAMATCH)* 10 + CAR-ACT-BDAMATCHELSE
ADD 1 TO J-BDAMATCH
MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)TO V-CARTOT-BDAMATCH  (J-BDAMATCH)END-IF
END-IF
MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCHADD 1 TO I-BDAMATCHEND-PERFORM.
SORT V-CARTOT-BDAMATCH   DESCENDING.IF T-CARTOT-BDAMATCH   NOT = ZEROS ANDI-DIR-BDAMATCH < LIM-BDAMATCHMOVE T-CARTOT-BDAMATCH TO
NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TOSUS-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1UNTIL  POSIC-SUMA-BDAMATCH  >  10 ORV-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZEROADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)END-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-IF.2000-U-INSERTAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-TEL-BDAMATCH.
REMARK* INPUT = TEL-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
REMARK********************************************************************IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0MOVE TEL-INPUT-BDAMATCH TO
NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TO
SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE I-CTA-BDAMATCH     TO
CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)ADD 1 TO I-TEL-BDAMATCHEND-IF.2000-U-INSERTAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-NOM-BDAMATCH.
REMARK* INPUT = NOM-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-NOM-BDAMATCH < LIM-BDAMATCH ANDNOM-INPUT-BDAMATCH <> SPACESMOVE NOM-INPUT-BDAMATCH  TONOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
NOM-LIMPI-BDAMATCHMOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCHNRO-VECES-2-BDAMATCHPERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1UNTIL  NRO-VECES-1-BDAMATCH  >  60IF NRO-VECES-1-BDAMATCH  >  1 ANDNOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCHEND-IF
IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "COMPUTE  NRO-VECES-2-BDAMATCH =
60 - NRO-VECES-1-BDAMATCHMOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH) = SPACESMOVE  85TO  NRO-VECES-1-BDAMATCHEND-IF
END-IF
END-PERFORM
INSPECT NOM-LIMPI-BDAMATCH
TALLYINGPESO-CTAS-TOT-BDAMATCHFOR CHARACTERS BEFORE INITIAL " "MOVE  PESO-CTAS-TOT-BDAMATCH TOLNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
FUEN01IF FUENTE-REG-BDACSV >= 02RMB0004
FUEN01MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)RMB0004
FUEN01END-IFRMB0004MOVE  SUSC-CTAS-BDAMATCH TO
SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCHEND-IF.2000-U-INSERTAR-CTA-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-CTA-BDAMATCH.
REMARK* INPUT = CTA-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-CTA-BDAMATCH < LIM-BDAMATCH ANDCTA-INPUT-BDAMATCH <> SPACESADD 1 TO I-CTA-BDAMATCHMOVE CTA-INPUT-BDAMATCH TOCTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
VIGE01MOVE FALLECIDO-BDAMATCH TORMB0003
VIGE01CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)RMB0003
FUEN01IF FUENTE-REG-BDACSV >= 2RMB0004
FUEN01MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)RMB0004
FUEN01END-IFRMB0004END-IF.
3000-U-ORDENAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-DIR-BDAMATCH.
REMARK* INPUT = TABLA DE DIRECCIONES LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
REMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTOREMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-DIR-BDAMATCH
DESCENDING NUM-DIR-BDAMATCHASCENDING  CTA-DIR-BDAMATCH.MOVE 1 TO I-CTA-BDAMATCH.MOVE 0 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-DIR-ANT-BDAMATCHMOVE ALL "9"TO NUM-DIR-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0IF NUM-DIR-ANT-BDAMATCH <>
NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE  I-CTA-BDAMATCHTO  POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-DIR-ANT-BDAMATCH <>CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-DIR-ANT-BDAMATCHMOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-DIR-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.
REMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
REMARK* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-TEL-BDAMATCH
DESCENDING NUM-TEL-BDAMATCHASCENDING  CTA-TEL-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-TEL-ANT-BDAMATCHMOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0OR  FIL-FUE-BDAMATCH > LIM-BDAMATCHOR  COL-FUE-BDAMATCH > LIM-BDAMATCHIF NUM-TEL-ANT-BDAMATCH <>NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-TEL-ANT-BDAMATCH <>CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-TEL-ANT-BDAMATCHMOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-TEL-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-NOM-BDAMATCH.
REMARK* INPUT = TABLA DE NOMBRES     LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
REMARK* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-NOM-BDAMATCH.MOVE 1 TO GRU-NOM-BDAMATCH.MOVE GRU-NOM-BDAMATCH TOGRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).MOVE GRU-NOM-BDAMATCH TOGRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TOSUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TOSUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCH.PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0MOVE 1 TO I-GRU-BDAMATCHMOVE 0 TO MATCH-OK-OUT-VALNOMPERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCHOR MATCH-OK-OUT-VALNOM = 1MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOMBRE-INPUT-VALNOMMOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TONOMBOK-INPUT-VALNOM
VLNIT1IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3RMB0004
VLNIT1IF NUM-IDE-INPUT-BDAMATCH >= 600000000 ANDRMB0004
VLNIT1NUM-IDE-INPUT-BDAMATCH <= 999999999RMB0004
VLNIT1MOVE 2 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 1 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1ELSERMB0004
VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1END-IFRMB0004
VLNIT1ELSERMB0004
VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1END-IFRMB0004
APEL01IF NOMBRE-INPUT-VALNOM(43:3) = ".-," ORRMB0004
APEL01NOMBOK-INPUT-VALNOM(43:3) = ".-,"RMB0004
APEL01MOVE 1 TO BLOQUES-INPUT-VALNOMRMB0004
APEL01END-IFRMB0004PERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1MOVE I-GRU-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCH
APEL01IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDORMB0004
APEL01MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
APEL01END-IFRMB0004PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1
ADD   1  TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
PESO01MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TORMB0004
PESO01NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)RMB0004END-IF
END-IF
ADD 1 TO I-GRU-BDAMATCHEND-PERFORM
IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPOADD 1 TO GRU-NOM-BDAMATCHMOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLMMOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1   TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))ADD   1   TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ELSE*>MOVE GRU-NOM-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLMEND-IF
ADD 1 TO I-NOM-BDAMATCHEND-PERFORM.
SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING GRU-NOMS-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-NOM-ANT-BDAMATCHMOVE ALL "9"TO GRU-NOM-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0OR FIL-FUE-BDAMATCH > LIM-BDAMATCHOR COL-FUE-BDAMATCH > LIM-BDAMATCHIF GRU-NOM-ANT-BDAMATCH <>GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-NOM-ANT-BDAMATCH <>CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
END-IF
MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCTA-NOM-ANT-BDAMATCHMOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TOGRU-NOM-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.4000-U-INTERELACIONAR-BDAMATCH.
REMARK********************************************************************
REMARK*4000-U-INTERELACIONAR-BDAMATCH.
REMARK* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
REMARK* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
REMARK* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************
PESO01*    PERFORM 1110-MOSTRAR-MATRIZ1RMB0004MOVE 1 TO MOVIDO-BDAMATCH    .PERFORM UNTIL MOVIDO-BDAMATCH = 0MOVE 0 TO MOVIDO-BDAMATCHMOVE 1 TO FIL-BUS-BDAMATCHPERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCHMOVE 1 TO COL-BUS-BDAMATCHPERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCHIF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)> 0
MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)TO BUSCADO-BDAMATCH
PERFORM 4100-BUSCAR-RELACION-BDAMATCHELSE
MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHEND-IF
ADD 1 TO COL-BUS-BDAMATCHEND-PERFORM
ADD 1 TO FIL-BUS-BDAMATCHEND-PERFORMEND-PERFORM.4100-BUSCAR-RELACION-BDAMATCH.
REMARK********************************************************************
REMARK*4100-BUSCAR-RELACION-BDAMATCH.
REMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
REMARK********************************************************************MOVE 1 TO FIL-FUE-BDAMATCH.PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHIF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH <= 2000
PERFORM 4110-MOVER-RELACIONES-BDAMATCHEND-IF
END-IFEND-IF
END-IF
ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.4110-MOVER-RELACIONES-BDAMATCH.
REMARK********************************************************************
REMARK*4110-MOVER-RELACIONES-BDAMATCH.
REMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
REMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
REMARK********************************************************************MOVE 0 TO FIN-FUENTE-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING LIBRE-BUSCADO-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4ADD 1 TO LIBRE-BUSCADO-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCH.PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCHMOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TOPORINSERTAR-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH > 2000MOVE PORINSERTAR-BDAMATCH TOCAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)ADD 1 TO LIBRE-BUSCADO-BDAMATCHMOVE 1 TO MOVIDO-BDAMATCHEND-IF
ADD 1 TO COL-FUE-BDAMATCHEND-PERFORM.
INITIALIZE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK********************************************************************
REMARK*5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
REMARK* PORTAFOLIO QUE TIENE MAS CUENTAS
REMARK********************************************************************MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.REMARK********************************************************************MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.MOVE 0 TO MAXREL-PER-BDAMATCHMOVE 0 TO FIN-FUENTE-BDAMATCH.MOVE 1 TO FIL-FUE-BDAMATCH.MOVE 0 TO  PESOS-CTRL-BDAMATCHPERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4MOVE 0 TO PESO-CTAS-TOT-BDAMATCHMOVE 1 TO POSIC-SUMA-BDAMATCH
PESO01MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHRMB0004
PESO01MOVE 0 TO  POSIC-SUSC-BDAMATCHRMB0004
PESO01MOVE 0 TO ENT-FIN-PORT-BDAMATCHRMB0004
PESO01MOVE 0 TO ENT-UNICAS-PORT-BDAMATCHRMB0004PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCHMOVE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)TO  CTA-A-BUSCAR-BDAMATCH
PESO01IF CTA-A-BUSCAR-BDAMATCH > 0RMB0004
PESO01MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
PESO01TO SUSC-CTAS-BDAMATCHRMB0004
AJUS01MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
AJUS01TO I2-BDAMATCHRMB0005
PESO01PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCHRMB0004
PESO01PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCHRMB0004
PESO01PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCHRMB0004
PESO01END-IFRMB0004ADD 4 TO  POSIC-SUMA-BDAMATCHEND-PERFORM
PESO01PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCHRMB0004ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.
PESO01 5100-CALCULAR-PESO-DIR-BDAMATCH.RMB0004
PESO01     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1RMB0004
PESO01UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH ORRMB0004
PESO01CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROSRMB0004
PESO01IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
PESO01=  CTA-A-BUSCAR-BDAMATCH     RMB0004
PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH  =RMB0004
PESO01PESO-CTAS-TOT-BDAMATCH +RMB0004
PESO01(NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *RMB0004
PESO01PESO-DIR-BDAMATCH )RMB0004
PESO01END-IFRMB0004
PESO01     END-PERFORM.RMB0004
PESO01 5200-CALCULAR-PESO-TEL-BDAMATCH.RMB0004PESO01     END-PERFORM.RMB0004
PESO01 5200-CALCULAR-PESO-TEL-BDAMATCH.RMB0004
PESO01     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1RMB0004
PESO01UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH ORRMB0004
PESO01CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROSRMB0004
PESO01IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
PESO01=  CTA-A-BUSCAR-BDAMATCH    RMB0004
PESO01COMPUTE  PESO-CTAS-TOT-BDAMATCH  =RMB0004
PESO01PESO-CTAS-TOT-BDAMATCH +RMB0004
PESO01(NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *RMB0004
PESO01PESO-TEL-BDAMATCH )RMB0004
PESO01END-IFRMB0004
PESO01     END-PERFORM.RMB0004
PESO01 5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004
REMARK******************************************************************
PESO01*5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004
REMARK* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
REMARK* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
REMARK******************************************************************
PESO01     SET IND-DIR-BDAMATCH TO 1.RMB0004
PESO01     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT ENDRMB0004
PESO01MOVE 1 TO  INV-BDAMATCHRMB0004
PESO01WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =RMB0004
PESO01SUSC-CTAS-BDAMATCHRMB0004
PESO01MOVE 0 TO  INV-BDAMATCHRMB0004
PESO01     END-SEARCH.RMB0004
PESO01     IF INV-BDAMATCH  =  1RMB0004
PESO01AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCHRMB0004
PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
PESO01+ PESO-NOM-BDAMATCHRMB0004
PESO01ADD   1TO  POSIC-SUSC-BDAMATCHRMB0004
PESO01MOVE SUSC-CTAS-BDAMATCH  TORMB0004
PESO01COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)RMB0004
AJUS01*MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCHRMB0005
AJUS01IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100RMB0005
AJUS01IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2RMB0005
AJUS01ADD 1 TO ENT-FIN-PORT-BDAMATCHRMB0005
AJUS01END-IFRMB0005
AJUS01END-IFRMB0005
PESO01ADD 1 TO ENT-UNICAS-PORT-BDAMATCHRMB0004
PESO01     END-IF.RMB0004
PESO01     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1RMB0004
PESO01ADD 1000 TO PESO-CTAS-TOT-BDAMATCHRMB0004
PESO01     END-IF.RMB0004
PESO01 5400-DEDUCIR-MEJ-PORT-BDAMATCH.RMB0004
PESO01     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCHRMB0004
PESO01MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCHRMB0004
PESO01     END-IFRMB0004
PESO01     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCHRMB0004PESO01     END-IFRMB0004
PESO01     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCHRMB0004
PESO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
PESO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
PESO01MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
PESO01     ELSERMB0004
PESO01IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCHRMB0004
MEJO01PERFORM 5410-DESEMPATAR-BDAMATCHRMB0004
PESO01END-IFRMB0004
PESO01     END-IF.RMB0004
MEJO01 5410-DESEMPATAR-BDAMATCH.RMB0004
MEJO01IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
MEJO01ELSERMB0004
MEJO01IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
MEJO01IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 ANDRMB0004
MEJO01NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
MEJO01".-,"RMB0004
MEJO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TORMB0004
MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01ELSERMB0004
MEJO01IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >RMB0004
MEJO01LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
MEJO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TORMB0004
MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01END-IFRMB0004
MEJO01END-IFRMB0004
MEJO01END-IF.RMB0004
5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK*********************************************************************
REMARK*5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
REMARK* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
REMARK*********************************************************************MOVE 0 TO VALCTA-OUTPUT-BDAMATCHMOVE 1 TO I-BDAMATCH.IF MEJOR-PORTAFOLIO-BDAMATCH > 0PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORVALCTA-OUTPUT-BDAMATCH = 1 ORCAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)TO J-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHTO J-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHMOVE 1 TO VALCTA-OUTPUT-BDAMATCHEND-IF
ADD 1 TO I-BDAMATCHEND-PERFORMEND-IF.
*
6000-U-MEJOR-DIR-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-DIR-BDAMATCH.
REMARK*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
REMARK*********************************************************************SORT T-DIR-BDAMATCH
DESCENDING  NUM-CTAS-DIR-BDAMATCHDESCENDINGLNG-DIR-BDAMATCHDESCENDINGNUM-DIR-BDAMATCHDESCENDINGCTA-DIR-BDAMATCH.MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.6000-U-MEJOR-TEL-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-TEL-BDAMATCH.
REMARK*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
REMARK*********************************************************************SORT T-TEL-BDAMATCH
DESCENDING  NUM-CTAS-TEL-BDAMATCHDESCENDINGNUM-TEL-BDAMATCHDESCENDINGCTA-TEL-BDAMATCH.MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
*
6000-U-MEJOR-NOM-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-NOM-BDAMATCH.
REMARK*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
REMARK*********************************************************************SORT T-GRUNOM-BDAMATCH
DESCENDING  NUM-CTAS-GRUNOM-BDAMATCHDESCENDING  LNG-GRUNOM-BDAMATCHDESCENDING  NOM-GRUNOM-BDAMATCH.MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCHOR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCHOR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCHOR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,NRO-VECES-1-BDAMATCH) = 0OR ESTA-CTA-BDAMATCH  =  1IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
NRO-VECES-1-BDAMATCH)MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TOPOSIC-SUS-GRU-BDAMATCHMOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TONOM-OUTPUT-BDAMATCHMOVE 1 TO  ESTA-CTA-BDAMATCHEND-IF
END-PERFORM
END-IF
END-PERFORM
END-PERFORM.
*
9000-U-REALIZAR-BDAMATCH.
REMARK******************************************************************
REMARK*9000-U-REALIZAR-BDAMATCH.
REMARK* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL
REMARK* MEJOR NOMBRE
REMARK******************************************************************MOVE  ZEROSTO  POSIC-SUSC-BDAMATCHMOVE  ALL "9"TO  TABLA-SUSC-DIR-BDAMATCHPERFORM 3000-U-ORDENAR-DIR-BDAMATCHPERFORM 3000-U-ORDENAR-TEL-BDAMATCHPERFORM 3000-U-ORDENAR-NOM-BDAMATCHPERFORM 4000-U-INTERELACIONAR-BDAMATCHPERFORM 6000-U-MEJOR-DIR-BDAMATCH.PERFORM 6000-U-MEJOR-TEL-BDAMATCH.PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.PERFORM 6000-U-MEJOR-NOM-BDAMATCH.
*
9010-U-VER-FALLECIDO-BDAMATCH.
REMARK*********************************************************************
REMARK*9010-U-VER-FALLECIDO-BDAMATCH.
REMARK* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL
REMARK* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.
REMARK*********************************************************************
VIGE01     MOVE 1 TO I-BDAMATCH.RMB0003
VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003
VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003
VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003
VIGE01VALCTA-OUTPUT-BDAMATCH = 1 ORRMB0003
VIGE01CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
VIGE01MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
VIGE01TO J-BDAMATCHRMB0003
VIGE01ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCHRMB0003
VIGE01IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1RMB0003
VIGE01ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCHRMB0003
VIGE01END-IFRMB0003
VIGE01ADD 1 TO I-BDAMATCHRMB0003
VIGE01END-PERFORMRMB0003
VIGE01     END-IF.RMB0003
VIGE01*RMB0003
400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.
IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROCLEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~VIGE01END-IFRMB0003
VIGE01ADD 1 TO I-BDAMATCHRMB0003
VIGE01END-PERFORMRMB0003
VIGE01     END-IF.RMB0003
VIGE01*RMB0003
400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.
IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
"^?^?" [Modified] line 1202 of 1226 --98%-- BDAMATCH.PROC
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003BDAMATCH.PROC









PRO$WS:r BDAMATCH.WS"BDAMATCH.WS" 212 lines, 14407 characters 
REMARK*BDAMATCH-WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS
REMARK* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE
         *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO
*******************************************************************
RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
R-MARTINEZ. *          DEL PORTAFOLIO .                          *
5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  *
            * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH          *
             * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION 
*******************************************************************
NOMB01 01 VARIABLES-MAQ.                                                RMB0003
NOMB01     03 I-MAQ          PIC 9(03)  VALUE 0 RMB0003
NOMB01     03 J-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.         RMB0003
NOMB01     03 NOMBRE-OUTMAQ-OK         PIC X(45)  VALUE SPACES.RMB0003
NOMB01     03 NOMBRE-INPMAQ-X.                                    RMB0003
NOMB01 04 FILLERPIC X(02)  VALUE "A ".  RMB0003
NOMB01 04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.         RMB0003
NOMB01     03 PARTICULAS-INPMAQ.                                        RMB0003
NOMB01 04 BASURA-INPMAQ            PIC X(45).RMB0003
NOMB01        04 P1-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P2-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P3-INPMAQ                PIC X(45).  RMB0003
NOMB01        04 P4-INPMAQ                PIC X(45).                    RMB0003
NOMB01 04 P5-INPMAQ                PIC X(45).             RMB0003
NOMB01 04 P6-INPMAQ                PIC X(45).     RMB0003
NOMB01 04 P7-INPMAQ                PIC X(45).             RMB0003
NOMB01 04 P8-INPMAQ                PIC X(45).              RMB0003
NOMB01 04 P9-INPMAQ                PIC X(45).  RMB0003
NOMB01 04 P10-INPMAQ               PIC X(45).                    RMB0003
NOMB01 01  SIG-MAQ            PIC X(1).                        RMB0003
NOMB01     88 SIG-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
NOMB01 01  ANT-MAQ                     PIC X(1).                        RMB0003
NOMB01     88 ANT-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
NOMB01 01  ACTUAL-MAQ        PIC X(1).                        RMB0003
NOMB01     88 TILDE-MAQ   VALUE "Á" "É" "Í" "Ó" "Ú" "á" "é" "í" "ó" "ú".RMB0003
NOMB01     88 QUITAR-MAQ  VALUE  "'" "´"  "`" '"' .                     RMB0003
NOMB01     88 BORRAR-MAQ  VALUE "-" "." "1" "2" "3" "4"RMB0003
NOMB01                          "5" "6" "7" "8" "9" '0' ")" "," .RMB0003
NOMB01     88 ELIMINAR-MAQ VALUE "(" .                                  RMB0003
NOMB01     88 VALIDO-MAQ   VALUE "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"RMB0003
NOMB01                           "K" "L" "M" "N" "O" "P" "Q" "R" "S"    RMB0003
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
CARACTTEM-V09.PROC
CARACTTEM.PROC
DECIS3.PROC
INDEREGI.PROC
INDEREGIV01.PROC
LEEMAESTROS-082.PROC
LEEMAESTROS-AMNI.PROC
LEEMAESTROS-BBVA.PROC
LEEMAESTROS-CAV.PROC
LEEMAESTROS-NW.PROC
LEEMAESTROS-PRODUCCION.PROC
LEEMAESTROS-PRU.PROC
LEEMAESTROS-SEC.PROC
LEEMAESTROS.PROC
LEEMAESTROS2.PROC
LEEMAESTROSANT.PROC
LEEMAESTROSLEY.PROC
LEEMAESTROSNEW.PROC
LEEMAESTROSPE.PROC
LEEMAESTROSRMB.PROC
UTLINDEREGI.PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~

END-IF.GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TO


~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~24 lines deleted"^?^?" [Modified] line 1419 of 1419 --100%-- :w"^?^?" 1419 lines, 91843 characters :w qqq"qqq" File exists - use "w! qqq" to overwrite:w! qqq"qqq" 1419 lines, 91843 characters :q!icjlud@codes /d/iccol/desarrollo/copys
$ clear
icjlud@codes /d/iccol/desarrollo/copys
$ cat qqq
BDAMATCH.WS
REMARK*BDAMATCH-WS.v.0003.
REMARK********************************************************************
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR 
REMARK* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS      
REMARK* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE 
REMARK*         *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO     
REMARK********************************************************************
REMARK* RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
REMARK* R-MARTINEZ. *          DEL PORTAFOLIO .                          *
REMARK* 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  *
REMARK*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH          *
REMARK*             * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *
REMARK********************************************************************
NOMB01 01 VARIABLES-MAQ.                                                RMB0003
NOMB01     03 I-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 J-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.              RMB0003
NOMB01     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.         RMB0003
NOMB01     03 NOMBRE-OUTMAQ-OK         PIC X(45)  VALUE SPACES.         RMB0003
NOMB01     03 NOMBRE-INPMAQ-X.                                          RMB0003
NOMB01        04 FILLER                PIC X(02)  VALUE "A ".           RMB0003
NOMB01        04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.         RMB0003
NOMB01     03 PARTICULAS-INPMAQ.                                        RMB0003
NOMB01        04 BASURA-INPMAQ            PIC X(45).                    RMB0003
NOMB01        04 P1-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P2-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P3-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P4-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P5-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P6-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P7-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P8-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P9-INPMAQ                PIC X(45).                    RMB0003
NOMB01        04 P10-INPMAQ               PIC X(45).                    RMB0003
NOMB01 01  SIG-MAQ                     PIC X(1).                        RMB0003
NOMB01     88 SIG-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
NOMB01 01  ANT-MAQ                     PIC X(1).                        RMB0003
NOMB01     88 ANT-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
NOMB01 01  ACTUAL-MAQ                  PIC X(1).                        RMB0003
NOMB01     88 TILDE-MAQ   VALUE "Á" "É" "Í" "Ó" "Ú" "á" "é" "í" "ó" "ú".RMB0003
NOMB01     88 QUITAR-MAQ  VALUE  "'" "´"  "`" '"' .                     RMB0003
NOMB01     88 BORRAR-MAQ  VALUE "-" "." "1" "2" "3" "4"                 RMB0003
NOMB01                          "5" "6" "7" "8" "9" '0' ")" "," .       RMB0003
NOMB01     88 ELIMINAR-MAQ VALUE "(" .                                  RMB0003
NOMB01     88 VALIDO-MAQ   VALUE "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"RMB0003
NOMB01                           "K" "L" "M" "N" "O" "P" "Q" "R" "S"    RMB0003
NOMB01                           "T" "U" "V" "W" "X" "Y" "Z" " ".       RMB0003
       01 LLAVE-AUX11-BDAMATCH.                 
          02  TIPO-ID-AUX11-BDAMATCH    PIC 9(01).        
          02  NUM-ID-AUX11-BDAMATCH     PIC 9(11).                  
          02  COD-SUS-AUX11-BDAMATCH    PIC 9(06).        
          02  COD-CTA-AUX11-BDAMATCH    PIC 9(02).        
          02  NUM-CTA-AUX11-BDAMATCH    PIC X(18).        
       01 LLAVE-AUX13-BDAMATCH.                 
          02  TIPO-ID-AUX13-BDAMATCH    PIC 9(01).        
          02  NUM-ID-AUX13-BDAMATCH     PIC 9(13).                  
          02  COD-SUS-AUX13-BDAMATCH    PIC 9(06).        
          02  COD-CTA-AUX13-BDAMATCH    PIC 9(02).        
          02  NUM-CTA-AUX13-BDAMATCH    PIC X(18).        
       01 VARIABLES-BDAMATCH.        
PESO01    02 I2-BDAMATCH                PIC 9(2).                       RMB0003
PESO01    02 TIPCTA-BDAMATCH.                                           RMB0003
PESO01*******2=CK,1=CR,2=BS,3=CC,4=OT,9=INVALIDO                        RMB0003
PESO01       03 FILLER PIC X(30) VALUE "211422244444224442444433442444".RMB0003
PESO01       03 FILLER PIC X(30) VALUE "444444444444444444442999999999".RMB0003
PESO01       03 FILLER PIC X(30) VALUE "999999999999999999999999999999".RMB0003
PESO01       03 FILLER PIC X(10) VALUE "9999999999".                    RMB0003
PESO01    02 FILLER REDEFINES TIPCTA-BDAMATCH.                          RMB0003
PESO01       03 V-TIPCTA-BDAMATCH  OCCURS 100 TIMES PIC 9.              RMB0003
PESO01    02 APELLIDO-INPUT-BDAMATCH    PIC X(60) VALUE SPACES.         RMB0003
PESO01    02 ENT-FIN-PORT-BDAMATCH      PIC 9(3)  VALUE 0.              RMB0003
PESO01    02 ENT-UNICAS-PORT-BDAMATCH   PIC 9(3)  VALUE 0.              RMB0003
PESO01    02 ENT-FIN-MEJ-PORT-BDAMATCH  PIC 9(3)  VALUE 0.              RMB0003
VIGE01    02 FALLECIDO-BDAMATCH         PIC 9(01) VALUE 0.              RMB0002
          02 IDE-TIPO-BDAMATCH          PIC 9(01) VALUE 0.        
          02 ABIERTO-BDAMATCH           PIC 9(01) VALUE 0.        
          02 PROCESAR-BDAMATCH          PIC 9(01) VALUE 0.        
          02 FIN-BDAMATCH               PIC 9(01) VALUE 0.        
          02 NUM-IDE-INPUT-BDAMATCH     PIC 9(11).        
          02 TIP-IDE-INPUT-BDAMATCH     PIC 9(01).        
          02 I-GRU-BDAMATCH             PIC 9(5) VALUE 0.        
          02 GRU-NOM-BDAMATCH           PIC 9(5) VALUE 0.        
          02 MOVIDO-BDAMATCH            PIC 9(1) VALUE 0.        
          02 BUSCADO-D-BDAMATCH.        
             03 BUSCADO-BDAMATCH        PIC 9(3) VALUE 0.        
             03 FILLER                  PIC X(1) VALUE " ".        
          02 PORINSERTAR-D-BDAMATCH.        
             03 PORINSERTAR-BDAMATCH    PIC 9(03) VALUE 0.        
             03 FILLER                  PIC X(1) VALUE " ".        
          02 EXISTE-BDAMATCH            PIC 9(05) VALUE 0.        
          02 MEJOR-PORTAFOLIO-BDAMATCH  PIC 9(05) VALUE 0.        
          02 GRU-ANT-BDAMATCH           PIC 9(05) VALUE 0.        
          02 MAX-CUENTAS-BDAMATCH       PIC 9(05) VALUE 5.        
          02 MAX-REL-BDAMATCH           PIC 9(05) VALUE 5.        
          02 MAXREL-PER-BDAMATCH        PIC 9(05) VALUE 0.        
          02 FIN-FUENTE-BDAMATCH        PIC 9(05) VALUE 0.        
          02 FIL-BUS-BDAMATCH           PIC 9(05) VALUE 0.        
          02 COL-BUS-BDAMATCH           PIC 9(05) VALUE 0.        
          02 FIN-BUSCADO-BDAMATCH       PIC 9(05) VALUE 0.        
          02 LIBRE-BUSCADO-BDAMATCH     PIC 9(05) VALUE 0.        
          02 FIL-FUE-BDAMATCH           PIC 9(05) VALUE 0.        
          02 COL-FUE-BDAMATCH           PIC 9(05) VALUE 0.        
          02 I-BDAMATCH                 PIC 9(08) VALUE 0.        
          02 J-BDAMATCH                 PIC 9(08) VALUE 0.        
          02 I-DIR-BDAMATCH             PIC 9(05) VALUE 0.        
          02 I-TEL-BDAMATCH             PIC 9(05) VALUE 0.        
          02 I-NOM-BDAMATCH             PIC 9(05) VALUE 0.        
          02 I-CTA-BDAMATCH             PIC 9(05) VALUE 0.        
          02 NUM-DIR-ANT-BDAMATCH       PIC X(50).        
          02 NUM-TEL-ANT-BDAMATCH       PIC 9(15).        
          02 CTA-DIR-ANT-BDAMATCH       PIC 9(05).        
          02 CTA-TEL-ANT-BDAMATCH       PIC 9(05).        
          02 CTA-NOM-ANT-BDAMATCH       PIC 9(05).        
          02 GRU-NOM-ANT-BDAMATCH       PIC 9(05).        
          02 TABLA-DIR-BDAMATCH.        
             03 T-DIR-BDAMATCH OCCURS 501 TIMES.        
                04 CTA-DIR-BDAMATCH     PIC 9(03).        
                04 NUM-DIR-BDAMATCH     PIC X(50).        
                04 NUM-CTAS-DIR-BDAMATCH PIC 9(03).        
                04 SUS-DIR-BDAMATCH     PIC 9(06).        
                04 LNG-DIR-BDAMATCH     PIC 9(03).        
          02 TABLA-TEL-BDAMATCH.        
             03 T-TEL-BDAMATCH   OCCURS 501 TIMES.        
                04 CTA-TEL-BDAMATCH     PIC 9(03).        
                04 NUM-TEL-BDAMATCH     PIC 9(15).        
                04 NUM-CTAS-TEL-BDAMATCH PIC 9(03).        
                04 SUS-TEL-BDAMATCH     PIC 9(06).        
          02 TABLA-NOM-BDAMATCH.        
             03 T-NOM-BDAMATCH OCCURS 501 TIMES.        
                04 CTA-NOM-BDAMATCH     PIC 9(03).        
                04 NOM-NOM-BDAMATCH     PIC X(60).        
                04 SUS-NOM-BDAMATCH     PIC 9(06).        
                04 GRU-NOMS-BDAMATCH     PIC 9(03).        
                04 LNG-NOM-BDAMATCH     PIC 9(02).        
          02 TABLA-CUENTAS-BDAMATCH.        
             03 T-CUENTAS-BDAMATCH OCCURS 501 TIMES.        
                04 CTA-CUENTAS-BDAMATCH PIC X(38).        
VIGE01          04 CTA-FALLECIDO-BDAMATCH   PIC 9(1).                   RMB0002
FUEN01          04 FUEEXT-CUENTAS-BDAMATCH   PIC 9(1).                  RMB0003
          02 TABLA-GRUNOM-BDAMATCH.        
             03 T-GRUNOM-BDAMATCH OCCURS 501 TIMES.        
                04 GRUPO-GRUNOM-BDAMATCH PIC 9(03).        
                04 NOM-GRUNOM-BDAMATCH   PIC X(60).        
                04 NUM-CTAS-GRUNOM-BDAMATCH PIC 9(03).        
                04 LNG-GRUNOM-BDAMATCH   PIC 9(02).        
APEL01          04 APE-GRUNOM-BDAMATCH   PIC 9(03).                     RMB0003
          02  WS-PESOS-CUENTAS-BDAMATCH.        
            03  ESTA-CTA-BDAMATCH        PIC  9(01)  VALUE  ZEROS.        
            03  INV-BDAMATCH             PIC 9(04) VALUE ZEROS.        
            03  SUSC-CTAS-BDAMATCH       PIC 9(06) VALUE ZEROS.        
            03  SUSC-GRUPO-BDAMATCH.        
              05  SUSC-GRUP-SUS-BDAMATCH PIC  9(06)  VALUE  ZEROS.        
              05  SUSC-GRUP-GRU-BDAMATCH PIC  9(03)  VALUE  ZEROS.        
            03  PESO-CTAS-TOT-BDAMATCH   PIC 9(12) VALUE ZEROS.        
            03  PESOS-CTRL-BDAMATCH      PIC 9(12) VALUE ZEROS.        
            03  NOM-LIMPI-BDAMATCH       PIC X(60) VALUE SPACES.        
            03  CTA-A-BUSCAR-BDAMATCH    PIC 9(03) VALUE ZEROS.        
            03  PESO-TEL-BDAMATCH        PIC 9(02) VALUE 1.        
            03  PESO-DIR-BDAMATCH        PIC 9(02) VALUE 3.        
            03  PESO-NOM-BDAMATCH        PIC 9(02) VALUE 9.        
            03  POSIC-TEL-BDAMATCH       PIC 9(02) VALUE ZEROS.        
            03  POSIC-DIR-BDAMATCH       PIC 9(02) VALUE ZEROS.        
            03  POSIC-NOM-BDAMATCH       PIC 9(02) VALUE ZEROS.        
            03  POSIC-GRU-BDAMATCH       PIC 9(02) VALUE ZEROS.        
            03  NRO-VECES-1-BDAMATCH     PIC 9(03) VALUE ZEROS.        
            03  NRO-VECES-2-BDAMATCH     PIC 9(03) VALUE ZEROS.        
            03  NRO-VECES-3-BDAMATCH     PIC 9(03) VALUE ZEROS.        
            03  POSIC-SUMA-BDAMATCH      PIC 9(03) VALUE ZEROS.        
            03  POSIC-SUSC-BDAMATCH      PIC 9(03) VALUE ZEROS.        
            03  POSIC-SUS-GRU-BDAMATCH   PIC 9(03) VALUE ZEROS.        
       01 V-INTERRELAC-BDAMATCH.        
          02 CARAC-REL-BDAMATCH  OCCURS 501 TIMES PIC X(03).        
          02 FILA-REL-BDAMATCH OCCURS 501 TIMES.        
             03 COLUMNA-REL-BDAMATCH OCCURS 501 TIMES.        
                04 CAJA-BDAMATCH         PIC 9(03).        
                04 DELIMITADOR-BDAMATCH  PIC X(01).        
       01 VARIABLES-NOMBRES-BDAMATCH.        
          03 LIM-BDAMATCH                PIC  9(03) VALUE 500.        
          03 DIR-INPUT-BDAMATCH          PIC  X(60).        
          03 DIR-OUTPUT-BDAMATCH         PIC  X(60).        
          03 CTA-INPUT-BDAMATCH          PIC  X(38).        
          03 TEL-INPUT-BDAMATCH          PIC  9(15).        
          03 TEL-OUTPUT-BDAMATCH         PIC  9(15).        
          03 NOM-INPUT-BDAMATCH          PIC  X(60).        
          03 NOM-OUTPUT-BDAMATCH         PIC  X(60).        
VIGE01    03 NUM-MUERTOS-OUTPUT-BDAMATCH PIC  9(03).                    RMB0002
VIGE01    03 NUM-CTAS-OUTPUT-BDAMATCH    PIC  9(03).                    RMB0002
          03 VALCTA-OUTPUT-BDAMATCH      PIC  9(01).        
          03 CAR-ANT-BDAMATCH            PIC  X(01).                        
          03 CAR-ACT-BDAMATCH            PIC  9(01).                         
          03 T-CARDIR-BDAMATCH.                                                 
             04 V-CARDIR-BDAMATCH       OCCURS 60 TIMES PIC X(01).        
          03 T-CARTOT-BDAMATCH.                                              
             04 V-CARTOT-BDAMATCH       OCCURS 10 TIMES PIC 9(05).        
       01  TABLA-SUSC-DIR-BDAMATCH.                                          
         03  REG-SUSC-DIR-BDAMATCH   OCCURS 501 TIMES              
             ASCENDING KEY IS COD-SUSC-DIR-BDAMATCH  INDEXED BY         
                                                     IND-DIR-BDAMATCH.        
           05  COD-SUSC-DIR-BDAMATCH     PIC 9(06).                    
           05  FLAG-YA-CTA-BDAMATCH      PIC 9(01).                    
           05  FLAG-YA-DIR-BDAMATCH      PIC 9(01).                    
           05  FLAG-YA-TEL-BDAMATCH      PIC 9(01).                    
           05  FLAG-YA-NOM-BDAMATCH      PIC 9(01).                    
       01  TABLA-SUSC-NOMBRE-BDAMATCH.        
         03  REG-SUSC-NOM-BDAMATCH        OCCURS 501 TIMES        
             ASCENDING  KEY  IS  KEY-SUSC-NOM-BDAMATCH  INDEXED         
                                 BY IND-NOM-BDAMATCH.        
           05  KEY-SUSC-NOM-BDAMATCH.        
             07  COD-SUSC-NOM-BDAMATCH   PIC 9(06).        
             07  GRUPO-SUS-NOM-BDAMATCH  PIC 9(03).        




BDAMATCH.PROC
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH   
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL 
REMARK*             *        MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH 
REMARK*             *                  NUM-CTAS-OUTPUT-BDAMATCH   
REMARK*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK*             *        BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE  
REMARK*             *        DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *          DEL PORTAFOLIO .                       *
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL * 
REMARK*             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       * 
REMARK*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               * 
REMARK*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH       * 
REMARK*             * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7      * 
REMARK*             * NOMB01 - MAQUILLAR EL NOMBRE                    * 
REMARK*             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK*             *          DECUENTA DE LA MISMA CUENTA            *
REMARK*****************************************************************

       1000-U-RECORRER-CSV-BDAMATCH.                  
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.             
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION 
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH 
REMARK******************************************************************
           MOVE 0 TO IDE-TIPO-BDAMATCH        
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                         RMB0003
           MOVE 0 TO MAX-CUENTAS-BDAMATCH.        
           IF ABIERTO-BDAMATCH  = 0                
              OPEN INPUT  BDACSV                                                
              MOVE 1 TO ABIERTO-BDAMATCH                 
           END-IF.                
           INITIALIZE LLAVE-BDACSV.        
           MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .                
           MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .                
           MOVE 0 TO FIN-BDAMATCH .                
           MOVE 0 TO PROCESAR-BDAMATCH .                                  
           START BDACSV  KEY > LLAVE-BDACSV                  
                 INVALID KEY                 
                    MOVE 1 TO FIN-BDAMATCH                 
                 NOT INVALID KEY                 
                    READ BDACSV IGNORE LOCK NEXT RECORD                      
                       AT END                
                          MOVE 1 TO FIN-BDAMATCH                    
                    END-READ                
           END-START.                
           PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =              
                                            NUM-IDE-INPUT-BDAMATCH  OR          
                                            TIPO-ID-BDACSV  NOT =               
                                            TIP-IDE-INPUT-BDAMATCH              
              MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02        
              READ SUSCRIPTOR IGNORE LOCK        
                 INVALID KEY        
                    MOVE 0 TO PROCESAR-BDAMATCH        
                 NOT INVALID KEY         
FUEN01              MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004
              END-READ        
BLOQ01        IF PROCESAR-BDAMATCH = 1                                  RMB0004
BLOQ01           IF ESTADO-ABD02 = 1                                    RMB0004
BLOQ01              IF IND-BLOQUEO-BDACSV <> "B"                        RMB0004
BLOQ01                 MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004
FUEN01                 IF FUENTE-REG-BDACSV <= 01                       RMB0004
FUEN01                    PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH       RMB0004
FUEN01                 ELSE                                             RMB0004
FUEN01                    PERFORM 1100-LLENAR-AUX-BDAMATCH              RMB0004
FUEN01                 END-IF                                           RMB0004
FUEN01              ELSE                                                RMB0004
BLOQ01                 MOVE 0 TO PROCESAR-BDAMATCH                      RMB0004
BLOQ01              END-IF                                              RMB0004
BLOQ01           ELSE                                                   RMB0004
BLOQ01              MOVE 0 TO PROCESAR-BDAMATCH                         RMB0004
BLOQ01           END-IF                                                 RMB0004
BLOQ01        END-IF                                                    RMB0004
              IF PROCESAR-BDAMATCH = 1        
                 PERFORM 1200-PROC-REG-CSV-BDAMATCH        
              END-IF        
              READ BDACSV IGNORE LOCK   NEXT RECORD                      
              AT END                
                 MOVE 1 TO FIN-BDAMATCH                    
              END-READ                
LIMI01        IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
LIMI01           MOVE 1 TO FIN-BDAMATCH               *> SE ABLIGA A TIPRMB0004
LIMI01           MOVE 0 TO MAX-CUENTAS-BDAMATCH       *> EFICIENCIA Y   RMB0004
LIMI01           MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
LIMI01        END-IF                                                    RMB0004
           END-PERFORM.                
           IF MAX-CUENTAS-BDAMATCH > 0        
APEL01        IF APELLIDO-INPUT-BDAMATCH <> SPACES AND                  RMB0004
APEL01           MAX-CUENTAS-BDAMATCH > 1                               RMB0004
APEL01           PERFORM 1100-LLENAR-CSV-APE-BDAMATCH                   RMB0004
APEL01           PERFORM 1100-LLENAR-AUX-BDAMATCH                       RMB0004
APEL01           PERFORM 1200-PROC-REG-CSV-BDAMATCH                     RMB0004
APEL01        END-IF                                                    RMB0004
              PERFORM 9000-U-REALIZAR-BDAMATCH         
NOMB01        IF NOM-OUTPUT-BDAMATCH <> SPACES AND                      RMB0004
NOMB01           (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)                      RMB0004
NOMB01           MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQ              RMB0004
NOMB01           PERFORM 1100-MAQUILLAR-NOMBRE-MAQ                      RMB0004
NOMB01           MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCH           RMB0004
NOMB01        END-IF                                                    RMB0004
              IF NOM-OUTPUT-BDAMATCH <> SPACES        
                 MOVE 1 TO IDE-TIPO-BDAMATCH        
              END-IF        
           END-IF.        
NOMB01 1100-MAQUILLAR-NOMBRE-MAQ.                                       RMB0004
NOMB01     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
NOMB01     MOVE 0 TO I-MAQ                                              RMB0004
NOMB01     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
NOMB01             INITIAL "Y/O"                                        RMB0004
NOMB01             OR      "Y\O"                                        RMB0004
NOMB01             OR      " Y/OTRO "                                   RMB0004
NOMB01             OR      " Y/OTRA "                                   RMB0004
NOMB01             OR      " Y\OTRO "                                   RMB0004
NOMB01             OR      " Y\OTRA "                                   RMB0004
NOMB01             OR      " Y OTRO "                                   RMB0004
NOMB01             OR      " Y OTRA "                                   RMB0004
NOMB01     IF I-MAQ < 45 AND I-MAQ > 2                                  RMB0004
NOMB01        ADD 1 TO I-MAQ                                            RMB0004
NOMB01        MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)                      RMB0004
NOMB01     ELSE                                                         RMB0004
NOMB01        IF I-MAQ < 45                                             RMB0004
NOMB01           ADD 1 TO I-MAQ                                         RMB0004
NOMB01           MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)                  RMB0004
NOMB01        END-IF                                                    RMB0004
NOMB01     END-IF                                                       RMB0004
NOMB01     MOVE 0 TO SW-BORRAR-MAQ                                      RMB0004
NOMB01     MOVE 1 TO I-MAQ.                                             RMB0004
NOMB01     PERFORM UNTIL I-MAQ > 45                                     RMB0004
NOMB01       MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ                  RMB0004
NOMB01       IF TILDE-MAQ                                               RMB0004
NOMB01          PERFORM 1000-CAMBIAR-TILDE-MAQ                          RMB0004
NOMB01          MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)               RMB0004
NOMB01       END-IF                                                     RMB0004
NOMB01       IF FUNCTION ORD(ACTUAL-MAQ) < 31                           RMB0004
NOMB01          MOVE "." TO ACTUAL-MAQ                                  RMB0004
NOMB01       END-IF                                                     RMB0004
NOMB01       MOVE " " TO ANT-MAQ                                        RMB0004
NOMB01       IF I-MAQ > 1                                               RMB0004
NOMB01          COMPUTE J-MAQ = I-MAQ - 1                               RMB0004
NOMB01          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQ                  RMB0004
NOMB01       END-IF                                                     RMB0004
NOMB01       MOVE " " TO SIG-MAQ                                        RMB0004
NOMB01       IF I-MAQ < 45                                              RMB0004
NOMB01          COMPUTE J-MAQ = I-MAQ + 1                               RMB0004
NOMB01          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQ                  RMB0004
NOMB01       END-IF                                                     RMB0004
NOMB01       IF ACTUAL-MAQ = ")"                                        RMB0004
NOMB01          MOVE 0 TO SW-BORRAR-MAQ                                 RMB0004
NOMB01       END-IF                                                     RMB0004
NOMB01       IF SW-BORRAR-MAQ = 0                                       RMB0004
NOMB01          IF ELIMINAR-MAQ                                         RMB0004
NOMB01             MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                  RMB0004
NOMB01             IF I-MAQ > 1                                         RMB0004
NOMB01                MOVE 1 TO SW-BORRAR-MAQ                           RMB0004
NOMB01             END-IF                                               RMB0004
NOMB01          ELSE                                                    RMB0004
NOMB01             IF BORRAR-MAQ                                        RMB0004
NOMB01                MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)               RMB0004
NOMB01             ELSE                                                 RMB0004
NOMB01                IF QUITAR-MAQ                                     RMB0004
NOMB01                   COMPUTE J-MAQ = I-MAQ + 1                      RMB0004
NOMB01                   MOVE NOMBRE-INPMAQ(J-MAQ:) TO                  RMB0004
NOMB01                        NOMBRE-INPMAQ(I-MAQ:)                     RMB0004
NOMB01                   COMPUTE I-MAQ = I-MAQ - 1                      RMB0004
NOMB01                ELSE                                              RMB0004
NOMB01                   IF VALIDO-MAQ                                  RMB0004
NOMB01                      CONTINUE                                    RMB0004
NOMB01                   ELSE                                           RMB0004
NOMB01                      IF ANT-MAQ = "N" AND SIG-VOCAL-MAQ          RMB0004
NOMB01                         COMPUTE J-MAQ = I-MAQ + 1                RMB0004
NOMB01                         MOVE NOMBRE-INPMAQ(J-MAQ:) TO            RMB0004
NOMB01                              NOMBRE-INPMAQ(I-MAQ:)               RMB0004
NOMB01                         COMPUTE I-MAQ = I-MAQ - 1                RMB0004
NOMB01                      ELSE                                        RMB0004
NOMB01                         IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
NOMB01                            (ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
NOMB01                            IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
NOMB01                               COMPUTE J-MAQ = I-MAQ + 1          RMB0004
NOMB01                               MOVE NOMBRE-INPMAQ(J-MAQ:) TO      RMB0004
NOMB01                                    NOMBRE-INPMAQ(I-MAQ:)         RMB0004
NOMB01                            ELSE                                  RMB0004
NOMB01                               MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01                            END-IF                                RMB0004
NOMB01                         ELSE                                     RMB0004
NOMB01                            IF NOT ANT-VOCAL-MAQ AND              RMB0004
NOMB01                                   SIG-VOCAL-MAQ                  RMB0004
NOMB01                               MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01                            ELSE                                  RMB0004
NOMB01                               MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01                            END-IF                                RMB0004
NOMB01                         END-IF                                   RMB0004
NOMB01                      END-IF                                      RMB0004
NOMB01                   END-IF                                         RMB0004
NOMB01                END-IF                                            RMB0004
NOMB01             END-IF                                               RMB0004
NOMB01          END-IF                                                  RMB0004
NOMB01       ELSE                                                       RMB0004
NOMB01          MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                     RMB0004
NOMB01       END-IF                                                     RMB0004
NOMB01       ADD 1 TO I-MAQ                                             RMB0004
NOMB01     END-PERFORM.                                                 RMB0004
NOMB01     INITIALIZE PARTICULAS-INPMAQ                                 RMB0004
NOMB01     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "                RMB0004
NOMB01       INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
NOMB01            P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
NOMB01            P10-INPMAQ                                            RMB0004
NOMB01     MOVE SPACES TO NOMBRE-OUTMAQ-OK                              RMB0004
NOMB01     STRING P1-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P2-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P3-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P4-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P5-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P6-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P7-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P8-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P9-INPMAQ DELIMITED BY " "                            RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01            P10-INPMAQ DELIMITED BY " "                           RMB0004
NOMB01            " " DELIMITED BY SIZE                                 RMB0004
NOMB01       INTO NOMBRE-OUTMAQ-OK.                                     RMB0004
NOMB01       INSPECT NOMBRE-OUTMAQ-OK                                   RMB0004
NOMB01         REPLACING ALL  " PE A " BY " PENA ".                     RMB0004
NOMB01  1000-CAMBIAR-TILDE-MAQ.                                         RMB0004
NOMB01       EVALUATE ACTUAL-MAQ                                        RMB0004
NOMB01          WHEN "Á"                                                RMB0004
NOMB01            MOVE "A" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "É"                                                RMB0004
NOMB01            MOVE "E" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "Í"                                                RMB0004
NOMB01            MOVE "I" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "Ó"                                                RMB0004
NOMB01            MOVE "O" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "Ú"                                                RMB0004
NOMB01            MOVE "U" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "á"                                                RMB0004
NOMB01            MOVE "A" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "é"                                                RMB0004
NOMB01            MOVE "E" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "í"                                                RMB0004
NOMB01            MOVE "I" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "ó"                                                RMB0004
NOMB01            MOVE "O" TO ACTUAL-MAQ                                RMB0004
NOMB01          WHEN "Ú"                                                RMB0004
NOMB01            MOVE "U" TO ACTUAL-MAQ                                RMB0004
NOMB01        END-EVALUATE.                                             RMB0004
APEL01 1100-LLENAR-CSV-APE-BDAMATCH.                                    RMB0004
APEL01     INITIALIZE REG-BDACSV                                        RMB0004
APEL01     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSV               RMB0004
APEL01     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSV                RMB0004
APEL01     MOVE 980001         TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
APEL01     MOVE 02             TO  COD-CTA-BDACSV                       RMB0004
APEL01     MOVE "APELLID-01"   TO  NUM-CTA-BDACSV                       RMB0004
APEL01     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSV               RMB0004
APEL01     MOVE ".-,"                   TO  NOMBRE-BDACSV(43:3)         RMB0004
APEL01     MOVE 20110801       TO  FECHA-CREA-BDACSV                    RMB0004
APEL01     MOVE 0              TO  NUM-PORTAF-BDACSV                    RMB0004
APEL01     MOVE 0              TO  IND-NOMBRE-BDACSV                    RMB0004
APEL01     MOVE 0              TO  MEJOR-PORTAF-BDACSV                  RMB0004
APEL01     MOVE 0              TO  IND-ACTUALIZ-BDACSV                  RMB0004
APEL01     MOVE 01             TO  FUENTE-REG-BDACSV.                   RMB0004
APEL01 1100-LLENAR-AUX-BDAMATCH.                                        RMB0004
REMARK***********************************************************************
REMARK*1100-LLENAR-AUX-BDAMATCH.         
REMARK* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE  
REMARK* TAMAÑO                                                              
REMARK***********************************************************************
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .          RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .          RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .          RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .          RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .          RMB0004
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .          RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .          RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .          RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .          RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .          RMB0004
APEL01     MOVE 0 TO FALLECIDO-BDAMATCH.                                RMB0004
       1100-UBICAR-CHKCRE-CSV-BDAMATCH.        
REMARK***********************************************************************
REMARK*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
REMARK* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
REMARK***********************************************************************
           MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .        
           MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .        
           MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .        
           MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .        
           MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .        
           MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .        
           MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .        
           MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .        
           MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .        
           MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .        
VIGE01     MOVE 0 TO FALLECIDO-BDAMATCH                                 RMB0003
           IF COD-CTA-BDACSV = 01 OR 51         
              MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECK         
              READ MAESTRO-CHECK IGNORE LOCK INVALID KEY         
                   MOVE 0 TO PROCESAR-BDAMATCH        
VIGE01        NOT INVALID KEY                                           RMB0003
BLOQ01            IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)                  RMB0004
SINBLQ                AND CONSECUTIVO-ABD06 = 1
VIGE01               IF ADJETIVO-ABD06 = 1                              RMB0003
VIGE01                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
VIGE01               END-IF                                             RMB0003
SINBLQ            ELSE                                                  RMB0003
SINBLQ               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
SINBLQ            END-IF                                                RMB0003
SINBLQ        END-READ        
           ELSE        
              MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDIT         
              READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY         
                   MOVE 0 TO PROCESAR-BDAMATCH        
VIGE01        NOT INVALID KEY                                           RMB0003
BLOQ01            IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)                  RMB0004
SINBLQ               AND CONSECUTIVO-ABD07 = 1
VIGE01               IF ADJETIVO1-ABD07 = 1 OR                          RMB0003
VIGE01                  ADJETIVO2-ABD07 = 1 OR                          RMB0003
VIGE01                  ADJETIVO3-ABD07 = 1                             RMB0003
VIGE01                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
VIGE01               END-IF                                             RMB0003
SINBLQ            ELSE                                                  RMB0003
SINBLQ               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
VIGE01            END-IF                                                RMB0003
              END-READ        
           END-IF.        
              
       1200-PROC-REG-CSV-BDAMATCH.                                        
REMARK***********************************************************************
REMARK*1200-PROC-REG-CSV-BDAMATCH.                      
REMARK* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
REMARK* SI LO HAY
REMARK***********************************************************************
           IF MAX-CUENTAS-BDAMATCH = 0        
              PERFORM 1000-U-INICIALIZAR-BDAMATCH         
           END-IF.        
           MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.        
           MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLM
           PERFORM 2000-U-INSERTAR-CTA-BDAMATCH.         
           MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.                    
           PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.         
           MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.        
           READ MAESTRO-DIRECC IGNORE LOCK                                      
MEJO01*         NOT INVALID KEY                                         RMB0004
MEJO01*             PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                 RMB0004
MEJO01          INVALID KEY                                             RMB0004
MEJO01              MOVE SPACES TO LLAVE-DIRECC                         RMB0004
           END-READ.        
MEJO01     IF LLAVE-DIRECC <> SPACES                                    RMB0004
MEJO01        PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                       RMB0004
MEJO01     END-IF.                                                      RMB0004
              
       1210-DIRTEL-BDACSV-BDAMATCH.        
REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.
REMARK* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
REMARK* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
REMARK***********************************************************************
           IF CIURES-DIRECC NOT = SPACES        
              IF DIRRES-DIRECC NOT = SPACES         
                 MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCH        
                 PERFORM 2000-U-INSERTAR-DIR-BDAMATCH          
              END-IF        
              IF TELRES-DIRECC > 0 AND         
                 TELRES-DIRECC < 9999999999        
                 MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCH            
                 PERFORM 2000-U-INSERTAR-TEL-BDAMATCH         
              END-IF        
           END-IF.        
           IF CIULAB-DIRECC NOT = SPACES                        
              IF DIRLAB-DIRECC NOT = SPACES         
                 MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCH        
                 PERFORM 2000-U-INSERTAR-DIR-BDAMATCH         
              END-IF                                          
              IF TELLAB-DIRECC > 0 AND         
                 TELLAB-DIRECC < 9999999999                  
                 MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCH            
                 PERFORM 2000-U-INSERTAR-TEL-BDAMATCH         
              END-IF                                            
           END-IF.                                             
           IF CIUCOR-DIRECC NOT = SPACES AND         
              DIRCOR-DIRECC NOT = SPACES        
              MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCH        
              PERFORM 2000-U-INSERTAR-DIR-BDAMATCH        
           END-IF.        
              
       8000-U-VER-CTAABD07-BDAMATCH.           
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.  
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************
           IF IDE-TIPO-BDAMATCH = 1        
              MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCH        
              PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH         
              IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9        
                 MOVE 0 TO IND-BLOQUEO-ABD07        
              END-IF        
           END-IF.        
              
       8000-U-VER-CTAABD06-BDAMATCH.          
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD06-BDAMATCH.  
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************
           IF IDE-TIPO-BDAMATCH = 1        
              MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCH        
              PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH         
              IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9        
                 MOVE 0 TO IND-BLOQUEO-ABD06        
              END-IF        
           END-IF.        
              
REMARK*======================================================================
       1000-U-INICIALIZAR-BDAMATCH.          
REMARK********************************************************************
REMARK*1000-U-INICIALIZAR-BDAMATCH.
REMARK* INPUT = VACIO 
REMARK* OUTPUT= VACIO 
REMARK* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
REMARK* DEl MATCH.
REMARK********************************************************************
           MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.        
           MOVE 0 TO I-CTA-BDAMATCH.        
PESO01     INITIALIZE TABLA-CUENTAS-BDAMATCH.                           RMB0004
           INITIALIZE TABLA-DIR-BDAMATCH.             
           INITIALIZE TABLA-TEL-BDAMATCH.           
           INITIALIZE TABLA-NOM-BDAMATCH.        
           INITIALIZE TABLA-GRUNOM-BDAMATCH.                  
           INITIALIZE V-INTERRELAC-BDAMATCH.         
           MOVE ZEROS   TO POSIC-SUSC-BDAMATCH        
                            POSIC-SUS-GRU-BDAMATCH        
           MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH        
           MOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.        
              
       2000-U-INSERTAR-DIR-BDAMATCH.         
REMARK********************************************************************
REMARK*2000-U-INSERTAR-DIR-BDAMATCH. 
REMARK* INPUT = DIR-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO 
REMARK* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
REMARK* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
REMARK* LA DIRECCION CONTENGA ALGUN NUMERO
REMARK********************************************************************
           MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.        
           MOVE 1 TO I-BDAMATCH                                                 
           MOVE 0 TO J-BDAMATCH                                                 
           MOVE " " TO CAR-ANT-BDAMATCH                                         
           INITIALIZE T-CARTOT-BDAMATCH                                         
CARTOT     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10            CAV0002 
             IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERIC                         
                MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCH        
                IF CAR-ANT-BDAMATCH   NUMERIC                                   
                   COMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)           
                           = V-CARTOT-BDAMATCH  (J-BDAMATCH)                    
                           * 10 + CAR-ACT-BDAMATCH                              
                ELSE        
                   ADD 1 TO J-BDAMATCH                                          
                   MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)                         
                        TO V-CARTOT-BDAMATCH  (J-BDAMATCH)                      
                END-IF        
             END-IF        
             MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCH            
             ADD 1 TO I-BDAMATCH                                                
           END-PERFORM.        
           SORT V-CARTOT-BDAMATCH   DESCENDING.                                 
           IF T-CARTOT-BDAMATCH   NOT = ZEROS AND         
              I-DIR-BDAMATCH < LIM-BDAMATCH        
              MOVE T-CARTOT-BDAMATCH TO         
                   NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)        
              MOVE SUSC-CTAS-BDAMATCH TO         
                   SUS-DIR-BDAMATCH(I-DIR-BDAMATCH)        
              MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)        
              PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1        
                       UNTIL  POSIC-SUMA-BDAMATCH  >  10 OR        
                       V-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZERO        
                 ADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)        
              END-PERFORM        
              ADD 1 TO I-DIR-BDAMATCH        
           END-IF.        
              
       2000-U-INSERTAR-TEL-BDAMATCH.          
REMARK********************************************************************
REMARK*2000-U-INSERTAR-TEL-BDAMATCH. 
REMARK* INPUT = TEL-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO 
REMARK* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO     
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
REMARK********************************************************************
           IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0        
              MOVE TEL-INPUT-BDAMATCH TO         
                                      NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)        
              MOVE SUSC-CTAS-BDAMATCH TO         
                                      SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)        
              MOVE I-CTA-BDAMATCH     TO         
                                      CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)        
              ADD 1 TO I-TEL-BDAMATCH        
           END-IF.        
              
       2000-U-INSERTAR-NOM-BDAMATCH.          
REMARK********************************************************************
REMARK*2000-U-INSERTAR-NOM-BDAMATCH. 
REMARK* INPUT = NOM-INPUT-BDAMATCH 
REMARK* OUTPUT= VACIO 
REMARK* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE                  
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************
           IF I-NOM-BDAMATCH < LIM-BDAMATCH AND         
              NOM-INPUT-BDAMATCH <> SPACES        
              MOVE NOM-INPUT-BDAMATCH  TO         
                   NOM-NOM-BDAMATCH(I-NOM-BDAMATCH)        
                                         NOM-LIMPI-BDAMATCH        
              MOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)        
              MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCH        
                                  NRO-VECES-2-BDAMATCH        
              PERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1        
                UNTIL  NRO-VECES-1-BDAMATCH  >  60        
                IF NRO-VECES-1-BDAMATCH  >  1 AND        
                 NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "        
                   SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCH        
                END-IF        
                IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "        
                  COMPUTE  NRO-VECES-2-BDAMATCH =         
                           60 - NRO-VECES-1-BDAMATCH        
                  MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +         
                        1:NRO-VECES-2-BDAMATCH)        
                      TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)        
                  IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +         
                     1:NRO-VECES-2-BDAMATCH) = SPACES        
                     MOVE  85           TO  NRO-VECES-1-BDAMATCH        
                  END-IF        
                END-IF        
              END-PERFORM        
              INSPECT NOM-LIMPI-BDAMATCH        
                      TALLYING       PESO-CTAS-TOT-BDAMATCH        
                      FOR CHARACTERS BEFORE INITIAL " "        
              MOVE  PESO-CTAS-TOT-BDAMATCH TO         
                    LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)        
FUEN01        IF FUENTE-REG-BDACSV >= 02                                RMB0004
FUEN01           MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)            RMB0004
FUEN01        END-IF                                                    RMB0004
              MOVE  SUSC-CTAS-BDAMATCH TO         
                    SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)        
              ADD 1 TO I-NOM-BDAMATCH        
           END-IF.        
              
       2000-U-INSERTAR-CTA-BDAMATCH.         
REMARK********************************************************************
REMARK*2000-U-INSERTAR-CTA-BDAMATCH.  
REMARK* INPUT = CTA-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO 
REMARK* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA        
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************
           IF I-CTA-BDAMATCH < LIM-BDAMATCH AND         
              CTA-INPUT-BDAMATCH <> SPACES        
              ADD 1 TO I-CTA-BDAMATCH        
              MOVE CTA-INPUT-BDAMATCH TO         
                   CTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)        
              MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH         
VIGE01        MOVE FALLECIDO-BDAMATCH TO                                RMB0003
VIGE01             CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)               RMB0003
FUEN01        IF FUENTE-REG-BDACSV >= 2                                 RMB0004
FUEN01           MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)      RMB0004
FUEN01        END-IF                                                    RMB0004
           END-IF.        
       3000-U-ORDENAR-DIR-BDAMATCH.        
REMARK********************************************************************
REMARK*3000-U-ORDENAR-DIR-BDAMATCH.
REMARK* INPUT = TABLA DE DIRECCIONES LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
REMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON    
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                      
REMARK********************************************************************
           SORT T-DIR-BDAMATCH        
                DESCENDING NUM-DIR-BDAMATCH         
                ASCENDING  CTA-DIR-BDAMATCH.        
           MOVE 1 TO I-CTA-BDAMATCH.        
           MOVE 0 TO FIL-FUE-BDAMATCH        
           MOVE 1 TO COL-FUE-BDAMATCH        
           MOVE 999                TO CTA-DIR-ANT-BDAMATCH        
           MOVE ALL "9"            TO NUM-DIR-ANT-BDAMATCH        
           PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR        
                               CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0        
             IF NUM-DIR-ANT-BDAMATCH <>         
                                       NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)        
                ADD  1 TO FIL-FUE-BDAMATCH        
                MOVE 1 TO COL-FUE-BDAMATCH        
                MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO        
                     CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)        
                MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)        
                ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)        
                MOVE  I-CTA-BDAMATCH       TO  POSIC-SUMA-BDAMATCH        
                ADD 1 TO COL-FUE-BDAMATCH        
             ELSE        
                IF CTA-DIR-ANT-BDAMATCH <>         
                   CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)        
                   MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO        
                     CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)        
                   MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)        
                   ADD 1 TO COL-FUE-BDAMATCH        
                END-IF        
                  ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)        
             END-IF        
             MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO         
                                                CTA-DIR-ANT-BDAMATCH        
             MOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO         
                                                 NUM-DIR-ANT-BDAMATCH        
             ADD 1 TO I-CTA-BDAMATCH        
           END-PERFORM.        
           MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.        
              
       3000-U-ORDENAR-TEL-BDAMATCH.        
REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.
REMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS    
REMARK* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON    
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                      
REMARK********************************************************************
           SORT T-TEL-BDAMATCH        
                DESCENDING NUM-TEL-BDAMATCH        
                ASCENDING  CTA-TEL-BDAMATCH .        
           MOVE 1 TO I-CTA-BDAMATCH.        
           MOVE 1 TO COL-FUE-BDAMATCH        
           MOVE 999      TO CTA-TEL-ANT-BDAMATCH        
           MOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCH        
           PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH        
                   OR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0        
                   OR  FIL-FUE-BDAMATCH > LIM-BDAMATCH        
                   OR  COL-FUE-BDAMATCH > LIM-BDAMATCH        
             IF NUM-TEL-ANT-BDAMATCH <>        
                NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)        
                ADD  1 TO FIL-FUE-BDAMATCH        
                MOVE 1 TO COL-FUE-BDAMATCH        
                MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO        
                     CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)        
                MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)        
                ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)        
                MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCH        
                ADD 1 TO COL-FUE-BDAMATCH        
             ELSE        
                IF CTA-TEL-ANT-BDAMATCH <>        
                   CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)        
                   MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO        
                       CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)        
                   MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)        
                   ADD 1 TO COL-FUE-BDAMATCH        
                END-IF        
                  ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)        
             END-IF        
             MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO        
                                                 CTA-TEL-ANT-BDAMATCH        
             MOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO        
                                                 NUM-TEL-ANT-BDAMATCH        
             ADD 1 TO I-CTA-BDAMATCH        
           END-PERFORM.        
           MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.        
              
       3000-U-ORDENAR-NOM-BDAMATCH.        
REMARK********************************************************************
REMARK*3000-U-ORDENAR-NOM-BDAMATCH.
REMARK* INPUT = TABLA DE NOMBRES     LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
REMARK* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************
           SORT T-NOM-BDAMATCH        
                DESCENDING NOM-NOM-BDAMATCH        
                DESCENDING LNG-NOM-BDAMATCH        
                ASCENDING  CTA-NOM-BDAMATCH .        
           MOVE 1 TO I-NOM-BDAMATCH.        
           MOVE 1 TO GRU-NOM-BDAMATCH.        
           MOVE GRU-NOM-BDAMATCH TO         
                GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).        
           MOVE GRU-NOM-BDAMATCH TO         
                GRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).        
           MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO        
                NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).        
           MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TO         
                SUSC-GRUP-SUS-BDAMATCH        
           MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TO         
                SUSC-GRUP-GRU-BDAMATCH        
           PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH        
           IF  INV-BDAMATCH  =  1        
             ADD   1        TO        
             NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))        
           END-IF        
           MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO        
                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
           ADD 1 TO I-NOM-BDAMATCH.        
           PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCH        
                   OR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0        
             MOVE 1 TO I-GRU-BDAMATCH        
             MOVE 0 TO MATCH-OK-OUT-VALNOM        
             PERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =         
                     SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCH        
                     OR MATCH-OK-OUT-VALNOM = 1        
               MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO         
                    NOMBRE-INPUT-VALNOM        
               MOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TO        
                    NOMBOK-INPUT-VALNOM        
VLNIT1         IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3                      RMB0004
VLNIT1            IF NUM-IDE-INPUT-BDAMATCH >= 600000000 AND            RMB0004
VLNIT1               NUM-IDE-INPUT-BDAMATCH <= 999999999                RMB0004
VLNIT1               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004
VLNIT1               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004
VLNIT1            ELSE                                                  RMB0004
VLNIT1               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004
VLNIT1               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004
VLNIT1            END-IF                                                RMB0004
VLNIT1         ELSE                                                     RMB0004
VLNIT1            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004
VLNIT1            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004
VLNIT1         END-IF                                                   RMB0004
APEL01         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004
APEL01            NOMBOK-INPUT-VALNOM(43:3) = ".-,"                     RMB0004
APEL01            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004
APEL01         END-IF                                                   RMB0004
               PERFORM 10000-MATCH-NOMBRES-VALNOM        
               IF MATCH-OK-OUT-VALNOM = 1        
                  MOVE I-GRU-BDAMATCH TO         
                       GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)        
                  MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)        
                                       TO  SUSC-GRUP-SUS-BDAMATCH        
                  MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
                                       TO  SUSC-GRUP-GRU-BDAMATCH        
APEL01            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004
APEL01               MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
APEL01            END-IF                                                RMB0004
                  PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH        
                  IF  INV-BDAMATCH  =  1        
                    ADD   1  TO           
             NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))        
                  END-IF        
                  IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >        
                      LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
                    MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO        
                      LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
PESO01              MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO            RMB0004
PESO01                NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)             RMB0004
                  END-IF        
               END-IF        
               ADD 1 TO I-GRU-BDAMATCH        
             END-PERFORM        
             IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO        
                ADD 1 TO GRU-NOM-BDAMATCH        
                MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO        
                     NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
                MOVE GRU-NOM-BDAMATCH  TO        
                     GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)        
                MOVE GRU-NOM-BDAMATCH  TO         
                     GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLM        
                MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)        
                                   TO  SUSC-GRUP-SUS-BDAMATCH        
                MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
                                   TO  SUSC-GRUP-GRU-BDAMATCH        
                PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH        
                IF  INV-BDAMATCH  =  1        
                  ADD   1   TO           
             NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))        
                END-IF        
                MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO        
                     LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)        
             ELSE                                                    *>         
                MOVE GRU-NOM-BDAMATCH TO         
                     GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLM        
             END-IF        
             ADD 1 TO I-NOM-BDAMATCH        
           END-PERFORM.        
           SORT T-NOM-BDAMATCH        
                DESCENDING NOM-NOM-BDAMATCH        
                DESCENDING GRU-NOMS-BDAMATCH        
                DESCENDING LNG-NOM-BDAMATCH        
                ASCENDING  CTA-NOM-BDAMATCH .        
           MOVE 1 TO I-CTA-BDAMATCH.        
           MOVE 1 TO COL-FUE-BDAMATCH        
           MOVE 999                TO CTA-NOM-ANT-BDAMATCH        
           MOVE ALL "9"            TO GRU-NOM-ANT-BDAMATCH        
           PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH        
                   OR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0        
                   OR FIL-FUE-BDAMATCH > LIM-BDAMATCH        
                   OR COL-FUE-BDAMATCH > LIM-BDAMATCH        
             IF GRU-NOM-ANT-BDAMATCH <>         
                GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)        
                ADD  1 TO FIL-FUE-BDAMATCH        
                MOVE 1 TO COL-FUE-BDAMATCH        
                MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO        
                     CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)        
                MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)        
                ADD 1 TO COL-FUE-BDAMATCH        
             ELSE        
                IF CTA-NOM-ANT-BDAMATCH <>         
                   CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)        
                   MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO        
                        CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)        
                   MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)        
                   ADD 1 TO COL-FUE-BDAMATCH        
                END-IF        
             END-IF        
             MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO        
                  CTA-NOM-ANT-BDAMATCH        
             MOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TO         
                  GRU-NOM-ANT-BDAMATCH        
             ADD 1 TO I-CTA-BDAMATCH        
           END-PERFORM.        
           MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.        
              
       4000-U-INTERELACIONAR-BDAMATCH.        
REMARK********************************************************************
REMARK*4000-U-INTERELACIONAR-BDAMATCH.
REMARK* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
REMARK* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
REMARK* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON    
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                      
REMARK********************************************************************
PESO01*    PERFORM 1110-MOSTRAR-MATRIZ1                                 RMB0004
           MOVE 1 TO MOVIDO-BDAMATCH    .        
           PERFORM UNTIL MOVIDO-BDAMATCH = 0        
              MOVE 0 TO MOVIDO-BDAMATCH        
              MOVE 1 TO FIL-BUS-BDAMATCH        
              PERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCH        
                MOVE 1 TO COL-BUS-BDAMATCH        
                PERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCH        
                  IF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)        
                     > 0        
                  MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)        
                       TO BUSCADO-BDAMATCH        
                     PERFORM 4100-BUSCAR-RELACION-BDAMATCH        
                  ELSE        
                     MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCH        
                  END-IF        
                  ADD 1 TO COL-BUS-BDAMATCH        
                END-PERFORM        
                ADD 1 TO FIL-BUS-BDAMATCH        
              END-PERFORM        
           END-PERFORM.        
              
       4100-BUSCAR-RELACION-BDAMATCH.        
REMARK********************************************************************
REMARK*4100-BUSCAR-RELACION-BDAMATCH.
REMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
REMARK********************************************************************
           MOVE 1 TO FIL-FUE-BDAMATCH.        
           PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH        
              IF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCH        
                 MOVE 0 TO EXISTE-BDAMATCH        
                 INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)         
                    TALLYING EXISTE-BDAMATCH        
                    FOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCH        
                  ADD 1 TO EXISTE-BDAMATCH        
                  IF EXISTE-BDAMATCH <= 2000        
                      PERFORM 4110-MOVER-RELACIONES-BDAMATCH        
                 END-IF        
              END-IF        
              ADD 1 TO FIL-FUE-BDAMATCH        
           END-PERFORM.        
              
       4110-MOVER-RELACIONES-BDAMATCH.        
REMARK********************************************************************
REMARK*4110-MOVER-RELACIONES-BDAMATCH.
REMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
REMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
REMARK********************************************************************
             MOVE 0 TO FIN-FUENTE-BDAMATCH.        
             INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)         
                     TALLYING FIN-FUENTE-BDAMATCH        
                     FOR CHARACTERS BEFORE INITIAL "000 "        
             COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4        
             MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.        
             INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)         
                     TALLYING LIBRE-BUSCADO-BDAMATCH        
                     FOR CHARACTERS BEFORE INITIAL "000 "        
             COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4        
             ADD 1 TO LIBRE-BUSCADO-BDAMATCH.        
             MOVE 1 TO COL-FUE-BDAMATCH.        
             PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCH        
                MOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TO        
                               PORINSERTAR-BDAMATCH        
                MOVE 0 TO EXISTE-BDAMATCH        
                INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)         
                     TALLYING EXISTE-BDAMATCH        
                    FOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCH        
                ADD 1 TO EXISTE-BDAMATCH        
                IF EXISTE-BDAMATCH > 2000        
                  MOVE PORINSERTAR-BDAMATCH TO         
                  CAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)        
                  ADD 1 TO LIBRE-BUSCADO-BDAMATCH        
                  MOVE 1 TO MOVIDO-BDAMATCH        
                END-IF        
                ADD 1 TO COL-FUE-BDAMATCH        
             END-PERFORM.        
             INITIALIZE          
                  FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR        
              
       5000-U-MEJOR-PORTAFOL-BDAMATCH.        
REMARK********************************************************************
REMARK*5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
REMARK* PORTAFOLIO QUE TIENE MAS CUENTAS 
REMARK********************************************************************
            MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.        
            MOVE 0 TO MAXREL-PER-BDAMATCH        
            MOVE 0 TO FIN-FUENTE-BDAMATCH.        
            MOVE 1 TO FIL-FUE-BDAMATCH.        
            MOVE 0 TO  PESOS-CTRL-BDAMATCH        
            PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH        
              INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)         
                     TALLYING FIN-FUENTE-BDAMATCH        
                     FOR CHARACTERS BEFORE INITIAL "000 "        
              COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4        
              MOVE 0 TO PESO-CTAS-TOT-BDAMATCH        
              MOVE 1 TO POSIC-SUMA-BDAMATCH        
PESO01        MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH                   RMB0004
PESO01        MOVE 0 TO  POSIC-SUSC-BDAMATCH                            RMB0004
PESO01        MOVE 0 TO ENT-FIN-PORT-BDAMATCH                           RMB0004
PESO01        MOVE 0 TO ENT-UNICAS-PORT-BDAMATCH                        RMB0004
              PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1          
                 UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCH        
                 MOVE          
              FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)        
                      TO  CTA-A-BUSCAR-BDAMATCH        
PESO01           IF CTA-A-BUSCAR-BDAMATCH > 0                           RMB0004
PESO01            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
PESO01                 TO SUSC-CTAS-BDAMATCH                            RMB0004
AJUS01            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
AJUS01                 TO I2-BDAMATCH                                   RMB0005
PESO01            PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCH               RMB0004
PESO01            PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCH               RMB0004
PESO01            PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCH               RMB0004
PESO01           END-IF                                                 RMB0004
                 ADD 4 TO  POSIC-SUMA-BDAMATCH        
              END-PERFORM        
PESO01        PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCH                    RMB0004
              ADD 1 TO FIL-FUE-BDAMATCH        
            END-PERFORM.        
PESO01 5100-CALCULAR-PESO-DIR-BDAMATCH.                                 RMB0004
PESO01     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1       RMB0004
PESO01        UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH OR           RMB0004
PESO01        CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROS           RMB0004
PESO01        IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)                 RMB0004
PESO01                                     =  CTA-A-BUSCAR-BDAMATCH     RMB0004
PESO01          COMPUTE PESO-CTAS-TOT-BDAMATCH  =                       RMB0004
PESO01                   PESO-CTAS-TOT-BDAMATCH +                       RMB0004
PESO01          (NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *          RMB0004
PESO01                  PESO-DIR-BDAMATCH )                             RMB0004
PESO01        END-IF                                                    RMB0004
PESO01     END-PERFORM.                                                 RMB0004
PESO01 5200-CALCULAR-PESO-TEL-BDAMATCH.                                 RMB0004
PESO01     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1             RMB0004
PESO01        UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH OR              RMB0004
PESO01        CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROS            RMB0004
PESO01        IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)                RMB0004
PESO01                                      =  CTA-A-BUSCAR-BDAMATCH    RMB0004
PESO01          COMPUTE  PESO-CTAS-TOT-BDAMATCH  =                      RMB0004
PESO01             PESO-CTAS-TOT-BDAMATCH +                             RMB0004
PESO01           (NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *         RMB0004
PESO01             PESO-TEL-BDAMATCH )                                  RMB0004
PESO01        END-IF                                                    RMB0004
PESO01     END-PERFORM.                                                 RMB0004
PESO01 5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
REMARK******************************************************************
PESO01*5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
REMARK* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
REMARK* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
REMARK******************************************************************
PESO01     SET IND-DIR-BDAMATCH TO 1.                                   RMB0004
PESO01     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT END                      RMB0004
PESO01         MOVE 1 TO  INV-BDAMATCH                                  RMB0004
PESO01       WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =             RMB0004
PESO01            SUSC-CTAS-BDAMATCH                                    RMB0004
PESO01         MOVE 0 TO  INV-BDAMATCH                                  RMB0004
PESO01     END-SEARCH.                                                  RMB0004
PESO01     IF INV-BDAMATCH  =  1                                        RMB0004
PESO01        AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCH                  RMB0004
PESO01        COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
PESO01                                       + PESO-NOM-BDAMATCH        RMB0004
PESO01        ADD   1                TO  POSIC-SUSC-BDAMATCH            RMB0004
PESO01        MOVE SUSC-CTAS-BDAMATCH  TO                               RMB0004
PESO01             COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)           RMB0004
AJUS01*       MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCH             RMB0005
AJUS01        IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100                 RMB0005
AJUS01           IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2             RMB0005
AJUS01              ADD 1 TO ENT-FIN-PORT-BDAMATCH                      RMB0005
AJUS01           END-IF                                                 RMB0005
AJUS01        END-IF                                                    RMB0005
PESO01        ADD 1 TO ENT-UNICAS-PORT-BDAMATCH                         RMB0004
PESO01     END-IF.                                                      RMB0004
PESO01     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1        RMB0004
PESO01        ADD 1000 TO PESO-CTAS-TOT-BDAMATCH                        RMB0004
PESO01     END-IF.                                                      RMB0004
PESO01 5400-DEDUCIR-MEJ-PORT-BDAMATCH.                                  RMB0004
PESO01     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCH                 RMB0004
PESO01        MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCH        RMB0004
PESO01     END-IF                                                       RMB0004
PESO01     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCH            RMB0004
PESO01        MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
PESO01        MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
PESO01        MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
PESO01     ELSE                                                         RMB0004
PESO01        IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCH         RMB0004
MEJO01           PERFORM 5410-DESEMPATAR-BDAMATCH                       RMB0004
PESO01        END-IF                                                    RMB0004
PESO01     END-IF.                                                      RMB0004
MEJO01 5410-DESEMPATAR-BDAMATCH.                                        RMB0004
MEJO01      IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCH        RMB0004
MEJO01         MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
MEJO01         MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
MEJO01         MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
MEJO01      ELSE                                                        RMB0004
MEJO01         IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
MEJO01            IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 AND      RMB0004
MEJO01               NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
MEJO01                                                             ".-,"RMB0004
MEJO01               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
MEJO01                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01            ELSE                                                  RMB0004
MEJO01              IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >          RMB0004
MEJO01                 LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
MEJO01               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
MEJO01                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01            END-IF                                                RMB0004
MEJO01         END-IF                                                   RMB0004
MEJO01      END-IF.                                                     RMB0004
       5000-U-VALIDAR-CUENTA-BDAMATCH.        
REMARK*********************************************************************
REMARK*5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
REMARK* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
REMARK*********************************************************************
           MOVE 0 TO VALCTA-OUTPUT-BDAMATCH        
           MOVE 1 TO I-BDAMATCH.        
           IF MEJOR-PORTAFOLIO-BDAMATCH > 0         
              PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR         
                VALCTA-OUTPUT-BDAMATCH = 1 OR        
                CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0        
                MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)        
                     TO J-BDAMATCH        
                IF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCH        
                   MOVE 1 TO VALCTA-OUTPUT-BDAMATCH        
                END-IF        
                ADD 1 TO I-BDAMATCH        
              END-PERFORM        
           END-IF.        
      *        
       6000-U-MEJOR-DIR-BDAMATCH.        
REMARK*********************************************************************
REMARK*6000-U-MEJOR-DIR-BDAMATCH.
REMARK*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
REMARK*********************************************************************
           SORT T-DIR-BDAMATCH        
                DESCENDING  NUM-CTAS-DIR-BDAMATCH        
                DESCENDING       LNG-DIR-BDAMATCH        
                DESCENDING       NUM-DIR-BDAMATCH        
                DESCENDING       CTA-DIR-BDAMATCH.        
          MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.        
               
       6000-U-MEJOR-TEL-BDAMATCH.        
REMARK*********************************************************************
REMARK*6000-U-MEJOR-TEL-BDAMATCH.
REMARK*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
REMARK*********************************************************************
           SORT T-TEL-BDAMATCH        
                DESCENDING  NUM-CTAS-TEL-BDAMATCH        
                DESCENDING       NUM-TEL-BDAMATCH        
                DESCENDING       CTA-TEL-BDAMATCH.        
          MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.        
      *        
       6000-U-MEJOR-NOM-BDAMATCH.        
REMARK*********************************************************************
REMARK*6000-U-MEJOR-NOM-BDAMATCH.
REMARK*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
REMARK*********************************************************************
           SORT T-GRUNOM-BDAMATCH        
                DESCENDING  NUM-CTAS-GRUNOM-BDAMATCH        
                DESCENDING  LNG-GRUNOM-BDAMATCH        
                DESCENDING  NOM-GRUNOM-BDAMATCH.        
           MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.        
           PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1        
             UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCH        
                OR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROS        
                OR ESTA-CTA-BDAMATCH  =  1        
            PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1        
             UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH        
                OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROS        
                OR ESTA-CTA-BDAMATCH  =  1        
              IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =        
                  GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)        
               PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1        
                UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCH        
                 OR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,        
                    NRO-VECES-1-BDAMATCH) = 0        
                 OR ESTA-CTA-BDAMATCH  =  1        
                 IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =        
                     CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,        
                                   NRO-VECES-1-BDAMATCH)        
                   MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TO         
                        POSIC-SUS-GRU-BDAMATCH        
                   MOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TO         
                        NOM-OUTPUT-BDAMATCH        
                   MOVE 1 TO  ESTA-CTA-BDAMATCH        
                 END-IF        
               END-PERFORM        
              END-IF        
            END-PERFORM         
           END-PERFORM.        
      *        
       9000-U-REALIZAR-BDAMATCH.        
REMARK******************************************************************
REMARK*9000-U-REALIZAR-BDAMATCH.                                               
REMARK* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL 
REMARK* MEJOR NOMBRE 
REMARK******************************************************************
           MOVE  ZEROS                 TO  POSIC-SUSC-BDAMATCH        
           MOVE  ALL "9"               TO  TABLA-SUSC-DIR-BDAMATCH        
           PERFORM 3000-U-ORDENAR-DIR-BDAMATCH        
           PERFORM 3000-U-ORDENAR-TEL-BDAMATCH        
           PERFORM 3000-U-ORDENAR-NOM-BDAMATCH        
           PERFORM 4000-U-INTERELACIONAR-BDAMATCH        
           PERFORM 6000-U-MEJOR-DIR-BDAMATCH.        
           PERFORM 6000-U-MEJOR-TEL-BDAMATCH.        
           PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.        
           PERFORM 6000-U-MEJOR-NOM-BDAMATCH.        
      *        
       9010-U-VER-FALLECIDO-BDAMATCH.        
REMARK*********************************************************************
REMARK*9010-U-VER-FALLECIDO-BDAMATCH.        
REMARK* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL  
REMARK* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.            
REMARK*********************************************************************
VIGE01     MOVE 1 TO I-BDAMATCH.                                        RMB0003
VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0                             RMB0003
VIGE01        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR                RMB0003
VIGE01          VALCTA-OUTPUT-BDAMATCH = 1 OR                           RMB0003
VIGE01          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
VIGE01          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
VIGE01               TO J-BDAMATCH                                      RMB0003
VIGE01          ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCH                       RMB0003
VIGE01          IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1               RMB0003
VIGE01             ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCH                 RMB0003
VIGE01          END-IF                                                  RMB0003
VIGE01          ADD 1 TO I-BDAMATCH                                     RMB0003
VIGE01        END-PERFORM                                               RMB0003
VIGE01     END-IF.                                                      RMB0003
VIGE01*                                                                 RMB0003
       400-BUSCAR-SUSC-GRUPO-BDAMATCH.        
REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************
           SET IND-NOM-BDAMATCH TO 1.        
           SEARCH ALL REG-SUSC-NOM-BDAMATCH AT END        
               MOVE 1 TO  INV-BDAMATCH        
               WHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =         
                    SUSC-GRUPO-BDAMATCH        
               MOVE 0 TO  INV-BDAMATCH        
           END-SEARCH.        
           IF  INV-BDAMATCH = 1        
           AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCH        
             ADD 1 TO  POSIC-SUS-GRU-BDAMATCH        
             MOVE SUSC-GRUP-SUS-BDAMATCH TO        
                  COD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)        
             MOVE SUSC-GRUP-GRU-BDAMATCH TO          
                  GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)        
           END-IF.        
icjlud@codes /d/iccol/desarrollo/copys
$ ls ^?*

icjlud@codes /d/iccol/desarrollo/copys
$ rm "^?^?"
icjlud@codes /d/iccol/desarrollo/copys
$ ^[[A  $ rm "^?^?"$ ls ^?*   $ 
*: No such file or directory
icjlud@codes /d/iccol/desarrollo/copys
$ vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~No file  line 1 of 1 --100%-- !grep 10000-MATCH-NOMBRES-VALNOM *^[[D^[[D^[[D^[[D^[[D^[[D^[[Cgrep: can't open CARACTCAL-V02.PROC-BCK10
grep: can't open CARACTCAL-V02.PROC-BCK11
grep: can't open CARACTCAL-V02.PROC-BCK5
grep: can't open CARACTCAL-V02.PROC-BCK6
grep: can't open CARACTCAL-V02.PROC-BCK7
grep: can't open CARACTCAL-V02.PROC-BCK9
grep: can't open CARACTPER-009.PROC-2012-01-06
grep: can't open core
grep: can't open FRAINQ.DAT
BDAGCLA.PROC.0005:MODBDI*PERFORM 10000-MATCH-NOMBRES-VALNOMFAC000
3
BDAGCLA.PROC.20030529:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAGCLA.PROC.ORI:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCH.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCH.PROC-DAR:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCH.PROC-V02:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCH.PROC-V03:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCHNEW-EHA.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCHNEW.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDAMATCHRMB.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIALEDB2.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE_PRO.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE-2836.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE-2836.PROC:MICCSVPERFORM 10000-MATCH-NOMBRES-VALNOMCAV00
07
BDIIVIDE-BDAIDE.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
bdiivide.flor:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC-CV:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC-MAL:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC-MAL:MICCSVPERFORM 10000-MATCH-NOMBRES-VALNOMCAV000
7
BDIIVIDE.PROC-PROD:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC-V06:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC-V07:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDE.PROC-V07:MICCSVPERFORM 10000-MATCH-NOMBRES-VALNOMCAV000
7
BDIIVIDECOL.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDEECU.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
BDIIVIDENEW.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
DECIS3.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
DECIS3.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
grace.proc:PERFORM 10000-MATCH-NOMBRES-VALNOM
INDEREGI.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
INDEREGI.PROC-ANT:PERFORM 10000-MATCH-NOMBRES-VALNOM
INDEREGI.PROC.F-OLD!:PERFORM 10000-MATCH-NOMBRES-VALNOM
INDEREGIV01.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
MOTOALE-CV.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
MOTOALE.PROC:PERFORM 10000-MATCH-NOMBRES-VALNOM
59 more linesg
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
9 fewer lines!grep -il 10000-MATCH-NOMBRES-VALNOM *grep: can't open CARACTCAL-V02.PROC-BCK10
grep: can't open CARACTCAL-V02.PROC-BCK11
grep: can't open CARACTCAL-V02.PROC-BCK5
grep: can't open CARACTCAL-V02.PROC-BCK6
grep: can't open CARACTCAL-V02.PROC-BCK7
grep: can't open CARACTCAL-V02.PROC-BCK9
grep: can't open CARACTPER-009.PROC-2012-01-06
grep: can't open core
grep: can't open FRAINQ.DAT
BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCH.PROC-DAR
BDAMATCH.PROC-V02
BDAMATCH.PROC-V03
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE-2836.PROC
BDIIVIDE-BDAIDE.PROC
bdiivide.flor
BDIIVIDE.PROC
BDIIVIDE.PROC-CV
BDIIVIDE.PROC-MAL
BDIIVIDE.PROC-PROD
BDIIVIDE.PROC-V06
BDIIVIDE.PROC-V07
BDIIVIDECOL.PROC
BDIIVIDEECU.PROC
BDIIVIDENEW.PROC
DECIS3.PROC
grace.proc
INDEREGI.PROC
INDEREGI.PROC-ANT
INDEREGI.PROC.F-OLD!
INDEREGIV01.PROC
MOTOALE-CV.PROC
MOTOALE.PROC
MOTOALE.PROC-DEMO
qqq
RECONOCER-ESP.PROC
SCODRU.PROC1
SCODRU.PROC1.20030529
SCODRUCIG.PROC1
SCODRUFAC.PROC1
UTLINDEREGI.PROC
54 more lines













SCODRUFAC.PROC1
UTLINDEREGI.PROC
UTLLEY.PROC
VALNOM.PROC
VALNOM.PROC.0002
VALNOM.PROC.NUE
VALNOMGJ.ANT.PROC
VALNOMGJ.PROC
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~No file  line 48 of 55 --87%-- grep: can't open CARACTCAL-V02.PROC-BCK10
grep: can't open CARACTCAL-V02.PROC-BCK11
grep: can't open CARACTCAL-V02.PROC-BCK5
grep: can't open CARACTCAL-V02.PROC-BCK6
grep: can't open CARACTCAL-V02.PROC-BCK7
grep: can't open CARACTCAL-V02.PROC-BCK9
grep: can't open CARACTPER-009.PROC-2012-01-06
grep: can't open core
grep: can't open FRAINQ.DAT
BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCH.PROC-DAR
BDAMATCH.PROC-V02
BDAMATCH.PROC-V03
BDAMATCHNEW-EHA.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE-2836.PROC
BDIIVIDE-BDAIDE.PROC
bdiivide.flor
BDIIVIDE.PROC
BDIIVIDE.PROC-CV
BDIIVIDE.PROC-MAL
BDIIVIDE.PROC-PROD
BDIIVIDE.PROC-V06
BDIIVIDE.PROC-V07
BDIIVIDECOL.PROC
BDIIVIDEECU.PROC
BDIIVIDENEW.PROC
DECIS3.PROC
grace.proc
INDEREGI.PROC
INDEREGI.PROC-ANT
INDEREGI.PROC.F-OLD!
INDEREGIV01.PROC
MOTOALE-CV.PROC
MOTOALE.PROC
MOTOALE.PROC-DEMO
qqq
RECONOCER-ESP.PROC
SCODRU.PROC1
SCODRU.PROC1.20030529
SCODRUCIG.PROC1
SCODRUFAC.PROC1
UTLINDEREGI.PROC/leemaesPattern not found







UTLLEY.PROC
VALNOM.PROC
VALNOM.PROC.0002
VALNOM.PROC.NUE
VALNOMGJ.ANT.PROC
VALNOMGJ.PROC
~
~
~
9 lines deleted



~
~
~~



:r BDIIVIDE_PRO.PROC"BDIIVIDE_PRO.PROC" 283 lines, 18101 characters REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
      *             * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      *             * INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
      * FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
      * AGO.11/2004 * DIGITO DE CHEQUEO.
      * FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
      *             * CORRESPONDE AL RANGO.
REMARK******************************************************************
      * F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
      * F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
      * OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
      * FAC006C     *
REMARK******************************************************************
       80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*
 INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM
 NOMBRES-AUX-W-BDIIVIDE
 INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002



























80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0
IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1
MOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IFELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IF
END-IF
PERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0
MOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IF
END-IF
END-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.80200-VALIDAR-ID.
REMARK*===================================*
REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacion
REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEWHEN 1
PERFORM 85010-UBICA-CEDULAWHEN 2
PERFORM 85020-UBICA-NITWHEN 3
PERFORM 85020-UBICA-NITWHEN 4
PERFORM 85030-UBICA-EXTWHEN OTHER
MOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004
NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005
NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01END-IF.FAC0002

NUIP01 80400-VALIDAR-TIPO-ID.FAC0002
REMARK*================================================================
NUIP01*80400-VALIDAR-TIPO-ID.FAC0002
NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002
NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002
NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002
NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002
REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002
NUIP01WHEN 1FAC0002
NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005
NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005
NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03END-IFFAC0004
NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC000485010-UBICA-CEDULA.
REMARK*================================================================
REMARK*85010-UBICA-CEDULA.
REMARK*Ubica la identificacion dada la llave en BDIIREGI
REMARK*Arma el nombre completo en una sola variable
REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READ
IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0STRING
SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING
SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEEND-IF
IF ESTADO-CIVIL-BDIIREGI = 1STRING
"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEEND-IF
IF ESTADO-CIVIL-BDIIREGI = 2STRING
"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEEND-IF
STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",
DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.
REMARK*================================================================
REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READ
IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.85030-UBICA-EXT.
REMARK*================================================================
REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READ
IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.
BDIIVIDE-2836.PROC
BDIIVIDE-BDAIDE.PROC
bdiivide.flor
BDIIVIDE.PROC
BDIIVIDE.PROC-CV
BDIIVIDE.PROC-MAL
BDIIVIDE.PROC-PROD
BDIIVIDE.PROC-V06
BDIIVIDE.PROC-V07
BDIIVIDECOL.PROC
BDIIVIDEECU.PROC
BDIIVIDENEW.PROC
DECIS3.PROC
grace.proc
INDEREGI.PROC
INDEREGI.PROC-ANT
INDEREGI.PROC.F-OLD!
INDEREGIV01.PROC
MOTOALE-CV.PROC
MOTOALE.PROC
MOTOALE.PROC-DEMO
qqq
RECONOCER-ESP.PROC
SCODRU.PROC1
SCODRU.PROC1.20030529
SCODRUCIG.PROC1
SCODRUFAC.PROC1
UTLINDEREGI.PROC
UTLLEY.PROCSTRING
SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEEND-IF
IF ESTADO-CIVIL-BDIIREGI = 1STRING
"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEEND-IF
IF ESTADO-CIVIL-BDIIREGI = 2STRING
"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEEND-IF
STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",
DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.
REMARK*================================================================
REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READ
IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.85030-UBICA-EXT.
REMARK*================================================================
REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READ
IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.
BDIIVIDE-2836.PROC
BDIIVIDE-BDAIDE.PROC
bdiivide.flor
BDIIVIDE.PROC
BDIIVIDE.PROC-CV
BDIIVIDE.PROC-MAL
BDIIVIDE.PROC-PROD
BDIIVIDE.PROC-V06
BDIIVIDE.PROC-V07
BDIIVIDECOL.PROC
BDIIVIDEECU.PROC
BDIIVIDENEW.PROC
DECIS3.PROC
grace.proc
INDEREGI.PROC
INDEREGI.PROC-ANT
INDEREGI.PROC.F-OLD!
INDEREGIV01.PROC
MOTOALE-CV.PROC
MOTOALE.PROC
MOTOALE.PROC-DEMO
qqq
RECONOCER-ESP.PROC
SCODRU.PROC1
SCODRU.PROC1.20030529
SCODRUCIG.PROC1
SCODRUFAC.PROC1
UTLINDEREGI.PROC
UTLLEY.PROCBDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     *
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002:w! qqq"qqq" 325 lines, 18785 characters sdiff -w 170 BDIIVIDE_PRO.PROC BDIIVIDE_PRO.PROCC > qqqq!sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqqNUIP01    END-IF                                    FAC0002









:r qqqq"qqqq" 287 lines, 42377 characters 

REMARK*BDIIVIDE.PROC.v.03.0008|  REMARK*BD
IIVIDE.PROC.v.03.0006

REMARK******************************************************************REMARK***
***************************************************************

REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONESREMARK*RU
TINA DE VALIDACION DE IDENTIFICACIONES

REMARK******************************************************************REMARK***
***************************************************************

      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE* F
.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE

      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS* J
UN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS

      *             * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID

      *      * INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID

      * FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.* F
AC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.

REMARK******************************************************************REMARK***
***************************************************************

      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON* F
.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON

      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO* J
UL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO

      * FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2* F
AC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2

REMARK***
***************************************************************

      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL* F
.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL

      * AGO.11/2004 * DIGITO DE CHEQUEO.                                * A
GO.11/2004 * DIGITO DE CHEQUEO.

AC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO      * F
AC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO

            * CORRESPONDE AL RANGO.                        ** CORRESPONDE AL RANGO.

REMARK******************************************************************REMARK***
***************************************************************

F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:* F
.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:

OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* O
CT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)

      * FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:       * F
AC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:

            * ENTRE 900.000.000 Y 999.999.999 (MUISCA)     ** ENTRE 900.000.000 Y 999.999.999 (MUISCA)

REMARK******************************************************************REMARK***
***************************************************************
REMARK*BDIIVIDE.PROC.v.03.0008|  REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONESREMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.** CORRESPONDE AL RANGO.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     ** FAC006C     *
REMARK******************************************************************REMARK******************************************************************
* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS<
* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA<
* CAV0008     * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.<
REMARK******************************************************************<
80100-VALIDAR-IDENTIFICACION.80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datosREMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGIREMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportadoREMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDENOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1ELSE  IF TIP-ID-INPUT-VALNOM = 1MOVE 2 TO BLOQUES-INPUT-VALNOMMOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IFEND-IFEND-IFEND-IFPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.END-IF.80200-VALIDAR-ID.80200-VALIDAR-ID.
REMARK*===================================*REMARK*===================================*
REMARK*80200-VALIDAR-ID.REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacionREMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamenteREMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacionREMARK*Dependiendo del tipo de identificacion
REMARK*===================================*REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEEVALUATE TIP-IDE-BDIIVIDEWHEN 1WHEN 1PERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULAWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 3WHEN 3PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 3WHEN 3PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 4WHEN 4PERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXTWHEN OTHERWHEN OTHERMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.END-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDENUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004NUIP03*END-IFFAC0004
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005
NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01END-IF.FAC0002NUIP01END-IF.FAC0002

NUIP01 80400-VALIDAR-TIPO-ID.FAC0002NUIP01 80400-VALIDAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80400-VALIDAR-TIPO-ID.FAC0002NUIP01*80400-VALIDAR-TIPO-ID.FAC0002
NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002
NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002
NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002
NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002
NUIP01WHEN 1FAC0002NUIP01WHEN 1FAC0002
NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002NUIP01WHEN 2FAC0002NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006CNUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacionREMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005
NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005
NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC0004NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC000485010-UBICA-CEDULA.85010-UBICA-CEDULA.
REMARK*================================================================REMARK*================================================================
REMARK*85010-UBICA-CEDULA.REMARK*85010-UBICA-CEDULA.
REMARK*Ubica la identificacion dada la llave en BDIIREGIREMARK*Ubica la identificacion dada la llave en BDIIREGI
REMARK*Arma el nombre completo en una sola variableREMARK*Arma el nombre completo en una sola variable
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGSEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1STRINGSTRING"DE" DELIMITED BY SIZE,"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRINGSTRING"VDA DE" DELIMITED BY SIZE,"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFSTRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",DELIMITED BY SIZE,DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.85020-UBICA-NIT.
REMARK*================================================================REMARK*================================================================
REMARK*85020-UBICA-NIT.REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIANREMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.85030-UBICA-EXT.85030-UBICA-EXT.
REMARK*================================================================REMARK*================================================================
REMARK*85030-UBICA-EXT.REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DASREMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     ** OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* FAC006C     *
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0
IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1
MOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IF
END-IF
PERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0
MOVE 1 TO SW-NOMBRES-BDIIVIDEIF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IF
END-IF
END-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.80200-VALIDAR-ID.
REMARK*===================================*
REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacion
REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEWHEN 1
PERFORM 85010-UBICA-CEDULAWHEN 2
PERFORM 85020-UBICA-NITWHEN 3
PERFORM 85020-UBICA-NITWHEN 4
PERFORM 85030-UBICA-EXTWHEN OTHER
MOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004
NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005
NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01END-IF.FAC0002

NUIP01 80400-VALIDAR-TIPO-ID.FAC0002
REMARK*================================================================
NUIP01*80400-VALIDAR-TIPO-ID.FAC0002
NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002
NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002
NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002
NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002
REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002
NUIP01WHEN 1FAC0002
NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IF
END-IF
END-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002
NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.80200-VALIDAR-ID.
REMARK*===================================*
REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacion
REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEWHEN 1
PERFORM 85010-UBICA-CEDULAWHEN 2
PERFORM 85020-UBICA-NITWHEN 3
PERFORM 85020-UBICA-NITWHEN 4
PERFORM 85030-UBICA-EXTWHEN OTHER
MOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* FAC006C     *
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0
IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1
MOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IF
END-IF
PERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0
MOVE 1 TO SW-NOMBRES-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.85030-UBICA-EXT.85030-UBICA-EXT.
REMARK*================================================================REMARK*================================================================
REMARK*85030-UBICA-EXT.REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DASREMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     *
REMARK*BDIIVIDE.PROC.v.03.0008|  REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONESREMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.** CORRESPONDE AL RANGO.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     ** FAC006C     *
REMARK******************************************************************REMARK******************************************************************
* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS<
* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA<
* CAV0008     * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.<
REMARK******************************************************************<
80100-VALIDAR-IDENTIFICACION.80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datosREMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGIREMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportadoREMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDENOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSsdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1ELSE  IF TIP-ID-INPUT-VALNOM = 1MOVE 2 TO BLOQUES-INPUT-VALNOMMOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IFEND-IFEND-IFEND-IFPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.END-IF.80200-VALIDAR-ID.80200-VALIDAR-ID.
REMARK*===================================*REMARK*===================================*
REMARK*80200-VALIDAR-ID.REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacionREMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamenteREMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacionREMARK*Dependiendo del tipo de identificacion
REMARK*===================================*REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEEVALUATE TIP-IDE-BDIIVIDEWHEN 1WHEN 1PERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULAWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITsdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

REMARK*BDIIVIDE.PROC.v.03.0008|  REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONESREMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.** CORRESPONDE AL RANGO.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     ** FAC006C     *
REMARK******************************************************************REMARK******************************************************************
* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS<
* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA<
* CAV0008     * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.<
REMARK******************************************************************<
80100-VALIDAR-IDENTIFICACION.80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datosREMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGIREMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportadoREMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDENOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1ELSE  IF TIP-ID-INPUT-VALNOM = 1MOVE 2 TO BLOQUES-INPUT-VALNOMMOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IFEND-IFEND-IFEND-IFPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.END-IF.80200-VALIDAR-ID.80200-VALIDAR-ID.
REMARK*===================================*REMARK*===================================*
REMARK*80200-VALIDAR-ID.REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacionREMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamenteREMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacionREMARK*Dependiendo del tipo de identificacion
REMARK*===================================*REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEEVALUATE TIP-IDE-BDIIVIDEWHEN 1WHEN 1PERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULAWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 3WHEN 3PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 4WHEN 4PERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXTWHEN OTHERWHEN OTHERMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.END-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDENUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004NUIP03*END-IFFAC0004
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005
NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01END-IF.FAC0002NUIP01END-IF.FAC0002

NUIP01 80400-VALIDAR-TIPO-ID.FAC0002NUIP01 80400-VALIDAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80400-VALIDAR-TIPO-ID.FAC0002NUIP01*80400-VALIDAR-TIPO-ID.FAC0002
NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002
NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002
NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002
NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002
NUIP01WHEN 1FAC0002NUIP01WHEN 1FAC0002
NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006CNUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacionREMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005
NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005
NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC0004NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC000485010-UBICA-CEDULA.85010-UBICA-CEDULA.
REMARK*================================================================REMARK*================================================================
REMARK*85010-UBICA-CEDULA.REMARK*85010-UBICA-CEDULA.
REMARK*Ubica la identificacion dada la llave en BDIIREGIREMARK*Ubica la identificacion dada la llave en BDIIREGI
REMARK*Arma el nombre completo en una sola variableREMARK*Arma el nombre completo en una sola variable
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGSEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1STRINGSTRING"DE" DELIMITED BY SIZE,"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRINGSTRING"VDA DE" DELIMITED BY SIZE,"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFSTRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",DELIMITED BY SIZE,DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.85020-UBICA-NIT.
REMARK*================================================================REMARK*================================================================
REMARK*85020-UBICA-NIT.REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIANREMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANNUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006CNUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacionREMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005
NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005
NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC0004NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC000485010-UBICA-CEDULA.85010-UBICA-CEDULA.
REMARK*================================================================REMARK*================================================================
REMARK*85010-UBICA-CEDULA.REMARK*85010-UBICA-CEDULA.
REMARK*Ubica la identificacion dada la llave en BDIIREGIREMARK*Ubica la identificacion dada la llave en BDIIREGI
REMARK*Arma el nombre completo en una sola variableREMARK*Arma el nombre completo en una sola variable
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGSEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1STRINGSTRING"DE" DELIMITED BY SIZE,"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRINGSTRING"VDA DE" DELIMITED BY SIZE,"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFSTRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",DELIMITED BY SIZE,DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.85020-UBICA-NIT.
REMARK*================================================================REMARK*================================================================
REMARK*85020-UBICA-NIT.REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIANREMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.85030-UBICA-EXT.85030-UBICA-EXT.
REMARK*================================================================REMARK*================================================================
REMARK*85030-UBICA-EXT.REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DASREMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 ENsdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

REMARK*BDIIVIDE.PROC.v.03.0008|  REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONESREMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.** CORRESPONDE AL RANGO.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     ** FAC006C     *
REMARK******************************************************************REMARK******************************************************************
* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS<
* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA<
* CAV0008     * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.<
REMARK******************************************************************<
80100-VALIDAR-IDENTIFICACION.80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datosREMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGIREMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportadoREMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDENOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1ELSE  IF TIP-ID-INPUT-VALNOM = 1MOVE 2 TO BLOQUES-INPUT-VALNOMMOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IFEND-IFEND-IFEND-IFPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.END-IF.80200-VALIDAR-ID.80200-VALIDAR-ID.
REMARK*===================================*REMARK*===================================*
REMARK*80200-VALIDAR-ID.REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacionREMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamenteREMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacionREMARK*Dependiendo del tipo de identificacion
REMARK*===================================*REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEEVALUATE TIP-IDE-BDIIVIDEWHEN 1WHEN 1PERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULAWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 3WHEN 3PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 4WHEN 4PERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXTWHEN OTHERWHEN OTHERMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.END-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDENUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004NUIP03*END-IFFAC0004
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005
NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01END-IF.FAC0002NUIP01END-IF.FAC0002

NUIP01 80400-VALIDAR-TIPO-ID.FAC0002NUIP01 80400-VALIDAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80400-VALIDAR-TIPO-ID.FAC0002NUIP01*80400-VALIDAR-TIPO-ID.FAC0002
NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002
NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002
NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002
NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002
NUIP01WHEN 1FAC0002NUIP01WHEN 1FAC0002
NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006CNUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacionREMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005
NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005
NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC0004NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC000485010-UBICA-CEDULA.85010-UBICA-CEDULA.
REMARK*================================================================REMARK*================================================================
REMARK*85010-UBICA-CEDULA.REMARK*85010-UBICA-CEDULA.
REMARK*Ubica la identificacion dada la llave en BDIIREGIREMARK*Ubica la identificacion dada la llave en BDIIREGI
REMARK*Arma el nombre completo en una sola variableREMARK*Arma el nombre completo en una sola variable
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGSEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1STRINGSTRING"DE" DELIMITED BY SIZE,"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRINGSTRING"VDA DE" DELIMITED BY SIZE,"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFSTRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",DELIMITED BY SIZE,DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.85020-UBICA-NIT.
REMARK*================================================================REMARK*================================================================
REMARK*85020-UBICA-NIT.REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIANREMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.85030-UBICA-EXT.85030-UBICA-EXT.
REMARK*================================================================REMARK*================================================================
REMARK*85030-UBICA-EXT.REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DASREMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 ENsdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

REMARK*BDIIVIDE.PROC.v.03.0008|  REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONESREMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.** CORRESPONDE AL RANGO.
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     ** FAC006C     *
REMARK******************************************************************REMARK******************************************************************
* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS<
* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA<
* CAV0008     * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.<
REMARK******************************************************************<
80100-VALIDAR-IDENTIFICACION.80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datosREMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGIREMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportadoREMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMINITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDENOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002NUIP01    END-IFFAC0002
NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003NUIP02    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERICFAC0003
NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003NUIP02MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDEFAC0003
NUIP02    END-IFFAC0003NUIP02    END-IFFAC0003IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-ASGTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002NUIP01PERFORM 80300-ASIGNAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002NUIP01IF SW-VALTIPID-BDIIVIDE = 1FAC0002
NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002NUIP01PERFORM 80400-VALIDAR-TIPO-IDFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004NUIP03IF SW-DIGCHEQUEO-BDIIVIDE = 1FAC0004
NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004NUIP03PERFORM 80500-ELIMINAR-DIGITO-CHEQUEOFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004NUIP01IF SW-VALTIPID-BDIIVIDE = 0 ORFAC0004
NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002NUIP01(SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)FAC0002PERFORM 80200-VALIDAR-IDPERFORM 80200-VALIDAR-IDINITIALIZE NOM-VAL-BDIIVIDEINITIALIZE NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEMOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDEIF SW-VERIFNOM-BDIIVIDE = 1IF SW-VERIFNOM-BDIIVIDE = 1MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMMOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOMIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0IF NUM-BLOQUES-BDIIVIDE NUMERIC ANDIF NUM-BLOQUES-BDIIVIDE NUMERIC ANDNUM-BLOQUES-BDIIVIDE <> ZEROSNUM-BLOQUES-BDIIVIDE <> ZEROSMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMELSE IF TIP-ID-INPUT-VALNOM = 1ELSE  IF TIP-ID-INPUT-VALNOM = 1MOVE 2 TO BLOQUES-INPUT-VALNOMMOVE 2 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMELSE MOVE 1 TO BLOQUES-INPUT-VALNOMEND-IFEND-IFEND-IFEND-IFPERFORM 10000-MATCH-NOMBRES-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 0IF MATCH-OK-OUT-VALNOM = 0MOVE 1 TO SW-NOMBRES-BDIIVIDEMOVE 1 TO SW-NOMBRES-BDIIVIDEEND-IFEND-IFEND-IFEND-IFEND-IFEND-IF
NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002NUIP01ELSE IF SW-TID-BDIIVIDE = 1FAC0002
NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-ID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002ELSE MOVE 1 TO SW-ID-BDIIVIDEELSE MOVE 1 TO SW-ID-BDIIVIDEEND-IF.END-IF.80200-VALIDAR-ID.80200-VALIDAR-ID.
REMARK*===================================*REMARK*===================================*
REMARK*80200-VALIDAR-ID.REMARK*80200-VALIDAR-ID.
REMARK*Validacion del numero de identificacionREMARK*Validacion del numero de identificacion
REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:REMARK*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:
REMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamenteREMARK*BDIAREGI, BDIADAS, BDIADIAN respectivamente
REMARK*Dependiendo del tipo de identificacionREMARK*Dependiendo del tipo de identificacion
REMARK*===================================*REMARK*===================================*EVALUATE TIP-IDE-BDIIVIDEEVALUATE TIP-IDE-BDIIVIDEWHEN 1WHEN 1PERFORM 85010-UBICA-CEDULAPERFORM 85010-UBICA-CEDULAWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 2WHEN 2PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 3WHEN 3PERFORM 85020-UBICA-NITPERFORM 85020-UBICA-NITWHEN 4WHEN 4PERFORM 85030-UBICA-EXTPERFORM 85030-UBICA-EXTWHEN OTHERWHEN OTHERMOVE 1 TO SW-ID-BDIIVIDEMOVE 1 TO SW-ID-BDIIVIDEEND-EVALUATE.END-EVALUATE.

NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002NUIP01 80300-ASIGNAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002NUIP01*80300-ASIGNAR-TIPO-ID.FAC0002
NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002NUIP01*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADAFAC0002
NUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDENUPI01*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 1 ANDFAC0002
NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002NUIP01NUM-IDE-BDIIVIDE-R  <= 99999999) ORFAC0002
NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 1000000000 ANDFAC0002
NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003NUIP02NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0003
NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 1 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003NUIP02(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0003
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 2 TO TIP-IDE-BDIIVIDEFAC0002
NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004NUIP03*IF NUM-IDE-BDIIVIDE-R >= 8000000000FAC0004
NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03*MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03*MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03*END-IFFAC0004NUIP03*END-IFFAC0004
NUIP01ELSEFAC0002NUIP01ELSEFAC0002
NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002NUIP01IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002NUIP01(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0002
RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  8000000000)FAC0005
NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002NUIP01MOVE 3 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002NUIP01ELSE MOVE 4 TO TIP-IDE-BDIIVIDEFAC0002
NUIP01END-IF.FAC0002NUIP01END-IF.FAC0002

NUIP01 80400-VALIDAR-TIPO-ID.FAC0002NUIP01 80400-VALIDAR-TIPO-ID.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01*80400-VALIDAR-TIPO-ID.FAC0002NUIP01*80400-VALIDAR-TIPO-ID.FAC0002
NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002NUIP01*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGOFAC0002
NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002NUIP01*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002
NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002NUIP01*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;FAC0002
NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002NUIP01*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.FAC0002
REMARK*================================================================REMARK*================================================================
NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002NUIP01    INITIALIZE PARAMETROS-SALIDA-BDIIVIDEFAC0002
NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002NUIP01    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"FAC0002
NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002NUIP01    EVALUATE TIP-IDE-BDIIVIDEFAC0002
NUIP01WHEN 1FAC0002NUIP01WHEN 1FAC0002
NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002NUIP01IF NUM-IDE-BDIIVIDE-R > 9999999999FAC0002
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 2FAC0002NUIP01WHEN 2FAC0002
NUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006CNUIP04IF NUM-IDE-BDIIVIDE-R >  9999999999 ORFAC006C
RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005RANGO5(NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01WHEN 3FAC0002NUIP01WHEN 3FAC0002
RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005RANGO5IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000FAC0005
NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002NUIP01MOVE 1 TO SW-TID-BDIIVIDEFAC0002
NUIP01END-IFFAC0002NUIP01END-IFFAC0002
NUIP01    END-EVALUATE.FAC0002NUIP01    END-EVALUATE.FAC0002

NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03 80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*================================================================REMARK*================================================================
NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004NUIP03*80500-ELIMINAR-DIGITO-CHEQUEO.FAC0004
REMARK*Elimina el digito de chequeo y cambia el tipo de identificacionREMARK*Elimina el digito de chequeo y cambia el tipo de identificacion
REMARK*de acuerdo a los rangos para tipo id = 2 y 3REMARK*de acuerdo a los rangos para tipo id = 2 y 3
REMARK*================================================================REMARK*================================================================
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 600000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <  800000000) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  < 8000000000)FAC0005
NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 3 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004NUIP03IF (NUM-IDE-BDIIVIDE-R >= 800000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 999999999) ORFAC0005
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005RANGO5NUM-IDE-BDIIVIDE-R  <= 9999999999)FAC0005
NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004NUIP03MOVE 2 TO TIP-IDE-BDIIVIDEFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004NUIP03IF (TIP-IDE-BDIIVIDE = 2 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 10000000000) ORFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 8000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005RANGO5NUM-IDE-BDIIVIDE-R <= 9999999999)) ORFAC0005
NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004NUIP03(TIP-IDE-BDIIVIDE = 3 ANDFAC0004
NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004NUIP03(NUM-IDE-BDIIVIDE-R >= 6000000000 ANDFAC0004
RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005RANGO5NUM-IDE-BDIIVIDE-R <  8000000000))FAC0005
NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004NUIP03MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDEFAC0004
NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004NUIP03MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-RFAC0004
NUIP03END-IFFAC0004NUIP03END-IFFAC0004
NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC0004NUIP03INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".FAC000485010-UBICA-CEDULA.85010-UBICA-CEDULA.
REMARK*================================================================REMARK*================================================================
REMARK*85010-UBICA-CEDULA.REMARK*85010-UBICA-CEDULA.
REMARK*Ubica la identificacion dada la llave en BDIIREGIREMARK*Ubica la identificacion dada la llave en BDIIREGI
REMARK*Arma el nombre completo en una sola variableREMARK*Arma el nombre completo en una sola variable
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGIREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEMOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDEIF ESTADO-CIVIL-BDIIREGI = 0IF ESTADO-CIVIL-BDIIREGI = 0STRINGSTRINGSEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*" DELIMITED BY SIZE ,"*" DELIMITED BY SIZE ,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";" DELIMITED BY SIZE ,";" DELIMITED BY SIZE ,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 1IF ESTADO-CIVIL-BDIIREGI = 1STRINGSTRING"DE" DELIMITED BY SIZE,"DE" DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"  DELIMITED BY SIZE,"*"  DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,";"  DELIMITED BY SIZE,";"  DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFIF ESTADO-CIVIL-BDIIREGI = 2IF ESTADO-CIVIL-BDIIREGI = 2STRINGSTRING"VDA DE" DELIMITED BY SIZE,"VDA DE" DELIMITED BY SIZE,"*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,";"DELIMITED BY SIZE,";"DELIMITED BY SIZE,INTO NOM-LEIDO-BDIIVIDEINTO NOM-LEIDO-BDIIVIDEEND-IFEND-IFSTRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ","*"DELIMITED BY SIZE,"*"DELIMITED BY SIZE,NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",DELIMITED BY SIZE,DELIMITED BY SIZE,INTO NOM-VAL-BDIIVIDEINTO NOM-VAL-BDIIVIDEINSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "INITIALIZE NOM-LEIDO-BDIIVIDEINITIALIZE NOM-LEIDO-BDIIVIDEMOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.85020-UBICA-NIT.85020-UBICA-NIT.
REMARK*================================================================REMARK*================================================================
REMARK*85020-UBICA-NIT.REMARK*85020-UBICA-NIT.
REMARK*Ubica NIT en archivo de la DIAN, BDIIDIANREMARK*Ubica NIT en archivo de la DIAN, BDIIDIAN
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANMOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIANREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEMOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDEEND-IF.END-IF.85030-UBICA-EXT.85030-UBICA-EXT.
REMARK*================================================================REMARK*================================================================
REMARK*85030-UBICA-EXT.REMARK*85030-UBICA-EXT.
REMARK*Ubica cedula de extranjeria en archivo del DASREMARK*Ubica cedula de extranjeria en archivo del DAS
REMARK*================================================================REMARK*================================================================MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASMOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDASREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEREAD BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDEEND-READEND-READIF SW-ID-BDIIVIDE = 0IF SW-ID-BDIIVIDE = 0MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN





   
sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqqBDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     *
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEFAC0002
NUIP01    END-IFFAC0002
289 lines deleted

:r"BDIIVIDE_PRO.PROC" 283 lines, 18101 characters 


REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
      *             * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      *             * INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
*****************************************************************
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON 
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
      * FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL 
AGO.11/2004 * DIGITO DE CHEQUEO. 
FAC0004CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO 
       CORRESPONDE AL RANGO.ANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
OCT.22ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)5DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
FAC006C 80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
 de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*
    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM
                     NOMBRES-AUX-W-BDIIVIDE
   INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IF                                                        FAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                   FAC0002
NUIP01       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE        FAC0002
NUIP01    END-IF                           FAC0002
NUIP01    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                   FAC0002
NUIP01MOVE ZEROS TO SW-VALTIPID-BDIIVIDEFAC0002
NUIP01    END-IF                                           FAC00022DIGCHEQUEO-BDIIVIDE NOT NUMERIC32DIGCHEQUEO-BDIIVIDE323
      NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROSIF SW-ASGTIPID-BDIIVIDE = 1             PERFORM 80300-ASIGNAR-TIPO-ID



BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
            * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
       INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
FAC0002NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.ELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON 
JUL.16CUANDO SE LE QUITA EL DIGITO DE CHEQUEO       3NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL  
AGO.11/2004 * DIGITO DE CHEQUEO. 
FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO 
       CORRESPONDE AL RANGO.* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
*****************************************************************
      * F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
      * OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     * 
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*
          INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM 
              NOMBRES-AUX-W-BDIIVIDE
          INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"1VERIFNOM-BDIIVIDE NOT NUMERIC  21VERIFNOM-BDIIVIDE  212
NUIP01SW-ASGTIPID-BDIIVIDE NOT NUMERIC                           FAC0002 MOVE ZEROS TO SW-ASGTIPID-BDIIVIDEEND-IF                            
283 fewer lines

:r BDAMATCHNEW.PROC"BDAMATCHNEW.PROC" 1635 lines, 110713 characters 


* ojo ojo cuando pase este copy los programas deben incluir el copy bdanom fs y
* fd recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0003
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
*******************************************************************
 CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      
 C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
 R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK       MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
             *                  NUM-CTAS-OUTPUT-BDAMATCH   
REMARK*             *NOMB01  SE SEPARA EL NOMBRE EN NOMBRES Y APELLIDOS
REMARK********************************************************************
 1000-U-RECORRER-CSV-BDAMATCH.                  

REMARK*1000-U-RECORRER-CSV-BDAMATCH.             
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH      MOVE 0 TO IDE-TIPO-BDAMATCH        
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                  RMB0003
     MOVE 0 TO MAX-CUENTAS-BDAMATCH.        
           IF ABIERTO-BDAMATCH  = 0                
        OPEN INPUT  BDACSV                                   
        MOVE 1 TO ABIERTO-BDAMATCH                 
     END-IF.   
           INITIALIZE LLAVE-BDACSV.        
    MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .
           MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .
           MOVE 0 TO FIN-BDAMATCH . 
           MOVE 0 TO PROCESAR-BDAMATCH .                            
           START BDACSV  KEY > LLAVE-BDACSV                  
                 INVALID KEY                 
                    MOVE 1 TO FIN-BDAMATCH        NOT INVALID KEY                 READ BDACSV IGNORE LOCK NEXT RECORD             AT END                
                          MOVE 1 TO FIN-BDAMATCH
             END-READ                
           END-START.
           PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =       
                                     NUM-IDE-INPUT-BDAMATCH  OR         
                TIPO-ID-BDACSV  NOT =       



NUM-IDE-INPUT-BDAMATCH  OR
TIPO-ID-BDACSV  NOT =
TIP-IDE-INPUT-BDAMATCHMOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDAMATCHNOT INVALID KEY
IF ESTADO-ABD02 = 1
MOVE 1 TO PROCESAR-BDAMATCHPERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHELSE
MOVE 0 TO PROCESAR-BDAMATCHEND-IF
END-READ
IF PROCESAR-BDAMATCH = 1PERFORM 1200-PROC-REG-CSV-BDAMATCHEND-IF
READ BDACSV IGNORE LOCK   NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READ
END-PERFORM.
IF MAX-CUENTAS-BDAMATCH > 0PERFORM 9000-U-REALIZAR-BDAMATCHIF NOM-OUTPUT-BDAMATCH <> SPACES
NOMB01IF TIP-IDE-INPUT-BDAMATCH = 1RMB0003
NOMB01MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPUT-GGRMB0003
NOMB01PERFORM 1100-ANALIZAR-GGRMB0003
NOMB01IF EXC-OUTPUT-GG = 0RMB0003
NOMB01MOVE 1 TO IDE-TIPO-BDAMATCHRMB0003
VIGE01PERFORM 9010-U-VER-FALLECIDO-BDAMATCHRMB0003
NOMB01END-IFRMB0003
NOMB01ELSERMB0003
NOMB01MOVE 1 TO IDE-TIPO-BDAMATCHRMB0003
NOMB01END-IFRMB0003END-IF
END-IF.1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
REMARK* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
REMARK***********************************************************************MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
**OJO PENSAR QUE PASA SI LA CUENTA NO ESTA BLOQUEADA CON 9 ?????MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .**OJO PENSAR QUE PASA SI LA CUENTA NO ESTA BLOQUEADA CON 9 ?????
VIGE01     MOVE 0 TO FALLECIDO-BDAMATCHRMB0003IF COD-CTA-BDACSV = 01 OR 51MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECKREAD MAESTRO-CHECK IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
VIGE01IF IND-BLOQUEO-ABD06 = 9 OR 7RMB0003
VIGE01IF ADJETIVO-ABD06 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
VIGE01ELSERMB0003
VIGE01MOVE 0 TO PROCESAR-BDAMATCHRMB0003
VIGE01END-IFRMB0003END-READ
ELSE
MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDITREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
VIGE01IF IND-BLOQUEO-ABD07 = 9 OR 7RMB0003
VIGE01IF ADJETIVO1-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO2-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO3-ABD07 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
VIGE01ELSERMB0003
VIGE01MOVE 0 TO PROCESAR-BDAMATCHRMB0003
VIGE01END-IFRMB0003END-READ
END-IF.1200-PROC-REG-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1200-PROC-REG-CSV-BDAMATCH.
REMARK* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
REMARK* SI LO HAY
REMARK***********************************************************************IF MAX-CUENTAS-BDAMATCH = 0PERFORM 1000-U-INICIALIZAR-BDAMATCHEND-IF.
MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLMPERFORM 2000-U-INSERTAR-CTA-BDAMATCH.MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.READ MAESTRO-DIRECC IGNORE LOCKNOT INVALID KEY
PERFORM 1210-DIRTEL-BDACSV-BDAMATCHEND-READ.1210-DIRTEL-BDACSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.
REMARK* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
REMARK* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
REMARK***********************************************************************IF CIURES-DIRECC NOT = SPACESIF DIRRES-DIRECC NOT = SPACESMOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELRES-DIRECC > 0 ANDTELRES-DIRECC < 9999999999MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIULAB-DIRECC NOT = SPACESIF DIRLAB-DIRECC NOT = SPACESMOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELLAB-DIRECC > 0 ANDTELLAB-DIRECC < 9999999999MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIUCOR-DIRECC NOT = SPACES ANDDIRCOR-DIRECC NOT = SPACESMOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF.8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9MOVE 0 TO IND-BLOQUEO-ABD07END-IF
END-IF.8000-U-VER-CTAABD06-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD06-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9MOVE 0 TO IND-BLOQUEO-ABD06END-IF
END-IF.

REMARK*======================================================================
1000-U-INICIALIZAR-BDAMATCH.
REMARK********************************************************************
REMARK*1000-U-INICIALIZAR-BDAMATCH.
REMARK* INPUT = VACIO
REMARK* OUTPUT= VACIO
REMARK* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
REMARK* DEl MATCH.
REMARK********************************************************************MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.MOVE 0 TO I-CTA-BDAMATCH.INITIALIZE TABLA-DIR-BDAMATCH.INITIALIZE TABLA-TEL-BDAMATCH.INITIALIZE TABLA-NOM-BDAMATCH.INITIALIZE TABLA-GRUNOM-BDAMATCH.INITIALIZE V-INTERRELAC-BDAMATCH.MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.2000-U-INSERTAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-DIR-BDAMATCH.
REMARK* INPUT = DIR-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
REMARK* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
REMARK* LA DIRECCION CONTENGA ALGUN NUMERO
REMARK********************************************************************MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.MOVE 1 TO I-BDAMATCHMOVE 0 TO J-BDAMATCHMOVE " " TO CAR-ANT-BDAMATCHINITIALIZE T-CARTOT-BDAMATCH
CARTOT     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10CAV0002IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERICMOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCHIF CAR-ANT-BDAMATCH   NUMERICCOMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)= V-CARTOT-BDAMATCH  (J-BDAMATCH)* 10 + CAR-ACT-BDAMATCHELSE
ADD 1 TO J-BDAMATCH
MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)TO V-CARTOT-BDAMATCH  (J-BDAMATCH)END-IFTO V-CARTOT-BDAMATCH  (J-BDAMATCH)END-IF
END-IF
MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCHADD 1 TO I-BDAMATCHEND-PERFORM.
SORT V-CARTOT-BDAMATCH   DESCENDING.IF T-CARTOT-BDAMATCH   NOT = ZEROS ANDI-DIR-BDAMATCH < LIM-BDAMATCHMOVE T-CARTOT-BDAMATCH TO
NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TOSUS-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1UNTIL  POSIC-SUMA-BDAMATCH  >  10 ORV-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZEROADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)END-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-IF.2000-U-INSERTAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-TEL-BDAMATCH.
REMARK* INPUT = TEL-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
REMARK********************************************************************IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0MOVE TEL-INPUT-BDAMATCH TO
NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TO
SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE I-CTA-BDAMATCH     TO
CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)ADD 1 TO I-TEL-BDAMATCHEND-IF.2000-U-INSERTAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-NOM-BDAMATCH.
REMARK* INPUT = NOM-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-NOM-BDAMATCH < LIM-BDAMATCH ANDNOM-INPUT-BDAMATCH <> SPACESMOVE NOM-INPUT-BDAMATCH  TONOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
NOM-LIMPI-BDAMATCHMOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCHNRO-VECES-2-BDAMATCHMOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCHNRO-VECES-2-BDAMATCHPERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1UNTIL  NRO-VECES-1-BDAMATCH  >  60IF NRO-VECES-1-BDAMATCH  >  1 ANDNOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCHEND-IF
IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "COMPUTE  NRO-VECES-2-BDAMATCH =
60 - NRO-VECES-1-BDAMATCHMOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH) = SPACESMOVE  85TO  NRO-VECES-1-BDAMATCHEND-IF
END-IF
END-PERFORM
INSPECT NOM-LIMPI-BDAMATCH
TALLYINGPESO-CTAS-TOT-BDAMATCHFOR CHARACTERS BEFORE INITIAL " "MOVE  PESO-CTAS-TOT-BDAMATCH TOLNG-NOM-BDAMATCH(I-NOM-BDAMATCH)MOVE  SUSC-CTAS-BDAMATCH TO
SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCHEND-IF.2000-U-INSERTAR-CTA-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-CTA-BDAMATCH.
REMARK* INPUT = CTA-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-CTA-BDAMATCH < LIM-BDAMATCH ANDCTA-INPUT-BDAMATCH <> SPACESADD 1 TO I-CTA-BDAMATCHMOVE CTA-INPUT-BDAMATCH TOCTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
VIGE01MOVE FALLECIDO-BDAMATCH TORMB0003
VIGE01CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)RMB0003END-IF.
PERFORM  400-BUSCAR-SUSCRIPTOR-BDAMATCHIF  INV-BDAMATCH  =  1AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCHADD   1TO  POSIC-SUSC-BDAMATCHMOVE  SUSC-CTAS-BDAMATCH  TO
COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)MOVE  1     TO FLAG-YA-CTA-BDAMATCH(POSIC-SUSC-BDAMATCH)MOVE  ZEROS TO FLAG-YA-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)FLAG-YA-TEL-BDAMATCH(POSIC-SUSC-BDAMATCH)MOVE  ZEROS TO FLAG-YA-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)FLAG-YA-TEL-BDAMATCH(POSIC-SUSC-BDAMATCH)FLAG-YA-NOM-BDAMATCH(POSIC-SUSC-BDAMATCH)END-IF.3000-U-ORDENAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-DIR-BDAMATCH.
REMARK* INPUT = TABLA DE DIRECCIONES LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
REMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-DIR-BDAMATCH
DESCENDING NUM-DIR-BDAMATCHASCENDING  CTA-DIR-BDAMATCH.MOVE 1 TO I-CTA-BDAMATCH.MOVE 0 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-DIR-ANT-BDAMATCHMOVE ALL "9"TO NUM-DIR-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0IF NUM-DIR-ANT-BDAMATCH <>
NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE  I-CTA-BDAMATCHTO  POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-DIR-ANT-BDAMATCH <>CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-DIR-ANT-BDAMATCHMOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-DIR-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.
REMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOSREMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
REMARK* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-TEL-BDAMATCH
DESCENDING NUM-TEL-BDAMATCHASCENDING  CTA-TEL-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-TEL-ANT-BDAMATCHMOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0OR  FIL-FUE-BDAMATCH > LIM-BDAMATCHOR  COL-FUE-BDAMATCH > LIM-BDAMATCHIF NUM-TEL-ANT-BDAMATCH <>NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-TEL-ANT-BDAMATCH <>CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-TEL-ANT-BDAMATCHMOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-TEL-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-NOM-BDAMATCH.
REMARK* INPUT = TABLA DE NOMBRES     LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
REMARK* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .DESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-NOM-BDAMATCH.MOVE 1 TO GRU-NOM-BDAMATCH.MOVE GRU-NOM-BDAMATCH TOGRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).MOVE GRU-NOM-BDAMATCH TOGRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TOSUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TOSUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCH.PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0MOVE 1 TO I-GRU-BDAMATCHMOVE 0 TO MATCH-OK-OUT-VALNOMPERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCHOR MATCH-OK-OUT-VALNOM = 1MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOMBRE-INPUT-VALNOMMOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TONOMBOK-INPUT-VALNOMMOVE 1 TO TIP-ID-INPUT-VALNOMMOVE 2 TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1MOVE I-GRU-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1
ADD   1  TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)END-IF
END-IF
ADD 1 TO I-GRU-BDAMATCHEND-PERFORMADD 1 TO I-GRU-BDAMATCHEND-PERFORM
IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPOADD 1 TO GRU-NOM-BDAMATCHMOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLMMOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1   TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ELSE*>MOVE GRU-NOM-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLMEND-IF
ADD 1 TO I-NOM-BDAMATCHEND-PERFORM.
SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING GRU-NOMS-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-NOM-ANT-BDAMATCHMOVE ALL "9"TO GRU-NOM-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0OR FIL-FUE-BDAMATCH > LIM-BDAMATCHOR COL-FUE-BDAMATCH > LIM-BDAMATCHIF GRU-NOM-ANT-BDAMATCH <>GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-NOM-ANT-BDAMATCH <>CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IFADD 1 TO COL-FUE-BDAMATCHEND-IF
END-IF
MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCTA-NOM-ANT-BDAMATCHMOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TOGRU-NOM-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.4000-U-INTERELACIONAR-BDAMATCH.
REMARK********************************************************************
REMARK*4000-U-INTERELACIONAR-BDAMATCH.
REMARK* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
REMARK* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
REMARK* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************MOVE 1 TO MOVIDO-BDAMATCH    .PERFORM UNTIL MOVIDO-BDAMATCH = 0MOVE 0 TO MOVIDO-BDAMATCHMOVE 1 TO FIL-BUS-BDAMATCHPERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCHMOVE 1 TO COL-BUS-BDAMATCHPERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCHIF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)> 0
MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)TO BUSCADO-BDAMATCH
PERFORM 4100-BUSCAR-RELACION-BDAMATCHELSE
MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHEND-IF
ADD 1 TO COL-BUS-BDAMATCHEND-PERFORM
ADD 1 TO FIL-BUS-BDAMATCHEND-PERFORMEND-PERFORM.4100-BUSCAR-RELACION-BDAMATCH.
REMARK********************************************************************
REMARK*4100-BUSCAR-RELACION-BDAMATCH.
REMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
REMARK********************************************************************MOVE 1 TO FIL-FUE-BDAMATCH.PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHIF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH <= 2000
PERFORM 4110-MOVER-RELACIONES-BDAMATCHEND-IFPERFORM 4110-MOVER-RELACIONES-BDAMATCHEND-IF
END-IF
ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.4110-MOVER-RELACIONES-BDAMATCH.
REMARK********************************************************************
REMARK*4110-MOVER-RELACIONES-BDAMATCH.
REMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
REMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
REMARK********************************************************************MOVE 0 TO FIN-FUENTE-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING LIBRE-BUSCADO-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4ADD 1 TO LIBRE-BUSCADO-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCH.PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCHMOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TOPORINSERTAR-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH > 2000MOVE PORINSERTAR-BDAMATCH TOCAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)ADD 1 TO LIBRE-BUSCADO-BDAMATCHMOVE 1 TO MOVIDO-BDAMATCHEND-IF
ADD 1 TO COL-FUE-BDAMATCHEND-PERFORM.
INITIALIZE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK********************************************************************
REMARK*5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
REMARK* PORTAFOLIO QUE TIENE MAS CUENTAS
REMARK********************************************************************MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.MOVE 0 TO MAXREL-PER-BDAMATCHMOVE 0 TO FIN-FUENTE-BDAMATCH.MOVE 1 TO FIL-FUE-BDAMATCH.MOVE 0 TO  PESOS-CTRL-BDAMATCHPERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq


* ojo ojo cuando pase este copy los programas deben incluir el copy bdanom fs y
* fd recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0003
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**NOMB01  SE SEPARA EL NOMBRE EN NOMBRES Y APELLIDOS
REMARK********************************************************************
1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHEND-IF.
INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVINVALID KEY
MOVE 1 TO FIN-BDAMATCHNOT INVALID KEY
READ BDACSV IGNORE LOCK NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READEND-START.
PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
NUM-IDE-INPUT-BDAMATCH  OR
TIPO-ID-BDACSV  NOT =



BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE.PROC.v.03.0006
****************************************************************
RUTINA DE VALIDACION DE IDENTIFICACIONES
****************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
      *             * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
*****************************************************************
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON 
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO       
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2

      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
      * AGO.11/2004 * DIGITO DE CHEQUEO. 
      * FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO 
      *      * CORRESPONDE AL RANGO.* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
*             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     *
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM NOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC   FAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IF     FAC0002
NUIP01    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                     FAC0002
NUIP01MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002
NUIP01    END-IF                     FAC0002
1635 fewer lines

BDAMATCHRMB.PROC:






:r BDAMATCHRMB.PROC"BDAMATCHRMB.PROC" 1227 lines, 79009 characters * OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
*****************************************************************
 RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
 R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
             *        MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH 
REMARK*             *                  NUM-CTAS-OUTPUT-BDAMATCH   
REMARKSINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK       BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE 
REMARK*               DE FRENADAS

REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *          DEL PORTAFOLIO .              *
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL * 
             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       * 
REMARK*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               *
REMARK*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK*        LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARKNOMB01 - MAQUILLAR EL NOMBRE*
             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMBAJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK*             *          DECUENTA DE LA MISMA CUENTA            *
REMARK*****************************************************************

       1000-U-RECORRER-CSV-BDAMATCH.                  
REMARK******************************************************************
1000-U-RECORRER-CSV-BDAMATCH.       
 SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
MATCH 
*****************************************************************
           MOVE 0 TO IDE-TIPO-BDAMATCH     
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .             RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003 MOVE 0 TO MAX-CUENTAS-BDAMATCH.        
           IF ABIERTO-BDAMATCH  = 0          
       OPEN INPUT  BDACSV                                    MOVE 1 TO ABIERTO-BDAMATCH       


OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHEND-IF.
INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO PROCESAR-BDAMATCH .START BDACSV  KEY > LLAVE-BDACSVINVALID KEY
MOVE 1 TO FIN-BDAMATCHNOT INVALID KEY
READ BDACSV IGNORE LOCK NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READEND-START.
PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
NUM-IDE-INPUT-BDAMATCH  OR
TIPO-ID-BDACSV  NOT =
TIP-IDE-INPUT-BDAMATCHMOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02READ SUSCRIPTOR IGNORE LOCKINVALID KEY
MOVE 0 TO PROCESAR-BDAMATCHNOT INVALID KEY
FUEN01MOVE 1 TO PROCESAR-BDAMATCHRMB0004END-READ
BLOQ01IF PROCESAR-BDAMATCH = 1RMB0004
BLOQ01IF ESTADO-ABD02 = 1RMB0004
BLOQ01IF IND-BLOQUEO-BDACSV <> "B"RMB0004
BLOQ01MOVE 1 TO PROCESAR-BDAMATCHRMB0004
FUEN01IF FUENTE-REG-BDACSV <= 01RMB0004
FUEN01PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCHRMB0004
FUEN01ELSERMB0004
FUEN01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
FUEN01END-IFRMB0004
FUEN01ELSERMB0004
BLOQ01MOVE 0 TO PROCESAR-BDAMATCHRMB0004
BLOQ01END-IFRMB0004
BLOQ01ELSERMB0004
BLOQ01MOVE 0 TO PROCESAR-BDAMATCHRMB0004
BLOQ01END-IFRMB0004
BLOQ01END-IFRMB0004IF PROCESAR-BDAMATCH = 1PERFORM 1200-PROC-REG-CSV-BDAMATCHEND-IF
READ BDACSV IGNORE LOCK   NEXT RECORDAT END
MOVE 1 TO FIN-BDAMATCHEND-READ
LIMI01IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
LIMI01MOVE 1 TO FIN-BDAMATCH*> SE ABLIGA A TIPRMB0004
LIMI01MOVE 0 TO MAX-CUENTAS-BDAMATCH*> EFICIENCIA Y   RMB0004
LIMI01MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
LIMI01END-IFRMB0004LIMI01MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
LIMI01END-IFRMB0004END-PERFORM.
IF MAX-CUENTAS-BDAMATCH > 0
APEL01IF APELLIDO-INPUT-BDAMATCH <> SPACES ANDRMB0004
APEL01MAX-CUENTAS-BDAMATCH > 1RMB0004
APEL01PERFORM 1100-LLENAR-CSV-APE-BDAMATCHRMB0004
APEL01PERFORM 1100-LLENAR-AUX-BDAMATCHRMB0004
APEL01PERFORM 1200-PROC-REG-CSV-BDAMATCHRMB0004
APEL01END-IFRMB0004PERFORM 9000-U-REALIZAR-BDAMATCH
NOMB01IF NOM-OUTPUT-BDAMATCH <> SPACES ANDRMB0004
NOMB01(TIP-IDE-INPUT-BDAMATCH = 1 OR 4)RMB0004
NOMB01MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQRMB0004
NOMB01PERFORM 1100-MAQUILLAR-NOMBRE-MAQRMB0004
NOMB01MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCHRMB0004
NOMB01END-IFRMB0004IF NOM-OUTPUT-BDAMATCH <> SPACESMOVE 1 TO IDE-TIPO-BDAMATCHEND-IF
END-IF.
NOMB01 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004
NOMB01     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
NOMB01     MOVE 0 TO I-MAQRMB0004
NOMB01     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
NOMB01INITIAL "Y/O"RMB0004
NOMB01OR"Y\O"RMB0004
NOMB01OR" Y/OTRO "RMB0004
NOMB01OR" Y/OTRA "RMB0004
NOMB01OR" Y\OTRO "RMB0004
NOMB01OR" Y\OTRA "RMB0004
NOMB01OR" Y OTRO "RMB0004
NOMB01OR" Y OTRA "RMB0004
NOMB01     IF I-MAQ < 45 AND I-MAQ > 2RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01     ELSERMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)RMB0004
NOMB01END-IFRMB0004
NOMB01     END-IFRMB0004
NOMB01     MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01     MOVE 1 TO I-MAQ.RMB0004
NOMB01     PERFORM UNTIL I-MAQ > 45RMB0004
NOMB01MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQRMB0004
NOMB01IF TILDE-MAQRMB0004
NOMB01PERFORM 1000-CAMBIAR-TILDE-MAQRMB0004
NOMB01MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)RMB0004
NOMB01END-IFRMB0004
NOMB01IF FUNCTION ORD(ACTUAL-MAQ) < 31RMB0004
NOMB01MOVE "." TO ACTUAL-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01MOVE " " TO ANT-MAQRMB0004
NOMB01IF I-MAQ > 1RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ - 1RMB0004NOMB01IF I-MAQ > 1RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ - 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01MOVE " " TO SIG-MAQRMB0004
NOMB01IF I-MAQ < 45RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01IF ACTUAL-MAQ = ")"RMB0004
NOMB01MOVE 0 TO SW-BORRAR-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01IF SW-BORRAR-MAQ = 0RMB0004
NOMB01IF ELIMINAR-MAQRMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01IF I-MAQ > 1RMB0004
NOMB01MOVE 1 TO SW-BORRAR-MAQRMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01IF BORRAR-MAQRMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01ELSERMB0004
NOMB01IF QUITAR-MAQRMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01COMPUTE I-MAQ = I-MAQ - 1RMB0004
NOMB01ELSERMB0004
NOMB01IF VALIDO-MAQRMB0004
NOMB01CONTINUERMB0004
NOMB01ELSERMB0004
NOMB01IF ANT-MAQ = "N" AND SIG-VOCAL-MAQRMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01COMPUTE I-MAQ = I-MAQ - 1RMB0004
NOMB01ELSERMB0004
NOMB01IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
NOMB01(ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
NOMB01IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
NOMB01COMPUTE J-MAQ = I-MAQ + 1RMB0004
NOMB01MOVE NOMBRE-INPMAQ(J-MAQ:) TORMB0004
NOMB01NOMBRE-INPMAQ(I-MAQ:)RMB0004
NOMB01ELSERMB0004
NOMB01MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01IF NOT ANT-VOCAL-MAQ ANDRMB0004
NOMB01SIG-VOCAL-MAQRMB0004
NOMB01MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01ELSERMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01END-IFRMB0004
NOMB01ELSERMB0004
NOMB01MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)RMB0004
NOMB01END-IFRMB0004
NOMB01ADD 1 TO I-MAQRMB0004
NOMB01     END-PERFORM.RMB0004
NOMB01     INITIALIZE PARTICULAS-INPMAQRMB0004
NOMB01     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "RMB0004
NOMB01INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
NOMB01P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
NOMB01P10-INPMAQRMB0004
NOMB01     MOVE SPACES TO NOMBRE-OUTMAQ-OKRMB0004
NOMB01     STRING P1-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P2-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P3-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P4-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P5-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P6-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P7-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P8-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P9-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01P10-INPMAQ DELIMITED BY " "RMB0004
NOMB01" " DELIMITED BY SIZERMB0004
NOMB01INTO NOMBRE-OUTMAQ-OK.RMB0004
NOMB01INSPECT NOMBRE-OUTMAQ-OKRMB0004
NOMB01REPLACING ALL  " PE A " BY " PENA ".RMB0004
NOMB01  1000-CAMBIAR-TILDE-MAQ.RMB0004
NOMB01EVALUATE ACTUAL-MAQRMB0004
NOMB01WHEN "Á"RMB0004
NOMB01MOVE "A" TO ACTUAL-MAQRMB0004
NOMB01WHEN "É"RMB0004
NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Í"RMB0004
NOMB01MOVE "I" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ó"RMB0004
NOMB01MOVE "O" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ú"RMB0004
NOMB01MOVE "U" TO ACTUAL-MAQRMB0004
NOMB01WHEN "á"RMB0004
NOMB01MOVE "A" TO ACTUAL-MAQRMB0004
NOMB01WHEN "é"RMB0004
NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "í"RMB0004NOMB01MOVE "E" TO ACTUAL-MAQRMB0004
NOMB01WHEN "í"RMB0004
NOMB01MOVE "I" TO ACTUAL-MAQRMB0004
NOMB01WHEN "ó"RMB0004
NOMB01MOVE "O" TO ACTUAL-MAQRMB0004
NOMB01WHEN "Ú"RMB0004
NOMB01MOVE "U" TO ACTUAL-MAQRMB0004
NOMB01END-EVALUATE.RMB0004
APEL01 1100-LLENAR-CSV-APE-BDAMATCH.RMB0004
APEL01     INITIALIZE REG-BDACSVRMB0004
APEL01     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSVRMB0004
APEL01     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSVRMB0004
APEL01     MOVE 980001TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
APEL01     MOVE 02TO  COD-CTA-BDACSVRMB0004
APEL01     MOVE "APELLID-01"   TO  NUM-CTA-BDACSVRMB0004
APEL01     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSVRMB0004
APEL01     MOVE ".-,"TO  NOMBRE-BDACSV(43:3)RMB0004
APEL01     MOVE 20110801TO  FECHA-CREA-BDACSVRMB0004
APEL01     MOVE 0TO  NUM-PORTAF-BDACSVRMB0004
APEL01     MOVE 0TO  IND-NOMBRE-BDACSVRMB0004
APEL01     MOVE 0TO  MEJOR-PORTAF-BDACSVRMB0004
APEL01     MOVE 0TO  IND-ACTUALIZ-BDACSVRMB0004
APEL01     MOVE 01TO  FUENTE-REG-BDACSV.RMB0004
APEL01 1100-LLENAR-AUX-BDAMATCH.RMB0004
REMARK***********************************************************************
REMARK*1100-LLENAR-AUX-BDAMATCH.
REMARK* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE
REMARK* TAMAÑO
REMARK***********************************************************************
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .RMB0004
APEL01     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .RMB0004
APEL01     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .RMB0004
APEL01     MOVE 0 TO FALLECIDO-BDAMATCH.RMB0004
1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
REMARK* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
REMARK* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
REMARK***********************************************************************MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
VIGE01     MOVE 0 TO FALLECIDO-BDAMATCHRMB0003IF COD-CTA-BDACSV = 01 OR 51MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECKREAD MAESTRO-CHECK IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
BLOQ01IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)RMB0004
SINBLQAND CONSECUTIVO-ABD06 = 1
VIGE01IF ADJETIVO-ABD06 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
SINBLQELSERMB0003
SINBLQMOVE 0 TO PROCESAR-BDAMATCHRMB0003
SINBLQEND-IFRMB0003
SINBLQEND-READ
ELSE
MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDITREAD MAESTRO-CREDIT IGNORE LOCK INVALID KEYMOVE 0 TO PROCESAR-BDAMATCH
VIGE01NOT INVALID KEYRMB0003
BLOQ01IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)RMB0004
SINBLQAND CONSECUTIVO-ABD07 = 1
VIGE01IF ADJETIVO1-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO2-ABD07 = 1 ORRMB0003
VIGE01ADJETIVO3-ABD07 = 1RMB0003
VIGE01MOVE 1 TO FALLECIDO-BDAMATCHRMB0003
VIGE01END-IFRMB0003
SINBLQELSERMB0003
SINBLQMOVE 0 TO PROCESAR-BDAMATCHRMB0003
VIGE01END-IFRMB0003END-READ
END-IF.1200-PROC-REG-CSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1200-PROC-REG-CSV-BDAMATCH.
REMARK* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
REMARK* SI LO HAY
REMARK***********************************************************************IF MAX-CUENTAS-BDAMATCH = 0PERFORM 1000-U-INICIALIZAR-BDAMATCHEND-IF.
MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLMPERFORM 2000-U-INSERTAR-CTA-BDAMATCH.MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.READ MAESTRO-DIRECC IGNORE LOCK
MEJO01*NOT INVALID KEYRMB0004
MEJO01*PERFORM 1210-DIRTEL-BDACSV-BDAMATCHRMB0004
MEJO01INVALID KEYRMB0004
MEJO01MOVE SPACES TO LLAVE-DIRECCRMB0004END-READ.MEJO01MOVE SPACES TO LLAVE-DIRECCRMB0004END-READ.
MEJO01     IF LLAVE-DIRECC <> SPACESRMB0004
MEJO01PERFORM 1210-DIRTEL-BDACSV-BDAMATCHRMB0004
MEJO01     END-IF.RMB00041210-DIRTEL-BDACSV-BDAMATCH.
REMARK***********************************************************************
REMARK*1210-DIRTEL-BDACSV-BDAMATCH.
REMARK* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
REMARK* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
REMARK***********************************************************************IF CIURES-DIRECC NOT = SPACESIF DIRRES-DIRECC NOT = SPACESMOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELRES-DIRECC > 0 ANDTELRES-DIRECC < 9999999999MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIULAB-DIRECC NOT = SPACESIF DIRLAB-DIRECC NOT = SPACESMOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF
IF TELLAB-DIRECC > 0 ANDTELLAB-DIRECC < 9999999999MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-TEL-BDAMATCHEND-IF
END-IF.
IF CIUCOR-DIRECC NOT = SPACES ANDDIRCOR-DIRECC NOT = SPACESMOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCHPERFORM 2000-U-INSERTAR-DIR-BDAMATCHEND-IF.8000-U-VER-CTAABD07-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD07-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9MOVE 0 TO IND-BLOQUEO-ABD07END-IF
END-IF.8000-U-VER-CTAABD06-BDAMATCH.
8000-U-VER-CTAABD06-BDAMATCH.
REMARK***********************************************************************
REMARK*8000-U-VER-CTAABD06-BDAMATCH.
REMARK*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
REMARK*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
REMARK*  DE BLOQUEO A 0
REMARK***********************************************************************IF IDE-TIPO-BDAMATCH = 1MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCHPERFORM 5000-U-VALIDAR-CUENTA-BDAMATCHIF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9MOVE 0 TO IND-BLOQUEO-ABD06END-IF
END-IF.

REMARK*======================================================================
1000-U-INICIALIZAR-BDAMATCH.
REMARK********************************************************************
REMARK*1000-U-INICIALIZAR-BDAMATCH.
REMARK* INPUT = VACIO
REMARK* OUTPUT= VACIO
REMARK* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
REMARK* DEl MATCH.
REMARK********************************************************************MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.MOVE 0 TO I-CTA-BDAMATCH.
PESO01     INITIALIZE TABLA-CUENTAS-BDAMATCH.RMB0004INITIALIZE TABLA-DIR-BDAMATCH.INITIALIZE TABLA-TEL-BDAMATCH.INITIALIZE TABLA-NOM-BDAMATCH.INITIALIZE TABLA-GRUNOM-BDAMATCH.INITIALIZE V-INTERRELAC-BDAMATCH.MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
POSIC-SUS-GRU-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHMOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.2000-U-INSERTAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-DIR-BDAMATCH.
REMARK* INPUT = DIR-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
REMARK* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
REMARK* LA DIRECCION CONTENGA ALGUN NUMERO
REMARK********************************************************************MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.MOVE 1 TO I-BDAMATCHMOVE 0 TO J-BDAMATCHMOVE " " TO CAR-ANT-BDAMATCHINITIALIZE T-CARTOT-BDAMATCH
CARTOT     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10CAV0002IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERICMOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCHIF CAR-ANT-BDAMATCH   NUMERICMOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCHIF CAR-ANT-BDAMATCH   NUMERICCOMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)= V-CARTOT-BDAMATCH  (J-BDAMATCH)* 10 + CAR-ACT-BDAMATCHELSE
ADD 1 TO J-BDAMATCH
MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)TO V-CARTOT-BDAMATCH  (J-BDAMATCH)END-IF
END-IF
MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCHADD 1 TO I-BDAMATCHEND-PERFORM.
SORT V-CARTOT-BDAMATCH   DESCENDING.IF T-CARTOT-BDAMATCH   NOT = ZEROS ANDI-DIR-BDAMATCH < LIM-BDAMATCHMOVE T-CARTOT-BDAMATCH TO
NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TOSUS-DIR-BDAMATCH(I-DIR-BDAMATCH)MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1UNTIL  POSIC-SUMA-BDAMATCH  >  10 ORV-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZEROADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)END-PERFORM
ADD 1 TO I-DIR-BDAMATCHEND-IF.2000-U-INSERTAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-TEL-BDAMATCH.
REMARK* INPUT = TEL-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
REMARK********************************************************************IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0MOVE TEL-INPUT-BDAMATCH TO
NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE SUSC-CTAS-BDAMATCH TO
SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)MOVE I-CTA-BDAMATCH     TO
CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)ADD 1 TO I-TEL-BDAMATCHEND-IF.2000-U-INSERTAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-NOM-BDAMATCH.
REMARK* INPUT = NOM-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-NOM-BDAMATCH < LIM-BDAMATCH ANDNOM-INPUT-BDAMATCH <> SPACESMOVE NOM-INPUT-BDAMATCH  TONOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
NOM-LIMPI-BDAMATCHMOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCHNRO-VECES-2-BDAMATCHPERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1UNTIL  NRO-VECES-1-BDAMATCH  >  60IF NRO-VECES-1-BDAMATCH  >  1 ANDNOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCHEND-IF
IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "COMPUTE  NRO-VECES-2-BDAMATCH =
60 - NRO-VECES-1-BDAMATCHMOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH)TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +1:NRO-VECES-2-BDAMATCH) = SPACESMOVE  85TO  NRO-VECES-1-BDAMATCHEND-IF
END-IF
END-PERFORM
INSPECT NOM-LIMPI-BDAMATCH
TALLYINGPESO-CTAS-TOT-BDAMATCHFOR CHARACTERS BEFORE INITIAL " "MOVE  PESO-CTAS-TOT-BDAMATCH TOLNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
FUEN01IF FUENTE-REG-BDACSV >= 02RMB0004
FUEN01MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)RMB0004
FUEN01END-IFRMB0004MOVE  SUSC-CTAS-BDAMATCH TO
SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCHEND-IF.2000-U-INSERTAR-CTA-BDAMATCH.
REMARK********************************************************************
REMARK*2000-U-INSERTAR-CTA-BDAMATCH.
REMARK* INPUT = CTA-INPUT-BDAMATCH
REMARK* OUTPUT= VACIO
REMARK* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
REMARK* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
REMARK********************************************************************IF I-CTA-BDAMATCH < LIM-BDAMATCH ANDCTA-INPUT-BDAMATCH <> SPACESADD 1 TO I-CTA-BDAMATCHMOVE CTA-INPUT-BDAMATCH TOCTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
VIGE01MOVE FALLECIDO-BDAMATCH TORMB0003MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
VIGE01MOVE FALLECIDO-BDAMATCH TORMB0003
VIGE01CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)RMB0003
FUEN01IF FUENTE-REG-BDACSV >= 2RMB0004
FUEN01MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)RMB0004
FUEN01END-IFRMB0004END-IF.
3000-U-ORDENAR-DIR-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-DIR-BDAMATCH.
REMARK* INPUT = TABLA DE DIRECCIONES LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
REMARK* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-DIR-BDAMATCH
DESCENDING NUM-DIR-BDAMATCHASCENDING  CTA-DIR-BDAMATCH.MOVE 1 TO I-CTA-BDAMATCH.MOVE 0 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-DIR-ANT-BDAMATCHMOVE ALL "9"TO NUM-DIR-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0IF NUM-DIR-ANT-BDAMATCH <>
NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE  I-CTA-BDAMATCHTO  POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-DIR-ANT-BDAMATCH <>CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-DIR-ANT-BDAMATCHMOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-DIR-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-TEL-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.REMARK********************************************************************
REMARK*3000-U-ORDENAR-TEL-BDAMATCH.
REMARK* INPUT = TABLA DE TELEFONOS   LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
REMARK* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-TEL-BDAMATCH
DESCENDING NUM-TEL-BDAMATCHASCENDING  CTA-TEL-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-TEL-ANT-BDAMATCHMOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0OR  FIL-FUE-BDAMATCH > LIM-BDAMATCHOR  COL-FUE-BDAMATCH > LIM-BDAMATCHIF NUM-TEL-ANT-BDAMATCH <>NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCHADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-TEL-ANT-BDAMATCH <>CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)END-IF
MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
CTA-TEL-ANT-BDAMATCHMOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
NUM-TEL-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.3000-U-ORDENAR-NOM-BDAMATCH.
REMARK********************************************************************
REMARK*3000-U-ORDENAR-NOM-BDAMATCH.
REMARK* INPUT = TABLA DE NOMBRES     LLENA
REMARK* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
REMARK* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHSORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-NOM-BDAMATCH.MOVE 1 TO GRU-NOM-BDAMATCH.MOVE GRU-NOM-BDAMATCH TOGRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).MOVE GRU-NOM-BDAMATCH TOGRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TOSUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TOSUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ADD 1 TO I-NOM-BDAMATCH.PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0MOVE 1 TO I-GRU-BDAMATCHMOVE 0 TO MATCH-OK-OUT-VALNOMPERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCHOR MATCH-OK-OUT-VALNOM = 1MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOMBRE-INPUT-VALNOMMOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TONOMBOK-INPUT-VALNOM
VLNIT1IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3RMB0004
VLNIT1IF NUM-IDE-INPUT-BDAMATCH >= 600000000 ANDRMB0004
VLNIT1NUM-IDE-INPUT-BDAMATCH <= 999999999RMB0004
VLNIT1MOVE 2 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 1 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1ELSERMB0004
VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1END-IFRMB0004
VLNIT1ELSERMB0004
VLNIT1MOVE 1 TO TIP-ID-INPUT-VALNOMRMB0004
VLNIT1MOVE 2 TO BLOQUES-INPUT-VALNOMRMB0004
VLNIT1END-IFRMB0004
APEL01IF NOMBRE-INPUT-VALNOM(43:3) = ".-," ORRMB0004
APEL01NOMBOK-INPUT-VALNOM(43:3) = ".-,"RMB0004
APEL01MOVE 1 TO BLOQUES-INPUT-VALNOMRMB0004
APEL01END-IFRMB0004PERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1MOVE I-GRU-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE I-GRU-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCH
APEL01IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDORMB0004
APEL01MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
APEL01END-IFRMB0004PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1
ADD   1  TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
PESO01MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TORMB0004
PESO01NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)RMB0004END-IF
END-IF
ADD 1 TO I-GRU-BDAMATCHEND-PERFORM
IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPOADD 1 TO GRU-NOM-BDAMATCHMOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TONOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)MOVE GRU-NOM-BDAMATCH  TO
GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLMMOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
TO  SUSC-GRUP-SUS-BDAMATCHMOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
TO  SUSC-GRUP-GRU-BDAMATCHPERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCHIF  INV-BDAMATCH  =  1ADD   1   TONUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))END-IF
MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TOLNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)ELSE*>MOVE GRU-NOM-BDAMATCH TO
GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLMEND-IF
ADD 1 TO I-NOM-BDAMATCHEND-PERFORM.
SORT T-NOM-BDAMATCH
DESCENDING NOM-NOM-BDAMATCHDESCENDING GRU-NOMS-BDAMATCHDESCENDING LNG-NOM-BDAMATCHASCENDING  CTA-NOM-BDAMATCH .MOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 1 TO I-CTA-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCHMOVE 999TO CTA-NOM-ANT-BDAMATCHMOVE ALL "9"TO GRU-NOM-ANT-BDAMATCHPERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCHOR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0OR FIL-FUE-BDAMATCH > LIM-BDAMATCHOR COL-FUE-BDAMATCH > LIM-BDAMATCHIF GRU-NOM-ANT-BDAMATCH <>GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)ADD  1 TO FIL-FUE-BDAMATCHMOVE 1 TO COL-FUE-BDAMATCHMOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHELSE
IF CTA-NOM-ANT-BDAMATCH <>CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)ADD 1 TO COL-FUE-BDAMATCHEND-IF
END-IF
MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TOCTA-NOM-ANT-BDAMATCHMOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TOGRU-NOM-ANT-BDAMATCHADD 1 TO I-CTA-BDAMATCHEND-PERFORM.
MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.4000-U-INTERELACIONAR-BDAMATCH.
REMARK********************************************************************
REMARK*4000-U-INTERELACIONAR-BDAMATCH.
REMARK* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
REMARK* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
REMARK* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
REMARK* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
REMARK********************************************************************
PESO01*    PERFORM 1110-MOSTRAR-MATRIZ1RMB0004MOVE 1 TO MOVIDO-BDAMATCH    .PERFORM UNTIL MOVIDO-BDAMATCH = 0MOVE 0 TO MOVIDO-BDAMATCHMOVE 1 TO FIL-BUS-BDAMATCHPERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCHMOVE 1 TO COL-BUS-BDAMATCHPERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCHIF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)> 0
MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)TO BUSCADO-BDAMATCH
PERFORM 4100-BUSCAR-RELACION-BDAMATCHELSE
MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHELSE
MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHEND-IF
ADD 1 TO COL-BUS-BDAMATCHEND-PERFORM
ADD 1 TO FIL-BUS-BDAMATCHEND-PERFORMEND-PERFORM.4100-BUSCAR-RELACION-BDAMATCH.
REMARK********************************************************************
REMARK*4100-BUSCAR-RELACION-BDAMATCH.
REMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
REMARK********************************************************************MOVE 1 TO FIL-FUE-BDAMATCH.PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHIF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH <= 2000
PERFORM 4110-MOVER-RELACIONES-BDAMATCHEND-IF
END-IF
ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.4110-MOVER-RELACIONES-BDAMATCH.
REMARK********************************************************************
REMARK*4110-MOVER-RELACIONES-BDAMATCH.
REMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
REMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
REMARK********************************************************************MOVE 0 TO FIN-FUENTE-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING LIBRE-BUSCADO-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4ADD 1 TO LIBRE-BUSCADO-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCH.PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCHMOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TOPORINSERTAR-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH > 2000ADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH > 2000MOVE PORINSERTAR-BDAMATCH TOCAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)ADD 1 TO LIBRE-BUSCADO-BDAMATCHMOVE 1 TO MOVIDO-BDAMATCHEND-IF
ADD 1 TO COL-FUE-BDAMATCHEND-PERFORM.
INITIALIZE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK********************************************************************
REMARK*5000-U-MEJOR-PORTAFOL-BDAMATCH.
REMARK* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
REMARK* PORTAFOLIO QUE TIENE MAS CUENTAS
REMARK********************************************************************MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.MOVE 0 TO MAXREL-PER-BDAMATCHMOVE 0 TO FIN-FUENTE-BDAMATCH.MOVE 1 TO FIL-FUE-BDAMATCH.MOVE 0 TO  PESOS-CTRL-BDAMATCH
XXXXXXMOVE 0 TO LNGNOM-MAY-MEJ-PORT-BDAMATCHPERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4MOVE 0 TO PESO-CTAS-TOT-BDAMATCHMOVE 1 TO POSIC-SUMA-BDAMATCH
PESO01MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCHRMB0004
PESO01MOVE 0 TO  POSIC-SUSC-BDAMATCHRMB0004
PESO01MOVE 0 TO ENT-FIN-PORT-BDAMATCHRMB0004
PESO01MOVE 0 TO ENT-UNICAS-PORT-BDAMATCHRMB0004
XXXXXXMOVE 0 TO LNGNOM-MAY-PORT-BDAMATCHPERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCHMOVE
FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)TO  CTA-A-BUSCAR-BDAMATCH
PESO01IF CTA-A-BUSCAR-BDAMATCH > 0RMB0004
PESO01MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
PESO01TO SUSC-CTAS-BDAMATCHRMB0004
AJUS01MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
AJUS01TO I2-BDAMATCHRMB0005
PESO01PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCHRMB0004
PESO01PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCHRMB0004
PESO01PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCHRMB0004
XXXXXXPERFORM 5400-CALCULAR-LNG-NOM-BDAMATCH
PESO01END-IFRMB0004ADD 4 TO  POSIC-SUMA-BDAMATCHEND-PERFORM
PESO01PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCHRMB0004ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.ADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.
XXXXXX 5400-CALCULAR-LNG-NOM-BDAMATCH.
XXXXXX     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1RMB0004
XXXXXXUNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH ORRMB0004
XXXXXXCTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROSRMB0004
XXXXXXIF CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
XXXXXX=  CTA-A-BUSCAR-BDAMATCH     RMB0004
XXXXXXIF LNG-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH) >RMB0004
XXXXXXLNGNOM-MAY-PORT-BDAMATCH
XXXXXXMOVE LNG-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH) TO
XXXXXXLNGNOM-MAY-PORT-BDAMATCH
XXXXXXEND-IFRMB0004
XXXXXXEND-IFRMB0004
XXXXXX     END-PERFORM.RMB0004
PESO01 5100-CALCULAR-PESO-DIR-BDAMATCH.RMB0004
PESO01     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1RMB0004
PESO01UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH ORRMB0004
PESO01CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROSRMB0004
PESO01IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
PESO01=  CTA-A-BUSCAR-BDAMATCH     RMB0004
PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH  =RMB0004
PESO01PESO-CTAS-TOT-BDAMATCH +RMB0004
PESO01(NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *RMB0004
PESO01PESO-DIR-BDAMATCH )RMB0004
PESO01END-IFRMB0004
PESO01     END-PERFORM.RMB0004
PESO01 5200-CALCULAR-PESO-TEL-BDAMATCH.RMB0004
PESO01     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1RMB0004
PESO01UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH ORRMB0004
PESO01CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROSRMB0004
PESO01IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)RMB0004
PESO01=  CTA-A-BUSCAR-BDAMATCH    RMB0004
PESO01COMPUTE  PESO-CTAS-TOT-BDAMATCH  =RMB0004
PESO01PESO-CTAS-TOT-BDAMATCH +RMB0004
PESO01(NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *RMB0004
PESO01PESO-TEL-BDAMATCH )RMB0004
PESO01END-IFRMB0004
PESO01     END-PERFORM.RMB0004
PESO01 5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004
REMARK******************************************************************
PESO01*5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004
REMARK* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
REMARK* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
REMARK******************************************************************
PESO01     SET IND-DIR-BDAMATCH TO 1.RMB0004
PESO01     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT ENDRMB0004
PESO01MOVE 1 TO  INV-BDAMATCHRMB0004
PESO01WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =RMB0004
PESO01SUSC-CTAS-BDAMATCHRMB0004
PESO01MOVE 0 TO  INV-BDAMATCHRMB0004
PESO01     END-SEARCH.RMB0004
PESO01     IF INV-BDAMATCH  =  1RMB0004
PESO01AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCHRMB0004
PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
PESO01+ PESO-NOM-BDAMATCHRMB0004PESO01COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
PESO01+ PESO-NOM-BDAMATCHRMB0004
PESO01ADD   1TO  POSIC-SUSC-BDAMATCHRMB0004
PESO01MOVE SUSC-CTAS-BDAMATCH  TORMB0004
PESO01COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)RMB0004
AJUS01*MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCHRMB0005
AJUS01IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100RMB0005
AJUS01IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2RMB0005
AJUS01ADD 1 TO ENT-FIN-PORT-BDAMATCHRMB0005
AJUS01END-IFRMB0005
AJUS01END-IFRMB0005
PESO01ADD 1 TO ENT-UNICAS-PORT-BDAMATCHRMB0004
PESO01     END-IF.RMB0004
PESO01     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1RMB0004
PESO01ADD 1000 TO PESO-CTAS-TOT-BDAMATCHRMB0004
PESO01     END-IF.RMB0004
PESO01 5400-DEDUCIR-MEJ-PORT-BDAMATCH.RMB0004
PESO01     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCHRMB0004
PESO01MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCHRMB0004
PESO01     END-IFRMB0004
PESO01     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCHRMB0004
PESO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
PESO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
PESO01MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
XXXXXXMOVE LNGNOM-MAY-PORT-BDAMATCH TO
XXXXXXLNGNOM-MAY-MEJ-PORT-BDAMATCH
PESO01     ELSERMB0004
PESO01IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCHRMB0004
MEJO01PERFORM 5410-DESEMPATAR-BDAMATCHRMB0004
PESO01END-IFRMB0004
PESO01     END-IF.RMB0004
MEJO01 5410-DESEMPATAR-BDAMATCH.RMB0004
MEJO01IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
XXXXXXMOVE LNGNOM-MAY-PORT-BDAMATCH TO
XXXXXXLNGNOM-MAY-MEJ-PORT-BDAMATCH
MEJO01ELSERMB0004
MEJO01IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
MEJO01IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 ANDRMB0004
MEJO01NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
MEJO01".-,"RMB0004
MEJO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TORMB0004
MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
XXXXXXMOVE LNGNOM-MAY-PORT-BDAMATCH TO
XXXXXXLNGNOM-MAY-MEJ-PORT-BDAMATCH
MEJO01ELSERMB0004
XXXXXX*IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >RMB0004
XXXXXX*LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
XXXXXXIF LNGNOM-MAY-PORT-BDAMATCH >
XXXXXXLNGNOM-MAY-MEJ-PORT-BDAMATCH
XXXXXXMOVE LNGNOM-MAY-PORT-BDAMATCH TO
XXXXXXLNGNOM-MAY-MEJ-PORT-BDAMATCHXXXXXXMOVE LNGNOM-MAY-PORT-BDAMATCH TO
XXXXXXLNGNOM-MAY-MEJ-PORT-BDAMATCH
MEJO01MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
MEJO01MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
MEJO01MOVE ENT-FIN-PORT-BDAMATCH TORMB0004
MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01END-IFRMB0004
MEJO01END-IFRMB0004
MEJO01END-IF.RMB0004
5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK*********************************************************************
REMARK*5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
REMARK* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
REMARK*********************************************************************MOVE 0 TO VALCTA-OUTPUT-BDAMATCHMOVE 1 TO I-BDAMATCH.IF MEJOR-PORTAFOLIO-BDAMATCH > 0PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORVALCTA-OUTPUT-BDAMATCH = 1 ORCAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)TO J-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHMOVE 1 TO VALCTA-OUTPUT-BDAMATCHEND-IF
ADD 1 TO I-BDAMATCHEND-PERFORMEND-IF.
*
6000-U-MEJOR-DIR-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-DIR-BDAMATCH.
REMARK*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
REMARK*********************************************************************SORT T-DIR-BDAMATCH
DESCENDING  NUM-CTAS-DIR-BDAMATCHDESCENDINGLNG-DIR-BDAMATCHDESCENDINGNUM-DIR-BDAMATCHDESCENDINGCTA-DIR-BDAMATCH.MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.6000-U-MEJOR-TEL-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-TEL-BDAMATCH.
REMARK*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
REMARK*********************************************************************SORT T-TEL-BDAMATCH
DESCENDING  NUM-CTAS-TEL-BDAMATCHDESCENDINGNUM-TEL-BDAMATCHDESCENDINGCTA-TEL-BDAMATCH.MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
*
6000-U-MEJOR-NOM-BDAMATCH.
REMARK*********************************************************************
REMARK*6000-U-MEJOR-NOM-BDAMATCH.REMARK*********************************************************************
REMARK*6000-U-MEJOR-NOM-BDAMATCH.
REMARK*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
REMARK*********************************************************************SORT T-GRUNOM-BDAMATCH
DESCENDING  NUM-CTAS-GRUNOM-BDAMATCHDESCENDING  LNG-GRUNOM-BDAMATCHDESCENDING  NOM-GRUNOM-BDAMATCH.MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCHOR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCHOR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROSOR ESTA-CTA-BDAMATCH  =  1IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCHOR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,NRO-VECES-1-BDAMATCH) = 0OR ESTA-CTA-BDAMATCH  =  1IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
NRO-VECES-1-BDAMATCH)MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TOPOSIC-SUS-GRU-BDAMATCHMOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TONOM-OUTPUT-BDAMATCHMOVE 1 TO  ESTA-CTA-BDAMATCHEND-IF
END-PERFORM
END-IF
END-PERFORM
END-PERFORM.
*
9000-U-REALIZAR-BDAMATCH.
REMARK******************************************************************
REMARK*9000-U-REALIZAR-BDAMATCH.
REMARK* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL
REMARK* MEJOR NOMBRE
REMARK******************************************************************MOVE  ZEROSTO  POSIC-SUSC-BDAMATCHMOVE  ALL "9"TO  TABLA-SUSC-DIR-BDAMATCHPERFORM 3000-U-ORDENAR-DIR-BDAMATCHPERFORM 3000-U-ORDENAR-TEL-BDAMATCHPERFORM 3000-U-ORDENAR-NOM-BDAMATCHPERFORM 4000-U-INTERELACIONAR-BDAMATCHPERFORM 6000-U-MEJOR-DIR-BDAMATCH.PERFORM 6000-U-MEJOR-TEL-BDAMATCH.PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.PERFORM 6000-U-MEJOR-NOM-BDAMATCH.
*
9010-U-VER-FALLECIDO-BDAMATCH.*
9010-U-VER-FALLECIDO-BDAMATCH.
REMARK*********************************************************************
REMARK*9010-U-VER-FALLECIDO-BDAMATCH.
REMARK* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL
REMARK* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.
REMARK*********************************************************************
VIGE01     MOVE 1 TO I-BDAMATCH.RMB0003
VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003
VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003
VIGE01VALCTA-OUTPUT-BDAMATCH = 1 ORRMB0003
VIGE01CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
VIGE01MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
VIGE01TO J-BDAMATCHRMB0003
VIGE01ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCHRMB0003
VIGE01IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1RMB0003
VIGE01ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCHRMB0003
VIGE01END-IFRMB0003
VIGE01ADD 1 TO I-BDAMATCHRMB0003
VIGE01END-PERFORMRMB0003
VIGE01     END-IF.RMB0003
VIGE01*RMB0003
400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.
IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

BDAMATCHRMB.PROC:
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCH


VIGE01ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCHRMB0003
VIGE01IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1RMB0003
VIGE01ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCHRMB0003
VIGE01END-IFRMB0003
VIGE01ADD 1 TO I-BDAMATCHRMB0003
VIGE01END-PERFORMRMB0003
VIGE01     END-IF.RMB0003
VIGE01*RMB0003
400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.
IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

BDAMATCHRMB.PROC:
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADAS
REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCH
REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCH






BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE.PROC.v.03.0006
*****************************************************************
RUTINA DE VALIDACION DE IDENTIFICACIONES
*****************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
       NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
*
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON 
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
      * FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
*****************************************************************
      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL  
      * AGO.11/2004 * DIGITO DE CHEQUEO. 
      * FAC0004CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO 
      CORRESPONDE AL RANGO.
*****************************************************************
      * F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FACDEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
*****************************************************************
      * F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN    
      * OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS   
* FAC006C     *
REMARK******************************************************************
       80100-VALIDAR-IDENTIFICACION.
===================================*
80100-VALIDAR-IDENTIFICACION.
Valida el numero de identificacion contra las bases de datos
de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
 y verifica la coincidencia del nombre reportado
REMARK*===================================*
          INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM 
                     NOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IF                        FAC0002
1227 lines deleted


* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
*****************************************************************
 RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
 R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
             *        MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH 
REMARK*             *                  NUM-CTAS-OUTPUT-BDAMATCH   
REMARKSINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK       BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE 
REMARK*               DE FRENADAS

REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *          DEL PORTAFOLIO .              *
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL * 
             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       * 
REMARK*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               *
REMARK*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK*        LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARKNOMB01 - MAQUILLAR EL NOMBRE*
             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************
REMARK* RMBAJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK*             *          DECUENTA DE LA MISMA CUENTA            *
REMARK*****************************************************************

       1000-U-RECORRER-CSV-BDAMATCH.                  
REMARK******************************************************************
1000-U-RECORRER-CSV-BDAMATCH.       
 SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
MATCH 
*****************************************************************
           MOVE 0 TO IDE-TIPO-BDAMATCH     
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .             RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003 MOVE 0 TO MAX-CUENTAS-BDAMATCH.        
           IF ABIERTO-BDAMATCH  = 0          
       OPEN INPUT  BDACSV                      
              MOVE 1 TO ABIERTO-BDAMATCHmore lines






BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE.PROC.v.03.0006
*****************************************************************
RUTINA DE VALIDACION DE IDENTIFICACIONES
*****************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
       NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
*
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON 
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
      * FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
*****************************************************************
      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL  
      * AGO.11/2004 * DIGITO DE CHEQUEO. 
      * FAC0004CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO 
      CORRESPONDE AL RANGO.
*****************************************************************
      * F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FACDEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
*****************************************************************
      * F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN    
      * OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS   
* FAC006C     *
REMARK******************************************************************
       80100-VALIDAR-IDENTIFICACION.
===================================*
80100-VALIDAR-IDENTIFICACION.
Valida el numero de identificacion contra las bases de datos
de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
 y verifica la coincidencia del nombre reportado
REMARK*===================================*
          INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM 
                     NOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002
NUIP01MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002
NUIP01    END-IF                        FAC0002fewer lines

sdiff -w 170  BDAMATCHRMB.PROCC  BDAMATCHRMB.PROCH
sdiff -w 170 BDAMATCH.PROC BDAMATCHRMB.PROC


!sdiff -w 170 BDAMATCH.PROC BDAMATCHRMB.PROC


* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCHREMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITOREMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJORREMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LASREMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************REMARK******************************************************************
 RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DEREMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
 R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL   REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
             *        MEJOR PORTAFOLIO  REMARK**MEJOR PORTAFOLIO
 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH      REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK*             *                  NUM-CTAS-OUTPUT-BDAMATCH     REMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SINREMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK       BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUEREMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK       DE FRENADAS                            REMARK**DE FRENADAS
REMARK*****************************************************************REMARK*****************************************************************
 RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  * REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *          DEL PORTAFOLIO .                       *REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK*        BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       * REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
             * FUEN01 - NCLUIR  FUENTES EXTERNAS               * REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH       *REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK*             * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK*        NOMB01 - MAQUILLAR EL NOMBRE            *REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARKVLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2* REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************  REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  * REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
             *          DECUENTA DE LA MISMA CUENTA            * REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************REMARK*****************************************************************

 1000-U-RECORRER-CSV-BDAMATCH.1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCHREMARK*1000-U-RECORRER-CSV-BDAMATCH.
 SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACIONREMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
 BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR ELREMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
MATCH                                                       REMARK* MATCH
*****************************************************************REMARK******************************************************************
           MOVE 0 TO IDE-TIPO-BDAMATCH                 MOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                 RMB0003VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH. MOVE 0 TO MAX-CUENTAS-BDAMATCH. IF ABIERTO-BDAMATCH  = 0                        IF ABIERTO-BDAMATCH  = 0
              OPEN INPUT  BDACSV                    OPEN INPUT  BDACSV
       MOVE 1 TO ABIERTO-BDAMATCH              MOVE 1 TO ABIERTO-BDAMATCH
1226 more lines


* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS* OJO **r
ecordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005REMARK* B
DAMATCH.PROC.v.0005
REMARK******************************************************************REMARK***
***************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCHREMARK* E
STE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITOREMARK* D
E NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJORREMARK* C
OPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LASREMARK* P
ORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.REMARK* E
STRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************REMARK***
*****************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*REMARK* C
AV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*REMARK* C
. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*REMARK* R
.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************REMARK***
***************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DEREMARK* R
MB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DELREMARK* R
.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIOREMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCHREMARK* 2
5-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCHREMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SINREMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUEREMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADASREMARK**DE FRENADAS
REMARK*****************************************************************REMARK***
**************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *REMARK* R
MB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*REMARK* R
-MARTINEZ. *DEL PORTAFOLIO .*
@* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCHREMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITOREMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJORREMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LASREMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DEREMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DELREMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIOREMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCHREMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCHREMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SINREMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUEREMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADASREMARK**DE FRENADAS
REMARK*****************************************************************REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACIONREMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR ELREMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCHREMARK* MATCH
REMARK******************************************************************REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVOPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHMOVE 1 TO ABIERTO-BDAMATCHEND-IF.END-IF.INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .

REMARK******************************************************************REMARK***
***************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCHREMARK* E
STE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITOREMARK* D
E NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJORREMARK* C
OPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LASREMARK* P
ORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.REMARK* E
STRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************REMARK***
*****************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*REMARK* C
AV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*REMARK* C
. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*REMARK* R
.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************REMARK***
***************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DEREMARK* R
MB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DELREMARK* R
.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIOREMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCHREMARK* 2
5-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCHREMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SINREMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUEREMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADASREMARK**DE FRENADAS
REMARK*****************************************************************REMARK***
**************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *REMARK* R
MB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*REMARK* R
-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *REMARK* 5
-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
@REMARK******************************************************************REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCHREMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITOREMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJORREMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LASREMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DEREMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DELREMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIOREMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCHREMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCHREMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SINREMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUEREMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADASREMARK**DE FRENADAS
REMARK*****************************************************************REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACIONREMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR ELREMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCHREMARK* MATCH
REMARK******************************************************************REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0OPEN INPUT  BDACSVOPEN INPUT  BDACSVMOVE 1 TO ABIERTO-BDAMATCHMOVE 1 TO ABIERTO-BDAMATCHEND-IF.END-IF.INITIALIZE LLAVE-BDACSV.INITIALIZE LLAVE-BDACSV.MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .MOVE 0 TO FIN-BDAMATCH .MOVE 0 TO FIN-BDAMATCH .REMARK* BDAMATCH.PROC.v.0005REMARK* BDAMATCH.PROC.v.0005* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMASsdiff -w 170 BDAMATCH.PROC BDAMATCHRMB.PROCsdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq





PERFORM 4100-BUSCAR-RELACION-BDAMATCHPERFORM 4100-BUSCAR-RELACION-BDAMATCHELSEELSEMOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHMOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCHEND-IFEND-IFADD 1 TO COL-BUS-BDAMATCHADD 1 TO COL-BUS-BDAMATCHEND-PERFORMEND-PERFORMADD 1 TO FIL-BUS-BDAMATCHADD 1 TO FIL-BUS-BDAMATCHEND-PERFORMEND-PERFORMEND-PERFORM.END-PERFORM.4100-BUSCAR-RELACION-BDAMATCH.4100-BUSCAR-RELACION-BDAMATCH.
REMARK********************************************************************REMARK********************************************************************
REMARK*4100-BUSCAR-RELACION-BDAMATCH.REMARK*4100-BUSCAR-RELACION-BDAMATCH.
REMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILAREMARK* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
REMARK********************************************************************REMARK********************************************************************MOVE 1 TO FIL-FUE-BDAMATCH.MOVE 1 TO FIL-FUE-BDAMATCH.PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHPERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCHIF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCHIF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING EXISTE-BDAMATCHTALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCHFOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHADD 1 TO EXISTE-BDAMATCHIF EXISTE-BDAMATCH <= 2000IF EXISTE-BDAMATCH <= 2000PERFORM 4110-MOVER-RELACIONES-BDAMATCHPERFORM 4110-MOVER-RELACIONES-BDAMATCHEND-IFEND-IFEND-IFEND-IFADD 1 TO FIL-FUE-BDAMATCHADD 1 TO FIL-FUE-BDAMATCHEND-PERFORM.END-PERFORM.4110-MOVER-RELACIONES-BDAMATCH.4110-MOVER-RELACIONES-BDAMATCH.
REMARK********************************************************************REMARK********************************************************************
REMARK*4110-MOVER-RELACIONES-BDAMATCH.REMARK*4110-MOVER-RELACIONES-BDAMATCH.
REMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONESREMARK* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
REMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDAREMARK* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
REMARK********************************************************************REMARK********************************************************************MOVE 0 TO FIN-FUENTE-BDAMATCH.MOVE 0 TO FIN-FUENTE-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)TALLYING FIN-FUENTE-BDAMATCHTALLYING FIN-FUENTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "FOR CHARACTERS BEFORE INITIAL "000 "COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING LIBRE-BUSCADO-BDAMATCHTALLYING LIBRE-BUSCADO-BDAMATCHFOR CHARACTERS BEFORE INITIAL "000 "FOR CHARACTERS BEFORE INITIAL "000 "COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4ADD 1 TO LIBRE-BUSCADO-BDAMATCH.ADD 1 TO LIBRE-BUSCADO-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCH.MOVE 1 TO COL-FUE-BDAMATCH.PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCHPERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCHMOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TOMOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TOPORINSERTAR-BDAMATCHPORINSERTAR-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHMOVE 0 TO EXISTE-BDAMATCHINSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)TALLYING EXISTE-BDAMATCHTALLYING EXISTE-BDAMATCHFOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCHFOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCHADD 1 TO EXISTE-BDAMATCHADD 1 TO EXISTE-BDAMATCHMEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004MEJO01ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
MEJO01END-IFRMB0004MEJO01END-IFRMB0004
MEJO01END-IFRMB0004MEJO01END-IFRMB0004
MEJO01END-IF.RMB0004MEJO01END-IF.RMB0004
5000-U-VALIDAR-CUENTA-BDAMATCH.5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK*********************************************************************REMARK*********************************************************************
REMARK*5000-U-VALIDAR-CUENTA-BDAMATCH.REMARK*5000-U-VALIDAR-CUENTA-BDAMATCH.
REMARK* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTROREMARK* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
REMARK* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCHREMARK* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
REMARK*********************************************************************REMARK*********************************************************************MOVE 0 TO VALCTA-OUTPUT-BDAMATCHMOVE 0 TO VALCTA-OUTPUT-BDAMATCHMOVE 1 TO I-BDAMATCH.MOVE 1 TO I-BDAMATCH.IF MEJOR-PORTAFOLIO-BDAMATCH > 0IF MEJOR-PORTAFOLIO-BDAMATCH > 0PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORPERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORVALCTA-OUTPUT-BDAMATCH = 1 ORVALCTA-OUTPUT-BDAMATCH = 1 ORCAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)TO J-BDAMATCHTO J-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHIF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCHMOVE 1 TO VALCTA-OUTPUT-BDAMATCHMOVE 1 TO VALCTA-OUTPUT-BDAMATCHEND-IFEND-IFADD 1 TO I-BDAMATCHADD 1 TO I-BDAMATCHEND-PERFORMEND-PERFORMEND-IF.END-IF.
**
6000-U-MEJOR-DIR-BDAMATCH.6000-U-MEJOR-DIR-BDAMATCH.
REMARK*********************************************************************REMARK*********************************************************************
REMARK*6000-U-MEJOR-DIR-BDAMATCH.REMARK*6000-U-MEJOR-DIR-BDAMATCH.
REMARK*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCIONREMARK*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
REMARK*********************************************************************REMARK*********************************************************************SORT T-DIR-BDAMATCHSORT T-DIR-BDAMATCHDESCENDING  NUM-CTAS-DIR-BDAMATCHDESCENDING  NUM-CTAS-DIR-BDAMATCHDESCENDINGLNG-DIR-BDAMATCHDESCENDINGLNG-DIR-BDAMATCHDESCENDINGNUM-DIR-BDAMATCHDESCENDINGNUM-DIR-BDAMATCHDESCENDINGCTA-DIR-BDAMATCH.DESCENDINGCTA-DIR-BDAMATCH.MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.6000-U-MEJOR-TEL-BDAMATCH.6000-U-MEJOR-TEL-BDAMATCH.
REMARK*********************************************************************REMARK*********************************************************************
REMARK*6000-U-MEJOR-TEL-BDAMATCH.REMARK*6000-U-MEJOR-TEL-BDAMATCH.
REMARK*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONOREMARK*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
REMARK*********************************************************************REMARK*********************************************************************SORT T-TEL-BDAMATCHSORT T-TEL-BDAMATCHDESCENDING  NUM-CTAS-TEL-BDAMATCHDESCENDING  NUM-CTAS-TEL-BDAMATCHDESCENDINGNUM-TEL-BDAMATCHDESCENDINGNUM-TEL-BDAMATCHDESCENDINGCTA-TEL-BDAMATCH.DESCENDINGCTA-TEL-BDAMATCH.MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
**
6000-U-MEJOR-NOM-BDAMATCH.6000-U-MEJOR-NOM-BDAMATCH.
REMARK*********************************************************************REMARK*********************************************************************
REMARK*6000-U-MEJOR-NOM-BDAMATCH.REMARK*6000-U-MEJOR-NOM-BDAMATCH.
REMARK*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBREREMARK*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
REMARK*********************************************************************REMARK*********************************************************************SORT T-GRUNOM-BDAMATCHSORT T-GRUNOM-BDAMATCHDESCENDING  NUM-CTAS-GRUNOM-BDAMATCHDESCENDING  NUM-CTAS-GRUNOM-BDAMATCHDESCENDING  LNG-GRUNOM-BDAMATCHDESCENDING  LNG-GRUNOM-BDAMATCHVIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003VIGE01     IF MEJOR-PORTAFOLIO-BDAMATCH > 0RMB0003
VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003VIGE01PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH ORRMB0003
VIGE01VALCTA-OUTPUT-BDAMATCH = 1 ORRMB0003VIGE01VALCTA-OUTPUT-BDAMATCH = 1 ORRMB0003
VIGE01CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003VIGE01CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
VIGE01MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003VIGE01MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
VIGE01TO J-BDAMATCHRMB0003VIGE01TO J-BDAMATCHRMB0003
VIGE01ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCHRMB0003VIGE01ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCHRMB0003
VIGE01IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1RMB0003VIGE01IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1RMB0003
VIGE01ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCHRMB0003VIGE01ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCHRMB0003
VIGE01END-IFRMB0003VIGE01END-IFRMB0003
VIGE01ADD 1 TO I-BDAMATCHRMB0003VIGE01ADD 1 TO I-BDAMATCHRMB0003
VIGE01END-PERFORMRMB0003VIGE01END-PERFORMRMB0003
VIGE01     END-IF.RMB0003VIGE01     END-IF.RMB0003
VIGE01*RMB0003VIGE01*RMB0003
400-BUSCAR-SUSC-GRUPO-BDAMATCH.400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK******************************************************************REMARK******************************************************************
REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.REMARK*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.REMARK* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
REMARK******************************************************************REMARK******************************************************************SET IND-NOM-BDAMATCH TO 1.SET IND-NOM-BDAMATCH TO 1.SEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDSEARCH ALL REG-SUSC-NOM-BDAMATCH AT ENDMOVE 1 TO  INV-BDAMATCHMOVE 1 TO  INV-BDAMATCHWHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =WHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =SUSC-GRUPO-BDAMATCHSUSC-GRUPO-BDAMATCHMOVE 0 TO  INV-BDAMATCHMOVE 0 TO  INV-BDAMATCHEND-SEARCH.END-SEARCH.IF  INV-BDAMATCH = 1IF  INV-BDAMATCH = 1AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHAND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHADD 1 TO  POSIC-SUS-GRU-BDAMATCHMOVE SUSC-GRUP-SUS-BDAMATCH TOMOVE SUSC-GRUP-SUS-BDAMATCH TOCOD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)COD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)MOVE SUSC-GRUP-GRU-BDAMATCH TOMOVE SUSC-GRUP-GRU-BDAMATCH TOGRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)END-IF.END-IF.




BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
  

     

     




sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

sdiff -w 170 BDAMATCH.PROC BDAMATCHRMB.PROC
* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS* OJO **recordar que este copy está en LEEMAESTROS.PROC Y NO EN LOS PROGRAMAS
REMARK* BDAMATCH.PROC.v.0005REMARK* BDAMATCH.PROC.v.0005
REMARK******************************************************************REMARK******************************************************************
REMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCHREMARK* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
REMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITOREMARK* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
REMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJORREMARK* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
REMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LASREMARK* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.REMARK* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
REMARK********************************************************************REMARK********************************************************************
REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*REMARK* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA*
REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*REMARK* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*REMARK* R.MARTINEZ  *10 POSICIONES DE LAS MISMA.*
REMARK******************************************************************REMARK******************************************************************
REMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DEREMARK* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
REMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DELREMARK* R.MARTINEZ  *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
REMARK**MEJOR PORTAFOLIOREMARK**MEJOR PORTAFOLIO
REMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCHREMARK* 25-MARZ-2010*SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
REMARK**NUM-CTAS-OUTPUT-BDAMATCHREMARK**NUM-CTAS-OUTPUT-BDAMATCH
REMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SINREMARK**SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
REMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUEREMARK**BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
REMARK**DE FRENADASREMARK**DE FRENADAS
REMARK*****************************************************************REMARK*****************************************************************
REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *REMARK* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*REMARK* R-MARTINEZ. *DEL PORTAFOLIO .*
REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *REMARK* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*REMARK** BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV*
REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*REMARK** FUEN01 - NCLUIR  FUENTES EXTERNAS*
REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*REMARK** APEL01 - INCLUIR PRIMER APELLIDO EN MATCH*
REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*REMARK** LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7*
REMARK** NOMB01 - MAQUILLAR EL NOMBRE*REMARK** NOMB01 - MAQUILLAR EL NOMBRE*
REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *REMARK** VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*REMARK**CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
REMARK*****************************************************************REMARK*****************************************************************
REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *REMARK* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*REMARK* R-MARTINEZ. *EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *REMARK* 14-DIC 2011 *SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
REMARK**DECUENTA DE LA MISMA CUENTA*REMARK**DECUENTA DE LA MISMA CUENTA*
REMARK*****************************************************************REMARK*****************************************************************1000-U-RECORRER-CSV-BDAMATCH.1000-U-RECORRER-CSV-BDAMATCH.
REMARK******************************************************************REMARK******************************************************************
REMARK*1000-U-RECORRER-CSV-BDAMATCH.REMARK*1000-U-RECORRER-CSV-BDAMATCH.
REMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACIONREMARK* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
REMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR ELREMARK* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
REMARK* MATCHREMARK* MATCH
REMARK******************************************************************REMARK******************************************************************MOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003VIGE01     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .RMB0003
VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003VIGE01     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.RMB0003MOVE 0 TO MAX-CUENTAS-BDAMATCH.MOVE 0 TO MAX-CUENTAS-BDAMATCH.IF ABIERTO-BDAMATCH  = 0IF ABIERTO-BDAMATCH  = 0






BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE.PROC.v.03.0006
*****************************************************************
RUTINA DE VALIDACION DE IDENTIFICACIONES
*****************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
      *             * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002 NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
*****************************************************************
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON 
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO       
      * FAC0003NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
*****************************************************************
      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL  
      * AGO.11/2004 * DIGITO DE CHEQUEO. 
      * FAC0004CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO 
      CORRESPONDE AL RANGO.
*****************************************************************
      * F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FAC0005DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
*****************************************************************
      * F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN     
      * OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS    
      * FAC006C
*
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
80100-VALIDAR-IDENTIFICACION.
 Valida el numero de identificacion contra las bases de datos
de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
y verifica la coincidencia del nombre reportado
===================================*
          INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM           NOMBRES-AUX-W-BDIIVIDE
          INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIPIF SW-VERIFNOM-BDIIVIDE NOT NUMERIC  FAC0002 
NUIP01       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDEFAC0002 
NUIP01    END-IF                   FAC0002 
1229 lines deleted

BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     *
REMARK******************************************************************
80100-VALIDAR-IDENTIFICACION.
REMARK*===================================*
REMARK*80100-VALIDAR-IDENTIFICACION.
REMARK* Valida el numero de identificacion contra las bases de datos
REMARK* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI
REMARK* y verifica la coincidencia del nombre reportado
REMARK*===================================*INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOMNOMBRES-AUX-W-BDIIVIDEINSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
NUIP01    IF SW-VERIFNOM-BDIIVIDE NOT NUMERICFAC0002































BDACSV.FS::r BDACSV.FS"BDACSV.FS" 9 lines, 401 characters * BDACSV-FS.V.0001
* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DASSELECT BDACSV
ASSIGN TO DISK "$DATABASE/BDACSV"ORGANIZATION IS INDEXEDACCESS MODE IS DYNAMICRECORD KEY IS LLAVE-BDACSVLOCK MODE IS MANUAL WITH LOCK ON RECORD.








BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************BDACSV.FS::r BDACSV.FS"BDACSV.FS" 9 lines, 401 characters * BDACSV-FS.V.0001
* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DASSELECT BDACSV
ASSIGN TO DISK "$DATABASE/BDACSV"ORGANIZATION IS INDEXEDACCESS MODE IS DYNAMICRECORD KEY IS LLAVE-BDACSVLOCK MODE IS MANUAL WITH LOCK ON RECORD.








BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORIBDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
9 fewer linesFD:r BDACSV.FD"BDACSV.FD" 51 lines, 3101 characters * BDACSV-FD.v.0003
* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DAS
******************************************************************
* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
* R.MARTINEZ *POR T7
******************************************************************
* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
* OCT-12-2012*DE REGISTRADURIA INCOMPLETA DE FUENTE
* LUIS GOMEZ *CONFIABLE
******************************************************************
FD  BDACSV.
01  REG-BDACSV.
03 LLAVE-BDACSV.
05  TIPO-ID-BDACSV    PIC 9(01).
              05  NUM-ID-BDACSV     PIC 9(15).
              05  COD-SUS-BDACSV    PIC 9(06).
              05  COD-CTA-BDACSV    PIC 9(02).
              05  NUM-CTA-BDACSV    PIC X(25).
           03  NOMBRE-BDACSVPIC X(45).
INCLUS     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.STT0003
INCLUS        05 APELLIDO1-BDACSVPIC X(16).STT0003
INCLUS        05 APELLIDO2-BDACSVPIC X(16).STT0003
INCLUS        05 DES-NOMBRE1-BDACSV    PIC X(12).STT0003
INCLUS     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
           03  FECHA-CREA-BDACSV       PIC 9(08).
           03  NUM-PORTAF-BDACSV    PIC 9(02).03  IND-NOMBRE-BDACSV    PIC 9(02).03  MEJOR-PORTAF-BDACSV  PIC 9(02).03  IND-ACTUALIZ-BDACSV  PIC 9(02).03  FUENTE-REG-BDACSV    PIC 9(02).BLOQ01     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADORMB0002TIP6Y7     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002INCLUS*    03  FILLERPIC X(50).STT0003* BDACSV-FD.v.0003* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DAS
******************************************************************
* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
* R.MARTINEZ *POR T7
******************************************************************
* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
* OCT-12-2012*DE REGISTRADURIA INCOMPLETA DE FUENTE
* LUIS GOMEZ *CONFIABLE
******************************************************************
FD  BDACSV.
01  REG-BDACSV.
03 LLAVE-BDACSV.
05  TIPO-ID-BDACSV    PIC 9(01).05  NUM-ID-BDACSV     PIC 9(15).05  COD-SUS-BDACSV    PIC 9(06).05  COD-CTA-BDACSV    PIC 9(02).05  NUM-CTA-BDACSV    PIC X(25).03  NOMBRE-BDACSVPIC X(45).
INCLUS     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.STT0003
INCLUS05 APELLIDO1-BDACSVPIC X(16).STT0003
INCLUS05 APELLIDO2-BDACSVPIC X(16).STT0003
INCLUS05 DES-NOMBRE1-BDACSV    PIC X(12).STT0003
INCLUS     05  IND-UNIFICADO-BDACSV    PIC 9(01).STT000303  FECHA-CREA-BDACSVPIC 9(08).03  NUM-PORTAF-BDACSV    PIC 9(02).03  IND-NOMBRE-BDACSV    PIC 9(02).03  MEJOR-PORTAF-BDACSV  PIC 9(02).03  IND-ACTUALIZ-BDACSV  PIC 9(02).03  FUENTE-REG-BDACSV    PIC 9(02).
BLOQ01     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADORMB0002
TIP6Y7     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002
INCLUS*    03  FILLERPIC X(50).STT0003
INCLUS     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003
INCLUS05  DES-NOMBRE2-BDACSV    PIC X(12).STT0003
INCLUS05  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003
INCLUS05  DEP-EXP-BDACSVPIC 9(02).STT0003
INCLUS05  MUNIC-EXP-BDACSVPIC 9(03).STT0003
INCLUS05  ESTADO-VIG-BDACSV     PIC 9(02).STT0003
INCLUS05  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003
INCLUS05  IND-SEXO-BDACSVPIC X.STT0003
INCLUS05  IND-ESTADO-BDACSV     PIC 9.STT0003
INCLUS05  IND-CONSULADO-BDACSV  PIC 9(1).STT0003
INCLUS05  COD-CONSULADO-BDACSV  PIC 9(3).STT0003
INCLUS     03  FILLERPIC X(07).STT0003
BLOQ01*    03  FILLERPIC X(48).BLOQ01*    03  FILLERPIC X(48).BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)* BDACSV-FD.v.0003* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DAS
******************************************************************
* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
* R.MARTINEZ *POR T7
******************************************************************
* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
* OCT-12-2012*DE REGISTRADURIA INCOMPLETA DE FUENTE
* LUIS GOMEZ *CONFIABLE
******************************************************************
FD  BDACSV.
01  REG-BDACSV.
03 LLAVE-BDACSV.
05  TIPO-ID-BDACSV    PIC 9(01).05  NUM-ID-BDACSV     PIC 9(15).05  COD-SUS-BDACSV    PIC 9(06).05  COD-CTA-BDACSV    PIC 9(02).05  NUM-CTA-BDACSV    PIC X(25).03  NOMBRE-BDACSVPIC X(45).
INCLUS     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.STT0003
INCLUS05 APELLIDO1-BDACSVPIC X(16).STT0003
INCLUS05 APELLIDO2-BDACSVPIC X(16).STT0003
INCLUS05 DES-NOMBRE1-BDACSV    PIC X(12).STT0003
INCLUS     05  IND-UNIFICADO-BDACSV    PIC 9(01).STT000303  FECHA-CREA-BDACSVPIC 9(08).03  NUM-PORTAF-BDACSV    PIC 9(02).03  IND-NOMBRE-BDACSV    PIC 9(02).03  MEJOR-PORTAF-BDACSV  PIC 9(02).03  IND-ACTUALIZ-BDACSV  PIC 9(02).03  FUENTE-REG-BDACSV    PIC 9(02).
BLOQ01     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADORMB0002
TIP6Y7     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002
INCLUS*    03  FILLERPIC X(50).STT0003
INCLUS     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003
INCLUS05  DES-NOMBRE2-BDACSV    PIC X(12).STT0003
INCLUS05  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003
INCLUS05  DEP-EXP-BDACSVPIC 9(02).STT0003
INCLUS05  MUNIC-EXP-BDACSVPIC 9(03).STT0003
INCLUS05  ESTADO-VIG-BDACSV     PIC 9(02).STT0003
INCLUS05  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003
INCLUS05  IND-SEXO-BDACSVPIC X.STT0003
INCLUS05  IND-ESTADO-BDACSV     PIC 9.STT0003
INCLUS05  IND-CONSULADO-BDACSV  PIC 9(1).STT0003
INCLUS05  COD-CONSULADO-BDACSV  PIC 9(3).STT0003
INCLUS     03  FILLERPIC X(07).STT0003
BLOQ01*    03  FILLERPIC X(48).
BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:



grep 513-VALIDA-EN-CSV
!grep -il 513-VALIDA-EN-CSV *. ^?grep: can't open *.
grep: can't open ^?
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2::!grep -il 513-VALIDA-EN-CSV *.PROC      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)!grep -i 513-VALIDA-EN-CSV *grep: can't open CARACTCAL-V02.PROC-BCK10
grep: can't open CARACTCAL-V02.PROC-BCK11
grep: can't open CARACTCAL-V02.PROC-BCK5
grep: can't open CARACTCAL-V02.PROC-BCK6
grep: can't open CARACTCAL-V02.PROC-BCK7
grep: can't open CARACTCAL-V02.PROC-BCK9
grep: can't open CARACTPER-009.PROC-2012-01-06
grep: can't open core
grep: can't open FRAINQ.DAT8 more lines
      * AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
8 fewer lines!fu/bin/ksh: fu:  not found!ls $FUENTES;w
*ICGD12.v.02.0052.
#BDIAREGI-REVISION.CBL#save#
°
|
$TEMPORALES-ICGLEY.CON
$TEMPORALES-ICGLEY.CON.idx
1
15000
172.24.2.7
510005.20080530
510046.20120629.T
600098
600098.20060425
680098.20060425
9999991000905140104.txt.log
A
a-fven.cbl
a.c
a.cbl
a.tmp
aa
aaa
AAA.CBL
aaaa.cbl
AAAAAA.CBL
AAAAlog
AAABBB.CBL
AAPR4
ABB0053.TXT
ABB0053.txt2
ACCDISP.CBL
account.cbl
ACITAGTNEW.CBL
ACITAGTNEWCC.CBL
ACITNWT.CBL
ACITRUNEW.CBL
ACOTRUACIIgj.CBL
act-carlos.cbl
ACT-CTACERO.CBL
ACT-CTASPACE.CBL
ACT-FCHAPER.CBL
ACT-GARANTE.CBL
ACT-ICITICO.CBL
11876 more lines/bin/ksh: fu:  not found












BDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
      * F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
      * JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
      *   * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
      ** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
      * FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
      * F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
      * JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
      * FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
      * F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
      * AGO.11/2004 * DIGITO DE CHEQUEO.
      * FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
      *       * CORRESPONDE AL RANGO.
REMARK******************************************************************
      * F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
      * OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
      * FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
      *             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)
fewer lines!grep -il 513-VALIDA-EN-CSVREMARK******************************************************************!grep -il $FUENTES/h513-VALIDA-EN-CSV $FUENTES/* >2>/dev/null/d/iccol/desarrollo/fuentes/icestd12.cbl
/d/iccol/desarrollo/fuentes/icestd12v09.cbl
/d/iccol/desarrollo/fuentes/P_PESVNO.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PES.CBL
/d/iccol/desarrollo/fuentes/PESVNO-AVV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-CV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-DIGITO.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL-20101014
/d/iccol/desarrollo/fuentes/PESVNO.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNO0504.CBL
/d/iccol/desarrollo/fuentes/PESVNO64.CBL
/d/iccol/desarrollo/fuentes/PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV_cg.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV-V05.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-ORI
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_CAL.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_p.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V04.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-V01
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGElag.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVTMX.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVv06.CBL
62 more linesgrep 513-VALIDA-EN-CSV
/d/iccol/desarrollo/fuentes/icestd12.cbl
/d/iccol/desarrollo/fuentes/icestd12v09.cbl
/d/iccol/desarrollo/fuentes/P_PESVNO.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PES.CBL
/d/iccol/desarrollo/fuentes/PESVNO-AVV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-CV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-DIGITO.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL-20101014
/d/iccol/desarrollo/fuentes/PESVNO.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNO0504.CBL
/d/iccol/desarrollo/fuentes/PESVNO64.CBL
/d/iccol/desarrollo/fuentes/PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV_cg.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV-V05.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-ORI
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_CAL.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_p.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V04.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-V01
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGElag.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVTMX.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOGJ.CBL
/d/iccol/desarrollo/fuentes/PESVNONW1.CBL
/d/iccol/desarrollo/fuentes/PESVNOPEO.CBL
/d/iccol/desarrollo/fuentes/PESVNOpv.CBLgrep 513-VALIDA-EN-CSV
/d/iccol/desarrollo/fuentes/icestd12.cbl
/d/iccol/desarrollo/fuentes/icestd12v09.cbl
/d/iccol/desarrollo/fuentes/P_PESVNO.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PES.CBL
/d/iccol/desarrollo/fuentes/PESVNO-AVV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-CV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-DIGITO.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL-20101014
/d/iccol/desarrollo/fuentes/PESVNO.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNO0504.CBL
/d/iccol/desarrollo/fuentes/PESVNO64.CBL
/d/iccol/desarrollo/fuentes/PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV_cg.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV-V05.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-ORI
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_CAL.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_p.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V04.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-V01
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGElag.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVTMX.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOGJ.CBL
/d/iccol/desarrollo/fuentes/PESVNONW1.CBL
/d/iccol/desarrollo/fuentes/PESVNOPEO.CBL
/d/iccol/desarrollo/fuentes/PESVNOpv.CBL
/d/iccol/desarrollo/fuentes/pesvnormb.cbl
/d/iccol/desarrollo/fuentes/PESVNORMB.CBL
/d/iccol/desarrollo/fuentes/PESVNORMB.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNORMBNW-EHA.CBLgrep 513-VALIDA-EN-CSV
/d/iccol/desarrollo/fuentes/icestd12.cbl
/d/iccol/desarrollo/fuentes/icestd12v09.cbl
/d/iccol/desarrollo/fuentes/P_PESVNO.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PES.CBL
/d/iccol/desarrollo/fuentes/PESVNO-AVV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-CV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-DIGITO.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL-20101014
/d/iccol/desarrollo/fuentes/PESVNO.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNO0504.CBL
/d/iccol/desarrollo/fuentes/PESVNO64.CBL
/d/iccol/desarrollo/fuentes/PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV_cg.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV-V05.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-ORI
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_CAL.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_p.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V04.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-V01
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGElag.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVTMX.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOGJ.CBL
/d/iccol/desarrollo/fuentes/PESVNONW1.CBL
/d/iccol/desarrollo/fuentes/PESVNOPEO.CBL
/d/iccol/desarrollo/fuentes/PESVNOpv.CBL
/d/iccol/desarrollo/fuentes/pesvnormb.cbl
/d/iccol/desarrollo/fuentes/PESVNORMB.CBL
/d/iccol/desarrollo/fuentes/PESVNORMB.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNORMBNW-EHA.CBL
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-20100813/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-20100813
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bckupM
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bk-20100812
/d/iccol/desarrollo/fuentes/PESVNOSEGE2.CBL
/d/iccol/desarrollo/fuentes/pesvnotest.cbl
/d/iccol/desarrollo/fuentes/PESVNOTEST.CBL
/d/iccol/desarrollo/fuentes/PESVNOv09.CBL
/d/iccol/desarrollo/fuentes/PESVNOv10.CBL
/d/iccol/desarrollo/fuentes/xxxxxxxxxxx.cblBDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 ENgrep 513-VALIDA-EN-CSV
/d/iccol/desarrollo/fuentes/icestd12.cbl
/d/iccol/desarrollo/fuentes/icestd12v09.cbl
/d/iccol/desarrollo/fuentes/P_PESVNO.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/P_PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PES.CBL
/d/iccol/desarrollo/fuentes/PESVNO-AVV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-CV.CBL
/d/iccol/desarrollo/fuentes/PESVNO-DIGITO.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNO-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL
/d/iccol/desarrollo/fuentes/PESVNO.CBL-20101014
/d/iccol/desarrollo/fuentes/PESVNO.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNO0504.CBL
/d/iccol/desarrollo/fuentes/PESVNO64.CBL
/d/iccol/desarrollo/fuentes/PESVNOCITI.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV_cg.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV-V05.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSV.CBL-ORI
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_CAL.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS_p.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVBCSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVFNG.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUS.CBL-lag
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSc.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVPLUSv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V02.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V03.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE-V04.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGE.CBL-V01
/d/iccol/desarrollo/fuentes/PESVNOCSVSEGElag.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVTMX.CBL
/d/iccol/desarrollo/fuentes/PESVNOCSVv06.CBL
/d/iccol/desarrollo/fuentes/PESVNOGJ.CBL
/d/iccol/desarrollo/fuentes/PESVNONW1.CBL
/d/iccol/desarrollo/fuentes/PESVNOPEO.CBL
/d/iccol/desarrollo/fuentes/PESVNOpv.CBL
/d/iccol/desarrollo/fuentes/pesvnormb.cbl
/d/iccol/desarrollo/fuentes/PESVNORMB.CBL
/d/iccol/desarrollo/fuentes/PESVNORMB.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNORMBNW-EHA.CBL
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-20100813
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bckup/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bckup
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bckupM
/d/iccol/desarrollo/fuentes/PESVNORMBNW.CBL-bk-20100812
/d/iccol/desarrollo/fuentes/PESVNOSEGE2.CBL
/d/iccol/desarrollo/fuentes/pesvnotest.cbl
/d/iccol/desarrollo/fuentes/PESVNOTEST.CBL
/d/iccol/desarrollo/fuentes/PESVNOv09.CBL
/d/iccol/desarrollo/fuentes/PESVNOv10.CBL
/d/iccol/desarrollo/fuentes/xxxxxxxxxxx.cblBDAGCLA.PROC.0005
BDAGCLA.PROC.20030529
BDAGCLA.PROC.ORI
BDAMATCH.PROC
BDAMATCHNEW.PROC
BDAMATCHRMB.PROC
BDIIALEDB2.PROC
BDIIVIDE_PRO.PROC
REMARK*BDIIVIDE.PROC.v.03.0006
REMARK******************************************************************
REMARK*RUTINA DE VALIDACION DE IDENTIFICACIONES
REMARK******************************************************************
* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE
* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS
** NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID
** INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID
* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.
REMARK******************************************************************
* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON
* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO
* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2
REMARK******************************************************************
* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL
* AGO.11/2004 * DIGITO DE CHEQUEO.
* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO
** CORRESPONDE AL RANGO.
REMARK******************************************************************
* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:
* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)
* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:
** ENTRE 900.000.000 Y 999.999.999 (MUISCA)
REMARK******************************************************************
* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN
* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS
* FAC006C     *

sdiff -w 170 BDIIVIDE.PROC BDIIVIDE_PRO.PROC > qqqq

sdiff -w 170 BDAMATCH.PROC BDAMATCHRMB.PROCBDACSV.FS:
* BDACSV-FS.V.0001
* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DASSELECT BDACSV
ASSIGN TO DISK "$DATABASE/BDACSV"ORGANIZATION IS INDEXEDACCESS MODE IS DYNAMICRECORD KEY IS LLAVE-BDACSVLOCK MODE IS MANUAL WITH LOCK ON RECORD.



BDACSV.FD:
* BDACSV-FD.v.0003
* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
* DATOS OFICIALES DE REGIS, DIAN Y DAS
******************************************************************
* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
* R.MARTINEZ *POR T7
******************************************************************
* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
* OCT-12-2012*DE REGISTRADURIA INCOMPLETA DE FUENTE
* LUIS GOMEZ *CONFIABLE
******************************************************************
FD  BDACSV.
01  REG-BDACSV.
03 LLAVE-BDACSV.
05  TIPO-ID-BDACSV    PIC 9(01).05  NUM-ID-BDACSV     PIC 9(15).05  COD-SUS-BDACSV    PIC 9(06).05  COD-CTA-BDACSV    PIC 9(02).05  NUM-CTA-BDACSV    PIC X(25).03  NOMBRE-BDACSVPIC X(45).
INCLUS     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.STT0003
INCLUS05 APELLIDO1-BDACSVPIC X(16).STT0003
INCLUS05 APELLIDO2-BDACSVPIC X(16).STT0003
INCLUS05 DES-NOMBRE1-BDACSV    PIC X(12).STT0003
INCLUS     05  IND-UNIFICADO-BDACSV    PIC 9(01).STT000303  FECHA-CREA-BDACSVPIC 9(08).03  NUM-PORTAF-BDACSV    PIC 9(02).03  IND-NOMBRE-BDACSV    PIC 9(02)."BDIIVIDE_PRO.PROC" [Not edited] [Modified] line 1 of 478 --0%-- :q!icjlud@codes /d/iccol/desarrollo/copys
$ vi

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~PES.CBL:








:r PES.CBL"PES.CBL" No such file or directory:q!icjlud@codes /d/iccol/desarrollo/copys
$ cd ^?^?^?         fu
icjlud@codes /d/iccol/desarrollo/fuentes
$ vi qqq
"qqq" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"qqq" [New file]PES.CBL::r PES.CBL"PES.CBL" 956 lines, 45526 characters PES.CBL:
* PESVNOCSV.V.01.0009.
IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.
******************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.
*
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
*
* Cliente : Datacredito
*
* Version : 09/06/2008 09:08:25 a.m.
******************************************************************
*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final
*
******************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*
REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**
REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **
REMARK******************************************************************
******************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|*
******************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|*
******************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|*
******************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|*
******************************************************************
* PJV0009    | CQ6685 - SE HACE AJUSTE EN VALIDACION POR RANGOS  *
* JUL.09-2012|    CUANDO ES TIPO IDE 2 O 3.*
* GER.DESARR.|*
******************************************************************
*"qqq" [Modified] line 2 of 957 --0%-- /513-valida-en-csvPattern not found/513-VALIDA-EN-CA^?
 [1] + Stopped (SIGTSTP)        vi qqq
icjlud@codes /d/iccol/desarrollo/fuentes
$ ^Z^[  $ vi qqq$       $ fg
vi qqq
PES.CBL:
* PESVNOCSV.V.01.0009.
IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.
******************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.
*
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
*
* Cliente : Datacredito
*
* Version : 09/06/2008 09:08:25 a.m.
******************************************************************
*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final
*
******************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*
REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**
REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **
REMARK******************************************************************
******************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|*
******************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|*
******************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|*
******************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|*
******************************************************************
* PJV0009    | CQ6685 - SE HACE AJUSTE EN VALIDACION POR RANGOS  *
* JUL.09-2012|    CUANDO ES TIPO IDE 2 O 3.*
* GER.DESARR.|*
******************************************************************
*/513-MOVE 1  TO SW-ERRORPERFORM 512-CREE-REGISTROWRITE REG-INCONSADD  1  TO TIPO-ID-INVALIDOELSE
MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDEMOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
NUM-ID-WMOVE  NOMBRE-E  TO  NOMBRE-BDIIVIDEMOVE    1TO  SW-VERIFNOM-BDIIVIDE
CQ6685IF TIPOID-E = 2 OR 3PJV0009
CQ6685MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEPJV0009
CQ6685END-IFPJV0009MOVE  W-BLOQUES TO  NUM-BLOQUES-BDIIVIDEPERFORM 80100-VALIDAR-IDENTIFICACIONMOVE  TIP-IDE-BDIIVIDE TO TIPOID-EMOVE  NUM-IDE-BDIIVIDE TO NUMID-EINITIALIZE REG-VALIDAS REG-INCONS
REQ596MOVE FILLER-2-E TO FILLER-2-VALLAG0007
REQ596MOVE FILLER-2-E TO FILLER-2-INCLAG0007MOVE ";" TO FILLER1 FILLER2 FILLER3 FILLER4 FILLER5FILLER6 FILLER7 FILLER8 FILLER9IF SW-ID-BDIIVIDE = 1
IF TIPOID-E <> 1
CSVCEXMOVE  ZEROSTO  HACER-MATCHGJC0003
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006
CSVCEXPERFORM  513-VALIDA-EN-CSVGJC0003
CSVCEXIF  IDE-TIPO-BDAMATCH  =  0GJC0003
CSVCEXMOVE 03TO  CODIGO-ERROR CODERR-INCGJC0003
CSVCEXMOVE  1TO SW-ERRORGJC0003
CSVCEXPERFORM 512-CREE-REGISTROGJC0003
CSVCEXWRITE REG-INCONSGJC0003
CSVCEXADD   1TO  NO-EXISTE-DIANGJC0003
CSVCEXEND-IFGJC0003ELSE
MOVE  ZEROS TO  HACER-MATCH
MODCEDMOVE 0 TO IDE-TIPO-BDAMATCHEHA0006PERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0
MOVE 04 TO CODIGO-ERROR CODERR-INCMOVE TIPOID-E TO TIP-INC
ADD  1  TO NO-EXISTE-REGISMOVE 1  TO SW-ERROR
PERFORM 510-ESCRIBIR-INCONSEND-IF
END-IF
ELSE
IF SW-NOMBRES-BDIIVIDE = 1IF TIPOID-E <> 1
MOVE 01 TO CODIGO-ERROR CODERR-INCMOVE  1 TO SW-ERROR
PERFORM 512-CREE-REGISTROWRITE REG-INCONS
ADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4//IF CODIGO-ERROR = 02 AND SW-ERROR = 1MOVE TIPOID-E TO TIP-INC.IF SW-ERROR = 1
PERFORM 512-CREE-REGISTROWRITE REG-INCONS.**************************************************************
*512-CREE-REGISTRO.
* ARMA EL REGISTRO DE INCONSISTENCIAS DEL ARCHIVO DCINC
**************************************************************
512-CREE-REGISTRO.MOVE TIPOID-E TO TIP-INCMOVE NUMID-E  TO CED-INCFAC0019MOVE NOMBRE-E TO NOM1-INCIF CODIGO-ERROR = 02 OR 01 OR 06 OR 07MOVE NOM-VAL-BDIIVIDE TO NOM2-INCELSE
MOVE SPACESTO NOM2-INC
MUN-EXP-INC
DEP-EXP-INC
VIG-INCMOVE ZEROSTO FEC-EXP-INCMOVE FILLER-2-E  TO FILLER-2-INCEND-IF.**************************************************************
*513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA
**************************************************************
513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008***************************************************************513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA
**************************************************************
513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008
REQ609MOVE 0 TO IDE-TIPO-BDAMATCHLAG0008
REQ609END-IFLAG0008
REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VALWRITE REG-VALIDAS
ADD 1 TO REG-CORRECTOS  SI-EXISTE-CSVEND-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
*9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
********************************************************************800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
*******************************************************************
800-GRABAR-SECUENCIAL.INITIALIZE REG-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE ZEROSTO TIP-ID-SECMOVE W-TARIFATO NUM-TERM-SECMOVE 2TO COBRA-SECMOVE 1TO PRIV-SECMOVE " "TO SBPRIV-SECMOVE 2TO PRODU-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZEROSTO TABLA-SCOR-SECACCEPT TIEMPO-WFROM TIMEMOVE TIEMPO-W(1:6)     TO HORA-SECIF W-CONT-TIPO-5>  ZEROSADD 1 TO LLAVE7
MOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE 5  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEY***************************************************************513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA
**************************************************************
513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008
REQ609MOVE 0 TO IDE-TIPO-BDAMATCHLAG0008
REQ609END-IFLAG0008
REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGOMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VALWRITE REG-VALIDAS
ADD 1 TO REG-CORRECTOS  SI-EXISTE-CSVEND-IF
END-IF.9800-FILTRAR-ALFABETICO.
******************************************************************
*9800-FILTRAR-ALFABETICO.*
*    SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA*
******************************************************************MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRAINITIALIZE CADENA-SALEMOVE 1 TO J
PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICOIF SI-ALFABETICO
MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)ADD 1 TO J
END-IF
END-PERFORM.
********************************************************************800-GRABAR-SECUENCIAL.
* SE ARMA Y GRABA REGISTRO EN EL ARCHIVO ICBTCO, INDICANDO EN EL
* NUMERO DE TERMINAL, LA TARIFA UTILIZADA Y EN EL NUMERO DE IDEN-
* TIFICACION LA CANTIDAD DE VALIDACIONES REALIZADAS. SE GRABA UN
* REGISTRO POR CADA TIPO DE RESULTADO DE LA VALIDACION
*******************************************************************
800-GRABAR-SECUENCIAL.INITIALIZE REG-SECMOVE SUSCRIPTOR-AUX    TO COD-SUSCRIP-SECMOVE FECHA-AUX-RTO FEC-CONSUL-SECMOVE ZEROSTO TIP-ID-SECMOVE W-TARIFATO NUM-TERM-SECMOVE 2TO COBRA-SECMOVE 1TO PRIV-SECMOVE " "TO SBPRIV-SECMOVE 2TO PRODU-SECMOVE COD-CLAVE-ABD09   TO COD-CLAVE-SECMOVE CLAVE-AUT-ABD09   TO CLAVE-AUT-SECMOVE CIUDAD-CONS-ABD09 TO CIUDAD-CONS-SECMOVE REGIONAL-ABD14    TO REGIONAL-COMIS-SECMOVE ZONA-FAC-ABD09    TO ZONA-FAC-SECMOVE ZEROSTO TABLA-SCOR-SECACCEPT TIEMPO-WFROM TIMEMOVE TIEMPO-W(1:6)     TO HORA-SECIF W-CONT-TIPO-5>  ZEROSADD 1 TO LLAVE7
MOVE LLAVE7 TO LLAVE-SECMOVE W-CONT-TIPO-5  TO NUM-ID-SECMOVE 5  TO TIP-CON-SEC
XXXXXX*WRITE REG-SEC INVALID KEY***************************************************************513-VALIDA-EN-CSV.
*    VALIDA SI LA IDENTIFICACION ESTA EL LA BASE DE DATOS
*    ALTERNA
**************************************************************
513-VALIDA-EN-CSV.
REQ550*    hace validacion de tipo de identificacion
REQ550     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
REQ550     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
REQ550     PERFORM 80400-VALIDAR-TIPO-ID
REQ550     IF SW-TID-BDIIVIDE = 0IF HACER-MATCH = ZEROSIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOROPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECKPERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRS
REQ609IF IDE-TIPO-BDAMATCH = 1LAG0008
REQ609IF TIPOID-E = 1 OR 4LAG0008
REQ609INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALLLAG0008
REQ609"," BY " ", ";" BY " "LAG0008
REQ609END-IFLAG0008
REQ609MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMLAG0008
REQ609MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMLAG0008
REQ609MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMLAG0008
REQ609MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM     LAG0008
REQ609PERFORM 10000-MATCH-NOMBRES-VALNOMLAG0008
REQ609IF MATCH-OK-OUT-VALNOM = 1LAG0008
REQ609MOVE 1 TO IDE-TIPO-BDAMATCHLAG0008
REQ609ELSELAG0008
REQ609MOVE 0 TO IDE-TIPO-BDAMATCHLAG0008
REQ609END-IFLAG0008
REQ609END-IFLAG0008IF IDE-TIPO-BDAMATCH = 1MOVE TIPOID-E TO TIP-VALMOVE NUMID-E  TO CED-VALMOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE ZEROS    TO FEC-EXP-VALMOVE SPACES   TO MUN-EXP-VALMOVE SPACES   TO DEP-EXP-VALMOVE SPACES   TO VIG-VALMOVE SPACES   TO GENERO-VALMOVE SPACES   TO EDAD-VALMOVE SPACES   TO EDAD-RANGO
PAM460*MOVE "A"TO ORIGEN-VAL

WRITE REG-VALIDAS


ADD 1 TO REG-CORRECTOS  SI-EXISTE-CSV



END-IF




END-IF./1000-U-RECORRER-CSV-BDAMATCH/Search wrapped around BOTTOM of buffer?Search wrapped around TOP of buffer
:set nows
"qqq" [Modified] line 813 of 957 --84%-- PES.CBL:
* PESVNOCSV.V.01.0009.
IDENTIFICATION DIVISION.
PROGRAM-ID. PESVNO.
AUTHOR. DATACREDITO.
DATE-WRITTEN. MAYO/2001.
DATE-COMPILED.
******************************************************************
* PROGRAMA PARA VALIDACION DE CEDULAS, NITS Y CEDULAS DE*
* EXTRANJERIA.
*
* Programa: PESVNOCSV.CBL   BASE ==> $DATABASE/BDACSV
*
* Cliente : Datacredito
*
* Version : 09/06/2008 09:08:25 a.m.
******************************************************************
*  Validacion especial tomando el archivo de
*  Cuentas Sin Validar para poder reportalos en el informe final
*
******************************************************************
REMARK* LAG0002* PAM372 - SEPARADORES ";" EN INCONSISTENCIAS
REMARK* L.GOMEZ* PARA IGUALARLO AL PESVNO
REMARK* SEPT. 30/2009*
REMARK*******************************************************************
REMARK* GJC0003* CSVCEX - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2009/12/21   * VALIDAR CON CEDULA DE EXTRANJERIA.*
REMARK* GRACIELA JIM.**
REMARK******************************************************************
REMARK* LAG0004* REQ550 - AJUSTE A LA VALIDACION PARA CUENTAS SIN*
REMARK* 2010/03/12   * VALIDAR INCLUYENDO VALIDACION DE RANGOS.*
REMARK* G.DESARROLLO **
REMARK******************************************************************
******************************************************************
* GDT0005    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
* FEB.09-2010|    FORMATO TIPO 8.*
* GER.DESARR.|*
******************************************************************
* EHA0006    | MODCED - MODIFICACION PARA EVITAR ERRORES EN LA   *
* MAY.05-2010|    ESCRITURA DE REGISTROS*
* GER.DESARR.|*
******************************************************************
* LAG0007    | REQ596 - CORRECCION PARA MANEJO DE RELLENO EN     *
* OCT.07-2010|    EN TIPOS ID DIFERENTE A 1*
* GER.DESARR.|*
******************************************************************
* LAG0008    | REQ609 - CORRECCION PARA VALIDACION DE NOMBRE     *
* OCT.14-2010|    CUANDO TRAE DE BASE ALTERNA*
* GER.DESARR.|*
******************************************************************
* PJV0009    | CQ6685 - SE HACE AJUSTE EN VALIDACION POR RANGOS  *
* JUL.09-2012|    CUANDO ES TIPO IDE 2 O 3.*
* GER.DESARR.|*
******************************************************************
*
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
956 fewer lines:q!icjlud@codes /d/iccol/desarrollo/fuentes
$ l qqq
qqq: No such file or directory
icjlud@codes /d/iccol/desarrollo/fuentes
$ co
icjlud@codes /d/iccol/desarrollo/copys
$ grep -il "select *maestro-direcc" *.proc^?^?^?          PROC 
icjlud@codes /d/iccol/desarrollo/copys
$ 
icjlud@codes /d/iccol/desarrollo/copys
$ 
icjlud@codes /d/iccol/desarrollo/copys
$ 