=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.10 09:50:22 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Tue Jun 10 07:15:40 2014 from 172.16.10.59
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 140 lines, 6074 characters ls -l ACTAREV.CBL
ls -l ACTAVAL.CBL
ls -l ACTBIGID.CBL
ls -l ACTCAMPLEY.CBL
ls -l ACTESTLEY.CBL
ls -l ACTEUNI.CBL
ls -l ACTEUNILG.CBL
ls -l ACTEUNINW.CBL
ls -l ACTMDIDE.CBL
ls -l ACTMFRE.CBL
ls -l ACTMIGRAC.CBL
ls -l ACTVLCR.CBL
ls -l ACTVLCT.CBL
ls -l ACTVLESP.CBL
ls -l BDACSVEXTRAE.CBL
ls -l BDIEREEST.CBL
ls -l BDIPROBINC.CBL
ls -l BDLPLANOS.CBL
ls -l BDLSTR.CBL
ls -l CALIDBDSS.CBL
ls -l caract-icjvlr.CBL
ls -l CARACTBC.CBL
ls -l CARACTBD.CBL
ls -l CARACTBDL.CBL
ls -l CARACTBDLNEW.CBL
ls -l CARACTCOL.CBL
ls -l CARACTDIR.CBL
ls -l CARACTNEW.CBL
ls -l CARACTNEWRMB.CBL
ls -l CARACTPER.CBL
ls -l CARACTUSA.CBL
ls -l CARGAJUR.CBL
ls -l CARPER-ND.CBL
ls -l CASOSMER.CBL
ls -l CERTCARDEC.CBL
ls -l CITSELPS.CBL
ls -l CITSELPSv02.CBL
ls -l COLASCOHQ.CBL
ls -l CTL003.CBL
ls -l CTL103.CBL
ls -l CTL113.CBL
ls -l CTLACT09.CBL
ls -l CTLACT12.CBL
ls -l CTLACT13.CBL
ls -l CTLACT14.CBL
ls -l CTLACT16.CBL
ls -l CTLACT24.CBL
ls -l CTLACT34.CBL
ls -l CTLACT40.CBL"qqq" 140 lines, 6074 characters:%s/ls -l/wc70 substitutions wc CTLACT24.CBL
wc CTLACT34.CBL
wc CTLACT40.CBL
wc CTLACT41.CBL
wc CTLACT45.CBL
wc CTLACT49.CBL
wc CTLACT55.CBL
wc CTLCOPYBNK.CBL
wc CTLCOPYCRE.CBL
wc CTLCOPYMES.CBL
wc CTLIDXTDC.CBL
wc CTLN97.CBL
wc CTLPRSCCN.CBL
wc CTLUTL01.CBL
wc CTLUTL02.CBL
wc CTLUTL18.CBL
wc CTLUTL19.CBL
wc CTLUTL21.CBL
wc CTLUTL24.CBL
wc CTLUTL25.CBL
wc CTLUTL66.CBL
wc DD3VHF.CBL
wc DEBS18.CBL
wc DTCABD.CBL
-rw-rw-r--   1 icjdld   icdatacr  106038 Mar 11  2010 ACTAREV.CBL
-rw-rw-r--   1 iccavd   icdatacr  583589 Jul  6  2011 ACTAVAL.CBL
-rw-rw-r--   1 icjjmd   icdatacr   41027 Apr 28 17:33 ACTBIGID.CBL
-rw-rw-r--   1 icgjcd   icdatacr   78194 Jul 18  2010 ACTCAMPLEY.CBL
-rw-rw-r--   1 icgjcd   icdatacr   88645 Dec 28  2010 ACTESTLEY.CBL
-rw-rw-r--   1 iccavd   icdatacr  352126 Oct 15  2013 ACTEUNI.CBL
-rw-rw-r--   1 icjdld   icdatacr  152396 Mar 11  2010 ACTEUNILG.CBL
-rw-rw-r--   1 icjdld   icdatacr  189857 Mar 11  2010 ACTEUNINW.CBL
-rw-rw-r--   1 icjdld   icdatacr   79743 Mar 11  2010 ACTMDIDE.CBL
-rw-rw-r--   1 iccavd   icdatacr  185586 Sep 19  2012 ACTMFRE.CBL
-rw-rw-r--   1 iccavd   icdatacr  205945 May  9  2013 ACTMIGRAC.CBL
-rw-rw-r--   1 iccavd   icdatacr  836410 Jun 27  2013 ACTVLCR.CBL
-rw-rw-r--   1 iccavd   icdatacr  456770 Jun 27  2013 ACTVLCT.CBL
-rw-rw-r--   1 icjdld   icdatacr  170941 Mar 11  2010 ACTVLESP.CBL
-rw-rw-r--   1 icgjcd   icdatacr   15847 Apr 11  2012 BDACSVEXTRAE.CBL
-rw-rw-r--   1 icjdld   icdatacr   33231 Mar 11  2010 BDIEREEST.CBL
-rw-rw-r--   1 icjdld   icdatacr   48410 Mar 11  2010 BDIPROBINC.CBL
-rw-rw-r--   1 iclagd   icdatacr   34970 Jun 28  2012 BDLPLANOS.CBL
-rw-rw-r--   1 1395     icdatacr   31381 Nov 17  2010 BDLSTR.CBL
-rw-rw-r--   1 227icdatacr  121235 Jun  4  2010 CALIDBDSS.CBL
-rw-rw-r--   1 icjdld   icdatacr   37388 Mar 11  2010 caract-icjvlr.CBL
-rw-rw-r--   1 icjdld   icdatacr   13494 Jul 30  2010 CARACTBC.CBL
-rw-rw-r--   1 icjdld   icdatacr   48848 Mar 11  2010 CARACTBD.CBL
-rw-rw-r--   1 icrmbd   icdatacr   56396 Jan 28 14:44 CARACTBDL.CBL
-rw-rw-r--   1 icrmbd   icdatacr   54039 Nov 21  2013 CARACTBDLNEW.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
70 lines deletedwc ACTAREV.CBL
wc ACTAVAL.CBL
wc ACTBIGID.CBL
wc ACTCAMPLEY.CBL
wc ACTESTLEY.CBL
wc ACTEUNI.CBL
wc ACTEUNILG.CBL
wc ACTEUNINW.CBL
wc ACTMDIDE.CBL
wc ACTMFRE.CBL
wc ACTMIGRAC.CBL
wc ACTVLCR.CBL
wc ACTVLCT.CBL
wc ACTVLESP.CBL
wc BDACSVEXTRAE.CBL
wc BDIEREEST.CBL
wc BDIPROBINC.CBL
wc BDLPLANOS.CBL
wc BDLSTR.CBL
wc CALIDBDSS.CBL
wc caract-icjvlr.CBL
wc CARACTBC.CBL
wc CARACTBD.CBL
wc CARACTBDL.CBL
wc CARACTBDLNEW.CBL
wc CARACTCOL.CBL
wc CARACTDIR.CBL
wc CARACTNEW.CBL
wc CARACTNEWRMB.CBL
wc CARACTPER.CBL
wc CARACTUSA.CBL
wc CARGAJUR.CBL
wc CARPER-ND.CBL
wc CASOSMER.CBL
wc CERTCARDEC.CBL
wc CITSELPS.CBL
wc CITSELPSv02.CBL
wc COLASCOHQ.CBL
wc CTL003.CBL
wc CTL103.CBL
wc CTL113.CBL
wc CTLACT09.CBL
wc CTLACT12.CBL
wc CTLACT13.CBL
wc CTLACT14.CBL
wc CTLACT16.CBL
wc CTLACT24.CBL
wc CTLACT34.CBL
wc CTLACT40.CBL"qqq" 70 lines, 1147 characters /d/iccol/desarrollo/fuentes>vi qqq
"qqq" 70 lines, 1147 characters wc ACTAREV.CBL
wc ACTAVAL.CBL
wc ACTBIGID.CBL
wc ACTCAMPLEY.CBL
wc ACTESTLEY.CBL
wc ACTEUNI.CBL
wc ACTEUNILG.CBL
wc ACTEUNINW.CBL
wc ACTMDIDE.CBL
wc ACTMFRE.CBL
wc ACTMIGRAC.CBL
wc ACTVLCR.CBL
wc ACTVLCT.CBL
wc ACTVLESP.CBL
wc BDACSVEXTRAE.CBL
wc BDIEREEST.CBL
wc BDIPROBINC.CBL
wc BDLPLANOS.CBL
wc BDLSTR.CBL
wc CALIDBDSS.CBL
wc caract-icjvlr.CBL
wc CARACTBC.CBL
wc CARACTBD.CBL
wc CARACTBDL.CBL
wc CARACTBDLNEW.CBL
wc CARACTCOL.CBL
wc CARACTDIR.CBL
wc CARACTNEW.CBL
wc CARACTNEWRMB.CBL
wc CARACTPER.CBL
wc CARACTUSA.CBL
wc CARGAJUR.CBL
wc CARPER-ND.CBL
wc CASOSMER.CBL
wc CERTCARDEC.CBL
wc CITSELPS.CBL
wc CITSELPSv02.CBL
wc COLASCOHQ.CBL
wc CTL003.CBL
wc CTL103.CBL
wc CTL113.CBL
wc CTLACT09.CBL
wc CTLACT12.CBL
wc CTLACT13.CBL
wc CTLACT14.CBL
wc CTLACT16.CBL
wc CTLACT24.CBL
wc CTLACT34.CBL
wc CTLACT40.CBL"qqq" 70 lines, 1147 charactersOPEN MODE
OPEN MODE

OPEN MODE



!sh qqq    1697    8223  106038 ACTAREV.CBL9039   44327  583589 ACTAVAL.CBL764    2947   41027 ACTBIGID.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1973    6707   88645 ACTESTLEY.CBL
    4982   23794  352126 ACTEUNI.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2979   14061  189857 ACTEUNINW.CBL
    1706    5381   79743 ACTMDIDE.CBL
    2930   13638  185586 ACTMFRE.CBL
    2779   14151  205945 ACTMIGRAC.CBL
   12194   62286  836410 ACTVLCR.CBL
    7095   26771  456770 ACTVLCT.CBL
    2950   11358  170941 ACTVLESP.CBL277     830   15847 BDACSVEXTRAE.CBL724    2514   33231 BDIEREEST.CBL
    1027    4025   48410 BDIPROBINC.CBL641    2268   34970 BDLPLANOS.CBL636    2124   31381 BDLSTR.CBL
    2711   10259  121235 CALIDBDSS.CBL852    2969   37388 caract-icjvlr.CBL310    1145   13494 CARACTBC.CBL
    1067    4000   48848 CARACTBD.CBL
    1183    3976   56396 CARACTBDL.CBL
    1124    3862   54039 CARACTBDLNEW.CBL304     998   13124 CARACTCOL.CBL619    2285   33028 CARACTDIR.CBL
    1841    7540  110927 CARACTNEW.CBL
    1723    7016  102312 CARACTNEWRMB.CBL306    1004   13181 CARACTPER.CBL
    1490    6455   94996 CARACTUSA.CBL
    1396    5623   59160 CARGAJUR.CBL306    1004   13181 CARPER-ND.CBL
    2466   10466  126977 CASOSMER.CBL
    2727   10276  153150 CERTCARDEC.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL622    2095   26428 COLASCOHQ.CBL990    3867   48956 CTL003.CBL295    1017   16487 CTL103.CBL282     965   13039 CTL113.CBL819    3472   53184 CTLACT09.CBL773    3137   43770 CTLACT12.CBL608    2532   35019 CTLACT13.CBL559    2046   28395 CTLACT14.CBL508    1619   30592 CTLACT16.CBL541    1778   24912 CTLACT24.CBL479    1547   21197 CTLACT34.CBL
    1389    4545   61978 CTLACT40.CBL
69 more lines     541    1778   24912 CTLACT24.CBL479    1547   21197 CTLACT34.CBL
    1389    4545   61978 CTLACT40.CBL809    3173   42810 CTLACT41.CBL
    2276   10400  152185 CTLACT45.CBL
    2053    6764  140475 CTLACT49.CBL
    1413    6135   92259 CTLACT55.CBL413    1449   20397 CTLCOPYBNK.CBL507    2029   26493 CTLCOPYCRE.CBL402    1427   19605 CTLCOPYMES.CBL170     530    8018 CTLIDXTDC.CBL
    1884    8959  132326 CTLN97.CBL539    1827   33892 CTLPRSCCN.CBL453    1791   21952 CTLUTL01.CBL536    1754   24694 CTLUTL02.CBL631    2495   30641 CTLUTL18.CBL332    1107   16271 CTLUTL19.CBL319     922   13871 CTLUTL21.CBL446    1765   21531 CTLUTL24.CBL297    1003   14539 CTLUTL25.CBL620    2439   29933 CTLUTL66.CBL
    6842   27485  492817 DD3VHF.CBL
    2804   11536  157200 DEBS18.CBL
    1814    6877   93361 DTCABD.CBL


wc ACTAREV.CBL
wc ACTAVAL.CBL
wc ACTBIGID.CBL
wc ACTCAMPLEY.CBL
wc ACTESTLEY.CBL
wc ACTEUNI.CBL
wc ACTEUNILG.CBL
wc ACTEUNINW.CBL
wc ACTMDIDE.CBL
wc ACTMFRE.CBL
wc ACTMIGRAC.CBL
wc ACTVLCR.CBL
wc ACTVLCT.CBL
wc ACTVLESP.CBL
wc BDACSVEXTRAE.CBL
wc BDIEREEST.CBL
wc BDIPROBINC.CBL
wc BDLPLANOS.CBL
wc BDLSTR.CBL
wc CALIDBDSS.CBL
wc caract-icjvlr.CBL
wc CARACTBC.CBL
wc CARACTBD.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
72 lines deleted    1697    8223  106038 ACTAREV.CBL9039   44327  583589 ACTAVAL.CBL764    2947   41027 ACTBIGID.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1973    6707   88645 ACTESTLEY.CBL
    4982   23794  352126 ACTEUNI.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2979   14061  189857 ACTEUNINW.CBL
    1706    5381   79743 ACTMDIDE.CBL
    2930   13638  185586 ACTMFRE.CBL
    2779   14151  205945 ACTMIGRAC.CBL
   12194   62286  836410 ACTVLCR.CBL
    7095   26771  456770 ACTVLCT.CBL
    2950   11358  170941 ACTVLESP.CBL277     830   15847 BDACSVEXTRAE.CBL724    2514   33231 BDIEREEST.CBL
    1027    4025   48410 BDIPROBINC.CBL641    2268   34970 BDLPLANOS.CBL636    2124   31381 BDLSTR.CBL
    2711   10259  121235 CALIDBDSS.CBL852    2969   37388 caract-icjvlr.CBL310    1145   13494 CARACTBC.CBL
    1067    4000   48848 CARACTBD.CBL
    1183    3976   56396 CARACTBDL.CBL
    1124    3862   54039 CARACTBDLNEW.CBL304     998   13124 CARACTCOL.CBL619    2285   33028 CARACTDIR.CBL
    1841    7540  110927 CARACTNEW.CBL
    1723    7016  102312 CARACTNEWRMB.CBL306    1004   13181 CARACTPER.CBL
    1490    6455   94996 CARACTUSA.CBL
    1396    5623   59160 CARGAJUR.CBL306    1004   13181 CARPER-ND.CBL
    2466   10466  126977 CASOSMER.CBL
    2727   10276  153150 CERTCARDEC.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL622    2095   26428 COLASCOHQ.CBL990    3867   48956 CTL003.CBL295    1017   16487 CTL103.CBL282     965   13039 CTL113.CBL819    3472   53184 CTLACT09.CBL773    3137   43770 CTLACT12.CBL608    2532   35019 CTLACT13.CBL559    2046   28395 CTLACT14.CBL508    1619   30592 CTLACT16.CBL541    1778   24912 CTLACT24.CBL479    1547   21197 CTLACT34.CBL
    1389    4545   61978 CTLACT40.CBL!sort 170     530    8018 CTLIDXTDC.CBL 277     830   15847 BDACSVEXTRAE.CBL282     965   13039 CTL113.CBL
     295    1017   16487 CTL103.CBL
     297    1003   14539 CTLUTL25.CBL
     304     998   13124 CARACTCOL.CBL
     306    1004   13181 CARACTPER
     306    1004   13181 CARPER-ND
     310    1145   13494 CARACTBC
     319     922   13871 CTLUTL21.CBL
     332    1107   16271 CTLUTL19.CBL
     402    1427   19605 CTLCOPYMES.CBL
     413    1449   20397 CTLCOPYBNK.CBL
     446    1765   21531 CTLUTL24453    1791   21952 CTLUTL01.CBL479    1547   21197 CTLACT34.CBL
     507    2029   26493 CTLCOPYCRE508    1619   30592 CTLACT16.CBL51754   24694 CTLUTL02.CBL
     539    1827   33892 CTLPRSCCN541    1778   24912 CTLACT24.CBL559    2046   28395 CTLACT14
     608    2532   35019 CTLACT13
     619    2285   33028DIR
     620    2439   29933 CTLUTL66.CBL622    2095   26428 COLASCOHQ
31    2495   30641 CTLUTL18.CBL
     636    2124   31381 BDLSTR.CBL
     641    2268   34970 BDLPLANOS.CBL724    2514   33231 BDIEREEST
     764    2947   41027 ACTBIGID.CBL
     773    3137   43770 CTLACT12809    3173   42810 CTLACT41.CBL
     819    3472   53184 CTLACT09
     852    2969   37388 caract-icjvlr.CBL
     990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    11242   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR
    1413    6135   9225955
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE
    1723    7016  102312 CARACTNEWRMB.CBL814    6877   93361 DTCABD.CBL     170     530    8018 CTLIDXTDC.CBL277     830   15847 BDACSVEXTRAE.CBL282     965   13039 CTL113.CBL295    1017   16487 CTL103.CBL297    1003   14539 CTLUTL25.CBL304     998   13124 CARACTCOL.CBL306    1004   13181 CARACTPER.CBL306    1004   13181 CARPER-ND.CBL310    1145   13494 CARACTBC.CBL319     922   13871 CTLUTL21.CBL332    1107   16271 CTLUTL19.CBL402    1427   19605 CTLCOPYMES.CBL413    1449   20397 CTLCOPYBNK.CBL446    1765   21531 CTLUTL24.CBL453    1791   21952 CTLUTL01.CBL479    1547   21197 CTLACT34.CBL507    2029   26493 CTLCOPYCRE.CBL508    1619   30592 CTLACT16.CBL536    1754   24694 CTLUTL02.CBL539    1827   33892 CTLPRSCCN.CBL541    1778   24912 CTLACT24.CBL559    2046   28395 CTLACT14.CBL608    2532   35019 CTLACT13.CBL619    2285   33028 CARACTDIR.CBL620    2439   29933 CTLUTL66.CBL622    2095   26428 COLASCOHQ.CBL631    2495   30641 CTLUTL18.CBL636    2124   31381 BDLSTR.CBL641    2268   34970 BDLPLANOS.CBL724    2514   33231 BDIEREEST.CBL764    2947   41027 ACTBIGID.CBL773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBLLAPPEND MODE      2010LAPPEND MODE   2012LAPPEND MODE         2010L         2010L           2010LAPPEND MODE      2011L      2011L      2011



LAPPEND MODE       2010L       2010L       2010LAPPEND MODE     2011LAPPEND MODE     2013LAPPEND MODE       2010L       2010L       2010LAPPEND MODE     2012LAPPEND MODE       2013LAPPEND MODE       2010L      2010
L       2010
LAPPEND MODE       2012
LAPPEND MODE       2010
L      2010
L       2010
LAPPEND MODE      2014
LAPPEND MODE       2010
L     2010
INSERT MODE    
LAPPEND MODE      2012
LAPPEND MODE      2010
LAPPEND MODE       2014     764    2947   41027 ACTBIGID.CBL2014773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL
    1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2711   10259  121235 CALIDBDSS.CBL
    2727   10276  153150 CERTCARDEC.CBL
    2779   14151  205945 ACTMIGRAC.CBL
    2804   11536  157200 DEBS18.CBL
    2930   13638  185586 ACTMFRE.CBL
    2950   11358  170941 ACTVLESP.CBL
    2979   14061  189857 ACTEUNINW.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL
    4982   23794  352126 ACTEUNI.CBL
    6842   27485  492817 DD3VHF.CBL
    7095   26771  456770 ACTVLCT.CBL
    9039   44327  583589 ACTAVAL.CBL
   12194   62286  836410 ACTVLCR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~     170     530    8018 CTLIDXTDC.CBL2010277     830   15847 BDACSVEXTRAE.CBL   2012282     965   13039 CTL113.CBL2010295    1017   16487 CTL103.CBL2010297    1003   14539 CTLUTL25.CBL2010304     998   13124 CARACTCOL.CBL2011306    1004   13181 CARACTPER.CBL2011306    1004   13181 CARPER-ND.CBL2011310    1145   13494 CARACTBC.CBL2010319     922   13871 CTLUTL21.CBL2010332    1107   16271 CTLUTL19.CBL2010402    1427   19605 CTLCOPYMES.CBL     2011413    1449   20397 CTLCOPYBNK.CBL     2013446    1765   21531 CTLUTL24.CBL2010453    1791   21952 CTLUTL01.CBL2010479    1547   21197 CTLACT34.CBL2010507    2029   26493 CTLCOPYCRE.CBL     2012508    1619   30592 CTLACT16.CBL2013536    1754   24694 CTLUTL02.CBL2010539    1827   33892 CTLPRSCCN.CBL2010541    1778   24912 CTLACT24.CBL2010559    2046   28395 CTLACT14.CBL2012608    2532   35019 CTLACT13.CBL2010619    2285   33028 CARACTDIR.CBL2010620    2439   29933 CTLUTL66.CBL2010622    2095   26428 COLASCOHQ.CBL2014631    2495   30641 CTLUTL18.CBL2010636    2124   31381 BDLSTR.CBL2010641    2268   34970 BDLPLANOS.CBL2012724    2514   33231 BDIEREEST.CBL2010764    2947   41027 ACTBIGID.CBL2014773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL
    1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL"qqq" [Modified] line 1 of 70 --1%--      170     530    8018 CTLIDXTDC.CBL2010277     830   15847 BDACSVEXTRAE.CBL   2012282     965   13039 CTL113.CBL2010295    1017   16487 CTL103.CBL2010297    1003   14539 CTLUTL25.CBL2010304     998   13124 CARACTCOL.CBL2011306    1004   13181 CARACTPER.CBL2011306    1004   13181 CARPER-ND.CBL2011310    1145   13494 CARACTBC.CBL2010319     922   13871 CTLUTL21.CBL2010332    1107   16271 CTLUTL19.CBL2010402    1427   19605 CTLCOPYMES.CBL     2011413    1449   20397 CTLCOPYBNK.CBL     2013446    1765   21531 CTLUTL24.CBL2010453    1791   21952 CTLUTL01.CBL2010479    1547   21197 CTLACT34.CBL2010507    2029   26493 CTLCOPYCRE.CBL     2012508    1619   30592 CTLACT16.CBL2013536    1754   24694 CTLUTL02.CBL2010539    1827   33892 CTLPRSCCN.CBL2010541    1778   24912 CTLACT24.CBL2010559    2046   28395 CTLACT14.CBL2012608    2532   35019 CTLACT13.CBL2010619    2285   33028 CARACTDIR.CBL2010620    2439   29933 CTLUTL66.CBL2010622    2095   26428 COLASCOHQ.CBL2014631    2495   30641 CTLUTL18.CBL2010636    2124   31381 BDLSTR.CBL2010641    2268   34970 BDLPLANOS.CBL2012724    2514   33231 BDIEREEST.CBL2010764    2947   41027 ACTBIGID.CBL2014773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL     170     530    8018 CTLIDXTDC.CBL2010277     830   15847 BDACSVEXTRAE.CBL   2012282     965   13039 CTL113.CBL2010295    1017   16487 CTL103.CBL2010297    1003   14539 CTLUTL25.CBL2010304     998   13124 CARACTCOL.CBL2011306    1004   13181 CARACTPER.CBL2011306    1004   13181 CARPER-ND.CBL2011310    1145   13494 CARACTBC.CBL2010319     922   13871 CTLUTL21.CBL2010332    1107   16271 CTLUTL19.CBL2010402    1427   19605 CTLCOPYMES.CBL     2011413    1449   20397 CTLCOPYBNK.CBL     2013446    1765   21531 CTLUTL24.CBL2010453    1791   21952 CTLUTL01.CBL2010479    1547   21197 CTLACT34.CBL2010507    2029   26493 CTLCOPYCRE.CBL     2012508    1619   30592 CTLACT16.CBL2013536    1754   24694 CTLUTL02.CBL2010539    1827   33892 CTLPRSCCN.CBL2010541    1778   24912 CTLACT24.CBL2010559    2046   28395 CTLACT14.CBL2012608    2532   35019 CTLACT13.CBL2010619    2285   33028 CARACTDIR.CBL2010620    2439   29933 CTLUTL66.CBL2010622    2095   26428 COLASCOHQ.CBL2014631    2495   30641 CTLUTL18.CBL2010636    2124   31381 BDLSTR.CBL2010641    2268   34970 BDLPLANOS.CBL2012724    2514   33231 BDIEREEST.CBL2010764    2947   41027 ACTBIGID.CBL2014773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL
    1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL
    2615   11765  152396 ACTEUNILG.CBL
    1814    6877   93361 DTCABD.CBL1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2711   10259  121235 CALIDBDSS.CBL
    2727   10276  153150 CERTCARDEC.CBL
    2779   14151  205945 ACTMIGRAC.CBL
    2804   11536  157200 DEBS18.CBL
    2930   13638  185586 ACTMFRE.CBL
    2950   11358  170941 ACTVLESP.CBL
    2979   14061  189857 ACTEUNINW.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL
    4982   23794  352126 ACTEUNI.CBL
    6842   27485  492817 DD3VHF.CBL
    7095   26771  456770 ACTVLCT.CBL
    9039   44327  583589 ACTAVAL.CBL
   12194   62286  836410 ACTVLCR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~    1814    6877   93361 DTCABD.CBL1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2711   10259  121235 CALIDBDSS.CBL
    2727   10276  153150 CERTCARDEC.CBL
    2779   14151  205945 ACTMIGRAC.CBL
    2804   11536  157200 DEBS18.CBL
    2930   13638  185586 ACTMFRE.CBL
    2950   11358  170941 ACTVLESP.CBL
    2979   14061  189857 ACTEUNINW.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL
    4982   23794  352126 ACTEUNI.CBL
    6842   27485  492817 DD3VHF.CBL
    7095   26771  456770 ACTVLCT.CBL
    9039   44327  583589 ACTAVAL.CBL
   12194   62286  836410 ACTVLCR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~    1814    6877   93361 DTCABD.CBL1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2711   10259  121235 CALIDBDSS.CBL
    2727   10276  153150 CERTCARDEC.CBL
    2779   14151  205945 ACTMIGRAC.CBL
    2804   11536  157200 DEBS18.CBL
    2930   13638  185586 ACTMFRE.CBL
    2950   11358  170941 ACTVLESP.CBL
    2979   14061  189857 ACTEUNINW.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL
    4982   23794  352126 ACTEUNI.CBL
    6842   27485  492817 DD3VHF.CBL
    7095   26771  456770 ACTVLCT.CBL
    9039   44327  583589 ACTAVAL.CBL
   12194   62286  836410 ACTVLCR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~     170     530    8018 CTLIDXTDC.CBL2010277     830   15847 BDACSVEXTRAE.CBL   2012282     965   13039 CTL113.CBL2010295    1017   16487 CTL103.CBL2010297    1003   14539 CTLUTL25.CBL2010304     998   13124 CARACTCOL.CBL2011306    1004   13181 CARACTPER.CBL2011306    1004   13181 CARPER-ND.CBL2011310    1145   13494 CARACTBC.CBL2010319     922   13871 CTLUTL21.CBL2010332    1107   16271 CTLUTL19.CBL2010402    1427   19605 CTLCOPYMES.CBL     2011413    1449   20397 CTLCOPYBNK.CBL     2013446    1765   21531 CTLUTL24.CBL2010453    1791   21952 CTLUTL01.CBL2010479    1547   21197 CTLACT34.CBL2010507    2029   26493 CTLCOPYCRE.CBL     2012508    1619   30592 CTLACT16.CBL2013536    1754   24694 CTLUTL02.CBL2010539    1827   33892 CTLPRSCCN.CBL2010541    1778   24912 CTLACT24.CBL2010559    2046   28395 CTLACT14.CBL2012608    2532   35019 CTLACT13.CBL2010619    2285   33028 CARACTDIR.CBL2010620    2439   29933 CTLUTL66.CBL2010622    2095   26428 COLASCOHQ.CBL2014631    2495   30641 CTLUTL18.CBL2010636    2124   31381 BDLSTR.CBL2010641    2268   34970 BDLPLANOS.CBL2012724    2514   33231 BDIEREEST.CBL2010764    2947   41027 ACTBIGID.CBL2014773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL$CHANGE MODEOLASCOHQ.CBL170     530    8018 CTLIDXTDC.CBL      2010     809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL
    1841    7540  110927 CARACTNEW.CBL
    1884    8959  132326 CTLN97.CBL
    1973    6707   88645 ACTESTLEY.CBL
    2053    6764  140475 CTLACT49.CBL
    2276   10400  152185 CTLACT45.CBL
    2466   10466  126977 CASOSMER.CBL
    2615   11765  152396 ACTEUNILG.CBL
    2711   10259  121235 CALIDBDSS.CBL
    2727   10276  153150 CERTCARDEC.CBL
    2779   14151  205945 ACTMIGRAC.CBL
    2804   11536  157200 DEBS18.CBL
    2930   13638  185586 ACTMFRE.CBL
    2950   11358  170941 ACTVLESP.CBL
    2979   14061  189857 ACTEUNINW.CBL
    4230   14243  200767 CITSELPS.CBL
    4230   14243  200767 CITSELPSv02.CBL
    4982   23794  352126 ACTEUNI.CBL
    6842   27485  492817 DD3VHF.CBL
    7095   26771  456770 ACTVLCT.CBL
    9039   44327  583589 ACTAVAL.CBL
   12194   62286  836410 ACTVLCR.CBL
~
~
~
~
~
~
~
~
~
~
~





     170     530    8018 CTLIDXTDC.CBL2010277     830   15847 BDACSVEXTRAE.CBL   2012282     965   13039 CTL113.CBL2010295    1017   16487 CTL103.CBL2010297    1003   14539 CTLUTL25.CBL2010304     998   13124 CARACTCOL.CBL2011306    1004   13181 CARACTPER.CBL2011306    1004   13181 CARPER-ND.CBL2011310    1145   13494 CARACTBC.CBL2010319     922   13871 CTLUTL21.CBL2010332    1107   16271 CTLUTL19.CBL2010402    1427   19605 CTLCOPYMES.CBL     2011413    1449   20397 CTLCOPYBNK.CBL     2013446    1765   21531 CTLUTL24.CBL2010453    1791   21952 CTLUTL01.CBL2010479    1547   21197 CTLACT34.CBL2010507    2029   26493 CTLCOPYCRE.CBL     2012508    1619   30592 CTLACT16.CBL2013536    1754   24694 CTLUTL02.CBL2010539    1827   33892 CTLPRSCCN.CBL2010541    1778   24912 CTLACT24.CBL2010559    2046   28395 CTLACT14.CBL2012608    2532   35019 CTLACT13.CBL2010619    2285   33028 CARACTDIR.CBL2010620    2439   29933 CTLUTL66.CBL2010622    2095   26428 COLASCOHQ.CBL2014631    2495   30641 CTLUTL18.CBL2010636    2124   31381 BDLSTR.CBL2010641    2268   34970 BDLPLANOS.CBL2012724    2514   33231 BDIEREEST.CBL2010764    2947   41027 ACTBIGID.CBL2014773    3137   43770 CTLACT12.CBL809    3173   42810 CTLACT41.CBL819    3472   53184 CTLACT09.CBL852    2969   37388 caract-icjvlr.CBL990    3867   48956 CTL003.CBL
    1027    4025   48410 BDIPROBINC.CBL
    1067    4000   48848 CARACTBD.CBL
    1124    3862   54039 CARACTBDLNEW.CBL
    1183    3976   56396 CARACTBDL.CBL
    1389    4545   61978 CTLACT40.CBL
    1396    5623   59160 CARGAJUR.CBL
    1413    6135   92259 CTLACT55.CBL
    1490    6455   94996 CARACTUSA.CBL
    1498    5671   78194 ACTCAMPLEY.CBL
    1697    8223  106038 ACTAREV.CBL
    1706    5381   79743 ACTMDIDE.CBL
    1723    7016  102312 CARACTNEWRMB.CBL
    1814    6877   93361 DTCABD.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
70 lines deletedNo lines in buffer!grep -il 513-VALIDA-EN-CSV *.CBL *.cblgrep: can't open ICGAA2.CBL
grep: can't open ICGAAM.CBL
grep: can't open LISTASU.CBL
grep: can't open LISTASUS.CBL
grep: can't open PRUCOMP-3.CBL
P_PESVNO.CBL
P_PESVNOCITI.CBL
P_PESVNOCSVBCS.CBL
P_PESVNOCSVFNG.CBL
P_PESVNOCSVPLUS.CBL
PES.CBL
PESVNO-AVV.CBL
PESVNO-CV.CBL
PESVNO-DIGITO.CBL
PESVNO-V02.CBL
PESVNO-V03.CBL
PESVNO.CBL
PESVNO0504.CBL
PESVNO64.CBL
PESVNOCITI.CBL
PESVNOCSV_cg.CBL
PESVNOCSV-V05.CBL
PESVNOCSV.CBL
PESVNOCSVBCS_CAL.CBL
PESVNOCSVBCS_p.CBL
PESVNOCSVBCS.CBL
PESVNOCSVBCSv06.CBL
PESVNOCSVc.CBL
PESVNOCSVFNG.CBL
PESVNOCSVPLUS.CBL
PESVNOCSVPLUSc.CBL
PESVNOCSVPLUSv06.CBL
PESVNOCSVSEGE-V02.CBL
PESVNOCSVSEGE-V03.CBL
PESVNOCSVSEGE-V04.CBL
PESVNOCSVSEGE.CBL
PESVNOCSVSEGElag.CBL
PESVNOCSVTMX.CBL
PESVNOCSVv06.CBL
PESVNOGJ.CBL
PESVNONW1.CBL
PESVNOPEO.CBL
PESVNOpv.CBL
PESVNORMB.CBL
PESVNORMBNW-EHA.CBL
PESVNORMBNW.CBL
PESVNOSEGE2.CBL
PESVNOTEST.CBL
PESVNOv09.CBL
55 more lines



PESVNOv10.CBL
icestd12.cbl
icestd12v09.cbl
pesvnormb.cbl
pesvnotest.cbl:%s/.*/wc &; ls -l &51 substitutions wc PESVNOCSVSEGE-V02.CBL; ls -l PESVNOCSVSEGE-V02.CBL
wc PESVNOCSVSEGE-V03.CBL; ls -l PESVNOCSVSEGE-V03.CBL
wc PESVNOCSVSEGE-V04.CBL; ls -l PESVNOCSVSEGE-V04.CBL
wc PESVNOCSVSEGE.CBL; ls -l PESVNOCSVSEGE.CBL
wc PESVNOCSVSEGElag.CBL; ls -l PESVNOCSVSEGElag.CBL
wc PESVNOCSVTMX.CBL; ls -l PESVNOCSVTMX.CBL
wc PESVNOCSVv06.CBL; ls -l PESVNOCSVv06.CBL
wc PESVNOGJ.CBL; ls -l PESVNOGJ.CBL
wc PESVNONW1.CBL; ls -l PESVNONW1.CBL
wc PESVNOPEO.CBL; ls -l PESVNOPEO.CBL
wc PESVNOpv.CBL; ls -l PESVNOpv.CBL
wc PESVNORMB.CBL; ls -l PESVNORMB.CBL
wc PESVNORMBNW-EHA.CBL; ls -l PESVNORMBNW-EHA.CBL
wc PESVNORMBNW.CBL; ls -l PESVNORMBNW.CBL
wc PESVNOSEGE2.CBL; ls -l PESVNOSEGE2.CBL
wc PESVNOTEST.CBL; ls -l PESVNOTEST.CBL
wc PESVNOv09.CBL; ls -l PESVNOv09.CBL
wc PESVNOv10.CBL; ls -l PESVNOv10.CBL
wc icestd12.cbl; ls -l icestd12.cbl
wc icestd12v09.cbl; ls -l icestd12v09.cbl
wc pesvnormb.cbl; ls -l pesvnormb.cbl
wc pesvnotest.cbl; ls -l pesvnotest.cbl
wc PESVNOZZ.cbl; ls -l PESVNOZZ.cbl
wc xxxxxxxxxxx.cbl; ls -l xxxxxxxxxxx.cbl
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"qqq" [Modified] line 51 of 51 --100%-- :w"qqq" 51 lines, 2174 characters wc P_PESVNO.CBL; ls -l P_PESVNO.CBL
wc P_PESVNOCITI.CBL; ls -l P_PESVNOCITI.CBL
wc P_PESVNOCSVBCS.CBL; ls -l P_PESVNOCSVBCS.CBL
wc P_PESVNOCSVFNG.CBL; ls -l P_PESVNOCSVFNG.CBL
wc P_PESVNOCSVPLUS.CBL; ls -l P_PESVNOCSVPLUS.CBL
wc PES.CBL; ls -l PES.CBL
wc PESVNO-AVV.CBL; ls -l PESVNO-AVV.CBL
wc PESVNO-CV.CBL; ls -l PESVNO-CV.CBL
wc PESVNO-DIGITO.CBL; ls -l PESVNO-DIGITO.CBL
wc PESVNO-V02.CBL; ls -l PESVNO-V02.CBL
wc PESVNO-V03.CBL; ls -l PESVNO-V03.CBL
wc PESVNO.CBL; ls -l PESVNO.CBL
wc PESVNO0504.CBL; ls -l PESVNO0504.CBL
wc PESVNO64.CBL; ls -l PESVNO64.CBL
wc PESVNOCITI.CBL; ls -l PESVNOCITI.CBL
wc PESVNOCSV_cg.CBL; ls -l PESVNOCSV_cg.CBL
wc PESVNOCSV-V05.CBL; ls -l PESVNOCSV-V05.CBL
wc PESVNOCSV.CBL; ls -l PESVNOCSV.CBL
wc PESVNOCSVBCS_CAL.CBL; ls -l PESVNOCSVBCS_CAL.CBL
wc PESVNOCSVBCS_p.CBL; ls -l PESVNOCSVBCS_p.CBL
wc PESVNOCSVBCS.CBL; ls -l PESVNOCSVBCS.CBL
wc PESVNOCSVBCSv06.CBL; ls -l PESVNOCSVBCSv06.CBL
wc PESVNOCSVc.CBL; ls -l PESVNOCSVc.CBL
wc PESVNOCSVFNG.CBL; ls -l PESVNOCSVFNG.CBL
wc PESVNOCSVPLUS.CBL; ls -l PESVNOCSVPLUS.CBL
wc PESVNOCSVPLUSc.CBL; ls -l PESVNOCSVPLUSc.CBL
wc PESVNOCSVPLUSv06.CBL; ls -l PESVNOCSVPLUSv06.CBL
wc PESVNOCSVSEGE-V02.CBL; ls -l PESVNOCSVSEGE-V02.CBL
wc PESVNOCSVSEGE-V03.CBL; ls -l PESVNOCSVSEGE-V03.CBL
wc PESVNOCSVSEGE-V04.CBL; ls -l PESVNOCSVSEGE-V04.CBL
wc PESVNOCSVSEGE.CBL; ls -l PESVNOCSVSEGE.CBL
wc PESVNOCSVSEGElag.CBL; ls -l PESVNOCSVSEGElag.CBL
wc PESVNOCSVTMX.CBL; ls -l PESVNOCSVTMX.CBL
wc PESVNOCSVv06.CBL; ls -l PESVNOCSVv06.CBL
wc PESVNOGJ.CBL; ls -l PESVNOGJ.CBL
wc PESVNONW1.CBL; ls -l PESVNONW1.CBL
wc PESVNOPEO.CBL; ls -l PESVNOPEO.CBL
wc PESVNOpv.CBL; ls -l PESVNOpv.CBL
wc PESVNORMB.CBL; ls -l PESVNORMB.CBL
wc PESVNORMBNW-EHA.CBL; ls -l PESVNORMBNW-EHA.CBL
wc PESVNORMBNW.CBL; ls -l PESVNORMBNW.CBL
wc PESVNOSEGE2.CBL; ls -l PESVNOSEGE2.CBL
wc PESVNOTEST.CBL; ls -l PESVNOTEST.CBL
wc PESVNOv09.CBL; ls -l PESVNOv09.CBL
wc PESVNOv10.CBL; ls -l PESVNOv10.CBL
wc icestd12.cbl; ls -l icestd12.cbl
wc icestd12v09.cbl; ls -l icestd12v09.cbl
wc pesvnormb.cbl; ls -l pesvnormb.cbl
wc pesvnotest.cbl; ls -l pesvnotest.cblOPEN MODE!!sh qqq!sh qqq     919    3467   42879 P_PESVNO.CBL
-rw-rw-r--   1 1360     icdatacr   42879 Jul 13  2010 P_PESVNO.CBL934    4489   58108 P_PESVNOCITI.CBL
-rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL
    1694    7549  109933 P_PESVNOCSVBCS.CBL
-rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL946    3422   43437 P_PESVNOCSVFNG.CBL
-rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL899    3336   41287 P_PESVNOCSVPLUS.CBL
-rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL956    3677   45526 PES.CBL
-rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL987    3828   47865 PESVNO-AVV.CBL
-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL946    3615   44911 PESVNO-CV.CBL
-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL952    3658   45386 PESVNO-DIGITO.CBL
-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL895    3326   41114 PESVNO-V02.CBL
-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL903    3381   41902 PESVNO-V03.CBL
-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL
    1065    4266   54157 PESVNO.CBL
-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL917    3462   42689 PESVNO0504.CBL
-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL952    3658   45379 PESVNO64.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL951    4565   59253 PESVNOCITI.CBL
-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL929    3490   43503 PESVNOCSV_cg.CBL
-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL923    3455   43051 PESVNOCSV-V05.CBL
-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL
    1069    4306   54743 PESVNOCSV.CBL
-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
    2708   11391  135767 PESVNOCSVBCS_CAL.CBL
-rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2853   12239  145451 PESVNOCSVBCS_p.CBL
-rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    3619   16002  207161 PESVNOCSVBCS.CBL
-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    2874   12348  146988 PESVNOCSVBCSv06.CBL
-rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
    1011    3900   49725 PESVNOCSVc.CBL
-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL953    3466   43920 PESVNOCSVFNG.CBL
-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL
    1070    4318   54855 PESVNOCSVPLUS.CBL
101 more linesLAPPEND MODE           

     L           

    L         L                 3275   14781  184036 PESVNORMBNW-EHA.CBL
-rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
    3374   15105  188406 PESVNORMBNW.CBL
-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
    4735   17588  277169 PESVNOSEGE2.CBL
-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
    2413   10821  139052 PESVNOTEST.CBL
-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL983    3857   47985 PESVNOv09.CBL
-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL998    3932   49201 PESVNOv10.CBL
-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
    1134    4631   66170 icestd12.cbl
-rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
    1134    4631   66170 icestd12v09.cbl
-rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
    1065    4266   54157 pesvnormb.cbl
-rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
    2283   10232  133784 pesvnotest.cbl
-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    1066    4270   54196 PESVNOZZ.cbl
-rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
    3728   16478  203565 xxxxxxxxxxx.cbl
-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
wc P_PESVNO.CBL; ls -l P_PESVNO.CBL
wc P_PESVNOCITI.CBL; ls -l P_PESVNOCITI.CBL
wc P_PESVNOCSVBCS.CBL; ls -l P_PESVNOCSVBCS.CBL
wc P_PESVNOCSVFNG.CBL; ls -l P_PESVNOCSVFNG.CBL
wc P_PESVNOCSVPLUS.CBL; ls -l P_PESVNOCSVPLUS.CBL
wc PES.CBL; ls -l PES.CBL
wc PESVNO-AVV.CBL; ls -l PESVNO-AVV.CBL
wc PESVNO-CV.CBL; ls -l PESVNO-CV.CBL
wc PESVNO-DIGITO.CBL; ls -l PESVNO-DIGITO.CBL
wc PESVNO-V02.CBL; ls -l PESVNO-V02.CBL
wc PESVNO-V03.CBL; ls -l PESVNO-V03.CBL
wc PESVNO.CBL; ls -l PESVNO.CBL
wc PESVNO0504.CBL; ls -l PESVNO0504.CBL
wc PESVNO64.CBL; ls -l PESVNO64.CBL
wc PESVNOCITI.CBL; ls -l PESVNOCITI.CBL
wc PESVNOCSV_cg.CBL; ls -l PESVNOCSV_cg.CBL
wc PESVNOCSV-V05.CBL; ls -l PESVNOCSV-V05.CBL
wc PESVNOCSV.CBL; ls -l PESVNOCSV.CBL
wc PESVNOCSVBCS_CAL.CBL; ls -l PESVNOCSVBCS_CAL.CBL
wc PESVNOCSVBCS_p.CBL; ls -l PESVNOCSVBCS_p.CBL
wc PESVNOCSVBCS.CBL; ls -l PESVNOCSVBCS.CBL
wc PESVNOCSVBCSv06.CBL; ls -l PESVNOCSVBCSv06.CBL
wc PESVNOCSVc.CBL; ls -l PESVNOCSVc.CBL
wc PESVNOCSVFNG.CBL; ls -l PESVNOCSVFNG.CBL
wc PESVNOCSVPLUS.CBL; ls -l PESVNOCSVPLUS.CBL
wc P_PESVNO.CBL; ls -l P_PESVNO.CBL
wc P_PESVNOCITI.CBL; ls -l P_PESVNOCITI.CBL
wc P_PESVNOCSVBCS.CBL; ls -l P_PESVNOCSVBCS.CBL
wc P_PESVNOCSVFNG.CBL; ls -l P_PESVNOCSVFNG.CBL
wc P_PESVNOCSVPLUS.CBL; ls -l P_PESVNOCSVPLUS.CBL
wc PES.CBL; ls -l PES.CBL
wc PESVNO-AVV.CBL; ls -l PESVNO-AVV.CBL
wc PESVNO-CV.CBL; ls -l PESVNO-CV.CBL
wc PESVNO-DIGITO.CBL; ls -l PESVNO-DIGITO.CBL
wc PESVNO-V02.CBL; ls -l PESVNO-V02.CBL
wc PESVNO-V03.CBL; ls -l PESVNO-V03.CBL
wc PESVNO.CBL; ls -l PESVNO.CBL
wc PESVNO0504.CBL; ls -l PESVNO0504.CBL
wc PESVNO64.CBL; ls -l PESVNO64.CBL
wc PESVNOCITI.CBL; ls -l PESVNOCITI.CBL
wc PESVNOCSV_cg.CBL; ls -l PESVNOCSV_cg.CBL
wc PESVNOCSV-V05.CBL; ls -l PESVNOCSV-V05.CBL
wc PESVNOCSV.CBL; ls -l PESVNOCSV.CBL
wc PESVNOCSVBCS_CAL.CBL; ls -l PESVNOCSVBCS_CAL.CBL
wc PESVNOCSVBCS_p.CBL; ls -l PESVNOCSVBCS_p.CBL
wc PESVNOCSVBCS.CBL; ls -l PESVNOCSVBCS.CBL
wc PESVNOCSVBCSv06.CBL; ls -l PESVNOCSVBCSv06.CBL
wc PESVNOCSVc.CBL; ls -l PESVNOCSVc.CBL
wc PESVNOCSVFNG.CBL; ls -l PESVNOCSVFNG.CBL
wc PESVNOCSVPLUS.CBL; ls -l PESVNOCSVPLUS.CBL
wc PESVNOCSVPLUSc.CBL; ls -l PESVNOCSVPLUSc.CBL
wc PESVNOCSVPLUSv06.CBL; ls -l PESVNOCSVPLUSv06.CBL
wc PESVNOCSVSEGE-V02.CBL; ls -l PESVNOCSVSEGE-V02.CBL
wc PESVNOCSVSEGE-V03.CBL; ls -l PESVNOCSVSEGE-V03.CBL
wc PESVNOCSVSEGE-V04.CBL; ls -l PESVNOCSVSEGE-V04.CBL
wc PESVNOCSVSEGE.CBL; ls -l PESVNOCSVSEGE.CBL
wc PESVNOCSVSEGElag.CBL; ls -l PESVNOCSVSEGElag.CBL
wc PESVNOCSVTMX.CBL; ls -l PESVNOCSVTMX.CBL
wc PESVNOCSVv06.CBL; ls -l PESVNOCSVv06.CBL
wc PESVNOGJ.CBL; ls -l PESVNOGJ.CBL
wc PESVNONW1.CBL; ls -l PESVNONW1.CBL
wc PESVNOPEO.CBL; ls -l PESVNOPEO.CBL
wc PESVNOpv.CBL; ls -l PESVNOpv.CBL
wc PESVNORMB.CBL; ls -l PESVNORMB.CBL
wc PESVNORMBNW-EHA.CBL; ls -l PESVNORMBNW-EHA.CBL
wc PESVNORMBNW.CBL; ls -l PESVNORMBNW.CBL
wc PESVNOSEGE2.CBL; ls -l PESVNOSEGE2.CBL
wc PESVNOTEST.CBL; ls -l PESVNOTEST.CBL
wc PESVNOv09.CBL; ls -l PESVNOv09.CBL
wc PESVNOv10.CBL; ls -l PESVNOv10.CBL
wc icestd12.cbl; ls -l icestd12.cbl
wc icestd12v09.cbl; ls -l icestd12v09.cbl
wc pesvnormb.cbl; ls -l pesvnormb.cbl
wc pesvnotest.cbl; ls -l pesvnotest.cblwc P_PESVNO.CBL; ls -l P_PESVNO.CBL
wc P_PESVNOCITI.CBL; ls -l P_PESVNOCITI.CBL
wc P_PESVNOCSVBCS.CBL; ls -l P_PESVNOCSVBCS.CBL
wc P_PESVNOCSVFNG.CBL; ls -l P_PESVNOCSVFNG.CBL
wc P_PESVNOCSVPLUS.CBL; ls -l P_PESVNOCSVPLUS.CBL
wc PES.CBL; ls -l PES.CBL
wc PESVNO-AVV.CBL; ls -l PESVNO-AVV.CBL
wc PESVNO-CV.CBL; ls -l PESVNO-CV.CBL
wc PESVNO-DIGITO.CBL; ls -l PESVNO-DIGITO.CBL
wc PESVNO-V02.CBL; ls -l PESVNO-V02.CBL
wc PESVNO-V03.CBL; ls -l PESVNO-V03.CBL
wc PESVNO.CBL; ls -l PESVNO.CBL
wc PESVNO0504.CBL; ls -l PESVNO0504.CBL
wc PESVNO64.CBL; ls -l PESVNO64.CBL
wc PESVNOCITI.CBL; ls -l PESVNOCITI.CBL
wc PESVNOCSV_cg.CBL; ls -l PESVNOCSV_cg.CBL
wc PESVNOCSV-V05.CBL; ls -l PESVNOCSV-V05.CBL
wc PESVNOCSV.CBL; ls -l PESVNOCSV.CBL
wc PESVNOCSVBCS_CAL.CBL; ls -l PESVNOCSVBCS_CAL.CBL
wc PESVNOCSVBCS_p.CBL; ls -l PESVNOCSVBCS_p.CBL
wc PESVNOCSVBCS.CBL; ls -l PESVNOCSVBCS.CBL
wc PESVNOCSVBCSv06.CBL; ls -l PESVNOCSVBCSv06.CBL
wc PESVNOCSVc.CBL; ls -l PESVNOCSVc.CBL
wc PESVNOCSVFNG.CBL; ls -l PESVNOCSVFNG.CBL
wc PESVNOCSVPLUS.CBL; ls -l PESVNOCSVPLUS.CBL
wc PESVNOCSVPLUSc.CBL; ls -l PESVNOCSVPLUSc.CBL
wc PESVNOCSVPLUSv06.CBL; ls -l PESVNOCSVPLUSv06.CBL
wc PESVNOCSVSEGE-V02.CBL; ls -l PESVNOCSVSEGE-V02.CBL
wc PESVNOCSVSEGE-V03.CBL; ls -l PESVNOCSVSEGE-V03.CBL
wc PESVNOCSVSEGE-V04.CBL; ls -l PESVNOCSVSEGE-V04.CBL
wc PESVNOCSVSEGE.CBL; ls -l PESVNOCSVSEGE.CBL
wc PESVNOCSVSEGElag.CBL; ls -l PESVNOCSVSEGElag.CBL
wc PESVNOCSVTMX.CBL; ls -l PESVNOCSVTMX.CBL
wc PESVNOCSVv06.CBL; ls -l PESVNOCSVv06.CBL
wc PESVNOGJ.CBL; ls -l PESVNOGJ.CBL
wc PESVNONW1.CBL; ls -l PESVNONW1.CBL
wc PESVNOPEO.CBL; ls -l PESVNOPEO.CBL
wc PESVNOpv.CBL; ls -l PESVNOpv.CBL
wc PESVNORMB.CBL; ls -l PESVNORMB.CBL
wc PESVNORMBNW-EHA.CBL; ls -l PESVNORMBNW-EHA.CBL
wc PESVNORMBNW.CBL; ls -l PESVNORMBNW.CBL
wc PESVNOSEGE2.CBL; ls -l PESVNOSEGE2.CBL
wc PESVNOTEST.CBL; ls -l PESVNOTEST.CBL
wc PESVNOv09.CBL; ls -l PESVNOv09.CBL
wc PESVNOv10.CBL; ls -l PESVNOv10.CBL
wc icestd12.cbl; ls -l icestd12.cbl
wc icestd12v09.cbl; ls -l icestd12v09.cbl
wc pesvnormb.cbl; ls -l pesvnormb.cbl
wc pesvnotest.cbl; ls -l pesvnotest.cbl
wc PESVNOZZ.cbl; ls -l PESVNOZZ.cbl
wc xxxxxxxxxxx.cbl; ls -l xxxxxxxxxxx.cbl
~
~
~
~wc PESVNOZZ.cbl; ls -l PESVNOZZ.cbl
wc xxxxxxxxxxx.cbl; ls -l xxxxxxxxxxx.cbl
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~    2283   10232  133784 pesvnotest.cbl
-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    1066    4270   54196 PESVNOZZ.cbl
-rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
    3728   16478  203565 xxxxxxxxxxx.cbl
-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
wc P_PESVNO.CBL; ls -l P_PESVNO.CBL
wc P_PESVNOCITI.CBL; ls -l P_PESVNOCITI.CBL
wc P_PESVNOCSVBCS.CBL; ls -l P_PESVNOCSVBCS.CBL
wc P_PESVNOCSVFNG.CBL; ls -l P_PESVNOCSVFNG.CBL
wc P_PESVNOCSVPLUS.CBL; ls -l P_PESVNOCSVPLUS.CBL
wc PES.CBL; ls -l PES.CBL
wc PESVNO-AVV.CBL; ls -l PESVNO-AVV.CBL
wc PESVNO-CV.CBL; ls -l PESVNO-CV.CBL
wc PESVNO-DIGITO.CBL; ls -l PESVNO-DIGITO.CBL
wc PESVNO-V02.CBL; ls -l PESVNO-V02.CBL
wc PESVNO-V03.CBL; ls -l PESVNO-V03.CBL
wc PESVNO.CBL; ls -l PESVNO.CBL
wc PESVNO0504.CBL; ls -l PESVNO0504.CBL
wc PESVNO64.CBL; ls -l PESVNO64.CBL
wc PESVNOCITI.CBL; ls -l PESVNOCITI.CBL
wc PESVNOCSV_cg.CBL; ls -l PESVNOCSV_cg.CBL
wc PESVNOCSV-V05.CBL; ls -l PESVNOCSV-V05.CBL
wc PESVNOCSV.CBL; ls -l PESVNOCSV.CBL
wc PESVNOCSVBCS_CAL.CBL; ls -l PESVNOCSVBCS_CAL.CBL
wc PESVNOCSVBCS_p.CBL; ls -l PESVNOCSVBCS_p.CBL
wc PESVNOCSVBCS.CBL; ls -l PESVNOCSVBCS.CBL
wc PESVNOCSVBCSv06.CBL; ls -l PESVNOCSVBCSv06.CBL
wc PESVNOCSVc.CBL; ls -l PESVNOCSVc.CBL
wc PESVNOCSVFNG.CBL; ls -l PESVNOCSVFNG.CBL
wc PESVNOCSVPLUS.CBL; ls -l PESVNOCSVPLUS.CBL
wc PESVNOCSVPLUSc.CBL; ls -l PESVNOCSVPLUSc.CBL
wc PESVNOCSVPLUSv06.CBL; ls -l PESVNOCSVPLUSv06.CBL
wc PESVNOCSVSEGE-V02.CBL; ls -l PESVNOCSVSEGE-V02.CBL
wc PESVNOCSVSEGE-V03.CBL; ls -l PESVNOCSVSEGE-V03.CBL
wc PESVNOCSVSEGE-V04.CBL; ls -l PESVNOCSVSEGE-V04.CBL
wc PESVNOCSVSEGE.CBL; ls -l PESVNOCSVSEGE.CBL
wc PESVNOCSVSEGElag.CBL; ls -l PESVNOCSVSEGElag.CBL
wc PESVNOCSVTMX.CBL; ls -l PESVNOCSVTMX.CBL
wc PESVNOCSVv06.CBL; ls -l PESVNOCSVv06.CBL
wc PESVNOGJ.CBL; ls -l PESVNOGJ.CBL
wc PESVNONW1.CBL; ls -l PESVNONW1.CBL
wc PESVNOPEO.CBL; ls -l PESVNOPEO.CBL
wc PESVNOpv.CBL; ls -l PESVNOpv.CBL
wc PESVNORMB.CBL; ls -l PESVNORMB.CBL
wc PESVNORMBNW-EHA.CBL; ls -l PESVNORMBNW-EHA.CBL
wc PESVNORMBNW.CBL; ls -l PESVNORMBNW.CBL
wc PESVNOSEGE2.CBL; ls -l PESVNOSEGE2.CBL
wc PESVNOTEST.CBL; ls -l PESVNOTEST.CBL
wc PESVNOv09.CBL; ls -l PESVNOv09.CBL
wc PESVNOv10.CBL; ls -l PESVNOv10.CBL
wc icestd12.cbl; ls -l icestd12.cbl
wc icestd12v09.cbl; ls -l icestd12v09.cbl
wc pesvnormb.cbl; ls -l pesvnormb.cbl
wc pesvnotest.cbl; ls -l pesvnotest.cbl
wc PESVNOZZ.cbl; ls -l PESVNOZZ.cbl

wc xxxxxxxxxxx.cbl; ls -l xxxxxxxxxxx.cbl

    

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
51 lines deleted


-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~     919    3467   42879 P_PESVNO.CBL
-rw-rw-r--   1 1360     icdatacr   42879 Jul 13  2010 P_PESVNO.CBL934    4489   58108 P_PESVNOCITI.CBL
-rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL
    1694    7549  109933 P_PESVNOCSVBCS.CBL
-rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL946    3422   43437 P_PESVNOCSVFNG.CBL
-rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL899    3336   41287 P_PESVNOCSVPLUS.CBL
-rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL956    3677   45526 PES.CBL
-rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL987    3828   47865 PESVNO-AVV.CBL
-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL946    3615   44911 PESVNO-CV.CBL
-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL952    3658   45386 PESVNO-DIGITO.CBL
-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL895    3326   41114 PESVNO-V02.CBL
-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL903    3381   41902 PESVNO-V03.CBL
-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL
    1065    4266   54157 PESVNO.CBL
-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL917    3462   42689 PESVNO0504.CBL
-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL952    3658   45379 PESVNO64.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL951    4565   59253 PESVNOCITI.CBL
-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL929    3490   43503 PESVNOCSV_cg.CBL
-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL923    3455   43051 PESVNOCSV-V05.CBL
-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL
    1069    4306   54743 PESVNOCSV.CBL
-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
    2708   11391  135767 PESVNOCSVBCS_CAL.CBL
-rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2853   12239  145451 PESVNOCSVBCS_p.CBL
-rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    3619   16002  207161 PESVNOCSVBCS.CBL
-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    2874   12348  146988 PESVNOCSVBCSv06.CBL
-rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
    1011    3900   49725 PESVNOCSVc.CBL
-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL953    3466   43920 PESVNOCSVFNG.CBL
-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL
    1070    4318   54855 PESVNOCSVPLUS.CBL
-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL989    3817   48311 PESVNOCSVPLUSc.CBL
-rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL917    3447   42753 PESVNOCSVPLUSv06.CBL
-rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL
    4954   18356  287300 PESVNOCSVSEGE-V02.CBL:map q A            ^^[JL            -rw-rw-r--   1 1360     icdatacr   42879 Jul 13  2010 P_PESVNO.CBL
-rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL:map qMissing rhs:map q A            ^|JjJj: Not an editor commandL           J:map q A            ^^[JjL            -rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL
    5534   21248  329808 PESVNOCSVSEGE-V03.CBL
L          -rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL
-rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
L          -rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL
5681   22063  340872 PESVNOCSVSEGE-V04.CBL
L             -rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL
-rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
L             -rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL
5977   23427  361326 PESVNOCSVSEGE.CBL
L          -rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL
-rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL
L           -rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL
5773   22407  345546 PESVNOCSVSEGElag.CBL
L           -rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL
-rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
L          -rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL
2795   10563  161516 PESVNOCSVTMX.CBL
L          -rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL
-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
L          -rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
939    3530   44191 PESVNOCSVv06.CBL
L          -rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL
-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL
L            -rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL
899    3346   41290 PESVNOGJ.CBL
L          -rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL
-rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL
L            -rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL
3242   14640  183121 PESVNONW1.CBL
L           -rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL
-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
L           -rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
983    3857   47985 PESVNOPEO.CBL
L            -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
-rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL
L          -rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
952    3658   45379 PESVNOpv.CBL
L            -rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
-rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL
L             -rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
3238   14622  182955 PESVNORMB.CBL
L          -rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
L            -rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL
3275   14781  184036 PESVNORMBNW-EHA.CBL
L           -rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
-rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
L          -rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL
3374   15105  188406 PESVNORMBNW.CBL
L            -rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL
-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
L           -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
4735   17588  277169 PESVNOSEGE2.CBL
L           -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
L           -rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
2413   10821  139052 PESVNOTEST.CBL
L           -rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL
-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
L            -rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
983    3857   47985 PESVNOv09.CBL
L            -rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL
L            -rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL
998    3932   49201 PESVNOv10.CBL
L            -rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL
-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
L           -rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
1134    4631   66170 icestd12.cbl
L           -rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL
-rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
L            -rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL
1134    4631   66170 icestd12v09.cbl
L           -rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
-rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
L             -rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
1065    4266   54157 pesvnormb.cbl
L             -rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
-rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
L             -rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
2283   10232  133784 pesvnotest.cbl
L          -rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
L           -rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL
1066    4270   54196 PESVNOZZ.cbl
L           -rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
-rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
l            -rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
3728   16478  203565 xxxxxxxxxxx.cbl
l             -rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
l           -rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
~
l          -rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl





~
l            -rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl




~
l             -rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
~l                                                  !sort895    3326   41114 PESVNO-V02.CBLicjdld1114 Mar 11ESVNO-V02.CBL899    3336   41287SVPLUS.CBL    -rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL
     899    3346   41290 PESVNOGJ.CBL           -rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL
03    3381   41902 PESVNO-V03.CBL         -rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL917    3447   42753 PESVNOCSVPLUSv06.CBL952753 Jun 11  2013 PESVNOCSVPLUSv06.CBL
17    3462   42689 PESVNO0504.CBL         -rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL
19    3467   42879 P_PESVNO.CBL  602879 Jul 13  2010 P_PESVNO.CBL
23    3455   4305CSV-V05.CBL    -rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL
29    3490   43503CSV_cg.CBL 1395  3503 Jul  9CSV_cg.CBL934    4489   58108 P_PESVNOCITI.CBL    -rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL
39    3530   44191CSVv06.CBL    -rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL
     946    3422   43437 P_PESVNOCSVFNG.CBL         -rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL
46    3615   44911-CV.CBL cav4911 Jul 11  2012-CV.CBL
1    4565   59253CITI.CBL59253 Sep 10CITI.CBL
2    3658   4537964.CBL  45379 Jul 1264.CBL
52    3658   45379pv.CBL    -rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL
52    3658   45386-DIGITOav5386 Jul 10  2012-DIGITO
     953    3466   43920FNG.CBL    -rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL
     956    3677   45526 PES.CBL            -rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL
     983    3857   47985PEO.CBL          -rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL
     983    3857   47985v09.CBL   -rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL
     987    3828   47865-AVV.CBL         -rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL
     989    3817   48311PLUSc.CBL         -rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL
98    3932   49201v10.CBL   -rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
11    3900   4972c.CBL   -rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
    1065    4266   54157.CBL         -rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
    1065    4266   54157 pesvnormb.cbl          -rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
    1066    4270   54196ZZ.cbl           -rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
    1069    4306   54743.CBL          -rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
    1070    4318   54855PLUS.CBL    -rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
    1134    4631   66170 icestd12.cbl     -rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
    1134    4631   66170 icestd12v09.cbl     -rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
    1694    7549  109933 P_PESVNOCSVBCS.CBL6009933 Jul 13  2010 P_PESVNOCSVBCS.CBL
    2283   10232  133784 pesvnotest.cbl  -rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    2413   10821  139052TEST.CBLrmb139052 Aug  7TEST.CBL
    2708   11391  135767CSVBCS_CAL.CBL           -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2795   10563  161516CSVTMX.CBL    -rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
    2853   12239  145451CSVBCS_p.CBL         -rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    2874   12348  146988CSVBCSv06.CBL            -rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
38   14622  182955.CBL          -rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL242   14640  183121NW1.CBL  -rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
    3275   14781  184036RMBNW-EHA.CBL    -rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
    3374   15105  188406RMBNW.CBL    -rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
    3619   16002  207161CSVBCS.CBL    -rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    3728   16478  203565 xxxxxxxxxxx.cbl    -rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
    4735   17588  277169 PESVNOSEGE2.CBL    -rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
    4954   18356  287300 PESVNOCSVSEGE-V02.CBL    -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
    5534   21248  329808 PESVNOCSVSEGE-V03.CBL          -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
    5681   22063  340872 PESVNOCSVSEGE-V04.CBL          -rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
    5773   22407  34554CSVSEGElag.CBL           -rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
    5977   23427  361326 PESVNOCSVSEGE.CBL95361326 Sep 10  2012 PESVNOCSVSEGE.CBL
      


-rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL   -rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL


   
   
   
   
   




   
   
    



   


    



   

   
   


-rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL   -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
   
   
      


      
   
   
   
   
-rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL  -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
-rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL  -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
-rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL  -rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
-rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL   -rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
        895    3326   41114 PESVNO-V02.CBL-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL899    3336   41287 P_PESVNOCSVPLUS.CBL    -rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL899    3346   41290 PESVNOGJ.CBL-rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL903    3381   41902 PESVNO-V03.CBL-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL917    3447   42753 PESVNOCSVPLUSv06.CBL   -rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL917    3462   42689 PESVNO0504.CBL-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL919    3467   42879 P_PESVNO.CBL-rw-rw-r--   1 1360     icdatacr   42879 Jul 13  2010 P_PESVNO.CBL923    3455   43051 PESVNOCSV-V05.CBL-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL929    3490   43503 PESVNOCSV_cg.CBL-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL934    4489   58108 P_PESVNOCITI.CBL-rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL939    3530   44191 PESVNOCSVv06.CBL-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL946    3422   43437 P_PESVNOCSVFNG.CBL     -rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL946    3615   44911 PESVNO-CV.CBL-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL951    4565   59253 PESVNOCITI.CBL-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL952    3658   45379 PESVNO64.CBL-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL952    3658   45379 PESVNOpv.CBL-rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL952    3658   45386 PESVNO-DIGITO.CBL-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL953    3466   43920 PESVNOCSVFNG.CBL-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL956    3677   45526 PES.CBL-rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL983    3857   47985 PESVNOPEO.CBL-rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL983    3857   47985 PESVNOv09.CBL-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL987    3828   47865 PESVNO-AVV.CBL-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL989    3817   48311 PESVNOCSVPLUSc.CBL     -rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL998    3932   49201 PESVNOv10.CBL-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
    1011    3900   49725 PESVNOCSVc.CBL-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
    1065    4266   54157 PESVNO.CBL-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
    1065    4266   54157 pesvnormb.cbl-rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
    1066    4270   54196 PESVNOZZ.cbl-rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
    1069    4306   54743 PESVNOCSV.CBL-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
    1070    4318   54855 PESVNOCSVPLUS.CBL-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
    1134    4631   66170 icestd12.cbl-rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
    1134    4631   66170 icestd12v09.cbl-rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
    1694    7549  109933 P_PESVNOCSVBCS.CBL     -rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL
    2283   10232  133784 pesvnotest.cbl-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    2413   10821  139052 PESVNOTEST.CBL-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
    2708   11391  135767 PESVNOCSVBCS_CAL.CBL   -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2795   10563  161516 PESVNOCSVTMX.CBL-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
    2853   12239  145451 PESVNOCSVBCS_p.CBL     -rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    2874   12348  146988 PESVNOCSVBCSv06.CBL    -rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
    3238   14622  182955 PESVNORMB.CBL-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
    3242   14640  183121 PESVNONW1.CBL-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
    3275   14781  184036 PESVNORMBNW-EHA.CBL    -rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
    3374   15105  188406 PESVNORMBNW.CBL-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
    3619   16002  207161 PESVNOCSVBCS.CBL-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    3728   16478  203565 xxxxxxxxxxx.cbl-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl
    4735   17588  277169 PESVNOSEGE2.CBL-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
    4954   18356  287300 PESVNOCSVSEGE-V02.CBL  -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
    5534   21248  329808 PESVNOCSVSEGE-V03.CBL  -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
    5681   22063  340872 PESVNOCSVSEGE-V04.CBL  -rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL5773   22407  345546 PESVNOCSVSEGElag.CBL   -rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL     895    3326   41114 PESVNO-V02.CBL-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL     895    3326   41114 PESVNO-V02.CBL-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL899    3336   41287 P_PESVNOCSVPLUS.CBL    -rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL899    3346   41290 PESVNOGJ.CBL-rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL903    3381   41902 PESVNO-V03.CBL-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL917    3447   42753 PESVNOCSVPLUSv06.CBL   -rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL917    3462   42689 PESVNO0504.CBL-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL919    3467   42879 P_PESVNO.CBL-rw-rw-r--   1 1360     icdatacr   42879 Jul 13  2010 P_PESVNO.CBL923    3455   43051 PESVNOCSV-V05.CBL-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL929    3490   43503 PESVNOCSV_cg.CBL-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL934    4489   58108 P_PESVNOCITI.CBL-rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL939    3530   44191 PESVNOCSVv06.CBL-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL946    3422   43437 P_PESVNOCSVFNG.CBL     -rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL946    3615   44911 PESVNO-CV.CBL-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL951    4565   59253 PESVNOCITI.CBL-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL952    3658   45379 PESVNO64.CBL-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL952    3658   45379 PESVNOpv.CBL-rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL952    3658   45386 PESVNO-DIGITO.CBL-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL953    3466   43920 PESVNOCSVFNG.CBL-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL956    3677   45526 PES.CBL-rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL983    3857   47985 PESVNOPEO.CBL-rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL983    3857   47985 PESVNOv09.CBL-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL987    3828   47865 PESVNO-AVV.CBL-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL989    3817   48311 PESVNOCSVPLUSc.CBL     -rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL998    3932   49201 PESVNOv10.CBL-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
    1011    3900   49725 PESVNOCSVc.CBL-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
    1065    4266   54157 PESVNO.CBL-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
    1065    4266   54157 pesvnormb.cbl-rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
    1066    4270   54196 PESVNOZZ.cbl-rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
    1069    4306   54743 PESVNOCSV.CBL-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
    1070    4318   54855 PESVNOCSVPLUS.CBL-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
    1134    4631   66170 icestd12.cbl-rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
    1134    4631   66170 icestd12v09.cbl-rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
    1694    7549  109933 P_PESVNOCSVBCS.CBL     -rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL
    2283   10232  133784 pesvnotest.cbl-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    2413   10821  139052 PESVNOTEST.CBL-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
    2708   11391  135767 PESVNOCSVBCS_CAL.CBL   -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2795   10563  161516 PESVNOCSVTMX.CBL-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
    2853   12239  145451 PESVNOCSVBCS_p.CBL     -rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    2874   12348  146988 PESVNOCSVBCSv06.CBL    -rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
    3238   14622  182955 PESVNORMB.CBL-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
    3242   14640  183121 PESVNONW1.CBL-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
    3275   14781  184036 PESVNORMBNW-EHA.CBL    -rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
    3374   15105  188406 PESVNORMBNW.CBL-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
    3619   16002  207161 PESVNOCSVBCS.CBL-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    3728   16478  203565 xxxxxxxxxxx.cbl-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl4735   17588  277169 PESVNOSEGE2.CBL-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
    4954   18356  287300 PESVNOCSVSEGE-V02.CBL  -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
    5534   21248  329808 PESVNOCSVSEGE-V03.CBL  -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL5681   22063  340872 PESVNOCSVSEGE-V04.CBL  -rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL     895    3326   41114 PESVNO-V02.CBL-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL    1069    4306   54743 PESVNOCSV.CBL-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL1070    4318   54855 PESVNOCSVPLUS.CBL-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
    1134    4631   66170 icestd12.cbl-rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
    1134    4631   66170 icestd12v09.cbl-rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
    1694    7549  109933 P_PESVNOCSVBCS.CBL     -rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL
    2283   10232  133784 pesvnotest.cbl-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    2413   10821  139052 PESVNOTEST.CBL-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
    2708   11391  135767 PESVNOCSVBCS_CAL.CBL   -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2795   10563  161516 PESVNOCSVTMX.CBL-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
    2853   12239  145451 PESVNOCSVBCS_p.CBL     -rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    2874   12348  146988 PESVNOCSVBCSv06.CBL    -rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
    3238   14622  182955 PESVNORMB.CBL-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
    3242   14640  183121 PESVNONW1.CBL-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
    3275   14781  184036 PESVNORMBNW-EHA.CBL    -rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
    3374   15105  188406 PESVNORMBNW.CBL-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
    3619   16002  207161 PESVNOCSVBCS.CBL-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    3728   16478  203565 xxxxxxxxxxx.cbl-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl4735   17588  277169 PESVNOSEGE2.CBL-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
    4954   18356  287300 PESVNOCSVSEGE-V02.CBL  -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
    5534   21248  329808 PESVNOCSVSEGE-V03.CBL  -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL
    5681   22063  340872 PESVNOCSVSEGE-V04.CBL  -rw-rw-r--   1 1381     icdatacr  340872 Mar 14  2011 PESVNOCSVSEGE-V04.CBL
    5773   22407  345546 PESVNOCSVSEGElag.CBL   -rw-rw-r--   1 1395     icdatacr  345546 Oct 21  2011 PESVNOCSVSEGElag.CBL
    5977   23427  361326 PESVNOCSVSEGE.CBL-rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~-rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL        -rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL    -rw-rw-r--   1 1395     icdatacr  361326 Sep 10  2012 PESVNOCSVSEGE.CBL         895    3326   41114 PESVNO-V02.CBL-rw-rw-r--   1 icjdld   icdatacr   41114 Mar 11  2010 PESVNO-V02.CBL899    3336   41287 P_PESVNOCSVPLUS.CBL    -rw-rw-r--   1 1360     icdatacr   41287 Jul 13  2010 P_PESVNOCSVPLUS.CBL899    3346   41290 PESVNOGJ.CBL-rw-rw-r--   1 icjdld   icdatacr   41290 Mar 11  2010 PESVNOGJ.CBL903    3381   41902 PESVNO-V03.CBL-rw-rw-r--   1 icjdld   icdatacr   41902 Mar 11  2010 PESVNO-V03.CBL917    3447   42753 PESVNOCSVPLUSv06.CBL   -rw-rw-r--   1 1395     icdatacr   42753 Jun 11  2013 PESVNOCSVPLUSv06.CBL917    3462   42689 PESVNO0504.CBL-rw-rw-r--   1 icehad   icdatacr   42689 May  5  2010 PESVNO0504.CBL919    3467   42879 P_PESVNO.CBL-rw-rw-r--   1 1360     icdatacr   42879 Jul 13  2010 P_PESVNO.CBL923    3455   43051 PESVNOCSV-V05.CBL-rw-rw-r--   1 iccigd   icdatacr   43051 May  3  2011 PESVNOCSV-V05.CBL929    3490   43503 PESVNOCSV_cg.CBL-rw-rw-r--   1 1395     icdatacr   43503 Jul  9  2012 PESVNOCSV_cg.CBL934    4489   58108 P_PESVNOCITI.CBL-rw-rw-r--   1 1360     icdatacr   58108 Jul 13  2010 P_PESVNOCITI.CBL939    3530   44191 PESVNOCSVv06.CBL-rw-rw-r--   1 1395     icdatacr   44191 Jun 11  2013 PESVNOCSVv06.CBL946    3422   43437 P_PESVNOCSVFNG.CBL     -rw-rw-r--   1 1360     icdatacr   43437 Jul 13  2010 P_PESVNOCSVFNG.CBL946    3615   44911 PESVNO-CV.CBL-rw-rw-r--   1 iccavd   icdatacr   44911 Jul 11  2012 PESVNO-CV.CBL951    4565   59253 PESVNOCITI.CBL-rw-rw-r--   1 1395     icdatacr   59253 Sep 10  2012 PESVNOCITI.CBL952    3658   45379 PESVNO64.CBL-rw-rw-r--   1 1395     icdatacr   45379 Jul 12  2012 PESVNO64.CBL952    3658   45379 PESVNOpv.CBL-rw-rw-r--   1 1395     icdatacr   45379 Aug 14  2012 PESVNOpv.CBL952    3658   45386 PESVNO-DIGITO.CBL-rw-rw-r--   1 iccavd   icdatacr   45386 Jul 10  2012 PESVNO-DIGITO.CBL953    3466   43920 PESVNOCSVFNG.CBL-rw-rw-r--   1 1395     icdatacr   43920 Jul  9  2012 PESVNOCSVFNG.CBL956    3677   45526 PES.CBL-rw-rw-r--   1 icrmbd   icdatacr   45526 Aug  6  2012 PES.CBL983    3857   47985 PESVNOPEO.CBL-rw-rw-r--   1 icrmbd   icdatacr   47985 Aug 15  2012 PESVNOPEO.CBL983    3857   47985 PESVNOv09.CBL-rw-rw-r--   1 1395     icdatacr   47985 Sep  4  2012 PESVNOv09.CBL987    3828   47865 PESVNO-AVV.CBL-rw-rw-r--   1 1395     icdatacr   47865 Sep 10  2012 PESVNO-AVV.CBL989    3817   48311 PESVNOCSVPLUSc.CBL     -rw-rw-r--   1 1395     icdatacr   48311 Jun 25  2013 PESVNOCSVPLUSc.CBL998    3932   49201 PESVNOv10.CBL-rw-rw-r--   1 1395     icdatacr   49201 Apr  2  2013 PESVNOv10.CBL
    1011    3900   49725 PESVNOCSVc.CBL-rw-rw-r--   1 1395     icdatacr   49725 Jun 25  2013 PESVNOCSVc.CBL
    1065    4266   54157 PESVNO.CBL-rw-rw-r--   1 1395     icdatacr   54157 Apr  4  2013 PESVNO.CBL
    1065    4266   54157 pesvnormb.cbl-rw-rw-r--   1 1381     icdatacr   54157 Jul 19  2013 pesvnormb.cbl
    1066    4270   54196 PESVNOZZ.cbl-rw-rw-r--   1 icjlud   icdatacr   54196 Jun  9 19:31 PESVNOZZ.cbl
    1069    4306   54743 PESVNOCSV.CBL-rw-rw-r--   1 1395     icdatacr   54743 Jun 25  2013 PESVNOCSV.CBL
    1070    4318   54855 PESVNOCSVPLUS.CBL-rw-rw-r--   1 1395     icdatacr   54855 Sep 24  2013 PESVNOCSVPLUS.CBL
    1134    4631   66170 icestd12.cbl-rw-rw-r--   1 iclagd   icdatacr   66170 Mar 13 08:26 icestd12.cbl
    1134    4631   66170 icestd12v09.cbl-rw-rw-r--   1 1395     icdatacr   66170 Nov 24  2011 icestd12v09.cbl
    1694    7549  109933 P_PESVNOCSVBCS.CBL     -rw-rw-r--   1 1360     icdatacr  109933 Jul 13  2010 P_PESVNOCSVBCS.CBL
    2283   10232  133784 pesvnotest.cbl-rw-rw-r--   1 icrmbd   icdatacr  133784 Aug  7  2010 pesvnotest.cbl
    2413   10821  139052 PESVNOTEST.CBL-rw-rw-r--   1 icrmbd   icdatacr  139052 Aug  7  2010 PESVNOTEST.CBL
    2708   11391  135767 PESVNOCSVBCS_CAL.CBL   -rw-rw-r--   1 1395     icdatacr  135767 Dec 15  2011 PESVNOCSVBCS_CAL.CBL
    2795   10563  161516 PESVNOCSVTMX.CBL-rw-rw-r--   1 1381     icdatacr  161516 Jun 24  2011 PESVNOCSVTMX.CBL
    2853   12239  145451 PESVNOCSVBCS_p.CBL     -rw-rw-r--   1 1395     icdatacr  145451 Jan 17  2012 PESVNOCSVBCS_p.CBL
    2874   12348  146988 PESVNOCSVBCSv06.CBL    -rw-rw-r--   1 1395     icdatacr  146988 Mar  4  2013 PESVNOCSVBCSv06.CBL
    3238   14622  182955 PESVNORMB.CBL-rw-rw-r--   1 1381     icdatacr  182955 Aug  8  2010 PESVNORMB.CBL
    3242   14640  183121 PESVNONW1.CBL-rw-rw-r--   1 icrmbd   icdatacr  183121 Aug  9  2010 PESVNONW1.CBL
    3275   14781  184036 PESVNORMBNW-EHA.CBL    -rw-rw-r--   1 icehad   icdatacr  184036 Aug 12  2010 PESVNORMBNW-EHA.CBL
    3374   15105  188406 PESVNORMBNW.CBL-rw-rw-r--   1 1381     icdatacr  188406 Sep  9  2010 PESVNORMBNW.CBL
    3619   16002  207161 PESVNOCSVBCS.CBL-rw-rw-r--   1 1395     icdatacr  207161 May 28  2013 PESVNOCSVBCS.CBL
    3728   16478  203565 xxxxxxxxxxx.cbl-rw-rw-r--   1 1381     icdatacr  203565 Oct 19  2010 xxxxxxxxxxx.cbl4735   17588  277169 PESVNOSEGE2.CBL-rw-rw-r--   1 1381     icdatacr  277169 Oct 27  2010 PESVNOSEGE2.CBL
    4954   18356  287300 PESVNOCSVSEGE-V02.CBL  -rw-rw-r--   1 1381     icdatacr  287300 Jan 24  2011 PESVNOCSVSEGE-V02.CBL
    5534   21248  329808 PESVNOCSVSEGE-V03.CBL  -rw-rw-r--   1 1381     icdatacr  329808 Feb 24  2011 PESVNOCSVSEGE-V03.CBL"qqq" [Modified] line 1 of 51 --1%-- 
:qw"qqq" 51 lines, 5773 characters 


:q/d/iccol/desarrollo/fuentes>v ^[  /d/iccol/desarrollo/fuentes>vi qqqqwc PES.CBL; ls -l PES.CBLvi qqq                   vi qqqfu      vi CARGAJUR.CBL
"CARGAJUR.CBL" 1396 lines, 59160 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************"CARGAJUR.CBL" 1396 lines, 59160 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1396 lines deletedNo lines in buffer:set noai nosmAPPEND MODE      $SET LIST SETTING LISTWIDTH"80"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDACSV.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record
APPEND MODE              file status is EST-BDIIALE.==.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      ******************************************************************
APPEND MODE       DATA DIVISION.
APPEND MODE       FILE section.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD
APPEND MODE      ******************************************************************
APPEND MODE       FD JURAD.
APPEND MODE       01  JURAD-reg.
APPEND MODE      * Registros de movimientos I, M, E
APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
APPEND MODE           03 JURAD-tipo-novedad        pic x.
APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}
APPEND MODE           03 JURAD-id-tipo             pic x.
APPEND MODE      *    Numero de identificacion
APPEND MODE           03 JURAD-id-numeroX          pic x(11).
APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX
APPEND MODE                                        pic 9(11).
APPEND MODE      *    Nombres y Apellidos
APPEND MODE           03 JURAD-nombre              pic x(45).
APPEND MODE      *    Numero de demandas vigentes
APPEND MODE           03 JURAD-demandas-vigentes   pic 999.
APPEND MODE      *    Numero de demandas terminadas
APPEND MODE           03 JURAD-demandas-terminadas pic 999.
APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD
APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).
APPEND MODE      *    Numero de embargos vigentes
APPEND MODE           03 JURAD-embargos-vigentes   pic 999.
APPEND MODE      *    Numero de embargos terminados
APPEND MODE           03 JURAD-embargos-terminados pic 999.
APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD
APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).
APPEND MODE
APPEND MODE       01  JURADT-reg.
APPEND MODE      * Registro de totales de control T
APPEND MODE      *    Tipo de Novedad = "T"
APPEND MODE           03 JURADT-tipo-novedad       pic x.
APPEND MODE           03                           pic x.
APPEND MODE      *    Cantidad de registros
APPEND MODE           03 JURADT-registros          pic 9(11).
APPEND MODE           03                           pic x.
APPEND MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa
APPEND MODE      *    Total numero de demandas vigentes
APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).
APPEND MODE           03                           pic x.
APPEND MODE      *    Total numero de demandas terminadas
APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).
APPEND MODE           03                           pic x.
APPEND MODE      *    Total numero de embargos vigentes
APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).
APPEND MODE           03                           pic x.
APPEND MODE      *    Total numero de embargos terminados
APPEND MODE           03 JURADT-embargos-terminados pic 9(7).
APPEND MODE           03                           pic x(41).
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD
APPEND MODE      ******************************************************************
APPEND MODE       FD ERRS.
APPEND MODE       01  ERRS-reg.
APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
APPEND MODE           03 ERRS-tipo-novedad         pic x.
APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}
APPEND MODE           03 ERRS-id-tipo              pic x.
APPEND MODE      *    Numero de identificacion
APPEND MODE           03 ERRS-id-numero            pic x(11).
APPEND MODE      *    Nombres y Apellidos
APPEND MODE           03 ERRS-nombre               pic x(45).
APPEND MODE      *    Numero de demandas vigentes
APPEND MODE           03 ERRS-demandas-vigentes    pic 999.
APPEND MODE      *    Numero de demandas terminadas
APPEND MODE           03 ERRS-demandas-terminadas  pic 999.
APPEND MODE      *    Fecha ultima demanda vigente YYMMDD
APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).
APPEND MODE      *    Numero de embargos vigentes
APPEND MODE           03 ERRS-embargos-vigentes    pic 999.
APPEND MODE      *    Numero de embargos terminados
APPEND MODE           03 ERRS-embargos-terminados  pic 999.
APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD
APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).
APPEND MODE      *    Causa del rechazo
APPEND MODE           03 ERRS-causa-rechazo        pic x(61).
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Contiene los ids y nombres de personas
APPEND MODE      ******************************************************************
APPEND MODE       copy BDIIREGI.FD.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada
APPEND MODE      * por la DIAN
APPEND MODE      ******************************************************************
APPEND MODE       copy BDIIDIAN.FD.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS
APPEND MODE      ******************************************************************
APPEND MODE       copy BDIIDAS.FD.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Base alterna
APPEND MODE      ******************************************************************
APPEND MODE       COPY BDACSV.FD.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Maestro de alertas reportadas por suscriptores
APPEND MODE      ******************************************************************
APPEND MODE       copy BDIIALE.FD.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE       WORKING-STORAGE section.
APPEND MODE      ******************************************************************
APPEND MODE      * Nombre del programa
APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Variables para rutina de validacion de identificaciones
APPEND MODE      ******************************************************************
APPEND MODE       copy BDIIVIDE.WS.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online
APPEND MODE      ******************************************************************
APPEND MODE       copy BDIIALE.WS.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Datos para las rutinas de validacin de nombres
APPEND MODE      ******************************************************************
APPEND MODE       copy LEEMAESTROS.WS.
APPEND MODE
APPEND MODE      *****************************************************************
APPEND MODE      * Direcciones de los archivos en el file system
APPEND MODE      *****************************************************************
APPEND MODE       copy ICFILE.WS.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo
APPEND MODE      * de entrada (normal) o alguna otra condicion (error)
APPEND MODE       01  IND-fin-proceso              pic xx value "NO".
APPEND MODE
APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".
APPEND MODE       01  JURAD-fs                     pic xx value spaces.
APPEND MODE
APPEND MODE       01  ERRS-fs                      pic xx value spaces.
APPEND MODE
APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE
APPEND MODE       01 D-datahost.
APPEND MODE           05 D-vigentes                pic 9(5).
APPEND MODE           05 D-terminados              pic 9(5).
APPEND MODE           05 D-fecha-ultima            pic x(8).
APPEND MODE      ******************************************************************
APPEND MODE      * Parametros iniciales, de la linea de comando
APPEND MODE      * La linea de comando que contiene los parametros
APPEND MODE       01 P-command-line                pic x(80) value spaces.
APPEND MODE       01 P-parametros.
APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto
APPEND MODE           03 P-proceso-real            pic x value "2".
APPEND MODE           88 PROCESO-REAL              value "1".
APPEND MODE
APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
APPEND MODE           03 P-file-name               pic x(80) value spaces.
APPEND MODE           03 P-file-name-R             redefines P-file-name.
APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian
APPEND MODE               05 P-cod-suscriptor      pic 9(6).
APPEND MODE      *        aaa = Codificacion del producto ("100")
APPEND MODE               05 P-producto            pic xxx.
APPEND MODE      *        DDMMAA = Fecha de proceso
APPEND MODE               05 P-fecha-proceso       pic x(6).
APPEND MODE      *        bb =  01 a CI
APPEND MODE               05 P-ci-bi               pic xx.
APPEND MODE      *        XX = Tipo de proceso
APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez
APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL
APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL
APPEND MODE      *        04 Refresque Total - Carga TOTAL
APPEND MODE               05 P-tipo-proceso        pic xx.
APPEND MODE      *        extension del archivo ".txt"
APPEND MODE               05 P-extension           pic x(4).
APPEND MODE               05                       pic x(57).
APPEND MODE           03 P-file-path               pic x(80) value spaces.
APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.
APPEND MODE
APPEND MODE      * Fecha de proceso editada YYYYMMDD
APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).
APPEND MODE      * Fecha de proceso + 50 aos
APPEND MODE       01 P-fecha-proceso-50.
APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.
APPEND MODE           03                           pic x(4).
APPEND MODE      ******************************************************************
APPEND MODE      * Datos para el reporte final
APPEND MODE       01 W-tiempo.
APPEND MODE           03 W-hora-inicio             pic 9(8).
APPEND MODE           03 W-hora-fin                pic 9(8).
APPEND MODE       01 N-edit                        pic z(8)B.
APPEND MODE       01 N-editp100                    redefines N-edit
APPEND MODE                                        pic z(5)9.9B.
APPEND MODE       01 N-contadores.
APPEND MODE      *    Registros en el archivo de entrada
APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.
APPEND MODE      *    Registros procesados sin error
APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.
APPEND MODE      *    Registros con error
APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.
APPEND MODE
APPEND MODE      *    Cantidades de registros por tipo de novedad
APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.
APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.
APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.
APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.
APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.
APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.
APPEND MODE
APPEND MODE      *    Alertas borradas previo al refresque total
APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.
APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.
APPEND MODE      *    Alertas insertadas
APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.
APPEND MODE      *    Alertas modificadas
APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.
APPEND MODE      *    Alertas eliminadas
APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.
APPEND MODE      *    Insercion de alerta existente
APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.
APPEND MODE      *    Modificacion o eliminacion de alerta inexistente
APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.
APPEND MODE
APPEND MODE      *    Sumas de cantidades de demandas y embargos
APPEND MODE           03 N-demandas-vigentes       pic 9(7).
APPEND MODE           03 N-demandas-terminadas     pic 9(7).
APPEND MODE           03 N-embargos-vigentes       pic 9(7).
APPEND MODE           03 N-embargos-terminados     pic 9(7).
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Armado de las lineas de alerta
APPEND MODE       01 LA-lineas-alerta.
APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un
APPEND MODE      *    archivo, como BDIIALE-ALERTAS
APPEND MODE           03 LAend                     pic 999 comp value 0.
APPEND MODE           03 LA-modelos.
APPEND MODE      *         12345678901234567890123456789012345678901234567890
APPEND MODE               05 pic x(50) value
APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
APPEND MODE               05 pic x(50) value
APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
APPEND MODE               05 pic x(50) value
APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
APPEND MODE               05 pic x(50) value
APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
APPEND MODE               05 pic x(50) value high-values. *> end marker
APPEND MODE           03 LA-modelos2               redefines LA-modelos.
APPEND MODE               05 LA-modelo             pic x(50) occurs 5
APPEND MODE                                        indexed LAm.
APPEND MODE      *    Funcionamiento de los templates.
APPEND MODE      *    Hay dos templates por de alerta, uno por linea.
APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con
APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.
APPEND MODE      *    Por ejemplo:
APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.
APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece
APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.
APPEND MODE           03 LA-templates.
APPEND MODE               05 LA-template           occurs 4 indexed LAx.
APPEND MODE                   07 LA-parte          pic x(50)
APPEND MODE                                        occurs 10 indexed LAy.
APPEND MODE      *    Las dos lineas armadas
APPEND MODE           03 LA-lineas.
APPEND MODE               05 LA-linea1             pic x(50).
APPEND MODE               05 LA-linea2             pic x(50).
APPEND MODE      *    Los valores a insertar en una linea
APPEND MODE           03 LA-valores.
APPEND MODE               05 LA-valor              pic x(50)
APPEND MODE                                        occurs 10 indexed LAv.
APPEND MODE      *    Datos para editar valores a insertar
APPEND MODE           03 LA-num                    pic -(11)0.
APPEND MODE           03 LA-numX                   redefines LA-num
APPEND MODE                                        pic x(12).
APPEND MODE           03 LA-descarte               pic x(50).
APPEND MODE
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Errores de consistencia del input
APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador
APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
APPEND MODE       01 E-errores.
APPEND MODE      *    indica si el registro actual tiene error
APPEND MODE           03 E-hay-error               pic xx value "NO".
APPEND MODE      *    errores del registro actual
APPEND MODE           03 E-errores-reg             pic x(300) value spaces.
APPEND MODE      *    contador de registros con error
APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.
APPEND MODE      *    tabla de errores
APPEND MODE           03 pic x(11) value "01 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".
APPEND MODE           03 pic x(11) value "02 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".
APPEND MODE           03 pic x(11) value "03 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Numero de identificacion invalido, debe ser numerico".
APPEND MODE           03 pic x(11) value "04 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Tipo de identificacion debe ser mayor que cero".
APPEND MODE           03 pic x(11) value "05 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Falta el nombre o denominacion".
APPEND MODE           03 pic x(11) value "06 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Numero de demandas vigentes: debe ser numerico".
APPEND MODE           03 pic x(11) value "07 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Numero de demandas terminadas: debe ser numerico".
APPEND MODE           03 pic x(11) value "08 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
APPEND MODE           03 pic x(11) value "09 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
APPEND MODE           03 pic x(11) value "10 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Numero de embargos vigentes: debe ser numerico".
APPEND MODE           03 pic x(11) value "11 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Numero de embargos terminados: debe ser numerico".
APPEND MODE           03 pic x(11) value "12 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
APPEND MODE           03 pic x(11) value "13 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
APPEND MODE           03 pic x(11) value "14 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "El numero de id no se encuentra en el archivo maestro".
APPEND MODE           03 pic x(11) value "15 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "El nombre en el input no coincide con el registrado".
APPEND MODE           03 pic x(11) value "16 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Numero de id fuera del rango del tipo de id informado".
APPEND MODE           03 pic x(11) value "17 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Modificacin de alerta inexistente".
APPEND MODE           03 pic x(11) value "18 0000000 ".
APPEND MODE           03 pic x(59) value
APPEND MODE           "Eliminacin de alerta inexistente".
APPEND MODE      *----------------- insertar nuevos items aqui -------------------
APPEND MODE           03 pic x(11) value "00 0000000 ".
APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".
APPEND MODE           03                           pic x(3500). *> los 50 items
APPEND MODE       01 E-errores-2                   redefines E-errores.
APPEND MODE           03                           pic xx.
APPEND MODE           03                           pic x(300).
APPEND MODE           03                           pic 9(8).
APPEND MODE           03 E-error                   occurs 50 indexed Ex.
APPEND MODE               05 E-codigo              pic xx.
APPEND MODE               05                       pic x.
APPEND MODE               05 E-contador            pic 9(7).
APPEND MODE               05                       pic x.
APPEND MODE               05 E-descripcion         pic x(59).
APPEND MODE       01 E-edit                        pic z(8)B.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      * Control de rangos de valores de las fechas del input
APPEND MODE       01 VALIDACIONES-FECHAS.
APPEND MODE           02 ANO-VAL-X                 pic 9(04).
APPEND MODE              88 ANO-VAL                value 1900 thru 2050.
APPEND MODE           02 MES-VAL-X                 pic 9(02).
APPEND MODE              88 MES-VAL                value 01   thru 12.
APPEND MODE           02 DIA-VAL-X                 pic 9(02).
APPEND MODE              88 DIA-VAL                value 01   thru 31.
APPEND MODE
APPEND MODE
APPEND MODE      /*****************************************************************
APPEND MODE      ******************************************************************
APPEND MODE       PROCEDURE DIVISION.
APPEND MODE
APPEND MODE      * 0000-PROGRAMA-PRINCIPAL
APPEND MODE      * 4000-PROCESAR-REGISTRO
APPEND MODE      * 4000-PROCESAR-REGISTRO-2
APPEND MODE      * 4100-VALIDACION-FORMAL
APPEND MODE      * 4200-VALIDACION-SEMANTICA
APPEND MODE      * 4300-MODIFICAR-BDIIALE
APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS
APPEND MODE      * 4300-MODIFICAR-BDIIALE-I
APPEND MODE      * 4300-MODIFICAR-BDIIALE-M
APPEND MODE      * 4300-MODIFICAR-BDIIALE-E
APPEND MODE      * 4333-LEER-BDIIALE-RANDOM
APPEND MODE      * 4333-GRABAR-BDIIALE
APPEND MODE      * 4333-REGRABAR-BDIIALE
APPEND MODE      * 4333-ELIMINAR-BDIIALE
APPEND MODE      * 4800-PROCESO-REG-T
APPEND MODE      * 4900-GRABAR-ERROR
APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA
APPEND MODE      * 1000-RUTINA-INICIAL
APPEND MODE      * 1022-CARGAR-INCONSISTENTES
APPEND MODE      * 1000-NOT-USED
APPEND MODE      * 1001-ELIMINAR-TODO
APPEND MODE      * 7000-RUTINA-FINAL
APPEND MODE      * 9000-CANCELAR-PROGRAMA
APPEND MODE
APPEND MODE
APPEND MODE       0000-PROGRAMA-PRINCIPAL.
APPEND MODE      ******************************************************************
APPEND MODE      *    inicializa el ambiente y abre los archivos
APPEND MODE           perform 1000-RUTINA-INICIAL
APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta
APPEND MODE      *    encontrar el registro "T" de totales
APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
APPEND MODE      *    cierra archivos y produce el reporte final
APPEND MODE           perform 7000-RUTINA-FINAL
APPEND MODE           goback.
APPEND MODE
APPEND MODE       4000-PROCESAR-REGISTRO.
APPEND MODE      ****************************************************************
APPEND MODE      * Proceso de un registro del archivo de entrada JURAD
APPEND MODE      * Lectura y control del file status del archivo
APPEND MODE      ****************************************************************
APPEND MODE      *    lectura del proximo registro
APPEND MODE           read JURAD
APPEND MODE           evaluate JURAD-fs
APPEND MODE           when "00"
APPEND MODE      *        controla el reg y lo aplica si es OK
APPEND MODE               perform 4000-PROCESAR-REGISTRO-2
APPEND MODE               move JURAD-reg to JURAD-reg-anterior
APPEND MODE           when "10"
APPEND MODE      *        fin del archivo de input:
APPEND MODE      *        esto es un error, no se encontro el registro "T" antes
APPEND MODE      *        de que se terminara el archivo
APPEND MODE               display "Falta el reg de totales del archivo JURAD "
APPEND MODE               display "Nombre del archivo: " P-file-name
APPEND MODE               display "File status: " JURAD-fs
APPEND MODE               display "Ultimo registro leido: " N-reg-leidos
APPEND MODE               display JURAD-reg-anterior
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           when other
APPEND MODE      *        error de lectura: cancelacion del proceso
APPEND MODE               display "Error en lectura del archivo JURAD "
APPEND MODE               display "Nombre del archivo: " P-file-name
APPEND MODE               display "File status: " JURAD-fs
APPEND MODE               display "Ultimo registro leido: " N-reg-leidos
APPEND MODE               display JURAD-reg-anterior
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE
APPEND MODE       4000-PROCESAR-REGISTRO-2.
APPEND MODE      ****************************************************************
APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa
APPEND MODE      * para actualizar el archivo de alertas en linea
APPEND MODE      * La informacion esta leida en JURAD-reg
APPEND MODE      ****************************************************************
APPEND MODE           move "NO" to E-hay-error
APPEND MODE
APPEND MODE      *    validacion del tipo de movimiento
APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"
APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE
APPEND MODE      *    si es el registro "T" hay que sealar el fin de proceso
APPEND MODE           if JURAD-tipo-novedad = "T"
APPEND MODE               move "SI" to IND-fin-proceso
APPEND MODE               perform 4800-PROCESO-REG-T
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE
APPEND MODE           add 1 to N-reg-leidos
APPEND MODE
APPEND MODE      *    validacion formal de los datos
APPEND MODE           move 0 to codigo-error
APPEND MODE           perform 4100-VALIDACION-FORMAL
APPEND MODE           if E-hay-error = "SI"
APPEND MODE               perform 4900-GRABAR-ERROR
APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE
APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica
APPEND MODE           perform 4200-VALIDACION-SEMANTICA
APPEND MODE           if E-hay-error = "SI"
APPEND MODE               perform 4900-GRABAR-ERROR
APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE
APPEND MODE           perform 4200-CONTAR-TIPO-CUENTA
APPEND MODE
APPEND MODE      *    intento de actualizacion de BDIIALE
APPEND MODE           perform 4300-MODIFICAR-BDIIALE
APPEND MODE           add 1 to N-reg-OK.
APPEND MODE
APPEND MODE
APPEND MODE
APPEND MODE       4100-VALIDACION-FORMAL.
APPEND MODE      ******************************************************************
APPEND MODE      * Validacion formal de los datos del input
APPEND MODE      ******************************************************************
APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}
APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"
APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores
APPEND MODE               move 05 to codigo-error
APPEND MODE           end-if
APPEND MODE      *    Numero de identificacion
APPEND MODE           if JURAD-id-numeroX is not numeric
APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE           if JURAD-id-numero not > 0
APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes
APPEND MODE      *    no se controlan
APPEND MODE           if JURAD-tipo-novedad = "E"
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE      *    Nombres y Apellidos
APPEND MODE           if JURAD-nombre = spaces
APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    Numero de demandas vigentes
APPEND MODE           if JURAD-demandas-vigentes is not numeric
APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    Numero de demandas terminadas
APPEND MODE           if JURAD-demandas-terminadas is not numeric
APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    Fecha ultima demanda vigente YYMMDD
APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric
APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL
APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    Numero de embargos vigentes
APPEND MODE           if JURAD-embargos-vigentes not numeric
APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    Numero de embargos terminados
APPEND MODE           if JURAD-embargos-terminados not numeric
APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD
APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric
APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL
APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores
APPEND MODE           end-if.
APPEND MODE
APPEND MODE
APPEND MODE       4200-VALIDACION-SEMANTICA.
APPEND MODE      ****************************************************************
APPEND MODE      * Validacion del numero de identificacion y de su relacion con
APPEND MODE      * el nombre
APPEND MODE      ****************************************************************
APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE
APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE
APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE
APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3
APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE
APPEND MODE           END-IF
APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE
APPEND MODE      *    Valida el numero de identificacin contra las bases de
APPEND MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,
APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado
APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error
APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION
APPEND MODE      *    a ver si la validacion cambio el tipo de ide
APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE
APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores
APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "
APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero
APPEND MODE           end-if
APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
APPEND MODE           if SW-ID-BDIIVIDE = 1
APPEND MODE      *        es un id invlido
APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores
APPEND MODE      *        valida contra la base alterna
APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores
APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA
APPEND MODE           else
APPEND MODE      *        existe id, a ver si el nombre coincide
APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores
APPEND MODE                   display "novedad:  " JURAD-nombre
APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE
APPEND MODE      *            validacin en base alterna
APPEND MODE                   perform 4220-VALIDACION-NOMBRE-NO-COINCIDE
APPEND MODE               end-if
APPEND MODE           end-if.
APPEND MODE
APPEND MODE
APPEND MODE       4220-VALIDACION-NOMBRE-NO-COINCIDE.
APPEND MODE      ******************************************************************
APPEND MODE      * Validacin de IDs que figuran OK pero el nombre no coincide
APPEND MODE      ******************************************************************
APPEND MODE      >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
APPEND MODE      * >>>> EDITANDO AC: falta integrar la parte cuando el nombre s
APPEND MODE      * coincide, que no hace nada
APPEND MODE      >>>>>>>>>>>>>>>>>>>>>>>>>>>>>
APPEND MODE           IF TIPOID-E = 1
APPEND MODE      *        es una cdula, nombre no coincide
APPEND MODE               PERFORM 810-BUSCAR-MUNICIPIO
APPEND MODE      *        MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC
APPEND MODE      *        MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INC
APPEND MODE               MOVE FECHA-EXP-BDIIREGI TO FECHA-2000
APPEND MODE               IF ANO-2000-R > 51
APPEND MODE                   ADD 1900 TO ANO-2000-R
APPEND MODE               ELSE
APPEND MODE                   ADD 2000 TO ANO-2000-R
APPEND MODE               END-IF
APPEND MODE               MOVE IND-SEXO-BDIIREGI TO GENERO-VAL
APPEND MODE               PERFORM 505-RANGO-EDADES
APPEND MODE               MOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INC
APPEND MODE               IF ESTADO-VIG-BDIIREGI = 12 OR = 27
APPEND MODE                   MOVE "00" TO VIG-VAL VIG-INC
APPEND MODE               ELSE
APPEND MODE                   MOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INC
APPEND MODE               END-IF
APPEND MODE               MOVE 02 TO CODIGO-ERROR CODERR-INC
APPEND MODE               MOVE 1 TO SW-ERROR
APPEND MODE               PERFORM 510-ESCRIBIR-INCONS
APPEND MODE               ADD 1 TO NO-COINCIDE-REGIS
APPEND MODE
APPEND MODE           ELSE
APPEND MODE
APPEND MODE      *        no es una cdula
APPEND MODE               MOVE 01 TO CODIGO-ERROR CODERR-INC
APPEND MODE               MOVE 1 TO SW-ERROR
APPEND MODE               PERFORM 512-CREE-REGISTRO
APPEND MODE               WRITE REG-INCONS
APPEND MODE               ADD 1 TO NO-COINCIDE-DIAN
APPEND MODE               IF TIPOID-E = 4
APPEND MODE                   MOVE NACIO-BDIIDAS TO MUN-EXP-INC
APPEND MODE               END-IF
APPEND MODE
APPEND MODE
APPEND MODE           END-IF.
APPEND MODE
APPEND MODE
APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.
APPEND MODE      ******************************************************************
APPEND MODE      * Validacin de IDs que no figuran en las bases normales
APPEND MODE      ******************************************************************
APPEND MODE           MOVE 0 TO HACER-MATCH
APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH
APPEND MODE      *    valida si la identificacin est en la base de datos
APPEND MODE      *    alterna
APPEND MODE           PERFORM 513-VALIDA-EN-CSV
APPEND MODE           IF IDE-TIPO-BDAMATCH = 0
APPEND MODE               IF TIP-IDE-BDIIVIDE = 1
APPEND MODE      *            es una cdula
APPEND MODE                   MOVE 04 TO CODIGO-ERROR
APPEND MODE               lse
APPEND MODE      *            no es una cdula
APPEND MODE                   MOVE 03 TO CODIGO-ERROR
APPEND MODE               END-IF
APPEND MODE           END-IF.
APPEND MODE
APPEND MODE
APPEND MODE       4300-MODIFICAR-BDIIALE.
APPEND MODE      ******************************************************************
APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,
APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y
APPEND MODE      * embargos
APPEND MODE      ******************************************************************
APPEND MODE           initialize REG-BDIIALE
APPEND MODE
APPEND MODE      *    si hay demandas
APPEND MODE           if JURAD-demandas-vigentes > zero
APPEND MODE           or JURAD-demandas-terminadas > zero
APPEND MODE               move "J001" to LLASEC-BDIIALE
APPEND MODE      *        arma datos de demandas
APPEND MODE               move JURAD-demandas-vigentes to D-vigentes
APPEND MODE               move JURAD-demandas-terminadas to D-terminados
APPEND MODE               string "20" JURAD-demandas-fecha-ultima
APPEND MODE               delimited size into D-fecha-ultima
APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS
APPEND MODE           end-if.
APPEND MODE
APPEND MODE      *    si hay embargos
APPEND MODE           if JURAD-embargos-vigentes > zero
APPEND MODE           or JURAD-embargos-terminados > zero
APPEND MODE               move "J002" to LLASEC-BDIIALE
APPEND MODE      *        arma datos de embargos
APPEND MODE               move JURAD-embargos-vigentes to D-vigentes
APPEND MODE               move JURAD-embargos-terminados to D-terminados
APPEND MODE               string "20" JURAD-embargos-fecha-ultimo
APPEND MODE               delimited size into D-fecha-ultima
APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS
APPEND MODE           end-if.
APPEND MODE
APPEND MODE
APPEND MODE
APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.
APPEND MODE      ******************************************************************
APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion
APPEND MODE      * del mismo que es comun a demandas y embargos
APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
APPEND MODE      ******************************************************************
APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK
APPEND MODE      *    el file status de BDIIALE queda con "00"
APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM
APPEND MODE
APPEND MODE      *    procesa segun el tipo de novedad I M E
APPEND MODE           evaluate JURAD-tipo-novedad
APPEND MODE           when "I"
APPEND MODE               add 1 to N-reg-tipo-I-OK
APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I
APPEND MODE           when "M"
APPEND MODE               add 1 to N-reg-tipo-M-OK
APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M
APPEND MODE           when "E"
APPEND MODE               add 1 to N-reg-tipo-E-OK
APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E
APPEND MODE           when other
APPEND MODE      *        esto es "imposible" por control de consistencia anterior
APPEND MODE               display "error de logica: tipo-novedad="
APPEND MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos
APPEND MODE               display "Registro de JURAD: " display JURAD-reg
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE
APPEND MODE       4300-MODIFICAR-BDIIALE-I.
APPEND MODE      ******************************************************************
APPEND MODE      * Insercion de una alerta nueva
APPEND MODE      * Si ya existia muestra un mensaje y continua
APPEND MODE      ******************************************************************
APPEND MODE      *    si el registro existia es un error
APPEND MODE           if EST-BDIIALE = "00"
APPEND MODE               display "Insercion de alerta nueva que ya existe "
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Registro de input: "
APPEND MODE               display JURAD-reg
APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
APPEND MODE               add 1 to N-ale-ya-existe
APPEND MODE           end-if
APPEND MODE
APPEND MODE      *    completa los datos del registro
APPEND MODE           initialize ENCABEZADO-BDIIALE
APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
APPEND MODE           FEC-REP-BDIIALE
APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE
APPEND MODE           move 0 to BLOQUEO-BDIIALE
APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE
APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA
APPEND MODE           if EST-BDIIALE = "00"
APPEND MODE               perform 4333-REGRABAR-BDIIALE
APPEND MODE           else
APPEND MODE               perform 4333-GRABAR-BDIIALE
APPEND MODE           end-if.
APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
APPEND MODE      *    " fs:" EST-BDIIALE.
APPEND MODE
APPEND MODE
APPEND MODE       4300-MODIFICAR-BDIIALE-M.
APPEND MODE      ******************************************************************
APPEND MODE      * Modificacion de una alerta existente
APPEND MODE      * Si no existia muestra un mensaje y continua
APPEND MODE      ******************************************************************
APPEND MODE      *    si el registro no existia es un error
APPEND MODE           if EST-BDIIALE not = "00"
APPEND MODE               display "Modificacion de alerta inexistente "
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Registro de input: "
APPEND MODE               display JURAD-reg
APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
APPEND MODE               add 1 to N-ale-no-existe
APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores
APPEND MODE           end-if
APPEND MODE      *    reemplaza la fecha de reporte y los valores
APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE
APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE
APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA
APPEND MODE           if EST-BDIIALE = "00"
APPEND MODE               perform 4333-REGRABAR-BDIIALE
APPEND MODE           else
APPEND MODE               perform 4333-GRABAR-BDIIALE
APPEND MODE           end-if.
APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
APPEND MODE      *    " fs:" EST-BDIIALE.
APPEND MODE
APPEND MODE
APPEND MODE       4300-MODIFICAR-BDIIALE-E.
APPEND MODE      ******************************************************************
APPEND MODE      * Eliminacion de una alerta
APPEND MODE      * Si no existia muestra un mensaje y continua
APPEND MODE      ******************************************************************
APPEND MODE      *    elimina el registro
APPEND MODE           if EST-BDIIALE = "00"
APPEND MODE               perform 4333-ELIMINAR-BDIIALE
APPEND MODE           else
APPEND MODE               display "Eliminacion de alerta inexistente "
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Registro de input: "
APPEND MODE               display JURAD-reg
APPEND MODE               add 1 to N-ale-no-existe
APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores
APPEND MODE           end-if.
APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
APPEND MODE      *    " fs:" EST-BDIIALE.
APPEND MODE
APPEND MODE
APPEND MODE       4333-LEER-BDIIALE-RANDOM.
APPEND MODE      ******************************************************************
APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE
APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado
APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
APPEND MODE      ******************************************************************
APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE
APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE
APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE
APPEND MODE           move 000 to COD-ALERTA-BDIIALE
APPEND MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002
APPEND MODE
APPEND MODE           read BDIIALE
APPEND MODE           evaluate EST-BDIIALE
APPEND MODE           when "00"
APPEND MODE               continue
APPEND MODE           when "23"
APPEND MODE               continue
APPEND MODE           when other
APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Ultimo registro procesado: "
APPEND MODE               display JURAD-reg-anterior
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
APPEND MODE      *    " fs:" EST-BDIIALE.
APPEND MODE
APPEND MODE
APPEND MODE       4333-GRABAR-BDIIALE.
APPEND MODE      ******************************************************************
APPEND MODE      * Inserta un registro nuevo en BDIIALE
APPEND MODE      ******************************************************************
APPEND MODE           if not PROCESO-REAL
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE           write REG-BDIIALE
APPEND MODE           evaluate EST-BDIIALE
APPEND MODE           when "00"
APPEND MODE               add 1 to N-ale-insertadas
APPEND MODE           when other
APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Registro BDIIALE: "
APPEND MODE               display REG-BDIIALE
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE
APPEND MODE       4333-REGRABAR-BDIIALE.
APPEND MODE      ******************************************************************
APPEND MODE      * Regraba un registro modificado en BDIIALE
APPEND MODE      ******************************************************************
APPEND MODE           if not PROCESO-REAL
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE           rewrite REG-BDIIALE
APPEND MODE           evaluate EST-BDIIALE
APPEND MODE           when "00"
APPEND MODE               add 1 to N-ale-modificadas
APPEND MODE           when other
APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Registro BDIIALE: "
APPEND MODE               display REG-BDIIALE
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE
APPEND MODE       4333-ELIMINAR-BDIIALE.
APPEND MODE      ******************************************************************
APPEND MODE      * Elimina un registro de BDIIALE
APPEND MODE      ******************************************************************
APPEND MODE           if not PROCESO-REAL
APPEND MODE               exit paragraph
APPEND MODE           end-if
APPEND MODE           delete BDIIALE
APPEND MODE           evaluate EST-BDIIALE
APPEND MODE           when "00"
APPEND MODE               add 1 to N-ale-eliminadas
APPEND MODE           when other
APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE
APPEND MODE               " key: " LLAVE-BDIIALE
APPEND MODE               display "Registro BDIIALE: "
APPEND MODE               display REG-BDIIALE
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE       4800-PROCESO-REG-T.
APPEND MODE      ******************************************************************
APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales
APPEND MODE      * de control, y debera ser el ultimo del archivo
APPEND MODE      ******************************************************************
APPEND MODE      * Control de los totales calculados contra los esperados
APPEND MODE           move "NO" to E-hay-error
APPEND MODE      *    cantidad de registros I M E
APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos
APPEND MODE               continue
APPEND MODE           else
APPEND MODE               display " "
APPEND MODE               display "No coincide la cantidad de registros:"
APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos
APPEND MODE               move "SI" to E-hay-error
APPEND MODE           end-if
APPEND MODE
APPEND MODE      *    Sumas de cantidades de demandas y embargos
APPEND MODE           if function numval(JURADT-demandas-terminadas)
APPEND MODE           = N-demandas-terminadas
APPEND MODE               continue
APPEND MODE           else
APPEND MODE               display " "
APPEND MODE               display "No coincide total de demandas terminadas:"
APPEND MODE               JURADT-demandas-terminadas " con el calculado:"
APPEND MODE               N-demandas-terminadas
APPEND MODE               move "SI" to E-hay-error
APPEND MODE           end-if
APPEND MODE
APPEND MODE           if function numval(JURADT-embargos-vigentes)
APPEND MODE           = N-embargos-vigentes
APPEND MODE               continue
APPEND MODE           else
APPEND MODE               display " "
APPEND MODE               display "No coincide total de embargos vigentes:"
APPEND MODE               JURADT-embargos-vigentes " con el calculado:"
APPEND MODE               N-embargos-vigentes
APPEND MODE               move "SI" to E-hay-error
APPEND MODE           end-if
APPEND MODE
APPEND MODE           if function numval(JURADT-embargos-terminados)
APPEND MODE           = N-embargos-terminados
APPEND MODE               continue
APPEND MODE           else
APPEND MODE               display " "
APPEND MODE               display "No coincide total de embargos terminados:"
APPEND MODE               JURADT-embargos-terminados " con el calculado:"
APPEND MODE               N-embargos-terminados
APPEND MODE               move "SI" to E-hay-error
APPEND MODE           end-if.
APPEND MODE
APPEND MODE      *    si hubo cualquier cosa se invalida el proceso
APPEND MODE           if E-hay-error = "SI"
APPEND MODE               display "Error en registro T de totales de control"
APPEND MODE               display "Nombre del archivo: " ERRS-file-name
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-if.
APPEND MODE
APPEND MODE
APPEND MODE       4900-GRABAR-ERROR.
APPEND MODE      ******************************************************************
APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS
APPEND MODE      * con indicacion del error detectado
APPEND MODE      ******************************************************************
APPEND MODE           move JURAD-reg to ERRS-reg
APPEND MODE           move E-errores-reg to ERRS-causa-rechazo
APPEND MODE      *    lista de los codigos de los errores del registro
APPEND MODE           move E-errores-reg to ERRS-causa-rechazo
APPEND MODE           write ERRS-reg
APPEND MODE           evaluate ERRS-fs
APPEND MODE               when "00"
APPEND MODE                   continue
APPEND MODE               when other
APPEND MODE                   display "Error al grabar el archivo de errores "
APPEND MODE                   display "Nombre del archivo: " ERRS-file-name
APPEND MODE                   display "File status: " ERRS-fs
APPEND MODE                   perform 9000-CANCELAR-PROGRAMA
APPEND MODE                   goback
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE
APPEND MODE       4320-ARMAR-TEXTO-ALERTA.
APPEND MODE      ****************************************************************
APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates
APPEND MODE      * de las linea de alerta que corresponde
APPEND MODE      ****************************************************************
APPEND MODE      *    segun se trate de demandas o embargos
APPEND MODE           if JURAD-demandas-vigentes not = 0
APPEND MODE           or JURAD-demandas-terminadas not = 0
APPEND MODE               set LAx to 1
APPEND MODE               move high-values to LA-valores
APPEND MODE               move JURAD-demandas-vigentes to LA-num
APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile
APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)
APPEND MODE      *        delimited by all space
APPEND MODE               move LA-numx(9:12) to LA-valor(1)
APPEND MODE               move JURAD-demandas-terminadas to LA-num
APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile
APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)
APPEND MODE      *        delimited by all space
APPEND MODE               move LA-numx(9:12) to LA-valor(2)
APPEND MODE
APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile
APPEND MODE      * >>>> da error en el end-if
APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)
APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)
APPEND MODE      *        delimited by high-value
APPEND MODE           end-if.
APPEND MODE
APPEND MODE
APPEND MODE       1000-RUTINA-INICIAL.
APPEND MODE      ******************************************************************
APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo
APPEND MODE      * del programa:
APPEND MODE      *   - obtencion de los parametros
APPEND MODE      *   - apertura del archivo de entrada
APPEND MODE      *   - apertura de todos los demas archivos
APPEND MODE      *   - eliminacion de datos existentes si es refresque completo
APPEND MODE      *   - carga en memoria de los IDs de inconsistentes
APPEND MODE      ******************************************************************
APPEND MODE      * Registra hora de inicio
APPEND MODE           accept W-hora-inicio from time
APPEND MODE
APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el
APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),
APPEND MODE      * el indicador de proceso real o en falso (default)
APPEND MODE           accept P-command-line from COMMAND-LINE
APPEND MODE           display "Parametros: " P-command-line
APPEND MODE           unstring P-command-line delimited by all " " into
APPEND MODE           P-file-name P-proceso-real
APPEND MODE
APPEND MODE      * El programa se anuncia en la consola
APPEND MODE      * TODO: se usa un anuncio mas vistoso?
APPEND MODE           if PROCESO-REAL
APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"
APPEND MODE           else
APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"
APPEND MODE           end-if
APPEND MODE
APPEND MODE      * El indicador de proceso real debe ser 1 o 2
APPEND MODE           if P-proceso-real not = "1" and "2"
APPEND MODE               display "El indicador de proceso real es invalido"
APPEND MODE               display "debe ser 1 o 2"
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-if
APPEND MODE
APPEND MODE      * TODO: controlar los componentes del filename
APPEND MODE           evaluate P-tipo-proceso
APPEND MODE           when "01"
APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"
APPEND MODE           when "02"
APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"
APPEND MODE           when "03"
APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"
APPEND MODE           when "04"
APPEND MODE               display "04 Refresque Total - Carga TOTAL"
APPEND MODE           when other
APPEND MODE      *        valor invalido
APPEND MODE               display "El tipo de proceso " P-tipo-proceso
APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"
APPEND MODE               perform 9000-CANCELAR-PROGRAMA
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato
APPEND MODE      * YYYYMMDD
APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
APPEND MODE           P-fecha-proceso(1:2) delimited size
APPEND MODE           into P-fecha-proceso-YYYYMMDD
APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
APPEND MODE
APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso
APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
APPEND MODE           add 50 to P-fecha-proceso-50YYYY
APPEND MODE
APPEND MODE      * Apertura del archivo de entrada
APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path
APPEND MODE           open input JURAD
APPEND MODE           evaluate JURAD-fs
APPEND MODE               when "00"
APPEND MODE                    continue
APPEND MODE               when other
APPEND MODE                   display "Error en open del archivo JURAD "
APPEND MODE                   display "Path del archivo: " P-file-path
APPEND MODE                   display "File status: " JURAD-fs
APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna
APPEND MODE                   goback
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE      * Apertura del archivo de errores
APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"
APPEND MODE           into ERRS-file-name
APPEND MODE           open output ERRS
APPEND MODE           evaluate ERRS-fs
APPEND MODE               when "00"
APPEND MODE                    continue
APPEND MODE               when other
APPEND MODE                   display "Error en open del archivo de errores "
APPEND MODE                   display "Nombre del archivo: " ERRS-file-name
APPEND MODE                   display "File status: " ERRS-fs
APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna
APPEND MODE                   goback
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE      * Apertura de los archivos maestros
APPEND MODE      * TODO: falta capturar el status de estas operaciones?
APPEND MODE           open input BDIIREGI
APPEND MODE           open input BDIIDIAN
APPEND MODE           open input BDIIDAS.
APPEND MODE
APPEND MODE      * Apertura del archivo de alertas en linea
APPEND MODE           if PROCESO-REAL
APPEND MODE               open i-o BDIIALE
APPEND MODE           else
APPEND MODE               open input BDIIALE
APPEND MODE           end-if.
APPEND MODE
APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros
APPEND MODE      * de Jurad existentes
APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL
APPEND MODE               perform 1001-ELIMINAR-TODO
APPEND MODE           end-if.
APPEND MODE
APPEND MODE
APPEND MODE       1000-NOT-USED.
APPEND MODE      ******************************************************************
APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en
APPEND MODE      * blanco, me parece que se deberan cargar, aunque sea de manera
APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs
APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta
APPEND MODE      * que se ejecute el programa que genera los textos.
APPEND MODE      ******************************************************************
APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver
APPEND MODE      * >>>> por ahora esta anulado
APPEND MODE      ******************************************************************
APPEND MODE      * Carga de los templates para armar el texto de alertas
APPEND MODE      * TODO: por ahora los templates son literales
APPEND MODE           set LAx to 0
APPEND MODE           move high-values to LA-templates
APPEND MODE           perform varying LAm from 1 by 1
APPEND MODE           until LA-modelo(LAm) = high-values
APPEND MODE               set LAx up by 1
APPEND MODE      *        separa las partes de la linea
APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)
APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
APPEND MODE      *        delimited by all "&"
APPEND MODE      *        prepara para omitir los espacios al final de c/parte
APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10
APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing
APPEND MODE                   spaces by high-values
APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first
APPEND MODE                   high-value by space
APPEND MODE               end-perform
APPEND MODE           end-perform.
APPEND MODE
APPEND MODE
APPEND MODE       1001-ELIMINAR-TODO.
APPEND MODE      ******************************************************************
APPEND MODE      * Elimina los registros de alertas existentes en el archivo de
APPEND MODE      * alertas en linea, previo a un refresque total
APPEND MODE      ******************************************************************
APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"
APPEND MODE      *    posiciona en el primer reg de JURAD
APPEND MODE           move zero to TIP-IDE-BDIIALE
APPEND MODE           move zero to NUM-IDE-BDIIALE
APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE
APPEND MODE           move zeros to COD-ALERTA-BDIIALE
APPEND MODE           move low-values to LLASEC-BDIIALE
APPEND MODE           start BDIIALE key > LLAVE-BDIIALE
APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE
APPEND MODE           evaluate EST-BDIIALE
APPEND MODE           when "00"
APPEND MODE      *        posicionado
APPEND MODE               continue
APPEND MODE           when other
APPEND MODE      *        no hay registros
APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE
APPEND MODE               exit paragraph
APPEND MODE           end-evaluate.
APPEND MODE
APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD
APPEND MODE      *    hasta el fin del archivo
APPEND MODE           perform until EST-BDIIALE not = "00"
APPEND MODE               read BDIIALE next record
APPEND MODE               evaluate EST-BDIIALE
APPEND MODE               when "00"
APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE
APPEND MODE      *            " k:" LLAVE-BDIIALE
APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor
APPEND MODE      *                es un alerta de JURAD
APPEND MODE                       delete BDIIALE
APPEND MODE                       if EST-BDIIALE = "00"
APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE
APPEND MODE                           add 1 to N-ale-borradas
APPEND MODE                       else
APPEND MODE      *                    error en la eliminacion
APPEND MODE                           display "Error al eliminar un registro de "
APPEND MODE                           "BDIIALE vaciando los datos"
APPEND MODE                           display "Clave: " LLAVE-BDIIALE
APPEND MODE                           display "Reg borrados: " N-ale-borradas
APPEND MODE                           perform 9000-CANCELAR-PROGRAMA
APPEND MODE                       end-if
APPEND MODE                   end-if
APPEND MODE               when "10"
APPEND MODE      *            fin de archivo: sale normalmente
APPEND MODE                   display "Fin de los registros a eliminar - ledos:"
APPEND MODE                   N-ale-leidas
APPEND MODE               when other
APPEND MODE      *            lectura anormal: cancelacion del programa
APPEND MODE                   display "Error en lectura del archivo de alertas "
APPEND MODE                   "online"
APPEND MODE                   display "File status: " EST-BDIIALE
APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna
APPEND MODE               end-evaluate
APPEND MODE           end-perform.
APPEND MODE           display "Termino la eliminacion total de JURAD"
APPEND MODE           display "Reg borrados: " N-ale-borradas.
APPEND MODE
APPEND MODE
APPEND MODE       7000-RUTINA-FINAL.
APPEND MODE      ******************************************************************
APPEND MODE      * Registra hora de finalizacion
APPEND MODE           accept W-hora-fin from time
APPEND MODE
APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"
APPEND MODE
APPEND MODE      * Close todos los archivos
APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
APPEND MODE
APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
APPEND MODE      * Emision de contadores de registros
APPEND MODE           display " "
APPEND MODE           display "Totales de registros:"
APPEND MODE           display " "
APPEND MODE      *    porcentaje registros procesados OK
APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos
APPEND MODE           display N-editp100 "% de registros correctos"
APPEND MODE      *    porcentaje registros inconsistentes
APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
APPEND MODE           / N-reg-leidos
APPEND MODE           display N-editp100 "% de registros inconsistentes"
APPEND MODE      *    cantidad de registros ledos (excludo el registro "T")
APPEND MODE           move N-reg-leidos to N-edit
APPEND MODE           display N-edit "Registros IME en el archivo de entrada"
APPEND MODE      *    cantidad de registros procesados sin error
APPEND MODE           move N-reg-OK to N-edit
APPEND MODE           display N-edit "Registros procesados sin error"
APPEND MODE
APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
APPEND MODE      * definicion de estos contadores
APPEND MODE      *    move N-reg-tipo-I-OK to N-edit
APPEND MODE      *    display N-edit "Registros tipo I aceptados"
APPEND MODE      *    move N-reg-tipo-M-OK to N-edit
APPEND MODE      *    display N-edit "Registros tipo M aceptados"
APPEND MODE      *    move N-reg-tipo-E-OK to N-edit
APPEND MODE      *    display N-edit "Registros tipo E aceptados"
APPEND MODE
APPEND MODE      *    cantidad de registros con error
APPEND MODE           move E-cont-regs-con-error to N-reg-con-error
APPEND MODE           move N-reg-con-error to N-edit
APPEND MODE           display N-edit "Registros con error"
APPEND MODE      *    cantidades de alertas afectadas
APPEND MODE           if P-tipo-proceso = "04"
APPEND MODE               move N-ale-borradas to N-edit
APPEND MODE               display N-edit
APPEND MODE               "Alertas borradas previo al refresque total"
APPEND MODE           end-if
APPEND MODE           move N-ale-insertadas to N-edit
APPEND MODE           display N-edit "Alertas insertadas"
APPEND MODE           move N-ale-modificadas to N-edit
APPEND MODE           display N-edit "Alertas modificadas"
APPEND MODE           move N-ale-eliminadas to N-edit
APPEND MODE           display N-edit "Alertas eliminadas"
APPEND MODE           move N-ale-ya-existe to N-edit
APPEND MODE           display N-edit "Insercion de alerta existente"
APPEND MODE           move N-ale-no-existe to N-edit
APPEND MODE           display N-edit "Modif o elim de alerta inexistente".
APPEND MODE
APPEND MODE      * Emision del reporte de errores
APPEND MODE           display " "
APPEND MODE           display "Totales por tipo de error detectado:"
APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50
APPEND MODE           or E-codigo(Ex) = "00"
APPEND MODE               if E-contador(Ex) not = 0
APPEND MODE                   move E-contador(ex) to E-edit
APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
APPEND MODE               end-if
APPEND MODE           end-perform.
APPEND MODE
APPEND MODE
APPEND MODE       9000-CANCELAR-PROGRAMA.
APPEND MODE      ******************************************************************
APPEND MODE      * Procedimiento standard de cancelacion de programa batch
APPEND MODE      ******************************************************************
APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?
APPEND MODE           display " "
APPEND MODE           display pgm " - proceso cancelado"
APPEND MODE           goback returning 99.
APPEND MODE
APPEND MODE
APPEND MODE           copy BDIIVIDE.PROC.
APPEND MODE
APPEND MODE
APPEND MODE           copy LEEMAESTROS.PROC.
APPEND MODE
APPEND MODE
APPEND MODE      /
APPEND MODE       IDENTIFICATION DIVISION.
APPEND MODE       PROGRAM-ID. PONERR.
APPEND MODE      ******************************************************************
APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un
APPEND MODE      * registro de input
APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador
APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta
APPEND MODE      * el registro erroneo
APPEND MODE      ******************************************************************
APPEND MODE       ENVIRONMENT DIVISION.
APPEND MODE       DATA DIVISION.
APPEND MODE       WORKING-STORAGE SECTION.
APPEND MODE      ******************************************************************
APPEND MODE      * Registro de input (primeros 86 caracteres)
APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.
APPEND MODE      * Posicion del proximo error en la lista de errores del reg
APPEND MODE       01  errIndex                     pic 999 comp.
APPEND MODE      ******************************************************************
APPEND MODE
APPEND MODE       LINKAGE SECTION.
APPEND MODE      ******************************************************************
APPEND MODE      * Codigo del error detectado
APPEND MODE       01  cod-error                    pic xx.
APPEND MODE      ******************************************************************
APPEND MODE      * Registro de input (primeros 86 caracteres)
APPEND MODE       01  reg-input                    pic x(86).
APPEND MODE      ******************************************************************
APPEND MODE      * Tabla de errores de consistencia del input
APPEND MODE       01 E-errores.
APPEND MODE      *    indica si el registro actual tiene error
APPEND MODE           03 E-hay-error               pic xx.
APPEND MODE      *    errores del registro actual
APPEND MODE           03 E-errores-reg             pic x(300).
APPEND MODE      *    contador de registros con error
APPEND MODE           03 E-cont-regs-con-error     pic 9(8).
APPEND MODE      *    tabla de errores
APPEND MODE           03 E-error                   occurs 50 indexed Ex.
APPEND MODE               05 E-codigo              pic xx.
APPEND MODE               05                       pic x.
APPEND MODE               05 E-contador            pic 9(7).
APPEND MODE               05                       pic x.
APPEND MODE               05 E-descripcion         pic x(59).
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE
APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.
APPEND MODE       00.
APPEND MODE      *    marca al reg actual como erroneo
APPEND MODE           move "SI" to E-hay-error
APPEND MODE
APPEND MODE      *    cuenta y muestra el registro de input
APPEND MODE           if reg-input not = reg-input-anterior
APPEND MODE               add 1 to E-cont-regs-con-error
APPEND MODE               display " "
APPEND MODE               display reg-input
APPEND MODE               move reg-input to reg-input-anterior
APPEND MODE               move spaces to E-errores-reg
APPEND MODE               move 2 to errIndex
APPEND MODE           end-if
APPEND MODE
APPEND MODE      *    contabiliza el error en la tabla de errores
APPEND MODE           set Ex to 1
APPEND MODE           search E-error varying Ex
APPEND MODE           at end
APPEND MODE               display "--- falla en la tabla de errores ---" cod-error
APPEND MODE           when E-codigo(Ex) = "00"
APPEND MODE               add 1 to E-contador(Ex)
APPEND MODE               display "--- error tipo exotico: " cod-error
APPEND MODE               add 1 to E-contador(Ex)
APPEND MODE           when E-codigo(Ex) = cod-error
APPEND MODE               add 1 to E-contador(Ex)
APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)
APPEND MODE           end-search
APPEND MODE
APPEND MODE      *    agrega a la lista de errores del registro
APPEND MODE           if errIndex < (300 - 59 - 3)
APPEND MODE               move cod-error to E-errores-reg(errIndex:2)
APPEND MODE               add 3 to errIndex
APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)
APPEND MODE               add 59 to errIndex
APPEND MODE           end-if
APPEND MODE
APPEND MODE           exit program.
APPEND MODE
APPEND MODE
APPEND MODE       end program PONERR.
APPEND MODE
APPEND MODE       end program CARGAJUR2.
APPEND MODE
APPEND MODE      ******************************************************************
APPEND MODE      ******************************************************************
APPEND MODE
APPEND MODE
:w"CARGAJUR.CBL" 1456 lines, 61357 characters 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR2.******************************************************************
******************************************************************

"CARGAJUR.CBL" line 1455 of 1456 --99%-- 

"CARGAJUR.CBL" line 1456 of 1456 --100%-- 
:file CARGAJUR-OLD.CBL"CARGAJUR-OLD.CBL" [Not edited] line 1456 of 1456 --100%-- 
:w  CARGAJUR-OLD.CBL"CARGAJUR-OLD.CBL" [New file] 1456 lines, 61357 characters 
:qyou have mail in /usr/mail/icjlud
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 51 lines, 5773 characters      895    3326   41114 PESVNO-V02.CBL-rw-rw-r--   1 icjdld   icdatacr   411
14 Mar 11  2010 PESVNO-V02.CBL899    3336   41287 P_PESVNOCSVPLUS.CBL    -rw-rw-r--   1 1360     icdatacr   412
87 Jul 13  2010 P_PESVNOCSVPLUS.CBL899    3346   41290 PESVNOGJ.CBL-rw-rw-r--   1 icjdld   icdatacr   412
90 Mar 11  2010 PESVNOGJ.CBL903    3381   41902 PESVNO-V03.CBL-rw-rw-r--   1 icjdld   icdatacr   419
02 Mar 11  2010 PESVNO-V03.CBL917    3447   42753 PESVNOCSVPLUSv06.CBL   -rw-rw-r--   1 1395     icdatacr   427
53 Jun 11  2013 PESVNOCSVPLUSv06.CBL917    3462   42689 PESVNO0504.CBL-rw-rw-r--   1 icehad   icdatacr   426
89 May  5  2010 PESVNO0504.CBL919    3467   42879 P_PESVNO.CBL-rw-rw-r--   1 1360     icdatacr   428
79 Jul 13  2010 P_PESVNO.CBL923    3455   43051 PESVNOCSV-V05.CBL-rw-rw-r--   1 iccigd   icdatacr   430
51 May  3  2011 PESVNOCSV-V05.CBL929    3490   43503 PESVNOCSV_cg.CBL-rw-rw-r--   1 1395     icdatacr   435
03 Jul  9  2012 PESVNOCSV_cg.CBL934    4489   58108 P_PESVNOCITI.CBL-rw-rw-r--   1 1360     icdatacr   581
08 Jul 13  2010 P_PESVNOCITI.CBL939    3530   44191 PESVNOCSVv06.CBL-rw-rw-r--   1 1395     icdatacr   441
91 Jun 11  2013 PESVNOCSVv06.CBL946    3422   43437 P_PESVNOCSVFNG.CBL     -rw-rw-r--   1 1360     icdatacr   434
37 Jul 13  2010 P_PESVNOCSVFNG.CBL946    3615   44911 PESVNO-CV.CBL-rw-rw-r--   1 iccavd   icdatacr   449
11 Jul 11  2012 PESVNO-CV.CBL951    4565   59253 PESVNOCITI.CBL-rw-rw-r--   1 1395     icdatacr   592
53 Sep 10  2012 PESVNOCITI.CBL952    3658   45379 PESVNO64.CBL-rw-rw-r--   1 1395     icdatacr   453
79 Jul 12  2012 PESVNO64.CBL952    3658   45379 PESVNOpv.CBL-rw-rw-r--   1 1395     icdatacr   453
79 Aug 14  2012 PESVNOpv.CBL952    3658   45386 PESVNO-DIGITO.CBL-rw-rw-r--   1 iccavd   icdatacr   453
86 Jul 10  2012 PESVNO-DIGITO.CBL953    3466   43920 PESVNOCSVFNG.CBL-rw-rw-r--   1 1395     icdatacr   439
20 Jul  9  2012 PESVNOCSVFNG.CBL956    3677   45526 PES.CBL-rw-rw-r--   1 icrmbd   icdatacr   455
26 Aug  6  2012 PES.CBL983    3857   47985 PESVNOPEO.CBL-rw-rw-r--   1 icrmbd   icdatacr   479
85 Aug 15  2012 PESVNOPEO.CBL983    3857   47985 PESVNOv09.CBL-rw-rw-r--   1 1395     icdatacr   479
85 Sep  4  2012 PESVNOv09.CBL987    3828   47865 PESVNO-AVV.CBL-rw-rw-r--   1 1395     icdatacr   478
65 Sep 10  2012 PESVNO-AVV.CBL989    3817   48311 PESVNOCSVPLUSc.CBL     -rw-rw-r--   1 1395     icdatacr   483
11 Jun 25  2013 PESVNOCSVPLUSc.CBL998    3932   49201 PESVNOv10.CBL-rw-rw-r--   1 1395     icdatacr   492
01 Apr  2  2013 PESVNOv10.CBL
@"qqq" 51 lines, 5773 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
51 lines deletedNo lines in buffer
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~APPEND MODEsdiff -w 170  CARGAJUR-OLD.CBL  CARGAJUR-OLD.CBL
OPEN MODE





!sdiff -w 170  CARGAJUR.CBL  CARGAJUR-OLD.CBL$SET LIST SETTING LISTWIDTH"80"$SET LIST SETTING LISTWIDTH"80"
 IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
 PROGRAM-ID.    CARGAJUR.PROGRAM-ID.    CARGAJUR.
      ************************************************************************************************************************************
      * Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
      * por Jurad* por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.* el archivo ERRS.
      ************************************************************************************************************************************
 AUTHOR.Globant JL.AUTHOR.Globant JL.
 DATE-WRITTEN.DATE-WRITTEN.
 DATE-COMPILED.DATE-COMPILED.
 CONFIGURATION section.CONFIGURATION section.
 SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
 OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
 INPUT-OUTPUT section.INPUT-OUTPUT section.
 FILE-CONTROL.FILE-CONTROL.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 select JURAD assign to P-file-pathselect JURAD assign to P-file-path
 organization is line sequentialorganization is line sequential
 file status is JURAD-fs.file status is JURAD-fs.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-name
 organization is line sequentialorganization is line sequential
 file status is ERRS-fs.file status is ERRS-fs.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIREGI.FS.copy BDIIREGI.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIDIAN.FS.copy BDIIDIAN.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDACSV.FS.copy BDACSV.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIDAS.FS.copy BDIIDAS.FS.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
 copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on record
 file status is EST-BDIIALE.==.file status is EST-BDIIALE.==.

      ************************************************************************************************************************************
      ************************************************************************************************************************************
1455 more lines************************************************************************************************************************************************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuacin no estonfirmedo, no se usa|* $$$$ El formato a continuacin no est confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Base alterna* Base alterna
************************************************************************************************************************************
COPY BDACSV.FD.COPY BDACSV.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************
copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************
copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validacin de nombres|* Datos para las rutinas de validacin de nombres
************************************************************************************************************************************
copy LEEMAESTROS.WS.copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************
copy ICFILE.WS.copy ICFILE.WS.************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aos|* Fecha de proceso + 50 aos
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7).03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 "."Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificacin de alerta inexistente".|"Modificacin de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminacin de alerta inexistente".|"Eliminacin de alerta inexistente".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.PROCEDURE DIVISION.PROCEDURE DIVISION.* 0000-PROGRAMA-PRINCIPAL* 0000-PROGRAMA-PRINCIPAL
* 4000-PROCESAR-REGISTRO* 4000-PROCESAR-REGISTRO
* 4000-PROCESAR-REGISTRO-2* 4000-PROCESAR-REGISTRO-2
* 4100-VALIDACION-FORMAL* 4100-VALIDACION-FORMAL
* 4200-VALIDACION-SEMANTICA* 4200-VALIDACION-SEMANTICA
* 4300-MODIFICAR-BDIIALE* 4300-MODIFICAR-BDIIALE
* 4300-MODIFICAR-BDIIALE-DATOS* 4300-MODIFICAR-BDIIALE-DATOS
* 4300-MODIFICAR-BDIIALE-I* 4300-MODIFICAR-BDIIALE-I
* 4300-MODIFICAR-BDIIALE-M* 4300-MODIFICAR-BDIIALE-M
* 4300-MODIFICAR-BDIIALE-E* 4300-MODIFICAR-BDIIALE-E
* 4333-LEER-BDIIALE-RANDOM* 4333-LEER-BDIIALE-RANDOM
* 4333-GRABAR-BDIIALE* 4333-GRABAR-BDIIALE
* 4333-REGRABAR-BDIIALE* 4333-REGRABAR-BDIIALE
* 4333-ELIMINAR-BDIIALE* 4333-ELIMINAR-BDIIALE
* 4800-PROCESO-REG-T* 4800-PROCESO-REG-T
* 4900-GRABAR-ERROR* 4900-GRABAR-ERROR
* 4320-ARMAR-TEXTO-ALERTA* 4320-ARMAR-TEXTO-ALERTA
* 1000-RUTINA-INICIAL* 1000-RUTINA-INICIAL
* 1022-CARGAR-INCONSISTENTES* 1022-CARGAR-INCONSISTENTES
* 1000-NOT-USED* 1000-NOT-USED
* 1001-ELIMINAR-TODO* 1001-ELIMINAR-TODO
* 7000-RUTINA-FINAL* 7000-RUTINA-FINAL
* 9000-CANCELAR-PROGRAMA* 9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anteriorwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-name"qqq" [Modified] line 433 of 1458 --29%-- display "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que sealar el fin de proceso|*    si es el registro "T" hay que sealar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4200-CONTAR-TIPO-CUENTAperform 4200-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4200-CONTAR-TIPO-CUENTAperform 4200-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifend-ifend-ifperform 4200-CONTAR-TIPO-CUENTAperform 4200-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosend-ifend-if*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IFEND-IFMOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificacin contra las bases de|*    Valida el numero de identificacin contra las bases de
*    datos de validacin de informacin BDIIDIAN, BDIIDAS,|*    datos de validacin de informacin BDIIDIAN, BDIIDAS,
*    BDIIREGI y verifica la coincidencia del nombre reportado*    BDIIREGI y verifica la coincidencia del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    a ver si la validacion cambio el tipo de ide*    a ver si la validacion cambio el tipo de ideif JURAD-id-tipo not = TIP-IDE-BDIIVIDEif JURAD-id-tipo not = TIP-IDE-BDIIVIDEcall "PONERR" using "16" JURAD-reg E-errorescall "PONERR" using "16" JURAD-reg E-erroresdisplay "Tipo ide cambiado de " JURAD-id-tipo " a "display "Tipo ide cambiado de " JURAD-id-tipo " a "TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroTIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroend-ifend-if
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id invdo|*es un id invlidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternacall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-erroresperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alterna|*validacin en base alternaperform 4220-VALIDACION-NOMBRE-NO-COINCIDEperform 4220-VALIDACION-NOMBRE-NO-COINCIDEend-ifend-ifperform 4220-VALIDACION-NOMBRE-NO-COINCIDEperform 4220-VALIDACION-NOMBRE-NO-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDACION-NOMBRE-NO-COINCIDE.4220-VALIDACION-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide|* Validacin de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
* >>>> EDITANDO ACz falta integrar la parte cuando el nombre s\212     * coi   |* >>>> EDITANDO AC: falta integrar la parte cuando el nombre s
>* coincide, que no hace nada
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>IF TIPOID-E = 1IF TIPOID-E = 1
*es una cla, nombre no coincide|*es una cdula, nombre no coincidePERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIO
*MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC*MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC
*MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INC*MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADESMOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INCMOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INCMOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INCEND-IFEND-IFMOVE 02 TO CODIGO-ERROR CODERR-INCMOVE 02 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE*no es una cla|*no es una cdulaMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS TO MUN-EXP-INCMOVE NACIO-BDIIDAS TO MUN-EXP-INCEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales************************************************************************************************************************************* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin estn la base de datos|*    valida si la identificacin est en la base de datos
*    alterna*    alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cla|*es una cdulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORlselse
*no es una cla|*no es una cdulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROREND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion************************************************************************************************************************************* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg n: " N-reg-leidosJURAD-tipo-novedad " reg n: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALE************************************************************************************************************************************* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin estn la base de datos|*    valida si la identificacin est en la base de datos
*    alterna*    alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cla|*es una cdulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORlselse
*no es una cla|*no es una cdulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROREND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion************************************************************************************************************************************* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg n: " N-reg-leidosJURAD-tipo-novedad " reg n: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-erroresend-ifend-if
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-erroresend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fureviamente cargado con J001 o J002|*    LLASEC-BDIIALE fu previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphif not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberser el ultimo del archivo|* de control, y debera ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinue= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
********************************************************************************************************************************
* Hace el reemplazo de los valores adecuados en los templates* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde* de las linea de alerta que corresponde
********************************************************************************************************************************
*    segun se trate de demandas o embargos*    segun se trate de demandas o embargosif JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all space*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all space*delimited by all spacemove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
* >>>> da error en el end-if* >>>> da error en el end-if
*string LA-parte(LAx, 1) LA-valor(1)*string LA-parte(LAx, 1) LA-valor(1)
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-value*delimited by high-valueend-if.end-if.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"evaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deber cargar, aunque sea de manera|* blanco, me parece que se deberan cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"evaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deber cargar, aunque sea de manera|* blanco, me parece que se deberan cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"evaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - les:"|display "Fin de los registros a eliminar - ledos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidoscompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros les (exclu el registro "T")|*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.*    copy LEEMAESTROS.PROC.|copy LEEMAESTROS.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.compute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros les (exclu el registro "T")|*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.*    copy LEEMAESTROS.PROC.|copy LEEMAESTROS.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program CARGAJUR2.end program CARGAJUR2.************************************************************************************************************************************
************************************************************************************************************************************


~
~"qqq" 1458 lines, 175634 characters /d/iccol/desarrollo/fuentes>cp sdiff -w 170  CARGAJUR.CBL  CARGAJUR-OLD.CBL^[  /d/iccol/desarrollo/fuentes>cp sdiff -w 170  CARGAJUR.CBL  CARGAJUR-OLD.CBL                                 CARGAJUR.CBL    CARGAJUR.CBL  . CARGAJUR.CBL  CBL   CA>/d/iccol/desarrollo/fuentes>vi qqq                                            /d/iccol/desarrollo/fuentes>      sdiff -w 170  CARGAJUR.CBL  CARGAJUR-OLD.CBL                  CARGAJUR-OLD.CBL CARGAJUR.CBL /d/iccol/desarrollo/fuentes>  CARGAJUR-OLD.CBL CARGAJUR.CBL             /d/iccol/desarrollo/fuentes>c  CARGAJUR-OLD.CBL CARGAJUR.CBL /d/iccol/desarrollo/fuentes>cp  CARGAJUR-OLD.CBL CARGAJUR.CBL /d/iccol/desarrollo/fuentes>cp
/d/iccol/desarrollo/fuentes>vi qqq
"qqq" 1458 lines, 175634 characters sdiff -w 170  CARGAJUR.CBL  CARGAJUR-OLD.CBL$SET LIST SETTING LISTWIDTH"80"$SET LIST SETTING LISTWIDTH"80"
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.PROGRAM-ID.    CARGAJUR.
************************************************************************************************************************************
* Actualizacion del archivo de alertas con los datos provistos* Actualizacion del archivo de alertas con los datos provistos
* por Jurad* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.* el archivo ERRS.
************************************************************************************************************************************
AUTHOR.Globant JL.AUTHOR.Globant JL.
DATE-WRITTEN.DATE-WRITTEN.
DATE-COMPILED.DATE-COMPILED.
CONFIGURATION section.CONFIGURATION section.
SOURCE-COMPUTER. microfocus.SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.INPUT-OUTPUT section.
FILE-CONTROL.FILE-CONTROL.************************************************************************************************************************************
************************************************************************************************************************************
select JURAD assign to P-file-pathselect JURAD assign to P-file-pathorganization is line sequentialorganization is line sequentialfile status is JURAD-fs.file status is JURAD-fs.************************************************************************************************************************************
************************************************************************************************************************************
select ERRS assign to ERRS-file-nameselect ERRS assign to ERRS-file-nameorganization is line sequentialorganization is line sequentialfile status is ERRS-fs.file status is ERRS-fs.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIREGI.FS.copy BDIIREGI.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDIAN.FS.copy BDIIDIAN.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDACSV.FS.copy BDACSV.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIDAS.FS.copy BDIIDAS.FS.************************************************************************************************************************************
************************************************************************************************************************************copy BDIIALE.FS replacing == on record.== by == on recordcopy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.file status is EST-BDIIALE.==.************************************************************************************************************************************
************************************************************************************************************************************"qqq" 1458 lines, 175634 characters************************************************************************************************************************************************************************************************************************************************************************
DATA DIVISION.DATA DIVISION.
FILE section.FILE section.************************************************************************************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD* Archivo de entrada con los datos de demandas y embargos de JURAD
************************************************************************************************************************************
FD JURAD.FD JURAD.
01  JURAD-reg.01  JURAD-reg.
* Registros de movimientos I, M, E* Registros de movimientos I, M, E
*    Tipo de Novedad {I, M, E} Inser/Modif/Elim*    Tipo de Novedad {I, M, E} Inser/Modif/Elim03 JURAD-tipo-novedadpic x.03 JURAD-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 JURAD-id-tipopic x.03 JURAD-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroXpic x(11).03 JURAD-id-numeroredefines JURAD-id-numeroX03 JURAD-id-numeroredefines JURAD-id-numeroXpic 9(11).pic 9(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 JURAD-nombrepic x(45).03 JURAD-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 JURAD-demandas-vigentes   pic 999.03 JURAD-demandas-vigentes   pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 JURAD-demandas-terminadas pic 999.03 JURAD-demandas-terminadas pic 999.
*    Fecha ultima demanda vigente YYYYMMDD*    Fecha ultima demanda vigente YYYYMMDD03 JURAD-demandas-fecha-ultima pic x(8).03 JURAD-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 JURAD-embargos-vigentes   pic 999.03 JURAD-embargos-vigentes   pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 JURAD-embargos-terminados pic 999.03 JURAD-embargos-terminados pic 999.
*    Fecha ultimo embargo vigente YYYYMMDD*    Fecha ultimo embargo vigente YYYYMMDD03 JURAD-embargos-fecha-ultimo pic x(8).03 JURAD-embargos-fecha-ultimo pic x(8).01  JURADT-reg.01  JURADT-reg.
* Registro de totales de control T* Registro de totales de control T
*    Tipo de Novedad = "T"*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03 JURADT-tipo-novedadpic x.03pic x.03pic x.
*    Cantidad de registros*    Cantidad de registros03 JURADT-registrospic 9(11).03 JURADT-registrospic 9(11).03pic x.03pic x.
* $$$$ El formato a continuacin no estonfirmedo, no se usa|* $$$$ El formato a continuacin no est confirmedo, no se usa
*    Total numero de demandas vigentes*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03 JURADT-demandas-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de demandas terminadas*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03 JURADT-demandas-terminadas pic 9(7).03pic x.03pic x.
*    Total numero de embargos vigentes*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03 JURADT-embargos-vigentes  pic 9(7).03pic x.03pic x.
*    Total numero de embargos terminados*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03 JURADT-embargos-terminados pic 9(7).03pic x(41).03pic x(41).03pic x(41).03pic x(41).************************************************************************************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD* Archivo de salida con los registros defectuosos del arch JURAD
************************************************************************************************************************************
FD ERRS.FD ERRS.
01  ERRS-reg.01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.03 ERRS-id-tipopic x.
*    Numero de identificacion*    Numero de identificacion03 ERRS-id-numeropic x(11).03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos*    Nombres y Apellidos03 ERRS-nombrepic x(45).03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo*    Causa del rechazo03 ERRS-causa-rechazopic x(61).03 ERRS-causa-rechazopic x(61).************************************************************************************************************************************
* Contiene los ids y nombres de personas* Contiene los ids y nombres de personas
************************************************************************************************************************************
copy BDIIREGI.FD.copy BDIIREGI.FD.************************************************************************************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN* por la DIAN
************************************************************************************************************************************
copy BDIIDIAN.FD.copy BDIIDIAN.FD.************************************************************************************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS* Archivo maestro de cedulas de extranjeria suministrado por DAS
************************************************************************************************************************************
copy BDIIDAS.FD.copy BDIIDAS.FD.************************************************************************************************************************************
* Base alterna* Base alterna
************************************************************************************************************************************
COPY BDACSV.FD.COPY BDACSV.FD.************************************************************************************************************************************
* Maestro de alertas reportadas por suscriptores* Maestro de alertas reportadas por suscriptores
************************************************************************************************************************************
copy BDIIALE.FD.copy BDIIALE.FD.copy BDIIALE.FD.copy BDIIALE.FD.************************************************************************************************************************************
WORKING-STORAGE section.WORKING-STORAGE section.
************************************************************************************************************************************
* Nombre del programa* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".01  pgmpic x(10) value "CARGAJUR".************************************************************************************************************************************
* Variables para rutina de validacion de identificaciones* Variables para rutina de validacion de identificaciones
************************************************************************************************************************************
copy BDIIVIDE.WS.copy BDIIVIDE.WS.************************************************************************************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online* Variables relacionadas con la la base BDIIALE de alertas online
************************************************************************************************************************************
copy BDIIALE.WS.copy BDIIALE.WS.************************************************************************************************************************************
* Datos para las rutinas de validacin de nombres|* Datos para las rutinas de validacin de nombres
************************************************************************************************************************************
copy LEEMAESTROS.WS.copy LEEMAESTROS.WS.**********************************************************************************************************************************
* Direcciones de los archivos en el file system* Direcciones de los archivos en el file system
**********************************************************************************************************************************
copy ICFILE.WS.copy ICFILE.WS.************************************************************************************************************************************
* Indica que se termino el proceso, por agotamiento del archivo* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".01  IND-fin-procesopic xx value "NO".* Copia del ultimo reg de input, para mensajes (Ult reg: ...)* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.01  JURAD-fspic xx value spaces.01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.01 D-datahost.05 D-vigentespic 9(5).05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).05 D-fecha-ultimapic x(8).
************************************************************************************************************************************
* Parametros iniciales, de la linea de comando* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.01 P-command-linepic x(80) value spaces.
01 P-parametros.01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic x value "2".03 P-proceso-realpic x value "2".88 PROCESO-REALvalue "1".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.03 P-file-namepic x(80) value spaces.03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")*aaa = Codificacion del producto ("100")05 P-productopic xxx.05 P-productopic xxx.
*DDMMAA = Fecha de proceso*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).05 P-fecha-procesopic x(6).
*bb =  01 a CI*bb =  01 a CI05 P-ci-bipic xx.05 P-ci-bipic xx.
*XX = Tipo de proceso*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.05 P-tipo-procesopic xx.
*extension del archivo ".txt"*extension del archivo ".txt"05 P-extensionpic x(4).05 P-extensionpic x(4).05pic x(57).05pic x(57).03 P-file-pathpic x(80) value spaces.03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 aos|* Fecha de proceso + 50 aos
01 P-fecha-proceso-50.01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).03pic x(4).
************************************************************************************************************************************
* Datos para el reporte final* Datos para el reporte final
01 W-tiempo.01 W-tiempo.03 W-hora-iniciopic 9(8).03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.01 N-editpic z(8)B.
01 N-editp100redefines N-edit01 N-editp100redefines N-editpic z(5)9.9B.pic z(5)9.9B.
01 N-contadores.01 N-contadores.
*    Registros en el archivo de entrada*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.03 N-reg-OKpic 9(8) value zero.
*    Registros con error*    Registros con error03 N-reg-con-errorpic 9(8) value zero.03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existente*    Insercion de alerta existente03 N-ale-ya-existepic 9(8) value zero.03 N-ale-ya-existepic 9(8) value zero.
*    Modificacion o eliminacion de alerta inexistente*    Modificacion o eliminacion de alerta inexistente03 N-ale-no-existepic 9(8) value zero.03 N-ale-no-existepic 9(8) value zero.*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargos03 N-demandas-vigentespic 9(7).03 N-demandas-vigentespic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-demandas-terminadas     pic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-vigentespic 9(7).03 N-embargos-terminados     pic 9(7).03 N-embargos-terminados     pic 9(7).************************************************************************************************************************************
* Armado de las lineas de alerta* Armado de las lineas de alerta
01 LA-lineas-alerta.01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS*    archivo, como BDIIALE-ALERTAS03 LAendpic 999 comp value 0.03 LAendpic 999 comp value 0.03 LA-modelos.03 LA-modelos.
*12345678901234567890123456789012345678901234567890*1234567890123456789012345678901234567890123456789005 pic x(50) value05 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS"."TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]"."LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES"."TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] "."EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker05 pic x(50) value high-values. *> end marker03 LA-modelos2redefines LA-modelos.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 505 LA-modelopic x(50) occurs 5indexed LAm.indexed LAm.
*    Funcionamiento de los templates.*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamanio del contenido.*    conveniente que informe sobre el tamanio del contenido.03 LA-templates.03 LA-templates.05 LA-templateoccurs 4 indexed LAx.05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)07 LA-partepic x(50)occurs 10 indexed LAy.occurs 10 indexed LAy.
*    Las dos lineas armadas*    Las dos lineas armadas03 LA-lineas.03 LA-lineas.05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).05 LA-linea1pic x(50).05 LA-linea1pic x(50).05 LA-linea2pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea*    Los valores a insertar en una linea03 LA-valores.03 LA-valores.05 LA-valorpic x(50)05 LA-valorpic x(50)occurs 10 indexed LAv.occurs 10 indexed LAv.
*    Datos para editar valores a insertar*    Datos para editar valores a insertar03 LA-numpic -(11)0.03 LA-numpic -(11)0.03 LA-numXredefines LA-num03 LA-numXredefines LA-numpic x(12).pic x(12).03 LA-descartepic x(50).03 LA-descartepic x(50).************************************************************************************************************************************
* Errores de consistencia del input* Errores de consistencia del input
* Cada error tiene un codigo de 2 digitos, un espacio, contador* Cada error tiene un codigo de 2 digitos, un espacio, contador
* de ocurrencias de 7 digitos, un espacio, y descripcion de 59* de ocurrencias de 7 digitos, un espacio, y descripcion de 59
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx value "NO".03 E-hay-errorpic xx value "NO".
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300) value spaces.03 E-errores-regpic x(300) value spaces.
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8) value zero.03 E-cont-regs-con-error     pic 9(8) value zero.
*    tabla de errores*    tabla de errores03 pic x(11) value "01 0000000 ".03 pic x(11) value "01 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de movimiento invalido, debe ser I M E T"."Tipo de movimiento invalido, debe ser I M E T".03 pic x(11) value "02 0000000 ".03 pic x(11) value "02 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion invalido, debe ser 1 2 3 4"."Tipo de identificacion invalido, debe ser 1 2 3 4".03 pic x(11) value "03 0000000 ".03 pic x(11) value "03 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de identificacion invalido, debe ser numerico"."Numero de identificacion invalido, debe ser numerico".03 pic x(11) value "04 0000000 ".03 pic x(11) value "04 0000000 ".03 pic x(59) value03 pic x(59) value"Tipo de identificacion debe ser mayor que cero"."Tipo de identificacion debe ser mayor que cero".03 pic x(11) value "05 0000000 ".03 pic x(11) value "05 0000000 ".03 pic x(59) value03 pic x(59) value"Falta el nombre o denominacion"."Falta el nombre o denominacion".03 pic x(11) value "06 0000000 ".03 pic x(11) value "06 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas vigentes: debe ser numerico"."Numero de demandas vigentes: debe ser numerico".03 pic x(11) value "07 0000000 ".03 pic x(11) value "07 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de demandas terminadas: debe ser numerico"."Numero de demandas terminadas: debe ser numerico".03 pic x(11) value "08 0000000 ".03 pic x(11) value "08 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: debe ser numerica"."Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "09 0000000 ".03 pic x(11) value "09 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultima demanda vigente YYYYMMDD: fuera de rango"."Fecha ultima demanda vigente YYYYMMDD: fuera de rango".03 pic x(11) value "10 0000000 ".03 pic x(11) value "10 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 "."Numero de embargos vigentes: debe ser numerico"."Numero de embargos vigentes: debe ser numerico".03 pic x(11) value "11 0000000 ".03 pic x(11) value "11 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de embargos terminados: debe ser numerico"."Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(11) value "12 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica"."Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(11) value "13 0000000 ".03 pic x(59) value03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango"."Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(11) value "14 0000000 ".03 pic x(59) value03 pic x(59) value"El numero de id no se encuentra en el archivo maestro"."El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(11) value "15 0000000 ".03 pic x(59) value03 pic x(59) value"El nombre en el input no coincide con el registrado"."El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(11) value "16 0000000 ".03 pic x(59) value03 pic x(59) value"Numero de id fuera del rango del tipo de id informado"."Numero de id fuera del rango del tipo de id informado".03 pic x(11) value "17 0000000 ".03 pic x(11) value "17 0000000 ".03 pic x(59) value03 pic x(59) value"Modificacin de alerta inexistente".|"Modificacin de alerta inexistente".03 pic x(11) value "18 0000000 ".03 pic x(11) value "18 0000000 ".03 pic x(59) value03 pic x(59) value"Eliminacin de alerta inexistente".|"Eliminacin de alerta inexistente".
*----------------- insertar nuevos items aqui -------------------*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.01 E-errores-2redefines E-errores.03pic xx.03pic xx.03pic x(300).03pic x(300).03pic 9(8).03pic 9(8).03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).
01 E-editpic z(8)B.01 E-editpic z(8)B.************************************************************************************************************************************
* Control de rangos de valores de las fechas del input* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31.88 DIA-VALvalue 01   thru 31./*****************************************************************/*****************************************************************
************************************************************************************************************************************
PROCEDURE DIVISION.PROCEDURE DIVISION.PROCEDURE DIVISION.PROCEDURE DIVISION.* 0000-PROGRAMA-PRINCIPAL* 0000-PROGRAMA-PRINCIPAL
* 4000-PROCESAR-REGISTRO* 4000-PROCESAR-REGISTRO
* 4000-PROCESAR-REGISTRO-2* 4000-PROCESAR-REGISTRO-2
* 4100-VALIDACION-FORMAL* 4100-VALIDACION-FORMAL
* 4200-VALIDACION-SEMANTICA* 4200-VALIDACION-SEMANTICA
* 4300-MODIFICAR-BDIIALE* 4300-MODIFICAR-BDIIALE
* 4300-MODIFICAR-BDIIALE-DATOS* 4300-MODIFICAR-BDIIALE-DATOS
* 4300-MODIFICAR-BDIIALE-I* 4300-MODIFICAR-BDIIALE-I
* 4300-MODIFICAR-BDIIALE-M* 4300-MODIFICAR-BDIIALE-M
* 4300-MODIFICAR-BDIIALE-E* 4300-MODIFICAR-BDIIALE-E
* 4333-LEER-BDIIALE-RANDOM* 4333-LEER-BDIIALE-RANDOM
* 4333-GRABAR-BDIIALE* 4333-GRABAR-BDIIALE
* 4333-REGRABAR-BDIIALE* 4333-REGRABAR-BDIIALE
* 4333-ELIMINAR-BDIIALE* 4333-ELIMINAR-BDIIALE
* 4800-PROCESO-REG-T* 4800-PROCESO-REG-T
* 4900-GRABAR-ERROR* 4900-GRABAR-ERROR
* 4320-ARMAR-TEXTO-ALERTA* 4320-ARMAR-TEXTO-ALERTA
* 1000-RUTINA-INICIAL* 1000-RUTINA-INICIAL
* 1022-CARGAR-INCONSISTENTES* 1022-CARGAR-INCONSISTENTES
* 1000-NOT-USED* 1000-NOT-USED
* 1001-ELIMINAR-TODO* 1001-ELIMINAR-TODO
* 7000-RUTINA-FINAL* 7000-RUTINA-FINAL
* 9000-CANCELAR-PROGRAMA* 9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.0000-PROGRAMA-PRINCIPAL.
************************************************************************************************************************************
*    inicializa el ambiente y abre los archivos*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIALperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totales*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte final*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALperform 7000-RUTINA-FINALgoback.goback.4000-PROCESAR-REGISTRO.4000-PROCESAR-REGISTRO.
********************************************************************************************************************************
* Proceso de un registro del archivo de entrada JURAD* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo* Lectura y control del file status del archivo
********************************************************************************************************************************
*    lectura del proximo registro*    lectura del proximo registroread JURADread JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"
*controla el reg y lo aplica si es OK*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2perform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriormove JURAD-reg to JURAD-reg-anteriorwhen "10"when "10"
*fin del archivo de input:*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivo*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "Falta el reg de totales del archivo JURAD "display "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAwhen otherwhen other
*error de lectura: cancelacion del proceso*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4000-PROCESAR-REGISTRO-2.4000-PROCESAR-REGISTRO-2.
********************************************************************************************************************************
* Controla los datos de un registro de JURAD y si es OK lo usa* Controla los datos de un registro de JURAD y si es OK lo usa
* para actualizar el archivo de alertas en linea* para actualizar el archivo de alertas en linea
* La informacion esta leida en JURAD-reg* La informacion esta leida en JURAD-reg
********************************************************************************************************************************move "NO" to E-hay-errormove "NO" to E-hay-error*    validacion del tipo de movimiento*    validacion del tipo de movimientoif JURAD-tipo-novedad not = "I" and "M" and "E" and "T"if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"call "PONERR" using "01" JURAD-reg E-errorescall "PONERR" using "01" JURAD-reg E-erroresend-ifend-if*    si es el registro "T" hay que sealar el fin de proceso|*    si es el registro "T" hay que sealar el fin de procesoif JURAD-tipo-novedad = "T"if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesomove "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Tperform 4800-PROCESO-REG-Texit paragraphexit paragraphend-ifend-ifadd 1 to N-reg-leidosadd 1 to N-reg-leidos*    validacion formal de los datos*    validacion formal de los datosmove 0 to codigo-errormove 0 to codigo-errorperform 4100-VALIDACION-FORMALperform 4100-VALIDACION-FORMALif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4200-CONTAR-TIPO-CUENTAperform 4200-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-if*    si la validacion formal dio OK se hace validacion semantica*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"if E-hay-error = "SI"perform 4900-GRABAR-ERRORperform 4900-GRABAR-ERRORperform 4200-CONTAR-TIPO-CUENTAperform 4200-CONTAR-TIPO-CUENTAexit paragraphexit paragraphend-ifend-ifend-ifend-ifperform 4200-CONTAR-TIPO-CUENTAperform 4200-CONTAR-TIPO-CUENTA*    intento de actualizacion de BDIIALE*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.add 1 to N-reg-OK.4100-VALIDACION-FORMAL.4100-VALIDACION-FORMAL.
************************************************************************************************************************************
* Validacion formal de los datos del input* Validacion formal de los datos del input
************************************************************************************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-errorescall "PONERR" using "02" JURAD-reg E-erroresmove 05 to codigo-errormove 05 to codigo-errorend-ifend-if
*    Numero de identificacion*    Numero de identificacionif JURAD-id-numeroX is not numericif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-errorescall "PONERR" using "03" JURAD-reg E-erroresend-ifend-ifif JURAD-id-numero not > 0if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-errorescall "PONERR" using "04" JURAD-reg E-erroresend-ifend-if
*    si el movimiento es una eliminacion los datos subsiguientes*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlan*    no se controlanif JURAD-tipo-novedad = "E"if JURAD-tipo-novedad = "E"exit paragraphexit paragraphend-ifend-if
*    Nombres y Apellidos*    Nombres y Apellidosif JURAD-nombre = spacesif JURAD-nombre = spacescall "PONERR" using "05" JURAD-reg E-errorescall "PONERR" using "05" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas vigentes*    Numero de demandas vigentesif JURAD-demandas-vigentes is not numericif JURAD-demandas-vigentes is not numericcall "PONERR" using "06" JURAD-reg E-errorescall "PONERR" using "06" JURAD-reg E-erroresend-ifend-if
*    Numero de demandas terminadas*    Numero de demandas terminadasif JURAD-demandas-terminadas is not numericif JURAD-demandas-terminadas is not numericcall "PONERR" using "07" JURAD-reg E-errorescall "PONERR" using "07" JURAD-reg E-erroresend-ifend-if
*    Fecha ultima demanda vigente YYMMDD*    Fecha ultima demanda vigente YYMMDDif JURAD-demandas-fecha-ultima is not numericif JURAD-demandas-fecha-ultima is not numericcall "PONERR" using "08" JURAD-reg E-errorescall "PONERR" using "08" JURAD-reg E-erroresend-ifend-ifmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASmove JURAD-demandas-fecha-ultima to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "09" JURAD-reg E-errorescall "PONERR" using "09" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos vigentes*    Numero de embargos vigentesif JURAD-embargos-vigentes not numericif JURAD-embargos-vigentes not numericcall "PONERR" using "10" JURAD-reg E-errorescall "PONERR" using "10" JURAD-reg E-erroresend-ifend-if
*    Numero de embargos terminados*    Numero de embargos terminadosend-ifend-if*    Numero de embargos terminados*    Numero de embargos terminadosif JURAD-embargos-terminados not numericif JURAD-embargos-terminados not numericcall "PONERR" using "11" JURAD-reg E-errorescall "PONERR" using "11" JURAD-reg E-erroresend-ifend-if
*    Fecha ultimo embargo vigente YYMMDD*    Fecha ultimo embargo vigente YYMMDDif JURAD-embargos-fecha-ultimo is not numericif JURAD-embargos-fecha-ultimo is not numericcall "PONERR" using "12" JURAD-reg E-errorescall "PONERR" using "12" JURAD-reg E-erroresend-ifend-ifmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASmove JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHASif not ANO-VAL or not MES-VAL or not DIA-VALif not ANO-VAL or not MES-VAL or not DIA-VALcall "PONERR" using "13" JURAD-reg E-errorescall "PONERR" using "13" JURAD-reg E-erroresend-if.end-if.4200-VALIDACION-SEMANTICA.4200-VALIDACION-SEMANTICA.
********************************************************************************************************************************
* Validacion del numero de identificacion y de su relacion con* Validacion del numero de identificacion y de su relacion con
* el nombre* el nombre
********************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-tipo to TIP-IDE-BDIIVIDEmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-id-numero to NUM-IDE-BDIIVIDE-Rmove JURAD-nombre to NOMBRE-BDIIVIDEmove JURAD-nombre to NOMBRE-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEIF TIP-IDE-BDIIVIDE = 2 OR 3IF TIP-IDE-BDIIVIDE = 2 OR 3MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEMOVE 1 TO SW-DIGCHEQUEO-BDIIVIDEEND-IFEND-IFMOVE 2 TO NUM-BLOQUES-BDIIVIDEMOVE 2 TO NUM-BLOQUES-BDIIVIDE
*    Valida el numero de identificacin contra las bases de|*    Valida el numero de identificacin contra las bases de
*    datos de validacin de informacin BDIIDIAN, BDIIDAS,|*    datos de validacin de informacin BDIIDIAN, BDIIDAS,
*    BDIIREGI y verifica la coincidencia del nombre reportado*    BDIIREGI y verifica la coincidencia del nombre reportado
*    Retorna SW-ID-BDIIVIDE=1 si hay error*    Retorna SW-ID-BDIIVIDE=1 si hay errorperform 80100-VALIDAR-IDENTIFICACIONperform 80100-VALIDAR-IDENTIFICACION
*    a ver si la validacion cambio el tipo de ide*    a ver si la validacion cambio el tipo de ideif JURAD-id-tipo not = TIP-IDE-BDIIVIDEif JURAD-id-tipo not = TIP-IDE-BDIIVIDEcall "PONERR" using "16" JURAD-reg E-errorescall "PONERR" using "16" JURAD-reg E-erroresdisplay "Tipo ide cambiado de " JURAD-id-tipo " a "display "Tipo ide cambiado de " JURAD-id-tipo " a "TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroTIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroend-ifend-if
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1if SW-ID-BDIIVIDE = 1
*es un id invdo|*es un id invlidocall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-errores
*valida contra la base alterna*valida contra la base alternacall "PONERR" using "14" JURAD-reg E-errorescall "PONERR" using "14" JURAD-reg E-erroresperform 4210-VALIDACION-ID-NO-FIGURAperform 4210-VALIDACION-ID-NO-FIGURAelseelse
*existe id, a ver si el nombre coincide*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-errorescall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEdisplay "registro: " NOM-LEIDO-BDIIVIDE
*validacin en base alterna|*validacin en base alternaperform 4220-VALIDACION-NOMBRE-NO-COINCIDEperform 4220-VALIDACION-NOMBRE-NO-COINCIDEend-ifend-ifperform 4220-VALIDACION-NOMBRE-NO-COINCIDEperform 4220-VALIDACION-NOMBRE-NO-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDACION-NOMBRE-NO-COINCIDE.4220-VALIDACION-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide|* Validacin de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
* >>>> EDITANDO ACz falta integrar la parte cuando el nombre s\212     * coi   |* >>>> EDITANDO AC: falta integrar la parte cuando el nombre s
>* coincide, que no hace nada
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>IF TIPOID-E = 1IF TIPOID-E = 1
*es una cla, nombre no coincide|*es una cdula, nombre no coincidePERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIO
*MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC*MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC
*MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INC*MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADESMOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INCMOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INCMOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INCEND-IFEND-IFMOVE 02 TO CODIGO-ERROR CODERR-INCMOVE 02 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE*no es una cla|*no es una cdulaMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS TO MUN-EXP-INCMOVE NACIO-BDIIDAS TO MUN-EXP-INCEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales************************************************************************************************************************************* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin estn la base de datos|*    valida si la identificacin est en la base de datos
*    alterna*    alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cla|*es una cdulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORlselse
*no es una cla|*no es una cdulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROREND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacionperform 4220-VALIDACION-NOMBRE-NO-COINCIDEperform 4220-VALIDACION-NOMBRE-NO-COINCIDEend-ifend-ifend-if.end-if.4220-VALIDACION-NOMBRE-NO-COINCIDE.4220-VALIDACION-NOMBRE-NO-COINCIDE.
************************************************************************************************************************************
* Validacin de IDs que figuran OK pero el nombre no coincide|* Validacin de IDs que figuran OK pero el nombre no coincide
************************************************************************************************************************************
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
* >>>> EDITANDO ACz falta integrar la parte cuando el nombre s\212     * coi   |* >>>> EDITANDO AC: falta integrar la parte cuando el nombre s
>* coincide, que no hace nada
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>IF TIPOID-E = 1IF TIPOID-E = 1
*es una cla, nombre no coincide|*es una cdula, nombre no coincidePERFORM 810-BUSCAR-MUNICIPIOPERFORM 810-BUSCAR-MUNICIPIO
*MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC*MOVE TIP-IDE-BDIIVIDE TO TIP-VAL TIP-INC
*MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INC*MOVE NUM-IDE-BDIIVIDE TO CED-VAL CED-INCMOVE FECHA-EXP-BDIIREGI TO FECHA-2000MOVE FECHA-EXP-BDIIREGI TO FECHA-2000IF ANO-2000-R > 51IF ANO-2000-R > 51ADD 1900 TO ANO-2000-RADD 1900 TO ANO-2000-RELSEELSEADD 2000 TO ANO-2000-RADD 2000 TO ANO-2000-REND-IFEND-IFMOVE IND-SEXO-BDIIREGI TO GENERO-VALMOVE IND-SEXO-BDIIREGI TO GENERO-VALPERFORM 505-RANGO-EDADESPERFORM 505-RANGO-EDADESMOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INCMOVE FECHA-2000 TO FEC-EXP-VAL FEC-EXP-INCIF ESTADO-VIG-BDIIREGI = 12 OR = 27IF ESTADO-VIG-BDIIREGI = 12 OR = 27MOVE "00" TO VIG-VAL VIG-INCMOVE "00" TO VIG-VAL VIG-INCELSEELSEMOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INCMOVE ESTADO-VIG-BDIIREGI TO VIG-VAL VIG-INCEND-IFEND-IFMOVE 02 TO CODIGO-ERROR CODERR-INCMOVE 02 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 510-ESCRIBIR-INCONSPERFORM 510-ESCRIBIR-INCONSADD 1 TO NO-COINCIDE-REGISADD 1 TO NO-COINCIDE-REGISELSEELSE*no es una cla|*no es una cdulaMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 01 TO CODIGO-ERROR CODERR-INCMOVE 1 TO SW-ERRORMOVE 1 TO SW-ERRORPERFORM 512-CREE-REGISTROPERFORM 512-CREE-REGISTROWRITE REG-INCONSWRITE REG-INCONSADD 1 TO NO-COINCIDE-DIANADD 1 TO NO-COINCIDE-DIANIF TIPOID-E = 4IF TIPOID-E = 4MOVE NACIO-BDIIDAS TO MUN-EXP-INCMOVE NACIO-BDIIDAS TO MUN-EXP-INCEND-IFEND-IFEND-IF.END-IF.4210-VALIDACION-ID-NO-FIGURA.4210-VALIDACION-ID-NO-FIGURA.
************************************************************************************************************************************
* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales************************************************************************************************************************************* Validacin de IDs que no figuran en las bases normales|* Validacin de IDs que no figuran en las bases normales
************************************************************************************************************************************MOVE 0 TO HACER-MATCHMOVE 0 TO HACER-MATCHMOVE 0 TO IDE-TIPO-BDAMATCHMOVE 0 TO IDE-TIPO-BDAMATCH
*    valida si la identificacin estn la base de datos|*    valida si la identificacin est en la base de datos
*    alterna*    alternaPERFORM 513-VALIDA-EN-CSVPERFORM 513-VALIDA-EN-CSVIF IDE-TIPO-BDAMATCH = 0IF IDE-TIPO-BDAMATCH = 0IF TIP-IDE-BDIIVIDE = 1IF TIP-IDE-BDIIVIDE = 1
*es una cla|*es una cdulaMOVE 04 TO CODIGO-ERRORMOVE 04 TO CODIGO-ERRORlselse
*no es una cla|*no es una cdulaMOVE 03 TO CODIGO-ERRORMOVE 03 TO CODIGO-ERROREND-IFEND-IFEND-IF.END-IF.4300-MODIFICAR-BDIIALE.4300-MODIFICAR-BDIIALE.
************************************************************************************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y* modificaciones o eliminaciones segun haya o no demandas y
* embargos* embargos
************************************************************************************************************************************initialize REG-BDIIALEinitialize REG-BDIIALE*    si hay demandas*    si hay demandasif JURAD-demandas-vigentes > zeroif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALEmove "J001" to LLASEC-BDIIALE
*arma datos de demandas*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimastring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.*    si hay embargos*    si hay embargosif JURAD-embargos-vigentes > zeroif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALEmove "J002" to LLASEC-BDIIALE
*arma datos de embargos*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimostring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSperform 4300-MODIFICAR-BDIIALE-DATOSend-if.end-if.4300-MODIFICAR-BDIIALE-DATOS.4300-MODIFICAR-BDIIALE-DATOS.
************************************************************************************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion************************************************************************************************************************************* Parte de la carga de datos en el registro BDIIALE y grabacion* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
************************************************************************************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOMperform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M E*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadevaluate JURAD-tipo-novedadwhen "I"when "I"add 1 to N-reg-tipo-I-OKadd 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-Iperform 4300-MODIFICAR-BDIIALE-Iwhen "M"when "M"add 1 to N-reg-tipo-M-OKadd 1 to N-reg-tipo-M-OKperform 4300-MODIFICAR-BDIIALE-Mperform 4300-MODIFICAR-BDIIALE-Mwhen "E"when "E"add 1 to N-reg-tipo-E-OKadd 1 to N-reg-tipo-E-OKperform 4300-MODIFICAR-BDIIALE-Eperform 4300-MODIFICAR-BDIIALE-Ewhen otherwhen other
*esto es "imposible" por control de consistencia anterior*esto es "imposible" por control de consistencia anteriordisplay "error de logica: tipo-novedad="display "error de logica: tipo-novedad="JURAD-tipo-novedad " reg n: " N-reg-leidosJURAD-tipo-novedad " reg n: " N-reg-leidosdisplay "Registro de JURAD: " display JURAD-regdisplay "Registro de JURAD: " display JURAD-regperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4300-MODIFICAR-BDIIALE-I.4300-MODIFICAR-BDIIALE-I.
************************************************************************************************************************************
* Insercion de una alerta nueva* Insercion de una alerta nueva
* Si ya existia muestra un mensaje y continua* Si ya existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro existia es un error*    si el registro existia es un errorif EST-BDIIALE = "00"if EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeadd 1 to N-ale-ya-existeend-ifend-if*    completa los datos del registro*    completa los datos del registroinitialize ENCABEZADO-BDIIALEinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.4300-MODIFICAR-BDIIALE-M.
************************************************************************************************************************************
* Modificacion de una alerta existente* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    si el registro no existia es un error*    si el registro no existia es un errorif EST-BDIIALE not = "00"if EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "17" JURAD-reg E-errorescall "PONERR" using "17" JURAD-reg E-erroresend-ifend-if
*    reemplaza la fecha de reporte y los valores*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEperform 4333-REGRABAR-BDIIALEelseelseperform 4333-GRABAR-BDIIALEperform 4333-GRABAR-BDIIALEend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.4300-MODIFICAR-BDIIALE-E.
************************************************************************************************************************************
* Eliminacion de una alerta* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua* Si no existia muestra un mensaje y continua
************************************************************************************************************************************
*    elimina el registro*    elimina el registroif EST-BDIIALE = "00"if EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEperform 4333-ELIMINAR-BDIIALEelseelsedisplay "Eliminacion de alerta inexistente "display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro de input: "display "Registro de input: "display JURAD-regdisplay JURAD-regadd 1 to N-ale-no-existeadd 1 to N-ale-no-existecall "PONERR" using "18" JURAD-reg E-errorescall "PONERR" using "18" JURAD-reg E-erroresend-if.end-if.
*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
4333-LEER-BDIIALE-RANDOM.4333-LEER-BDIIALE-RANDOM.
************************************************************************************************************************************
* Arma clave exacta y lee un registro de BDIIALE* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
************************************************************************************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fureviamente cargado con J001 o J002|*    LLASEC-BDIIALE fu previamente cargado con J001 o J002read BDIIALEread BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"continuecontinuewhen "23"when "23"continuecontinuewhen otherwhen otherdisplay "Error al leer BDIIALE fs: " EST-BDIIALEdisplay "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display "Ultimo registro procesado: "display JURAD-reg-anteriordisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.4333-GRABAR-BDIIALE.
************************************************************************************************************************************
* Inserta un registro nuevo en BDIIALE* Inserta un registro nuevo en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifwrite REG-BDIIALEwrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-insertadasadd 1 to N-ale-insertadaswhen otherwhen otherdisplay "Error al grabar BDIIALE fs: " EST-BDIIALEdisplay "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-REGRABAR-BDIIALE.4333-REGRABAR-BDIIALE.
************************************************************************************************************************************
* Regraba un registro modificado en BDIIALE* Regraba un registro modificado en BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphif not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifrewrite REG-BDIIALErewrite REG-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-modificadasadd 1 to N-ale-modificadaswhen otherwhen otherdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALEdisplay "Error al regrabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4333-ELIMINAR-BDIIALE.4333-ELIMINAR-BDIIALE.
************************************************************************************************************************************
* Elimina un registro de BDIIALE* Elimina un registro de BDIIALE
************************************************************************************************************************************if not PROCESO-REALif not PROCESO-REALexit paragraphexit paragraphend-ifend-ifdelete BDIIALEdelete BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"add 1 to N-ale-eliminadasadd 1 to N-ale-eliminadaswhen otherwhen otherdisplay "Error al deletear BDIIALE fs: " EST-BDIIALEdisplay "Error al deletear BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display "Registro BDIIALE: "display REG-BDIIALEdisplay REG-BDIIALEperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.4800-PROCESO-REG-T.4800-PROCESO-REG-T.
************************************************************************************************************************************
* El registro leido en el archivo JURAD es tipo "T" con totales* El registro leido en el archivo JURAD es tipo "T" con totales
* de control, y deberser el ultimo del archivo|* de control, y debera ser el ultimo del archivo
************************************************************************************************************************************
* Control de los totales calculados contra los esperados* Control de los totales calculados contra los esperadosmove "NO" to E-hay-errormove "NO" to E-hay-error
*    cantidad de registros I M E*    cantidad de registros I M Eif function numval(JURADT-registros) = N-reg-leidosif function numval(JURADT-registros) = N-reg-leidoscontinuecontinueelseelsedisplay " "display " "display "No coincide la cantidad de registros:"display "No coincide la cantidad de registros:"JURADT-registros " con los leidos:" N-reg-leidosJURADT-registros " con los leidos:" N-reg-leidosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-if*    Sumas de cantidades de demandas y embargos*    Sumas de cantidades de demandas y embargosif function numval(JURADT-demandas-terminadas)if function numval(JURADT-demandas-terminadas)= N-demandas-terminadas= N-demandas-terminadascontinuecontinue= N-demandas-terminadas= N-demandas-terminadascontinuecontinueelseelsedisplay " "display " "display "No coincide total de demandas terminadas:"display "No coincide total de demandas terminadas:"JURADT-demandas-terminadas " con el calculado:"JURADT-demandas-terminadas " con el calculado:"N-demandas-terminadasN-demandas-terminadasmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-vigentes)if function numval(JURADT-embargos-vigentes)= N-embargos-vigentes= N-embargos-vigentescontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos vigentes:"display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesN-embargos-vigentesmove "SI" to E-hay-errormove "SI" to E-hay-errorend-ifend-ifif function numval(JURADT-embargos-terminados)if function numval(JURADT-embargos-terminados)= N-embargos-terminados= N-embargos-terminadoscontinuecontinueelseelsedisplay " "display " "display "No coincide total de embargos terminados:"display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosN-embargos-terminadosmove "SI" to E-hay-errormove "SI" to E-hay-errorend-if.end-if.*    si hubo cualquier cosa se invalida el proceso*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"if E-hay-error = "SI"display "Error en registro T de totales de control"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-if.end-if.4900-GRABAR-ERROR.4900-GRABAR-ERROR.
************************************************************************************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado* con indicacion del error detectado
************************************************************************************************************************************move JURAD-reg to ERRS-regmove JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registro*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazomove E-errores-reg to ERRS-causa-rechazowrite ERRS-regwrite ERRS-regevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "Error al grabar el archivo de errores "display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAgobackgobackend-evaluate.end-evaluate.4320-ARMAR-TEXTO-ALERTA.4320-ARMAR-TEXTO-ALERTA.
********************************************************************************************************************************
* Hace el reemplazo de los valores adecuados en los templates* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde* de las linea de alerta que corresponde
********************************************************************************************************************************
*    segun se trate de demandas o embargos*    segun se trate de demandas o embargosif JURAD-demandas-vigentes not = 0if JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0or JURAD-demandas-terminadas not = 0set LAx to 1set LAx to 1move high-values to LA-valoresmove high-values to LA-valoresmove JURAD-demandas-vigentes to LA-nummove JURAD-demandas-vigentes to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all space*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-nummove JURAD-demandas-terminadas to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all space*delimited by all spacemove LA-numx(9:12) to LA-valor(2)move LA-numx(9:12) to LA-valor(2)* >>>> esto esta anulado x que no se como hacer para que lo compile* >>>> esto esta anulado x que no se como hacer para que lo compile
* >>>> da error en el end-if* >>>> da error en el end-if
*string LA-parte(LAx, 1) LA-valor(1)*string LA-parte(LAx, 1) LA-valor(1)
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-value*delimited by high-valueend-if.end-if.1000-RUTINA-INICIAL.1000-RUTINA-INICIAL.
************************************************************************************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:* del programa:
*   - obtencion de los parametros*   - obtencion de los parametros
*   - apertura del archivo de entrada*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo*   - eliminacion de datos existentes si es refresque completo
*   - carga en memoria de los IDs de inconsistentes*   - carga en memoria de los IDs de inconsistentes
************************************************************************************************************************************
* Registra hora de inicio* Registra hora de inicioaccept W-hora-inicio from timeaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),* Obtiene informacion sobre la corrida de la linea de comando: el* Obtiene informacion sobre la corrida de la linea de comando: el* nombre del archivo de entrada (que contiene el tipo de proceso),* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEaccept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-linedisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intounstring P-command-line delimited by all " " intoP-file-name P-proceso-realP-file-name P-proceso-real* El programa se anuncia en la consola* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?* TODO: se usa un anuncio mas vistoso?if PROCESO-REALif PROCESO-REALdisplay pgm " Carga de archivo JURAD - proceso REAL"display pgm " Carga de archivo JURAD - proceso REAL"elseelsedisplay pgm " Carga de archivo JURAD - proceso en falso"display pgm " Carga de archivo JURAD - proceso en falso"end-ifend-if* El indicador de proceso real debe ser 1 o 2* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-if* TODO: controlar los componentes del filename* TODO: controlar los componentes del filenameevaluate P-tipo-procesoevaluate P-tipo-procesowhen "01"when "01"display "01 Envio Original - Carga TOTAL 1a vez"display "01 Envio Original - Carga TOTAL 1a vez"when "02"when "02"display "02 Archivo Semanal - Carga PARCIAL"display "02 Archivo Semanal - Carga PARCIAL"when "03"when "03"display "03 Archivo Mensual - Carga PARCIAL"display "03 Archivo Mensual - Carga PARCIAL"when "04"when "04"display "04 Refresque Total - Carga TOTAL"display "04 Refresque Total - Carga TOTAL"when otherwhen other
*valor invalido*valor invalidodisplay "El tipo de proceso " P-tipo-procesodisplay "El tipo de proceso " P-tipo-proceso" es invalido (debe ser 01 02 03 o 04)"" es invalido (debe ser 01 02 03 o 04)"perform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-evaluate.end-evaluate.* Edita la fecha de proceso DDMMAA del parametro en formato* Edita la fecha de proceso DDMMAA del parametro en formato
* YYYYMMDD* YYYYMMDDstring "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)P-fecha-proceso(1:2) delimited sizeP-fecha-proceso(1:2) delimited sizeinto P-fecha-proceso-YYYYMMDDinto P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de proceso* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYYadd 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entrada* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathstring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADopen input JURADevaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"evaluate JURAD-fsevaluate JURAD-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo JURAD "display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura del archivo de errores* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"string "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameinto ERRS-file-nameopen output ERRSopen output ERRSevaluate ERRS-fsevaluate ERRS-fswhen "00"when "00"continuecontinuewhen otherwhen otherdisplay "Error en open del archivo de errores "display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsdisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornagobackgobackend-evaluate.end-evaluate.* Apertura de los archivos maestros* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIREGIopen input BDIIDIANopen input BDIIDIANopen input BDIIDAS.open input BDIIDAS.* Apertura del archivo de alertas en linea* Apertura del archivo de alertas en lineaif PROCESO-REALif PROCESO-REALopen i-o BDIIALEopen i-o BDIIALEelseelseopen input BDIIALEopen input BDIIALEend-if.end-if.* Si es un refresque total (codigo 04) se eliminan los registros* Si es un refresque total (codigo 04) se eliminan los registros
* de Jurad existentes* de Jurad existentesif P-tipo-proceso = "04" and PROCESO-REALif P-tipo-proceso = "04" and PROCESO-REALperform 1001-ELIMINAR-TODOperform 1001-ELIMINAR-TODOend-if.end-if.1000-NOT-USED.1000-NOT-USED.
************************************************************************************************************************************
* Aunque tengo instrucciones de dejar los textos de alertas en* Aunque tengo instrucciones de dejar los textos de alertas en
* blanco, me parece que se deber cargar, aunque sea de manera|* blanco, me parece que se deberan cargar, aunque sea de manera
* precaria, por si justo cae una consulta para uno de los IDs* precaria, por si justo cae una consulta para uno de los IDs
* involucrados. La persona que consulta va a ver <spaces>, hasta* involucrados. La persona que consulta va a ver <spaces>, hasta
* que se ejecute el programa que genera los textos.* que se ejecute el programa que genera los textos.
************************************************************************************************************************************
* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver
* >>>> por ahora esta anulado* >>>> por ahora esta anulado* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"evaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - les:"|display "Fin de los registros a eliminar - ledos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidoscompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros les (exclu el registro "T")|*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.*    copy LEEMAESTROS.PROC.|copy LEEMAESTROS.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.compute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros les (exclu el registro "T")|*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************evaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - les:"|display "Fin de los registros a eliminar - ledos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidos* >>>> esto da un error de compilacion que no puedo resolver* >>>> esto da un error de compilacion que no puedo resolver* >>>> por ahora esta anulado* >>>> por ahora esta anulado
************************************************************************************************************************************
* Carga de los templates para armar el texto de alertas* Carga de los templates para armar el texto de alertas
* TODO: por ahora los templates son literales* TODO: por ahora los templates son literalesset LAx to 0set LAx to 0move high-values to LA-templatesmove high-values to LA-templatesperform varying LAm from 1 by 1perform varying LAm from 1 by 1until LA-modelo(LAm) = high-valuesuntil LA-modelo(LAm) = high-valuesset LAx up by 1set LAx up by 1
*separa las partes de la linea*separa las partes de la linea
*unstring LA-modelo(LAm) into LA-parte(LAx, 1)*unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)*LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)*LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)*LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
*delimited by all "&"*delimited by all "&"
*prepara para omitir los espacios al final de c/parte*prepara para omitir los espacios al final de c/parteperform varying LAy from 1 by 1 until LAy > 10perform varying LAy from 1 by 1 until LAy > 10inspect LA-parte(LAx, LAy) replacing trailinginspect LA-parte(LAx, LAy) replacing trailingspaces by high-valuesspaces by high-valuesinspect LA-parte(LAx, LAy) replacing firstinspect LA-parte(LAx, LAy) replacing firsthigh-value by spacehigh-value by spaceend-performend-performend-perform.end-perform.1001-ELIMINAR-TODO.1001-ELIMINAR-TODO.
************************************************************************************************************************************
* Elimina los registros de alertas existentes en el archivo de* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total* alertas en linea, previo a un refresque total
************************************************************************************************************************************display "Eliminando toda la informacion con fuente JURAD"display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURAD*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALE*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*posicionado*posicionadocontinuecontinuewhen otherwhen other
*no hay registros*no hay registrosdisplay "No hay registros a eliminar fs:" EST-BDIIALEdisplay "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphexit paragraphend-evaluate.end-evaluate.*    lee secuencialmente y elimina los registros de JURAD*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivo*    hasta el fin del archivoperform until EST-BDIIALE not = "00"perform until EST-BDIIALE not = "00"read BDIIALE next recordread BDIIALE next recordevaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"evaluate EST-BDIIALEevaluate EST-BDIIALEwhen "00"when "00"
*display "BDIIALE leido fs:" EST-BDIIALE*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE*" k:" LLAVE-BDIIALEif FUENTE-BDIIALE = P-cod-suscriptorif FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD*es un alerta de JURADdelete BDIIALEdelete BDIIALEif EST-BDIIALE = "00"if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALE*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradasadd 1 to N-ale-borradaselseelse
*error en la eliminacion*error en la eliminaciondisplay "Error al eliminar un registro de "display "Error al eliminar un registro de ""BDIIALE vaciando los datos""BDIIALE vaciando los datos"display "Clave: " LLAVE-BDIIALEdisplay "Clave: " LLAVE-BDIIALEdisplay "Reg borrados: " N-ale-borradasdisplay "Reg borrados: " N-ale-borradasperform 9000-CANCELAR-PROGRAMAperform 9000-CANCELAR-PROGRAMAend-ifend-ifend-ifend-ifwhen "10"when "10"
*fin de archivo: sale normalmente*fin de archivo: sale normalmentedisplay "Fin de los registros a eliminar - les:"|display "Fin de los registros a eliminar - ledos:"N-ale-leidasN-ale-leidaswhen otherwhen other
*lectura anormal: cancelacion del programa*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas "display "Error en lectura del archivo de alertas ""online""online"display "File status: " EST-BDIIALEdisplay "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-evaluateend-perform.end-perform.display "Termino la eliminacion total de JURAD"display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.7000-RUTINA-FINAL.
************************************************************************************************************************************
* Registra hora de finalizacion* Registra hora de finalizacionaccept W-hora-fin from timeaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivos* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.display "Fecha de proceso: " P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD
* Emision de contadores de registros* Emision de contadores de registrosdisplay " "display " "display "Totales de registros:"display "Totales de registros:"display " "display " "
*    porcentaje registros procesados OK*    porcentaje registros procesados OKcompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidoscompute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidosdisplay N-editp100 "% de registros correctos"display N-editp100 "% de registros correctos"
*    porcentaje registros inconsistentes*    porcentaje registros inconsistentescompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidoscompute N-editp100 rounded = 100.0 * E-cont-regs-con-errorcompute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidos/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"display N-editp100 "% de registros inconsistentes"
*    cantidad de registros les (exclu el registro "T")|*    cantidad de registros ledos (excludo el registro "T")move N-reg-leidos to N-editmove N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"display N-edit "Registros IME en el archivo de entrada"
*    cantidad de registros procesados sin error*    cantidad de registros procesados sin errormove N-reg-OK to N-editmove N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"display N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"*    display N-edit "Registros tipo E aceptados"*    cantidad de registros con error*    cantidad de registros con errormove E-cont-regs-con-error to N-reg-con-errormove E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editmove N-reg-con-error to N-editdisplay N-edit "Registros con error"display N-edit "Registros con error"
*    cantidades de alertas afectadas*    cantidades de alertas afectadasif P-tipo-proceso = "04"if P-tipo-proceso = "04"move N-ale-borradas to N-editmove N-ale-borradas to N-editdisplay N-editdisplay N-edit"Alertas borradas previo al refresque total""Alertas borradas previo al refresque total"end-ifend-ifmove N-ale-insertadas to N-editmove N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"display N-edit "Alertas insertadas"move N-ale-modificadas to N-editmove N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"display N-edit "Alertas modificadas"move N-ale-eliminadas to N-editmove N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"display N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editmove N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"display N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editmove N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".display N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores* Emision del reporte de erroresdisplay " "display " "display "Totales por tipo de error detectado:"display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"or E-codigo(Ex) = "00"if E-contador(Ex) not = 0if E-contador(Ex) not = 0move E-contador(ex) to E-editmove E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)display E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-ifend-ifend-perform.end-perform.9000-CANCELAR-PROGRAMA.9000-CANCELAR-PROGRAMA.
************************************************************************************************************************************
* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch
************************************************************************************************************************************* Procedimiento standard de cancelacion de programa batch* Procedimiento standard de cancelacion de programa batch************************************************************************************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?* TODO: hay un standard para comunicar una cancelacion de proceso?display " "display " "display pgm " - proceso cancelado"display pgm " - proceso cancelado"goback returning 99.goback returning 99.copy BDIIVIDE.PROC.copy BDIIVIDE.PROC.*    copy LEEMAESTROS.PROC.|copy LEEMAESTROS.PROC.//
IDENTIFICATION DIVISION.IDENTIFICATION DIVISION.
PROGRAM-ID. PONERR.PROGRAM-ID. PONERR.
************************************************************************************************************************************
* Rutina de conveniencia para procesar un error detectado en un* Rutina de conveniencia para procesar un error detectado en un
* registro de input* registro de input
* Contabiliza el error en la tabla de errores, activa el indicador* Contabiliza el error en la tabla de errores, activa el indicador
* de registro con error, muestra el mensaje en la pantalla, cuenta* de registro con error, muestra el mensaje en la pantalla, cuenta
* el registro erroneo* el registro erroneo
************************************************************************************************************************************
ENVIRONMENT DIVISION.ENVIRONMENT DIVISION.
DATA DIVISION.DATA DIVISION.
WORKING-STORAGE SECTION.WORKING-STORAGE SECTION.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-input-anteriorpic x(86) value low-values.01  reg-input-anteriorpic x(86) value low-values.
* Posicion del proximo error en la lista de errores del reg* Posicion del proximo error en la lista de errores del reg
01  errIndexpic 999 comp.01  errIndexpic 999 comp.
************************************************************************************************************************************LINKAGE SECTION.LINKAGE SECTION.
************************************************************************************************************************************
* Codigo del error detectado* Codigo del error detectado
01  cod-errorpic xx.01  cod-errorpic xx.
************************************************************************************************************************************
* Registro de input (primeros 86 caracteres)* Registro de input (primeros 86 caracteres)
01  reg-inputpic x(86).01  reg-inputpic x(86).
************************************************************************************************************************************
* Tabla de errores de consistencia del input* Tabla de errores de consistencia del input
01 E-errores.01 E-errores.
*    indica si el registro actual tiene error*    indica si el registro actual tiene error03 E-hay-errorpic xx.03 E-hay-errorpic xx.
*    errores del registro actual*    errores del registro actual03 E-errores-regpic x(300).03 E-errores-regpic x(300).
*    contador de registros con error*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores*    tabla de errores03 E-erroroccurs 50 indexed Ex.03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05 E-codigopic xx.05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-contadorpic 9(7).05 E-contadorpic 9(7).05pic x.05pic x.05 E-descripcionpic x(59).05 E-descripcionpic x(59).************************************************************************************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.PROCEDURE DIVISION using cod-error reg-input E-errores.
00.00.
*    marca al reg actual como erroneo*    marca al reg actual como erroneomove "SI" to E-hay-errormove "SI" to E-hay-error*    cuenta y muestra el registro de input*    cuenta y muestra el registro de inputif reg-input not = reg-input-anteriorif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-erroradd 1 to E-cont-regs-con-errordisplay " "display " "display reg-inputdisplay reg-inputmove reg-input to reg-input-anteriormove reg-input to reg-input-anteriormove spaces to E-errores-regmove spaces to E-errores-regmove 2 to errIndexmove 2 to errIndexend-ifend-if*    contabiliza el error en la tabla de errores*    contabiliza el error en la tabla de erroresset Ex to 1set Ex to 1search E-error varying Exsearch E-error varying Exat endat enddisplay "--- falla en la tabla de errores ---" cod-errordisplay "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"when E-codigo(Ex) = "00"add 1 to E-contador(Ex)add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errordisplay "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)when E-codigo(Ex) = cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)add 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchend-search*    agrega a la lista de errores del registro*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)if errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexadd 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)move E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexadd 59 to errIndexend-ifend-ifexit program.exit program.end program PONERR.end program PONERR.end program CARGAJUR2.end program CARGAJUR2.************************************************************************************************************************************
************************************************************************************************************************************


~
~:q/d/iccol/desarrollo/fuentes>^[j  /d/iccol/desarrollo/fuentes>vi qqqcp  CARGAJUR-OLD.CBL CARGAJUR.CBL/d/iccol/desarrollo/fuentes> CARGAJUR.CBL                    /d/iccol/desarrollo/fuentes>v CARGAJUR.CBLi CARGAJUR.CBL  CARGAJUR.CBL
"CARGAJUR.CBL" 1456 lines, 61357 characters $SET LIST SETTING LISTWIDTH"80"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************"CARGAJUR.CBL" 1456 lines, 61357 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1456 lines deletedNo lines in buffer:set noai nosmAPPEND MODE      $SET LIST SETTING LISTWIDTH"80"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDACSV.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************

      ******************************************************************

APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record

APPEND MODE              file status is EST-BDIIALE.==.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ****************************************************************** 

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Base alterna

APPEND MODE      ******************************************************************

APPEND MODE       COPY BDACSV.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la bsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

APPEND MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacin de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 aos

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificacin de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminacin de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que sealar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificacin contra las bases de

APPEND MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id invlido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validacin en base alterna

APPEND MODE                   perform 4220-VALIDACION-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDACION-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDACION-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIPOID-E = 1

APPEND MODE      *        es una cdula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cdula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDACION-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificacin est en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cdula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               lse

APPEND MODE      *            no es una cdula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debera ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberan cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - ledos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros ledos (excludo el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR2.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE
$SET LIST SETTING LISTWIDTH"80"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************:w"CARGAJUR.CBL" 1484 lines, 62498 characters [1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:    20
* Unrecoverable :     0                    Severe  :    18
* Errors        :     2                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1185828     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>vi  CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 59 lines, 3343 characters * Rejected - OPT
  2220perform 4220-VALIDACION-NOMBRE-NO-COINCIDE
*1006-E******************************************************(   0)**
**    COBOL word contains more than 31 characters. Word truncated.
  2227 4220-VALIDACION-NOMBRE-NO-COINCIDE.
*1006-E**********************************(  40)**
**    COBOL word contains more than 31 characters. Word truncated.
  2232     IF TIPOID-E = 1
*  12-S***************(  40)**
**    Operand TIPOID-E is not declared
  2235     ELSE
* 562-S********(  41)**
**    An "ELSE" phrase did not have a matching IF and was discarded.
  2238     END-IF.
* 564-S**********(  41)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2251move 1 TO SW-BDIIALE
*  12-S****************************(  41)**
**    Operand SW-BDIIALE is not declared
  2253move 0 to SW-BDIIALE
*  12-S****************************(  41)**
**    Operand SW-BDIIALE is not declared
  2256move 1 to SW-BDIIALE
*  12-S********************************(  41)**
**    Operand SW-BDIIALE is not declared
  2260     perform until SW-BDIIALE = 1
*  12-S****************************(  41)**
**    Operand SW-BDIIALE is not declared
  2268move 1 to SW-BDIIALE
*  12-S*********************************(  41)**
**    Operand SW-BDIIALE is not declared
  2270if SW-BDIIALE = 0
*  12-S*********************(  41)**
**    Operand SW-BDIIALE is not declared
  2272move 1 to SW-BDIIALE
*  12-S************************************(  41)**
**    Operand SW-BDIIALE is not declared
  2274end-if
* 564-S**************(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2275     end-perform.
* 564-S***************(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2294     MOVE 0 TO HACER-MATCH
*  12-S*************************(  42)**
**    Operand HACER-MATCH is not declared
  2303lse
*  12-S***********(  42)**
**    Operand LSE is not declared"CARGAJUR.CBL.err" 59 lines, 3343 characters* Rejected - OPT
  2220perform 4220-VALIDACION-NOMBRE-NO-COINCIDE
*1006-E******************************************************(   0)**
**    COBOL word contains more than 31 characters. Word truncated.
  2227 4220-VALIDACION-NOMBRE-NO-COINCIDE.
*1006-E**********************************(  40)**
**    COBOL word contains more than 31 characters. Word truncated.
  2232     IF TIPOID-E = 1
*  12-S***************(  40)**
**    Operand TIPOID-E is not declared
  2235     ELSE
* 562-S********(  41)**
**    An "ELSE" phrase did not have a matching IF and was discarded.
  2238     END-IF.
* 564-S**********(  41)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2251move 1 TO SW-BDIIALE
*  12-S****************************(  41)**
**    Operand SW-BDIIALE is not declared
  2253move 0 to SW-BDIIALE
*  12-S****************************(  41)**
**    Operand SW-BDIIALE is not declared
  2256move 1 to SW-BDIIALE
*  12-S********************************(  41)**
**    Operand SW-BDIIALE is not declared
  2260     perform until SW-BDIIALE = 1
*  12-S****************************(  41)**
**    Operand SW-BDIIALE is not declared
  2268move 1 to SW-BDIIALE
*  12-S*********************************(  41)**
**    Operand SW-BDIIALE is not declared
  2270if SW-BDIIALE = 0
*  12-S*********************(  41)**
**    Operand SW-BDIIALE is not declared
  2272move 1 to SW-BDIIALE
*  12-S************************************(  41)**
**    Operand SW-BDIIALE is not declared
  2274end-if
* 564-S**************(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2275     end-perform.
* 564-S***************(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2294     MOVE 0 TO HACER-MATCH
*  12-S*************************(  42)**
**    Operand HACER-MATCH is not declared
  2303lse
*  12-S***********(  42)**
**    Operand LSE is not declared
  


  


  * 348-S***********************(  42)****    Procedure name 4200-CONTAR-TIPO-CUENTA undeclared, line 2102 (first usage)* 348-S*****************(  59)****    Procedure name 513-VALIDA-EN-CSV undeclared, line 2298 (first usage)
* 348-S**************************(  59)**
**    Procedure name 10000-MATCH-NOMBRES-VALNOM undeclared, line 3030 (first usage)
  3325 end program CARGAJUR2.
* 613-S*********************(  59)**
**    Invalid program name
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL  


  


  


  


  







:q/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>fg
vi  CARGAJUR.CBL
$SET LIST SETTING LISTWIDTH"80"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1484 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"80"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDACSV.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************

      ******************************************************************

APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record

APPEND MODE              file status is EST-BDIIALE.==.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Base alterna

APPEND MODE      ******************************************************************

APPEND MODE       COPY BDACSV.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la bsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

APPEND MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE      *  posible: COPY BDAMATCH.WS.                                              
                              LEEMAEST      16

APPEND MODE       01  IDE-TIPO-BDAMATCH            PIC 9 value 0.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacin de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 aos

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificacin de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminacin de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que sealar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificacin contra las bases de

APPEND MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id invlido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validacin en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cdula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cdula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del cdigo

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificacin est en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cdula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cdula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debera ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberan cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - ledos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros ledos (excludo el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificacin est en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE      *           MOVE "A"      TO ORIGEN-VAL

APPEND MODE                  PERFORM  301-GRABA-LOS-VALIDOS

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           copy BDAMATCH.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1593 lines, 67072 characters 
[1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgjobsvi  CARGAJUR.CBL.errdes-c-v CARGAJUR    
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
* Total Messages:  1327
* Unrecoverable :     0                    Severe  :  1327
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1185852     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 3980 lines, 274809 characters * Rejected - OPT
  2303ADD 1 TO W-CONT-TIPO-6
*  12-S******************************(   0)**
**    Operand W-CONT-TIPO-6 is not declared
  2306ADD 1 TO W-CONT-TIPO-7
*  12-S**********************************(  42)**
**    Operand W-CONT-TIPO-7 is not declared
  2309ADD 1 TO W-CONT-TIPO-5
*  12-S**********************************(  42)**
**    Operand W-CONT-TIPO-5 is not declared
  2311IF TIPOID-E = 2 OR 3
*  12-S***********************(  42)**
**    Operand TIPOID-E is not declared
  2312ADD 1 TO W-CONT-TIPO-5-PJ
*  12-S*****************************************(  42)**
**    Operand W-CONT-TIPO-5-PJ is not declared
  2315     END-IF.
* 564-S**********(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2323     MOVE 0 TO IDE-TIPO-BDAMATCH
*   5-S*******************************(  42)**
**    User-name IDE-TIPO-BDAMATCH not unique
  2327     IF IDE-TIPO-BDAMATCH = 0
*   5-S************************(  42)**
**    User-name IDE-TIPO-BDAMATCH not unique
  2335     END-IF.
* 564-S**********(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2980     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
*  12-S******************(  42)**
**    Operand TIPOID-E is not declared
  2981     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
*  12-S*****************(  54)**
**    Operand NUMID-E is not declared
  2985IF OPEN-DIR = ZEROS
*  12-S******************(  54)**
**    Operand OPEN-DIR is not declared
  2986OPEN INPUT MAESTRO-DIRECC
*  12-S***********************************(  54)**
**    Operand MAESTRO-DIRECC is not declared
  2987OPEN INPUT BDLCLI
*  12-S***************************(  54)**
**    Operand BDLCLI is not declared
  2988OPEN INPUT SUSCRIPTOR
*  12-S*******************************(  54)**
**    Operand SUSCRIPTOR is not declared
  2989OPEN INPUT MAESTRO-CREDIT
*  12-S***********************************(  54)**
**    Operand MAESTRO-CREDIT is not declared"CARGAJUR.CBL.err" 3980 lines, 274809 characters:q/d/iccol/desarrollo/fuentes>fg
vi  CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

$SET LIST SETTING LISTWIDTH"80"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1593 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"80"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDACSV.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************

      ******************************************************************

APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record

APPEND MODE              file status is EST-BDIIALE.==.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Base alterna

APPEND MODE      ******************************************************************

APPEND MODE       COPY BDACSV.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la bsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

APPEND MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE      *  posible: COPY BDAMATCH.WS.

APPEND MODE       01  IDE-TIPO-BDAMATCH            PIC 9 value 0.

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacin de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 aos

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificacin de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminacin de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que sealar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificacin contra las bases de

APPEND MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id invlido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validacin en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cdula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cdula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del cdigo

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificacin est en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cdula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cdula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debera ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberan cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - ledos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros ledos (excludo el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificacin est en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE      *           MOVE "A"      TO ORIGEN-VAL

APPEND MODE                  PERFORM  301-GRABA-LOS-VALIDOS

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           copy BDAMATCH.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

"CARGAJUR.CBL" [Modified] line 1600 of 1600 --100%-- 
:w"CARGAJUR.CBL" 1600 lines, 67349 characters 
[1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:  1662
* Unrecoverable :     0                    Severe  :  1662
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1185884     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 4986 lines, 338578 characters * Rejected - OPT
  2317IF TIPOID-E = 2 OR 3
*  12-S***********************(   0)**
**    Operand TIPOID-E is not declared
  2321     END-IF.
* 564-S**********(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2329     MOVE 0 TO IDE-TIPO-BDAMATCH
*   5-S*******************************(  42)**
**    User-name IDE-TIPO-BDAMATCH not unique
  2333     IF IDE-TIPO-BDAMATCH = 0
*   5-S************************(  42)**
**    User-name IDE-TIPO-BDAMATCH not unique
  2341     END-IF.
* 564-S**********(  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2986     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE
*  12-S******************(  42)**
**    Operand TIPOID-E is not declared
  2987     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE
*  12-S*****************(  53)**
**    Operand NUMID-E is not declared
  2991IF OPEN-DIR = ZEROS
*  12-S******************(  54)**
**    Operand OPEN-DIR is not declared
  2992OPEN INPUT MAESTRO-DIRECC
*  12-S***********************************(  54)**
**    Operand MAESTRO-DIRECC is not declared
  2993OPEN INPUT BDLCLI
*  12-S***************************(  54)**
**    Operand BDLCLI is not declared
  2994OPEN INPUT SUSCRIPTOR
*  12-S*******************************(  54)**
**    Operand SUSCRIPTOR is not declared
  2995OPEN INPUT MAESTRO-CREDIT
*  12-S***********************************(  54)**
**    Operand MAESTRO-CREDIT is not declared
  2996OPEN INPUT MAESTRO-CHECK
*  12-S**********************************(  54)**
**    Operand MAESTRO-CHECK is not declared
  2998MOVE 1 TO OPEN-DIR
*  12-S****************************(  54)**
**    Operand OPEN-DIR is not declared
  3000MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH
*  12-S*********************(  54)**
**    Operand TIPOID-E is not declared
  3001MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*  12-S********************(  54)**
**    Operand NUMID-E is not declared"CARGAJUR.CBL.err" 4986 lines, 338578 characters/-e\>/
  //////



/


/
/  3004IF IDE-TIPO-BDAMATCH = 1
*   5-S****************************(  54)**
**    User-name IDE-TIPO-BDAMATCH not unique
  3005IF TIPOID-E = 1 OR 4
/*  12-S**********************(  54)**
**    Operand TIPOID-E is not declared
/  3009MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOM
:v//d**    Operand TIPOID-E is not declared
  3001         MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
Operand NUMID-E is not declared
  3005            IF TIPOID-E = 1 OR 4
**    Operand TIPOID-E is not declared
  3009            MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM
**    Operand NOMBRE-E is not declared
  3011            MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOM
Operand TIPOID-E is not declared
  3024            MOVE TIPOID-E TO TIP-VAL
**    Operand TIPOID-E is not declared
  3025            MOVE NUMID-E  TO CED-VAL
**    Operand NUMID-E is not declared
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
4966 fewer lines  3000MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH**    Operand NUMID-E is not declared  2987     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE**    Operand TIPOID-E is not declared  2986     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE**    Operand TIPOID-E is not declared  2317IF TIPOID-E = 2 OR 3  *  12-S*******************************(  54)**
**    Operand SUSCRIPTOR is not declared
  2995OPEN INPUT MAESTRO-CREDIT
*  12-S***********************************(  54)**
**    Operand MAESTRO-CREDIT is not declared
  2996OPEN INPUT MAESTRO-CHECK
*  12-S**********************************(  54)**
**    Operand MAESTRO-CHECK is not declared
  2998MOVE 1 TO OPEN-DIR
*  12-S****************************(  54)**
**    Operand OPEN-DIR is not declared
  3000MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH
*  12-S*********************(  54)**
**    Operand TIPOID-E is not declared
  3001MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*  12-S********************(  54)**
**    Operand NUMID-E is not declared
  3004IF IDE-TIPO-BDAMATCH = 1
*   5-S****************************(  54)**
**    User-name IDE-TIPO-BDAMATCH not unique
  3005IF TIPOID-E = 1 OR 4
*  12-S**********************(  54)**
**    Operand TIPOID-E is not declared
  3009MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOM
*  12-S************************(  54)**
**    Operand NOMBRE-E is not declared
  3011MOVE TIPOID-ETO  TIP-ID-INPUT-VALNOM
*  12-S************************(  54)**
**    Operand TIPOID-E is not declared
  3015MOVE 1 TO IDE-TIPO-BDAMATCH
*   5-S*****************************************(  54)**
**    User-name IDE-TIPO-BDAMATCH not unique
  3017IF W-BLOQUES > 0
*  12-S*************************(  54)**
**    Operand W-BLOQUES is not declared
  3018MOVE 0 TO IDE-TIPO-BDAMATCH
*   5-S*******************************************(  55)**
**    User-name IDE-TIPO-BDAMATCH not unique
  3020END-IF
* 564-S*****************(  55)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3021END-IF
* 564-S**************(  55)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3023IF IDE-TIPO-BDAMATCH = 1
*   5-S****************************(  55)**
**    User-name IDE-TIPO-BDAMATCH not unique
  3024MOVE TIPOID-E TO TIP-VAL
*  12-S************************(  55)**
4966 more lines


  


  


  


  


  


  


  


  
*  12-S************************(  55)**
**    Operand TIPOID-E is not declared
  3025MOVE NUMID-E  TO CED-VAL
*  12-S***********************(  55)**
**    Operand NUMID-E is not declared
  3026MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA
*  12-S***************************************************(  55)**
**    Operand CADENA-ENTRA is not declared
  3028MOVE CADENA-SALE TO  NOM-VAL
*  12-S***************************(  55)**
**    Operand CADENA-SALE is not declared
  3029MOVE ZEROS    TO FEC-EXP-VAL
*  12-S***************************************(  55)**
**    Operand FEC-EXP-VAL is not declared
  3030MOVE SPACES   TO MUN-EXP-VAL
*  12-S***************************************(  55)**
**    Operand MUN-EXP-VAL is not declared
  3031MOVE SPACES   TO DEP-EXP-VAL
*  12-S***************************************(  55)**
**    Operand DEP-EXP-VAL is not declared
  3032MOVE SPACES   TO VIG-VAL
*  12-S***********************************(  55)**
**    Operand VIG-VAL is not declared
  3033MOVE SPACES   TO GENERO-VAL
*  12-S**************************************(  55)**
**    Operand GENERO-VAL is not declared
  3034MOVE SPACES   TO EDAD-VAL
*  12-S************************************(  55)**
**    Operand EDAD-VAL is not declared
  3035MOVE SPACES   TO EDAD-RANGO
*  12-S**************************************(  55)**
**    Operand EDAD-RANGO is not declared
  3038ADD 1 TO SI-EXISTE-CSV
*  12-S*********************************(  55)**
**    Operand SI-EXISTE-CSV is not declared
  3039END-IF
* 564-S***************(  55)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3040END-IF.
* 564-S************(  56)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3046     MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA
*  12-S******************************************(  56)**
**    Operand CADENA-ENTRA is not declared
  3047     INITIALIZE CADENA-SALE
*  12-S**************************(  56)**
**    Operand CADENA-SALE is not declared
  3048     MOVE 1 TO J
*  12-S***************(  56)**:qNo write since last change (:quit! overrides):q!/d/iccol/desarrollo/fuentes>fg
vi  CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

$SET LIST SETTING LISTWIDTH"80"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1600 lines deletedNo lines in bufferINPUT MODEET LIST SETTING LISTWIDTH"80"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDACSV.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************

      ******************************************************************

INPUT MODE           copy BDIIALE.FS replacing == on record.== by == on record

INPUT MODE              file status is EST-BDIIALE.==.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Archivos de base alterna

INPUT MODE      ******************************************************************

INPUT MODE

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      ******************************************************************

INPUT MODE       DATA DIVISION.

INPUT MODE       FILE section.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

INPUT MODE      ******************************************************************

INPUT MODE       FD JURAD.

INPUT MODE       01  JURAD-reg.

INPUT MODE      * Registros de movimientos I, M, E

INPUT MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

INPUT MODE           03 JURAD-tipo-novedad        pic x.

INPUT MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

INPUT MODE           03 JURAD-id-tipo             pic x.

INPUT MODE      *    Numero de identificacion

INPUT MODE           03 JURAD-id-numeroX          pic x(11).

INPUT MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

INPUT MODE                                        pic 9(11).

INPUT MODE      *    Nombres y Apellidos

INPUT MODE           03 JURAD-nombre              pic x(45).

INPUT MODE      *    Numero de demandas vigentes

INPUT MODE           03 JURAD-demandas-vigentes   pic 999.

INPUT MODE      *    Numero de demandas terminadas

INPUT MODE           03 JURAD-demandas-terminadas pic 999.

INPUT MODE      *    Fecha ultima demanda vigente YYYYMMDD

INPUT MODE           03 JURAD-demandas-fecha-ultima pic x(8).

INPUT MODE      *    Numero de embargos vigentes

INPUT MODE           03 JURAD-embargos-vigentes   pic 999.

INPUT MODE      *    Numero de embargos terminados

INPUT MODE           03 JURAD-embargos-terminados pic 999.

INPUT MODE      *    Fecha ultimo embargo vigente YYYYMMDD

INPUT MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

INPUT MODE

INPUT MODE       01  JURADT-reg.

INPUT MODE      * Registro de totales de control T

INPUT MODE      *    Tipo de Novedad = "T"

INPUT MODE           03 JURADT-tipo-novedad       pic x.

INPUT MODE           03                           pic x.

INPUT MODE      *    Cantidad de registros

INPUT MODE           03 JURADT-registros          pic 9(11).

INPUT MODE           03                           pic x.

INPUT MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa

INPUT MODE      *    Total numero de demandas vigentes

INPUT MODE           03 JURADT-demandas-vigentes  pic 9(7).

INPUT MODE           03                           pic x.

INPUT MODE      *    Total numero de demandas terminadas

INPUT MODE           03 JURADT-demandas-terminadas pic 9(7).

INPUT MODE           03                           pic x.

INPUT MODE      *    Total numero de embargos vigentes

INPUT MODE           03 JURADT-embargos-vigentes  pic 9(7).

INPUT MODE           03                           pic x.

INPUT MODE      *    Total numero de embargos terminados

INPUT MODE           03 JURADT-embargos-terminados pic 9(7).

INPUT MODE           03                           pic x(41).

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Archivo de salida con los registros defectuosos del arch JURAD

INPUT MODE      ******************************************************************

INPUT MODE       FD ERRS.

INPUT MODE       01  ERRS-reg.

INPUT MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

INPUT MODE           03 ERRS-tipo-novedad         pic x.

INPUT MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

INPUT MODE           03 ERRS-id-tipo              pic x.

INPUT MODE      *    Numero de identificacion

INPUT MODE           03 ERRS-id-numero            pic x(11).

INPUT MODE      *    Nombres y Apellidos

INPUT MODE           03 ERRS-nombre               pic x(45).

INPUT MODE      *    Numero de demandas vigentes

INPUT MODE           03 ERRS-demandas-vigentes    pic 999.

INPUT MODE      *    Numero de demandas terminadas

INPUT MODE           03 ERRS-demandas-terminadas  pic 999.

INPUT MODE      *    Fecha ultima demanda vigente YYMMDD

INPUT MODE           03 ERRS-demandas-fecha-ultima pic x(8).

INPUT MODE      *    Numero de embargos vigentes

INPUT MODE           03 ERRS-embargos-vigentes    pic 999.

INPUT MODE      *    Numero de embargos terminados

INPUT MODE           03 ERRS-embargos-terminados  pic 999.

INPUT MODE      *    Fecha ultimo embargo vigente YYMMDD

INPUT MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

INPUT MODE      *    Causa del rechazo

INPUT MODE           03 ERRS-causa-rechazo        pic x(61).

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Contiene los ids y nombres de personas

INPUT MODE      ******************************************************************

INPUT MODE       copy BDIIREGI.FD.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

INPUT MODE      * por la DIAN

INPUT MODE      ******************************************************************

INPUT MODE       copy BDIIDIAN.FD.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

INPUT MODE      ******************************************************************

INPUT MODE       copy BDIIDAS.FD.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Base alterna

INPUT MODE      ******************************************************************

INPUT MODE       COPY BDACSV.FD.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Maestro de alertas reportadas por suscriptores

INPUT MODE      ******************************************************************

INPUT MODE       copy BDIIALE.FD.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE       WORKING-STORAGE section.

INPUT MODE      ******************************************************************

INPUT MODE      * Nombre del programa

INPUT MODE       01  pgm                          pic x(10) value "CARGAJUR".

INPUT MODE

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Datos para la bsqueda en base alterna

INPUT MODE       01  W-DERECHOS                   PIC 9 value 0.

INPUT MODE       01  CODIGO-ERROR                 pic 99 value 00.

INPUT MODE

INPUT MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

INPUT MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

INPUT MODE       01  SW-BDIIALE                   pic 9 value 0.

INPUT MODE       01  HACER-MATCH                  PIC 9 value 0.

INPUT MODE       01  OPEN-DIR                     PIC 9 value 0.

INPUT MODE       01  W-BLOQUES                    PIC 9 value 2.

INPUT MODE

INPUT MODE       01  DATOS-E.

INPUT MODE           03 TIPOID-E                  pic 9.

INPUT MODE           03 NUMID-E                   pic 9(11).

INPUT MODE           03 NOMBRE-E                  pic x(45).

INPUT MODE

INPUT MODE       01  REG-VALIDAS.                           

INPUT MODE           03 TIP-VAL                   PIC 9.   

INPUT MODE           03 CED-VAL                   PIC 9(11).

INPUT MODE           03 NOM-VAL                   PIC X(45).

INPUT MODE           03 FEC-EXP-VAL               PIC 9(08).

INPUT MODE           03 MUN-EXP-VAL               PIC X(15).

INPUT MODE           03 DEP-EXP-VAL               PIC X(15).

INPUT MODE           03 VIG-VAL                   PIC X(02).

INPUT MODE           03 GENERO-VAL                PIC X(01).

INPUT MODE           03 EDAD-VAL                  PIC X(03).

INPUT MODE           03 EDAD-RANGO                PIC X(05).

INPUT MODE           03 FILLER-2-VAL              PIC X(51).

INPUT MODE

INPUT MODE      *  posible: COPY BDAMATCH.WS.

INPUT MODE       01  W-CONTADORES.

INPUT MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

INPUT MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

INPUT MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

INPUT MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

INPUT MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Variables para rutina de validacion de identificaciones

INPUT MODE      ******************************************************************

INPUT MODE       copy BDIIVIDE.WS.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Variables relacionadas con la la base BDIIALE de alertas online

INPUT MODE      ******************************************************************

INPUT MODE       copy BDIIALE.WS.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Datos para las rutinas de validacin de nombres

INPUT MODE      ******************************************************************

INPUT MODE       copy LEEMAESTROS.WS.

INPUT MODE

INPUT MODE      *****************************************************************

INPUT MODE      * Direcciones de los archivos en el file system

INPUT MODE      *****************************************************************

INPUT MODE       copy ICFILE.WS.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Indica que se termino el proceso, por agotamiento del archivo

INPUT MODE      * de entrada (normal) o alguna otra condicion (error)

INPUT MODE       01  IND-fin-proceso              pic xx value "NO".

INPUT MODE

INPUT MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

INPUT MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

INPUT MODE       01  JURAD-fs                     pic xx value spaces.

INPUT MODE

INPUT MODE       01  ERRS-fs                      pic xx value spaces.

INPUT MODE

INPUT MODE      * Datos de demandas o embargos que van en el registro BDIIALE

INPUT MODE       01 D-datahost.

INPUT MODE           05 D-vigentes                pic 9(5).

INPUT MODE           05 D-terminados              pic 9(5).

INPUT MODE           05 D-fecha-ultima            pic x(8).

INPUT MODE      ******************************************************************

INPUT MODE      * Parametros iniciales, de la linea de comando

INPUT MODE      * La linea de comando que contiene los parametros

INPUT MODE       01 P-command-line                pic x(80) value spaces.

INPUT MODE       01 P-parametros.

INPUT MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

INPUT MODE           03 P-proceso-real            pic x value "2".

INPUT MODE           88 PROCESO-REAL              value "1".

INPUT MODE

INPUT MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

INPUT MODE           03 P-file-name               pic x(80) value spaces.

INPUT MODE           03 P-file-name-R             redefines P-file-name.

INPUT MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

INPUT MODE               05 P-cod-suscriptor      pic 9(6).

INPUT MODE      *        aaa = Codificacion del producto ("100")

INPUT MODE               05 P-producto            pic xxx.

INPUT MODE      *        DDMMAA = Fecha de proceso

INPUT MODE               05 P-fecha-proceso       pic x(6).

INPUT MODE      *        bb =  01 a CI

INPUT MODE               05 P-ci-bi               pic xx.

INPUT MODE      *        XX = Tipo de proceso

INPUT MODE      *        01 Envio Original - Carga TOTAL - primera vez

INPUT MODE      *        02 Archivo Semanal - Carga PARCIAL

INPUT MODE      *        03 Archivo Mensual - Carga PARCIAL

INPUT MODE      *        04 Refresque Total - Carga TOTAL

INPUT MODE               05 P-tipo-proceso        pic xx.

INPUT MODE      *        extension del archivo ".txt"

INPUT MODE               05 P-extension           pic x(4).

INPUT MODE               05                       pic x(57).

INPUT MODE           03 P-file-path               pic x(80) value spaces.

INPUT MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

INPUT MODE          03 ERRS-file-name             pic x(80) value spaces.

INPUT MODE

INPUT MODE      * Fecha de proceso editada YYYYMMDD

INPUT MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

INPUT MODE      * Fecha de proceso + 50 aos

INPUT MODE       01 P-fecha-proceso-50.

INPUT MODE           03  P-fecha-proceso-50YYYY   pic 9999.

INPUT MODE           03                           pic x(4).

INPUT MODE      ******************************************************************

INPUT MODE      * Datos para el reporte final

INPUT MODE       01 W-tiempo.

INPUT MODE           03 W-hora-inicio             pic 9(8).

INPUT MODE           03 W-hora-fin                pic 9(8).

INPUT MODE       01 N-edit                        pic z(8)B.

INPUT MODE       01 N-editp100                    redefines N-edit

INPUT MODE                                        pic z(5)9.9B.

INPUT MODE       01 N-contadores.

INPUT MODE      *    Registros en el archivo de entrada

INPUT MODE           03 N-reg-leidos              pic 9(8) value zero.

INPUT MODE      *    Registros procesados sin error

INPUT MODE           03 N-reg-OK                  pic 9(8) value zero.

INPUT MODE      *    Registros con error

INPUT MODE           03 N-reg-con-error           pic 9(8) value zero.

INPUT MODE

INPUT MODE      *    Cantidades de registros por tipo de novedad

INPUT MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

INPUT MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

INPUT MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

INPUT MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

INPUT MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

INPUT MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

INPUT MODE

INPUT MODE      *    Alertas borradas previo al refresque total

INPUT MODE           03 N-ale-leidas              pic 9(8) value zero.

INPUT MODE           03 N-ale-borradas            pic 9(8) value zero.

INPUT MODE      *    Alertas insertadas

INPUT MODE           03 N-ale-insertadas          pic 9(8) value zero.

INPUT MODE      *    Alertas modificadas

INPUT MODE           03 N-ale-modificadas         pic 9(8) value zero.

INPUT MODE      *    Alertas eliminadas

INPUT MODE           03 N-ale-eliminadas          pic 9(8) value zero.

INPUT MODE      *    Insercion de alerta existente

INPUT MODE           03 N-ale-ya-existe           pic 9(8) value zero.

INPUT MODE      *    Modificacion o eliminacion de alerta inexistente

INPUT MODE           03 N-ale-no-existe           pic 9(8) value zero.

INPUT MODE

INPUT MODE      *    Sumas de cantidades de demandas y embargos

INPUT MODE           03 N-demandas-vigentes       pic 9(7).

INPUT MODE           03 N-demandas-terminadas     pic 9(7).

INPUT MODE           03 N-embargos-vigentes       pic 9(7).

INPUT MODE           03 N-embargos-terminados     pic 9(7).

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Armado de las lineas de alerta

INPUT MODE       01 LA-lineas-alerta.

INPUT MODE      *    Los modelos a continuacion deberan obtenerse de un

INPUT MODE      *    archivo, como BDIIALE-ALERTAS

INPUT MODE           03 LAend                     pic 999 comp value 0.

INPUT MODE           03 LA-modelos.

INPUT MODE      *         12345678901234567890123456789012345678901234567890

INPUT MODE               05 pic x(50) value

INPUT MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

INPUT MODE               05 pic x(50) value

INPUT MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

INPUT MODE               05 pic x(50) value

INPUT MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

INPUT MODE               05 pic x(50) value

INPUT MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

INPUT MODE               05 pic x(50) value high-values. *> end marker

INPUT MODE           03 LA-modelos2               redefines LA-modelos.

INPUT MODE               05 LA-modelo             pic x(50) occurs 5

INPUT MODE                                        indexed LAm.

INPUT MODE      *    Funcionamiento de los templates.

INPUT MODE      *    Hay dos templates por de alerta, uno por linea.

INPUT MODE      *    Cada template consiste en hasta 10 frases fijas con

INPUT MODE      *    ampersands (&) donde se van a reemplazar los valores.

INPUT MODE      *    Por ejemplo:

INPUT MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

INPUT MODE      *    tiene 3 frases fijas y 2 reemplazos.

INPUT MODE      *    La cantidad de ampersands es irrelevante, pero parece

INPUT MODE      *    conveniente que informe sobre el tamanio del contenido.

INPUT MODE           03 LA-templates.

INPUT MODE               05 LA-template           occurs 4 indexed LAx.

INPUT MODE                   07 LA-parte          pic x(50)

INPUT MODE                                        occurs 10 indexed LAy.

INPUT MODE      *    Las dos lineas armadas

INPUT MODE           03 LA-lineas.

INPUT MODE               05 LA-linea1             pic x(50).

INPUT MODE               05 LA-linea2             pic x(50).

INPUT MODE      *    Los valores a insertar en una linea

INPUT MODE           03 LA-valores.

INPUT MODE               05 LA-valor              pic x(50)

INPUT MODE                                        occurs 10 indexed LAv.

INPUT MODE      *    Datos para editar valores a insertar

INPUT MODE           03 LA-num                    pic -(11)0.

INPUT MODE           03 LA-numX                   redefines LA-num

INPUT MODE                                        pic x(12).

INPUT MODE           03 LA-descarte               pic x(50).

INPUT MODE

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Errores de consistencia del input

INPUT MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

INPUT MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

INPUT MODE       01 E-errores.

INPUT MODE      *    indica si el registro actual tiene error

INPUT MODE           03 E-hay-error               pic xx value "NO".

INPUT MODE      *    errores del registro actual

INPUT MODE           03 E-errores-reg             pic x(300) value spaces.

INPUT MODE      *    contador de registros con error

INPUT MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

INPUT MODE      *    tabla de errores

INPUT MODE           03 pic x(11) value "01 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Tipo de movimiento invalido, debe ser I M E T".

INPUT MODE           03 pic x(11) value "02 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

INPUT MODE           03 pic x(11) value "03 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Numero de identificacion invalido, debe ser numerico".

INPUT MODE           03 pic x(11) value "04 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Tipo de identificacion debe ser mayor que cero".

INPUT MODE           03 pic x(11) value "05 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Falta el nombre o denominacion".

INPUT MODE           03 pic x(11) value "06 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Numero de demandas vigentes: debe ser numerico".

INPUT MODE           03 pic x(11) value "07 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Numero de demandas terminadas: debe ser numerico".

INPUT MODE           03 pic x(11) value "08 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

INPUT MODE           03 pic x(11) value "09 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

INPUT MODE           03 pic x(11) value "10 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Numero de embargos vigentes: debe ser numerico".

INPUT MODE           03 pic x(11) value "11 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Numero de embargos terminados: debe ser numerico".

INPUT MODE           03 pic x(11) value "12 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

INPUT MODE           03 pic x(11) value "13 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

INPUT MODE           03 pic x(11) value "14 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "El numero de id no se encuentra en el archivo maestro".

INPUT MODE           03 pic x(11) value "15 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "El nombre en el input no coincide con el registrado".

INPUT MODE           03 pic x(11) value "16 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Numero de id fuera del rango del tipo de id informado".

INPUT MODE           03 pic x(11) value "17 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Modificacin de alerta inexistente".

INPUT MODE           03 pic x(11) value "18 0000000 ".

INPUT MODE           03 pic x(59) value

INPUT MODE           "Eliminacin de alerta inexistente".

INPUT MODE      *----------------- insertar nuevos items aqui -------------------

INPUT MODE           03 pic x(11) value "00 0000000 ".

INPUT MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

INPUT MODE           03                           pic x(3500). *> los 50 items

INPUT MODE       01 E-errores-2                   redefines E-errores.

INPUT MODE           03                           pic xx.

INPUT MODE           03                           pic x(300).

INPUT MODE           03                           pic 9(8).

INPUT MODE           03 E-error                   occurs 50 indexed Ex.

INPUT MODE               05 E-codigo              pic xx.

INPUT MODE               05                       pic x.

INPUT MODE               05 E-contador            pic 9(7).

INPUT MODE               05                       pic x.

INPUT MODE               05 E-descripcion         pic x(59).

INPUT MODE       01 E-edit                        pic z(8)B.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      * Control de rangos de valores de las fechas del input

INPUT MODE       01 VALIDACIONES-FECHAS.

INPUT MODE           02 ANO-VAL-X                 pic 9(04).

INPUT MODE              88 ANO-VAL                value 1900 thru 2050.

INPUT MODE           02 MES-VAL-X                 pic 9(02).

INPUT MODE              88 MES-VAL                value 01   thru 12.

INPUT MODE           02 DIA-VAL-X                 pic 9(02).

INPUT MODE              88 DIA-VAL                value 01   thru 31.

INPUT MODE

INPUT MODE

INPUT MODE      /*****************************************************************

INPUT MODE      ******************************************************************

INPUT MODE       PROCEDURE DIVISION.

INPUT MODE

INPUT MODE      * 0000-PROGRAMA-PRINCIPAL

INPUT MODE      * 4000-PROCESAR-REGISTRO

INPUT MODE      * 4000-PROCESAR-REGISTRO-2

INPUT MODE      * 4100-VALIDACION-FORMAL

INPUT MODE      * 4200-VALIDACION-SEMANTICA

INPUT MODE      * 4300-MODIFICAR-BDIIALE

INPUT MODE      * 4300-MODIFICAR-BDIIALE-DATOS

INPUT MODE      * 4300-MODIFICAR-BDIIALE-I

INPUT MODE      * 4300-MODIFICAR-BDIIALE-M

INPUT MODE      * 4300-MODIFICAR-BDIIALE-E

INPUT MODE      * 4333-LEER-BDIIALE-RANDOM

INPUT MODE      * 4333-GRABAR-BDIIALE

INPUT MODE      * 4333-REGRABAR-BDIIALE

INPUT MODE      * 4333-ELIMINAR-BDIIALE

INPUT MODE      * 4800-PROCESO-REG-T

INPUT MODE      * 4900-GRABAR-ERROR

INPUT MODE      * 4320-ARMAR-TEXTO-ALERTA

INPUT MODE      * 1000-RUTINA-INICIAL

INPUT MODE      * 1022-CARGAR-INCONSISTENTES

INPUT MODE      * 1000-NOT-USED

INPUT MODE      * 1001-ELIMINAR-TODO

INPUT MODE      * 7000-RUTINA-FINAL

INPUT MODE      * 9000-CANCELAR-PROGRAMA

INPUT MODE

INPUT MODE

INPUT MODE       0000-PROGRAMA-PRINCIPAL.

INPUT MODE      ******************************************************************

INPUT MODE      *    inicializa el ambiente y abre los archivos

INPUT MODE           perform 1000-RUTINA-INICIAL

INPUT MODE      *    procesa cada uno de los registros del archivo JURAD hasta

INPUT MODE      *    encontrar el registro "T" de totales

INPUT MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

INPUT MODE      *    cierra archivos y produce el reporte final

INPUT MODE           perform 7000-RUTINA-FINAL

INPUT MODE           goback.

INPUT MODE

INPUT MODE       4000-PROCESAR-REGISTRO.

INPUT MODE      ****************************************************************

INPUT MODE      * Proceso de un registro del archivo de entrada JURAD

INPUT MODE      * Lectura y control del file status del archivo

INPUT MODE      ****************************************************************

INPUT MODE      *    lectura del proximo registro

INPUT MODE           read JURAD

INPUT MODE           evaluate JURAD-fs

INPUT MODE           when "00"

INPUT MODE      *        controla el reg y lo aplica si es OK

INPUT MODE               perform 4000-PROCESAR-REGISTRO-2

INPUT MODE               move JURAD-reg to JURAD-reg-anterior

INPUT MODE           when "10"

INPUT MODE      *        fin del archivo de input:

INPUT MODE      *        esto es un error, no se encontro el registro "T" antes

INPUT MODE      *        de que se terminara el archivo

INPUT MODE               display "Falta el reg de totales del archivo JURAD "

INPUT MODE               display "Nombre del archivo: " P-file-name

INPUT MODE               display "File status: " JURAD-fs

INPUT MODE               display "Ultimo registro leido: " N-reg-leidos

INPUT MODE               display JURAD-reg-anterior

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           when other

INPUT MODE      *        error de lectura: cancelacion del proceso

INPUT MODE               display "Error en lectura del archivo JURAD "

INPUT MODE               display "Nombre del archivo: " P-file-name

INPUT MODE               display "File status: " JURAD-fs

INPUT MODE               display "Ultimo registro leido: " N-reg-leidos

INPUT MODE               display JURAD-reg-anterior

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE

INPUT MODE       4000-PROCESAR-REGISTRO-2.

INPUT MODE      ****************************************************************

INPUT MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

INPUT MODE      * para actualizar el archivo de alertas en linea

INPUT MODE      * La informacion esta leida en JURAD-reg

INPUT MODE      ****************************************************************

INPUT MODE           move "NO" to E-hay-error

INPUT MODE

INPUT MODE      *    validacion del tipo de movimiento

INPUT MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

INPUT MODE               call "PONERR" using "01" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE

INPUT MODE      *    si es el registro "T" hay que sealar el fin de proceso

INPUT MODE           if JURAD-tipo-novedad = "T"

INPUT MODE               move "SI" to IND-fin-proceso

INPUT MODE               perform 4800-PROCESO-REG-T

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE

INPUT MODE           add 1 to N-reg-leidos

INPUT MODE

INPUT MODE      *    validacion formal de los datos

INPUT MODE           move 0 to codigo-error

INPUT MODE           perform 4100-VALIDACION-FORMAL

INPUT MODE           if E-hay-error = "SI"

INPUT MODE               perform 4900-GRABAR-ERROR

INPUT MODE               perform 4200-CONTAR-TIPO-CUENTA

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE

INPUT MODE      *    si la validacion formal dio OK se hace validacion semantica

INPUT MODE           perform 4200-VALIDACION-SEMANTICA

INPUT MODE           if E-hay-error = "SI"

INPUT MODE               perform 4900-GRABAR-ERROR

INPUT MODE               perform 4200-CONTAR-TIPO-CUENTA

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE

INPUT MODE           perform 4240-CONTAR-TIPO-CUENTA

INPUT MODE

INPUT MODE      *    intento de actualizacion de BDIIALE

INPUT MODE           perform 4300-MODIFICAR-BDIIALE

INPUT MODE           add 1 to N-reg-OK.

INPUT MODE

INPUT MODE

INPUT MODE

INPUT MODE       4100-VALIDACION-FORMAL.

INPUT MODE      ******************************************************************

INPUT MODE      * Validacion formal de los datos del input

INPUT MODE      ******************************************************************

INPUT MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

INPUT MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

INPUT MODE               call "PONERR" using "02" JURAD-reg E-errores

INPUT MODE               move 05 to codigo-error

INPUT MODE           end-if

INPUT MODE      *    Numero de identificacion

INPUT MODE           if JURAD-id-numeroX is not numeric

INPUT MODE               call "PONERR" using "03" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE           if JURAD-id-numero not > 0

INPUT MODE               call "PONERR" using "04" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    si el movimiento es una eliminacion los datos subsiguientes

INPUT MODE      *    no se controlan

INPUT MODE           if JURAD-tipo-novedad = "E"

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE      *    Nombres y Apellidos

INPUT MODE           if JURAD-nombre = spaces

INPUT MODE               call "PONERR" using "05" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    Numero de demandas vigentes

INPUT MODE           if JURAD-demandas-vigentes is not numeric

INPUT MODE               call "PONERR" using "06" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    Numero de demandas terminadas

INPUT MODE           if JURAD-demandas-terminadas is not numeric

INPUT MODE               call "PONERR" using "07" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    Fecha ultima demanda vigente YYMMDD

INPUT MODE           if JURAD-demandas-fecha-ultima is not numeric

INPUT MODE               call "PONERR" using "08" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

INPUT MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

INPUT MODE               call "PONERR" using "09" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    Numero de embargos vigentes

INPUT MODE           if JURAD-embargos-vigentes not numeric

INPUT MODE               call "PONERR" using "10" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    Numero de embargos terminados

INPUT MODE           if JURAD-embargos-terminados not numeric

INPUT MODE               call "PONERR" using "11" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    Fecha ultimo embargo vigente YYMMDD

INPUT MODE           if JURAD-embargos-fecha-ultimo is not numeric

INPUT MODE               call "PONERR" using "12" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

INPUT MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

INPUT MODE               call "PONERR" using "13" JURAD-reg E-errores

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE       4200-VALIDACION-SEMANTICA.

INPUT MODE      ****************************************************************

INPUT MODE      * Validacion del numero de identificacion y de su relacion con

INPUT MODE      * el nombre

INPUT MODE      ****************************************************************

INPUT MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

INPUT MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

INPUT MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

INPUT MODE

INPUT MODE           move JURAD-id-tipo to TIPOID-E

INPUT MODE           move JURAD-id-numero to NUMID-E

INPUT MODE           move JURAD-nombre NOMBRE-E

INPUT MODE

INPUT MODE           move 1 to SW-VERIFNOM-BDIIVIDE

INPUT MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

INPUT MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

INPUT MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

INPUT MODE           END-IF

INPUT MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

INPUT MODE      *    Valida el numero de identificacin contra las bases de

INPUT MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,

INPUT MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

INPUT MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

INPUT MODE           perform 80100-VALIDAR-IDENTIFICACION

INPUT MODE      *    a ver si la validacion cambio el tipo de ide

INPUT MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

INPUT MODE               call "PONERR" using "16" JURAD-reg E-errores

INPUT MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

INPUT MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

INPUT MODE           end-if

INPUT MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

INPUT MODE           if SW-ID-BDIIVIDE = 1

INPUT MODE      *        es un id invlido

INPUT MODE               call "PONERR" using "14" JURAD-reg E-errores

INPUT MODE      *        valida contra la base alterna

INPUT MODE               call "PONERR" using "14" JURAD-reg E-errores

INPUT MODE               perform 4210-VALIDACION-ID-NO-FIGURA

INPUT MODE           else

INPUT MODE      *        existe id, a ver si el nombre coincide

INPUT MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

INPUT MODE                   call "PONERR" using "15" JURAD-reg E-errores

INPUT MODE                   display "novedad:  " JURAD-nombre

INPUT MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

INPUT MODE      *            validacin en base alterna

INPUT MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

INPUT MODE               else

INPUT MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

INPUT MODE               end-if

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

INPUT MODE      ******************************************************************

INPUT MODE      * Validacin de IDs que figuran OK pero el nombre no coincide

INPUT MODE      ******************************************************************

INPUT MODE      *    nombre no coincide

INPUT MODE           IF TIP-IDE-BDIIVIDE = 1

INPUT MODE      *        es una cdula

INPUT MODE               MOVE 02 TO CODIGO-ERROR

INPUT MODE           ELSE

INPUT MODE      *        no es una cdula

INPUT MODE               MOVE 01 TO CODIGO-ERROR

INPUT MODE           END-IF.

INPUT MODE

INPUT MODE

INPUT MODE       4222-VALIDA-NOMBRE-COINCIDE.

INPUT MODE      ******************************************************************

INPUT MODE      * Validacin de IDs que figuran OK pero el nombre coincide

INPUT MODE      ******************************************************************

INPUT MODE      *    nombre coincide: busca ID en BDIIALE

INPUT MODE           initialize LLAVE-BDIIALE

INPUT MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

INPUT MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

INPUT MODE           move 990003 to FUENTE-BDIIALE

INPUT MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

INPUT MODE               move 1 TO SW-BDIIALE

INPUT MODE           not invalid key

INPUT MODE               move 0 to SW-BDIIALE

INPUT MODE               read BDIIALE next record

INPUT MODE               at end

INPUT MODE                   move 1 to SW-BDIIALE

INPUT MODE               end-read

INPUT MODE           end-start

INPUT MODE

INPUT MODE           perform until SW-BDIIALE = 1

INPUT MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

INPUT MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

INPUT MODE               if FUENTE-BDIIALE = 990003

INPUT MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

INPUT MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

INPUT MODE               and BLOQUEO-BDIIALE = 0

INPUT MODE      *             encontrado

INPUT MODE                    move 1 to SW-BDIIALE

INPUT MODE               end-if

INPUT MODE               if SW-BDIIALE = 0

INPUT MODE                   read BDIIALE next record at end

INPUT MODE                       move 1 to SW-BDIIALE

INPUT MODE                   end-read

INPUT MODE               end-if

INPUT MODE           end-perform.

INPUT MODE

INPUT MODE           if TIP-IDE-BDIIVIDE = 1

INPUT MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

INPUT MODE                   move 07 to CODIGO-ERROR

INPUT MODE               else

INPUT MODE                   if ESTADO-VIG-BDIIREGI = 21

INPUT MODE                       move 06 to CODIGO-ERROR

INPUT MODE                       add 1 to NO-COINCIDE-REGIS

INPUT MODE                       add 1 to CONT-FALLECIDOS

INPUT MODE                   end-if

INPUT MODE               end-if

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE       4200-CONTAR-TIPO-CUENTA.

INPUT MODE      ******************************************************************

INPUT MODE      *    Conteo de los registros por "tipo", dependiendo del cdigo

INPUT MODE      *    de error:

INPUT MODE      *    tipo 5: sin error

INPUT MODE      *    tipo 6: 01 02 06 07

INPUT MODE      *    tipo 7: 03 04 05

INPUT MODE      ******************************************************************

INPUT MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

INPUT MODE               ADD 1 TO W-CONT-TIPO-6

INPUT MODE           ELSE

INPUT MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

INPUT MODE                   ADD 1 TO W-CONT-TIPO-7

INPUT MODE               ELSE

INPUT MODE      *            registros correctos, repetidos o no

INPUT MODE                   ADD 1 TO W-CONT-TIPO-5

INPUT MODE      *            si es una empresa

INPUT MODE                   IF TIPOID-E = 2 OR 3

INPUT MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

INPUT MODE                   END-IF

INPUT MODE               END-IF

INPUT MODE           END-IF.

INPUT MODE

INPUT MODE

INPUT MODE       4210-VALIDACION-ID-NO-FIGURA.

INPUT MODE      ******************************************************************

INPUT MODE      * Validacin de IDs que no figuran en las bases normales

INPUT MODE      ******************************************************************

INPUT MODE           MOVE 0 TO HACER-MATCH

INPUT MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

INPUT MODE      *    valida si la identificacin est en la base de datos

INPUT MODE      *    alterna

INPUT MODE           PERFORM 513-VALIDA-EN-CSV

INPUT MODE           IF IDE-TIPO-BDAMATCH = 0

INPUT MODE               IF TIP-IDE-BDIIVIDE = 1

INPUT MODE      *            es una cdula

INPUT MODE                   MOVE 04 TO CODIGO-ERROR

INPUT MODE               else

INPUT MODE      *            no es una cdula

INPUT MODE                   MOVE 03 TO CODIGO-ERROR

INPUT MODE               END-IF

INPUT MODE           END-IF.

INPUT MODE

INPUT MODE

INPUT MODE       4300-MODIFICAR-BDIIALE.

INPUT MODE      ******************************************************************

INPUT MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

INPUT MODE      * modificaciones o eliminaciones segun haya o no demandas y

INPUT MODE      * embargos

INPUT MODE      ******************************************************************

INPUT MODE           initialize REG-BDIIALE

INPUT MODE

INPUT MODE      *    si hay demandas

INPUT MODE           if JURAD-demandas-vigentes > zero

INPUT MODE           or JURAD-demandas-terminadas > zero

INPUT MODE               move "J001" to LLASEC-BDIIALE

INPUT MODE      *        arma datos de demandas

INPUT MODE               move JURAD-demandas-vigentes to D-vigentes

INPUT MODE               move JURAD-demandas-terminadas to D-terminados

INPUT MODE               string "20" JURAD-demandas-fecha-ultima

INPUT MODE               delimited size into D-fecha-ultima

INPUT MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

INPUT MODE           end-if.

INPUT MODE

INPUT MODE      *    si hay embargos

INPUT MODE           if JURAD-embargos-vigentes > zero

INPUT MODE           or JURAD-embargos-terminados > zero

INPUT MODE               move "J002" to LLASEC-BDIIALE

INPUT MODE      *        arma datos de embargos

INPUT MODE               move JURAD-embargos-vigentes to D-vigentes

INPUT MODE               move JURAD-embargos-terminados to D-terminados

INPUT MODE               string "20" JURAD-embargos-fecha-ultimo

INPUT MODE               delimited size into D-fecha-ultima

INPUT MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE

INPUT MODE       4300-MODIFICAR-BDIIALE-DATOS.

INPUT MODE      ******************************************************************

INPUT MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

INPUT MODE      * del mismo que es comun a demandas y embargos

INPUT MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

INPUT MODE      ******************************************************************

INPUT MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

INPUT MODE      *    el file status de BDIIALE queda con "00"

INPUT MODE           perform 4333-LEER-BDIIALE-RANDOM

INPUT MODE

INPUT MODE      *    procesa segun el tipo de novedad I M E

INPUT MODE           evaluate JURAD-tipo-novedad

INPUT MODE           when "I"

INPUT MODE               add 1 to N-reg-tipo-I-OK

INPUT MODE               perform 4300-MODIFICAR-BDIIALE-I

INPUT MODE           when "M"

INPUT MODE               add 1 to N-reg-tipo-M-OK

INPUT MODE               perform 4300-MODIFICAR-BDIIALE-M

INPUT MODE           when "E"

INPUT MODE               add 1 to N-reg-tipo-E-OK

INPUT MODE               perform 4300-MODIFICAR-BDIIALE-E

INPUT MODE           when other

INPUT MODE      *        esto es "imposible" por control de consistencia anterior

INPUT MODE               display "error de logica: tipo-novedad="

INPUT MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos

INPUT MODE               display "Registro de JURAD: " display JURAD-reg

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE

INPUT MODE       4300-MODIFICAR-BDIIALE-I.

INPUT MODE      ******************************************************************

INPUT MODE      * Insercion de una alerta nueva

INPUT MODE      * Si ya existia muestra un mensaje y continua

INPUT MODE      ******************************************************************

INPUT MODE      *    si el registro existia es un error

INPUT MODE           if EST-BDIIALE = "00"

INPUT MODE               display "Insercion de alerta nueva que ya existe "

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Registro de input: "

INPUT MODE               display JURAD-reg

INPUT MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

INPUT MODE               add 1 to N-ale-ya-existe

INPUT MODE           end-if

INPUT MODE

INPUT MODE      *    completa los datos del registro

INPUT MODE           initialize ENCABEZADO-BDIIALE

INPUT MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

INPUT MODE           FEC-REP-BDIIALE

INPUT MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

INPUT MODE           move 0 to BLOQUEO-BDIIALE

INPUT MODE           move D-datahost to INF-DATAHOST-BDIIALE

INPUT MODE           perform 4320-ARMAR-TEXTO-ALERTA

INPUT MODE           if EST-BDIIALE = "00"

INPUT MODE               perform 4333-REGRABAR-BDIIALE

INPUT MODE           else

INPUT MODE               perform 4333-GRABAR-BDIIALE

INPUT MODE           end-if.

INPUT MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

INPUT MODE      *    " fs:" EST-BDIIALE.

INPUT MODE

INPUT MODE

INPUT MODE       4300-MODIFICAR-BDIIALE-M.

INPUT MODE      ******************************************************************

INPUT MODE      * Modificacion de una alerta existente

INPUT MODE      * Si no existia muestra un mensaje y continua

INPUT MODE      ******************************************************************

INPUT MODE      *    si el registro no existia es un error

INPUT MODE           if EST-BDIIALE not = "00"

INPUT MODE               display "Modificacion de alerta inexistente "

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Registro de input: "

INPUT MODE               display JURAD-reg

INPUT MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

INPUT MODE               add 1 to N-ale-no-existe

INPUT MODE               call "PONERR" using "17" JURAD-reg E-errores

INPUT MODE           end-if

INPUT MODE      *    reemplaza la fecha de reporte y los valores

INPUT MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

INPUT MODE           move D-datahost to INF-DATAHOST-BDIIALE

INPUT MODE           perform 4320-ARMAR-TEXTO-ALERTA

INPUT MODE           if EST-BDIIALE = "00"

INPUT MODE               perform 4333-REGRABAR-BDIIALE

INPUT MODE           else

INPUT MODE               perform 4333-GRABAR-BDIIALE

INPUT MODE           end-if.

INPUT MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

INPUT MODE      *    " fs:" EST-BDIIALE.

INPUT MODE

INPUT MODE

INPUT MODE       4300-MODIFICAR-BDIIALE-E.

INPUT MODE      ******************************************************************

INPUT MODE      * Eliminacion de una alerta

INPUT MODE      * Si no existia muestra un mensaje y continua

INPUT MODE      ******************************************************************

INPUT MODE      *    elimina el registro

INPUT MODE           if EST-BDIIALE = "00"

INPUT MODE               perform 4333-ELIMINAR-BDIIALE

INPUT MODE           else

INPUT MODE               display "Eliminacion de alerta inexistente "

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Registro de input: "

INPUT MODE               display JURAD-reg

INPUT MODE               add 1 to N-ale-no-existe

INPUT MODE               call "PONERR" using "18" JURAD-reg E-errores

INPUT MODE           end-if.

INPUT MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

INPUT MODE      *    " fs:" EST-BDIIALE.

INPUT MODE

INPUT MODE

INPUT MODE       4333-LEER-BDIIALE-RANDOM.

INPUT MODE      ******************************************************************

INPUT MODE      * Arma clave exacta y lee un registro de BDIIALE

INPUT MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

INPUT MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

INPUT MODE      ******************************************************************

INPUT MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

INPUT MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

INPUT MODE           move P-cod-suscriptor to FUENTE-BDIIALE

INPUT MODE           move 000 to COD-ALERTA-BDIIALE

INPUT MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002

INPUT MODE

INPUT MODE           read BDIIALE

INPUT MODE           evaluate EST-BDIIALE

INPUT MODE           when "00"

INPUT MODE               continue

INPUT MODE           when "23"

INPUT MODE               continue

INPUT MODE           when other

INPUT MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Ultimo registro procesado: "

INPUT MODE               display JURAD-reg-anterior

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

INPUT MODE      *    " fs:" EST-BDIIALE.

INPUT MODE

INPUT MODE

INPUT MODE       4333-GRABAR-BDIIALE.

INPUT MODE      ******************************************************************

INPUT MODE      * Inserta un registro nuevo en BDIIALE

INPUT MODE      ******************************************************************

INPUT MODE           if not PROCESO-REAL

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE           write REG-BDIIALE

INPUT MODE           evaluate EST-BDIIALE

INPUT MODE           when "00"

INPUT MODE               add 1 to N-ale-insertadas

INPUT MODE           when other

INPUT MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Registro BDIIALE: "

INPUT MODE               display REG-BDIIALE

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE

INPUT MODE       4333-REGRABAR-BDIIALE.

INPUT MODE      ******************************************************************

INPUT MODE      * Regraba un registro modificado en BDIIALE

INPUT MODE      ******************************************************************

INPUT MODE           if not PROCESO-REAL

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE           rewrite REG-BDIIALE

INPUT MODE           evaluate EST-BDIIALE

INPUT MODE           when "00"

INPUT MODE               add 1 to N-ale-modificadas

INPUT MODE           when other

INPUT MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Registro BDIIALE: "

INPUT MODE               display REG-BDIIALE

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE

INPUT MODE       4333-ELIMINAR-BDIIALE.

INPUT MODE      ******************************************************************

INPUT MODE      * Elimina un registro de BDIIALE

INPUT MODE      ******************************************************************

INPUT MODE           if not PROCESO-REAL

INPUT MODE               exit paragraph

INPUT MODE           end-if

INPUT MODE           delete BDIIALE

INPUT MODE           evaluate EST-BDIIALE

INPUT MODE           when "00"

INPUT MODE               add 1 to N-ale-eliminadas

INPUT MODE           when other

INPUT MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

INPUT MODE               " key: " LLAVE-BDIIALE

INPUT MODE               display "Registro BDIIALE: "

INPUT MODE               display REG-BDIIALE

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE       4800-PROCESO-REG-T.

INPUT MODE      ******************************************************************

INPUT MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

INPUT MODE      * de control, y debera ser el ultimo del archivo

INPUT MODE      ******************************************************************

INPUT MODE      * Control de los totales calculados contra los esperados

INPUT MODE           move "NO" to E-hay-error

INPUT MODE      *    cantidad de registros I M E

INPUT MODE           if function numval(JURADT-registros) = N-reg-leidos

INPUT MODE               continue

INPUT MODE           else

INPUT MODE               display " "

INPUT MODE               display "No coincide la cantidad de registros:"

INPUT MODE               JURADT-registros " con los leidos:" N-reg-leidos

INPUT MODE               move "SI" to E-hay-error

INPUT MODE           end-if

INPUT MODE

INPUT MODE      *    Sumas de cantidades de demandas y embargos

INPUT MODE           if function numval(JURADT-demandas-terminadas)

INPUT MODE           = N-demandas-terminadas

INPUT MODE               continue

INPUT MODE           else

INPUT MODE               display " "

INPUT MODE               display "No coincide total de demandas terminadas:"

INPUT MODE               JURADT-demandas-terminadas " con el calculado:"

INPUT MODE               N-demandas-terminadas

INPUT MODE               move "SI" to E-hay-error

INPUT MODE           end-if

INPUT MODE

INPUT MODE           if function numval(JURADT-embargos-vigentes)

INPUT MODE           = N-embargos-vigentes

INPUT MODE               continue

INPUT MODE           else

INPUT MODE               display " "

INPUT MODE               display "No coincide total de embargos vigentes:"

INPUT MODE               JURADT-embargos-vigentes " con el calculado:"

INPUT MODE               N-embargos-vigentes

INPUT MODE               move "SI" to E-hay-error

INPUT MODE           end-if

INPUT MODE

INPUT MODE           if function numval(JURADT-embargos-terminados)

INPUT MODE           = N-embargos-terminados

INPUT MODE               continue

INPUT MODE           else

INPUT MODE               display " "

INPUT MODE               display "No coincide total de embargos terminados:"

INPUT MODE               JURADT-embargos-terminados " con el calculado:"

INPUT MODE               N-embargos-terminados

INPUT MODE               move "SI" to E-hay-error

INPUT MODE           end-if.

INPUT MODE

INPUT MODE      *    si hubo cualquier cosa se invalida el proceso

INPUT MODE           if E-hay-error = "SI"

INPUT MODE               display "Error en registro T de totales de control"

INPUT MODE               display "Nombre del archivo: " ERRS-file-name

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE       4900-GRABAR-ERROR.

INPUT MODE      ******************************************************************

INPUT MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

INPUT MODE      * con indicacion del error detectado

INPUT MODE      ******************************************************************

INPUT MODE           move JURAD-reg to ERRS-reg

INPUT MODE           move E-errores-reg to ERRS-causa-rechazo

INPUT MODE      *    lista de los codigos de los errores del registro

INPUT MODE           move E-errores-reg to ERRS-causa-rechazo

INPUT MODE           write ERRS-reg

INPUT MODE           evaluate ERRS-fs

INPUT MODE               when "00"

INPUT MODE                   continue

INPUT MODE               when other

INPUT MODE                   display "Error al grabar el archivo de errores "

INPUT MODE                   display "Nombre del archivo: " ERRS-file-name

INPUT MODE                   display "File status: " ERRS-fs

INPUT MODE                   perform 9000-CANCELAR-PROGRAMA

INPUT MODE                   goback

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE

INPUT MODE       4320-ARMAR-TEXTO-ALERTA.

INPUT MODE      ****************************************************************

INPUT MODE      * Hace el reemplazo de los valores adecuados en los templates

INPUT MODE      * de las linea de alerta que corresponde

INPUT MODE      ****************************************************************

INPUT MODE      *    segun se trate de demandas o embargos

INPUT MODE           if JURAD-demandas-vigentes not = 0

INPUT MODE           or JURAD-demandas-terminadas not = 0

INPUT MODE               set LAx to 1

INPUT MODE               move high-values to LA-valores

INPUT MODE               move JURAD-demandas-vigentes to LA-num

INPUT MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

INPUT MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

INPUT MODE      *        delimited by all space

INPUT MODE               move LA-numx(9:12) to LA-valor(1)

INPUT MODE               move JURAD-demandas-terminadas to LA-num

INPUT MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

INPUT MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

INPUT MODE      *        delimited by all space

INPUT MODE               move LA-numx(9:12) to LA-valor(2)

INPUT MODE

INPUT MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

INPUT MODE      * >>>> da error en el end-if

INPUT MODE      *        string LA-parte(LAx, 1) LA-valor(1)

INPUT MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

INPUT MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

INPUT MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

INPUT MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

INPUT MODE      *        LA-parte(LAx, 10) LA-valor(10)

INPUT MODE      *        delimited by high-value

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE       1000-RUTINA-INICIAL.

INPUT MODE      ******************************************************************

INPUT MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

INPUT MODE      * del programa:

INPUT MODE      *   - obtencion de los parametros

INPUT MODE      *   - apertura del archivo de entrada

INPUT MODE      *   - apertura de todos los demas archivos

INPUT MODE      *   - eliminacion de datos existentes si es refresque completo

INPUT MODE      *   - carga en memoria de los IDs de inconsistentes

INPUT MODE      ******************************************************************

INPUT MODE      * Registra hora de inicio

INPUT MODE           accept W-hora-inicio from time

INPUT MODE

INPUT MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

INPUT MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

INPUT MODE      * el indicador de proceso real o en falso (default)

INPUT MODE           accept P-command-line from COMMAND-LINE

INPUT MODE           display "Parametros: " P-command-line

INPUT MODE           unstring P-command-line delimited by all " " into

INPUT MODE           P-file-name P-proceso-real

INPUT MODE

INPUT MODE      * El programa se anuncia en la consola

INPUT MODE      * TODO: se usa un anuncio mas vistoso?

INPUT MODE           if PROCESO-REAL

INPUT MODE               display pgm " Carga de archivo JURAD - proceso REAL"

INPUT MODE           else

INPUT MODE               display pgm " Carga de archivo JURAD - proceso en falso"

INPUT MODE           end-if

INPUT MODE

INPUT MODE      * El indicador de proceso real debe ser 1 o 2

INPUT MODE           if P-proceso-real not = "1" and "2"

INPUT MODE               display "El indicador de proceso real es invalido"

INPUT MODE               display "debe ser 1 o 2"

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-if

INPUT MODE

INPUT MODE      * TODO: controlar los componentes del filename

INPUT MODE           evaluate P-tipo-proceso

INPUT MODE           when "01"

INPUT MODE               display "01 Envio Original - Carga TOTAL 1a vez"

INPUT MODE           when "02"

INPUT MODE               display "02 Archivo Semanal - Carga PARCIAL"

INPUT MODE           when "03"

INPUT MODE               display "03 Archivo Mensual - Carga PARCIAL"

INPUT MODE           when "04"

INPUT MODE               display "04 Refresque Total - Carga TOTAL"

INPUT MODE           when other

INPUT MODE      *        valor invalido

INPUT MODE               display "El tipo de proceso " P-tipo-proceso

INPUT MODE               " es invalido (debe ser 01 02 03 o 04)"

INPUT MODE               perform 9000-CANCELAR-PROGRAMA

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

INPUT MODE      * YYYYMMDD

INPUT MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

INPUT MODE           P-fecha-proceso(1:2) delimited size

INPUT MODE           into P-fecha-proceso-YYYYMMDD

INPUT MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

INPUT MODE

INPUT MODE      * Calcula una fecha 50 anios posterior a la de proceso

INPUT MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

INPUT MODE           add 50 to P-fecha-proceso-50YYYY

INPUT MODE

INPUT MODE      * Apertura del archivo de entrada

INPUT MODE           string "$TEMPORALES/" P-file-name into P-file-path

INPUT MODE           open input JURAD

INPUT MODE           evaluate JURAD-fs

INPUT MODE               when "00"

INPUT MODE                    continue

INPUT MODE               when other

INPUT MODE                   display "Error en open del archivo JURAD "

INPUT MODE                   display "Path del archivo: " P-file-path

INPUT MODE                   display "File status: " JURAD-fs

INPUT MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

INPUT MODE                   goback

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE      * Apertura del archivo de errores

INPUT MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

INPUT MODE           into ERRS-file-name

INPUT MODE           open output ERRS

INPUT MODE           evaluate ERRS-fs

INPUT MODE               when "00"

INPUT MODE                    continue

INPUT MODE               when other

INPUT MODE                   display "Error en open del archivo de errores "

INPUT MODE                   display "Nombre del archivo: " ERRS-file-name

INPUT MODE                   display "File status: " ERRS-fs

INPUT MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

INPUT MODE                   goback

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE      * Apertura de los archivos maestros

INPUT MODE      * TODO: falta capturar el status de estas operaciones?

INPUT MODE           open input BDIIREGI

INPUT MODE           open input BDIIDIAN

INPUT MODE           open input BDIIDAS.

INPUT MODE

INPUT MODE      * Apertura del archivo de alertas en linea

INPUT MODE           if PROCESO-REAL

INPUT MODE               open i-o BDIIALE

INPUT MODE           else

INPUT MODE               open input BDIIALE

INPUT MODE           end-if.

INPUT MODE

INPUT MODE      * Si es un refresque total (codigo 04) se eliminan los registros

INPUT MODE      * de Jurad existentes

INPUT MODE           if P-tipo-proceso = "04" and PROCESO-REAL

INPUT MODE               perform 1001-ELIMINAR-TODO

INPUT MODE           end-if.

INPUT MODE

INPUT MODE

INPUT MODE       1000-NOT-USED.

INPUT MODE      ******************************************************************

INPUT MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

INPUT MODE      * blanco, me parece que se deberan cargar, aunque sea de manera

INPUT MODE      * precaria, por si justo cae una consulta para uno de los IDs

INPUT MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

INPUT MODE      * que se ejecute el programa que genera los textos.

INPUT MODE      ******************************************************************

INPUT MODE      * >>>> esto da un error de compilacion que no puedo resolver

INPUT MODE      * >>>> por ahora esta anulado

INPUT MODE      ******************************************************************

INPUT MODE      * Carga de los templates para armar el texto de alertas

INPUT MODE      * TODO: por ahora los templates son literales

INPUT MODE           set LAx to 0

INPUT MODE           move high-values to LA-templates

INPUT MODE           perform varying LAm from 1 by 1

INPUT MODE           until LA-modelo(LAm) = high-values

INPUT MODE               set LAx up by 1

INPUT MODE      *        separa las partes de la linea

INPUT MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

INPUT MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

INPUT MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

INPUT MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

INPUT MODE      *        delimited by all "&"

INPUT MODE      *        prepara para omitir los espacios al final de c/parte

INPUT MODE               perform varying LAy from 1 by 1 until LAy > 10

INPUT MODE                   inspect LA-parte(LAx, LAy) replacing trailing

INPUT MODE                   spaces by high-values

INPUT MODE                   inspect LA-parte(LAx, LAy) replacing first

INPUT MODE                   high-value by space

INPUT MODE               end-perform

INPUT MODE           end-perform.

INPUT MODE

INPUT MODE

INPUT MODE       1001-ELIMINAR-TODO.

INPUT MODE      ******************************************************************

INPUT MODE      * Elimina los registros de alertas existentes en el archivo de

INPUT MODE      * alertas en linea, previo a un refresque total

INPUT MODE      ******************************************************************

INPUT MODE           display "Eliminando toda la informacion con fuente JURAD"

INPUT MODE      *    posiciona en el primer reg de JURAD

INPUT MODE           move zero to TIP-IDE-BDIIALE

INPUT MODE           move zero to NUM-IDE-BDIIALE

INPUT MODE           move P-cod-suscriptor to FUENTE-BDIIALE

INPUT MODE           move zeros to COD-ALERTA-BDIIALE

INPUT MODE           move low-values to LLASEC-BDIIALE

INPUT MODE           start BDIIALE key > LLAVE-BDIIALE

INPUT MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

INPUT MODE           evaluate EST-BDIIALE

INPUT MODE           when "00"

INPUT MODE      *        posicionado

INPUT MODE               continue

INPUT MODE           when other

INPUT MODE      *        no hay registros

INPUT MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

INPUT MODE               exit paragraph

INPUT MODE           end-evaluate.

INPUT MODE

INPUT MODE      *    lee secuencialmente y elimina los registros de JURAD

INPUT MODE      *    hasta el fin del archivo

INPUT MODE           perform until EST-BDIIALE not = "00"

INPUT MODE               read BDIIALE next record

INPUT MODE               evaluate EST-BDIIALE

INPUT MODE               when "00"

INPUT MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

INPUT MODE      *            " k:" LLAVE-BDIIALE

INPUT MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

INPUT MODE      *                es un alerta de JURAD

INPUT MODE                       delete BDIIALE

INPUT MODE                       if EST-BDIIALE = "00"

INPUT MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

INPUT MODE                           add 1 to N-ale-borradas

INPUT MODE                       else

INPUT MODE      *                    error en la eliminacion

INPUT MODE                           display "Error al eliminar un registro de "

INPUT MODE                           "BDIIALE vaciando los datos"

INPUT MODE                           display "Clave: " LLAVE-BDIIALE

INPUT MODE                           display "Reg borrados: " N-ale-borradas

INPUT MODE                           perform 9000-CANCELAR-PROGRAMA

INPUT MODE                       end-if

INPUT MODE                   end-if

INPUT MODE               when "10"

INPUT MODE      *            fin de archivo: sale normalmente

INPUT MODE                   display "Fin de los registros a eliminar - ledos:"

INPUT MODE                   N-ale-leidas

INPUT MODE               when other

INPUT MODE      *            lectura anormal: cancelacion del programa

INPUT MODE                   display "Error en lectura del archivo de alertas "

INPUT MODE                   "online"

INPUT MODE                   display "File status: " EST-BDIIALE

INPUT MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

INPUT MODE               end-evaluate

INPUT MODE           end-perform.

INPUT MODE           display "Termino la eliminacion total de JURAD"

INPUT MODE           display "Reg borrados: " N-ale-borradas.

INPUT MODE

INPUT MODE

INPUT MODE       7000-RUTINA-FINAL.

INPUT MODE      ******************************************************************

INPUT MODE      * Registra hora de finalizacion

INPUT MODE           accept W-hora-fin from time

INPUT MODE

INPUT MODE      * Leer JURAD a ver si hay registros despues del "T"

INPUT MODE

INPUT MODE      * Close todos los archivos

INPUT MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

INPUT MODE

INPUT MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

INPUT MODE      * Emision de contadores de registros

INPUT MODE           display " "

INPUT MODE           display "Totales de registros:"

INPUT MODE           display " "

INPUT MODE      *    porcentaje registros procesados OK

INPUT MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

INPUT MODE           display N-editp100 "% de registros correctos"

INPUT MODE      *    porcentaje registros inconsistentes

INPUT MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

INPUT MODE           / N-reg-leidos

INPUT MODE           display N-editp100 "% de registros inconsistentes"

INPUT MODE      *    cantidad de registros ledos (excludo el registro "T")

INPUT MODE           move N-reg-leidos to N-edit

INPUT MODE           display N-edit "Registros IME en el archivo de entrada"

INPUT MODE      *    cantidad de registros procesados sin error

INPUT MODE           move N-reg-OK to N-edit

INPUT MODE           display N-edit "Registros procesados sin error"

INPUT MODE

INPUT MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

INPUT MODE      * definicion de estos contadores

INPUT MODE      *    move N-reg-tipo-I-OK to N-edit

INPUT MODE      *    display N-edit "Registros tipo I aceptados"

INPUT MODE      *    move N-reg-tipo-M-OK to N-edit

INPUT MODE      *    display N-edit "Registros tipo M aceptados"

INPUT MODE      *    move N-reg-tipo-E-OK to N-edit

INPUT MODE      *    display N-edit "Registros tipo E aceptados"

INPUT MODE

INPUT MODE      *    cantidad de registros con error

INPUT MODE           move E-cont-regs-con-error to N-reg-con-error

INPUT MODE           move N-reg-con-error to N-edit

INPUT MODE           display N-edit "Registros con error"

INPUT MODE      *    cantidades de alertas afectadas

INPUT MODE           if P-tipo-proceso = "04"

INPUT MODE               move N-ale-borradas to N-edit

INPUT MODE               display N-edit

INPUT MODE               "Alertas borradas previo al refresque total"

INPUT MODE           end-if

INPUT MODE           move N-ale-insertadas to N-edit

INPUT MODE           display N-edit "Alertas insertadas"

INPUT MODE           move N-ale-modificadas to N-edit

INPUT MODE           display N-edit "Alertas modificadas"

INPUT MODE           move N-ale-eliminadas to N-edit

INPUT MODE           display N-edit "Alertas eliminadas"

INPUT MODE           move N-ale-ya-existe to N-edit

INPUT MODE           display N-edit "Insercion de alerta existente"

INPUT MODE           move N-ale-no-existe to N-edit

INPUT MODE           display N-edit "Modif o elim de alerta inexistente".

INPUT MODE

INPUT MODE      * Emision del reporte de errores

INPUT MODE           display " "

INPUT MODE           display "Totales por tipo de error detectado:"

INPUT MODE           perform varying Ex from 1 by 1 until Ex > 50

INPUT MODE           or E-codigo(Ex) = "00"

INPUT MODE               if E-contador(Ex) not = 0

INPUT MODE                   move E-contador(ex) to E-edit

INPUT MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

INPUT MODE               end-if

INPUT MODE           end-perform.

INPUT MODE

INPUT MODE

INPUT MODE       9000-CANCELAR-PROGRAMA.

INPUT MODE      ******************************************************************

INPUT MODE      * Procedimiento standard de cancelacion de programa batch

INPUT MODE      ******************************************************************

INPUT MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

INPUT MODE           display " "

INPUT MODE           display pgm " - proceso cancelado"

INPUT MODE           goback returning 99.

INPUT MODE

INPUT MODE

INPUT MODE       513-VALIDA-EN-CSV.

INPUT MODE      **************************************************************

INPUT MODE      * Valida si la identificacin est en la base de datos alterna

INPUT MODE      **************************************************************

INPUT MODE      *    hace validacion de tipo de identificacion

INPUT MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

INPUT MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

INPUT MODE           PERFORM 80400-VALIDAR-TIPO-ID

INPUT MODE           IF SW-TID-BDIIVIDE = 0

INPUT MODE           IF HACER-MATCH = ZEROS

INPUT MODE              IF OPEN-DIR = ZEROS

INPUT MODE                 OPEN INPUT MAESTRO-DIRECC

INPUT MODE                 OPEN INPUT BDLCLI

INPUT MODE                 OPEN INPUT SUSCRIPTOR

INPUT MODE                 OPEN INPUT MAESTRO-CREDIT

INPUT MODE                 OPEN INPUT MAESTRO-CHECK

INPUT MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

INPUT MODE                 MOVE 1 TO OPEN-DIR

INPUT MODE               END-IF

INPUT MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

INPUT MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

INPUT MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

INPUT MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

INPUT MODE               IF IDE-TIPO-BDAMATCH = 1

INPUT MODE                  IF TIPOID-E = 1 OR 4

INPUT MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

INPUT MODE                        "," BY " ", ";" BY " "

INPUT MODE                  END-IF

INPUT MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

INPUT MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

INPUT MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

INPUT MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

INPUT MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

INPUT MODE                  IF MATCH-OK-OUT-VALNOM = 1

INPUT MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

INPUT MODE                  ELSE

INPUT MODE                    IF W-BLOQUES > 0

INPUT MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

INPUT MODE                    END-IF

INPUT MODE                  END-IF

INPUT MODE               END-IF

INPUT MODE

INPUT MODE               IF IDE-TIPO-BDAMATCH = 1

INPUT MODE                  MOVE TIPOID-E TO TIP-VAL

INPUT MODE                  MOVE NUMID-E  TO CED-VAL

INPUT MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

INPUT MODE                  PERFORM 9800-FILTRAR-ALFABETICO

INPUT MODE                  MOVE CADENA-SALE TO  NOM-VAL

INPUT MODE                  MOVE ZEROS    TO FEC-EXP-VAL

INPUT MODE                  MOVE SPACES   TO MUN-EXP-VAL

INPUT MODE                  MOVE SPACES   TO DEP-EXP-VAL

INPUT MODE                  MOVE SPACES   TO VIG-VAL

INPUT MODE                  MOVE SPACES   TO GENERO-VAL

INPUT MODE                  MOVE SPACES   TO EDAD-VAL

INPUT MODE                  MOVE SPACES   TO EDAD-RANGO

INPUT MODE      *           MOVE "A"      TO ORIGEN-VAL

INPUT MODE                  PERFORM  301-GRABA-LOS-VALIDOS

INPUT MODE                  ADD 1 TO SI-EXISTE-CSV

INPUT MODE                END-IF

INPUT MODE             END-IF.

INPUT MODE

INPUT MODE       9800-FILTRAR-ALFABETICO.

INPUT MODE      ******************************************************************

INPUT MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

INPUT MODE      ******************************************************************

INPUT MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

INPUT MODE           INITIALIZE CADENA-SALE

INPUT MODE           MOVE 1 TO J

INPUT MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

INPUT MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

INPUT MODE              IF SI-ALFABETICO

INPUT MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

INPUT MODE                 ADD 1 TO J

INPUT MODE              END-IF

INPUT MODE           END-PERFORM.

INPUT MODE      ******************************************************************

INPUT MODE

INPUT MODE

INPUT MODE

INPUT MODE           copy BDIIVIDE.PROC.

INPUT MODE           copy BDLDIR.PROC.

INPUT MODE           copy BDAMATCH.PROC.

INPUT MODE           COPY LEEMAESTROS.PROC.

INPUT MODE

INPUT MODE

INPUT MODE      /

INPUT MODE       IDENTIFICATION DIVISION.

INPUT MODE       PROGRAM-ID. PONERR.

INPUT MODE      ******************************************************************

INPUT MODE      * Rutina de conveniencia para procesar un error detectado en un

INPUT MODE      * registro de input

INPUT MODE      * Contabiliza el error en la tabla de errores, activa el indicador

INPUT MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

INPUT MODE      * el registro erroneo

INPUT MODE      ******************************************************************

INPUT MODE       ENVIRONMENT DIVISION.

INPUT MODE       DATA DIVISION.

INPUT MODE       WORKING-STORAGE SECTION.

INPUT MODE      ******************************************************************

INPUT MODE      * Registro de input (primeros 86 caracteres)

INPUT MODE       01  reg-input-anterior           pic x(86) value low-values.

INPUT MODE      * Posicion del proximo error en la lista de errores del reg

INPUT MODE       01  errIndex                     pic 999 comp.

INPUT MODE      ******************************************************************

INPUT MODE

INPUT MODE       LINKAGE SECTION.

INPUT MODE      ******************************************************************

INPUT MODE      * Codigo del error detectado

INPUT MODE       01  cod-error                    pic xx.

INPUT MODE      ******************************************************************

INPUT MODE      * Registro de input (primeros 86 caracteres)

INPUT MODE       01  reg-input                    pic x(86).

INPUT MODE      ******************************************************************

INPUT MODE      * Tabla de errores de consistencia del input

INPUT MODE       01 E-errores.

INPUT MODE      *    indica si el registro actual tiene error

INPUT MODE           03 E-hay-error               pic xx.

INPUT MODE      *    errores del registro actual

INPUT MODE           03 E-errores-reg             pic x(300).

INPUT MODE      *    contador de registros con error

INPUT MODE           03 E-cont-regs-con-error     pic 9(8).

INPUT MODE      *    tabla de errores

INPUT MODE           03 E-error                   occurs 50 indexed Ex.

INPUT MODE               05 E-codigo              pic xx.

INPUT MODE               05                       pic x.

INPUT MODE               05 E-contador            pic 9(7).

INPUT MODE               05                       pic x.

INPUT MODE               05 E-descripcion         pic x(59).

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE

INPUT MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

INPUT MODE       00.

INPUT MODE      *    marca al reg actual como erroneo

INPUT MODE           move "SI" to E-hay-error

INPUT MODE

INPUT MODE      *    cuenta y muestra el registro de input

INPUT MODE           if reg-input not = reg-input-anterior

INPUT MODE               add 1 to E-cont-regs-con-error

INPUT MODE               display " "

INPUT MODE               display reg-input

INPUT MODE               move reg-input to reg-input-anterior

INPUT MODE               move spaces to E-errores-reg

INPUT MODE               move 2 to errIndex

INPUT MODE           end-if

INPUT MODE

INPUT MODE      *    contabiliza el error en la tabla de errores

INPUT MODE           set Ex to 1

INPUT MODE           search E-error varying Ex

INPUT MODE           at end

INPUT MODE               display "--- falla en la tabla de errores ---" cod-error

INPUT MODE           when E-codigo(Ex) = "00"

INPUT MODE               add 1 to E-contador(Ex)

INPUT MODE               display "--- error tipo exotico: " cod-error

INPUT MODE               add 1 to E-contador(Ex)

INPUT MODE           when E-codigo(Ex) = cod-error

INPUT MODE               add 1 to E-contador(Ex)

INPUT MODE               display "Error " cod-error " " E-descripcion(Ex)

INPUT MODE           end-search

INPUT MODE

INPUT MODE      *    agrega a la lista de errores del registro

INPUT MODE           if errIndex < (300 - 59 - 3)

INPUT MODE               move cod-error to E-errores-reg(errIndex:2)

INPUT MODE               add 3 to errIndex

INPUT MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

INPUT MODE               add 59 to errIndex

INPUT MODE           end-if

INPUT MODE

INPUT MODE           exit program.

INPUT MODE

INPUT MODE

INPUT MODE       end program PONERR.

INPUT MODE

INPUT MODE       end program CARGAJUR.

INPUT MODE

INPUT MODE      ******************************************************************

INPUT MODE      ******************************************************************

INPUT MODE

INPUT MODE
ET LIST SETTING LISTWIDTH"80"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************INSERT MODE      $S8$CHANGE MODE120:w"CARGAJUR.CBL" 1625 lines, 68313 characters [1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:  1609
* Unrecoverable :     0                    Severe  :  1609
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1186116     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 4827 lines, 564615 characters * Rejected - OPT
  2222     move JURAD-nombre NOMBRE-E
663
*  83-S******************************(   0)**665
**    Reserved word missing - TO expected.
665
  3017OPEN INPUT MAESTRO-DIRECC
1458
*  12-S***********************************(  40)**1459
**    Operand MAESTRO-DIRECC is not declared
1459
  3018OPEN INPUT BDLCLI
1459
*  12-S***************************(  54)**1460
**    Operand BDLCLI is not declared
1460
  3019OPEN INPUT SUSCRIPTOR
1460
*  12-S*******************************(  54)**1461
**    Operand SUSCRIPTOR is not declared
1461
  3020OPEN INPUT MAESTRO-CREDIT
1461
*  12-S***********************************(  54)**1462
**    Operand MAESTRO-CREDIT is not declared
1462
  3021OPEN INPUT MAESTRO-CHECK
1462
*  12-S**********************************(  54)**1463
**    Operand MAESTRO-CHECK is not declared
1463
  3051MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA1492
*  12-S***************************************************(  54)**1493
**    Operand CADENA-ENTRA is not declared
1493
  3053MOVE CADENA-SALE TO  NOM-VAL
1494
*  12-S***************************(  54)**1494
**    Operand CADENA-SALE is not declared
1494"CARGAJUR.CBL.err" 4827 lines, 564615 characters:q/d/iccol/desarrollo/fuentes>fg
vi  CARGAJUR.CBL
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1625 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDACSV.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************

      ******************************************************************

APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record

APPEND MODE              file status is EST-BDIIALE.==.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           copy ICBDIR.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la bsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

APPEND MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE      *  posible: COPY BDAMATCH.WS.

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacin de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 aos

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificacin de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminacin de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que sealar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificacin contra las bases de

APPEND MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id invlido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validacin en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cdula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cdula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del cdigo

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificacin est en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cdula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cdula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debera ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberan cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - ledos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros ledos (excludo el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificacin est en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE      *           MOVE "A"      TO ORIGEN-VAL

APPEND MODE                  PERFORM  301-GRABA-LOS-VALIDOS

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           copy BDAMATCH.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

"CARGAJUR.CBL" [Modified] line 1635 of 1635 --100%-- 
:w"CARGAJUR.CBL" 1635 lines, 68726 characters 
[1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:  1418
* Unrecoverable :     0                    Severe  :  1418
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1188988     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 4254 lines, 497574 characters * Rejected - OPT140     SELECT BDACSV
BDACSV4
*   5-S*****************(   0)**5
**    User-name BDACSV not unique
5
  3423OPEN INPUT MAESTRO-CREDIT
1471
*  12-S***********************************(   4)**1472
**    Operand MAESTRO-CREDIT is not declared
1472
  3466ADD 1 TO SI-EXISTE-CSV
1514
*  12-S*********************************(  61)**1516
**    Operand SI-EXISTE-CSV is not declared
1516
  3476     MOVE 1 TO J
  1524
*  12-S***************(  61)**1525
**    Operand J is not declared
1525
  3477     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 601525
*  12-S*********************(  62)**1525
**    Operand I is not declared
1525
  3478MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO1526
*  12-S***************************(  62)**1526
**    Operand I is not declared
1526
  3479IF SI-ALFABETICO
1527
*  12-S***********************(  62)**1528
**    Operand SI-ALFABETICO is not declared
1528
  3480MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)1528
*  12-S******************************(  62)**1528
**    Operand I is not declared
1528"CARGAJUR.CBL.err" 4254 lines, 497574 characters*  12-S******************************(  62)**1528
**    Operand I is not declared
1528
  3481ADD 1 TO J
1529
*  12-S********************(  62)**1531
**    Operand J is not declared
1531
  3482END-IF
    1530
* 564-S*************(  62)**1531
**    A scope-delimiter did not have a matching verb and was discarded.1531
  3483     END-PERFORM.
 1531
* 564-S***************(  62)**1531
**    A scope-delimiter did not have a matching verb and was discarded.1531
  3947     MOVE 0 TO NUM-OK-SEND-BDLDIR.RMB0010BDLDIR171
*  12-S********************************(  62)**171
**    Operand NUM-OK-SEND-BDLDIR is not declared
171
  3948     MOVE 1 TO DIR-OK-BDLDIR.RMB0010BDLDIR172
*  12-S***************************(  70)**172
**    Operand DIR-OK-BDLDIR is not declared
172
  3949     MOVE 1 TO TEL-OK-BDLDIR.RMB0010BDLDIR173
*  12-S***************************(  70)**173
**    Operand TEL-OK-BDLDIR is not declared
173
  3950     INITIALIZE TABLA-DIR-BDLDIR.RMB0010BDLDIR174
*  12-S*******************************(  70)**174
**    Operand TABLA-DIR-BDLDIR is not declared
174
  3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
@**    Operand TABLA-DIR-BDLDIR is not declared
174
  3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  70)**175
**    Operand TABLA-TEL-BDLDIR is not declared
175
  3952     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR176
*  12-S**************************************(  70)**176
**    Operand TABLA-DIRFINALES-BDLDIR is not declared176
  3953     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR177
*  12-S**************************************(  70)**177
**    Operand TABLA-TELFINALES-BDLDIR is not declared177
  3954     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178
*  12-S*****************************************(  70)**178
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared178
  3955     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR179
*  12-S*************************************(  70)**179
**    Operand T-DIRFINALESAUX-BDLDIR is not declared179
  3959IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR183
*  12-S******************************(  70)**183
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared
183
  3960MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR184
*  12-S****************************************(  70)**185
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared
185
  3961OPEN INPUT BDLSTDCIURMB0010BDLDIR185
*  12-S*****************************(  70)**186
@**    Operand TABLA-DIR-BDLDIR is not declared17
4
 3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR17
5
*  12-S*******************************(  70)**17
5
**    Operand TABLA-TEL-BDLDIR is not declared17
5
 3952     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR17
6
*  12-S**************************************(  70)**17
6
**    Operand TABLA-DIRFINALES-BDLDIR is not declared17
6
 3953     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR17
7
*  12-S**************************************(  70)**17
7
**    Operand TABLA-TELFINALES-BDLDIR is not declared17
7
 3954     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR17
8
*  12-S*****************************************(  70)**17
8
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared17
8
 3955     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR17
9
*  12-S*************************************(  70)**17
9
**    Operand T-DIRFINALESAUX-BDLDIR is not declared17
9
 3959IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR18
3
*  12-S******************************(  70)**18
3
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared18
3
 3960MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR18
4
*  12-S****************************************(  70)**18
5
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared18
5
 3961OPEN INPUT BDLSTDCIURMB0010BDLDIR18
5
*  12-S*****************************(  70)**18
6
@**    Operand TABLA-DIR-BDLDIR is not declared174
  3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  70)**175
**    Operand TABLA-TEL-BDLDIR is not declared175
  3952     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR176
*  12-S**************************************(  70)**176
**    Operand TABLA-DIRFINALES-BDLDIR is not declared176
  3953     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR177
*  12-S**************************************(  70)**177
**    Operand TABLA-TELFINALES-BDLDIR is not declared177
  3954     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178
*  12-S*****************************************(  70)**178
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared178
  3955     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR179
*  12-S*************************************(  70)**179
**    Operand T-DIRFINALESAUX-BDLDIR is not declared179
  3959IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR183
*  12-S******************************(  70)**183
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared183
  3960MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR184
*  12-S****************************************(  70)**185
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared185
  3961OPEN INPUT BDLSTDCIURMB0010BDLDIR185
*  12-S*****************************(  70)**186
**    Operand BDLSTDCIU is not declared186
  3962END-IF.RMB0010BDLDIR186
* 564-S************(  71)**186
**    A scope-delimiter did not have a matching verb and was discarded.186
  3964MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR188
*  12-S***********************************************(  71)**189
**    Operand LLAVE-BDLSTDCIU is not declared189
  3966MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*  12-S*****************************************(  71)**190
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared190
  3969MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR193
*  12-S***********************************************(  71)**194
**    Operand LLAVE-BDLSTDCIU is not declared194
  3971MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*  12-S*****************************************(  71)**195
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared195
  3974MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR198
*  12-S***********************************************(  71)**199
**    Operand LLAVE-BDLSTDCIU is not declared199
  3976MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*  12-S*****************************************(  71)**200
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared200
  3979     MOVE FUNCTION UPPER-CASE(LLAVE-BDLSTDCIU) TO LLAVE-BDLSTDCIU.RMB0010BDLDIR203
*  12-S********************************************(  71)**203
**    Operand LLAVE-BDLSTDCIU is not declared203**    Operand TABLA-DIR-BDLDIR is not declared174
  3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  70)**175
**    Operand TABLA-TEL-BDLDIR is not declared175
  3952     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR176
*  12-S**************************************(  70)**176
**    Operand TABLA-DIRFINALES-BDLDIR is not declared176
  3953     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR177
*  12-S**************************************(  70)**177
**    Operand TABLA-TELFINALES-BDLDIR is not declared177
  3954     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178
*  12-S*****************************************(  70)**178
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared178
  3955     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR179
*  12-S*************************************(  70)**179
**    Operand T-DIRFINALESAUX-BDLDIR is not declared179
  3959IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR183
*  12-S******************************(  70)**183
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared183
  3960MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR184
*  12-S****************************************(  70)**185
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared185
  3961OPEN INPUT BDLSTDCIURMB0010BDLDIR185
*  12-S*****************************(  70)**186
**    Operand BDLSTDCIU is not declared186
  3962END-IF.RMB0010BDLDIR186
* 564-S************(  71)**186
**    A scope-delimiter did not have a matching verb and was discarded.186
  3964MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR188
*  12-S***********************************************(  71)**189
**    Operand LLAVE-BDLSTDCIU is not declared189
  3966MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*  12-S*****************************************(  71)**190
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared190
  3969MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR193
*  12-S***********************************************(  71)**194
**    Operand LLAVE-BDLSTDCIU is not declared194
  3971MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*  12-S*****************************************(  71)**195
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared195
  3974MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR198
*  12-S***********************************************(  71)**199
**    Operand LLAVE-BDLSTDCIU is not declared199
  3976MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*  12-S*****************************************(  71)**200
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared200
  3979     MOVE FUNCTION UPPER-CASE(LLAVE-BDLSTDCIU) TO LLAVE-BDLSTDCIU.RMB0010BDLDIR203
*  12-S********************************************(  71)**203
**    Operand LLAVE-BDLSTDCIU is not declared203*  12-S********************************************(  71)**203
**    Operand LLAVE-BDLSTDCIU is not declared203
  3980     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '"' BY " ".RMB0010BDLDIR204
*  12-S***************************(  71)**204
**    Operand LLAVE-BDLSTDCIU is not declared204
  3981     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '*' BY " ".RMB0010BDLDIR205
*  12-S***************************(  71)**205
**    Operand LLAVE-BDLSTDCIU is not declared205
  3982     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '_' BY " ".RMB0010BDLDIR206
*  12-S***************************(  71)**206
**    Operand LLAVE-BDLSTDCIU is not declared206
  3983     MOVE 0 TO PATRON-CIU-BDLDIR CODIGO-DANE-CIU-BDLDIR.RMB0010BDLDIR207
*  12-S*******************************(  71)**207
**    Operand PATRON-CIU-BDLDIR is not declared207
  3984     MOVE SPACES TO CODIGO-DANE-CIU-BDLDIR.RMB0010BDLDIR208
*  12-S*****************************************(  71)**208
**    Operand CODIGO-DANE-CIU-BDLDIR is not declared208
  3985     MOVE 0 TO I-CIU-BDLDIR.RMB0010BDLDIR209
*  12-S**************************(  71)**209
**    Operand I-CIU-BDLDIR is not declared209
  3986     INSPECT LLAVE-BDLSTDCIU TALLYING I-CIU-BDLDIR FOR ALL "BOGOT"RMB0010BDLDIR210
*  12-S***************************(  71)**210
**    Operand LLAVE-BDLSTDCIU is not declared210
  3987     IF I-CIU-BDLDIR > 0RMB0010BDLDIR211
*  12-S*******************(  71)**211
**    Operand I-CIU-BDLDIR is not declared211
  3988MOVE 1 TO PATRON-CIU-BDLDIRRMB0010BDLDIR212
*  12-S**********************************(  72)**213
**    Operand PATRON-CIU-BDLDIR is not declared213
  3989MOVE "BOGOTA" TO LLAVE-BDLSTDCIURMB0010BDLDIR213
*  12-S***************************************(  72)**215
**    Operand LLAVE-BDLSTDCIU is not declared215
  3991MOVE LLAVE-BDLSTDCIU TO LLAVE-AUX-CIU-BDLDIRRMB0010BDLDIR215
*  12-S***************************(  72)**215
**    Operand LLAVE-BDLSTDCIU is not declared215
  3992UNSTRING LLAVE-AUX21-CIU-BDLDIR DELIMITED BY ALL " " INTO RMB0010BDLDIR216
*  12-S**************************************(  72)**216
**    Operand LLAVE-AUX21-CIU-BDLDIR is not declared216
  3994INSPECT CODIGO-DANE-CIU-BDLDIR REPLACING ALL " " BY "0"   RMB0010BDLDIR218
*  12-S*************************************(  72)**218
**    Operand CODIGO-DANE-CIU-BDLDIR is not declared218
  3995     END-IF.RMB0010BDLDIR219
* 564-S**********(  72)**219
**    A scope-delimiter did not have a matching verb and was discarded.219
  3996     MOVE SPACES TO CAMPO-CIU-BDLDIRRMB0010BDLDIR220
*  12-S***********************************(  72)**221
**    Operand CAMPO-CIU-BDLDIR is not declared221
  3997     MOVE 1 TO I-CIU-BDLDIR J-CIU-BDLDIRRMB0010BDLDIR221
*  12-S**************************(  72)**222* Rejected - OPT140     SELECT BDACSVBDACSV4
*   5-S*****************(   0)**5
**    User-name BDACSV not unique5
  3423OPEN INPUT MAESTRO-CREDIT1471
*  12-S***********************************(   4)**1472
**    Operand MAESTRO-CREDIT is not declared1472
  3466ADD 1 TO SI-EXISTE-CSV1514
*  12-S*********************************(  61)**1516
**    Operand SI-EXISTE-CSV is not declared1516
  3476     MOVE 1 TO J1524
*  12-S***************(  61)**1525
**    Operand J is not declared1525
  3477     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 601525
*  12-S*********************(  62)**1525
**    Operand I is not declared1525
  3478MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO1526
*  12-S***************************(  62)**1526
**    Operand I is not declared1526
  3479IF SI-ALFABETICO1527
*  12-S***********************(  62)**1528
**    Operand SI-ALFABETICO is not declared1528
  3480MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)1528
*  12-S******************************(  62)**1528
**    Operand I is not declared1528
  3481ADD 1 TO J1529
*  12-S********************(  62)**1531
**    Operand J is not declared1531
  3482END-IF1530
* 564-S*************(  62)**1531
**    A scope-delimiter did not have a matching verb and was discarded.1531
  3483     END-PERFORM.1531
* 564-S***************(  62)**1531
**    A scope-delimiter did not have a matching verb and was discarded.1531
  3947     MOVE 0 TO NUM-OK-SEND-BDLDIR.RMB0010BDLDIR171
*  12-S********************************(  62)**171
**    Operand NUM-OK-SEND-BDLDIR is not declared171
  3948     MOVE 1 TO DIR-OK-BDLDIR.RMB0010BDLDIR172
*  12-S***************************(  70)**172
**    Operand DIR-OK-BDLDIR is not declared172
  3949     MOVE 1 TO TEL-OK-BDLDIR.RMB0010BDLDIR173
*  12-S***************************(  70)**173
**    Operand TEL-OK-BDLDIR is not declared173
  3950     INITIALIZE TABLA-DIR-BDLDIR.RMB0010BDLDIR174
*  12-S*******************************(  70)**174
**    Operand TABLA-DIR-BDLDIR is not declared174
  3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  70)**175
**    Operand TABLA-TEL-BDLDIR is not declared175/open *input /*  12-S*******************************(  70)**174
**    Operand TABLA-DIR-BDLDIR is not declared174
  3951     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  70)**175
**    Operand TABLA-TEL-BDLDIR is not declared175
  3952     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR176
*  12-S**************************************(  70)**176
**    Operand TABLA-DIRFINALES-BDLDIR is not declared176
  3953     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR177
*  12-S**************************************(  70)**177
**    Operand TABLA-TELFINALES-BDLDIR is not declared177
  3954     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178
*  12-S*****************************************(  70)**178
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared178
  3955     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR179
*  12-S*************************************(  70)**179
**    Operand T-DIRFINALESAUX-BDLDIR is not declared179
  3959IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR183
*  12-S******************************(  70)**183
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared183
  3960MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR184
*  12-S****************************************(  70)**185
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared185
  3961OPEN INPUT BDLSTDCIURMB0010BDLDIR185
*  12-S*****************************(  70)**186
**    Operand BDLSTDCIU is not declared186
  3962END-IF.RMB0010BDLDIR186
* 564-S************(  71)**186
**    A scope-delimiter did not have a matching verb and was discarded.186
  3964MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR188
*  12-S***********************************************(  71)**189
**    Operand LLAVE-BDLSTDCIU is not declared189
  3966MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*  12-S*****************************************(  71)**190
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared190
  3969MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR193
*  12-S***********************************************(  71)**194
**    Operand LLAVE-BDLSTDCIU is not declared194
  3971MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*  12-S*****************************************(  71)**195
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared195
  3974MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR198
*  12-S***********************************************(  71)**199
**    Operand LLAVE-BDLSTDCIU is not declared199
  3976MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*  12-S*****************************************(  71)**200
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared200
  3979     MOVE FUNCTION UPPER-CASE(LLAVE-BDLSTDCIU) TO LLAVE-BDLSTDCIU.RMB0010BDLDIR203
*  12-S********************************************(  71)**203/* 564-S*************( 118)**1479
**    A scope-delimiter did not have a matching verb and was discarded.1479
  5255END-IFAAM0017BDLDIR1479
* 564-S************( 119)**1480
**    A scope-delimiter did not have a matching verb and was discarded.1480
  5256IF SW-1 = 1 AND V-CALTELFIN-BDLDIR(W-I + 1) < 1AAM0017BDLDIR1480
*  12-S*************( 119)**1480
**    Operand SW-1 is not declared1480
  5257MOVE W-OCURR  TO V-NUMTELFIN-BDLDIR(W-POSRC)AAM0017BDLDIR1481
*  12-S********************( 119)**1481
**    Operand W-OCURR is not declared1481
  5258END-IFAAM0017BDLDIR1482
* 564-S************( 119)**1483
**    A scope-delimiter did not have a matching verb and was discarded.1483
  5259ADD 1 TO W-IAAM0017BDLDIR1483
*  12-S******************( 119)**1484
**    Operand W-I is not declared1484
  5260     END-PERFORM.AAM0017BDLDIR1484
* 564-S***************( 119)**1484
**    A scope-delimiter did not have a matching verb and was discarded.1484
  5273     INITIALIZE TABLA-DIR-COMPUESTAS-BDLDIRRMB0010BDLDIR1497
*  12-S******************************************( 119)**1498
**    Operand TABLA-DIR-COMPUESTAS-BDLDIR is not declared1498
  5274     OPEN INPUT DIRESTRMB0010BDLDIR1498
*  12-S*********************( 119)**1499
**    Operand DIREST is not declared1499
  5275     MOVE 0 TO FDA-DIREST-BDLDIRRMB0010BDLDIR1499
*  12-S*******************************( 119)**1500
**    Operand FDA-DIREST-BDLDIR is not declared1500
  5276     READ DIRESTBDLDIR1500
*  12-S***************( 119)**1501
**    Operand DIREST is not declared1501
  5278MOVE 1 TO FDA-DIREST-BDLDIRRMB0010BDLDIR1502
*  12-S*************************************( 119)**1504
**    Operand FDA-DIREST-BDLDIR is not declared1504
  5279     END-READBDLDIR1503
* 564-S************( 119)**1504
**    A scope-delimiter did not have a matching verb and was discarded.1504
  5280     MOVE 1 TO I-STA-BDLDIRRMB0010BDLDIR1504
*  12-S**************************( 119)**1505
**    Operand I-STA-BDLDIR is not declared1505
  5281     MOVE 1 TO J-STA-BDLDIRRMB0010BDLDIR1505
*  12-S**************************( 119)**1507
**    Operand J-STA-BDLDIR is not declared1507
  5283     PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 2000  PJV0024BDLDIR1507
*  12-S***********************************( 119)**1507
**    Operand FDA-DIREST-BDLDIR is not declared1507
  5284IF DIR-ORIG-DIREST (1:4) <> "****"RMB0010BDLDIR1508
*  12-S*************************( 120)**1508/*  12-S************************************( 142)**2156
**    Operand J-MEJ-BDLDIR is not declared2156
  5931END-IFGJC0011BDLDIR2155
* 564-S******************( 142)**2156
**    A scope-delimiter did not have a matching verb and was discarded.2156
  5932END-IFGJC0011BDLDIR2156
* 564-S***************( 142)**2157
**    A scope-delimiter did not have a matching verb and was discarded.2157
  5933END-IFGJC0011BDLDIR2157
* 564-S************( 142)**2158
**    A scope-delimiter did not have a matching verb and was discarded.2158
  5934ADD 1 TO I-MEJ-BDLDIRGJC0011BDLDIR2158
*  12-S***************************( 142)**2159
**    Operand I-MEJ-BDLDIR is not declared2159
  5935    END-PERFORM.GJC0011BDLDIR2159
* 564-S**************( 143)**2159
**    A scope-delimiter did not have a matching verb and was discarded.2159
  5942     IF OPEN-BDLNEWDIRBOG-BDLDIR = 0GJC0011BDLDIR2166
*  12-S*******************************( 143)**2166
**    Operand OPEN-BDLNEWDIRBOG-BDLDIR is not declared2166
  5943MOVE 1 TO OPEN-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2167
*  12-S*****************************************( 143)**2168
**    Operand OPEN-BDLNEWDIRBOG-BDLDIR is not declared2168
  5944OPEN INPUT BDLNEWDIRBOGGJC0011BDLDIR2168
*  12-S******************************( 143)**2169
**    Operand BDLNEWDIRBOG is not declared2169
  5945     END-IF.GJC0011BDLDIR2169
* 564-S**********( 143)**2169
**    A scope-delimiter did not have a matching verb and was discarded.2169
  5946     MOVE T-NUMMEJ-BDLDIR TO NUMEROS-BDLNEWDIRBOGGJC0011BDLDIR2170
*  12-S************************( 143)**2170
**    Operand T-NUMMEJ-BDLDIR is not declared2170
  5947     IF L-BDLDIR(1) NOT = SPACESGJC0011BDLDIR2171
*  12-S***************( 143)**2171
**    Operand L-BDLDIR is not declared2171
  5948MOVE L-BDLDIR(1) TO AVENIDA-BDLNEWDIRBOGGJC0011BDLDIR2172
*  12-S********************( 143)**2172
**    Operand L-BDLDIR is not declared2172
  5950MOVE L-BDLDIR(2) TO AVENIDA-BDLNEWDIRBOGGJC0011BDLDIR2174
*  12-S********************( 143)**2174
**    Operand L-BDLDIR is not declared2174
  5951     END-IF.GJC0011BDLDIR2175
* 564-S**********( 143)**2175
**    A scope-delimiter did not have a matching verb and was discarded.2175
  5952     READ BDLNEWDIRBOGGJC0011BDLDIR2176
*  12-S*********************( 143)**2177
**    Operand BDLNEWDIRBOG is not declared2177
  5954MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2178
*  12-S*******************************************( 143)**2179/Address search hit BOTTOM without matching pattern:q/d/iccol/desarrollo/fuentes>fg
vi  CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDACSV.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1635 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuacin no est confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           copy ICBDIR.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la bsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

APPEND MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE      *  posible: COPY BDAMATCH.WS.

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacin de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 aos

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificacin de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminacin de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que sealar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificacin contra las bases de

APPEND MODE      *    datos de validacin de informacin BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id invlido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validacin en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cdula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cdula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del cdigo

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacin de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificacin est en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cdula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cdula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fu previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debera ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberan cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - ledos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros ledos (excludo el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificacin est en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE      *           MOVE "A"      TO ORIGEN-VAL

APPEND MODE                  PERFORM  301-GRABA-LOS-VALIDOS

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           copy BDAMATCH.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1639 lines, 68786 characters 
[1] + Stopped (SIGTSTP)        vi  CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi CARGAJUR.CBL.errdes-c-v CARGAJUR   fg              des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:  1176
* Unrecoverable :     0                    Severe  :  1176
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1191700     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 3528 lines, 412632 characters * Rejected - OPT
  3722ADD 1 TO SI-EXISTE-CSV1518
*  12-S*********************************(   0)**1520
**    Operand SI-EXISTE-CSV is not declared1520
  3732     MOVE 1 TO J1528
*  12-S***************(  65)**1529
**    Operand J is not declared1529
  3733     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 601529
*  12-S*********************(  65)**1529
**    Operand I is not declared1529
  3734MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO1530
*  12-S***************************(  66)**1530
**    Operand I is not declared1530
  3735IF SI-ALFABETICO1531
*  12-S***********************(  66)**1532
**    Operand SI-ALFABETICO is not declared1532
  3736MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)1532
*  12-S******************************(  66)**1532
**    Operand I is not declared1532
  3737ADD 1 TO J1533
*  12-S********************(  66)**1535
**    Operand J is not declared1535
  3738END-IF1534
* 564-S*************(  66)**1535
**    A scope-delimiter did not have a matching verb and was discarded.1535
  3739     END-PERFORM.1535
* 564-S***************(  66)**1535
**    A scope-delimiter did not have a matching verb and was discarded.1535
  4203     MOVE 0 TO NUM-OK-SEND-BDLDIR.RMB0010BDLDIR171
*  12-S********************************(  66)**171
**    Operand NUM-OK-SEND-BDLDIR is not declared171
  4204     MOVE 1 TO DIR-OK-BDLDIR.RMB0010BDLDIR172
*  12-S***************************(  74)**172
**    Operand DIR-OK-BDLDIR is not declared172
  4205     MOVE 1 TO TEL-OK-BDLDIR.RMB0010BDLDIR173
*  12-S***************************(  74)**173
**    Operand TEL-OK-BDLDIR is not declared173
  4206     INITIALIZE TABLA-DIR-BDLDIR.RMB0010BDLDIR174
*  12-S*******************************(  74)**174
**    Operand TABLA-DIR-BDLDIR is not declared174
  4207     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  74)**175
**    Operand TABLA-TEL-BDLDIR is not declared175
  4208     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR176
*  12-S**************************************(  74)**176
**    Operand TABLA-DIRFINALES-BDLDIR is not declared176
  4209     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR177
*  12-S**************************************(  74)**177
**    Operand TABLA-TELFINALES-BDLDIR is not declared177"CARGAJUR.CBL.err" 3528 lines, 412632 characters/open  4210     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178
*  12-S*****************************************(  74)**178
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared178
  4211     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR179
*  12-S*************************************(  74)**179
**    Operand T-DIRFINALESAUX-BDLDIR is not declared179
  4215IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR183
/*  12-S******************************(  74)**183
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared183
/  4216MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR184
/*  12-S****************************************(  74)**185
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared185
/*  12-S*********************************************( 145)**2150
**    Operand LETRA-BDLDIR is not declared2150
  6184ADD ORDEN-ASCII-BDLDIR TOGJC0011BDLDIR2152
*  12-S*************************************( 145)**2153
**    Operand ORDEN-ASCII-BDLDIR is not declared2153
  6186ADD 1 TO J-MEJ-BDLDIRGJC0011BDLDIR2154
*  12-S************************************( 145)**2156
**    Operand J-MEJ-BDLDIR is not declared2156
  6187END-IFGJC0011BDLDIR2155
* 564-S******************( 145)**2156
**    A scope-delimiter did not have a matching verb and was discarded.2156
  6188END-IFGJC0011BDLDIR2156
* 564-S***************( 145)**2157
**    A scope-delimiter did not have a matching verb and was discarded.2157
  6189END-IFGJC0011BDLDIR2157
* 564-S************( 145)**2158
**    A scope-delimiter did not have a matching verb and was discarded.2158
  6190ADD 1 TO I-MEJ-BDLDIRGJC0011BDLDIR2158
*  12-S***************************( 145)**2159
**    Operand I-MEJ-BDLDIR is not declared2159
  6191    END-PERFORM.GJC0011BDLDIR2159
* 564-S**************( 145)**2159
**    A scope-delimiter did not have a matching verb and was discarded.2159
  6198     IF OPEN-BDLNEWDIRBOG-BDLDIR = 0GJC0011BDLDIR2166
*  12-S*******************************( 145)**2166
**    Operand OPEN-BDLNEWDIRBOG-BDLDIR is not declared2166
  6199MOVE 1 TO OPEN-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2167
*  12-S*****************************************( 145)**2168
**    Operand OPEN-BDLNEWDIRBOG-BDLDIR is not declared2168
  6201     END-IF.GJC0011BDLDIR2169
* 564-S**********( 145)**2169
**    A scope-delimiter did not have a matching verb and was discarded.2169
  6202     MOVE T-NUMMEJ-BDLDIR TO NUMEROS-BDLNEWDIRBOGGJC0011BDLDIR2170
*  12-S************************( 146)**2170
**    Operand T-NUMMEJ-BDLDIR is not declared2170
  6203     IF L-BDLDIR(1) NOT = SPACESGJC0011BDLDIR2171
*  12-S***************( 146)**2171
**    Operand L-BDLDIR is not declared2171
  6204MOVE L-BDLDIR(1) TO AVENIDA-BDLNEWDIRBOGGJC0011BDLDIR2172
*  12-S********************( 146)**2172
**    Operand L-BDLDIR is not declared2172
  6206MOVE L-BDLDIR(2) TO AVENIDA-BDLNEWDIRBOGGJC0011BDLDIR2174
*  12-S********************( 146)**2174
**    Operand L-BDLDIR is not declared2174
  6207     END-IF.GJC0011BDLDIR2175
* 564-S**********( 146)**2175
**    A scope-delimiter did not have a matching verb and was discarded.2175
  6210MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2178
*  12-S*******************************************( 146)**2179//:g//d**    Operand ORDEN-ASCII-BDLDIR is not declared            3
  6186                ADD 1 TO J-MEJ-BDLDIRGJC0011BDLDIR4
*  12-S************************************    ( 145)**      6
**    Operand J-MEJ-BDLDIR is not declared          6
  6187             END-IF                       GJC0011BDLDIR5
* 564-S******************                  ( 145)**      6
**    A scope-delimiter did not have a matching verb and was discarded.        
  6188          END-IF                    GJC0011BDLDIR
* 564-S***************   ( 145)**      7
**    A scope-delimiter did not have a matching verb and was discarded.        7
  6189       END-IF                                                     GJC0011BDLDIR7
* 564-S************   ( 145)**      8
**    A scope-delimiter did not have a matching verb and was discarded.        8
  6190       ADD 1 TO I-MEJ-BDLDIR                                      GJC0011BDLDIR8
*  12-S***************************( 145)**      9
**    Operand I-MEJ-BDLDIR is not declared        9
  6191    END-PERFORM.                                                  GJC0011BDLDIR9
* 564-S**************             ( 145)**      9
**    A scope-delimiter did not have a matching verb and was discarded.        
*  12-S*******************************    ( 145)**66
*  12-S*****************************************( 145)**      68
  6201     END-IF.    GJC0011BDLDIR6
* 564-S**********                                                      ( 145)**6
**    A scope-delimiter did not have a matching verb and was discarded.              9
  6202     MOVE T-NUMMEJ-BDLDIR TO NUMEROS-BDLNEWDIRBOG GJC0011BDLDIR70
*  12-S************************                       ( 146)**70
**    Operand T-NUMMEJ-BDLDIR is not declared                70
  6203     IF L-BDLDIR(1) NOT = SPACES           GJC0011BDLDIR71
*  12-S***************                                ( 146)**71
**    Operand L-BDLDIR is not declared             71
  6204        MOVE L-BDLDIR(1) TO AVENIDA-BDLNEWDIRBOG GJC0011BDLDIR72
*  12-S********************                                            ( 146)**72
**    Operand L-BDLDIR is not declared                              2
  6206        MOVE L-BDLDIR(2) TO AVENIDA-BDLNEWDIRBOG GJC0011BDLDIR4
*  12-S********************                  ( 146)**4
**    Operand is not declared             4
  6207     END-IF.     GJC0011BDLDIR5
* 564-S**********                     ( 146)**5
**    A scope-delimiter did not have a matching verb and was discarded.              5
  6210           MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIR GJC0011BDLDIR8
*  12-S*******************************************( 146)**9
**    Operand HAY-BDLNEWDIRBOG-BDLDIR is not declared              9
  6212           MOVE 1 TO HAY-BDLNEWDIRBOG-BDLDIR GJC0011BDLDIR80
*  12-S*******************************************( 146)**81
**    Operand HAY-BDLNEWDIRBOG-BDLDIR is not declared             81
  6223     INITIALIZE TMP-EMAIL-BDLDIR ERR-EMAIL-BDLDIR CAV0027BDLDIR91
*  12-S*******************************                                 ( 146)**92
**    Operand TMP-EMAIL-BDLDIR is not declared                 92
  6226     IF EMAIL-BDLDIR NOT = SPACE             CAV0027BDLDIR94
8 fewer lines*  12-S*************************************( 145)**2153
**    Operand ORDEN-ASCII-BDLDIR is not declared2153
  6186ADD 1 TO J-MEJ-BDLDIRGJC0011BDLDIR2154
*  12-S************************************( 145)**2156
**    Operand J-MEJ-BDLDIR is not declared2156
  6187END-IFGJC0011BDLDIR2155
* 564-S******************( 145)**2156
**    A scope-delimiter did not have a matching verb and was discarded.2156
  6188END-IFGJC0011BDLDIR2156
* 564-S***************( 145)**2157
**    A scope-delimiter did not have a matching verb and was discarded.2157
  6189END-IFGJC0011BDLDIR2157
* 564-S************( 145)**2158
**    A scope-delimiter did not have a matching verb and was discarded.2158
  6190ADD 1 TO I-MEJ-BDLDIRGJC0011BDLDIR2158
*  12-S***************************( 145)**2159
**    Operand I-MEJ-BDLDIR is not declared2159
  6191    END-PERFORM.GJC0011BDLDIR2159
* 564-S**************( 145)**2159
**    A scope-delimiter did not have a matching verb and was discarded.2159
  6198     IF OPEN-BDLNEWDIRBOG-BDLDIR = 0GJC0011BDLDIR2166
*  12-S*******************************( 145)**2166
**    Operand OPEN-BDLNEWDIRBOG-BDLDIR is not declared2166
  6199MOVE 1 TO OPEN-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2167
*  12-S*****************************************( 145)**2168
**    Operand OPEN-BDLNEWDIRBOG-BDLDIR is not declared2168
  6201     END-IF.GJC0011BDLDIR2169
* 564-S**********( 145)**2169
**    A scope-delimiter did not have a matching verb and was discarded.2169
  6202     MOVE T-NUMMEJ-BDLDIR TO NUMEROS-BDLNEWDIRBOGGJC0011BDLDIR2170
*  12-S************************( 146)**2170
**    Operand T-NUMMEJ-BDLDIR is not declared2170
  6203     IF L-BDLDIR(1) NOT = SPACESGJC0011BDLDIR2171
*  12-S***************( 146)**2171
**    Operand L-BDLDIR is not declared2171
  6204MOVE L-BDLDIR(1) TO AVENIDA-BDLNEWDIRBOGGJC0011BDLDIR2172
*  12-S********************( 146)**2172
**    Operand L-BDLDIR is not declared2172
  6206MOVE L-BDLDIR(2) TO AVENIDA-BDLNEWDIRBOGGJC0011BDLDIR2174
*  12-S********************( 146)**2174
**    Operand L-BDLDIR is not declared2174
  6207     END-IF.GJC0011BDLDIR2175
* 564-S**********( 146)**2175
**    A scope-delimiter did not have a matching verb and was discarded.2175
  6210MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2178
*  12-S*******************************************( 146)**2179
**    Operand HAY-BDLNEWDIRBOG-BDLDIR is not declared2179
  6212MOVE 1 TO HAY-BDLNEWDIRBOG-BDLDIRGJC0011BDLDIR2180
*  12-S*******************************************( 146)**2181
8 more lines///Address search hit BOTTOM without matching pattern/Address search hit BOTTOM without matching pattern/Address search hit BOTTOM without matching pattern/Address search hit BOTTOM without matching pattern* Rejected - OPT
  3722ADD 1 TO SI-EXISTE-CSV1518
*  12-S*********************************(   0)**1520
**    Operand SI-EXISTE-CSV is not declared1520
  3732     MOVE 1 TO J1528
*  12-S***************(  65)**1529
**    Operand J is not declared1529
  3733     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 601529
*  12-S*********************(  65)**1529
**    Operand I is not declared1529
  3734MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO1530
*  12-S***************************(  66)**1530
**    Operand I is not declared1530
  3735IF SI-ALFABETICO1531
*  12-S***********************(  66)**1532
**    Operand SI-ALFABETICO is not declared1532
  3736MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)1532
*  12-S******************************(  66)**1532
**    Operand I is not declared1532
  3737ADD 1 TO J1533
*  12-S********************(  66)**1535
**    Operand J is not declared1535
  3738END-IF1534
* 564-S*************(  66)**1535
**    A scope-delimiter did not have a matching verb and was discarded.1535
  3739     END-PERFORM.1535
* 564-S***************(  66)**1535
**    A scope-delimiter did not have a matching verb and was discarded.1535
  4203     MOVE 0 TO NUM-OK-SEND-BDLDIR.RMB0010BDLDIR171
*  12-S********************************(  66)**171
**    Operand NUM-OK-SEND-BDLDIR is not declared171
  4204     MOVE 1 TO DIR-OK-BDLDIR.RMB0010BDLDIR172
*  12-S***************************(  74)**172
**    Operand DIR-OK-BDLDIR is not declared172
  4205     MOVE 1 TO TEL-OK-BDLDIR.RMB0010BDLDIR173
*  12-S***************************(  74)**173
**    Operand TEL-OK-BDLDIR is not declared173
  4206     INITIALIZE TABLA-DIR-BDLDIR.RMB0010BDLDIR174
*  12-S*******************************(  74)**174
**    Operand TABLA-DIR-BDLDIR is not declared174
  4207     INITIALIZE TABLA-TEL-BDLDIR.RMB0010BDLDIR175
*  12-S*******************************(  74)**175
**    Operand TABLA-TEL-BDLDIR is not declared175
  4208     INITIALIZE TABLA-DIRFINALES-BDLDIR.RMB0010BDLDIR176
*  12-S**************************************(  74)**176
**    Operand TABLA-DIRFINALES-BDLDIR is not declared176
  4209     INITIALIZE TABLA-TELFINALES-BDLDIR.RMB0010BDLDIR177
*  12-S**************************************(  74)**177
**    Operand TABLA-TELFINALES-BDLDIR is not declared177
  4210     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178    4210     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.AAM0017BDLDIR178
*  12-S*****************************************(  74)**178
**    Operand TABLA-DIRFINALESFIN-BDLDIR is not declared178
  4211     INITIALIZE T-DIRFINALESAUX-BDLDIR.AAM0017BDLDIR179
*  12-S*************************************(  74)**179
**    Operand T-DIRFINALESAUX-BDLDIR is not declared179
  4215IF OPEN-BDLSTDCIU-BDLDIR = 0RMB0010BDLDIR183
*  12-S******************************(  74)**183
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared183
  4216MOVE 1 TO OPEN-BDLSTDCIU-BDLDIRRMB0010BDLDIR184
*  12-S****************************************(  74)**185
**    Operand OPEN-BDLSTDCIU-BDLDIR is not declared185
  4218END-IF.RMB0010BDLDIR186
* 564-S************(  74)**186
**    A scope-delimiter did not have a matching verb and was discarded.186
  4222MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*  12-S*****************************************(  75)**190
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared190
  4227MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*  12-S*****************************************(  75)**195
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared195
  4232MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*  12-S*****************************************(  75)**200
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared200
  4239     MOVE 0 TO PATRON-CIU-BDLDIR CODIGO-DANE-CIU-BDLDIR.RMB0010BDLDIR207
*  12-S*******************************(  75)**207
**    Operand PATRON-CIU-BDLDIR is not declared207
  4240     MOVE SPACES TO CODIGO-DANE-CIU-BDLDIR.RMB0010BDLDIR208
*  12-S*****************************************(  75)**208
**    Operand CODIGO-DANE-CIU-BDLDIR is not declared208
  4241     MOVE 0 TO I-CIU-BDLDIR.RMB0010BDLDIR209
*  12-S**************************(  75)**209
**    Operand I-CIU-BDLDIR is not declared209
  4242     INSPECT LLAVE-BDLSTDCIU TALLYING I-CIU-BDLDIR FOR ALL "BOGOT"RMB0010BDLDIR210
*  12-S*************************************************(  75)**210
**    Operand I-CIU-BDLDIR is not declared210
  4243     IF I-CIU-BDLDIR > 0RMB0010BDLDIR211
*  12-S*******************(  75)**211
**    Operand I-CIU-BDLDIR is not declared211
  4244MOVE 1 TO PATRON-CIU-BDLDIRRMB0010BDLDIR212
*  12-S**********************************(  75)**213
**    Operand PATRON-CIU-BDLDIR is not declared213
  4246     ELSERMB0010BDLDIR214
* 562-S********(  75)**215
**    An "ELSE" phrase did not have a matching IF and was discarded.215
  4247MOVE LLAVE-BDLSTDCIU TO LLAVE-AUX-CIU-BDLDIRRMB0010BDLDIR215
*  12-S***************************************************(  75)**216
**    Operand LLAVE-AUX-CIU-BDLDIR is not declared216
  4248UNSTRING LLAVE-AUX21-CIU-BDLDIR DELIMITED BY ALL " " INTO RMB0010BDLDIR216  
*  12-S**************************************(  75)**216*  12-S**************************************(  75)**216
**    Operand LLAVE-AUX21-CIU-BDLDIR is not declared216
  4250INSPECT CODIGO-DANE-CIU-BDLDIR REPLACING ALL " " BY "0"   RMB0010BDLDIR218
*  12-S*************************************(  75)**218
**    Operand CODIGO-DANE-CIU-BDLDIR is not declared218
  4251     END-IF.RMB0010BDLDIR219
* 564-S**********(  76)**219
**    A scope-delimiter did not have a matching verb and was discarded.219
  4252     MOVE SPACES TO CAMPO-CIU-BDLDIRRMB0010BDLDIR220
*  12-S***********************************(  76)**221
**    Operand CAMPO-CIU-BDLDIR is not declared221
  4253     MOVE 1 TO I-CIU-BDLDIR J-CIU-BDLDIRRMB0010BDLDIR221
*  12-S**************************(  76)**222
**    Operand I-CIU-BDLDIR is not declared222
  4254     PERFORM UNTIL I-CIU-BDLDIR > 30RMB0010BDLDIR222
*  12-S******************************(  76)**222
**    Operand I-CIU-BDLDIR is not declared222
  4255IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) <> " "RMB0010BDLDIR223
*  12-S**************************************(  76)**223
**    Operand I-CIU-BDLDIR is not declared223
  4256IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) =RMB0010BDLDIR224
*  12-S*****************************************(  76)**224
**    Operand I-CIU-BDLDIR is not declared224
  4259MOVE 50 TO I-CIU-BDLDIRRMB0010BDLDIR227
*  12-S************************************(  76)**229
**    Operand I-CIU-BDLDIR is not declared229
  4261IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) NOT NUMERICRMB0010BDLDIR229
*  12-S********************************************(  76)**229
**    Operand I-CIU-BDLDIR is not declared229
  4262MOVE LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1)RMB0010BDLDIR230
*  12-S*************************************************(  76)**230
**    Operand I-CIU-BDLDIR is not declared230
  4264ADD 1 TO J-CIU-BDLDIRRMB0010BDLDIR232
*  12-S*************************************(  76)**234
**    Operand J-CIU-BDLDIR is not declared234
  4265END-IFRMB0010BDLDIR233
* 564-S*******************(  76)**234
**    A scope-delimiter did not have a matching verb and was discarded.234
  4266END-IFRMB0010BDLDIR234
* 564-S****************(  76)**235
**    A scope-delimiter did not have a matching verb and was discarded.235
  4267END-IFRMB0010BDLDIR235
* 564-S*************(  76)**236
**    A scope-delimiter did not have a matching verb and was discarded.236
  4268ADD 1 TO I-CIU-BDLDIRRMB0010BDLDIR236
*  12-S****************************(  76)**237
**    Operand I-CIU-BDLDIR is not declared237
  4269     END-PERFORM.RMB0010BDLDIR237
* 564-S***************(  76)**237
**    A scope-delimiter did not have a matching verb and was discarded.237**    A scope-delimiter did not have a matching verb and was discarded.237
  4270     IF CAMPO-CIU-BDLDIR = SPACESRMB0010BDLDIR238
*  12-S***********************(  76)**238
**    Operand CAMPO-CIU-BDLDIR is not declared238
  4271IF CODIGO-DANE-CIU-BDLDIR NUMERIC ANDRMB0010BDLDIR239
*  12-S********************************(  76)**239
**    Operand CODIGO-DANE-CIU-BDLDIR is not declared239
  4273MOVE CODIGO-DANE-CIU-BDLDIR TO CAMPO-CIU-BDLDIRRMB0010BDLDIR241
*  12-S*************************************(  76)**241
**    Operand CODIGO-DANE-CIU-BDLDIR is not declared241
  4274END-IFRMB0010BDLDIR242
* 564-S*************(  77)**243
**    A scope-delimiter did not have a matching verb and was discarded.243
  4275     END-IF.RMB0010BDLDIR243
* 564-S**********(  77)**243
**    A scope-delimiter did not have a matching verb and was discarded.243
  4276     MOVE CAMPO-CIU-BDLDIR TO LLAVE-BDLSTDCIURMB0010BDLDIR244
*  12-S*************************(  77)**244
**    Operand CAMPO-CIU-BDLDIR is not declared244
  4278MOVE SPACESTO CIUDAD-ESTANDAR-CIU-BDLDIRRMB0010BDLDIR246
*  12-S***********************************************************     (  77)**247
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared247
  4280MOVE CIUDAD-BDLSTDCIU TO CIUDAD-ESTANDAR-CIU-BDLDIR   RMB0010BDLDIR248
*  12-S**************************************************************  (  77)**249
**    Operand CIUDAD-ESTANDAR-CIU-BDLDIR is not declared249
  4287     IF NUM-OK-SEND-BDLDIR <= 500RMB0010BDLDIR255
*  12-S*************************(  77)**255
**    Operand NUM-OK-SEND-BDLDIR is not declared255
  4289     END-IF.BDLDIR257
* 564-S**********(  77)**257
**    A scope-delimiter did not have a matching verb and was discarded.257
  4290     ADD 1 TO NUM-OK-SEND-BDLDIR.RMB0010BDLDIR258
*  12-S*******************************(  77)**258
**    Operand NUM-OK-SEND-BDLDIR is not declared258
  4298     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIRRMB0010BDLDIR266
*  12-S******************************************************(  77)**267
**    Operand CIUDAD-RES-A-ESTANDAR-BDLDIR is not declared267
  4299     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIRRMB0010BDLDIR267
*  12-S******************************************************(  77)**268
**    Operand CIUDAD-LAB-A-ESTANDAR-BDLDIR is not declared268
  4300     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.RMB0010BDLDIR268
*  12-S******************************************************(  77)**268
**    Operand CIUDAD-COR-A-ESTANDAR-BDLDIR is not declared268
  4321IF DIRRES-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010BDLDIR289
*  12-S******************************************************(  77)**289
**    Operand DIR-OK-BDLDIR is not declared289
  4322MOVE DIRRES-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR290
*  12-S**************************************************(  78)**290
**    Operand V-DIRECCION-BDLDIR is not declared290:qNo write since last change (:quit! overrides):q!/d/iccol/desarrollo/fuentes>
shell will timeout in 60 seconds due to inactivity
ksh: timed out waiting for input
You have running jobs
