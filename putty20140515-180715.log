=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.15 18:07:15 =~=~=~=~=~=~=~=~=~=~=~=
login as: icdgd
Using keyboard-interactive authentication.
Password: 
Last login: Thu May 15 15:25:50 2014 from 172.16.10.31
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icdgd@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo $fu
/d/iccol/desarrollo $view   CARGAJUR.CBL
"CARGAJUR.CBL" 2362 lines, 108795 characters $SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualizacin del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI"CARGAJUR.CBL" 2362 lines, 108795 characters line 1 of 2362 --0%-- 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
2362 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    ACTALEJUR.



      ******************************************************************
      * Actualización del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-name
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.
      * TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *        assign to disk TITLE-BDIIREGI
c     *        organization is indexed
c     *        access mode is dynamic

c     *        record key is LLAVE-BDIIREGI

APPEND MODEc     $if SW-STATUS-BDIIREGI = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIREGI SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIREGI CON status.........."

APPEND MODEc     *        file status is COD-RETORNO-BDIIREGI

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODEc     $SET IDXFORMAT"0"

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FS.

APPEND MODEc     * BDIIDIAN.v.03.0001

APPEND MODEc     * MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA

APPEND MODEc     * POR LA DIAN

APPEND MODEc     * DIAN equivale a la AFIP de Argentina, contiene ids de empresas

APPEND MODEc     ******************************************************************

APPEND MODEc     $SET CONSTANT SW-STATUS-BDIIDIAN"NO"

APPEND MODEc     *    select BDIIDIAN assign to disk TITLE-BDIIDIAN

APPEND MODEc     *        organization is indexed

APPEND MODEc     *        access mode  is dynamic

APPEND MODEc     *        record key   is LLAVE-BDIIDIAN

APPEND MODEc     $if SW-STATUS-BDIIDIAN = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIDIAN SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIDIAN CON status.........."

APPEND MODEc     *        file status is COD-RETORNO-BDIIDIAN

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODE 

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FS.

APPEND MODEc     * BDIIDAS.v.03.0001

APPEND MODEc     *=================================================================

APPEND MODEc     * MAESTRO DE CEDULAS DE EXTRANJERIA, PROPORCIONADAS POR EL DAS

APPEND MODEc     * Equivale a la SIDE de Argentina, provee ids de extranjeros

APPEND MODEc     *=================================================================

APPEND MODEc     $SET CONSTANT SW-STATUS-BDIIDAS"NO"

APPEND MODEc     *    select BDIIDAS assign to disk TITLE-BDIIDAS

APPEND MODEc     *        organization is indexed

APPEND MODEc     *        access mode is dynamic

APPEND MODEc     *        record key is LLAVE-BDIIDAS

APPEND MODEc     $if SW-STATUS-BDIIDAS = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIDAS SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIDAS CON status.........."

APPEND MODEc     *        file status is COD-RETORNO-BDIIDAS

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record

APPEND MODE              file status is EST-BDIIALE.==.

APPEND MODEc     * BDIIALE-FS.v01.0001

APPEND MODEc     * Maestro de alertas reportadas por suscriptotres

APPEND MODEc     * Suscriptores son bancos, financieras y otros clientes de

APPEND MODEc     * Datacredito

APPEND MODEc

APPEND MODEc     $SET CONSTANT SW-STATUS-BDIIALE"NO"

APPEND MODEc     *    select BDIIALE

APPEND MODEc     *        assign to disk MAES-BDIIALE-TITLE

APPEND MODEc     *        organization is indexed

APPEND MODEc     *        access mode is dynamic

APPEND MODEc     *        record key is LLAVE-BDIIALE

APPEND MODEc     $if SW-STATUS-BDIIALE = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIALE SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIALE CON status.........."

APPEND MODEc     *        file status is EST-BDIIALE

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(6).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(6).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODEc     * BDIIREGI.v.03.0006

APPEND MODEc     ******************************************************************

APPEND MODEc     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL

APPEND MODEc     ******************************************************************

APPEND MODEc     *FD  BDIIREGI.

APPEND MODEc     *01  REG-BDIIREGI.

APPEND MODEc     *    03  LLAVE-BDIIREGI          pic 9(12).

APPEND MODEc     *    03  LLAVE-BDIIREGI-R        redefines LLAVE-BDIIREGI.

APPEND MODEc     *        05  TIPO-ID-BDIIREGI    pic 9.

APPEND MODEc     *        05  CEDULA-BDIIREGI     pic 9(11).

APPEND MODEc     *    03  DES-NOMBRE1-BDIIREGI    pic X(12).

APPEND MODEc     *    03  DES-NOMBRE2-BDIIREGI    pic X(12).

APPEND MODEc     *    03  APELLIDO1-BDIIREGI      pic X(16).

APPEND MODEc     *    03  APELLIDO2-BDIIREGI      pic X(16).

APPEND MODEc     *    03  ESTADO-CIVIL-BDIIREGI   pic 9.

APPEND MODEc     *    03  FECHA-EXPEDI-BDIIREGI.

APPEND MODEc     *        05  SIGLO-EXP-BDIIREGI  pic 9(2).

APPEND MODEc     *        05  FECHA-EXP-BDIIREGI  pic 9(6).

APPEND MODEc     *    03  INF-NUMERICA-BDIIREGI   pic 9(7).

APPEND MODEc     *    03  INF-NUMERICA-BDIIREGI-R redefines INF-NUMERICA-BDIIREGI.

APPEND MODEc     *        05 DEP-EXP-BDIIREGI     pic 99.

APPEND MODEc     *        05 MUNIC-EXP-BDIIREGI   pic 999.

APPEND MODEc     *        05 ESTADO-VIG-BDIIREGI  pic 99.

APPEND MODEc     *    03  FECHA-NACIMNTO-BDIIREGI.

APPEND MODEc     *        05  SIGLO-NAC-BDIIREGI  pic 9(2).

APPEND MODEc     *        05  FECHA-NAC-BDIIREGI  pic 9(6).

APPEND MODEc     *    03  FECHA-EDICTO-BDIIREGI.

APPEND MODEc     *        05  SIGLO-EDI-BDIIREGI  pic 9(2).

APPEND MODEc     *        05  FECHA-EDI-BDIIREGI  pic 9(6).

APPEND MODEc     *    03  IND-SEXO-BDIIREGI       pic X.

APPEND MODEc     *    03  IND-ESTADO-BDIIREGI     pic 9.

APPEND MODEc     *    03  NUM-RESOLUC-BDIIREGI    pic 9(4).

APPEND MODEc     *    03  ANO-RESOLUC-BDIIREGI    pic 9(2).

APPEND MODEc     *    03  BLOQUEO-TUTELA-BDIIREGI pic X(1).

APPEND MODEc     *    03  FECHA-CREAC-BDIIREGI    pic 9(8).

APPEND MODEc     *    03  FECHA-MODIF-BDIIREGI    pic 9(8).

APPEND MODEc     *    03  IND-MODIF-BDIIREGI      pic X(1).

APPEND MODEc     *    03  IND-CREACION-BDIIREGI redefines

APPEND MODEc     *             IND-MODIF-BDIIREGI pic X(1).

APPEND MODEc     *    03  IND-CAMBIO-BDIIREGI     pic X(1).

APPEND MODEc     *    03  IND-CONSULADO-BDIIREGI  pic 9(1).

APPEND MODEc     *    03  COD-CONSULADO-BDIIREGI  pic 9(3).

APPEND MODEc     *    03  ES-IND-CAMARA-BDIIREGI  pic 9(1).

APPEND MODEc     *    03  ES-IND-BURO-BDIIREGI    pic 9(1).

APPEND MODEc     *    03  FILLER-BDIIREGI         pic X(27).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODEc     * BDIIDIAN.v.03.0004

APPEND MODEc     ******************************************************************

APPEND MODEc     *FD  BDIIDIAN.

APPEND MODEc     *01  REG-BDIIDIAN.

APPEND MODEc     *    03 LLAVE-BDIIDIAN.

APPEND MODEc     *       05 NITS-BDIIDIAN            pic X(11).

APPEND MODEc     *       05 NITS-R-BDIIDIAN redefines NITS-BDIIDIAN

APPEND MODEc     *                                   pic 9(11).

APPEND MODEc     *    03 DIGITO-CONTROL-BDIIDIAN     pic X(01).

APPEND MODEc     *    03 DESCRIPCION1-BDIIDIAN       pic X(80).

APPEND MODEc     *    03 DESCRIPCION1-BDIIDIAN-R redefines DESCRIPCION1-BDIIDIAN.

APPEND MODEc     *       05 DESCRIPCION-BDIIDIAN     pic X(79).

APPEND MODEc     *       05 ESTADO-BDIIDIAN          pic 9.

APPEND MODEc     *    03 COD-CIIU-BDIIDIAN           pic 9(4).

APPEND MODEc     *    03 FEC-INSCRIP-BDIIDIAN        pic 9(8).

APPEND MODEc     *    03 FECHA-CREAC-BDIIDIAN        pic 9(8).

APPEND MODEc     *    03 FECHA-MODIF-BDIIDIAN        pic 9(8).

APPEND MODEc     *    03 IND-MODIF-BDIIDIAN          pic X(1).

APPEND MODEc     *    03 ES-CLIENTE-DATACR-BDIIDIAN  pic X(1). *> S,N

APPEND MODEc     *    03 VE-INDEPENDIENTES-BDIIDIAN  pic X(1). *> S,N

APPEND MODEc     *    03 FECHA-MODIF-INDE-BDIIDIAN   pic 9(04). *> AAMM

APPEND MODEc     *    03 FILLER-BDIIDIAN             pic X(19).

APPEND MODEc     *    03 FILLER-BDIIDIAN             pic X(13).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODEc     * BDIIDAS.v.03.0002

APPEND MODEc     ******************************************************************

APPEND MODEc     *FD  BDIIDAS.

APPEND MODEc     *01  REG-BDIIDAS.

APPEND MODEc     *    03 LLAVE-BDIIDAS.

APPEND MODEc     *       05 TIPO-ID-BDIIDAS           pic 9.

APPEND MODEc     *       05 NUM-ID-BDIIDAS            pic 9(11).

APPEND MODEc     *    03 NACIO-BDIIDAS                pic X(15).

APPEND MODEc     *    03 NOMBRE-BDIIDAS               pic X(45).

APPEND MODEc     *    03 FECHA-CREAC-BDIIDAS          pic 9(8).

APPEND MODEc     *    03 FECHA-MODIF-BDIIDAS          pic 9(8).

APPEND MODEc     *    03 IND-MODIF-BDIIDAS            pic X(1).

APPEND MODEc     *    03 FILLER-BDIIDAS               pic X(31).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODEc     * BDIIALE-FD.v01.0003.

APPEND MODEc     *****************************************************************

APPEND MODEc     *FD BDIIALE.

APPEND MODEc     *01 REG-BDIIALE.

APPEND MODEc     *   02 LLAVE-BDIIALE.

APPEND MODEc     *      03 TIP-IDE-BDIIALE        pic 9(01).

APPEND MODEc     *      03 NUM-IDE-BDIIALE        pic 9(11).

APPEND MODEc     *      03 FUENTE-BDIIALE         pic 9(06).

APPEND MODEc     *      03 COD-ALERTA-BDIIALE     pic 9(03).

APPEND MODEc     *      03 LLASEC-BDIIALE         pic X(08).

APPEND MODEc     *   02 ENCABEZADO-BDIIALE.

APPEND MODEc     *      03 FEC-NOV-BDIIALE        pic 9(08).

APPEND MODEc     *      03 FEC-VEN-BDIIALE        pic 9(08).

APPEND MODEc     *      03 FEC-REP-BDIIALE        pic 9(08).

APPEND MODEc     *      03 BLOQUEO-BDIIALE        pic 9(01).

APPEND MODEc     *      03 FILLER-BDIIALE         pic X(10).

APPEND MODEc     *      03 INF-DATAHOST-BDIIALE   pic X(18).

APPEND MODEc     *      03 LINEAS-BDIIALE.

APPEND MODEc     *         04 LINEA1-BDIIALE      pic X(50).

APPEND MODEc     *         04 LINEA2-BDIIALE      pic X(50).

APPEND MODEc     *      03 filler redefines LINEAS-BDIIALE.

APPEND MODEc     *         04 DATOS-BDIIALE       pic X(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODEc     *BDIIVIDE.WS.v03.0003.

APPEND MODEc     ******************************************************************

APPEND MODEc     *01  NUM-ID-W-BDIIVIDE.

APPEND MODEc     *    03  NUM-ID-W11-BDIIVIDE           pic 9(11) value zeros.

APPEND MODEc     *    03  NUM-ID-W11-R-BDIIVIDE redefines NUM-ID-W11-BDIIVIDE.

APPEND MODEc     *        05 NUM-ID-W10-BDIIVIDE        pic 9(10).

APPEND MODEc     *        05 RESTO-NUM-ID-BDIIVIDE      pic 9.

APPEND MODEc     *01  NOMBRES-AUX-W-BDIIVIDE.

APPEND MODEc     *    03 PRIMER-APELLIDO-BDIIVIDE       pic X(15) value spaces.

APPEND MODEc     *    03 SEGUNDO-APELLIDO-BDIIVIDE      pic X(15) value spaces.

APPEND MODEc     *    03 PRIMER-NOMBRE-BDIIVIDE         pic X(15) value spaces.

APPEND MODEc     *    03 SEGUNDO-NOMBRE-BDIIVIDE        pic X(15) value spaces.

APPEND MODEc     *    03 NOM-LEIDO-BDIIVIDE             pic X(65) value spaces.

APPEND MODEc     *

APPEND MODEc     *01 PARAMETROS-ENTRADA-BDIIVIDE        pic X(100) value spaces.

APPEND MODEc     *01 PARAMETROS-ENTRADA-R-BDIIVIDE redefines

APPEND MODEc     *                                     PARAMETROS-ENTRADA-BDIIVIDE.

APPEND MODEc     *    03 TIP-IDE-BDIIVIDE               pic X.

APPEND MODEc     *    03 NUM-IDE-BDIIVIDE               pic X(11) JUSTIFIED right.

APPEND MODEc     *    03 NUM-IDE-BDIIVIDE-R redefines   NUM-IDE-BDIIVIDE

APPEND MODEc     *                                      pic 9(11).

APPEND MODEc     *    03 NOMBRE-BDIIVIDE                pic X(65).

APPEND MODEc     *    03 SW-VERIFNOM-BDIIVIDE           pic 9.

APPEND MODEc     *    03 NUM-BLOQUES-BDIIVIDE           pic 9.

APPEND MODEc     *    03 SW-VALTIPID-BDIIVIDE           pic 9.

APPEND MODEc     *    03 SW-ASGTIPID-BDIIVIDE           pic 9.

APPEND MODEc     *    03 SW-DIGCHEQUEO-BDIIVIDE         pic 9.

APPEND MODEc     *    03 FILLER-BDIIVIDE                pic X(18).

APPEND MODEc     *

APPEND MODEc     *01 PARAMETROS-SALIDA-BDIIVIDE.

APPEND MODEc     *   03 NOM-VAL-BDIIVIDE                pic X(65) value spaces.

APPEND MODEc     *   03 SW-ID-BDIIVIDE                  pic 9 value 0.

APPEND MODEc     *   03 SW-NOMBRES-BDIIVIDE             pic 9 value 0.

APPEND MODEc     *   03 SW-TID-BDIIVIDE                 pic 9 value 0.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con las alertas del sistema

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODEc     * BDIIALE-WS.v01.0007

APPEND MODEc     *01 VARIABLES-BDIIALE.

APPEND MODEc     *   02 ES-INDEPENDIENTE-BDIIALE           pic 9(01) value 0.

APPEND MODEc     *   02 MIRO-SIES-INDEPENDIENTE-BDIIALE    pic 9(01) value 0.

APPEND MODEc     *   02 MAES-BDIIALE-TITLE    pic X(20)

APPEND MODEc     *                            value "$DATABASE/BDIIALE".

APPEND MODEc     *   02 EST-BDIIALE           pic X(02) value "00".

APPEND MODEc     *   02 FIN-BDIIALE           pic 9(01) value 0.

APPEND MODEc     *   02 PROCESAR-BDIIALE      pic 9(01) value 0.

APPEND MODEc     *   02 CONT-LINEAS-BDIIALE   pic 9(03) value 0.

APPEND MODEc     *   02 ABIERTO-BDIIALE       pic 9(01) value 0.

APPEND MODEc     *   02 TIP-IDE-AUX-BDIIALE   pic 9(01) value 0.

APPEND MODEc     *   02 NUM-IDE-AUX-BDIIALE   pic 9(11) value 0.

APPEND MODEc     *   02 MARCAR-ICBTCO-BDIIALE pic 9(01) value 0.

APPEND MODEc     *   02 FECHA-AUX-BDIIALE     pic 9(08) value 0.

APPEND MODEc     *   02 FECHA-NOV-AUX-BDIIALE pic 9(08) value 0.

APPEND MODEc     *   02 FECHA-VEN-AUX-BDIIALE pic 9(08) value 0.

APPEND MODEc     *   02 FECHA-REP-AUX-BDIIALE pic 9(08) value 0.

APPEND MODEc     *   02 FUENTE-AUX-BDIIALE    pic 9(06) value 0.

APPEND MODEc     *   02 NOMFUE1-AUX-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 NOMFUE2-AUX-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 CODALE-AUX-BDIIALE    pic 9(03) value 0.

APPEND MODEc     *   02 TIPALE-AUX-BDIIALE    pic X(01) value spaces.

APPEND MODEc     *   02 TEXTO1-AUX-BDIIALE    pic X(50) value spaces.

APPEND MODEc     *   02 INF-DATAHOST-AUX-BDIIALE      pic X(18) value spaces.

APPEND MODEc     *   02 PAR-CODBLOALER        pic 9(1)  value 1.

APPEND MODEc     *   02 PAR-MSGBLOALER        pic X(60) value

APPEND MODEc     *      " ALERTA DADA POR LA ENTIDAD".

APPEND MODEc     *01 M-ALERTA.

APPEND MODEc     *   03 V-ALERTA   occurs 40 TIMES pic 9(02).

APPEND MODEc     *01 TITULOS-BDIIALE.

APPEND MODEc     *   02 filler                pic X(30) value all "=".

APPEND MODEc     *   02 filler    pic X(20) value "==== [ ALERTAS ] ===".

APPEND MODEc     *   02 filler                pic X(30) value all "=".

APPEND MODEc     *   02 filler    pic X(20) value "FUENTE           FEC".

APPEND MODEc     *   02 filler    pic X(20) value "HA           DESCRIP".

APPEND MODEc     *   02 filler    pic X(20) value "CION                ".

APPEND MODEc     *   02 filler    pic X(20) value "                    ".

APPEND MODEc     *   02 filler                pic X(80) value all "=".

APPEND MODEc     *01 LINEA1-BDIIALE-TIT.

APPEND MODEc     *   02 RAYA-BDIIALE          pic X(01) value " ".

APPEND MODEc     *   02 NOMFUE-LIN1-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 FEC-NOV-LIN1-BDIIALE  pic X(11) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 TEXTO-LIN1-BDIIALE    pic X(50) value spaces.

APPEND MODEc     *   02 filler                pic X(02) value spaces.

APPEND MODEc     *01 LINEA2-BDIIALE-TIT.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 NOMFUE-LIN2-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 filler                pic X(11) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 TEXTO-LIN2-BDIIALE    pic X(50) value spaces.

APPEND MODEc     *   02 filler                pic X(02) value spaces.

APPEND MODEc     *   02 TEXTO2-AUX-BDIIALE    pic X(50) value spaces.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres de VALNOM.PROC

APPEND MODE      ******************************************************************

APPEND MODE       copy VALNOM.WS.

APPEND MODEc     * VALNOM-WS.v.0002

APPEND MODEc     * 01 VARIABLES-VALNOM.

APPEND MODEc     *    03 VECTOR-INPUT-VALNOM.

APPEND MODEc     *      04 VM-INPUT-VALNOM     occurs 20 TIMES .

APPEND MODEc     *         05 VMM-INPUT-VALNOM occurs 15 TIMES pic X.

APPEND MODEc     *    03 VECTOR-OK-VALNOM.

APPEND MODEc     *      04 VM-OK-VALNOM         occurs 20 TIMES.

APPEND MODEc     *         05 VMM-OK-VALNOM    occurs 15 TIMES pic X.

APPEND MODEc     *    03 BLOQOK-AUX-VALNOM           pic 9(2).

APPEND MODEc     *    03 CADENA-VALNOM.

APPEND MODEc     *       04 filler                   pic X(2) value "A ".

APPEND MODEc     *       04 NOMBRE-AUX-VALNOM        pic X(65).

APPEND MODEc     *       04 filler redefines NOMBRE-AUX-VALNOM.

APPEND MODEc     *          05 VNOM-AUX-VALNOM occurs 65 TIMES pic X.

APPEND MODEc     *    03 BASURA-VALNOM               pic X(10).

APPEND MODEc     *    03 BLOQUES-INPUT-VALNOM        pic 9(2).

APPEND MODEc     *    03 NOMBRE-INPUT-VALNOM         pic X(65).

APPEND MODEc     *    03 filler redefines NOMBRE-INPUT-VALNOM.

APPEND MODEc     *       05 V-NOMBRE-VALNOM          pic X occurs 65 TIMES.

APPEND MODEc     *    03 NOMBOK-INPUT-VALNOM         pic X(65).

APPEND MODEc     *    03 filler redefines NOMBOK-INPUT-VALNOM.

APPEND MODEc     *       05 V-NOMBOK-VALNOM          pic X occurs 65 TIMES.

APPEND MODEc     *    03 TIP-ID-INPUT-VALNOM         pic 9(02).

APPEND MODEc     *    03 MATCH-OK-OUT-VALNOM         pic 9(01).

APPEND MODEc     *    03 A-VALNOM                    pic 9(05).

APPEND MODEc     *    03 I-VALNOM                    pic 9(05).

APPEND MODEc     *    03 J-VALNOM                    pic 9(05).

APPEND MODEc     *    03 K-VALNOM                    pic 9(05).

APPEND MODEc     *    03 L-VALNOM                    pic 9(05).

APPEND MODEc     *    03 M-VALNOM                    pic 9(05).

APPEND MODEc     *    03 INI-VALNOM                  pic 9(02).

APPEND MODEc     *    03 LON-VALNOM                  pic 9(02).

APPEND MODEc     *    03 LETRAS-OK-VALNOM            pic 9(02).

APPEND MODEc     *    03 LETRAS-OK2-VALNOM           pic 9(02).

APPEND MODEc     *    03 TOTLET-OK-VALNOM            pic 9(02).

APPEND MODEc     *    03 TOTLET-INP-VALNOM           pic 9(02).

APPEND MODEc     *    03 PEDAZO-VALNOM               pic X(15).

APPEND MODEc     *    03 POR-TOT-VALNOM              pic 9(05).

APPEND MODEc     *    03 POR-INP-VALNOM              pic 9(05).

APPEND MODEc     *    03 APROX-TOT-VALNOM            pic 9(05).

APPEND MODEc     *    03 APROX-INP-VALNOM            pic 9(05).

APPEND MODEc     *    03 VECTORES-VALNOM.

APPEND MODEc     *       04 filler                   occurs 256 TIMES.

APPEND MODEc     *          05 CONT-LET-INPUT-VALNOM pic 9(2).

APPEND MODEc     *          05 CONT-LET-OK-VALNOM    pic 9(2).

APPEND MODEc     *    03 VAL-APELLIDO-VALNOM         pic 9.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODEc     * ICFILE-WS.v.0040.

APPEND MODEc     * COPY PARA DIRECCIONAR LOS ARCHIVOS.

APPEND MODEc     *****************************************************************

APPEND MODEc     *01  FILE-TITLES.

APPEND MODEc     *    05  BDUUNI-TITLE        pic X(80) value "$BDU/BDUUNI".

APPEND MODEc     *    05  NOMB-APEL-TITLE     pic X(80) value "$DATABASE/ICBNAP".

APPEND MODEc     *    05  CLAVE-TITLE         pic X(80) value "$DATABASE/ICBCLA".

APPEND MODEc     *    05  TERM-TITLE          pic X(80) value "$DATABASE/ICBTER".

APPEND MODEc     *    05  MAES-PERSON-TITLE   pic X(80) value "$DATABASE/ICMPER".

APPEND MODEc     *    05  MAES-CHECK-TITLE    pic X(80) value "$DATABASE/ICMCHK".

APPEND MODEc     *    05  MAES-CREDIT-TITLE   pic X(80) value "$DATABASE/ICMCRE".

APPEND MODEc     *    05  MAES-MICROC-TITLE   pic X(80) value "$DATABASE/ICMMCR".

APPEND MODEc     *    05  MAES-ICMCHQ-TITLE   pic X(80) value "$DATABASE/ICMCHQ".

APPEND MODEc     *    05  INDEXADO-TITLE      pic X(80) value "$DATABASE/ICBCON".

APPEND MODEc     *    05  SECUENCIAL-TITLE    pic X(80) value "$DATABASE/ICBTCO".

APPEND MODEc     *    05  SUSCRIPTOR-TITLE    pic X(80) value "$DATABASE/ICBSUS".

APPEND MODEc     *    05  ARCHNITS-TITLE      pic X(80) value "ICDIAN".

APPEND MODEc     *    05  ARCHIVO-CLIENTE     pic X(80) value "$DATABASE/ICMCLI".

APPEND MODEc     *    05  MAES-ICMCLN-TITLE   pic X(80) value "$DATABASE/ICMCLN".

APPEND MODEc     *    05  ARCHIVO-PREPAGOS    pic X(80) value "$DATABASE/ICMPRE".

APPEND MODEc     *    05  ARCHIVO-USUARIOS    pic X(80) value "$DATABASE/ICMUSU".

APPEND MODEc     *    05  TITLE-SCODTB        pic X(80) value "$DATABASE/SCODTB".

APPEND MODEc     *    05  TITLE-BDIRMAE1      pic X(80) value "$DATABASE/BDIRMAE1".

APPEND MODEc     *    05  TITLE-BDIRMAE2      pic X(80) value "$DATABASE/BDIRMAE2".

APPEND MODEc     *    05  TITLE-BDIRMAE3      pic X(80) value "$DATABASE/BDIRMAE3".

APPEND MODEc     *    05  TITLE-BDIRMAE4      pic X(80) value "$DATABASE/BDIRMAE4".

APPEND MODEc     *    05  TITLE-BDIRCTR       pic X(80) value "$DATABASE/BDIRCTR".

APPEND MODEc     *    05  TITLE-BDIMHIS       pic X(80) value "$DATABASE/BDIMHIS".

APPEND MODEc     *    05  BDAPRVTR-TITLE      pic X(80) value "$DATABASE/BDAPRVTR".

APPEND MODEc     *    05  TITLE-DTCABD.

APPEND MODEc     *        07 filler           pic X(13) value "$DATOS/DTCABD".

APPEND MODEc     *        07 ANOMESDIA-DTCABD pic 9(08) value zeros.

APPEND MODEc     *    05  BDLCLI-TITLE        pic X(80) value "$DATABASE/BDLCLI".

APPEND MODEc     *    05  SCOREPREC-TITLE     pic X(80) value "$DATOS/SCOREPREC".

APPEND MODEc     *    05  ARCHIVO-LOGS        pic X(80) value

APPEND MODEc     *        "/ic/datacred/desarrollo/logs/ICL325".

APPEND MODEc     *    05  ARCHIVO-TEMPORAL    pic X(80) value

APPEND MODEc     *                                "$TEMPORALES/TEMPORAL".

APPEND MODEc     *    05  ESTAD-CADUC         pic X(80) value

APPEND MODEc     *                                "$TEMPORALES/ESTCAD.DAT".

APPEND MODEc     *    05  MATRIZ-CADUC        pic X(80) value

APPEND MODEc     *                                "$DATABASE/ICTCAD".

APPEND MODEc     *    05  ETQ-CIN             pic X(80) value

APPEND MODEc     *                                "$TEMPORALES/ICINCO.DAT".

APPEND MODEc     *    05  RECLACOM-TITLE      pic X(80) value "$DATABASE/ICMRCM".

APPEND MODEc     *    05  RECLAMOS-TITLE      pic X(80) value "$DATABASE/ICMRCL".

APPEND MODEc     *    05 MAESTRO-FACUCLI      pic X(80) value "$DATABASE/FACUCLI".

APPEND MODEc     *    05 TITLE-FACUCLP        pic X(80) value "$DATABASE/FACUCLP".

APPEND MODEc     *    05 TITLE-FACUAUT        pic X(80) value "$DATABASE/FACUAUT".

APPEND MODEc     *    05 TITLE-FACULOG        pic X(80) value "$DATABASE/FACULOG".

APPEND MODEc     *    05 TITLE-FACUPAR        pic X(80) value

APPEND MODEc     *                                "$DATABASE/FACUPAR.DAT".

APPEND MODEc     *    05 MAES-ICMCREH-TITLE   pic X(80) value "$DATABASE/ICMCREH".

APPEND MODEc     *    05 MAES-ICMCHKH-TITLE   pic X(80) value "$DATABASE/ICMCHKH".

APPEND MODEc     *    05 MAES-ICMCHQH-TITLE   pic X(80) value "$DATABASE/ICMCHQH".

APPEND MODEc     *

APPEND MODEc     *    05 TITLE-CIIU          pic X(80) value "$DATABASE/ICTCIIU".

APPEND MODEc     *    05 TITLE-BDINCCB       pic X(80) value "$ICREGIS/BDINCCB".

APPEND MODEc     *    05 TITLE-BDINREG       pic X(80) value "$ICREGIS/BDINREG".

APPEND MODEc     *    05 TITLE-BDINDAS       pic X(80) value "$ICREGIS/BDINDAS".

APPEND MODEc     *    05 TITLE-BDINDIAN      pic X(80) value "$ICREGIS/BDINDIAN".

APPEND MODEc     *    05 TITLE-CONRAZ        pic X(80)

APPEND MODEc     *                           value "$DATABASE/CONRAZ.DAT".

APPEND MODEc     *    05 TITLE-FRALOG        pic x(80) value "$DATABASE/FRALOG".

APPEND MODEc     *    05 TITLE-FRAINQ        pic X(80) value

APPEND MODEc     *                           "$DATABASE/FRAINQ.DAT".

APPEND MODEc     *    05 TITLE-FRAINQGR      pic X(80) value

APPEND MODEc     *                           "$DATABASE/FRAINQGR.DAT".

APPEND MODEc     *    05 TITLE-BDSCORES.

APPEND MODEc     *       07 filler           pic X(15) value "$SCORES/BDSCORE".

APPEND MODEc     *       07 T-FECHA-PROC     pic 9(04).

APPEND MODEc     *    05 TITLE-ICBPRO        pic x(80) value "$DATABASE/ICBPRO".

APPEND MODEc     *    05 TITLE-DTRLLA        pic x(80) value "$DATABASE/DTRLLA".

APPEND MODEc     *    05 TITLE-DTCLOG        pic X(80) value "$DATABASE/DTCLOG".

APPEND MODEc     *    05 TITLE-DTCCOM        pic X(80) value "$DATABASE/DTCCOM".

APPEND MODEc     *    05 TITLE-DTCING        pic X(80) value "$DATABASE/DTCING".

APPEND MODEc     *    05 TITLE-DTCFAL        pic X(80) value "$DATABASE/DTCFAL".

APPEND MODEc     *    05 TITLE-DTCMDF        pic X(80) value "$DATABASE/DTCMDF".

APPEND MODEc     *    05 TITLE-DTCTRA        pic X(80) value "$DATABASE/DTCTRA".

APPEND MODEc     *    05 TITLE-BDINBYN       pic X(80) value "$ICREGIS/BDINBYN".

APPEND MODEc     *    05 SI-BDIEMSUP         pic X(80) value "$DBSUPER/BDIEMSUP".

APPEND MODEc     *    05 TITLE-BDIEMSUP      pic X(80) value "$DBSUPER/BDIESU".

APPEND MODEc     *    05 SI-BDIEENTI         pic X(80) value "$DBSUPER/BDIEENTI".

APPEND MODEc     *    05 SI-BDIEMPER         pic X(80) value "$DBSUPER/BDIEMPER".

APPEND MODEc     *    05 SI-BDIETEMA         pic X(80) value "$DBSUPER/BDIETEMA".

APPEND MODEc     *    05 SI-BDIEAPER         pic X(80) value "$DBSUPER/BDIEAPER".

APPEND MODEc     *    05 SI-BDIEMENT         pic X(80) value "$DBSUPER/BDIEMENT".

APPEND MODEc     *    05 SI-BDIEMOVI         pic X(80) value "$DBSUPER/BDIEMOVI".

APPEND MODEc     *    05 SI-BDIEHSUP         pic X(80) value "$DBSUPER/BDIEHSUP".

APPEND MODEc     *    05 SI-BDIERECL         pic X(80) value "$DBSUPER/BDIERECL".

APPEND MODEc     *    05 SI-BDIEMTOT         pic X(80) value "$DBSUPER/BDIEMTOT".

APPEND MODEc     *    05 NOMBRE-WEB-SAL.

APPEND MODEc     *       07 NOM-DUE-WEB-SAL pic X(15) value "$DATOS/WEB-SAL.".

APPEND MODEc     *       07 FECHA-WEB-SAL   pic 9(8).

APPEND MODEc     *    05 NOMBRE-RAS-SAL.

APPEND MODEc     *       07 NOM-DUE-WEB-SAL pic X(15) value "$DATOS/RAS-SAL.".

APPEND MODEc     *       07 FECHA-RAS-SAL   pic 9(8).

APPEND MODEc     *    05 NOMBRE-CLAVE-WEB.

APPEND MODEc     *       07 NOMBRE-WEB-W    pic X(80) value "$DATABASE/ARCH-WEB".

APPEND MODEc     *    05 NOMBRE-RAS-LOG.

APPEND MODEc     *       07 NOM-RAS-LOG     pic X(19) value

APPEND MODEc     *                          "$DATOS/WEB-RAS.LOG.".

APPEND MODEc     *       07 FECHA-RAS-LOG   pic 9(8).

APPEND MODEc     *    05 TITLE-BDIIDIAN     pic X(80)  value "$DATABASE/BDIIDIAN".

APPEND MODEc     *    05 TITLE-BDIIREGI     pic X(80)  value "$ICREGIS/BDIIRE".

APPEND MODEc     *    05 TITLE-BDIIDAS      pic X(80)  value "$DATABASE/BDIIDAS".

APPEND MODEc     *    05 TITLE-DTCNHAB      pic X(80)  value "$DATABASE/DTCNHAB".

APPEND MODEc     *    05 TITLE-ICDACT       pic X(80)  value

APPEND MODEc     *                          "$TEMPORALES/ICDACT.DAT".

APPEND MODEc     *    05 NOMBRE-ACTALOG     pic X(80)  value

APPEND MODEc     *                          "$TRABAJO/logs/ACTALOG".

APPEND MODEc     *    05 NOMBRE-VALVEST     pic X(80)  value

APPEND MODEc     *                          "$TRABAJO/logs/VALVEST.DAT".

APPEND MODEc     *    05 NOMBRE-CALIDLOG.

APPEND MODEc     *       07 NOM-CALIDLOG    pic X(23)  value

APPEND MODEc     *                          "$TRABAJO/logs/CALIDLOG-".

APPEND MODEc     *       07 FCH-CALIDLOG    pic 9(8).

APPEND MODEc     *    05 NOMBRE-CALIDDRP.

APPEND MODEc     *       07 NOM-CALIDDRP    pic X(24) value

APPEND MODEc     *                          "$TEMPORALES/CALIDAD-DRP.".

APPEND MODEc     *       07 FCH-CALIDDRP    pic 9(8).

APPEND MODEc     *    05  MAES-ICMVLR-TITLE.

APPEND MODEc     *        07 MAES-DIRECTORY1       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE1            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE2.

APPEND MODEc     *        07 MAES-DIRECTORY2       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE2            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE3.

APPEND MODEc     *        07 MAES-DIRECTORY3       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE3            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE4.

APPEND MODEc     *        07 MAES-DIRECTORY4       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE4            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE5.

APPEND MODEc     *        07 MAES-DIRECTORY5       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE5            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE6.

APPEND MODEc     *        07 MAES-DIRECTORY6       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE6            pic X(63).

APPEND MODEc     *    05 TITLE-BDLDIRACE  pic X(80) value "$DATABASE/BDLDIRACE".

APPEND MODEc     *    05 TITLE-BDLMAIEXC  pic X(80) value "$DATABASE/BDLMAIEXC".

APPEND MODEc     *    05 TITLE-BDLTELEXC  pic X(80) value "$DATABASE/BDLTELEXC".

APPEND MODEc     *    05 TITLE-BDANOM     pic X(80) value "$DATABASE/BDANOM".

APPEND MODEc     *    05 TITLE-FRZMYR     pic X(80) value "$DATABASE/FRZMYR".

APPEND MODEc     *    05 TITLE-DVPDANE    pic X(80) value "$DATABASE/DVPDANE.DAT".

APPEND MODEc     *    05 TITLE-CARACT-IND pic X(80) value

APPEND MODEc     *                                  "$DATABASE/CARACTUSA-INDCL".

APPEND MODEc     *    05 FRABDU-TITLE     pic X(25) value

APPEND MODEc     *                                "$VALORES/frabduact/FRABDU".

APPEND MODEc     *    05 FRABDV-TITLE     pic X(29) value

APPEND MODEc     *                                "$VALORES/frabduact/FRABDU.NEW".

APPEND MODEc     *    05 MAES-ICMHCIIU-TITLE pic X(80) value "$DATABASE/ICMHCIIU".

APPEND MODEc     *    05 MAES-ICMCONTTRJ-TITLE pic X(80) value

APPEND MODEc     *                                   "$DATABASE/ICMCONTTRJ".

APPEND MODEc     *    05 TITLE-ICBCOB     pic X(16) value "$DATABASE/ICBCOB".

APPEND MODEc     *    05 TITLE-SCODAPJA   pic X(37) value "$DATABASE/SCODAPJA".

APPEND MODEc     *01 TITLE-BDSCOREHIS.

APPEND MODEc     *   02 filler          pic X(21) value "$DATABASE/BDSCOREHIS.".

APPEND MODEc     *   02 ANO-ANT-TITLE-BDSCOREHIS  pic 9(04) value 2013.

APPEND MODEc     *   02 filler                    pic X(01) value "-".

APPEND MODEc     *   02 ANO-ACT-TITLE-BDSCOREHIS  pic 9(04) value 2014.

APPEND MODE

APPEND MODE       01 LINEA1-AUX.

APPEND MODE      * TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS

APPEND MODE          02 filler    pic X(29)

APPEND MODE                       value "DEMANDAS JUDICIALES VIGENTES:".

APPEND MODE          02 NUM-VIG-1 pic 9(05) value 0.

APPEND MODE          02 filler    pic X(08) value " ULTIMA:".

APPEND MODE          02 FEC-VIG-1 pic 9(08) value 0.

APPEND MODE       01 LINEA2-AUX.

APPEND MODE          02 filler    pic X(31)

APPEND MODE                       value "DEMANDAS JUDICIALES TERMINADAS:".

APPEND MODE          02 NUM-TER-2 pic 9(05) value 0.

APPEND MODE          02 filler    pic X(14) value spaces.

APPEND MODE       01 VARIABLES-GENERALES.

APPEND MODE          03 real                       pic 9      value 0.

APPEND MODE          03 FIN-ENTRADA                pic 9      value 0.

APPEND MODE          03 FECHA-PROCESO              pic 9(8)   value 0.

APPEND MODE          03 FECHA-VENCIMIENTO          pic 9(8)   value 0.

APPEND MODE          03 DIAS-DESDE-1600            pic 9(8)   value 0.

APPEND MODE       01 INF-DATAHOST-AUX.

APPEND MODE          02 NUM-DEMA-VIG-AUX           pic 9(5).

APPEND MODE          02 NUM-DEMA-TER-AUX           pic 9(5).

APPEND MODE          02 FEC-DEMA-VIG-AUX           pic 9(8).

APPEND MODE       01 VARIABLES-INPUT.

APPEND MODE          03 TIPO-IDE-INP               pic 9.

APPEND MODE          03 NUM-IDE-INP                pic 9(11).

APPEND MODE          03 NOMBRES-INP                pic X(30).

APPEND MODE          03 APELLIDO-PAT-INP           pic X(30).

APPEND MODE          03 APELLIDO-MAT-INP           pic X(30).

APPEND MODE          03 NUM-DEMA-VIG-INP           pic 9(05).

APPEND MODE          03 NUM-DEMA-TER-INP           pic 9(05).

APPEND MODE          03 FEC-DEMA-VIG-INP           pic 9(08).

APPEND MODE          03 TIPO-IDE-INP-X             pic X.

APPEND MODE          03 NUM-IDE-INP-X              pic X(11).

APPEND MODE          03 NUM-DEMA-VIG-INP-X         pic X(05).

APPEND MODE          03 NUM-DEMA-TER-INP-X         pic X(05).

APPEND MODE          03 FEC-DEMA-VIG-INP-X         pic X(08).

APPEND MODE       01 M-ERRORES.

APPEND MODE          03 V-ERR occurs 50 TIMES      pic 9(1).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "SI" para activar 

APPEND MODE      * TODO: fijo en "NO" para pruebas

APPEND MODE           03 P-proceso-real            pic xx value "NO".

APPEND MODE           88 PROCESO-REAL              value "SI".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Código de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Inserción de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificación o eliminación de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un 

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *< end marker

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5 

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo: 

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos. 

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamaño del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               LA-valor                 pic x(50) 

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un código de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 80

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificación invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE          02 ANO-VAL-X                   pic 9(04).

APPEND MODE             88 ANO-VAL  value 1900 thru 2050.

APPEND MODE          02 MES-VAL-X                   pic 9(02).

APPEND MODE             88 MES-VAL  value 01   thru 12.

APPEND MODE          02 DIA-VAL-X                   pic 9(02).

APPEND MODE             88 DIA-VAL  value 01   thru 31.

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    6000-SACAR-RESUMEN

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La información está leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T" 

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validación formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    actualizacion de BDIIALE o grabacion en arch ERRS de defectos

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               add 1 to N-reg-con-error

APPEND MODE           else

APPEND MODE               perform 4300-MODIFICAR-BDIIALE

APPEND MODE               add 1 to N-reg-OK

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-demandas-fecha-ultima(1:2) > "50"

APPEND MODE               string "19" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-embargos-fecha-ultimo(1:2) > "50"

APPEND MODE               string "19" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a " 

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           enf-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones, 

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y 

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero 

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima 

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero 

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyó OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserción de una alerta nueva

APPEND MODE      * Si ya exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro exist\055a es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE 

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificación de una alerta existente

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no exist\055a es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminación de una alerta

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "20" thru "29"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           write BDIIALE-reg

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           rewrite BDIIALE-reg

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: >>>> implementar la grabación del archivo ERRS

APPEND MODE           display "NO GRABA ERRS".

APPEND MODE 

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    según se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0 

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE               unstring LA-num into LA-descarte LA-valor(1)

APPEND MODE               delimited by all spaces

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE               unstring LA-num into LA-descarte LA-valor(2)

APPEND MODE               delimited by all spaces

APPEND MODE               string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE               string LA-parte(LAx, 2) LA-valor(2)

APPEND MODE               string LA-parte(LAx, 3) LA-valor(3)

APPEND MODE               string LA-parte(LAx, 4) LA-valor(4)

APPEND MODE               string LA-parte(LAx, 5) LA-valor(5)

APPEND MODE               string LA-parte(LAx, 6) LA-valor(6)

APPEND MODE               string LA-parte(LAx, 7) LA-valor(7)

APPEND MODE               string LA-parte(LAx, 8) LA-valor(8)

APPEND MODE               string LA-parte(LAx, 9) LA-valor(9)

APPEND MODE               string LA-parte(LAx, 10) LA-valor(10)

APPEND MODE               delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso

APPEND MODE           display "Carga de archivo JURAD"

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "command line: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01" *> 01 Envio Original - Carga TOTAL 1a vez

APPEND MODE               perform 1000-CARGA-TOTAL

APPEND MODE           when "02" *> 02 Archivo Semanal - Carga PARCIAL

APPEND MODE               perform 1000-ACTUALIZACION

APPEND MODE           when "03" *> 03 Archivo Mensual - Carga PARCIAL

APPEND MODE               perform 1000-ACTUALIZACION

APPEND MODE           when "04" *> 04 Refresque Total - Carga TOTAL

APPEND MODE               perform 1000-CARGA-TOTAL

APPEND MODE      *    valor invalido

APPEND MODE           when other

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD 

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size 

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una decha 50 años posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo jurad "

APPEND MODE                   display "Nombre del archivo: " P-file-name

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string P-file-name(1:19) "_ERRORES.txt" into

APPEND MODE           ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm frm 1 by 1 

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE               unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE               LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE               LA-parte(LAx, n) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE               LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE               delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect PA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect PA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE invalid key

APPEND MODE      *        no hay registros

APPEND MODE               exit paragraph

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas. 

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time.

APPEND MODE      *    leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display "Proceso cancelado"

APPEND MODE           goback.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(80) value low-values.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input                    pic x(80).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input(1:80) not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display reg-input(1:80)

APPEND MODE               move reg-input(1:80) to reg-input-anterior

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program ACTALEJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * De aqu\055 para abajo se va a eliminar, son recortes del programa

APPEND MODE      * ejemplo (rescatar los COPYs)

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE      *6000-SACAR-RESUMEN.

APPEND MODE      ****************************************************************

APPEND MODE      ****************************************************************

APPEND MODE      *    display "==============[ RESUMEN del PROCESO ]============"

APPEND MODE      *    display "TIPO DE PROCESO             = "   COMANDO(1:10)

APPEND MODE      *    display "DEMANDADOS LEIDOS           = " CONT-LEIDOS

APPEND MODE      *    display "  DEMANDADOS VALIDOS        = " CONT-REGISTROS-OK

APPEND MODE      *    display "    DEMANDADOS CREADOS      = " CONT-WRITE-OK

APPEND MODE      *    display "    DEMANDADOS ACTUALIZADOS = " CONT-REWRITE-OK

APPEND MODE      *    display "    DEMANDADOS ERR CREAR    = " CONT-WRITE-ERR

APPEND MODE      *    display "    DEMANDADOS ERR ACTUALIZ = " CONT-REWRITE-ERR

APPEND MODE      *    display "  DEMANDADOS NO VALIDOS     = " CONT-REGISTROS-ERR

APPEND MODE      *    display "=================================================".

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODEc     *BDIIVIDE.PROC.v.03.0006

APPEND MODEc     ******************************************************************

APPEND MODEc     * Rutina de validacion de identificaciones

APPEND MODEc     ******************************************************************

APPEND MODEc

APPEND MODEc     *80100-VALIDAR-IDENTIFICACION.

APPEND MODEc     *===================================*

APPEND MODEc     * Valida el numero de identificacion contra las bases de datos

APPEND MODEc     * de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI

APPEND MODEc     * y verifica la coincidencia del nombre reportado

APPEND MODEc     *===================================*

APPEND MODEc     *    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM

APPEND MODEc     *    NOMBRES-AUX-W-BDIIVIDE

APPEND MODEc     *    move zeros to NUM-IDE-BDIIVIDE

APPEND MODEc     *    if SW-VERIFNOM-BDIIVIDE not numeric

APPEND MODEc     *        move zeros to SW-VERIFNOM-BDIIVIDE

APPEND MODEc     *    end-if

APPEND MODEc     *    if SW-ASGTIPID-BDIIVIDE not numeric

APPEND MODEc     *        move zeros to SW-ASGTIPID-BDIIVIDE

APPEND MODEc     *    end-if

APPEND MODEc     *    if SW-VALTIPID-BDIIVIDE not numeric

APPEND MODEc     *        move zeros to SW-VALTIPID-BDIIVIDE

APPEND MODEc     *    end-if

APPEND MODEc     *    if SW-DIGCHEQUEO-BDIIVIDE not numeric

APPEND MODEc     *        move zeros to SW-DIGCHEQUEO-BDIIVIDE

APPEND MODEc     *    end-if

APPEND MODEc     *    if NUM-IDE-BDIIVIDE is numeric and NUM-IDE-BDIIVIDE <> zeros

APPEND MODEc     *        if SW-ASGTIPID-BDIIVIDE = 1

APPEND MODEc     *            perform 80300-ASIGNAR-TIPO-ID

APPEND MODEc     *        end-if

APPEND MODEc     *        if SW-VALTIPID-BDIIVIDE = 1

APPEND MODEc     *            perform 80400-VALIDAR-TIPO-ID

APPEND MODEc     *        end-if

APPEND MODEc     *        if SW-DIGCHEQUEO-BDIIVIDE = 1

APPEND MODEc     *            perform 80500-ELIMINAR-DIGITO-CHEQUEO

APPEND MODEc     *        end-if

APPEND MODEc     *        if SW-VALTIPID-BDIIVIDE = 0 or

APPEND MODEc     *            (SW-VALTIPID-BDIIVIDE = 1 and SW-TID-BDIIVIDE = 0)

APPEND MODEc     *            perform 80200-VALIDAR-ID

APPEND MODEc     *            INITIALIZE NOM-VAL-BDIIVIDE

APPEND MODEc     *            move NOM-LEIDO-BDIIVIDE to NOM-VAL-BDIIVIDE

APPEND MODEc     *            if SW-VERIFNOM-BDIIVIDE = 1

APPEND MODEc     *                move TIP-IDE-BDIIVIDE to TIP-ID-INPUT-VALNOM

APPEND MODEc     *                move NOMBRE-BDIIVIDE to NOMBRE-INPUT-VALNOM

APPEND MODEc     *                move NOM-VAL-BDIIVIDE to NOMBOK-INPUT-VALNOM

APPEND MODEc     *                if SW-ID-BDIIVIDE = 0

APPEND MODEc     *                    if NUM-BLOQUES-BDIIVIDE numeric and

APPEND MODEc     *                        NUM-BLOQUES-BDIIVIDE <> zeros

APPEND MODEc     *                        move NUM-BLOQUES-BDIIVIDE

APPEND MODEc     *                        to BLOQUES-INPUT-VALNOM

APPEND MODEc     *                    else

APPEND MODEc     *                        if TIP-ID-INPUT-VALNOM = 1

APPEND MODEc     *                            move 2 to BLOQUES-INPUT-VALNOM

APPEND MODEc     *                        else

APPEND MODEc     *                            move 1 to BLOQUES-INPUT-VALNOM

APPEND MODEc     *                        end-if

APPEND MODEc     *                    end-if

APPEND MODEc     *                    perform 10000-MATCH-NOMBRES-VALNOM

APPEND MODEc     *                    if MATCH-OK-OUT-VALNOM = 0

APPEND MODEc     *                        move 1 to SW-NOMBRES-BDIIVIDE

APPEND MODEc     *                    end-if

APPEND MODEc     *                end-if

APPEND MODEc     *            end-if

APPEND MODEc     *        else if SW-TID-BDIIVIDE = 1

APPEND MODEc     *            move 1 to SW-ID-BDIIVIDE

APPEND MODEc     *        end-if

APPEND MODEc     *        end-if

APPEND MODEc     *    else

APPEND MODEc     *        move 1 to SW-ID-BDIIVIDE

APPEND MODEc     *    end-if.

APPEND MODEc

APPEND MODEc

APPEND MODEc

APPEND MODEc     *80200-VALIDAR-ID.

APPEND MODEc     *===================================*

APPEND MODEc     * Validacion del numero de identificacion

APPEND MODEc     * con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:

APPEND MODEc     * BDIAREGI, BDIADAS, BDIADIAN respectivamente

APPEND MODEc     * dependiendo del tipo de identificacion

APPEND MODEc     *===================================*

APPEND MODEc     *    evaluate TIP-IDE-BDIIVIDE

APPEND MODEc     *    when 1

APPEND MODEc     *        perform 85010-UBICA-CEDULA

APPEND MODEc     *    when 2

APPEND MODEc     *        perform 85020-UBICA-NIT

APPEND MODEc     *    when 3

APPEND MODEc     *        perform 85020-UBICA-NIT

APPEND MODEc     *    when 4

APPEND MODEc     *        perform 85030-UBICA-EXT

APPEND MODEc     *    when other

APPEND MODEc     *        move 1 to SW-ID-BDIIVIDE

APPEND MODEc     *    end-evaluate.

APPEND MODEc

APPEND MODEc

APPEND MODEc

APPEND MODEc     *80300-ASIGNAR-TIPO-ID.

APPEND MODEc     *================================================================

APPEND MODEc     *ASIGNACION del TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA

APPEND MODEc     *SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE

APPEND MODEc     *================================================================

APPEND MODEc     *    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE

APPEND MODEc     *    inspect NUM-IDE-BDIIVIDE replacing all " " by "0"

APPEND MODEc     *    if NUM-IDE-BDIIVIDE-R >= 1 and <= 99 999999

APPEND MODEc     *    or NUM-IDE-BDIIVIDE-R >= 1000 000000 and < 8000 000000

APPEND MODEc     *        move 1 to TIP-IDE-BDIIVIDE

APPEND MODEc     *    else

APPEND MODEc     *        if NUM-IDE-BDIIVIDE-R >= 800 000000 and <= 999 999999

APPEND MODEc     *        or NUM-IDE-BDIIVIDE-R >= 8000 000000 and <= 9999 999999

APPEND MODEc     *            move 2 to TIP-IDE-BDIIVIDE

APPEND MODEc     *            if NUM-IDE-BDIIVIDE-R >= 8000 000000

APPEND MODEc     *                move NUM-IDE-BDIIVIDE-R to NUM-ID-W11-BDIIVIDE

APPEND MODEc     *                move NUM-ID-W10-BDIIVIDE to NUM-IDE-BDIIVIDE-R

APPEND MODEc     *            end-if

APPEND MODEc     *        else

APPEND MODEc     *            if NUM-IDE-BDIIVIDE-R >= 600 000000 and < 800 000000

APPEND MODEc     *            or NUM-IDE-BDIIVIDE-R >= 6000 000000 and < 8000 000000

APPEND MODEc     *                move 3 to TIP-IDE-BDIIVIDE

APPEND MODEc     *            else

APPEND MODEc     *                move 4 to TIP-IDE-BDIIVIDE

APPEND MODEc     *            end-if.

APPEND MODEc     *********end-if.

APPEND MODEc     *****end-if.

APPEND MODE

APPEND MODEc

APPEND MODEc

APPEND MODEc     *80400-VALIDAR-TIPO-ID.

APPEND MODEc     *================================================================

APPEND MODEc     *80400-VALIDAR-TIPO-ID.

APPEND MODEc     *VALIDACION del TIPO DE IDENTIFICACION DE ACUERDO AL RANGO

APPEND MODEc     *CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.

APPEND MODEc     *PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;

APPEND MODEc     *RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.

APPEND MODEc     *================================================================

APPEND MODEc     *    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE

APPEND MODEc     *    inspect NUM-IDE-BDIIVIDE replacing all " " by "0"

APPEND MODEc     *    evaluate TIP-IDE-BDIIVIDE

APPEND MODEc     *        when 1

APPEND MODEc     *            if NUM-IDE-BDIIVIDE-R > 9999999999

APPEND MODEc     *                move 1 to SW-TID-BDIIVIDE

APPEND MODEc     *            end-if

APPEND MODEc     *        when 2

APPEND MODEc     *            if NUM-IDE-BDIIVIDE-R >  9999999999 or

APPEND MODEc     *            (NUM-IDE-BDIIVIDE-R <= 800000000 and >= 600000000)

APPEND MODEc     *                move 1 to SW-TID-BDIIVIDE

APPEND MODEc     *            end-if

APPEND MODEc     *        when 3

APPEND MODEc     *            if NUM-IDE-BDIIVIDE-R > 800000000 or < 600000000

APPEND MODEc     *                move 1 to SW-TID-BDIIVIDE

APPEND MODEc     *            end-if

APPEND MODEc     *            end-evaluate.

APPEND MODEc

APPEND MODEc

APPEND MODEc

APPEND MODEc     *80500-ELIMINAR-DIGITO-CHEQUEO.

APPEND MODEc     *================================================================

APPEND MODEc     *80500-ELIMINAR-DIGITO-CHEQUEO.

APPEND MODEc     *Elimina el digito de chequeo y cambia el tipo de identificacion

APPEND MODEc     *de acuerdo a los rangos para tipo id = 2 y 3

APPEND MODEc     *================================================================

APPEND MODEc     *    if (NUM-IDE-BDIIVIDE-R >= 600000000 and

APPEND MODEc     *        NUM-IDE-BDIIVIDE-R  <  800000000)
 or

APPEND MODEc     *        (NUM-IDE-BDIIVIDE-R >= 6000000000 and

APPEND MODEc     *        NUM-IDE-BDIIVIDE-R  < 8000000000)


APPEND MODEc     *        move 3 to TIP-IDE-BDIIVIDE

APPEND MODEc     *    end-if

APPEND MODEc     *    if (NUM-IDE-BDIIVIDE-R >= 800000000 and

APPEND MODEc     *        NUM-IDE-BDIIVIDE-R  <= 999999999)
 or

APPEND MODEc     *        (NUM-IDE-BDIIVIDE-R >= 8000000000 and

APPEND MODEc     *        NUM-IDE-BDIIVIDE-R  <= 9999999999)


APPEND MODEc     *        move 2 to TIP-IDE-BDIIVIDE

APPEND MODEc     *    end-if

APPEND MODEc     *    if (TIP-IDE-BDIIVIDE = 2 and

APPEND MODEc     *        (NUM-IDE-BDIIVIDE-R >= 10000000000) or

APPEND MODEc     *        (NUM-IDE-BDIIVIDE-R >= 8000000000 and

APPEND MODEc     *        NUM-IDE-BDIIVIDE-R <= 9999999999)
) or

APPEND MODEc     *        (TIP-IDE-BDIIVIDE = 3 and

APPEND MODEc     *        (NUM-IDE-BDIIVIDE-R >= 6000000000 and

APPEND MODEc     *        NUM-IDE-BDIIVIDE-R <  8000000000)
)

APPEND MODEc     *        move NUM-IDE-BDIIVIDE to NUM-ID-W11-BDIIVIDE

APPEND MODEc     *        move NUM-ID-W10-BDIIVIDE to NUM-IDE-BDIIVIDE-R

APPEND MODEc     *    end-if

APPEND MODEc     *    inspect NUM-IDE-BDIIVIDE replacing all " " by "0".

APPEND MODEc

APPEND MODEc

APPEND MODEc     *85010-UBICA-CEDULA.

APPEND MODEc     *================================================================

APPEND MODEc     * Ubica la identificacion dada la llave en BDIIREGI

APPEND MODEc     * Arma el nombre completo en una sola variable

APPEND MODEc     *================================================================

APPEND MODEc     *    move NUM-IDE-BDIIVIDE to CEDULA-BDIIREGI

APPEND MODEc     *    move TIP-IDE-BDIIVIDE to TIPO-ID-BDIIREGI

APPEND MODEc     *    read BDIIREGI invalid key

APPEND MODEc     *        move 1 to SW-ID-BDIIVIDE

APPEND MODEc     *    end-read

APPEND MODEc     *    if SW-ID-BDIIVIDE = 0 *> la cedula existe

APPEND MODEc     *        move APELLIDO1-BDIIREGI to PRIMER-APELLIDO-BDIIVIDE

APPEND MODEc     *        move APELLIDO2-BDIIREGI to SEGUNDO-APELLIDO-BDIIVIDE

APPEND MODEc     *        move DES-NOMBRE2-BDIIREGI to SEGUNDO-NOMBRE-BDIIVIDE

APPEND MODEc     *        move DES-NOMBRE1-BDIIREGI to PRIMER-NOMBRE-BDIIVIDE

APPEND MODEc     *        if ESTADO-CIVIL-BDIIREGI = 0

APPEND MODEc     *            string

APPEND MODEc     *            SEGUNDO-APELLIDO-BDIIVIDE delimited by "  ",

APPEND MODEc     *            "*" delimited by size ,

APPEND MODEc     *            PRIMER-NOMBRE-BDIIVIDE delimited by "  ",

APPEND MODEc     *            "*" delimited by size ,

APPEND MODEc     *            SEGUNDO-NOMBRE-BDIIVIDE delimited by size,

APPEND MODEc     *            ";" delimited by size ,

APPEND MODEc     *            into NOM-LEIDO-BDIIVIDE

APPEND MODEc     *        end-if

APPEND MODEc     *        if ESTADO-CIVIL-BDIIREGI = 1

APPEND MODEc     *            string

APPEND MODEc     *            "DE" delimited by size,

APPEND MODEc     *            "*" delimited by size,

APPEND MODEc     *            SEGUNDO-APELLIDO-BDIIVIDE delimited by "  ",

APPEND MODEc     *            "*" delimited by size,

APPEND MODEc     *            PRIMER-NOMBRE-BDIIVIDE delimited by "  ",

APPEND MODEc     *            "*" delimited by size,

APPEND MODEc     *            SEGUNDO-NOMBRE-BDIIVIDE delimited by size,

APPEND MODEc     *            ";" delimited by size,

APPEND MODEc     *            into NOM-LEIDO-BDIIVIDE

APPEND MODEc     *        end-if

APPEND MODEc     *        if ESTADO-CIVIL-BDIIREGI = 2

APPEND MODEc     *            string

APPEND MODEc     *            "VDA DE" delimited by size,

APPEND MODEc     *            "*" delimited by size,

APPEND MODEc     *            SEGUNDO-APELLIDO-BDIIVIDE delimited by "  ",

APPEND MODEc     *            "*" delimited by size,

APPEND MODEc     *            PRIMER-NOMBRE-BDIIVIDE delimited by "  ",

APPEND MODEc     *            "*" delimited by size,

APPEND MODEc     *            SEGUNDO-NOMBRE-BDIIVIDE delimited by size,

APPEND MODEc     *            ";" delimited by size,

APPEND MODEc     *            into NOM-LEIDO-BDIIVIDE

APPEND MODEc     *        end-if

APPEND MODEc     *        string PRIMER-APELLIDO-BDIIVIDE delimited by "  ",

APPEND MODEc     *        "*" delimited by size,

APPEND MODEc     *        NOM-LEIDO-BDIIVIDE delimited size, "*" delimited size,

APPEND MODEc     *        into NOM-VAL-BDIIVIDE

APPEND MODEc     *        inspect NOM-VAL-BDIIVIDE replacing all "*" by " "

APPEND MODEc     *        inspect NOM-VAL-BDIIVIDE replacing all ";" by " "

APPEND MODEc     *        initialize NOM-LEIDO-BDIIVIDE

APPEND MODEc     *        move NOM-VAL-BDIIVIDE to NOM-LEIDO-BDIIVIDE

APPEND MODEc     *    end-if.  *> was missing

APPEND MODEc

APPEND MODEc     *85020-UBICA-NIT.

APPEND MODEc     *================================================================

APPEND MODEc     *85020-UBICA-NIT.

APPEND MODEc     *Ubica NIT en archivo de la DIAN, BDIIDIAN

APPEND MODEc     *================================================================

APPEND MODEc     *    move NUM-IDE-BDIIVIDE to NITS-R-BDIIDIAN

APPEND MODEc     *    read BDIIDIAN invalid key

APPEND MODEc     *        move 1 to SW-ID-BDIIVIDE

APPEND MODEc     *    end-read

APPEND MODEc     *    if SW-ID-BDIIVIDE = 0

APPEND MODEc     *        move DESCRIPCION-BDIIDIAN to NOM-LEIDO-BDIIVIDE

APPEND MODEc     *    end-if.

APPEND MODEc

APPEND MODEc

APPEND MODEc     *85030-UBICA-EXT.

APPEND MODEc     *================================================================

APPEND MODEc     *85030-UBICA-EXT.

APPEND MODEc     *Ubica cedula de extranjeria en archivo del DAS

APPEND MODEc     *================================================================

APPEND MODEc     *    move NUM-IDE-BDIIVIDE to NUM-ID-BDIIDAS

APPEND MODEc     *    move TIP-IDE-BDIIVIDE to TIPO-ID-BDIIDAS

APPEND MODEc     *    read BDIIDAS invalid key

APPEND MODEc     *        move 1 to SW-ID-BDIIVIDE

APPEND MODEc     *    end-read

APPEND MODEc     *    if SW-ID-BDIIVIDE = 0

APPEND MODEc     *        move NOMBRE-BDIIDAS to NOM-LEIDO-BDIIVIDE

APPEND MODEc     *    end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE                   copy VALNOM.PROC.

APPEND MODEc     *VALNOM-PROC.v.0005

APPEND MODEc     ******************************************************************

APPEND MODEc     * RUTINA CREADA PARA HACER LA VALIDACION DE NOMBRES CONTRA LOS

APPEND MODEc     * ARCHIVOS DE LA REGISTRADURIA, DIAN Y DAS, DEPENDIENDO del TIPO

APPEND MODEc     * DE IDENTIFICACION RECIBIDA.

APPEND MODEc     *    PARAMETROS

APPEND MODEc     *        BLOQUES-INPUT-VALNOM - NUMERO DE BLOQUES A VALIDAR

APPEND MODEc     *        NOMBRE-INPUT-VALNOM  - NOMBRE A VALIDAR

APPEND MODEc     *        NOMBOK-INPUT-VALNOM  - NOMBRE CORRECTO CON EL QUE SE

APPEND MODEc     *                               DEBE COMPARAR NOMBRE-INPUT-VALNOM

APPEND MODEc     *        TIP-ID-INPUT-VALNOM  - TIPO DE IDENTIFICACION A VALIDAR

APPEND MODEc     *    SALIDAS:

APPEND MODEc     *        MATCH-OK-OUT-VALNOM  - 0-NO HUBO       1-HUBO

APPEND MODEc     ******************************************************************

APPEND MODEc

APPEND MODEc

APPEND MODEc     *10000-MATCH-NOMBRES-VALNOM.

APPEND MODEc     ******************************************************************

APPEND MODEc     *10000-MATCH-NOMBRE-VALNOM.

APPEND MODEc     * SE BUSCA DETERMINAR SI EL NOMBRE DE LA PERSONA CONSULTADA HACE

APPEND MODEc     * CON EL NOMBRE ENVIADO EN LA CONSULTA.

APPEND MODEc     ******************************************************************

APPEND MODEc     *    move 0 to MATCH-OK-OUT-VALNOM.

APPEND MODEc     *    move NOMBRE-INPUT-VALNOM to NOMBRE-AUX-VALNOM.

APPEND MODEc     *    if TIP-ID-INPUT-VALNOM  = 2

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        " S.A. " by "      ",

APPEND MODEc     *        "." by " ", " LTDA " by "      ",

APPEND MODEc     *        " LIMITADA " by "          ",

APPEND MODEc     *        " CIA " by "     ", " COMPA/IA " by "          ",

APPEND MODEc     *        " INVERSIONES " by "             ",

APPEND MODEc     *        " EMPRESA " by "         ",

APPEND MODEc     *        " CORPORACION " by "             ",

APPEND MODEc     *        " DE " by "    ", " LA " by "    ", " DEL " by "     ",

APPEND MODEc     *        " S " by "   ", " A " by "   "

APPEND MODEc     *        " Y " by "   "

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        " S.A. " by "      ",

APPEND MODEc     *        "." by " ", " LTDA " by "      ",

APPEND MODEc     *        " LIMITADA " by "          ",

APPEND MODEc     *        " CIA " by "     ", " COMPA/IA " by "          ",

APPEND MODEc     *        " INVERSIONES " by "             ",

APPEND MODEc     *        " EMPRESA " by "         ",

APPEND MODEc     *        " CORPORACION " by "             ",

APPEND MODEc     *        " DE " by "    ", " LA " by "    ", " DEL " by "     ",

APPEND MODEc     *        " S " by "   ", " A " by "   "

APPEND MODEc     *        " Y " by "   "

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        "." by " ","-" by " ",

APPEND MODEc     *        "C" by "S","Z" by "S","J" by "G","V" by "B",

APPEND MODEc     *        "Y" by "G","H" by "G","I" by "G"

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        "." by " ","-" by " ",

APPEND MODEc     *        "C" by "S","Z" by "S","J" by "G","V" by "B",

APPEND MODEc     *        "Y" by "G","H" by "G","I" by "G"

APPEND MODEc     *        move NOMBRE-AUX-VALNOM to NOMBRE-INPUT-VALNOM

APPEND MODEc     *    else

APPEND MODEc     *        inspect CADENA-VALNOM    replacing all

APPEND MODEc     *        "." by " ","-" by " ", "," by " ",

APPEND MODEc     *        "C" by "S","Z" by "S","J" by "G","V" by "B",

APPEND MODEc     *        "Y" by "G","H" by "G","I" by "G",

APPEND MODEc     *        " DE " by "    "," LA " by "    ",

APPEND MODEc     *        " del " by "     "

APPEND MODEc     *        inspect CADENA-VALNOM    replacing all

APPEND MODEc     *        "." by " ","-" by " ", "," by " ",

APPEND MODEc     *        "C" by "S","Z" by "S","J" by "G","V" by "B",

APPEND MODEc     *        "Y" by "G","H" by "G","I" by "G",

APPEND MODEc     *        " DE " by "    "," LA " by "    ",

APPEND MODEc     *        " del " by "     "

APPEND MODEc     *        perform varying I-VALNOM from 1 by 1

APPEND MODEc     *            until I-VALNOM >= 66

APPEND MODEc     *            if VNOM-AUX-VALNOM(I-VALNOM) not alphabetic

APPEND MODEc     *            and VNOM-AUX-VALNOM(I-VALNOM) not numeric

APPEND MODEc     *                move "*" to VNOM-AUX-VALNOM(I-VALNOM)

APPEND MODEc     *            end-if

APPEND MODEc     *            end-perform

APPEND MODEc     *    end-if.

APPEND MODEc     *    move spaces to VECTOR-INPUT-VALNOM.

APPEND MODEc     *    unstring CADENA-VALNOM delimited by all " " into

APPEND MODEc     *    BASURA-VALNOM

APPEND MODEc     *    VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)

APPEND MODEc     *    VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5) VM-INPUT-VALNOM(6)

APPEND MODEc     *    VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8) VM-INPUT-VALNOM(9)

APPEND MODEc     *    VM-INPUT-VALNOM(10) VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12)

APPEND MODEc     *    VM-INPUT-VALNOM(13) VM-INPUT-VALNOM(14) VM-INPUT-VALNOM(15)

APPEND MODEc     *    VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)

APPEND MODEc     *    VM-INPUT-VALNOM(19) VM-INPUT-VALNOM(20)

APPEND MODEc     ******************PREPARA EL NOMBRE CORRECTO del ARCHIVO *********

APPEND MODEc     *    move NOMBOK-INPUT-VALNOM to NOMBRE-AUX-VALNOM.

APPEND MODEc     *    if TIP-ID-INPUT-VALNOM  not = 2

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        "." by " ","-" by " ","," by " ",

APPEND MODEc     *        "C" by "S","Z" by "S","J" by "G","V" by "B",

APPEND MODEc     *        "Y" by "G","H" by "G","I" by "G"

APPEND MODEc     *        perform varying I-VALNOM from 1 by 1

APPEND MODEc     *            until I-VALNOM >= 66

APPEND MODEc     *            if VNOM-AUX-VALNOM(I-VALNOM) not alphabetic

APPEND MODEc     *                and VNOM-AUX-VALNOM(I-VALNOM) not numeric

APPEND MODEc     *                move "*" to VNOM-AUX-VALNOM(I-VALNOM)

APPEND MODEc     *            end-if

APPEND MODEc     *            end-perform

APPEND MODEc     *    else

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        " S.A. " by "      ",

APPEND MODEc     *        "." by " ", " LTDA " by "      ",

APPEND MODEc     *        " LIMITADA " by "          ",

APPEND MODEc     *        " CIA " by "     ", " COMPA/IA " by "          ",

APPEND MODEc     *        " INVERSIONES " by "             ",

APPEND MODEc     *        " EMPRESA " by "         ",

APPEND MODEc     *        " CORPORACION " by "             ",

APPEND MODEc     *        " DE " by "    ", " LA " by "    ", " del " by "     ",

APPEND MODEc     *        " S " by "   ", " A " by "   "

APPEND MODEc     *        " Y " by "   "

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        " S.A. " by "      ",

APPEND MODEc     *        "." by " ", " LTDA " by "      ",

APPEND MODEc     *        " LIMITADA " by "          ",

APPEND MODEc     *        " CIA " by "     ", " COMPA/IA " by "          ",

APPEND MODEc     *        " INVERSIONES " by "             ",

APPEND MODEc     *        " EMPRESA " by "         ",

APPEND MODEc     *        " CORPORACION " by "             ",

APPEND MODEc     *        " DE " by "    ", " LA " by "    ", " del " by "     ",

APPEND MODEc     *        " S " by "   ", " A " by "   "

APPEND MODEc     *        " Y " by "   "

APPEND MODEc     *        inspect NOMBRE-AUX-VALNOM replacing all

APPEND MODEc     *        "." by " ","-" by " ",

APPEND MODEc     *        "C" by "S","Z" by "S","J" by "G","V" by "B",

APPEND MODEc     *        "Y" by "G","H" by "G","I" by "G"

APPEND MODEc     *        move NOMBRE-AUX-VALNOM to NOMBOK-INPUT-VALNOM

APPEND MODEc     *    end-if.

APPEND MODEc     *    move spaces to VECTOR-OK-VALNOM.

APPEND MODEc     *    unstring CADENA-VALNOM delimited by all " " into

APPEND MODEc     *    BASURA-VALNOM

APPEND MODEc     *    VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)

APPEND MODEc     *    VM-OK-VALNOM(4) VM-OK-VALNOM(5) VM-OK-VALNOM(6)

APPEND MODEc     *    VM-OK-VALNOM(7) VM-OK-VALNOM(8) VM-OK-VALNOM(9)

APPEND MODEc     *    VM-OK-VALNOM(10) VM-OK-VALNOM(11) VM-OK-VALNOM(12)

APPEND MODEc     *    VM-OK-VALNOM(13) VM-OK-VALNOM(14) VM-OK-VALNOM(15)

APPEND MODEc     *    VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)

APPEND MODEc     *    VM-OK-VALNOM(19) VM-OK-VALNOM(20).

APPEND MODEc     ***********HACE LA VALIDACION BLOQUE A BLOQUE********************

APPEND MODEc     *    move 1 to I-VALNOM.

APPEND MODEc     *    move 0 to BLOQOK-AUX-VALNOM.

APPEND MODEc     *    perform until VM-INPUT-VALNOM(I-VALNOM) = spaces

APPEND MODEc     *        move 1 to J-VALNOM

APPEND MODEc     *        perform until J-VALNOM > 20

APPEND MODEc     *            if VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)

APPEND MODEc     *                add 1 to BLOQOK-AUX-VALNOM

APPEND MODEc     *                move spaces to VM-OK-VALNOM(J-VALNOM)

APPEND MODEc     *                VM-INPUT-VALNOM(I-VALNOM)

APPEND MODEc     *                move 21 to J-VALNOM

APPEND MODEc     *            else

APPEND MODEc     *                move 0 to M-VALNOM

APPEND MODEc     *                inspect VM-OK-VALNOM(J-VALNOM) tallying M-VALNOM

APPEND MODEc     *                for CHARACTERS BEFORE initial "*"

APPEND MODEc     *                if M-VALNOM >= 15

APPEND MODEc     *                    move 0 to M-VALNOM

APPEND MODEc     *                    inspect VM-OK-VALNOM(J-VALNOM) tallying

APPEND MODEc     *                    M-VALNOM for CHARACTERS BEFORE initial "N"

APPEND MODEc     *                end-if

APPEND MODEc     *                if M-VALNOM > 0 and < 15 and I-VALNOM < 20

APPEND MODEc     *                    and (14 - M-VALNOM > 0)

APPEND MODEc     *                    compute INI-VALNOM = M-VALNOM + 2

APPEND MODEc     *                    compute LON-VALNOM = 14 - M-VALNOM

APPEND MODEc     *                    move VM-OK-VALNOM(J-VALNOM) to PEDAZO-VALNOM

APPEND MODEc     *                    if PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =

APPEND MODEc     *                        VM-INPUT-VALNOM(I-VALNOM + 1 ) and

APPEND MODEc     *                        PEDAZO-VALNOM(1:M-VALNOM) =

APPEND MODEc     *                        VM-INPUT-VALNOM(I-VALNOM)

APPEND MODEc     *                        add 1 to BLOQOK-AUX-VALNOM

APPEND MODEc     *                        move spaces to VM-OK-VALNOM(J-VALNOM)

APPEND MODEc     *                        VM-INPUT-VALNOM(I-VALNOM)

APPEND MODEc     *                        move 21 to J-VALNOM

APPEND MODEc     *                        add 1 to I-VALNOM

APPEND MODEc     *                        move spaces to VM-INPUT-VALNOM(I-VALNOM)

APPEND MODEc     *                    end-if

APPEND MODEc     *                end-if

APPEND MODEc     *            end-if

APPEND MODEc     *            add 1 to J-VALNOM

APPEND MODEc     *            end-perform

APPEND MODEc     *            add 1 to I-VALNOM

APPEND MODEc     *            if I-VALNOM = 21

APPEND MODEc     *                next sentence

APPEND MODEc     *            end-if

APPEND MODEc     *            end-perform.

APPEND MODEc     *    if BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM

APPEND MODEc     *        move 1 to MATCH-OK-OUT-VALNOM

APPEND MODEc     *    else

APPEND MODEc     *        if TIP-ID-INPUT-VALNOM <> 2

APPEND MODEc     *            perform 10100-MATCH-APROXIMADO

APPEND MODEc     *        else

APPEND MODEc     *            perform 10100-MATCH-APROX-EMPRESAS

APPEND MODEc     *        end-if

APPEND MODEc     *        if BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM

APPEND MODEc     *            move 1 to MATCH-OK-OUT-VALNOM

APPEND MODEc     *        end-if

APPEND MODEc     *    end-if.

APPEND MODEc     *

APPEND MODEc     *

APPEND MODEc     ******************************************************************

APPEND MODEc     *10100-MATCH-APROXIMADO.

APPEND MODEc     * EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS

APPEND MODEc     * CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON

APPEND MODEc     * LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.

APPEND MODEc     ******************************************************************

APPEND MODEc     *10100-MATCH-APROXIMADO.

APPEND MODEc     *    if BLOQOK-AUX-VALNOM > 0

APPEND MODEc     *        move 65 to APROX-TOT-VALNOM APROX-INP-VALNOM

APPEND MODEc     *    else

APPEND MODEc     *        move 70 to APROX-TOT-VALNOM APROX-INP-VALNOM

APPEND MODEc     *    end-if

APPEND MODEc     *    move 1 to I-VALNOM.

APPEND MODEc     *    perform until I-VALNOM > 10

APPEND MODEc     *        move 1 to J-VALNOM

APPEND MODEc     *        perform until J-VALNOM > 10

APPEND MODEc     *            move 0 to LETRAS-OK-VALNOM LETRAS-OK2-VALNOM

APPEND MODEc     *            move 1 to K-VALNOM

APPEND MODEc     *            move 1 to L-VALNOM

APPEND MODEc     *            if VM-INPUT-VALNOM(I-VALNOM) not = spaces and

APPEND MODEc     *                VM-OK-VALNOM   (J-VALNOM) not = spaces

APPEND MODEc     *                perform until K-VALNOM > 15 or L-VALNOM > 15

APPEND MODEc     *                    if VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =

APPEND MODEc     *                    VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)

APPEND MODEc     *                    or ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"

APPEND MODEc     *                    and (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =

APPEND MODEc     *                    " " or = "N")
)

APPEND MODEc     *                        if VMM-OK-VALNOM (J-VALNOM,K-VALNOM)

APPEND MODEc     *                        not = spaces

APPEND MODEc     *                            add 1 to LETRAS-OK-VALNOM

APPEND MODEc     *                            add 1 to K-VALNOM

APPEND MODEc     *                            add 1 to L-VALNOM

APPEND MODEc     *                        else

APPEND MODEc     *                            move 19 to K-VALNOM

APPEND MODEc     *                        end-if

APPEND MODEc     *                    else

APPEND MODEc     *                        add 1 to K-VALNOM

APPEND MODEc     *                        if K-VALNOM <= 15 and L-VALNOM < 15

APPEND MODEc     *                            if VMM-INPUT-VALNOM(I-VALNOM,

APPEND MODEc     *                            L-VALNOM + 1)
 =

APPEND MODEc     *                                VMM-OK-VALNOM(J-VALNOM,K-VALNOM )

APPEND MODEc     *                                add 1 to L-VALNOM

APPEND MODEc     *                            end-if

APPEND MODEc     *                        end-if

APPEND MODEc     *                    end-if

APPEND MODEc     *                    end-perform

APPEND MODEc     *                    move 1 to K-VALNOM

APPEND MODEc     *                    move 1 to L-VALNOM

APPEND MODEc     *                    perform until K-VALNOM > 15 or L-VALNOM > 15

APPEND MODEc     *                        if VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =

APPEND MODEc     *                        VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)

APPEND MODEc     *                        or ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM))

APPEND MODEc     *                        = "*"

APPEND MODEc     *                        and (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM)

APPEND MODEc     *                        = " "   GJC0003 or = "N")
)

APPEND MODEc     *                            if VMM-OK-VALNOM (J-VALNOM,K-VALNOM)

APPEND MODEc     *                            not = spaces

APPEND MODEc     *                                add 1 to LETRAS-OK2-VALNOM

APPEND MODEc     *                                add 1 to K-VALNOM

APPEND MODEc     *                                add 1 to L-VALNOM

APPEND MODEc     *                            else

APPEND MODEc     *                                move 19 to K-VALNOM

APPEND MODEc     *                            end-if

APPEND MODEc     *                        else

APPEND MODEc     *                            add 1 to L-VALNOM

APPEND MODEc     *                            if L-VALNOM <= 15 and K-VALNOM < 15

APPEND MODEc     *                                if VMM-INPUT-VALNOM(I-VALNOM,

APPEND MODEc     *                                L-VALNOM)
 = VMM-OK-VALNOM

APPEND MODEc     *                                (J-VALNOM,K-VALNOM + 1)

APPEND MODEc     *                                    add 1 to K-VALNOM

APPEND MODEc     *                                end-if

APPEND MODEc     *                            end-if

APPEND MODEc     *                        end-if

APPEND MODEc     *                        end-perform

APPEND MODEc     *            end-if

APPEND MODEc     *            if LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM

APPEND MODEc     *                move LETRAS-OK2-VALNOM to LETRAS-OK-VALNOM

APPEND MODEc     *            end-if

APPEND MODEc     *            if LETRAS-OK-VALNOM > 0

APPEND MODEc     *                move 0 to TOTLET-INP-VALNOM TOTLET-OK-VALNOM

APPEND MODEc     *                inspect VM-INPUT-VALNOM(I-VALNOM) tallying

APPEND MODEc     *                TOTLET-INP-VALNOM

APPEND MODEc     *                for CHARACTERS BEFORE initial " "

APPEND MODEc     *                inspect VM-OK-VALNOM   (J-VALNOM) tallying

APPEND MODEc     *                TOTLET-OK-VALNOM

APPEND MODEc     *                for CHARACTERS BEFORE initial " "

APPEND MODEc     *                move 0 to POR-TOT-VALNOM  POR-INP-VALNOM

APPEND MODEc     *                if TOTLET-OK-VALNOM >= 3

APPEND MODEc     *                    compute POR-TOT-VALNOM = LETRAS-OK-VALNOM *

APPEND MODEc     *                    100 / TOTLET-OK-VALNOM

APPEND MODEc     *                end-if

APPEND MODEc     *                if TOTLET-INP-VALNOM >= 3

APPEND MODEc     *                    compute POR-INP-VALNOM = LETRAS-OK-VALNOM *

APPEND MODEc     *                    100 / TOTLET-INP-VALNOM

APPEND MODEc     *                end-if

APPEND MODEc     *                if TOTLET-OK-VALNOM > TOTLET-INP-VALNOM

APPEND MODEc     *                    compute A-VALNOM = TOTLET-INP-VALNOM * 100 /

APPEND MODEc     *                    TOTLET-OK-VALNOM

APPEND MODEc     *                else

APPEND MODEc     *                    compute A-VALNOM = TOTLET-OK-VALNOM  * 100 /

APPEND MODEc     *                    TOTLET-INP-VALNOM

APPEND MODEc     *                end-if

APPEND MODEc     *                if ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=

APPEND MODEc     *                    APROX-TOT-VALNOM)
 and

APPEND MODEc     *                    A-VALNOM >= 63

APPEND MODEc     ****   display "%TOT=",POR-TOT-VALNOM, " %INP=", POR-INP-VALNOM,

APPEND MODEc     ****           "A-VALNOM=", A-VALNOM

APPEND MODEc     *****       if (POR-TOT-VALNOM >= APROX-TOT-VALNOM and

APPEND MODEc     *****           POR-INP-VALNOM >= APROX-INP-VALNOM )
 or

APPEND MODEc     *****          ((POR-TOT-VALNOM >= APROX-TOT-VALNOM or

APPEND MODEc     *****            POR-INP-VALNOM >= APROX-INP-VALNOM )
 and

APPEND MODEc     *****            A-VALNOM >= 70)

APPEND MODEc     *                    add 1 to BLOQOK-AUX-VALNOM

APPEND MODEc     *                    move spaces to VM-OK-VALNOM(J-VALNOM)

APPEND MODEc     *                    VM-INPUT-VALNOM(I-VALNOM)

APPEND MODEc     *                end-if

APPEND MODEc     *            end-if

APPEND MODEc     *            add 1 to J-VALNOM

APPEND MODEc     *            end-perform

APPEND MODEc     *            add 1 to I-VALNOM

APPEND MODEc     *            end-perform.

APPEND MODEc     *

APPEND MODEc     *

APPEND MODEc     ******************************************************************

APPEND MODEc     *10100-MATCH-APROX-EMPRESAS

APPEND MODEc     * EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS

APPEND MODEc     * CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON

APPEND MODEc     * LOS TIPOS DE IDENTIFICACION 2.

APPEND MODEc     ******************************************************************

APPEND MODEc     *10100-MATCH-APROX-EMPRESAS.

APPEND MODEc     *    move zeros to TOTLET-INP-VALNOM

APPEND MODEc     *    move zeros to LETRAS-OK2-VALNOM

APPEND MODEc     *    move zeros to A-VALNOM

APPEND MODEc     *    move 1 to K-VALNOM

APPEND MODEc     *    perform until K-VALNOM > 65

APPEND MODEc     *        move K-VALNOM to I-VALNOM

APPEND MODEc     *        move 1 to J-VALNOM

APPEND MODEc     *        move zeros to LETRAS-OK-VALNOM

APPEND MODEc     *        perform until J-VALNOM > 65 or I-VALNOM > 65

APPEND MODEc     *            if V-NOMBRE-VALNOM(I-VALNOM) <> spaces and

APPEND MODEc     *                V-NOMBRE-VALNOM(I-VALNOM) <> "."

APPEND MODEc     *                if V-NOMBRE-VALNOM(I-VALNOM) =

APPEND MODEc     *                    V-NOMBOK-VALNOM(J-VALNOM)

APPEND MODEc     *                    add 1 to LETRAS-OK-VALNOM

APPEND MODEc     *                    add 1 to I-VALNOM

APPEND MODEc     *                    add 1 to J-VALNOM

APPEND MODEc     *                else

APPEND MODEc     *                    add 1 to J-VALNOM

APPEND MODEc     *                end-if

APPEND MODEc     *            else

APPEND MODEc     *                add 1 to I-VALNOM

APPEND MODEc     *            end-if

APPEND MODEc     *            end-perform

APPEND MODEc     *            if LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM

APPEND MODEc     *                move LETRAS-OK-VALNOM to LETRAS-OK2-VALNOM

APPEND MODEc     *            end-if

APPEND MODEc     *            add 1 to K-VALNOM

APPEND MODEc     *            end-perform.

APPEND MODEc     *    move 1 to I-VALNOM

APPEND MODEc     *    perform until I-VALNOM > 65

APPEND MODEc     *        if V-NOMBRE-VALNOM(I-VALNOM) <> spaces and

APPEND MODEc     *            V-NOMBRE-VALNOM(I-VALNOM) <> "."

APPEND MODEc     *            add 1 to TOTLET-INP-VALNOM

APPEND MODEc     *        end-if

APPEND MODEc     *        add 1 to I-VALNOM

APPEND MODEc     *        end-perform.

APPEND MODEc     *    compute A-VALNOM = LETRAS-OK2-VALNOM * 100 /

APPEND MODEc     *    TOTLET-INP-VALNOM.

APPEND MODEc     *    if A-VALNOM >= 75

APPEND MODEc     *        add 1 to BLOQOK-AUX-VALNOM

APPEND MODEc     *    end-if.

APPEND MODEc     *    move 0 to K-VALNOM

APPEND MODEc     *    if BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM

APPEND MODEc     *        INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM

APPEND MODEc     *        perform varying J-VALNOM from 1 by 1 until J-VALNOM > 65

APPEND MODEc     *            if V-NOMBRE-VALNOM(J-VALNOM) <> " "

APPEND MODEc     *                move function ORD(V-NOMBRE-VALNOM(J-VALNOM))

APPEND MODEc     *                to I-VALNOM

APPEND MODEc     *                add 1 to CONT-LET-INPUT-VALNOM(I-VALNOM)

APPEND MODEc     *    end-if

APPEND MODEc     *    if V-NOMBOK-VALNOM(J-VALNOM) <> " "

APPEND MODEc     *        move function ORD(V-NOMBOK-VALNOM(J-VALNOM))

APPEND MODEc     *        to I-VALNOM

APPEND MODEc     *        add 1 to CONT-LET-OK-VALNOM(I-VALNOM)

APPEND MODEc     *        end-if

APPEND MODEc     *        end-perform

APPEND MODEc     *        move 0 to I-VALNOM

APPEND MODEc     *        perform varying J-VALNOM from 1 by 1 until J-VALNOM > 256

APPEND MODEc     *            if CONT-LET-OK-VALNOM(J-VALNOM)  > 0

APPEND MODEc     *                add 1 to I-VALNOM

APPEND MODEc     *                if CONT-LET-OK-VALNOM(J-VALNOM) <

APPEND MODEc     *                    CONT-LET-INPUT-VALNOM(J-VALNOM)

APPEND MODEc     *                    compute L-VALNOM = L-VALNOM + 100

APPEND MODEc     *                else

APPEND MODEc     *                    compute L-VALNOM = L-VALNOM +

APPEND MODEc     *                    (CONT-LET-INPUT-VALNOM(J-VALNOM)

APPEND MODEc     *  100 /CONT-LET-OK-VALNOM(J-VALNOM))
  GJC0003

APPEND MODEc     *                end-if

APPEND MODEc     *            end-if

APPEND MODEc     *            end-perform

APPEND MODEc     *            compute K-VALNOM = L-VALNOM/I-VALNOM

APPEND MODEc     *            if (A-VALNOM >= 40 and K-VALNOM > 80) or

APPEND MODEc     *            ((A-VALNOM >= 35 and A-VALNOM < 40)

APPEND MODEc     *            and K-VALNOM > 85)
 ORGJC0003

APPEND MODEc     *            ((A-VALNOM >= 25 and A-VALNOM < 35)

APPEND MODEc     *            and K-VALNOM = 100)
  GJC0003

APPEND MODEc     *                add 1 to BLOQOK-AUX-VALNOM

APPEND MODEc     *            end-if

APPEND MODEc     *        end-if.

APPEND MODE

APPEND MODE
$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI"CARGAJUR.CBL" [Modified] line 1 of 2362 --0%-- :w"CARGAJUR.CBL" 2362 lines, 108648 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print
/d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo/objetos/CARGAJUR.idy
find: cannot read dir /d/iccol/desarrollo/fuentes/especiales/darlas: Permission denied
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err
/d/iccol/desarrollo/fuentes/CARGAJUR.lst
/d/iccol/desarrollo/fuentes/CARGAJUR.idy
find: cannot read dir /d/iccol/desarrollo/stt: Permission denied
find: cannot read dir /d/iccol/desarrollo/sf/.sunw: Permission denied
find: cannot read dir /d/iccol/desarrollo/.ssh: Permission denied
/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/objetos/CARGAJUR*
-rw-rw-r--   1 icdgd    icdatacr   47872 May 15 14:02 /d/iccol/desarrollo/objetos/CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr  275072 May 15 14:02 /d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/fuentes/CARGAJUR*
-rw-rw-r--   1 icdgd    icdatacr  108648 May 15 16:20 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   79102 May 15 14:02 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err
-rw-rw-r--   1 icdgd    icdatacr   47872 May 15 13:53 /d/iccol/desarrollo/fuentes/CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr  275080 May 15 13:53 /d/iccol/desarrollo/fuentes/CARGAJUR.lst
/d/iccol/desarrollo $vi /d/iccol/desarrollo/objetos/CARGAJUR.lst
"/d/iccol/desarrollo/objetos/CARGAJUR.lst" 4936 lines, 275072 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 14:02 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR COMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2 NOWB3
*WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"/d/iccol/desarrollo/objetos/CARGAJUR.lst" 4936 lines, 275072 characters^     2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.4******************************************************************5* Actualizacin del archivo de alertas con los datos provistos6* por Jurad7* Procesa el archivo JURAD. Controla cada registro: si es OK usa8* los datos para actualizar BDIIALE, si tiene defecto lo graba en9* el archivo ERRS.
    10******************************************************************
    11 AUTHOR.Globant JL.
    12 DATE-WRITTEN.
    13 DATE-COMPILED. 15-May-14 14:02.
    14 CONFIGURATION section.
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 14:02 Page   2
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
    15 SOURCE-COMPUTER. microfocus.
    16 OBJECT-COMPUTER. microfocus.
    17 INPUT-OUTPUT section.
    18 FILE-CONTROL.
    19
20******************************************************************
    21******************************************************************
    22 select JURAD assign to P-file-name
    23     organization is line sequential
    24     file status is JURAD-fs.
    25
26******************************************************************
    27******************************************************************
    28 select ERRS assign to ERRS-file-name
    29     organization is line sequential
    30     file status is ERRS-fs.
    31
32******************************************************************
    33******************************************************************
*   34     copy BDIIREGI.FS.
    35* BDIIREGI.v.03.0001
    36*===============================================================
    37* ESTRUCTURA DEL ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
    38*===============================================================
    39 $SET IDXFORMAT"8"
    40
41$SET CONSTANT SW-STATUS-BDIIREGI"NO"
    42     SELECT BDIIREGI
    43ASSIGN TO DISK TITLE-BDIIREGI
    44ORGANIZATION IS INDEXED
    45ACCESS MODE IS DYNAMIC
    46RECORD KEY IS LLAVE-BDIIREGI
    47$IF SW-STATUS-BDIIREGI = "NO"
    48$DISPLAY ".............COMPILANDO BDIIREGI SIN STATUS.........."    47$IF SW-STATUS-BDIIREGI = "NO"48$DISPLAY ".............COMPILANDO BDIIREGI SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO BDIIREGI CON STATUS.........."
    51XFILE STATUS IS COD-RETORNO-BDIIREGI
    52$END
    53LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    54
55$SET IDXFORMAT"0"
    56* TODO: debe compilar con file status
    57$SET CONSTANT SW-STATUS-BDIIREGI"SI"
    58* BDIIREGI.v.03.0001
    59******************************************************************
    60* ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
    61* Equivale al Registro Civil de Argentina, contiene los ids de
    62* gente
    63******************************************************************
    64$SET IDXFORMAT"8"
    65$SET CONSTANT SW-STATUS-BDIIREGI"NO"
    66*    select BDIIREGI
    67*assign to disk TITLE-BDIIREGI
    68*organization is indexed
    69*access mode is dynamic
    70*record key is LLAVE-BDIIREGI
    71$if SW-STATUS-BDIIREGI = "NO"
    72$display ".............COMPILANDO BDIIREGI SIN status.........."
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 14:02 Page   3
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/BDIIREGI.F
    73$else
    74$display ".............COMPILANDO BDIIREGI CON status.........."
    75*file status is COD-RETORNO-BDIIREGI
    76$end
    77*lock mode is manual with lock on record.
    78$SET IDXFORMAT"0"
    79
80******************************************************************
    81******************************************************************
*   82 copy BDIIDIAN.FS.
    83* BDIIDIAN.v.03.0001
    84*==================================================================
    85* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADAS
    86* POR LA DIAN
    87*==================================================================
    88$SET CONSTANT SW-STATUS-BDIIDIAN"NO"
    89     SELECT BDIIDIAN ASSIGN TO DISK TITLE-BDIIDIAN
    90ORGANIZATION IS INDEXED
    91ACCESS MODE  IS DYNAMIC
    92RECORD KEY   IS LLAVE-BDIIDIAN
    93$IF SW-STATUS-BDIIDIAN = "NO"    92RECORD KEY   IS LLAVE-BDIIDIAN93$IF SW-STATUS-BDIIDIAN = "NO"
    94$DISPLAY ".............COMPILANDO BDIIDIAN SIN STATUS.........."
    95$ELSE
    96$DISPLAY ".............COMPILANDO BDIIDIAN CON STATUS.........."
    97XFILE STATUS IS COD-RETORNO-BDIIDIAN
    98$END
    99LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   100* BDIIDIAN.v.03.0001
   101* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA
   102* POR LA DIAN
   103* DIAN equivale a la AFIP de Argentina, contiene ids de empresas
   104******************************************************************
   105$SET CONSTANT SW-STATUS-BDIIDIAN"NO"
   106*    select BDIIDIAN assign to disk TITLE-BDIIDIAN
   107*organization is indexed
   108*access mode  is dynamic
   109*record key   is LLAVE-BDIIDIAN
   110$if SW-STATUS-BDIIDIAN = "NO"
   111$display ".............COMPILANDO BDIIDIAN SIN status.........."
   112$else
   113$display ".............COMPILANDO BDIIDIAN CON status.........."
   114*file status is COD-RETORNO-BDIIDIAN
   115$end
   116*lock mode is manual with lock on record.
   117
118******************************************************************
   119******************************************************************
*  120 copy BDIIDAS.FS.
   121* BDIIDAS.v.03.0001
   122*=====================================================================
   123* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA, PROPORCIONADAS POR EL DAS
   124*=====================================================================
   125$SET CONSTANT SW-STATUS-BDIIDAS"NO"
   126     SELECT BDIIDAS ASSIGN TO DISK TITLE-BDIIDAS
   127ORGANIZATION IS INDEXED
   128ACCESS MODE IS DYNAMIC
   129RECORD KEY IS LLAVE-BDIIDAS
   130$IF SW-STATUS-BDIIDAS = "NO"
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 14:02 Page   4
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/BDIIDAS.FS
   131$DISPLAY ".............COMPILANDO BDIIDAS SIN STATUS.........."
   132$ELSE
   133$DISPLAY ".............COMPILANDO BDIIDAS CON STATUS.........."
   134XFILE STATUS IS COD-RETORNO-BDIIDAS
   135$END
   136LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   137* BDIIDAS.v.03.0001
   138*=================================================================   137* BDIIDAS.v.03.0001138*=================================================================
   139* MAESTRO DE CEDULAS DE EXTRANJERIA, PROPORCIONADAS POR EL DAS
   140* Equivale a la SIDE de Argentina, provee ids de extranjeros
   141*=================================================================
   142$SET CONSTANT SW-STATUS-BDIIDAS"NO"
   143*    select BDIIDAS assign to disk TITLE-BDIIDAS
   144*organization is indexed
   145*access mode is dynamic
   146*record key is LLAVE-BDIIDAS
   147$if SW-STATUS-BDIIDAS = "NO"
   148$display ".............COMPILANDO BDIIDAS SIN status.........."
   149$else
   150$display ".............COMPILANDO BDIIDAS CON status.........."
   151*file status is COD-RETORNO-BDIIDAS
   152$end
   153*lock mode is manual with lock on record.
   154
155
156******************************************************************
   157******************************************************************
*  158     copy BDIIALE.FS replacing == on record.== by == on record
*  159file status is EST-BDIIALE.==.
   160* BDIIALE-FS.v01.0001
   161* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTOTRES
   162
163$SET CONSTANT SW-STATUS-BDIIALE"NO"
   164     SELECT BDIIALE
   165ASSIGN TO DISK MAES-BDIIALE-TITLE
   166ORGANIZATION IS INDEXED
   167ACCESS MODE IS DYNAMIC
   168RECORD KEY IS LLAVE-BDIIALE
   169$IF SW-STATUS-BDIIALE = "NO"
   170$DISPLAY ".............COMPILANDO BDIIALE SIN STATUS.........."
   171$ELSE
   172$DISPLAY ".............COMPILANDO BDIIALE CON STATUS.........."
   173XFILE STATUS IS EST-BDIIALE
   174$END
   175LOCK MODE IS MANUAL WITH LOCKon record
   176file status is EST-BDIIALE.
   177* BDIIALE-FS.v01.0001
   178* Maestro de alertas reportadas por suscriptotres
   179* Suscriptores son bancos, financieras y otros clientes de
   180* Datacredito
   181
182$SET CONSTANT SW-STATUS-BDIIALE"NO"
   183*    select BDIIALE
   184*assign to disk MAES-BDIIALE-TITLE
   185*organization is indexed      184*assign to disk MAES-BDIIALE-TITLE185*organization is indexed
   186*access mode is dynamic
   187*record key is LLAVE-BDIIALE
   188$if SW-STATUS-BDIIALE = "NO"
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 14:02 Page   5
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/BDIIALE.FS
   189$display ".............COMPILANDO BDIIALE SIN status.........."
   190$else
   191$display ".............COMPILANDO BDIIALE CON status.........."
   192*file status is EST-BDIIALE
   193$end
   194*lock mode is manual with lock on record.
   195
196******************************************************************
   197******************************************************************
   198 DATA DIVISION.
   199 FILE section.
   200
201******************************************************************
   202* Archivo de entrada con los datos de demandas y embargos de JURAD
   203******************************************************************
   204 FD JURAD.
   205 01  JURAD-reg.
   206* Registros de movimientos I, M, E
   207*    Tipo de Novedad {I, M, E} Inser/Modif/Elim
   208     03 JURAD-tipo-novedadpic x.
   209*    Tipo de identificacion Numero {1, 2, 3, 4}
   210     03 JURAD-id-tipopic x.
   211*    Numero de identificacion
   212     03 JURAD-id-numeroXpic x(11).
   213     03 JURAD-id-numeroredefines 03 JURAD-id-numeroX
*  13-S*********************************************(   0)**
**    User-name required
   214pic 9(11).
   215*    Nombres y Apellidos
   216     03 JURAD-nombrepic x(45).
   217*    Numero de demandas vigentes
   218     03 JURAD-demandas-vigentes   pic 999.
   219*    Numero de demandas terminadas
   220     03 JURAD-demandas-terminadas pic 999.
   221*    Fecha ultima demanda vigente YYMMDD
   222     03 JURAD-demandas-fecha-ultima pic x(6).
   223*    Numero de embargos vigentes
   224     03 JURAD-embargos-vigentes   pic 999.
   225*    Numero de embargos terminados
   226     03 JURAD-embargos-terminados pic 999.
   227*    Fecha ultimo embargo vigente YYMMDD
   228     03 JURAD-embargos-fecha-ultimo pic x(6).   :q/d/iccol/desarrollo $ des-c-v CARGAJUR^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H^H                                                        fu
/d/iccol/desarrollo $ des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIREGI SIN status.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN status.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN status.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDIIALE SIN status.........."
* Total Messages:    44
* Unrecoverable :     0                    Severe  :    44
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       21052     Code:           0
* Total Messages:    45
* Unrecoverable :     0                    Severe  :    45
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       21052     Code:           0
* Total Messages:   386
* Unrecoverable :     0                    Severe  :   386
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:         170     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo $vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 1153 lines, 70588 characters * Rejected - OPT
  156505 pic x(50) value high-values. *< end marker
*  71-S*****************************************(   0)**
**    PROCEDURE DIVISION missing or unknown statement
  1567     03 LA-modelos2redefines LA-modelos.
* 206-S******(  28)**
**    01 or 77 level required
  156805 LA-modelopic x(50) occurs 5
* 206-S**********(  28)**
**    01 or 77 level required
  1579     03 LA-templates.
* 206-S******(  28)**
**    01 or 77 level required
  158005 LA-templateoccurs 4 indexed LAx.
* 206-S**********(  29)**
**    01 or 77 level required
  158107 LA-partepic x(50)
* 206-S**************(  29)**
**    01 or 77 level required
  1584     03 LA-lineas.
* 206-S******(  29)**
**    01 or 77 level required
  158505 LA-linea1pic x(50).
* 206-S**********(  29)**
**    01 or 77 level required
  158605 LA-linea2pic x(50).
* 206-S**********(  29)**
**    01 or 77 level required
  1588     03 LA-valores.
* 206-S******(  29)**
**    01 or 77 level required
  1589LA-valorpic x(50)
*  71-S****************(  29)**
**    PROCEDURE DIVISION missing or unknown statement
  1592     03 LA-numpic -(11)0.
* 206-S******(  29)**
**    01 or 77 level required
  1593     03 LA-descartepic x(50).
* 206-S******(  29)**
**    01 or 77 level required
  1877     enf-if
*  12-S**********(  29)**
**    Operand ENF-IF is not declared
  2054     write BDIIALE-reg
*  12-S*********************(  35)**
**    Operand BDIIALE-REG is not declared
  2071     rewrite BDIIALE-reg
*  12-S***********************(  38)**
**    Operand BDIIALE-REG is not declared"CARGAJUR.CBL.err" 1153 lines, 70588 characters:q/d/iccol/desarrollo $^[  /d/iccol/desarrollo $vi CARGAJUR.CBL.errvi CARGAJUR.CBL    
"CARGAJUR.CBL" 2362 lines, 108648 characters $SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI"CARGAJUR.CBL" 2362 lines, 108648 characters/<\*Address search hit BOTTOM without matching pattern:q/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI/<\*Address search hit BOTTOM without matching pattern"CARGAJUR.CBL" line 1 of 2362 --0%-- :q/d/iccol/desarrollo $pwd
/d/iccol/desarrollo/fuentes
/d/iccol/desarrollo $ls CARGAJU*
CARGAJUR.CBL      CARGAJUR.CBL.err  CARGAJUR.idy      CARGAJUR.lst
/d/iccol/desarrollo $view CARGAJUR.lst
"CARGAJUR.lst" [Read only] 4936 lines, 275080 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 13:53 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist list sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"CARGAJUR.lst" [Read only] 4936 lines, 275080 characters^/<\*  1549     03 N-ale-modificadaspic 9(8) value zero.
  1550*    Alertas eliminadas
  1551     03 N-ale-eliminadaspic 9(8) value zero.
  1552*    Insercin de alerta existente
  1553     03 N-ale-ya-existepic 9(8) value zero.
  1554*    Modificacin o eliminacin de alerta inexistente
  1555     03 N-ale-no-existepic 9(8) value zero.
  1556
  1557******************************************************************
  1558* Armado de las lineas de alerta
  1559 01 LA-lineas-alerta.
  1560*    Los modelos a continuacion deberan obtenerse de un
  1561*    archivo, como BDIIALE-ALERTAS
  1562     03 LA-modelos.
  1563*12345678901234567890123456789012345678901234567890
  156405 pic x(50) value
  1565"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".
  156605 pic x(50) value
  1567"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
  156805 pic x(50) value
  1569"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".
  157005 pic x(50) value
  1571"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
  157205 pic x(50) value high-values. <* end marker
*  71-S*****************************************(  28)**
**    PROCEDURE DIVISION missing or unknown statement
  1573     03 LAendpic 999 comp value 0.
  1574     03 LA-modelos2redefines LA-modelos.
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 13:53 Page  29
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
* 206-S******(  28)**
**    01 or 77 level required
  157505 LA-modelopic x(50) occurs 5
* 206-S**********(  28)**
**    01 or 77 level required
  1576indexed LAm.
  1577*    Funcionamiento de los templates.
  1578*    Hay dos templates por de alerta, uno por linea.
  1579*    Cada template consiste en hasta 10 frases fijas con
  1580*    ampersands (&) donde se van a reemplazar los valores.
  1581*    Por ejemplo:
  1582*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
  1583*    tiene 3 frases fijas y 2 reemplazos.
  1584*    La cantidad de ampersands es irrelevante, pero parece
  1585*    conveniente que informe sobre el tamao del contenido.
  1586     03 LA-templates.
* 206-S******(  29)**
**    01 or 77 level required
  158705 LA-templateoccurs 4 indexed LAx.:q/d/iccol/desarrollo $^[  /d/iccol/desarrollo $view CARGAJUR.lstmiew CARGAJUR.lstMIEW cls CARGAJU*      view CARGAJUR.lstrm  
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $rm   CARGAJUR.lstview CARGAJUR.lstls CARGAJU*      ls -CARGAJU*lCARGAJU*aCARGAJU* CARGAJU*
-rw-rw-r--   1 icdgd    icdatacr  108648 May 15 16:20 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   70588 May 15 16:31 CARGAJUR.CBL.err
-rw-rw-r--   1 icdgd    icdatacr   47872 May 15 13:53 CARGAJUR.idy
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $ls -la CARGAJU*rm   CARGAJUR.lstview CARGAJUR.lstls CARGAJU*      pwd        fg vi CARGAJUR.CBLvi CARGAJUR.CBL.err des-c-v CARGAJUR  w des-c-v CARGAJURh des-c-v CARGAJURi des-c-v CARGAJURc des-c-v CARGAJURh des-c-v CARGAJURh des-c-v         
/d/iccol/desarrollo/macros/des-c-v
/d/iccol/desarrollo $view /d/iccol/desarrollo/macros/des-c-v
"/d/iccol/desarrollo/macros/des-c-v" [Read only] 57 lines, 1671 characters #   MACRO REVISADA PARA MILENIO - VHF
#   MAC022.v.0003

#   EL OBJETIVO DE LA MACRO ES COMPILAR LOS PROGRAMAS FUENTES COBOL SIN
#   OMITIR LA VALIDACION DE DESBORDAMIENTO DE INDICES DE ARREGLOS
#   NDG002  - INCLUIR EN LA LINEA DE COMPILACION LA DIRECTIVA SOURCEASM PARA
#QUE AL GENERA UN ERROR EN EJECUCICON GENERE LA LINEA EN EL MENSAJE
#QUE DESPLIEGA AL CANCELAR LA EJECCUCION.
# MAYO/2013#SE INCLUYEN CAMBIOS PROPUESTOS POR GLOBANT COMPILANDO A 64 BITS
# G.JIMENEZ#LOS QUE NO TIENE CCI Y AGREGANDO " -C sourceasm" EN EL COMANDO
# v.0003   #DE COMPILACION, SE INDEPENDIZAN LA MACRO DE DESARROLLO Y LA DE
##PRODUCCION
echo "Ejecucion de la macro de compilacion cobol para desarrollo"
OLDDIR=`pwd`
cd ~/fuentes
fte=$1

if [ -s $fte.cbl ]; then
   ext="cbl"
elif [ -s $fte.CBL ]; then
   ext="CBL"
elif [ -s $fte ]; then
   ext=" "
else
echo "^G^G**** ATENCION: EL ARCHIVO NO EXISTE "
   ext="N"
fi
if [ "$ext" != "N" ]; then
   cd ~/objetos
   if [ "$ext" != " " ]
   then
fte=$fte.$ext
   fi
#######################################
# Incorporado por Globant
cci=`grep -ic CCI- ~/fuentes/$fte`
if [ $cci == 0 ]; then
    cob=cob64
else
cob=cob
fi
# Fin incorporado por Globant
#######################################

####   if cob -uv  -P $2 $3 ~/fuentes/$fte 2> ~/fuentes/$fte.err; then
   if $cob -uv -g -P -C sourceasm $2 $3 ~/fuentes/$fte 2> ~/fuentes/$fte.err; then
echo
echo ">>> DATACREDITO: TERMINO OK COMPILACION DE $fte"
rm ~/fuentes/$fte.err"/d/iccol/desarrollo/macros/des-c-v" [Read only] 57 lines, 1671 characters    cob=cob64
else
cob=cob
fi
# Fin incorporado por Globant
#######################################

####   if cob -uv  -P $2 $3 ~/fuentes/$fte 2> ~/fuentes/$fte.err; then
   if $cob -uv -g -P -C sourceasm $2 $3 ~/fuentes/$fte 2> ~/fuentes/$fte.err; then
echo
echo ">>> DATACREDITO: TERMINO OK COMPILACION DE $fte"
rm ~/fuentes/$fte.err
   else
echo
echo ">>> DATACREDITO: ** COMPILANDO $fte HUBO ERRORES..."
echo "** ESTAN EN EL ARCHIVO $fte.err\n"
   fi
fi
cd $OLDDIR
echo
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~if [ $cci == 0 ]; thencci=`grep -ic CCI- ~/fuentes/$fte`# Incorporado por Globant#######################################   fifte=$fte.$ext   then   if [ "$ext" != " " ]   cd ~/objetosif [ "$ext" != "N" ]; thenfi   ext="N"   echo "^G^G**** ATENCION: EL ARCHIVO NO EXISTE "else   ext=" "elif [ -s $fte ]; then   ext="CBL"elif [ -s $fte.CBL ]; then   ext="cbl"if [ -s $fte.cbl ]; thenfte=$1cd ~/fuentesOLDDIR=`pwd`:q/d/iccol/desarrollo $cob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P -C sourceasm $FUENTES/CARGAJUR.CBL
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIREGI SIN status.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN status.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN status.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDIIALE SIN status.........."
  1565         05 pic x(50) value high-values. *< end marker
*  71-S*****************************************                       (   0)**
**    PROCEDURE DIVISION missing or unknown statement
  1567     03 LA-modelos2               redefines LA-modelos.
* 206-S******                                                          (  28)**
**    01 or 77 level required
  1568         05 LA-modelo             pic x(50) occurs 5
* 206-S**********                                                      (  28)**
**    01 or 77 level required
  1579     03 LA-templates.
* 206-S******                                                          (  28)**
**    01 or 77 level required
  1580         05 LA-template           occurs 4 indexed LAx.
* 206-S**********                                                      (  29)**
**    01 or 77 level required
  1581             07 LA-parte          pic x(50)
* 206-S**************                                                  (  29)**
**    01 or 77 level required
  1584     03 LA-lineas.
* 206-S******                                                          (  29)**
**    01 or 77 level required
  1585         05 LA-linea1             pic x(50).
* 206-S**********                                                      (  29)**
**    01 or 77 level required
  1586         05 LA-linea2             pic x(50).
* 206-S**********                                                      (  29)**
**    01 or 77 level required
  1588     03 LA-valores.
* 206-S******                                                          (  29)**
**    01 or 77 level required
  1589         LA-valor                 pic x(50)
*  71-S****************                                                (  29)**
**    PROCEDURE DIVISION missing or unknown statement
  1592     03 LA-num                    pic -(11)0.
* 206-S******                                                          (  29)**
**    01 or 77 level required
  1593     03 LA-descarte               pic x(50).
* 206-S******                                                          (  29)**
**    01 or 77 level required
  1877     enf-if
*  12-S**********                                                      (  29)**
**    Operand ENF-IF is not declared
  2054     write BDIIALE-reg
*  12-S*********************                                           (  35)**
**    Operand BDIIALE-REG is not declared
  2071     rewrite BDIIALE-reg
*  12-S***********************                                         (  38)**
**    Operand BDIIALE-REG is not declared
  2118         set LAx to 1
*  12-S***************                                                 (  38)**
**    Operand LAX is not declared
  2119         move high-values to LA-valores
*  12-S**************************************                          (  39)**
**    Operand LA-VALORES is not declared
  2120         move JURAD-demandas-vigentes to LA-num
*  12-S**********************************************                  (  39)**
**    Operand LA-NUM is not declared
  2121         unstring LA-num into LA-descarte LA-valor(1)
*  12-S***********************                                         (  39)**
**    Operand LA-NUM is not declared
  2123         move JURAD-demandas-terminadas to LA-num
*  12-S************************************************                (  39)**
**    Operand LA-NUM is not declared
  2124         unstring LA-num into LA-descarte LA-valor(2)
*  12-S***********************                                         (  39)**
**    Operand LA-NUM is not declared
  2126         string LA-parte(LAx, 1) LA-valor(1)
*  12-S***********************                                         (  39)**
**    Operand LA-PARTE is not declared
  2127         string LA-parte(LAx, 2) LA-valor(2)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2128         string LA-parte(LAx, 3) LA-valor(3)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2129         string LA-parte(LAx, 4) LA-valor(4)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2130         string LA-parte(LAx, 5) LA-valor(5)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2131         string LA-parte(LAx, 6) LA-valor(6)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2132         string LA-parte(LAx, 7) LA-valor(7)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2133         string LA-parte(LAx, 8) LA-valor(8)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2134         string LA-parte(LAx, 9) LA-valor(9)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2135         string LA-parte(LAx, 10) LA-valor(10)
*  12-S***********************                                         (  40)**
**    Operand LA-PARTE is not declared
  2239     set LAx to 0
*  12-S***********                                                     (  40)**
**    Operand LAX is not declared
  2240     move high-values to LA-templates
*  12-S************************************                            (  42)**
**    Operand LA-TEMPLATES is not declared
  2241     perform varying LAm frm 1 by 1
*  12-S***********************                                         (  42)**
**    Operand LAM is not declared
  2243         set LAx up by 1
*  12-S***************                                                 (  42)**
**    Operand LAX is not declared
  2245         unstring LA-modelo(LAm) into LA-parte(LAx, 1)
*  12-S**************************                                      (  42)**
**    Operand LA-MODELO is not declared
  2251         perform varying LAy from 1 by 1 until LAy > 10
*  12-S***************************                                     (  42)**
**    Operand LAY is not declared
  2252             inspect PA-parte(LAx, LAy) replacing trailing
*  12-S****************************                                    (  42)**
**    Operand PA-PARTE is not declared
  2254             inspect PA-parte(LAx, LAy) replacing first
*  12-S****************************                                    (  42)**
**    Operand PA-PARTE is not declared
  2256         end-perform
* 564-S*******************                                             (  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2257     end-perform.
* 564-S***************                                                 (  42)**
**    A scope-delimiter did not have a matching verb and was discarded.
* 348-S****************                                                (  42)**
**    Procedure name 1000-CARGA-TOTAL undeclared, line 2165 (first usage)
* 348-S******************                                              (  57)**
**    Procedure name 1000-ACTUALIZACION undeclared, line 2167 (first usage)
* Total Messages:    44
* Unrecoverable :     0                    Severe  :    44
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       21052     Code:           0
  3172 80100-VALIDAR-IDENTIFICACION.
* 317-S****************************                                    (  57)**
**    Incorrect structure of PROCEDURE DIVISION
* Total Messages:    45
* Unrecoverable :     0                    Severe  :    45
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       21052     Code:           0
* 143-S****************************                                    (  59)**
**    Unknown IDENTIFICATION DIVISION paragraph
  3179    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM
* 105-S*************                                                   (  59)**
**    PROGRAM-ID missing
*  12-S****************************************                        (  59)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3181    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
*  12-S***************************                                     (  59)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3182    IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  59)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3183       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3184    END-IF                                                        FAC0002
* 564-S*********                                                       (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3185    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  60)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3186       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3187    END-IF                                                        FAC0002
* 564-S*********                                                       (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3188    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  60)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3189       MOVE ZEROS TO SW-VALTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3190    END-IF                                                        FAC0002
* 564-S*********                                                       (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3191    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERIC                         FAC0003
*  12-S****************************                                    (  60)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3192       MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDE                       FAC0003
*  12-S******************************************                      (  60)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3193    END-IF                                                        FAC0003
* 564-S*********                                                       (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3194    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
*  12-S**********************                                          (  60)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3195      IF SW-ASGTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  60)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3197      END-IF                                                      FAC0002
* 564-S***********                                                     (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3198      IF SW-VALTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  60)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3200      END-IF                                                      FAC0002
* 564-S***********                                                     (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3201      IF SW-DIGCHEQUEO-BDIIVIDE = 1                               FAC0004
*  12-S******************************                                  (  60)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3203      END-IF                                                      FAC0004
* 564-S***********                                                     (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3204      IF SW-VALTIPID-BDIIVIDE = 0 OR                              FAC0004
*  12-S****************************                                    (  61)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3207       INITIALIZE NOM-VAL-BDIIVIDE
*  12-S*********************************                               (  61)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3208       MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE
*  12-S*****************************                                   (  61)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3209       IF SW-VERIFNOM-BDIIVIDE = 1
*  12-S*****************************                                   (  61)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3210          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM
*  12-S******************************                                  (  61)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3211          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM
*  12-S*****************************                                   (  61)**
**    Operand NOMBRE-BDIIVIDE is not declared
  3212          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  61)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3213          IF SW-ID-BDIIVIDE = 0
*  12-S**************************                                      (  61)**
**    Operand SW-ID-BDIIVIDE is not declared
  3214             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND
*  12-S***********************************                             (  61)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3216                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
*  12-S****************************************                        (  61)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3217             ELSE IF TIP-ID-INPUT-VALNOM = 1
*  12-S***************************************                         (  61)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3218                     MOVE 2 TO BLOQUES-INPUT-VALNOM
*  12-S**************************************************              (  61)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3219                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM
*  12-S****************************************************            (  61)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3220                  END-IF
* 564-S***********************                                         (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3221             END-IF
* 564-S******************                                              (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3223             IF MATCH-OK-OUT-VALNOM = 0
*  12-S**********************************                              (  61)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3224                MOVE 1 TO SW-NOMBRES-BDIIVIDE
*  12-S********************************************                    (  61)**
**    Operand SW-NOMBRES-BDIIVIDE is not declared
  3225             END-IF
* 564-S******************                                              (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3226          END-IF
* 564-S***************                                                 (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3227       END-IF
* 564-S************                                                    (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3228      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  62)**
**    Operand SW-TID-BDIIVIDE is not declared
  3229              MOVE 1 TO SW-ID-BDIIVIDE                            FAC0002
*  12-S*************************************                           (  62)**
**    Operand SW-ID-BDIIVIDE is not declared
  3230           END-IF                                                 FAC0002
* 564-S****************                                                (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3231      END-IF                                                      FAC0002
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3232    ELSE MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  62)**
**    Operand SW-ID-BDIIVIDE is not declared
  3233    END-IF.
* 564-S*********                                                       (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3243     EVALUATE TIP-IDE-BDIIVIDE
*  12-S*****************************                                   (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3246       WHEN 2
* 368-S**********                                                      (  62)**
**    Exception phrase inappropriate
  3248       WHEN 3
* 368-S**********                                                      (  62)**
**    Exception phrase inappropriate
  3250       WHEN 4
* 368-S**********                                                      (  62)**
**    Exception phrase inappropriate
  3252       WHEN OTHER
* 368-S**********                                                      (  62)**
**    Exception phrase inappropriate
  3253         MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  62)**
**    Operand SW-ID-BDIIVIDE is not declared
  3254     END-EVALUATE.
* 564-S****************                                                (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3262    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002
*  12-S****************************************                        (  63)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3263    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3264      IF (NUM-IDE-BDIIVIDE-R >= 1 AND                             FAC0002
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3268         MOVE 1 TO TIP-IDE-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  63)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3270        IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002
*  12-S*****************************                                   (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3274           MOVE 2 TO TIP-IDE-BDIIVIDE                             FAC0002
*  12-S************************************                            (  63)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3280          IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002
*  12-S*******************************                                 (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3284             MOVE 3 TO TIP-IDE-BDIIVIDE                           FAC0002
*  12-S**************************************                          (  63)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3285          ELSE MOVE 4 TO TIP-IDE-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  63)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3286          END-IF.                                                 FAC0002
* 564-S***************                                                 (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3296    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  63)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3297    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  64)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3298    EVALUATE TIP-IDE-BDIIVIDE                                     FAC0002
*  12-S****************************                                    (  64)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3300       IF NUM-IDE-BDIIVIDE-R > 9999999999                         FAC0002
*  12-S***************************                                     (  64)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3301          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  64)**
**    Operand SW-TID-BDIIVIDE is not declared
  3302       END-IF                                                     FAC0002
* 564-S************                                                    (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3304       IF NUM-IDE-BDIIVIDE-R >  9999999999 OR                     FAC006C
*  12-S***************************                                     (  64)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3306          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  64)**
**    Operand SW-TID-BDIIVIDE is not declared
  3307       END-IF                                                     FAC0002
* 564-S************                                                    (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3309       IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000           FAC0005
*  12-S***************************                                     (  64)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3310          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  64)**
**    Operand SW-TID-BDIIVIDE is not declared
  3311       END-IF                                                     FAC0002
* 564-S************                                                    (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3312    END-EVALUATE.                                                 FAC0002
* 564-S***************                                                 (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3320      IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                     FAC0004
*  12-S***************************                                     (  64)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3324          MOVE 3 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  64)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3325      END-IF                                                      FAC0004
* 564-S***********                                                     (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3326      IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                     FAC0004
*  12-S***************************                                     (  65)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3330          MOVE 2 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  65)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3331      END-IF                                                      FAC0004
* 564-S***********                                                     (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3332      IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004
*  12-S*************************                                       (  65)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3339          MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDE            FAC0004
*  12-S******************************                                  (  65)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3340          MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R          FAC0004
*  12-S*********************************                               (  65)**
**    Operand NUM-ID-W10-BDIIVIDE is not declared
  3341      END-IF                                                      FAC0004
* 564-S***********                                                     (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3342      INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".          FAC0004
*  12-S*****************************                                   (  65)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3350     MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI
*  12-S*************************                                       (  65)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3351     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI
*  12-S*************************                                       (  65)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3352     READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  65)**
**    Operand BDIIREGI is not declared
*  12-S******************************************************          (  65)**
**    Operand SW-ID-BDIIVIDE is not declared
  3353     END-READ
* 564-S************                                                    (  66)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3354     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  66)**
**    Operand SW-ID-BDIIVIDE is not declared
  3355        MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  66)**
**    Operand APELLIDO1-BDIIREGI is not declared
  3356        MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  66)**
**    Operand APELLIDO2-BDIIREGI is not declared
  3357        MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE
*  12-S********************************                                (  66)**
**    Operand DES-NOMBRE2-BDIIREGI is not declared
  3358        MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE
*  12-S********************************                                (  66)**
**    Operand DES-NOMBRE1-BDIIREGI is not declared
  3359        IF ESTADO-CIVIL-BDIIREGI = 0
*  12-S*******************************                                 (  66)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3361             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  66)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3368         END-IF
* 564-S**************                                                  (  66)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3369         IF ESTADO-CIVIL-BDIIREGI = 1
*  12-S********************************                                (  66)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3373             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  66)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3380         END-IF
* 564-S**************                                                  (  66)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3381         IF ESTADO-CIVIL-BDIIREGI = 2
*  12-S********************************                                (  66)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3385             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  66)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3392         END-IF
* 564-S**************                                                  (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3393         STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S***************************************                         (  67)**
**    Operand PRIMER-APELLIDO-BDIIVIDE is not declared
  3399         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "
*  12-S********************************                                (  67)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3400         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "
*  12-S********************************                                (  67)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3401         INITIALIZE NOM-LEIDO-BDIIVIDE
*  12-S*************************************                           (  67)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3402         MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.
*  12-S*****************************                                   (  67)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3409     MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN
*  12-S*************************                                       (  67)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3410     READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  67)**
**    Operand BDIIDIAN is not declared
*  12-S******************************************************          (  67)**
**    Operand SW-ID-BDIIVIDE is not declared
  3411     END-READ
* 564-S************                                                    (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3412     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  67)**
**    Operand SW-ID-BDIIVIDE is not declared
  3413        MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE
*  12-S********************************                                (  67)**
**    Operand DESCRIPCION-BDIIDIAN is not declared
  3414     END-IF.
* 564-S**********                                                      (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3421     MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS
*  12-S*************************                                       (  68)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3422     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS
*  12-S*************************                                       (  68)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3423     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S****************                                                (  68)**
**    Operand BDIIDAS is not declared
*  12-S*****************************************************           (  68)**
**    Operand SW-ID-BDIIVIDE is not declared
  3424     END-READ
* 564-S************                                                    (  68)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3425     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  68)**
**    Operand SW-ID-BDIIVIDE is not declared
  3426        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.
*  12-S**************************                                      (  68)**
**    Operand NOMBRE-BDIIDAS is not declared
  3742     MOVE 0 TO MATCH-OK-OUT-VALNOM.
*  12-S*********************************                               (  68)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3743     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  73)**
**    Operand NOMBRE-INPUT-VALNOM is not declared
  3744     IF TIP-ID-INPUT-VALNOM  = 2
*  12-S**************************                                      (  74)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3745         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S*********************************                               (  74)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3756         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  74)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3767         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  74)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3771         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  74)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3775         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
*  12-S******************************                                  (  74)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3777        INSPECT CADENA-VALNOM    REPLACING ALL
*  12-S****************************                                    (  74)**
**    Operand CADENA-VALNOM is not declared
  3783        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
*  12-S****************************                                    (  74)**
**    Operand CADENA-VALNOM is not declared
  3789                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  74)**
**    Operand I-VALNOM is not declared
  3791                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  75)**
**    Operand VNOM-AUX-VALNOM is not declared
  3793                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  75)**
**    Operand VNOM-AUX-VALNOM is not declared
  3794                  END-IF
* 564-S***********************                                         (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3795                END-PERFORM
* 564-S**************************                                      (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3796     END-IF.
* 564-S**********                                                      (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3797     MOVE SPACES TO VECTOR-INPUT-VALNOM.
*  12-S**************************************                          (  75)**
**    Operand VECTOR-INPUT-VALNOM is not declared
  3798     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  75)**
**    Operand CADENA-VALNOM is not declared
  3811     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  75)**
**    Operand NOMBOK-INPUT-VALNOM is not declared
  3812     IF TIP-ID-INPUT-VALNOM  NOT = 2
*  12-S**************************                                      (  75)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3813        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S********************************                                (  75)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3817                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  75)**
**    Operand I-VALNOM is not declared
  3819                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  75)**
**    Operand VNOM-AUX-VALNOM is not declared
  3821                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  76)**
**    Operand VNOM-AUX-VALNOM is not declared
  3822                  END-IF
* 564-S***********************                                         (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3823                END-PERFORM
* 564-S**************************                                      (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3825         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  76)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3836         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  76)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3847        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
*  12-S********************************                                (  76)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3851         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  76)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3852     END-IF.
* 564-S**********                                                      (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3853     MOVE SPACES TO VECTOR-OK-VALNOM.
*  12-S***********************************                             (  76)**
**    Operand VECTOR-OK-VALNOM is not declared
  3854     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  76)**
**    Operand CADENA-VALNOM is not declared
  3865     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  76)**
**    Operand I-VALNOM is not declared
  3866     MOVE 0 TO BLOQOK-AUX-VALNOM.
*  12-S*******************************                                 (  77)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3867     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
*  12-S*********************************                               (  77)**
**    Operand VM-INPUT-VALNOM is not declared
  3868       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  77)**
**    Operand J-VALNOM is not declared
  3869       PERFORM UNTIL J-VALNOM > 20
*  12-S****************************                                    (  77)**
**    Operand J-VALNOM is not declared
  3870         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
*  12-S**************************                                      (  77)**
**    Operand VM-INPUT-VALNOM is not declared
  3871            ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*************************************                           (  77)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3872            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S**************************************                          (  77)**
**    Operand VM-OK-VALNOM is not declared
  3874            MOVE 21 TO J-VALNOM
*  12-S******************************                                  (  77)**
**    Operand J-VALNOM is not declared
  3876            MOVE 0 TO M-VALNOM
*  12-S*****************************                                   (  77)**
**    Operand M-VALNOM is not declared
  3877            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S*******************************                                 (  77)**
**    Operand VM-OK-VALNOM is not declared
  3879            IF M-VALNOM >= 15
*  12-S**********************                                          (  77)**
**    Operand M-VALNOM is not declared
  3880               MOVE 0 TO M-VALNOM
*  12-S********************************                                (  77)**
**    Operand M-VALNOM is not declared
  3881               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S**********************************                              (  77)**
**    Operand VM-OK-VALNOM is not declared
  3883            END-IF
* 564-S*****************                                               (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3884            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
*  12-S**********************                                          (  78)**
**    Operand M-VALNOM is not declared
  3886               COMPUTE INI-VALNOM = M-VALNOM + 2
*  12-S********************************                                (  78)**
**    Operand INI-VALNOM is not declared
  3887               COMPUTE LON-VALNOM = 14 - M-VALNOM
*  12-S********************************                                (  78)**
**    Operand LON-VALNOM is not declared
  3888               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
*  12-S*******************************                                 (  78)**
**    Operand VM-OK-VALNOM is not declared
  3889               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
*  12-S******************************                                  (  78)**
**    Operand PEDAZO-VALNOM is not declared
  3893                  ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*******************************************                     (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3894                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S********************************************                    (  78)**
**    Operand VM-OK-VALNOM is not declared
  3896                  MOVE 21 TO J-VALNOM
*  12-S************************************                            (  78)**
**    Operand J-VALNOM is not declared
  3897                  ADD 1 TO I-VALNOM
*  12-S**********************************                              (  78)**
**    Operand I-VALNOM is not declared
  3898                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  78)**
**    Operand VM-INPUT-VALNOM is not declared
  3899               END-IF
* 564-S********************                                            (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3900            END-IF
* 564-S*****************                                               (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3901         END-IF
* 564-S**************                                                  (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3902         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  78)**
**    Operand J-VALNOM is not declared
  3903       END-PERFORM
* 564-S*****************                                               (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3904       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  78)**
**    Operand I-VALNOM is not declared
  3905       IF I-VALNOM = 21
*  12-S*****************                                               (  78)**
**    Operand I-VALNOM is not declared
  3907       END-IF
* 564-S************                                                    (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3908     END-PERFORM.
* 564-S***************                                                 (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3909     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S************************                                        (  79)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3910        MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S************************************                            (  79)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3912        IF TIP-ID-INPUT-VALNOM <> 2
*  12-S*****************************                                   (  79)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3914        ELSE
* 562-S***********                                                     (  79)**
**    An "ELSE" phrase did not have a matching IF and was discarded.
  3916        END-IF
* 564-S*************                                                   (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3917        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S***************************                                     (  79)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3918           MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S***************************************                         (  79)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3919        END-IF
* 564-S*************                                                   (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3920     END-IF.
* 564-S**********                                                      (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3928     IF BLOQOK-AUX-VALNOM > 0
*  12-S************************                                        (  79)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3929        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  79)**
**    Operand APROX-TOT-VALNOM is not declared
  3931        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  79)**
**    Operand APROX-TOT-VALNOM is not declared
  3932     END-IF
* 564-S**********                                                      (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3933     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  79)**
**    Operand I-VALNOM is not declared
  3934     PERFORM UNTIL I-VALNOM > 10
*  12-S**************************                                      (  80)**
**    Operand I-VALNOM is not declared
  3935       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  80)**
**    Operand J-VALNOM is not declared
  3936       PERFORM UNTIL J-VALNOM > 10
*  12-S****************************                                    (  80)**
**    Operand J-VALNOM is not declared
  3937         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
*  12-S**********************************                              (  80)**
**    Operand LETRAS-OK-VALNOM is not declared
  3938         MOVE 1 TO K-VALNOM
*  12-S**************************                                      (  80)**
**    Operand K-VALNOM is not declared
  3939         MOVE 1 TO L-VALNOM
*  12-S**************************                                      (  80)**
**    Operand L-VALNOM is not declared
  3940         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
*  12-S**************************                                      (  80)**
**    Operand VM-INPUT-VALNOM is not declared
  3942            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  80)**
**    Operand K-VALNOM is not declared
  3943              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  80)**
**    Operand VMM-INPUT-VALNOM is not declared
  3948                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
*  12-S********************************                                (  80)**
**    Operand VMM-OK-VALNOM is not declared
  3949                    ADD 1 TO LETRAS-OK-VALNOM
*  12-S********************************************                    (  80)**
**    Operand LETRAS-OK-VALNOM is not declared
  3950                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  80)**
**    Operand K-VALNOM is not declared
  3951                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  80)**
**    Operand L-VALNOM is not declared
  3953                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  80)**
**    Operand K-VALNOM is not declared
  3954                 END-IF
* 564-S**********************                                          (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3956                 ADD 1   TO K-VALNOM
*  12-S***********************************                             (  80)**
**    Operand K-VALNOM is not declared
  3957                 IF K-VALNOM <= 15 AND L-VALNOM < 15
*  12-S***************************                                     (  80)**
**    Operand K-VALNOM is not declared
  3958                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
*  12-S**************************************                          (  81)**
**    Operand VMM-INPUT-VALNOM is not declared
  3960                       ADD 1 TO L-VALNOM
*  12-S***************************************                         (  81)**
**    Operand L-VALNOM is not declared
  3961                    END-IF
* 564-S*************************                                       (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3962                 END-IF
* 564-S**********************                                          (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3963              END-IF
* 564-S*******************                                             (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3964            END-PERFORM
* 564-S**********************                                          (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3965            MOVE 1 TO K-VALNOM
*  12-S*****************************                                   (  81)**
**    Operand K-VALNOM is not declared
  3966            MOVE 1 TO L-VALNOM
*  12-S*****************************                                   (  81)**
**    Operand L-VALNOM is not declared
  3967            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  81)**
**    Operand K-VALNOM is not declared
  3968              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  81)**
**    Operand VMM-INPUT-VALNOM is not declared
  3973                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
*  12-S********************************                                (  81)**
**    Operand VMM-OK-VALNOM is not declared
  3974                    ADD 1 TO LETRAS-OK2-VALNOM
*  12-S*********************************************                   (  81)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3975                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  81)**
**    Operand K-VALNOM is not declared
  3976                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  81)**
**    Operand L-VALNOM is not declared
  3978                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  81)**
**    Operand K-VALNOM is not declared
  3979                 END-IF
* 564-S**********************                                          (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3981                 ADD 1   TO L-VALNOM
*  12-S***********************************                             (  81)**
**    Operand L-VALNOM is not declared
  3982                 IF L-VALNOM <= 15 AND K-VALNOM < 15
*  12-S***************************                                     (  82)**
**    Operand L-VALNOM is not declared
  3983                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S**************************************                          (  82)**
**    Operand VMM-INPUT-VALNOM is not declared
  3985                       ADD 1 TO K-VALNOM
*  12-S***************************************                         (  82)**
**    Operand K-VALNOM is not declared
  3986                    END-IF
* 564-S*************************                                       (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3987                 END-IF
* 564-S**********************                                          (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3988              END-IF
* 564-S*******************                                             (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3989            END-PERFORM
* 564-S**********************                                          (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3990         END-IF
* 564-S**************                                                  (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3991         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
*  12-S****************************                                    (  82)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3992            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
*  12-S*********************************                               (  82)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3993         END-IF
* 564-S**************                                                  (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3994         IF LETRAS-OK-VALNOM > 0
*  12-S***************************                                     (  82)**
**    Operand LETRAS-OK-VALNOM is not declared
  3995            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
*  12-S**************************************                          (  82)**
**    Operand TOTLET-INP-VALNOM is not declared
  3996            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
*  12-S**********************************                              (  82)**
**    Operand VM-INPUT-VALNOM is not declared
  3999            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
*  12-S*******************************                                 (  82)**
**    Operand VM-OK-VALNOM is not declared
  4002            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
*  12-S***********************************                             (  82)**
**    Operand POR-TOT-VALNOM is not declared
  4003            IF TOTLET-OK-VALNOM >= 3
*  12-S******************************                                  (  82)**
**    Operand TOTLET-OK-VALNOM is not declared
  4004               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  82)**
**    Operand POR-TOT-VALNOM is not declared
  4006            END-IF
* 564-S*****************                                               (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4007            IF TOTLET-INP-VALNOM >= 3
*  12-S*******************************                                 (  83)**
**    Operand TOTLET-INP-VALNOM is not declared
  4008               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  83)**
**    Operand POR-INP-VALNOM is not declared
  4010            END-IF
* 564-S*****************                                               (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4011            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
*  12-S******************************                                  (  83)**
**    Operand TOTLET-OK-VALNOM is not declared
  4012               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
*  12-S******************************                                  (  83)**
**    Operand A-VALNOM is not declared
  4015               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
*  12-S******************************                                  (  83)**
**    Operand A-VALNOM is not declared
  4017            END-IF
* 564-S*****************                                               (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4018            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
*  12-S******************************                                  (  83)**
**    Operand POR-TOT-VALNOM is not declared
  4028               ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S****************************************                        (  83)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4029               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S*****************************************                       (  83)**
**    Operand VM-OK-VALNOM is not declared
  4031            END-IF
* 564-S*****************                                               (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4032         END-IF
* 564-S**************                                                  (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4033         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  83)**
**    Operand J-VALNOM is not declared
  4034       END-PERFORM
* 564-S*****************                                               (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4035       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  84)**
**    Operand I-VALNOM is not declared
  4036     END-PERFORM.
* 564-S***************                                                 (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4044   MOVE ZEROS TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  84)**
**    Operand TOTLET-INP-VALNOM is not declared
  4045   MOVE ZEROS TO LETRAS-OK2-VALNOM
*  12-S*********************************                               (  84)**
**    Operand LETRAS-OK2-VALNOM is not declared
  4046    MOVE ZEROS TO A-VALNOM                                        GJC0003
*  12-S*************************                                       (  84)**
**    Operand A-VALNOM is not declared
  4047   MOVE 1 TO K-VALNOM
*  12-S********************                                            (  84)**
**    Operand K-VALNOM is not declared
  4048   PERFORM UNTIL K-VALNOM > 65
*  12-S************************                                        (  84)**
**    Operand K-VALNOM is not declared
  4049     MOVE K-VALNOM  TO I-VALNOM
*  12-S*****************                                               (  84)**
**    Operand K-VALNOM is not declared
  4050     MOVE 1       TO J-VALNOM
*  12-S****************************                                    (  84)**
**    Operand J-VALNOM is not declared
  4051     MOVE ZEROS TO LETRAS-OK-VALNOM
*  12-S**********************************                              (  84)**
**    Operand LETRAS-OK-VALNOM is not declared
  4052     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
*  12-S**************************                                      (  84)**
**    Operand J-VALNOM is not declared
  4053        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S*************************                                       (  84)**
**    Operand V-NOMBRE-VALNOM is not declared
  4055           IF V-NOMBRE-VALNOM(I-VALNOM) =
*  12-S****************************                                    (  84)**
**    Operand V-NOMBRE-VALNOM is not declared
  4057              ADD 1 TO LETRAS-OK-VALNOM
*  12-S**************************************                          (  84)**
**    Operand LETRAS-OK-VALNOM is not declared
  4058              ADD 1 TO I-VALNOM
*  12-S******************************                                  (  84)**
**    Operand I-VALNOM is not declared
  4059              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  84)**
**    Operand J-VALNOM is not declared
  4061              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  85)**
**    Operand J-VALNOM is not declared
  4062           END-IF
* 564-S****************                                                (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4064           ADD 1 TO I-VALNOM
*  12-S***************************                                     (  85)**
**    Operand I-VALNOM is not declared
  4065        END-IF
* 564-S*************                                                   (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4066     END-PERFORM
* 564-S***************                                                 (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4067     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
*  12-S***********************                                         (  85)**
**    Operand LETRAS-OK-VALNOM is not declared
  4068        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
*  12-S****************************                                    (  85)**
**    Operand LETRAS-OK-VALNOM is not declared
  4069     END-IF
* 564-S**********                                                      (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4070     ADD 1 TO K-VALNOM
*  12-S*********************                                           (  85)**
**    Operand K-VALNOM is not declared
  4071   END-PERFORM.
* 564-S*************                                                   (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4072   MOVE 1 TO I-VALNOM
*  12-S********************                                            (  85)**
**    Operand I-VALNOM is not declared
  4073   PERFORM UNTIL I-VALNOM > 65
*  12-S************************                                        (  85)**
**    Operand I-VALNOM is not declared
  4074     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S**********************                                          (  85)**
**    Operand V-NOMBRE-VALNOM is not declared
  4076        ADD 1 TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  85)**
**    Operand TOTLET-INP-VALNOM is not declared
  4077     END-IF
* 564-S**********                                                      (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4078     ADD 1 TO I-VALNOM
*  12-S*********************                                           (  85)**
**    Operand I-VALNOM is not declared
  4079   END-PERFORM.
* 564-S*************                                                   (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4080   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
*  12-S******************                                              (  85)**
**    Operand A-VALNOM is not declared
  4082   IF A-VALNOM >= 75
*  12-S*************                                                   (  86)**
**    Operand A-VALNOM is not declared
  4083       ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S********************************                                (  86)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4084   END-IF.
* 564-S********                                                        (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4085    MOVE 0 TO K-VALNOM                                            GJC0003
*  12-S*********************                                           (  86)**
**    Operand K-VALNOM is not declared
  4086   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
*  12-S**********************                                          (  86)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4087      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
*  12-S************************                                        (  86)**
**    Operand A-VALNOM is not declared
  4088      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
*  12-S*****************************                                   (  86)**
**    Operand J-VALNOM is not declared
  4089               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  86)**
**    Operand V-NOMBRE-VALNOM is not declared
  4090                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  86)**
**    Operand V-NOMBRE-VALNOM is not declared
  4092                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
*  12-S**********************************************                  (  86)**
**    Operand CONT-LET-INPUT-VALNOM is not declared
  4093              END-IF                                              GJC0003
* 564-S*******************                                             (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4094               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  86)**
**    Operand V-NOMBOK-VALNOM is not declared
  4095                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  86)**
**    Operand V-NOMBOK-VALNOM is not declared
  4097                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
*  12-S*******************************************                     (  86)**
**    Operand CONT-LET-OK-VALNOM is not declared
  4098              END-IF                                              GJC0003
* 564-S*******************                                             (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4099      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4100      MOVE 0 TO I-VALNOM                                          GJC0003
*  12-S***********************                                         (  86)**
**    Operand I-VALNOM is not declared
  4101       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
*  12-S******************************                                  (  86)**
**    Operand J-VALNOM is not declared
  4102         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
*  12-S*****************************                                   (  87)**
**    Operand CONT-LET-OK-VALNOM is not declared
  4103            ADD 1 TO I-VALNOM                                     GJC0003
*  12-S****************************                                    (  87)**
**    Operand I-VALNOM is not declared
  4104            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
*  12-S********************************                                (  87)**
**    Operand CONT-LET-OK-VALNOM is not declared
  4106               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
*  12-S******************************                                  (  87)**
**    Operand L-VALNOM is not declared
  4108               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
*  12-S******************************                                  (  87)**
**    Operand L-VALNOM is not declared
  4111            END-IF                                                GJC0003
* 564-S*****************                                               (  87)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4112         END-IF                                                   GJC0003
* 564-S**************                                                  (  87)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4113      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  87)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4114      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
*  12-S*********************                                           (  87)**
**    Operand K-VALNOM is not declared
  4115       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
*  12-S******************                                              (  87)**
**    Operand A-VALNOM is not declared
  4118         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
*  12-S**********************************                              (  87)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4119       END-IF                                                     GJC0003
* 564-S************                                                    (  87)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4120   END-IF.                                                        GJC0003
* 564-S********                                                        (  87)**
**    A scope-delimiter did not have a matching verb and was discarded.
* Total Messages:   386
* Unrecoverable :     0                    Severe  :   386
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:         170     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print
/d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo/objetos/CARGAJUR.idy
find: cannot read dir /d/iccol/desarrollo/fuentes/especiales/darlas: Permission denied
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err
/d/iccol/desarrollo/fuentes/CARGAJUR.idy
/d/iccol/desarrollo/fuentes/CARGAJUR.lst
find: cannot read dir /d/iccol/desarrollo/stt: Permission denied
find: cannot read dir /d/iccol/desarrollo/sf/.sunw: Permission denied
find: cannot read dir /d/iccol/desarrollo/.ssh: Permission denied
/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/objetos/CARGAJUR*
-rw-rw-r--   1 icdgd    icdatacr   47872 May 15 16:31 /d/iccol/desarrollo/objetos/CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr  311229 May 15 16:31 /d/iccol/desarrollo/objetos/CARGAJUR.lst
/d/iccol/desarrollo $view /d/iccol/desarrollo/objetos/CARGAJUR.lst
"/d/iccol/desarrollo/objetos/CARGAJUR.lst" [Read only] 5561 lines, 311229 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:31 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR COMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2 NOWB3
*WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"/d/iccol/desarrollo/objetos/CARGAJUR.lst" [Read only] 5561 lines, 311229 characters^     2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.4******************************************************************5* Actualización del archivo de alertas con los datos provistos6* por Jurad7* Procesa el archivo JURAD. Controla cada registro: si es OK usa8* los datos para actualizar BDIIALE, si tiene defecto lo graba en9* el archivo ERRS.
    10******************************************************************
    11 AUTHOR.Globant JL.
    12 DATE-WRITTEN.
    13 DATE-COMPILED. 15-May-14 16:31.
    14 CONFIGURATION section.
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:31 Page   2
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
    15 SOURCE-COMPUTER. microfocus.
    16 OBJECT-COMPUTER. microfocus.
    17 INPUT-OUTPUT section.
    18 FILE-CONTROL.
    19
20******************************************************************
    21******************************************************************
    22 select JURAD assign to P-file-name
    23     organization is line sequential
    24     file status is JURAD-fs.
    25
26******************************************************************
    27******************************************************************
    28 select ERRS assign to ERRS-file-name
    29     organization is line sequential
    30     file status is ERRS-fs.
    31
32******************************************************************
    33******************************************************************
*   34     copy BDIIREGI.FS.
    35* BDIIREGI.v.03.0001
    36*===============================================================
    37* ESTRUCTURA DEL ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
    38*===============================================================
    39 $SET IDXFORMAT"8"
    40
41$SET CONSTANT SW-STATUS-BDIIREGI"NO"
    42     SELECT BDIIREGI
    43ASSIGN TO DISK TITLE-BDIIREGI
    44ORGANIZATION IS INDEXED
    45ACCESS MODE IS DYNAMIC
    46RECORD KEY IS LLAVE-BDIIREGI
    47$IF SW-STATUS-BDIIREGI = "NO"
    48$DISPLAY ".............COMPILANDO BDIIREGI SIN STATUS.........."/^\*\*  1544     03 N-ale-eliminadaspic 9(8) value zero.
  1545*    Inserción de alerta existente
  1546     03 N-ale-ya-existepic 9(8) value zero.
  1547*    Modificación o eliminación de alerta inexistente
  1548     03 N-ale-no-existepic 9(8) value zero.
  1549
  1550******************************************************************
  1551* Armado de las lineas de alerta
  1552 01 LA-lineas-alerta.
  1553*    Los modelos a continuacion deberan obtenerse de un
  1554*    archivo, como BDIIALE-ALERTAS
  1555     03 LA-modelos.
  1556*12345678901234567890123456789012345678901234567890
  155705 pic x(50) value
  1558"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".
  155905 pic x(50) value
  1560"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
  156105 pic x(50) value
  1562"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".
  156305 pic x(50) value
  1564"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
  156505 pic x(50) value high-values. *< end marker
*  71-S*****************************************(   0)**
**    PROCEDURE DIVISION missing or unknown statement
  1566     03 LAendpic 999 comp value 0.
  1567     03 LA-modelos2redefines LA-modelos.
* 206-S******(  28)**
**    01 or 77 level required
  156805 LA-modelopic x(50) occurs 5
* 206-S**********(  28)**
**    01 or 77 level required
  1569indexed LAm.
  1570*    Funcionamiento de los templates.
  1571*    Hay dos templates por de alerta, uno por linea.
  1572*    Cada template consiste en hasta 10 frases fijas con
  1573*    ampersands (&) donde se van a reemplazar los valores.
  1574*    Por ejemplo:
  1575*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
  1576*    tiene 3 frases fijas y 2 reemplazos.
  1577*    La cantidad de ampersands es irrelevante, pero parece
  1578*    conveniente que informe sobre el tamaño del contenido.
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:31 Page  29
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1579     03 LA-templates.
* 206-S******(  28)**
**    01 or 77 level required
  158005 LA-templateoccurs 4 indexed LAx.
* 206-S**********(  29)**
**    01 or 77 level required:q/d/iccol/desarrollo $^[  /d/iccol/desarrollo $view /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo $riew /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo $rm  
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $rm   /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo $view /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/objetos/CARGAJUR* /d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print             /d/iccol/desarrollo $
/d/iccol/desarrollo/objetos/CARGAJUR.idy
find: cannot read dir /d/iccol/desarrollo/fuentes/especiales/darlas: Permission denied
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err
/d/iccol/desarrollo/fuentes/CARGAJUR.idy
/d/iccol/desarrollo/fuentes/CARGAJUR.lst
find: cannot read dir /d/iccol/desarrollo/stt: Permission denied
find: cannot read dir /d/iccol/desarrollo/sf/.sunw: Permission denied
find: cannot read dir /d/iccol/desarrollo/.ssh: Permission denied
/d/iccol/desarrollo $rm /d/iccol/desarrollo/objetos/CARGAJUR.idy
/d/iccol/desarrollo $vire /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err
ksh: vire:  not found
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $vire /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $vire /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $view
"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err" [Read only] 1153 lines, 70588 characters * Rejected - OPT
  156505 pic x(50) value high-values. *< end marker
*  71-S*****************************************(   0)**
**    PROCEDURE DIVISION missing or unknown statement
  1567     03 LA-modelos2redefines LA-modelos.
* 206-S******(  28)**
**    01 or 77 level required
  156805 LA-modelopic x(50) occurs 5
* 206-S**********(  28)**
**    01 or 77 level required
  1579     03 LA-templates.
* 206-S******(  28)**
**    01 or 77 level required
  158005 LA-templateoccurs 4 indexed LAx.
* 206-S**********(  29)**
**    01 or 77 level required
  158107 LA-partepic x(50)
* 206-S**************(  29)**
**    01 or 77 level required
  1584     03 LA-lineas.
* 206-S******(  29)**
**    01 or 77 level required
  158505 LA-linea1pic x(50).
* 206-S**********(  29)**
**    01 or 77 level required
  158605 LA-linea2pic x(50).
* 206-S**********(  29)**
**    01 or 77 level required
  1588     03 LA-valores.
* 206-S******(  29)**
**    01 or 77 level required
  1589LA-valorpic x(50)
*  71-S****************(  29)**
**    PROCEDURE DIVISION missing or unknown statement
  1592     03 LA-numpic -(11)0.
* 206-S******(  29)**
**    01 or 77 level required
  1593     03 LA-descartepic x(50).
* 206-S******(  29)**
**    01 or 77 level required
  1877     enf-if
*  12-S**********(  29)**
**    Operand ENF-IF is not declared
  2054     write BDIIALE-reg
*  12-S*********************(  35)**
**    Operand BDIIALE-REG is not declared
  2071     rewrite BDIIALE-reg
*  12-S***********************(  38)**
**    Operand BDIIALE-REG is not declared"/d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err" [Read only] 1153 lines, 70588 characters:q/d/iccol/desarrollo $^[  /d/iccol/desarrollo $view /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $miew /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $mirm  
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $rm   /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $view /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $vire /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $rm /d/iccol/desarrollo/objetos/CARGAJUR.idy      /d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print            /d/iccol/desarrollo $
find: cannot read dir /d/iccol/desarrollo/fuentes/especiales/darlas: Permission denied
/d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes/CARGAJUR.idy
/d/iccol/desarrollo/fuentes/CARGAJUR.lst
find: cannot read dir /d/iccol/desarrollo/stt: Permission denied
find: cannot read dir /d/iccol/desarrollo/sf/.sunw: Permission denied
find: cannot read dir /d/iccol/desarrollo/.ssh: Permission denied
/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/fuentes/CARGAJUR*
-rw-rw-r--   1 icdgd    icdatacr  108648 May 15 16:20 /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   47872 May 15 16:43 /d/iccol/desarrollo/fuentes/CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr  311232 May 15 16:43 /d/iccol/desarrollo/fuentes/CARGAJUR.lst
/d/iccol/desarrollo $view /d/iccol/desarrollo/fuentes/CARGAJUR.lst
"/d/iccol/desarrollo/fuentes/CARGAJUR.lst" [Read only] 5561 lines, 311232 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:43 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"/d/iccol/desarrollo/fuentes/CARGAJUR.lst" [Read only] 5561 lines, 311232 characters^  4518*end-if
  4519*end-perform
  4520*compute K-VALNOM = L-VALNOM/I-VALNOM
  4521*if (A-VALNOM >= 40 and K-VALNOM > 80) or
  4522*((A-VALNOM >= 35 and A-VALNOM < 40)
  4523*and K-VALNOM > 85) ORGJC0003
  4524*((A-VALNOM >= 25 and A-VALNOM < 35)
  4525*and K-VALNOM = 100)  GJC0003
  4526*add 1 to BLOQOK-AUX-VALNOM
  4527*end-if
  4528*end-if.
  4529
  4530
* Micro Focus Server ExpressV5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*REF GNR-015065005AF
* Last message on page:   87
* Total Messages:   386
* Unrecoverable :     0Severe  :   386
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:43 Page  95
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/VALNOM.PRO
* Errors:     0Warnings:     0
* Informational :     0Flags   :     0
* Data:170     Code:0
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:43 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^/^\*\*  1544     03 N-ale-eliminadaspic 9(8) value zero.
  1545*    Inserción de alerta existente
  1546     03 N-ale-ya-existepic 9(8) value zero.
  1547*    Modificación o eliminación de alerta inexistente
  1548     03 N-ale-no-existepic 9(8) value zero.
  1549
  1550******************************************************************
  1551* Armado de las lineas de alerta
  1552 01 LA-lineas-alerta.
  1553*    Los modelos a continuacion deberan obtenerse de un
  1554*    archivo, como BDIIALE-ALERTAS
  1555     03 LA-modelos.
  1556*12345678901234567890123456789012345678901234567890
  155705 pic x(50) value
  1558"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".
  155905 pic x(50) value
  1560"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
  156105 pic x(50) value
  1562"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".
  156305 pic x(50) value
  1564"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
  156505 pic x(50) value high-values. *< end marker
*  71-S*****************************************(   0)**
**    PROCEDURE DIVISION missing or unknown statement
  1566     03 LAendpic 999 comp value 0.
  1567     03 LA-modelos2redefines LA-modelos.
* 206-S******(  28)**
**    01 or 77 level required
  156805 LA-modelopic x(50) occurs 5
* 206-S**********(  28)**
**    01 or 77 level required
  1569indexed LAm.
  1570*    Funcionamiento de los templates.
  1571*    Hay dos templates por de alerta, uno por linea.
  1572*    Cada template consiste en hasta 10 frases fijas con
  1573*    ampersands (&) donde se van a reemplazar los valores.
  1574*    Por ejemplo:
  1575*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
  1576*    tiene 3 frases fijas y 2 reemplazos.
  1577*    La cantidad de ampersands es irrelevante, pero parece
  1578*    conveniente que informe sobre el tamaño del contenido.
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 16:43 Page  29
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1579     03 LA-templates.
* 206-S******(  28)**
**    01 or 77 level required
  158005 LA-templateoccurs 4 indexed LAx.
* 206-S**********(  29)**
**    01 or 77 level required:q^?^?
  ::q/d/iccol/desarrollo $vi CARGAJUR.CBL
"CARGAJUR.CBL" 2362 lines, 108648 characters $SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI"CARGAJUR.CBL" 2362 lines, 108648 characters/EL EMBARGO MAS REC*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Inserción de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificación o eliminación de alerta inexistente03 N-ale-no-existepic 9(8) value zero.******************************************************************
* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *< end marker03 LAendpic 999 comp value 0.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamaño del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
LA-valorpic x(50)
REPLACE 1 CHAR>/\>\*//<\*Address search hit BOTTOM without matching pattern</Address search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern/*</Address search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern*>:w"CARGAJUR.CBL" 2362 lines, 108648 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $vi CARGAJUR.CBLview /d/iccol/desarrollo/fuentes/CARGAJUR.lst/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/fuentes/CARGAJUR* /d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print             /d/iccol/desarrollo $rm   /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $view /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $vire /d/iccol/desarrollo/fuentes/CARGAJUR.CBL.err/d/iccol/desarrollo $rm /d/iccol/desarrollo/objetos/CARGAJUR.idy      /d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print            /d/iccol/desarrollo $rm   /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo $view /d/iccol/desarrollo/objetos/CARGAJUR.lst/d/iccol/desarrollo $ls -la /d/iccol/desarrollo/objetos/CARGAJUR* /d/iccol/desarrollo $find ~ -name "CARGAJUR*" -print             /d/iccol/desarrollo $cob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIREGI SIN status.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN status.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN status.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDIIALE SIN status.........."
  1567     03 LA-modelos2               redefines LA-modelos.
* 204-S*****************************************************           (   0)**
**    REDEFINES on incorrect field
  1588     03 LA-valores.
* 256-S******************                                              (  28)**
**    Preceding record has zero length
  1589         LA-valor                 pic x(50)
*  71-S****************                                                (  29)**
**    PROCEDURE DIVISION missing or unknown statement
  1592     03 LA-num                    pic -(11)0.
* 206-S******                                                          (  29)**
**    01 or 77 level required
  1593     03 LA-descarte               pic x(50).
* 206-S******                                                          (  29)**
**    01 or 77 level required
  1877     enf-if
*  12-S**********                                                      (  29)**
**    Operand ENF-IF is not declared
  2054     write BDIIALE-reg
*  12-S*********************                                           (  34)**
**    Operand BDIIALE-REG is not declared
  2071     rewrite BDIIALE-reg
*  12-S***********************                                         (  37)**
**    Operand BDIIALE-REG is not declared
  2120         move JURAD-demandas-vigentes to LA-num
*  12-S**********************************************                  (  37)**
**    Operand LA-NUM is not declared
  2121         unstring LA-num into LA-descarte LA-valor(1)
*  12-S***********************                                         (  38)**
**    Operand LA-NUM is not declared
  2123         move JURAD-demandas-terminadas to LA-num
*  12-S************************************************                (  38)**
**    Operand LA-NUM is not declared
  2124         unstring LA-num into LA-descarte LA-valor(2)
*  12-S***********************                                         (  38)**
**    Operand LA-NUM is not declared
  2126         string LA-parte(LAx, 1) LA-valor(1)
*  12-S****************************************                        (  38)**
**    Operand LA-VALOR is not declared
  2127         string LA-parte(LAx, 2) LA-valor(2)
*  12-S****************************************                        (  38)**
**    Operand LA-VALOR is not declared
  2128         string LA-parte(LAx, 3) LA-valor(3)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2129         string LA-parte(LAx, 4) LA-valor(4)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2130         string LA-parte(LAx, 5) LA-valor(5)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2131         string LA-parte(LAx, 6) LA-valor(6)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2132         string LA-parte(LAx, 7) LA-valor(7)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2133         string LA-parte(LAx, 8) LA-valor(8)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2134         string LA-parte(LAx, 9) LA-valor(9)
*  12-S****************************************                        (  39)**
**    Operand LA-VALOR is not declared
  2135         string LA-parte(LAx, 10) LA-valor(10)
*  12-S*****************************************                       (  39)**
**    Operand LA-VALOR is not declared
  2241     perform varying LAm frm 1 by 1
*  83-S***************************                                     (  39)**
**    Reserved word missing - FROM expected.
  2247         LA-parte(LAx, n) LA-parte(LAx, 6) LA-parte(LAx, 7)
*  12-S***********************                                         (  41)**
**    Operand N is not declared
  2252             inspect PA-parte(LAx, LAy) replacing trailing
*  12-S****************************                                    (  41)**
**    Operand PA-PARTE is not declared
  2254             inspect PA-parte(LAx, LAy) replacing first
*  12-S****************************                                    (  41)**
**    Operand PA-PARTE is not declared
  2257     end-perform.
* 564-S***************                                                 (  41)**
**    A scope-delimiter did not have a matching verb and was discarded.
* 348-S****************                                                (  41)**
**    Procedure name 1000-CARGA-TOTAL undeclared, line 2165 (first usage)
* 348-S******************                                              (  56)**
**    Procedure name 1000-ACTUALIZACION undeclared, line 2167 (first usage)
* Total Messages:    29
* Unrecoverable :     0                    Severe  :    29
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23428     Code:           0
  3172 80100-VALIDAR-IDENTIFICACION.
* 317-S****************************                                    (  56)**
**    Incorrect structure of PROCEDURE DIVISION
* Total Messages:    30
* Unrecoverable :     0                    Severe  :    30
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23428     Code:           0
* 143-S****************************                                    (  58)**
**    Unknown IDENTIFICATION DIVISION paragraph
  3179    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM
* 105-S*************                                                   (  58)**
**    PROGRAM-ID missing
*  12-S****************************************                        (  58)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3181    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
*  12-S***************************                                     (  58)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3182    IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  58)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3183       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  59)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3184    END-IF                                                        FAC0002
* 564-S*********                                                       (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3185    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  59)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3186       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  59)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3187    END-IF                                                        FAC0002
* 564-S*********                                                       (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3188    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  59)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3189       MOVE ZEROS TO SW-VALTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  59)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3190    END-IF                                                        FAC0002
* 564-S*********                                                       (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3191    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERIC                         FAC0003
*  12-S****************************                                    (  59)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3192       MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDE                       FAC0003
*  12-S******************************************                      (  59)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3193    END-IF                                                        FAC0003
* 564-S*********                                                       (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3194    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
*  12-S**********************                                          (  59)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3195      IF SW-ASGTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  59)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3197      END-IF                                                      FAC0002
* 564-S***********                                                     (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3198      IF SW-VALTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  59)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3200      END-IF                                                      FAC0002
* 564-S***********                                                     (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3201      IF SW-DIGCHEQUEO-BDIIVIDE = 1                               FAC0004
*  12-S******************************                                  (  59)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3203      END-IF                                                      FAC0004
* 564-S***********                                                     (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3204      IF SW-VALTIPID-BDIIVIDE = 0 OR                              FAC0004
*  12-S****************************                                    (  60)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3207       INITIALIZE NOM-VAL-BDIIVIDE
*  12-S*********************************                               (  60)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3208       MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE
*  12-S*****************************                                   (  60)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3209       IF SW-VERIFNOM-BDIIVIDE = 1
*  12-S*****************************                                   (  60)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3210          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM
*  12-S******************************                                  (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3211          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM
*  12-S*****************************                                   (  60)**
**    Operand NOMBRE-BDIIVIDE is not declared
  3212          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  60)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3213          IF SW-ID-BDIIVIDE = 0
*  12-S**************************                                      (  60)**
**    Operand SW-ID-BDIIVIDE is not declared
  3214             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND
*  12-S***********************************                             (  60)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3216                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
*  12-S****************************************                        (  60)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3217             ELSE IF TIP-ID-INPUT-VALNOM = 1
*  12-S***************************************                         (  60)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3218                     MOVE 2 TO BLOQUES-INPUT-VALNOM
*  12-S**************************************************              (  60)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3219                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM
*  12-S****************************************************            (  60)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3220                  END-IF
* 564-S***********************                                         (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3221             END-IF
* 564-S******************                                              (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3223             IF MATCH-OK-OUT-VALNOM = 0
*  12-S**********************************                              (  60)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3224                MOVE 1 TO SW-NOMBRES-BDIIVIDE
*  12-S********************************************                    (  60)**
**    Operand SW-NOMBRES-BDIIVIDE is not declared
  3225             END-IF
* 564-S******************                                              (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3226          END-IF
* 564-S***************                                                 (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3227       END-IF
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3228      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3229              MOVE 1 TO SW-ID-BDIIVIDE                            FAC0002
*  12-S*************************************                           (  61)**
**    Operand SW-ID-BDIIVIDE is not declared
  3230           END-IF                                                 FAC0002
* 564-S****************                                                (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3231      END-IF                                                      FAC0002
* 564-S***********                                                     (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3232    ELSE MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  61)**
**    Operand SW-ID-BDIIVIDE is not declared
  3233    END-IF.
* 564-S*********                                                       (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3243     EVALUATE TIP-IDE-BDIIVIDE
*  12-S*****************************                                   (  61)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3246       WHEN 2
* 368-S**********                                                      (  61)**
**    Exception phrase inappropriate
  3248       WHEN 3
* 368-S**********                                                      (  61)**
**    Exception phrase inappropriate
  3250       WHEN 4
* 368-S**********                                                      (  61)**
**    Exception phrase inappropriate
  3252       WHEN OTHER
* 368-S**********                                                      (  61)**
**    Exception phrase inappropriate
  3253         MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  61)**
**    Operand SW-ID-BDIIVIDE is not declared
  3254     END-EVALUATE.
* 564-S****************                                                (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3262    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002
*  12-S****************************************                        (  62)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3263    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3264      IF (NUM-IDE-BDIIVIDE-R >= 1 AND                             FAC0002
*  12-S***************************                                     (  62)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3268         MOVE 1 TO TIP-IDE-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3270        IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002
*  12-S*****************************                                   (  62)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3274           MOVE 2 TO TIP-IDE-BDIIVIDE                             FAC0002
*  12-S************************************                            (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3280          IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002
*  12-S*******************************                                 (  62)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3284             MOVE 3 TO TIP-IDE-BDIIVIDE                           FAC0002
*  12-S**************************************                          (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3285          ELSE MOVE 4 TO TIP-IDE-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3286          END-IF.                                                 FAC0002
* 564-S***************                                                 (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3296    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  62)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3297    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3298    EVALUATE TIP-IDE-BDIIVIDE                                     FAC0002
*  12-S****************************                                    (  63)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3300       IF NUM-IDE-BDIIVIDE-R > 9999999999                         FAC0002
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3301          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  63)**
**    Operand SW-TID-BDIIVIDE is not declared
  3302       END-IF                                                     FAC0002
* 564-S************                                                    (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3304       IF NUM-IDE-BDIIVIDE-R >  9999999999 OR                     FAC006C
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3306          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  63)**
**    Operand SW-TID-BDIIVIDE is not declared
  3307       END-IF                                                     FAC0002
* 564-S************                                                    (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3309       IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000           FAC0005
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3310          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  63)**
**    Operand SW-TID-BDIIVIDE is not declared
  3311       END-IF                                                     FAC0002
* 564-S************                                                    (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3312    END-EVALUATE.                                                 FAC0002
* 564-S***************                                                 (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3320      IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                     FAC0004
*  12-S***************************                                     (  63)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3324          MOVE 3 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  63)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3325      END-IF                                                      FAC0004
* 564-S***********                                                     (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3326      IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                     FAC0004
*  12-S***************************                                     (  64)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3330          MOVE 2 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  64)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3331      END-IF                                                      FAC0004
* 564-S***********                                                     (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3332      IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004
*  12-S*************************                                       (  64)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3339          MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDE            FAC0004
*  12-S******************************                                  (  64)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3340          MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R          FAC0004
*  12-S*********************************                               (  64)**
**    Operand NUM-ID-W10-BDIIVIDE is not declared
  3341      END-IF                                                      FAC0004
* 564-S***********                                                     (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3342      INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".          FAC0004
*  12-S*****************************                                   (  64)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3350     MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI
*  12-S*************************                                       (  64)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3351     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI
*  12-S*************************                                       (  64)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3352     READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  64)**
**    Operand BDIIREGI is not declared
*  12-S******************************************************          (  64)**
**    Operand SW-ID-BDIIVIDE is not declared
  3353     END-READ
* 564-S************                                                    (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3354     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  65)**
**    Operand SW-ID-BDIIVIDE is not declared
  3355        MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  65)**
**    Operand APELLIDO1-BDIIREGI is not declared
  3356        MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  65)**
**    Operand APELLIDO2-BDIIREGI is not declared
  3357        MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE
*  12-S********************************                                (  65)**
**    Operand DES-NOMBRE2-BDIIREGI is not declared
  3358        MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE
*  12-S********************************                                (  65)**
**    Operand DES-NOMBRE1-BDIIREGI is not declared
  3359        IF ESTADO-CIVIL-BDIIREGI = 0
*  12-S*******************************                                 (  65)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3361             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  65)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3368         END-IF
* 564-S**************                                                  (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3369         IF ESTADO-CIVIL-BDIIREGI = 1
*  12-S********************************                                (  65)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3373             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  65)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3380         END-IF
* 564-S**************                                                  (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3381         IF ESTADO-CIVIL-BDIIREGI = 2
*  12-S********************************                                (  65)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3385             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  65)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3392         END-IF
* 564-S**************                                                  (  66)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3393         STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S***************************************                         (  66)**
**    Operand PRIMER-APELLIDO-BDIIVIDE is not declared
  3399         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "
*  12-S********************************                                (  66)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3400         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "
*  12-S********************************                                (  66)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3401         INITIALIZE NOM-LEIDO-BDIIVIDE
*  12-S*************************************                           (  66)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3402         MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.
*  12-S*****************************                                   (  66)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3409     MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN
*  12-S*************************                                       (  66)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3410     READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  66)**
**    Operand BDIIDIAN is not declared
*  12-S******************************************************          (  66)**
**    Operand SW-ID-BDIIVIDE is not declared
  3411     END-READ
* 564-S************                                                    (  66)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3412     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  66)**
**    Operand SW-ID-BDIIVIDE is not declared
  3413        MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE
*  12-S********************************                                (  66)**
**    Operand DESCRIPCION-BDIIDIAN is not declared
  3414     END-IF.
* 564-S**********                                                      (  66)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3421     MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS
*  12-S*************************                                       (  67)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3422     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS
*  12-S*************************                                       (  67)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3423     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S****************                                                (  67)**
**    Operand BDIIDAS is not declared
*  12-S*****************************************************           (  67)**
**    Operand SW-ID-BDIIVIDE is not declared
  3424     END-READ
* 564-S************                                                    (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3425     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  67)**
**    Operand SW-ID-BDIIVIDE is not declared
  3426        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.
*  12-S**************************                                      (  67)**
**    Operand NOMBRE-BDIIDAS is not declared
  3742     MOVE 0 TO MATCH-OK-OUT-VALNOM.
*  12-S*********************************                               (  67)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3743     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  72)**
**    Operand NOMBRE-INPUT-VALNOM is not declared
  3744     IF TIP-ID-INPUT-VALNOM  = 2
*  12-S**************************                                      (  73)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3745         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S*********************************                               (  73)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3756         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  73)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3767         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  73)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3771         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  73)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3775         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
*  12-S******************************                                  (  73)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3777        INSPECT CADENA-VALNOM    REPLACING ALL
*  12-S****************************                                    (  73)**
**    Operand CADENA-VALNOM is not declared
  3783        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
*  12-S****************************                                    (  73)**
**    Operand CADENA-VALNOM is not declared
  3789                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  73)**
**    Operand I-VALNOM is not declared
  3791                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  74)**
**    Operand VNOM-AUX-VALNOM is not declared
  3793                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  74)**
**    Operand VNOM-AUX-VALNOM is not declared
  3794                  END-IF
* 564-S***********************                                         (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3795                END-PERFORM
* 564-S**************************                                      (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3796     END-IF.
* 564-S**********                                                      (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3797     MOVE SPACES TO VECTOR-INPUT-VALNOM.
*  12-S**************************************                          (  74)**
**    Operand VECTOR-INPUT-VALNOM is not declared
  3798     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  74)**
**    Operand CADENA-VALNOM is not declared
  3811     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  74)**
**    Operand NOMBOK-INPUT-VALNOM is not declared
  3812     IF TIP-ID-INPUT-VALNOM  NOT = 2
*  12-S**************************                                      (  74)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3813        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S********************************                                (  74)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3817                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  74)**
**    Operand I-VALNOM is not declared
  3819                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  74)**
**    Operand VNOM-AUX-VALNOM is not declared
  3821                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  75)**
**    Operand VNOM-AUX-VALNOM is not declared
  3822                  END-IF
* 564-S***********************                                         (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3823                END-PERFORM
* 564-S**************************                                      (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3825         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  75)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3836         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  75)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3847        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
*  12-S********************************                                (  75)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3851         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  75)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3852     END-IF.
* 564-S**********                                                      (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3853     MOVE SPACES TO VECTOR-OK-VALNOM.
*  12-S***********************************                             (  75)**
**    Operand VECTOR-OK-VALNOM is not declared
  3854     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  75)**
**    Operand CADENA-VALNOM is not declared
  3865     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  75)**
**    Operand I-VALNOM is not declared
  3866     MOVE 0 TO BLOQOK-AUX-VALNOM.
*  12-S*******************************                                 (  76)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3867     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
*  12-S*********************************                               (  76)**
**    Operand VM-INPUT-VALNOM is not declared
  3868       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  76)**
**    Operand J-VALNOM is not declared
  3869       PERFORM UNTIL J-VALNOM > 20
*  12-S****************************                                    (  76)**
**    Operand J-VALNOM is not declared
  3870         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
*  12-S**************************                                      (  76)**
**    Operand VM-INPUT-VALNOM is not declared
  3871            ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*************************************                           (  76)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3872            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S**************************************                          (  76)**
**    Operand VM-OK-VALNOM is not declared
  3874            MOVE 21 TO J-VALNOM
*  12-S******************************                                  (  76)**
**    Operand J-VALNOM is not declared
  3876            MOVE 0 TO M-VALNOM
*  12-S*****************************                                   (  76)**
**    Operand M-VALNOM is not declared
  3877            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S*******************************                                 (  76)**
**    Operand VM-OK-VALNOM is not declared
  3879            IF M-VALNOM >= 15
*  12-S**********************                                          (  76)**
**    Operand M-VALNOM is not declared
  3880               MOVE 0 TO M-VALNOM
*  12-S********************************                                (  76)**
**    Operand M-VALNOM is not declared
  3881               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S**********************************                              (  76)**
**    Operand VM-OK-VALNOM is not declared
  3883            END-IF
* 564-S*****************                                               (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3884            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
*  12-S**********************                                          (  77)**
**    Operand M-VALNOM is not declared
  3886               COMPUTE INI-VALNOM = M-VALNOM + 2
*  12-S********************************                                (  77)**
**    Operand INI-VALNOM is not declared
  3887               COMPUTE LON-VALNOM = 14 - M-VALNOM
*  12-S********************************                                (  77)**
**    Operand LON-VALNOM is not declared
  3888               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
*  12-S*******************************                                 (  77)**
**    Operand VM-OK-VALNOM is not declared
  3889               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
*  12-S******************************                                  (  77)**
**    Operand PEDAZO-VALNOM is not declared
  3893                  ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*******************************************                     (  77)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3894                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S********************************************                    (  77)**
**    Operand VM-OK-VALNOM is not declared
  3896                  MOVE 21 TO J-VALNOM
*  12-S************************************                            (  77)**
**    Operand J-VALNOM is not declared
  3897                  ADD 1 TO I-VALNOM
*  12-S**********************************                              (  77)**
**    Operand I-VALNOM is not declared
  3898                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  77)**
**    Operand VM-INPUT-VALNOM is not declared
  3899               END-IF
* 564-S********************                                            (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3900            END-IF
* 564-S*****************                                               (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3901         END-IF
* 564-S**************                                                  (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3902         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  77)**
**    Operand J-VALNOM is not declared
  3903       END-PERFORM
* 564-S*****************                                               (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3904       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  77)**
**    Operand I-VALNOM is not declared
  3905       IF I-VALNOM = 21
*  12-S*****************                                               (  77)**
**    Operand I-VALNOM is not declared
  3907       END-IF
* 564-S************                                                    (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3908     END-PERFORM.
* 564-S***************                                                 (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3909     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S************************                                        (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3910        MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S************************************                            (  78)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3912        IF TIP-ID-INPUT-VALNOM <> 2
*  12-S*****************************                                   (  78)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3914        ELSE
* 562-S***********                                                     (  78)**
**    An "ELSE" phrase did not have a matching IF and was discarded.
  3916        END-IF
* 564-S*************                                                   (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3917        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S***************************                                     (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3918           MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S***************************************                         (  78)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3919        END-IF
* 564-S*************                                                   (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3920     END-IF.
* 564-S**********                                                      (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3928     IF BLOQOK-AUX-VALNOM > 0
*  12-S************************                                        (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3929        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  78)**
**    Operand APROX-TOT-VALNOM is not declared
  3931        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  78)**
**    Operand APROX-TOT-VALNOM is not declared
  3932     END-IF
* 564-S**********                                                      (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3933     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  78)**
**    Operand I-VALNOM is not declared
  3934     PERFORM UNTIL I-VALNOM > 10
*  12-S**************************                                      (  79)**
**    Operand I-VALNOM is not declared
  3935       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  79)**
**    Operand J-VALNOM is not declared
  3936       PERFORM UNTIL J-VALNOM > 10
*  12-S****************************                                    (  79)**
**    Operand J-VALNOM is not declared
  3937         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
*  12-S**********************************                              (  79)**
**    Operand LETRAS-OK-VALNOM is not declared
  3938         MOVE 1 TO K-VALNOM
*  12-S**************************                                      (  79)**
**    Operand K-VALNOM is not declared
  3939         MOVE 1 TO L-VALNOM
*  12-S**************************                                      (  79)**
**    Operand L-VALNOM is not declared
  3940         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
*  12-S**************************                                      (  79)**
**    Operand VM-INPUT-VALNOM is not declared
  3942            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  79)**
**    Operand K-VALNOM is not declared
  3943              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  79)**
**    Operand VMM-INPUT-VALNOM is not declared
  3948                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
*  12-S********************************                                (  79)**
**    Operand VMM-OK-VALNOM is not declared
  3949                    ADD 1 TO LETRAS-OK-VALNOM
*  12-S********************************************                    (  79)**
**    Operand LETRAS-OK-VALNOM is not declared
  3950                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  79)**
**    Operand K-VALNOM is not declared
  3951                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  79)**
**    Operand L-VALNOM is not declared
  3953                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  79)**
**    Operand K-VALNOM is not declared
  3954                 END-IF
* 564-S**********************                                          (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3956                 ADD 1   TO K-VALNOM
*  12-S***********************************                             (  79)**
**    Operand K-VALNOM is not declared
  3957                 IF K-VALNOM <= 15 AND L-VALNOM < 15
*  12-S***************************                                     (  79)**
**    Operand K-VALNOM is not declared
  3958                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
*  12-S**************************************                          (  80)**
**    Operand VMM-INPUT-VALNOM is not declared
  3960                       ADD 1 TO L-VALNOM
*  12-S***************************************                         (  80)**
**    Operand L-VALNOM is not declared
  3961                    END-IF
* 564-S*************************                                       (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3962                 END-IF
* 564-S**********************                                          (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3963              END-IF
* 564-S*******************                                             (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3964            END-PERFORM
* 564-S**********************                                          (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3965            MOVE 1 TO K-VALNOM
*  12-S*****************************                                   (  80)**
**    Operand K-VALNOM is not declared
  3966            MOVE 1 TO L-VALNOM
*  12-S*****************************                                   (  80)**
**    Operand L-VALNOM is not declared
  3967            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  80)**
**    Operand K-VALNOM is not declared
  3968              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  80)**
**    Operand VMM-INPUT-VALNOM is not declared
  3973                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
*  12-S********************************                                (  80)**
**    Operand VMM-OK-VALNOM is not declared
  3974                    ADD 1 TO LETRAS-OK2-VALNOM
*  12-S*********************************************                   (  80)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3975                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  80)**
**    Operand K-VALNOM is not declared
  3976                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  80)**
**    Operand L-VALNOM is not declared
  3978                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  80)**
**    Operand K-VALNOM is not declared
  3979                 END-IF
* 564-S**********************                                          (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3981                 ADD 1   TO L-VALNOM
*  12-S***********************************                             (  80)**
**    Operand L-VALNOM is not declared
  3982                 IF L-VALNOM <= 15 AND K-VALNOM < 15
*  12-S***************************                                     (  81)**
**    Operand L-VALNOM is not declared
  3983                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S**************************************                          (  81)**
**    Operand VMM-INPUT-VALNOM is not declared
  3985                       ADD 1 TO K-VALNOM
*  12-S***************************************                         (  81)**
**    Operand K-VALNOM is not declared
  3986                    END-IF
* 564-S*************************                                       (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3987                 END-IF
* 564-S**********************                                          (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3988              END-IF
* 564-S*******************                                             (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3989            END-PERFORM
* 564-S**********************                                          (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3990         END-IF
* 564-S**************                                                  (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3991         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
*  12-S****************************                                    (  81)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3992            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
*  12-S*********************************                               (  81)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3993         END-IF
* 564-S**************                                                  (  81)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3994         IF LETRAS-OK-VALNOM > 0
*  12-S***************************                                     (  81)**
**    Operand LETRAS-OK-VALNOM is not declared
  3995            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
*  12-S**************************************                          (  81)**
**    Operand TOTLET-INP-VALNOM is not declared
  3996            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
*  12-S**********************************                              (  81)**
**    Operand VM-INPUT-VALNOM is not declared
  3999            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
*  12-S*******************************                                 (  81)**
**    Operand VM-OK-VALNOM is not declared
  4002            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
*  12-S***********************************                             (  81)**
**    Operand POR-TOT-VALNOM is not declared
  4003            IF TOTLET-OK-VALNOM >= 3
*  12-S******************************                                  (  81)**
**    Operand TOTLET-OK-VALNOM is not declared
  4004               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  81)**
**    Operand POR-TOT-VALNOM is not declared
  4006            END-IF
* 564-S*****************                                               (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4007            IF TOTLET-INP-VALNOM >= 3
*  12-S*******************************                                 (  82)**
**    Operand TOTLET-INP-VALNOM is not declared
  4008               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  82)**
**    Operand POR-INP-VALNOM is not declared
  4010            END-IF
* 564-S*****************                                               (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4011            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
*  12-S******************************                                  (  82)**
**    Operand TOTLET-OK-VALNOM is not declared
  4012               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
*  12-S******************************                                  (  82)**
**    Operand A-VALNOM is not declared
  4015               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
*  12-S******************************                                  (  82)**
**    Operand A-VALNOM is not declared
  4017            END-IF
* 564-S*****************                                               (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4018            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
*  12-S******************************                                  (  82)**
**    Operand POR-TOT-VALNOM is not declared
  4028               ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S****************************************                        (  82)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4029               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S*****************************************                       (  82)**
**    Operand VM-OK-VALNOM is not declared
  4031            END-IF
* 564-S*****************                                               (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4032         END-IF
* 564-S**************                                                  (  82)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4033         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  82)**
**    Operand J-VALNOM is not declared
  4034       END-PERFORM
* 564-S*****************                                               (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4035       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  83)**
**    Operand I-VALNOM is not declared
  4036     END-PERFORM.
* 564-S***************                                                 (  83)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4044   MOVE ZEROS TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  83)**
**    Operand TOTLET-INP-VALNOM is not declared
  4045   MOVE ZEROS TO LETRAS-OK2-VALNOM
*  12-S*********************************                               (  83)**
**    Operand LETRAS-OK2-VALNOM is not declared
  4046    MOVE ZEROS TO A-VALNOM                                        GJC0003
*  12-S*************************                                       (  83)**
**    Operand A-VALNOM is not declared
  4047   MOVE 1 TO K-VALNOM
*  12-S********************                                            (  83)**
**    Operand K-VALNOM is not declared
  4048   PERFORM UNTIL K-VALNOM > 65
*  12-S************************                                        (  83)**
**    Operand K-VALNOM is not declared
  4049     MOVE K-VALNOM  TO I-VALNOM
*  12-S*****************                                               (  83)**
**    Operand K-VALNOM is not declared
  4050     MOVE 1       TO J-VALNOM
*  12-S****************************                                    (  83)**
**    Operand J-VALNOM is not declared
  4051     MOVE ZEROS TO LETRAS-OK-VALNOM
*  12-S**********************************                              (  83)**
**    Operand LETRAS-OK-VALNOM is not declared
  4052     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
*  12-S**************************                                      (  83)**
**    Operand J-VALNOM is not declared
  4053        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S*************************                                       (  83)**
**    Operand V-NOMBRE-VALNOM is not declared
  4055           IF V-NOMBRE-VALNOM(I-VALNOM) =
*  12-S****************************                                    (  83)**
**    Operand V-NOMBRE-VALNOM is not declared
  4057              ADD 1 TO LETRAS-OK-VALNOM
*  12-S**************************************                          (  83)**
**    Operand LETRAS-OK-VALNOM is not declared
  4058              ADD 1 TO I-VALNOM
*  12-S******************************                                  (  83)**
**    Operand I-VALNOM is not declared
  4059              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  83)**
**    Operand J-VALNOM is not declared
  4061              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  84)**
**    Operand J-VALNOM is not declared
  4062           END-IF
* 564-S****************                                                (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4064           ADD 1 TO I-VALNOM
*  12-S***************************                                     (  84)**
**    Operand I-VALNOM is not declared
  4065        END-IF
* 564-S*************                                                   (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4066     END-PERFORM
* 564-S***************                                                 (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4067     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
*  12-S***********************                                         (  84)**
**    Operand LETRAS-OK-VALNOM is not declared
  4068        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
*  12-S****************************                                    (  84)**
**    Operand LETRAS-OK-VALNOM is not declared
  4069     END-IF
* 564-S**********                                                      (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4070     ADD 1 TO K-VALNOM
*  12-S*********************                                           (  84)**
**    Operand K-VALNOM is not declared
  4071   END-PERFORM.
* 564-S*************                                                   (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4072   MOVE 1 TO I-VALNOM
*  12-S********************                                            (  84)**
**    Operand I-VALNOM is not declared
  4073   PERFORM UNTIL I-VALNOM > 65
*  12-S************************                                        (  84)**
**    Operand I-VALNOM is not declared
  4074     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S**********************                                          (  84)**
**    Operand V-NOMBRE-VALNOM is not declared
  4076        ADD 1 TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  84)**
**    Operand TOTLET-INP-VALNOM is not declared
  4077     END-IF
* 564-S**********                                                      (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4078     ADD 1 TO I-VALNOM
*  12-S*********************                                           (  84)**
**    Operand I-VALNOM is not declared
  4079   END-PERFORM.
* 564-S*************                                                   (  84)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4080   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
*  12-S******************                                              (  84)**
**    Operand A-VALNOM is not declared
  4082   IF A-VALNOM >= 75
*  12-S*************                                                   (  85)**
**    Operand A-VALNOM is not declared
  4083       ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S********************************                                (  85)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4084   END-IF.
* 564-S********                                                        (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4085    MOVE 0 TO K-VALNOM                                            GJC0003
*  12-S*********************                                           (  85)**
**    Operand K-VALNOM is not declared
  4086   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
*  12-S**********************                                          (  85)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4087      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
*  12-S************************                                        (  85)**
**    Operand A-VALNOM is not declared
  4088      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
*  12-S*****************************                                   (  85)**
**    Operand J-VALNOM is not declared
  4089               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  85)**
**    Operand V-NOMBRE-VALNOM is not declared
  4090                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  85)**
**    Operand V-NOMBRE-VALNOM is not declared
  4092                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
*  12-S**********************************************                  (  85)**
**    Operand CONT-LET-INPUT-VALNOM is not declared
  4093              END-IF                                              GJC0003
* 564-S*******************                                             (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4094               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  85)**
**    Operand V-NOMBOK-VALNOM is not declared
  4095                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  85)**
**    Operand V-NOMBOK-VALNOM is not declared
  4097                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
*  12-S*******************************************                     (  85)**
**    Operand CONT-LET-OK-VALNOM is not declared
  4098              END-IF                                              GJC0003
* 564-S*******************                                             (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4099      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  85)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4100      MOVE 0 TO I-VALNOM                                          GJC0003
*  12-S***********************                                         (  85)**
**    Operand I-VALNOM is not declared
  4101       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
*  12-S******************************                                  (  85)**
**    Operand J-VALNOM is not declared
  4102         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
*  12-S*****************************                                   (  86)**
**    Operand CONT-LET-OK-VALNOM is not declared
  4103            ADD 1 TO I-VALNOM                                     GJC0003
*  12-S****************************                                    (  86)**
**    Operand I-VALNOM is not declared
  4104            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
*  12-S********************************                                (  86)**
**    Operand CONT-LET-OK-VALNOM is not declared
  4106               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
*  12-S******************************                                  (  86)**
**    Operand L-VALNOM is not declared
  4108               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
*  12-S******************************                                  (  86)**
**    Operand L-VALNOM is not declared
  4111            END-IF                                                GJC0003
* 564-S*****************                                               (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4112         END-IF                                                   GJC0003
* 564-S**************                                                  (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4113      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4114      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
*  12-S*********************                                           (  86)**
**    Operand K-VALNOM is not declared
  4115       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
*  12-S******************                                              (  86)**
**    Operand A-VALNOM is not declared
  4118         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
*  12-S**********************************                              (  86)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  4119       END-IF                                                     GJC0003
* 564-S************                                                    (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
  4120   END-IF.                                                        GJC0003
* 564-S********                                                        (  86)**
**    A scope-delimiter did not have a matching verb and was discarded.
* Total Messages:   371
* Unrecoverable :     0                    Severe  :   371
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:         170     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $:q
ksh: :q:  not found
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Inserción de alerta existente03 N-ale-ya-existepic 9(8) value zero.
*    Modificación o eliminación de alerta inexistente03 N-ale-no-existepic 9(8) value zero.******************************************************************
* Armado de las lineas de alerta
01 LA-lineas-alerta.
*    Los modelos a continuacion deberan obtenerse de un
*    archivo, como BDIIALE-ALERTAS03 LA-modelos.
*1234567890123456789012345678901234567890123456789005 pic x(50) value"TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS".05 pic x(50) value"LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".05 pic x(50) value"TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES".05 pic x(50) value"EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".05 pic x(50) value high-values. *> end marker03 LAendpic 999 comp value 0.03 LA-modelos2redefines LA-modelos.05 LA-modelopic x(50) occurs 5
indexed LAm.
*    Funcionamiento de los templates.
*    Hay dos templates por de alerta, uno por linea.
*    Cada template consiste en hasta 10 frases fijas con
*    ampersands (&) donde se van a reemplazar los valores.
*    Por ejemplo:
*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
*    tiene 3 frases fijas y 2 reemplazos.
*    La cantidad de ampersands es irrelevante, pero parece
*    conveniente que informe sobre el tamaño del contenido.03 LA-templates.
05 LA-templateoccurs 4 indexed LAx.07 LA-partepic x(50)
occurs 10 indexed LAy.
*    Las dos lineas armadas03 LA-lineas.
05 LA-linea1pic x(50).05 LA-linea2pic x(50).
*    Los valores a insertar en una linea03 LA-valores.
LA-valorpic x(50)$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    ACTALEJUR.
******************************************************************
* Actualización del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-nameorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.
* TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *assign to disk TITLE-BDIIREGI
c     *organization is indexed
c     *access mode is dynamic
c     *record key is LLAVE-BDIIREGI
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
2362 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    ACTALEJUR.



      ******************************************************************
      * Actualización del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-name
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.
      * TODO: debe compilar con file status
c     $SET CONSTANT SW-STATUS-BDIIREGI"SI"
c     * BDIIREGI.v.03.0001
c     ******************************************************************
c     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL
c     * Equivale al Registro Civil de Argentina, contiene los ids de
c     * gente
c     ******************************************************************
c     $SET IDXFORMAT"8"
c     $SET CONSTANT SW-STATUS-BDIIREGI"NO"
c     *    select BDIIREGI
c     *        assign to disk TITLE-BDIIREGI
c     *        organization is indexed
c     *        access mode is dynamic

c     *        record key is LLAVE-BDIIREGI

APPEND MODEc     $if SW-STATUS-BDIIREGI = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIREGI SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIREGI CON status.........."

APPEND MODEc     *        file status is COD-RETORNO-BDIIREGI

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODEc     $SET IDXFORMAT"0"

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FS.

APPEND MODEc     * BDIIDIAN.v.03.0001

APPEND MODEc     * MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADA

APPEND MODEc     * POR LA DIAN

APPEND MODEc     * DIAN equivale a la AFIP de Argentina, contiene ids de empresas

APPEND MODEc     ******************************************************************

APPEND MODEc     $SET CONSTANT SW-STATUS-BDIIDIAN"NO"

APPEND MODEc     *    select BDIIDIAN assign to disk TITLE-BDIIDIAN

APPEND MODEc     *        organization is indexed

APPEND MODEc     *        access mode  is dynamic

APPEND MODEc     *        record key   is LLAVE-BDIIDIAN

APPEND MODEc     $if SW-STATUS-BDIIDIAN = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIDIAN SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIDIAN CON status.........."

APPEND MODEc     *        file status is COD-RETORNO-BDIIDIAN

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODE 

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FS.

APPEND MODEc     * BDIIDAS.v.03.0001

APPEND MODEc     *=================================================================

APPEND MODEc     * MAESTRO DE CEDULAS DE EXTRANJERIA, PROPORCIONADAS POR EL DAS

APPEND MODEc     * Equivale a la SIDE de Argentina, provee ids de extranjeros

APPEND MODEc     *=================================================================

APPEND MODEc     $SET CONSTANT SW-STATUS-BDIIDAS"NO"

APPEND MODEc     *    select BDIIDAS assign to disk TITLE-BDIIDAS

APPEND MODEc     *        organization is indexed

APPEND MODEc     *        access mode is dynamic

APPEND MODEc     *        record key is LLAVE-BDIIDAS

APPEND MODEc     $if SW-STATUS-BDIIDAS = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIDAS SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIDAS CON status.........."

APPEND MODEc     *        file status is COD-RETORNO-BDIIDAS

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE           copy BDIIALE.FS replacing == on record.== by == on record

APPEND MODE              file status is EST-BDIIALE.==.

APPEND MODEc     * BDIIALE-FS.v01.0001

APPEND MODEc     * Maestro de alertas reportadas por suscriptotres

APPEND MODEc     * Suscriptores son bancos, financieras y otros clientes de

APPEND MODEc     * Datacredito

APPEND MODEc

APPEND MODEc     $SET CONSTANT SW-STATUS-BDIIALE"NO"

APPEND MODEc     *    select BDIIALE

APPEND MODEc     *        assign to disk MAES-BDIIALE-TITLE

APPEND MODEc     *        organization is indexed

APPEND MODEc     *        access mode is dynamic

APPEND MODEc     *        record key is LLAVE-BDIIALE

APPEND MODEc     $if SW-STATUS-BDIIALE = "NO"

APPEND MODEc     $display ".............COMPILANDO BDIIALE SIN status.........."

APPEND MODEc     $else

APPEND MODEc     $display ".............COMPILANDO BDIIALE CON status.........."

APPEND MODEc     *        file status is EST-BDIIALE

APPEND MODEc     $end

APPEND MODEc     *        lock mode is manual with lock on record.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(6).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(6).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(6).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODEc     * BDIIREGI.v.03.0006

APPEND MODEc     ******************************************************************

APPEND MODEc     * ESTRUCTURA del ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL

APPEND MODEc     ******************************************************************

APPEND MODEc     *FD  BDIIREGI.

APPEND MODEc     *01  REG-BDIIREGI.

APPEND MODEc     *    03  LLAVE-BDIIREGI          pic 9(12).

APPEND MODEc     *    03  LLAVE-BDIIREGI-R        redefines LLAVE-BDIIREGI.

APPEND MODEc     *        05  TIPO-ID-BDIIREGI    pic 9.

APPEND MODEc     *        05  CEDULA-BDIIREGI     pic 9(11).

APPEND MODEc     *    03  DES-NOMBRE1-BDIIREGI    pic X(12).

APPEND MODEc     *    03  DES-NOMBRE2-BDIIREGI    pic X(12).

APPEND MODEc     *    03  APELLIDO1-BDIIREGI      pic X(16).

APPEND MODEc     *    03  APELLIDO2-BDIIREGI      pic X(16).

APPEND MODEc     *    03  ESTADO-CIVIL-BDIIREGI   pic 9.

APPEND MODEc     *    03  FECHA-EXPEDI-BDIIREGI.

APPEND MODEc     *        05  SIGLO-EXP-BDIIREGI  pic 9(2).

APPEND MODEc     *        05  FECHA-EXP-BDIIREGI  pic 9(6).

APPEND MODEc     *    03  INF-NUMERICA-BDIIREGI   pic 9(7).

APPEND MODEc     *    03  INF-NUMERICA-BDIIREGI-R redefines INF-NUMERICA-BDIIREGI.

APPEND MODEc     *        05 DEP-EXP-BDIIREGI     pic 99.

APPEND MODEc     *        05 MUNIC-EXP-BDIIREGI   pic 999.

APPEND MODEc     *        05 ESTADO-VIG-BDIIREGI  pic 99.

APPEND MODEc     *    03  FECHA-NACIMNTO-BDIIREGI.

APPEND MODEc     *        05  SIGLO-NAC-BDIIREGI  pic 9(2).

APPEND MODEc     *        05  FECHA-NAC-BDIIREGI  pic 9(6).

APPEND MODEc     *    03  FECHA-EDICTO-BDIIREGI.

APPEND MODEc     *        05  SIGLO-EDI-BDIIREGI  pic 9(2).

APPEND MODEc     *        05  FECHA-EDI-BDIIREGI  pic 9(6).

APPEND MODEc     *    03  IND-SEXO-BDIIREGI       pic X.

APPEND MODEc     *    03  IND-ESTADO-BDIIREGI     pic 9.

APPEND MODEc     *    03  NUM-RESOLUC-BDIIREGI    pic 9(4).

APPEND MODEc     *    03  ANO-RESOLUC-BDIIREGI    pic 9(2).

APPEND MODEc     *    03  BLOQUEO-TUTELA-BDIIREGI pic X(1).

APPEND MODEc     *    03  FECHA-CREAC-BDIIREGI    pic 9(8).

APPEND MODEc     *    03  FECHA-MODIF-BDIIREGI    pic 9(8).

APPEND MODEc     *    03  IND-MODIF-BDIIREGI      pic X(1).

APPEND MODEc     *    03  IND-CREACION-BDIIREGI redefines

APPEND MODEc     *             IND-MODIF-BDIIREGI pic X(1).

APPEND MODEc     *    03  IND-CAMBIO-BDIIREGI     pic X(1).

APPEND MODEc     *    03  IND-CONSULADO-BDIIREGI  pic 9(1).

APPEND MODEc     *    03  COD-CONSULADO-BDIIREGI  pic 9(3).

APPEND MODEc     *    03  ES-IND-CAMARA-BDIIREGI  pic 9(1).

APPEND MODEc     *    03  ES-IND-BURO-BDIIREGI    pic 9(1).

APPEND MODEc     *    03  FILLER-BDIIREGI         pic X(27).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODEc     * BDIIDIAN.v.03.0004

APPEND MODEc     ******************************************************************

APPEND MODEc     *FD  BDIIDIAN.

APPEND MODEc     *01  REG-BDIIDIAN.

APPEND MODEc     *    03 LLAVE-BDIIDIAN.

APPEND MODEc     *       05 NITS-BDIIDIAN            pic X(11).

APPEND MODEc     *       05 NITS-R-BDIIDIAN redefines NITS-BDIIDIAN

APPEND MODEc     *                                   pic 9(11).

APPEND MODEc     *    03 DIGITO-CONTROL-BDIIDIAN     pic X(01).

APPEND MODEc     *    03 DESCRIPCION1-BDIIDIAN       pic X(80).

APPEND MODEc     *    03 DESCRIPCION1-BDIIDIAN-R redefines DESCRIPCION1-BDIIDIAN.

APPEND MODEc     *       05 DESCRIPCION-BDIIDIAN     pic X(79).

APPEND MODEc     *       05 ESTADO-BDIIDIAN          pic 9.

APPEND MODEc     *    03 COD-CIIU-BDIIDIAN           pic 9(4).

APPEND MODEc     *    03 FEC-INSCRIP-BDIIDIAN        pic 9(8).

APPEND MODEc     *    03 FECHA-CREAC-BDIIDIAN        pic 9(8).

APPEND MODEc     *    03 FECHA-MODIF-BDIIDIAN        pic 9(8).

APPEND MODEc     *    03 IND-MODIF-BDIIDIAN          pic X(1).

APPEND MODEc     *    03 ES-CLIENTE-DATACR-BDIIDIAN  pic X(1). *> S,N

APPEND MODEc     *    03 VE-INDEPENDIENTES-BDIIDIAN  pic X(1). *> S,N

APPEND MODEc     *    03 FECHA-MODIF-INDE-BDIIDIAN   pic 9(04). *> AAMM

APPEND MODEc     *    03 FILLER-BDIIDIAN             pic X(19).

APPEND MODEc     *    03 FILLER-BDIIDIAN             pic X(13).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODEc     * BDIIDAS.v.03.0002

APPEND MODEc     ******************************************************************

APPEND MODEc     *FD  BDIIDAS.

APPEND MODEc     *01  REG-BDIIDAS.

APPEND MODEc     *    03 LLAVE-BDIIDAS.

APPEND MODEc     *       05 TIPO-ID-BDIIDAS           pic 9.

APPEND MODEc     *       05 NUM-ID-BDIIDAS            pic 9(11).

APPEND MODEc     *    03 NACIO-BDIIDAS                pic X(15).

APPEND MODEc     *    03 NOMBRE-BDIIDAS               pic X(45).

APPEND MODEc     *    03 FECHA-CREAC-BDIIDAS          pic 9(8).

APPEND MODEc     *    03 FECHA-MODIF-BDIIDAS          pic 9(8).

APPEND MODEc     *    03 IND-MODIF-BDIIDAS            pic X(1).

APPEND MODEc     *    03 FILLER-BDIIDAS               pic X(31).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODEc     * BDIIALE-FD.v01.0003.

APPEND MODEc     *****************************************************************

APPEND MODEc     *FD BDIIALE.

APPEND MODEc     *01 REG-BDIIALE.

APPEND MODEc     *   02 LLAVE-BDIIALE.

APPEND MODEc     *      03 TIP-IDE-BDIIALE        pic 9(01).

APPEND MODEc     *      03 NUM-IDE-BDIIALE        pic 9(11).

APPEND MODEc     *      03 FUENTE-BDIIALE         pic 9(06).

APPEND MODEc     *      03 COD-ALERTA-BDIIALE     pic 9(03).

APPEND MODEc     *      03 LLASEC-BDIIALE         pic X(08).

APPEND MODEc     *   02 ENCABEZADO-BDIIALE.

APPEND MODEc     *      03 FEC-NOV-BDIIALE        pic 9(08).

APPEND MODEc     *      03 FEC-VEN-BDIIALE        pic 9(08).

APPEND MODEc     *      03 FEC-REP-BDIIALE        pic 9(08).

APPEND MODEc     *      03 BLOQUEO-BDIIALE        pic 9(01).

APPEND MODEc     *      03 FILLER-BDIIALE         pic X(10).

APPEND MODEc     *      03 INF-DATAHOST-BDIIALE   pic X(18).

APPEND MODEc     *      03 LINEAS-BDIIALE.

APPEND MODEc     *         04 LINEA1-BDIIALE      pic X(50).

APPEND MODEc     *         04 LINEA2-BDIIALE      pic X(50).

APPEND MODEc     *      03 filler redefines LINEAS-BDIIALE.

APPEND MODEc     *         04 DATOS-BDIIALE       pic X(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODEc     *BDIIVIDE.WS.v03.0003.

APPEND MODEc     ******************************************************************

APPEND MODEc     *01  NUM-ID-W-BDIIVIDE.

APPEND MODEc     *    03  NUM-ID-W11-BDIIVIDE           pic 9(11) value zeros.

APPEND MODEc     *    03  NUM-ID-W11-R-BDIIVIDE redefines NUM-ID-W11-BDIIVIDE.

APPEND MODEc     *        05 NUM-ID-W10-BDIIVIDE        pic 9(10).

APPEND MODEc     *        05 RESTO-NUM-ID-BDIIVIDE      pic 9.

APPEND MODEc     *01  NOMBRES-AUX-W-BDIIVIDE.

APPEND MODEc     *    03 PRIMER-APELLIDO-BDIIVIDE       pic X(15) value spaces.

APPEND MODEc     *    03 SEGUNDO-APELLIDO-BDIIVIDE      pic X(15) value spaces.

APPEND MODEc     *    03 PRIMER-NOMBRE-BDIIVIDE         pic X(15) value spaces.

APPEND MODEc     *    03 SEGUNDO-NOMBRE-BDIIVIDE        pic X(15) value spaces.

APPEND MODEc     *    03 NOM-LEIDO-BDIIVIDE             pic X(65) value spaces.

APPEND MODEc     *

APPEND MODEc     *01 PARAMETROS-ENTRADA-BDIIVIDE        pic X(100) value spaces.

APPEND MODEc     *01 PARAMETROS-ENTRADA-R-BDIIVIDE redefines

APPEND MODEc     *                                     PARAMETROS-ENTRADA-BDIIVIDE.

APPEND MODEc     *    03 TIP-IDE-BDIIVIDE               pic X.

APPEND MODEc     *    03 NUM-IDE-BDIIVIDE               pic X(11) JUSTIFIED right.

APPEND MODEc     *    03 NUM-IDE-BDIIVIDE-R redefines   NUM-IDE-BDIIVIDE

APPEND MODEc     *                                      pic 9(11).

APPEND MODEc     *    03 NOMBRE-BDIIVIDE                pic X(65).

APPEND MODEc     *    03 SW-VERIFNOM-BDIIVIDE           pic 9.

APPEND MODEc     *    03 NUM-BLOQUES-BDIIVIDE           pic 9.

APPEND MODEc     *    03 SW-VALTIPID-BDIIVIDE           pic 9.

APPEND MODEc     *    03 SW-ASGTIPID-BDIIVIDE           pic 9.

APPEND MODEc     *    03 SW-DIGCHEQUEO-BDIIVIDE         pic 9.

APPEND MODEc     *    03 FILLER-BDIIVIDE                pic X(18).

APPEND MODEc     *

APPEND MODEc     *01 PARAMETROS-SALIDA-BDIIVIDE.

APPEND MODEc     *   03 NOM-VAL-BDIIVIDE                pic X(65) value spaces.

APPEND MODEc     *   03 SW-ID-BDIIVIDE                  pic 9 value 0.

APPEND MODEc     *   03 SW-NOMBRES-BDIIVIDE             pic 9 value 0.

APPEND MODEc     *   03 SW-TID-BDIIVIDE                 pic 9 value 0.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con las alertas del sistema

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODEc     * BDIIALE-WS.v01.0007

APPEND MODEc     *01 VARIABLES-BDIIALE.

APPEND MODEc     *   02 ES-INDEPENDIENTE-BDIIALE           pic 9(01) value 0.

APPEND MODEc     *   02 MIRO-SIES-INDEPENDIENTE-BDIIALE    pic 9(01) value 0.

APPEND MODEc     *   02 MAES-BDIIALE-TITLE    pic X(20)

APPEND MODEc     *                            value "$DATABASE/BDIIALE".

APPEND MODEc     *   02 EST-BDIIALE           pic X(02) value "00".

APPEND MODEc     *   02 FIN-BDIIALE           pic 9(01) value 0.

APPEND MODEc     *   02 PROCESAR-BDIIALE      pic 9(01) value 0.

APPEND MODEc     *   02 CONT-LINEAS-BDIIALE   pic 9(03) value 0.

APPEND MODEc     *   02 ABIERTO-BDIIALE       pic 9(01) value 0.

APPEND MODEc     *   02 TIP-IDE-AUX-BDIIALE   pic 9(01) value 0.

APPEND MODEc     *   02 NUM-IDE-AUX-BDIIALE   pic 9(11) value 0.

APPEND MODEc     *   02 MARCAR-ICBTCO-BDIIALE pic 9(01) value 0.

APPEND MODEc     *   02 FECHA-AUX-BDIIALE     pic 9(08) value 0.

APPEND MODEc     *   02 FECHA-NOV-AUX-BDIIALE pic 9(08) value 0.

APPEND MODEc     *   02 FECHA-VEN-AUX-BDIIALE pic 9(08) value 0.

APPEND MODEc     *   02 FECHA-REP-AUX-BDIIALE pic 9(08) value 0.

APPEND MODEc     *   02 FUENTE-AUX-BDIIALE    pic 9(06) value 0.

APPEND MODEc     *   02 NOMFUE1-AUX-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 NOMFUE2-AUX-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 CODALE-AUX-BDIIALE    pic 9(03) value 0.

APPEND MODEc     *   02 TIPALE-AUX-BDIIALE    pic X(01) value spaces.

APPEND MODEc     *   02 TEXTO1-AUX-BDIIALE    pic X(50) value spaces.

APPEND MODEc     *   02 INF-DATAHOST-AUX-BDIIALE      pic X(18) value spaces.

APPEND MODEc     *   02 PAR-CODBLOALER        pic 9(1)  value 1.

APPEND MODEc     *   02 PAR-MSGBLOALER        pic X(60) value

APPEND MODEc     *      " ALERTA DADA POR LA ENTIDAD".

APPEND MODEc     *01 M-ALERTA.

APPEND MODEc     *   03 V-ALERTA   occurs 40 TIMES pic 9(02).

APPEND MODEc     *01 TITULOS-BDIIALE.

APPEND MODEc     *   02 filler                pic X(30) value all "=".

APPEND MODEc     *   02 filler    pic X(20) value "==== [ ALERTAS ] ===".

APPEND MODEc     *   02 filler                pic X(30) value all "=".

APPEND MODEc     *   02 filler    pic X(20) value "FUENTE           FEC".

APPEND MODEc     *   02 filler    pic X(20) value "HA           DESCRIP".

APPEND MODEc     *   02 filler    pic X(20) value "CION                ".

APPEND MODEc     *   02 filler    pic X(20) value "                    ".

APPEND MODEc     *   02 filler                pic X(80) value all "=".

APPEND MODEc     *01 LINEA1-BDIIALE-TIT.

APPEND MODEc     *   02 RAYA-BDIIALE          pic X(01) value " ".

APPEND MODEc     *   02 NOMFUE-LIN1-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 FEC-NOV-LIN1-BDIIALE  pic X(11) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 TEXTO-LIN1-BDIIALE    pic X(50) value spaces.

APPEND MODEc     *   02 filler                pic X(02) value spaces.

APPEND MODEc     *01 LINEA2-BDIIALE-TIT.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 NOMFUE-LIN2-BDIIALE   pic X(14) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 filler                pic X(11) value spaces.

APPEND MODEc     *   02 filler                pic X(01) value spaces.

APPEND MODEc     *   02 TEXTO-LIN2-BDIIALE    pic X(50) value spaces.

APPEND MODEc     *   02 filler                pic X(02) value spaces.

APPEND MODEc     *   02 TEXTO2-AUX-BDIIALE    pic X(50) value spaces.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres de VALNOM.PROC

APPEND MODE      ******************************************************************

APPEND MODE       copy VALNOM.WS.

APPEND MODEc     * VALNOM-WS.v.0002

APPEND MODEc     * 01 VARIABLES-VALNOM.

APPEND MODEc     *    03 VECTOR-INPUT-VALNOM.

APPEND MODEc     *      04 VM-INPUT-VALNOM     occurs 20 TIMES .

APPEND MODEc     *         05 VMM-INPUT-VALNOM occurs 15 TIMES pic X.

APPEND MODEc     *    03 VECTOR-OK-VALNOM.

APPEND MODEc     *      04 VM-OK-VALNOM         occurs 20 TIMES.

APPEND MODEc     *         05 VMM-OK-VALNOM    occurs 15 TIMES pic X.

APPEND MODEc     *    03 BLOQOK-AUX-VALNOM           pic 9(2).

APPEND MODEc     *    03 CADENA-VALNOM.

APPEND MODEc     *       04 filler                   pic X(2) value "A ".

APPEND MODEc     *       04 NOMBRE-AUX-VALNOM        pic X(65).

APPEND MODEc     *       04 filler redefines NOMBRE-AUX-VALNOM.

APPEND MODEc     *          05 VNOM-AUX-VALNOM occurs 65 TIMES pic X.

APPEND MODEc     *    03 BASURA-VALNOM               pic X(10).

APPEND MODEc     *    03 BLOQUES-INPUT-VALNOM        pic 9(2).

APPEND MODEc     *    03 NOMBRE-INPUT-VALNOM         pic X(65).

APPEND MODEc     *    03 filler redefines NOMBRE-INPUT-VALNOM.

APPEND MODEc     *       05 V-NOMBRE-VALNOM          pic X occurs 65 TIMES.

APPEND MODEc     *    03 NOMBOK-INPUT-VALNOM         pic X(65).

APPEND MODEc     *    03 filler redefines NOMBOK-INPUT-VALNOM.

APPEND MODEc     *       05 V-NOMBOK-VALNOM          pic X occurs 65 TIMES.

APPEND MODEc     *    03 TIP-ID-INPUT-VALNOM         pic 9(02).

APPEND MODEc     *    03 MATCH-OK-OUT-VALNOM         pic 9(01).

APPEND MODEc     *    03 A-VALNOM                    pic 9(05).

APPEND MODEc     *    03 I-VALNOM                    pic 9(05).

APPEND MODEc     *    03 J-VALNOM                    pic 9(05).

APPEND MODEc     *    03 K-VALNOM                    pic 9(05).

APPEND MODEc     *    03 L-VALNOM                    pic 9(05).

APPEND MODEc     *    03 M-VALNOM                    pic 9(05).

APPEND MODEc     *    03 INI-VALNOM                  pic 9(02).

APPEND MODEc     *    03 LON-VALNOM                  pic 9(02).

APPEND MODEc     *    03 LETRAS-OK-VALNOM            pic 9(02).

APPEND MODEc     *    03 LETRAS-OK2-VALNOM           pic 9(02).

APPEND MODEc     *    03 TOTLET-OK-VALNOM            pic 9(02).

APPEND MODEc     *    03 TOTLET-INP-VALNOM           pic 9(02).

APPEND MODEc     *    03 PEDAZO-VALNOM               pic X(15).

APPEND MODEc     *    03 POR-TOT-VALNOM              pic 9(05).

APPEND MODEc     *    03 POR-INP-VALNOM              pic 9(05).

APPEND MODEc     *    03 APROX-TOT-VALNOM            pic 9(05).

APPEND MODEc     *    03 APROX-INP-VALNOM            pic 9(05).

APPEND MODEc     *    03 VECTORES-VALNOM.

APPEND MODEc     *       04 filler                   occurs 256 TIMES.

APPEND MODEc     *          05 CONT-LET-INPUT-VALNOM pic 9(2).

APPEND MODEc     *          05 CONT-LET-OK-VALNOM    pic 9(2).

APPEND MODEc     *    03 VAL-APELLIDO-VALNOM         pic 9.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODEc     * ICFILE-WS.v.0040.

APPEND MODEc     * COPY PARA DIRECCIONAR LOS ARCHIVOS.

APPEND MODEc     *****************************************************************

APPEND MODEc     *01  FILE-TITLES.

APPEND MODEc     *    05  BDUUNI-TITLE        pic X(80) value "$BDU/BDUUNI".

APPEND MODEc     *    05  NOMB-APEL-TITLE     pic X(80) value "$DATABASE/ICBNAP".

APPEND MODEc     *    05  CLAVE-TITLE         pic X(80) value "$DATABASE/ICBCLA".

APPEND MODEc     *    05  TERM-TITLE          pic X(80) value "$DATABASE/ICBTER".

APPEND MODEc     *    05  MAES-PERSON-TITLE   pic X(80) value "$DATABASE/ICMPER".

APPEND MODEc     *    05  MAES-CHECK-TITLE    pic X(80) value "$DATABASE/ICMCHK".

APPEND MODEc     *    05  MAES-CREDIT-TITLE   pic X(80) value "$DATABASE/ICMCRE".

APPEND MODEc     *    05  MAES-MICROC-TITLE   pic X(80) value "$DATABASE/ICMMCR".

APPEND MODEc     *    05  MAES-ICMCHQ-TITLE   pic X(80) value "$DATABASE/ICMCHQ".

APPEND MODEc     *    05  INDEXADO-TITLE      pic X(80) value "$DATABASE/ICBCON".

APPEND MODEc     *    05  SECUENCIAL-TITLE    pic X(80) value "$DATABASE/ICBTCO".

APPEND MODEc     *    05  SUSCRIPTOR-TITLE    pic X(80) value "$DATABASE/ICBSUS".

APPEND MODEc     *    05  ARCHNITS-TITLE      pic X(80) value "ICDIAN".

APPEND MODEc     *    05  ARCHIVO-CLIENTE     pic X(80) value "$DATABASE/ICMCLI".

APPEND MODEc     *    05  MAES-ICMCLN-TITLE   pic X(80) value "$DATABASE/ICMCLN".

APPEND MODEc     *    05  ARCHIVO-PREPAGOS    pic X(80) value "$DATABASE/ICMPRE".

APPEND MODEc     *    05  ARCHIVO-USUARIOS    pic X(80) value "$DATABASE/ICMUSU".

APPEND MODEc     *    05  TITLE-SCODTB        pic X(80) value "$DATABASE/SCODTB".

APPEND MODEc     *    05  TITLE-BDIRMAE1      pic X(80) value "$DATABASE/BDIRMAE1".

APPEND MODEc     *    05  TITLE-BDIRMAE2      pic X(80) value "$DATABASE/BDIRMAE2".

APPEND MODEc     *    05  TITLE-BDIRMAE3      pic X(80) value "$DATABASE/BDIRMAE3".

APPEND MODEc     *    05  TITLE-BDIRMAE4      pic X(80) value "$DATABASE/BDIRMAE4".

APPEND MODEc     *    05  TITLE-BDIRCTR       pic X(80) value "$DATABASE/BDIRCTR".

APPEND MODEc     *    05  TITLE-BDIMHIS       pic X(80) value "$DATABASE/BDIMHIS".

APPEND MODEc     *    05  BDAPRVTR-TITLE      pic X(80) value "$DATABASE/BDAPRVTR".

APPEND MODEc     *    05  TITLE-DTCABD.

APPEND MODEc     *        07 filler           pic X(13) value "$DATOS/DTCABD".

APPEND MODEc     *        07 ANOMESDIA-DTCABD pic 9(08) value zeros.

APPEND MODEc     *    05  BDLCLI-TITLE        pic X(80) value "$DATABASE/BDLCLI".

APPEND MODEc     *    05  SCOREPREC-TITLE     pic X(80) value "$DATOS/SCOREPREC".

APPEND MODEc     *    05  ARCHIVO-LOGS        pic X(80) value

APPEND MODEc     *        "/ic/datacred/desarrollo/logs/ICL325".

APPEND MODEc     *    05  ARCHIVO-TEMPORAL    pic X(80) value

APPEND MODEc     *                                "$TEMPORALES/TEMPORAL".

APPEND MODEc     *    05  ESTAD-CADUC         pic X(80) value

APPEND MODEc     *                                "$TEMPORALES/ESTCAD.DAT".

APPEND MODEc     *    05  MATRIZ-CADUC        pic X(80) value

APPEND MODEc     *                                "$DATABASE/ICTCAD".

APPEND MODEc     *    05  ETQ-CIN             pic X(80) value

APPEND MODEc     *                                "$TEMPORALES/ICINCO.DAT".

APPEND MODEc     *    05  RECLACOM-TITLE      pic X(80) value "$DATABASE/ICMRCM".

APPEND MODEc     *    05  RECLAMOS-TITLE      pic X(80) value "$DATABASE/ICMRCL".

APPEND MODEc     *    05 MAESTRO-FACUCLI      pic X(80) value "$DATABASE/FACUCLI".

APPEND MODEc     *    05 TITLE-FACUCLP        pic X(80) value "$DATABASE/FACUCLP".

APPEND MODEc     *    05 TITLE-FACUAUT        pic X(80) value "$DATABASE/FACUAUT".

APPEND MODEc     *    05 TITLE-FACULOG        pic X(80) value "$DATABASE/FACULOG".

APPEND MODEc     *    05 TITLE-FACUPAR        pic X(80) value

APPEND MODEc     *                                "$DATABASE/FACUPAR.DAT".

APPEND MODEc     *    05 MAES-ICMCREH-TITLE   pic X(80) value "$DATABASE/ICMCREH".

APPEND MODEc     *    05 MAES-ICMCHKH-TITLE   pic X(80) value "$DATABASE/ICMCHKH".

APPEND MODEc     *    05 MAES-ICMCHQH-TITLE   pic X(80) value "$DATABASE/ICMCHQH".

APPEND MODEc     *

APPEND MODEc     *    05 TITLE-CIIU          pic X(80) value "$DATABASE/ICTCIIU".

APPEND MODEc     *    05 TITLE-BDINCCB       pic X(80) value "$ICREGIS/BDINCCB".

APPEND MODEc     *    05 TITLE-BDINREG       pic X(80) value "$ICREGIS/BDINREG".

APPEND MODEc     *    05 TITLE-BDINDAS       pic X(80) value "$ICREGIS/BDINDAS".

APPEND MODEc     *    05 TITLE-BDINDIAN      pic X(80) value "$ICREGIS/BDINDIAN".

APPEND MODEc     *    05 TITLE-CONRAZ        pic X(80)

APPEND MODEc     *                           value "$DATABASE/CONRAZ.DAT".

APPEND MODEc     *    05 TITLE-FRALOG        pic x(80) value "$DATABASE/FRALOG".

APPEND MODEc     *    05 TITLE-FRAINQ        pic X(80) value

APPEND MODEc     *                           "$DATABASE/FRAINQ.DAT".

APPEND MODEc     *    05 TITLE-FRAINQGR      pic X(80) value

APPEND MODEc     *                           "$DATABASE/FRAINQGR.DAT".

APPEND MODEc     *    05 TITLE-BDSCORES.

APPEND MODEc     *       07 filler           pic X(15) value "$SCORES/BDSCORE".

APPEND MODEc     *       07 T-FECHA-PROC     pic 9(04).

APPEND MODEc     *    05 TITLE-ICBPRO        pic x(80) value "$DATABASE/ICBPRO".

APPEND MODEc     *    05 TITLE-DTRLLA        pic x(80) value "$DATABASE/DTRLLA".

APPEND MODEc     *    05 TITLE-DTCLOG        pic X(80) value "$DATABASE/DTCLOG".

APPEND MODEc     *    05 TITLE-DTCCOM        pic X(80) value "$DATABASE/DTCCOM".

APPEND MODEc     *    05 TITLE-DTCING        pic X(80) value "$DATABASE/DTCING".

APPEND MODEc     *    05 TITLE-DTCFAL        pic X(80) value "$DATABASE/DTCFAL".

APPEND MODEc     *    05 TITLE-DTCMDF        pic X(80) value "$DATABASE/DTCMDF".

APPEND MODEc     *    05 TITLE-DTCTRA        pic X(80) value "$DATABASE/DTCTRA".

APPEND MODEc     *    05 TITLE-BDINBYN       pic X(80) value "$ICREGIS/BDINBYN".

APPEND MODEc     *    05 SI-BDIEMSUP         pic X(80) value "$DBSUPER/BDIEMSUP".

APPEND MODEc     *    05 TITLE-BDIEMSUP      pic X(80) value "$DBSUPER/BDIESU".

APPEND MODEc     *    05 SI-BDIEENTI         pic X(80) value "$DBSUPER/BDIEENTI".

APPEND MODEc     *    05 SI-BDIEMPER         pic X(80) value "$DBSUPER/BDIEMPER".

APPEND MODEc     *    05 SI-BDIETEMA         pic X(80) value "$DBSUPER/BDIETEMA".

APPEND MODEc     *    05 SI-BDIEAPER         pic X(80) value "$DBSUPER/BDIEAPER".

APPEND MODEc     *    05 SI-BDIEMENT         pic X(80) value "$DBSUPER/BDIEMENT".

APPEND MODEc     *    05 SI-BDIEMOVI         pic X(80) value "$DBSUPER/BDIEMOVI".

APPEND MODEc     *    05 SI-BDIEHSUP         pic X(80) value "$DBSUPER/BDIEHSUP".

APPEND MODEc     *    05 SI-BDIERECL         pic X(80) value "$DBSUPER/BDIERECL".

APPEND MODEc     *    05 SI-BDIEMTOT         pic X(80) value "$DBSUPER/BDIEMTOT".

APPEND MODEc     *    05 NOMBRE-WEB-SAL.

APPEND MODEc     *       07 NOM-DUE-WEB-SAL pic X(15) value "$DATOS/WEB-SAL.".

APPEND MODEc     *       07 FECHA-WEB-SAL   pic 9(8).

APPEND MODEc     *    05 NOMBRE-RAS-SAL.

APPEND MODEc     *       07 NOM-DUE-WEB-SAL pic X(15) value "$DATOS/RAS-SAL.".

APPEND MODEc     *       07 FECHA-RAS-SAL   pic 9(8).

APPEND MODEc     *    05 NOMBRE-CLAVE-WEB.

APPEND MODEc     *       07 NOMBRE-WEB-W    pic X(80) value "$DATABASE/ARCH-WEB".

APPEND MODEc     *    05 NOMBRE-RAS-LOG.

APPEND MODEc     *       07 NOM-RAS-LOG     pic X(19) value

APPEND MODEc     *                          "$DATOS/WEB-RAS.LOG.".

APPEND MODEc     *       07 FECHA-RAS-LOG   pic 9(8).

APPEND MODEc     *    05 TITLE-BDIIDIAN     pic X(80)  value "$DATABASE/BDIIDIAN".

APPEND MODEc     *    05 TITLE-BDIIREGI     pic X(80)  value "$ICREGIS/BDIIRE".

APPEND MODEc     *    05 TITLE-BDIIDAS      pic X(80)  value "$DATABASE/BDIIDAS".

APPEND MODEc     *    05 TITLE-DTCNHAB      pic X(80)  value "$DATABASE/DTCNHAB".

APPEND MODEc     *    05 TITLE-ICDACT       pic X(80)  value

APPEND MODEc     *                          "$TEMPORALES/ICDACT.DAT".

APPEND MODEc     *    05 NOMBRE-ACTALOG     pic X(80)  value

APPEND MODEc     *                          "$TRABAJO/logs/ACTALOG".

APPEND MODEc     *    05 NOMBRE-VALVEST     pic X(80)  value

APPEND MODEc     *                          "$TRABAJO/logs/VALVEST.DAT".

APPEND MODEc     *    05 NOMBRE-CALIDLOG.

APPEND MODEc     *       07 NOM-CALIDLOG    pic X(23)  value

APPEND MODEc     *                          "$TRABAJO/logs/CALIDLOG-".

APPEND MODEc     *       07 FCH-CALIDLOG    pic 9(8).

APPEND MODEc     *    05 NOMBRE-CALIDDRP.

APPEND MODEc     *       07 NOM-CALIDDRP    pic X(24) value

APPEND MODEc     *                          "$TEMPORALES/CALIDAD-DRP.".

APPEND MODEc     *       07 FCH-CALIDDRP    pic 9(8).

APPEND MODEc     *    05  MAES-ICMVLR-TITLE.

APPEND MODEc     *        07 MAES-DIRECTORY1       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE1            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE2.

APPEND MODEc     *        07 MAES-DIRECTORY2       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE2            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE3.

APPEND MODEc     *        07 MAES-DIRECTORY3       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE3            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE4.

APPEND MODEc     *        07 MAES-DIRECTORY4       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE4            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE5.

APPEND MODEc     *        07 MAES-DIRECTORY5       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE5            pic X(63).

APPEND MODEc     *

APPEND MODEc     *    05  MAES-ICMVLR-TITLE6.

APPEND MODEc     *        07 MAES-DIRECTORY6       pic X(16) value

APPEND MODEc     *                                 "$VALORES/ICMVLR-".

APPEND MODEc     *        07 MAES-FILE6            pic X(63).

APPEND MODEc     *    05 TITLE-BDLDIRACE  pic X(80) value "$DATABASE/BDLDIRACE".

APPEND MODEc     *    05 TITLE-BDLMAIEXC  pic X(80) value "$DATABASE/BDLMAIEXC".

APPEND MODEc     *    05 TITLE-BDLTELEXC  pic X(80) value "$DATABASE/BDLTELEXC".

APPEND MODEc     *    05 TITLE-BDANOM     pic X(80) value "$DATABASE/BDANOM".

APPEND MODEc     *    05 TITLE-FRZMYR     pic X(80) value "$DATABASE/FRZMYR".

APPEND MODEc     *    05 TITLE-DVPDANE    pic X(80) value "$DATABASE/DVPDANE.DAT".

APPEND MODEc     *    05 TITLE-CARACT-IND pic X(80) value

APPEND MODEc     *                                  "$DATABASE/CARACTUSA-INDCL".

APPEND MODEc     *    05 FRABDU-TITLE     pic X(25) value

APPEND MODEc     *                                "$VALORES/frabduact/FRABDU".

APPEND MODEc     *    05 FRABDV-TITLE     pic X(29) value

APPEND MODEc     *                                "$VALORES/frabduact/FRABDU.NEW".

APPEND MODEc     *    05 MAES-ICMHCIIU-TITLE pic X(80) value "$DATABASE/ICMHCIIU".

APPEND MODEc     *    05 MAES-ICMCONTTRJ-TITLE pic X(80) value

APPEND MODEc     *                                   "$DATABASE/ICMCONTTRJ".

APPEND MODEc     *    05 TITLE-ICBCOB     pic X(16) value "$DATABASE/ICBCOB".

APPEND MODEc     *    05 TITLE-SCODAPJA   pic X(37) value "$DATABASE/SCODAPJA".

APPEND MODEc     *01 TITLE-BDSCOREHIS.

APPEND MODEc     *   02 filler          pic X(21) value "$DATABASE/BDSCOREHIS.".

APPEND MODEc     *   02 ANO-ANT-TITLE-BDSCOREHIS  pic 9(04) value 2013.

APPEND MODEc     *   02 filler                    pic X(01) value "-".

APPEND MODEc     *   02 ANO-ACT-TITLE-BDSCOREHIS  pic 9(04) value 2014.

APPEND MODE

APPEND MODE       01 LINEA1-AUX.

APPEND MODE      * TIENE [&&&&&] DEMANDAS CERRADAS Y [&&&&&] ABIERTAS

APPEND MODE          02 filler    pic X(29)

APPEND MODE                       value "DEMANDAS JUDICIALES VIGENTES:".

APPEND MODE          02 NUM-VIG-1 pic 9(05) value 0.

APPEND MODE          02 filler    pic X(08) value " ULTIMA:".

APPEND MODE          02 FEC-VIG-1 pic 9(08) value 0.

APPEND MODE       01 LINEA2-AUX.

APPEND MODE          02 filler    pic X(31)

APPEND MODE                       value "DEMANDAS JUDICIALES TERMINADAS:".

APPEND MODE          02 NUM-TER-2 pic 9(05) value 0.

APPEND MODE          02 filler    pic X(14) value spaces.

APPEND MODE       01 VARIABLES-GENERALES.

APPEND MODE          03 real                       pic 9      value 0.

APPEND MODE          03 FIN-ENTRADA                pic 9      value 0.

APPEND MODE          03 FECHA-PROCESO              pic 9(8)   value 0.

APPEND MODE          03 FECHA-VENCIMIENTO          pic 9(8)   value 0.

APPEND MODE          03 DIAS-DESDE-1600            pic 9(8)   value 0.

APPEND MODE       01 INF-DATAHOST-AUX.

APPEND MODE          02 NUM-DEMA-VIG-AUX           pic 9(5).

APPEND MODE          02 NUM-DEMA-TER-AUX           pic 9(5).

APPEND MODE          02 FEC-DEMA-VIG-AUX           pic 9(8).

APPEND MODE       01 VARIABLES-INPUT.

APPEND MODE          03 TIPO-IDE-INP               pic 9.

APPEND MODE          03 NUM-IDE-INP                pic 9(11).

APPEND MODE          03 NOMBRES-INP                pic X(30).

APPEND MODE          03 APELLIDO-PAT-INP           pic X(30).

APPEND MODE          03 APELLIDO-MAT-INP           pic X(30).

APPEND MODE          03 NUM-DEMA-VIG-INP           pic 9(05).

APPEND MODE          03 NUM-DEMA-TER-INP           pic 9(05).

APPEND MODE          03 FEC-DEMA-VIG-INP           pic 9(08).

APPEND MODE          03 TIPO-IDE-INP-X             pic X.

APPEND MODE          03 NUM-IDE-INP-X              pic X(11).

APPEND MODE          03 NUM-DEMA-VIG-INP-X         pic X(05).

APPEND MODE          03 NUM-DEMA-TER-INP-X         pic X(05).

APPEND MODE          03 FEC-DEMA-VIG-INP-X         pic X(08).

APPEND MODE       01 M-ERRORES.

APPEND MODE          03 V-ERR occurs 50 TIMES      pic 9(1).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "SI" para activar 

APPEND MODE      * TODO: fijo en "NO" para pruebas

APPEND MODE           03 P-proceso-real            pic xx value "NO".

APPEND MODE           88 PROCESO-REAL              value "SI".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Código de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Inserción de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificación o eliminación de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un 

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5 

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo: 

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos. 

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamaño del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50) 

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un código de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 80

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificación invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificación debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE          02 ANO-VAL-X                   pic 9(04).

APPEND MODE             88 ANO-VAL  value 1900 thru 2050.

APPEND MODE          02 MES-VAL-X                   pic 9(02).

APPEND MODE             88 MES-VAL  value 01   thru 12.

APPEND MODE          02 DIA-VAL-X                   pic 9(02).

APPEND MODE             88 DIA-VAL  value 01   thru 31.

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    6000-SACAR-RESUMEN

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La información está leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T" 

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validación formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    actualizacion de BDIIALE o grabacion en arch ERRS de defectos

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               add 1 to N-reg-con-error

APPEND MODE           else

APPEND MODE               perform 4300-MODIFICAR-BDIIALE

APPEND MODE               add 1 to N-reg-OK

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-demandas-fecha-ultima(1:2) > "50"

APPEND MODE               string "19" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-demandas-fecha-ultima into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-embargos-fecha-ultimo(1:2) > "50"

APPEND MODE               string "19" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           else

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo into 

APPEND MODE               VALIDACIONES-FECHAS

APPEND MODE           end-if

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a " 

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones, 

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y 

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero 

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima 

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero 

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyó OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg n°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserción de una alerta nueva

APPEND MODE      * Si ya exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro exist\055a es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE 

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificación de una alerta existente

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no exist\055a es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminación de una alerta

APPEND MODE      * Si no exist\055a muestra un mensaje y continúa

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminación de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "20" thru "29"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: >>>> implementar la grabación del archivo ERRS

APPEND MODE           display "NO GRABA ERRS".

APPEND MODE 

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    según se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0 

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE               unstring LA-num into LA-descarte LA-valor(1)

APPEND MODE               delimited by all spaces

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE               unstring LA-num into LA-descarte LA-valor(2)

APPEND MODE               delimited by all spaces

APPEND MODE               string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE               string LA-parte(LAx, 2) LA-valor(2)

APPEND MODE               string LA-parte(LAx, 3) LA-valor(3)

APPEND MODE               string LA-parte(LAx, 4) LA-valor(4)

APPEND MODE               string LA-parte(LAx, 5) LA-valor(5)

APPEND MODE               string LA-parte(LAx, 6) LA-valor(6)

APPEND MODE               string LA-parte(LAx, 7) LA-valor(7)

APPEND MODE               string LA-parte(LAx, 8) LA-valor(8)

APPEND MODE               string LA-parte(LAx, 9) LA-valor(9)

APPEND MODE               string LA-parte(LAx, 10) LA-valor(10)

APPEND MODE               delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso

APPEND MODE           display "Carga de archivo JURAD"

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "command line: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01" *> 01 Envio Original - Carga TOTAL 1a vez

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02" *> 02 Archivo Semanal - Carga PARCIAL

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03" *> 03 Archivo Mensual - Carga PARCIAL

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04" *> 04 Refresque Total - Carga TOTAL

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *       valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD 

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size 

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una decha 50 años posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo jurad "

APPEND MODE                   display "Nombre del archivo: " P-file-name

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string P-file-name(1:19) "_ERRORES.txt" into

APPEND MODE           ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1 

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE               unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE               LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE               LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE               LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE               delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE invalid key

APPEND MODE      *        no hay registros

APPEND MODE               exit paragraph

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas. 

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time.

APPEND MODE      *    leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display "Proceso cancelado"

APPEND MODE           goback.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(80) value low-values.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 80 caracteres)

APPEND MODE       01  reg-input                    pic x(80).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input(1:80) not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display reg-input(1:80)

APPEND MODE               move reg-input(1:80) to reg-input-anterior

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program ACTALEJUR.

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1656 lines, 75586 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fg:qcob64 lstpath"/d/iccol/desarrollo/temporales" -uv -g -P >/d/iccol/desarrollo $
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIREGI SIN status.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN status.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN status.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO BDIIALE SIN status.........."
  2122         delimited by all spaces
* 301-S*****************                                               (   0)**
**    Unrecognized verb
  2125         delimited by all spaces
* 301-S*****************                                               (  38)**
**    Unrecognized verb
  2127         string LA-parte(LAx, 2) LA-valor(2)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2128         string LA-parte(LAx, 3) LA-valor(3)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2129         string LA-parte(LAx, 4) LA-valor(4)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2130         string LA-parte(LAx, 5) LA-valor(5)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2131         string LA-parte(LAx, 6) LA-valor(6)
*  83-S**************                                                  (  38)**
**    Reserved word missing - DELIMITED expected.
  2132         string LA-parte(LAx, 7) LA-valor(7)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2133         string LA-parte(LAx, 8) LA-valor(8)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2134         string LA-parte(LAx, 9) LA-valor(9)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2135         string LA-parte(LAx, 10) LA-valor(10)
*  83-S**************                                                  (  39)**
**    Reserved word missing - DELIMITED expected.
  2137     end-if.
*  14-S**********                                                      (  39)**
**    Invalid operand
  2248         delimited by all "&"
* 301-S*****************                                               (  39)**
**    Unrecognized verb
  3149    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM
*  12-S****************************************                        (  41)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3151    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"
*  12-S***************************                                     (  56)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3152    IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  56)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3153       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  57)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3154    END-IF                                                        FAC0002
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3155    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  57)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3156       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  57)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3157    END-IF                                                        FAC0002
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3158    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                           FAC0002
*  12-S**************************                                      (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3159       MOVE ZEROS TO SW-VALTIPID-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3160    END-IF                                                        FAC0002
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3161    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERIC                         FAC0003
*  12-S****************************                                    (  57)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3162       MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDE                       FAC0003
*  12-S******************************************                      (  57)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3163    END-IF                                                        FAC0003
* 564-S*********                                                       (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3164    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS
*  12-S**********************                                          (  57)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3165      IF SW-ASGTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  57)**
**    Operand SW-ASGTIPID-BDIIVIDE is not declared
  3167      END-IF                                                      FAC0002
* 564-S***********                                                     (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3168      IF SW-VALTIPID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3170      END-IF                                                      FAC0002
* 564-S***********                                                     (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3171      IF SW-DIGCHEQUEO-BDIIVIDE = 1                               FAC0004
*  12-S******************************                                  (  57)**
**    Operand SW-DIGCHEQUEO-BDIIVIDE is not declared
  3173      END-IF                                                      FAC0004
* 564-S***********                                                     (  57)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3174      IF SW-VALTIPID-BDIIVIDE = 0 OR                              FAC0004
*  12-S****************************                                    (  57)**
**    Operand SW-VALTIPID-BDIIVIDE is not declared
  3177       INITIALIZE NOM-VAL-BDIIVIDE
*  12-S*********************************                               (  58)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3178       MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE
*  12-S*****************************                                   (  58)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3179       IF SW-VERIFNOM-BDIIVIDE = 1
*  12-S*****************************                                   (  58)**
**    Operand SW-VERIFNOM-BDIIVIDE is not declared
  3180          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM
*  12-S******************************                                  (  58)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3181          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM
*  12-S*****************************                                   (  58)**
**    Operand NOMBRE-BDIIVIDE is not declared
  3182          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  58)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3183          IF SW-ID-BDIIVIDE = 0
*  12-S**************************                                      (  58)**
**    Operand SW-ID-BDIIVIDE is not declared
  3184             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND
*  12-S***********************************                             (  58)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3186                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM
*  12-S****************************************                        (  58)**
**    Operand NUM-BLOQUES-BDIIVIDE is not declared
  3187             ELSE IF TIP-ID-INPUT-VALNOM = 1
*  12-S***************************************                         (  58)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3188                     MOVE 2 TO BLOQUES-INPUT-VALNOM
*  12-S**************************************************              (  58)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3189                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM
*  12-S****************************************************            (  58)**
**    Operand BLOQUES-INPUT-VALNOM is not declared
  3190                  END-IF
* 564-S***********************                                         (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3191             END-IF
* 564-S******************                                              (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3193             IF MATCH-OK-OUT-VALNOM = 0
*  12-S**********************************                              (  58)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3194                MOVE 1 TO SW-NOMBRES-BDIIVIDE
*  12-S********************************************                    (  58)**
**    Operand SW-NOMBRES-BDIIVIDE is not declared
  3195             END-IF
* 564-S******************                                              (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3196          END-IF
* 564-S***************                                                 (  58)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3197       END-IF
* 564-S************                                                    (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3198      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002
*  12-S****************************                                    (  59)**
**    Operand SW-TID-BDIIVIDE is not declared
  3199              MOVE 1 TO SW-ID-BDIIVIDE                            FAC0002
*  12-S*************************************                           (  59)**
**    Operand SW-ID-BDIIVIDE is not declared
  3200           END-IF                                                 FAC0002
* 564-S****************                                                (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3201      END-IF                                                      FAC0002
* 564-S***********                                                     (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3202    ELSE MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  59)**
**    Operand SW-ID-BDIIVIDE is not declared
  3203    END-IF.
* 564-S*********                                                       (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3213     EVALUATE TIP-IDE-BDIIVIDE
*  12-S*****************************                                   (  59)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3216       WHEN 2
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3218       WHEN 3
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3220       WHEN 4
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3222       WHEN OTHER
* 368-S**********                                                      (  59)**
**    Exception phrase inappropriate
  3223         MOVE 1 TO SW-ID-BDIIVIDE
*  12-S********************************                                (  59)**
**    Operand SW-ID-BDIIVIDE is not declared
  3224     END-EVALUATE.
* 564-S****************                                                (  59)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3232    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002
*  12-S****************************************                        (  60)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3233    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  60)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3234      IF (NUM-IDE-BDIIVIDE-R >= 1 AND                             FAC0002
*  12-S***************************                                     (  60)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3238         MOVE 1 TO TIP-IDE-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3240        IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002
*  12-S*****************************                                   (  60)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3244           MOVE 2 TO TIP-IDE-BDIIVIDE                             FAC0002
*  12-S************************************                            (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3250          IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002
*  12-S*******************************                                 (  60)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3254             MOVE 3 TO TIP-IDE-BDIIVIDE                           FAC0002
*  12-S**************************************                          (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3255          ELSE MOVE 4 TO TIP-IDE-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3256          END-IF.                                                 FAC0002
* 564-S***************                                                 (  60)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3266    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002
*  12-S****************************************                        (  60)**
**    Operand PARAMETROS-SALIDA-BDIIVIDE is not declared
  3267    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3268    EVALUATE TIP-IDE-BDIIVIDE                                     FAC0002
*  12-S****************************                                    (  61)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3270       IF NUM-IDE-BDIIVIDE-R > 9999999999                         FAC0002
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3271          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3272       END-IF                                                     FAC0002
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3274       IF NUM-IDE-BDIIVIDE-R >  9999999999 OR                     FAC006C
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3276          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3277       END-IF                                                     FAC0002
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3279       IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000           FAC0005
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3280          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002
*  12-S**********************************                              (  61)**
**    Operand SW-TID-BDIIVIDE is not declared
  3281       END-IF                                                     FAC0002
* 564-S************                                                    (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3282    END-EVALUATE.                                                 FAC0002
* 564-S***************                                                 (  61)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3290      IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                     FAC0004
*  12-S***************************                                     (  61)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3294          MOVE 3 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  61)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3295      END-IF                                                      FAC0004
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3296      IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                     FAC0004
*  12-S***************************                                     (  62)**
**    Operand NUM-IDE-BDIIVIDE-R is not declared
  3300          MOVE 2 TO TIP-IDE-BDIIVIDE                              FAC0004
*  12-S***********************************                             (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3301      END-IF                                                      FAC0004
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3302      IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004
*  12-S*************************                                       (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3309          MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDE            FAC0004
*  12-S******************************                                  (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3310          MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R          FAC0004
*  12-S*********************************                               (  62)**
**    Operand NUM-ID-W10-BDIIVIDE is not declared
  3311      END-IF                                                      FAC0004
* 564-S***********                                                     (  62)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3312      INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".          FAC0004
*  12-S*****************************                                   (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3320     MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI
*  12-S*************************                                       (  62)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3321     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI
*  12-S*************************                                       (  62)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3322     READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  62)**
**    Operand BDIIREGI is not declared
*  12-S******************************************************          (  62)**
**    Operand SW-ID-BDIIVIDE is not declared
  3323     END-READ
* 564-S************                                                    (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3324     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  63)**
**    Operand SW-ID-BDIIVIDE is not declared
  3325        MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  63)**
**    Operand APELLIDO1-BDIIREGI is not declared
  3326        MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE
*  12-S******************************                                  (  63)**
**    Operand APELLIDO2-BDIIREGI is not declared
  3327        MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE
*  12-S********************************                                (  63)**
**    Operand DES-NOMBRE2-BDIIREGI is not declared
  3328        MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE
*  12-S********************************                                (  63)**
**    Operand DES-NOMBRE1-BDIIREGI is not declared
  3329        IF ESTADO-CIVIL-BDIIREGI = 0
*  12-S*******************************                                 (  63)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3331             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  63)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3338         END-IF
* 564-S**************                                                  (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3339         IF ESTADO-CIVIL-BDIIREGI = 1
*  12-S********************************                                (  63)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3343             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  63)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3350         END-IF
* 564-S**************                                                  (  63)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3351         IF ESTADO-CIVIL-BDIIREGI = 2
*  12-S********************************                                (  63)**
**    Operand ESTADO-CIVIL-BDIIREGI is not declared
  3355             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S*************************************                           (  63)**
**    Operand SEGUNDO-APELLIDO-BDIIVIDE is not declared
  3362         END-IF
* 564-S**************                                                  (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3363         STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",
*  12-S***************************************                         (  64)**
**    Operand PRIMER-APELLIDO-BDIIVIDE is not declared
  3369         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "
*  12-S********************************                                (  64)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3370         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "
*  12-S********************************                                (  64)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3371         INITIALIZE NOM-LEIDO-BDIIVIDE
*  12-S*************************************                           (  64)**
**    Operand NOM-LEIDO-BDIIVIDE is not declared
  3372         MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.
*  12-S*****************************                                   (  64)**
**    Operand NOM-VAL-BDIIVIDE is not declared
  3379     MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN
*  12-S*************************                                       (  64)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3380     READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S*****************                                               (  64)**
**    Operand BDIIDIAN is not declared
*  12-S******************************************************          (  64)**
**    Operand SW-ID-BDIIVIDE is not declared
  3381     END-READ
* 564-S************                                                    (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3382     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  64)**
**    Operand SW-ID-BDIIVIDE is not declared
  3383        MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE
*  12-S********************************                                (  64)**
**    Operand DESCRIPCION-BDIIDIAN is not declared
  3384     END-IF.
* 564-S**********                                                      (  64)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3391     MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS
*  12-S*************************                                       (  65)**
**    Operand NUM-IDE-BDIIVIDE is not declared
  3392     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS
*  12-S*************************                                       (  65)**
**    Operand TIP-IDE-BDIIVIDE is not declared
  3393     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE
*  12-S****************                                                (  65)**
**    Operand BDIIDAS is not declared
*  12-S*****************************************************           (  65)**
**    Operand SW-ID-BDIIVIDE is not declared
  3394     END-READ
* 564-S************                                                    (  65)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3395     IF SW-ID-BDIIVIDE = 0
*  12-S*********************                                           (  65)**
**    Operand SW-ID-BDIIVIDE is not declared
  3396        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.
*  12-S**************************                                      (  65)**
**    Operand NOMBRE-BDIIDAS is not declared
  3439     MOVE 0 TO MATCH-OK-OUT-VALNOM.
*  12-S*********************************                               (  65)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3440     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  66)**
**    Operand NOMBRE-INPUT-VALNOM is not declared
  3441     IF TIP-ID-INPUT-VALNOM  = 2
*  12-S**************************                                      (  66)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3442         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3453         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3464         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3468         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
*  12-S*********************************                               (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3472         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
*  12-S******************************                                  (  66)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3474        INSPECT CADENA-VALNOM    REPLACING ALL
*  12-S****************************                                    (  67)**
**    Operand CADENA-VALNOM is not declared
  3480        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
*  12-S****************************                                    (  67)**
**    Operand CADENA-VALNOM is not declared
  3486                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  67)**
**    Operand I-VALNOM is not declared
  3488                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  67)**
**    Operand VNOM-AUX-VALNOM is not declared
  3490                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  67)**
**    Operand VNOM-AUX-VALNOM is not declared
  3491                  END-IF
* 564-S***********************                                         (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3492                END-PERFORM
* 564-S**************************                                      (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3493     END-IF.
* 564-S**********                                                      (  67)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3494     MOVE SPACES TO VECTOR-INPUT-VALNOM.
*  12-S**************************************                          (  67)**
**    Operand VECTOR-INPUT-VALNOM is not declared
  3495     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  67)**
**    Operand CADENA-VALNOM is not declared
  3508     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
*  12-S****************************                                    (  67)**
**    Operand NOMBOK-INPUT-VALNOM is not declared
  3509     IF TIP-ID-INPUT-VALNOM  NOT = 2
*  12-S**************************                                      (  68)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3510        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
*  12-S********************************                                (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3514                PERFORM VARYING I-VALNOM FROM 1 BY 1
*  12-S***************************************                         (  68)**
**    Operand I-VALNOM is not declared
  3516                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
*  12-S***********************************                             (  68)**
**    Operand VNOM-AUX-VALNOM is not declared
  3518                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  68)**
**    Operand VNOM-AUX-VALNOM is not declared
  3519                  END-IF
* 564-S***********************                                         (  68)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3520                END-PERFORM
* 564-S**************************                                      (  68)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3522         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3533         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
*  12-S*********************************                               (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3544        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
*  12-S********************************                                (  68)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3548         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
*  12-S******************************                                  (  69)**
**    Operand NOMBRE-AUX-VALNOM is not declared
  3549     END-IF.
* 564-S**********                                                      (  69)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3550     MOVE SPACES TO VECTOR-OK-VALNOM.
*  12-S***********************************                             (  69)**
**    Operand VECTOR-OK-VALNOM is not declared
  3551     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
*  12-S**************************                                      (  69)**
**    Operand CADENA-VALNOM is not declared
  3562     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  69)**
**    Operand I-VALNOM is not declared
  3563     MOVE 0 TO BLOQOK-AUX-VALNOM.
*  12-S*******************************                                 (  69)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3564     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
*  12-S*********************************                               (  69)**
**    Operand VM-INPUT-VALNOM is not declared
  3565       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  69)**
**    Operand J-VALNOM is not declared
  3566       PERFORM UNTIL J-VALNOM > 20
*  12-S****************************                                    (  69)**
**    Operand J-VALNOM is not declared
  3567         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
*  12-S**************************                                      (  69)**
**    Operand VM-INPUT-VALNOM is not declared
  3568            ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*************************************                           (  69)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3569            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S**************************************                          (  69)**
**    Operand VM-OK-VALNOM is not declared
  3571            MOVE 21 TO J-VALNOM
*  12-S******************************                                  (  69)**
**    Operand J-VALNOM is not declared
  3573            MOVE 0 TO M-VALNOM
*  12-S*****************************                                   (  69)**
**    Operand M-VALNOM is not declared
  3574            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S*******************************                                 (  69)**
**    Operand VM-OK-VALNOM is not declared
  3576            IF M-VALNOM >= 15
*  12-S**********************                                          (  70)**
**    Operand M-VALNOM is not declared
  3577               MOVE 0 TO M-VALNOM
*  12-S********************************                                (  70)**
**    Operand M-VALNOM is not declared
  3578               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
*  12-S**********************************                              (  70)**
**    Operand VM-OK-VALNOM is not declared
  3580            END-IF
* 564-S*****************                                               (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3581            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
*  12-S**********************                                          (  70)**
**    Operand M-VALNOM is not declared
  3583               COMPUTE INI-VALNOM = M-VALNOM + 2
*  12-S********************************                                (  70)**
**    Operand INI-VALNOM is not declared
  3584               COMPUTE LON-VALNOM = 14 - M-VALNOM
*  12-S********************************                                (  70)**
**    Operand LON-VALNOM is not declared
  3585               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
*  12-S*******************************                                 (  70)**
**    Operand VM-OK-VALNOM is not declared
  3586               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
*  12-S******************************                                  (  70)**
**    Operand PEDAZO-VALNOM is not declared
  3590                  ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S*******************************************                     (  70)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3591                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S********************************************                    (  70)**
**    Operand VM-OK-VALNOM is not declared
  3593                  MOVE 21 TO J-VALNOM
*  12-S************************************                            (  70)**
**    Operand J-VALNOM is not declared
  3594                  ADD 1 TO I-VALNOM
*  12-S**********************************                              (  70)**
**    Operand I-VALNOM is not declared
  3595                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
*  12-S***********************************************                 (  70)**
**    Operand VM-INPUT-VALNOM is not declared
  3596               END-IF
* 564-S********************                                            (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3597            END-IF
* 564-S*****************                                               (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3598         END-IF
* 564-S**************                                                  (  70)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3599         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  71)**
**    Operand J-VALNOM is not declared
  3600       END-PERFORM
* 564-S*****************                                               (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3601       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  71)**
**    Operand I-VALNOM is not declared
  3602       IF I-VALNOM = 21
*  12-S*****************                                               (  71)**
**    Operand I-VALNOM is not declared
  3604       END-IF
* 564-S************                                                    (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3605     END-PERFORM.
* 564-S***************                                                 (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3606     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S************************                                        (  71)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3607        MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S************************************                            (  71)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3609        IF TIP-ID-INPUT-VALNOM <> 2
*  12-S*****************************                                   (  71)**
**    Operand TIP-ID-INPUT-VALNOM is not declared
  3611        ELSE
* 562-S***********                                                     (  71)**
**    An "ELSE" phrase did not have a matching IF and was discarded.
  3613        END-IF
* 564-S*************                                                   (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3614        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
*  12-S***************************                                     (  71)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3615           MOVE 1 TO MATCH-OK-OUT-VALNOM
*  12-S***************************************                         (  71)**
**    Operand MATCH-OK-OUT-VALNOM is not declared
  3616        END-IF
* 564-S*************                                                   (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3617     END-IF.
* 564-S**********                                                      (  71)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3625     IF BLOQOK-AUX-VALNOM > 0
*  12-S************************                                        (  71)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3626        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  72)**
**    Operand APROX-TOT-VALNOM is not declared
  3628        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
*  12-S**********************************                              (  72)**
**    Operand APROX-TOT-VALNOM is not declared
  3629     END-IF
* 564-S**********                                                      (  72)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3630     MOVE 1 TO I-VALNOM.
*  12-S**********************                                          (  72)**
**    Operand I-VALNOM is not declared
  3631     PERFORM UNTIL I-VALNOM > 10
*  12-S**************************                                      (  72)**
**    Operand I-VALNOM is not declared
  3632       MOVE 1 TO J-VALNOM
*  12-S************************                                        (  72)**
**    Operand J-VALNOM is not declared
  3633       PERFORM UNTIL J-VALNOM > 10
*  12-S****************************                                    (  72)**
**    Operand J-VALNOM is not declared
  3634         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
*  12-S**********************************                              (  72)**
**    Operand LETRAS-OK-VALNOM is not declared
  3635         MOVE 1 TO K-VALNOM
*  12-S**************************                                      (  72)**
**    Operand K-VALNOM is not declared
  3636         MOVE 1 TO L-VALNOM
*  12-S**************************                                      (  72)**
**    Operand L-VALNOM is not declared
  3637         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
*  12-S**************************                                      (  72)**
**    Operand VM-INPUT-VALNOM is not declared
  3639            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  72)**
**    Operand K-VALNOM is not declared
  3640              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  72)**
**    Operand VMM-INPUT-VALNOM is not declared
  3645                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
*  12-S********************************                                (  72)**
**    Operand VMM-OK-VALNOM is not declared
  3646                    ADD 1 TO LETRAS-OK-VALNOM
*  12-S********************************************                    (  72)**
**    Operand LETRAS-OK-VALNOM is not declared
  3647                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  72)**
**    Operand K-VALNOM is not declared
  3648                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  72)**
**    Operand L-VALNOM is not declared
  3650                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  73)**
**    Operand K-VALNOM is not declared
  3651                 END-IF
* 564-S**********************                                          (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3653                 ADD 1   TO K-VALNOM
*  12-S***********************************                             (  73)**
**    Operand K-VALNOM is not declared
  3654                 IF K-VALNOM <= 15 AND L-VALNOM < 15
*  12-S***************************                                     (  73)**
**    Operand K-VALNOM is not declared
  3655                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
*  12-S**************************************                          (  73)**
**    Operand VMM-INPUT-VALNOM is not declared
  3657                       ADD 1 TO L-VALNOM
*  12-S***************************************                         (  73)**
**    Operand L-VALNOM is not declared
  3658                    END-IF
* 564-S*************************                                       (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3659                 END-IF
* 564-S**********************                                          (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3660              END-IF
* 564-S*******************                                             (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3661            END-PERFORM
* 564-S**********************                                          (  73)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3662            MOVE 1 TO K-VALNOM
*  12-S*****************************                                   (  73)**
**    Operand K-VALNOM is not declared
  3663            MOVE 1 TO L-VALNOM
*  12-S*****************************                                   (  73)**
**    Operand L-VALNOM is not declared
  3664            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
*  12-S*********************************                               (  73)**
**    Operand K-VALNOM is not declared
  3665              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S********************************                                (  73)**
**    Operand VMM-INPUT-VALNOM is not declared
  3670                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
*  12-S********************************                                (  73)**
**    Operand VMM-OK-VALNOM is not declared
  3671                    ADD 1 TO LETRAS-OK2-VALNOM
*  12-S*********************************************                   (  73)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3672                    ADD 1 TO K-VALNOM
*  12-S************************************                            (  73)**
**    Operand K-VALNOM is not declared
  3673                    ADD 1 TO L-VALNOM
*  12-S************************************                            (  74)**
**    Operand L-VALNOM is not declared
  3675                    MOVE 19 TO K-VALNOM
*  12-S**************************************                          (  74)**
**    Operand K-VALNOM is not declared
  3676                 END-IF
* 564-S**********************                                          (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3678                 ADD 1   TO L-VALNOM
*  12-S***********************************                             (  74)**
**    Operand L-VALNOM is not declared
  3679                 IF L-VALNOM <= 15 AND K-VALNOM < 15
*  12-S***************************                                     (  74)**
**    Operand L-VALNOM is not declared
  3680                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
*  12-S**************************************                          (  74)**
**    Operand VMM-INPUT-VALNOM is not declared
  3682                       ADD 1 TO K-VALNOM
*  12-S***************************************                         (  74)**
**    Operand K-VALNOM is not declared
  3683                    END-IF
* 564-S*************************                                       (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3684                 END-IF
* 564-S**********************                                          (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3685              END-IF
* 564-S*******************                                             (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3686            END-PERFORM
* 564-S**********************                                          (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3687         END-IF
* 564-S**************                                                  (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3688         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
*  12-S****************************                                    (  74)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3689            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
*  12-S*********************************                               (  74)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3690         END-IF
* 564-S**************                                                  (  74)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3691         IF LETRAS-OK-VALNOM > 0
*  12-S***************************                                     (  74)**
**    Operand LETRAS-OK-VALNOM is not declared
  3692            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
*  12-S**************************************                          (  74)**
**    Operand TOTLET-INP-VALNOM is not declared
  3693            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
*  12-S**********************************                              (  74)**
**    Operand VM-INPUT-VALNOM is not declared
  3696            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
*  12-S*******************************                                 (  75)**
**    Operand VM-OK-VALNOM is not declared
  3699            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
*  12-S***********************************                             (  75)**
**    Operand POR-TOT-VALNOM is not declared
  3700            IF TOTLET-OK-VALNOM >= 3
*  12-S******************************                                  (  75)**
**    Operand TOTLET-OK-VALNOM is not declared
  3701               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  75)**
**    Operand POR-TOT-VALNOM is not declared
  3703            END-IF
* 564-S*****************                                               (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3704            IF TOTLET-INP-VALNOM >= 3
*  12-S*******************************                                 (  75)**
**    Operand TOTLET-INP-VALNOM is not declared
  3705               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
*  12-S************************************                            (  75)**
**    Operand POR-INP-VALNOM is not declared
  3707            END-IF
* 564-S*****************                                               (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3708            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
*  12-S******************************                                  (  75)**
**    Operand TOTLET-OK-VALNOM is not declared
  3709               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
*  12-S******************************                                  (  75)**
**    Operand A-VALNOM is not declared
  3712               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
*  12-S******************************                                  (  75)**
**    Operand A-VALNOM is not declared
  3714            END-IF
* 564-S*****************                                               (  75)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3715            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
*  12-S******************************                                  (  75)**
**    Operand POR-TOT-VALNOM is not declared
  3725               ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S****************************************                        (  75)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3726               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
*  12-S*****************************************                       (  76)**
**    Operand VM-OK-VALNOM is not declared
  3728            END-IF
* 564-S*****************                                               (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3729         END-IF
* 564-S**************                                                  (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3730         ADD 1 TO J-VALNOM
*  12-S*************************                                       (  76)**
**    Operand J-VALNOM is not declared
  3731       END-PERFORM
* 564-S*****************                                               (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3732       ADD 1 TO I-VALNOM
*  12-S***********************                                         (  76)**
**    Operand I-VALNOM is not declared
  3733     END-PERFORM.
* 564-S***************                                                 (  76)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3741   MOVE ZEROS TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  76)**
**    Operand TOTLET-INP-VALNOM is not declared
  3742   MOVE ZEROS TO LETRAS-OK2-VALNOM
*  12-S*********************************                               (  76)**
**    Operand LETRAS-OK2-VALNOM is not declared
  3743    MOVE ZEROS TO A-VALNOM                                        GJC0003
*  12-S*************************                                       (  76)**
**    Operand A-VALNOM is not declared
  3744   MOVE 1 TO K-VALNOM
*  12-S********************                                            (  76)**
**    Operand K-VALNOM is not declared
  3745   PERFORM UNTIL K-VALNOM > 65
*  12-S************************                                        (  76)**
**    Operand K-VALNOM is not declared
  3746     MOVE K-VALNOM  TO I-VALNOM
*  12-S*****************                                               (  76)**
**    Operand K-VALNOM is not declared
  3747     MOVE 1       TO J-VALNOM
*  12-S****************************                                    (  76)**
**    Operand J-VALNOM is not declared
  3748     MOVE ZEROS TO LETRAS-OK-VALNOM
*  12-S**********************************                              (  76)**
**    Operand LETRAS-OK-VALNOM is not declared
  3749     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
*  12-S**************************                                      (  76)**
**    Operand J-VALNOM is not declared
  3750        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S*************************                                       (  77)**
**    Operand V-NOMBRE-VALNOM is not declared
  3752           IF V-NOMBRE-VALNOM(I-VALNOM) =
*  12-S****************************                                    (  77)**
**    Operand V-NOMBRE-VALNOM is not declared
  3754              ADD 1 TO LETRAS-OK-VALNOM
*  12-S**************************************                          (  77)**
**    Operand LETRAS-OK-VALNOM is not declared
  3755              ADD 1 TO I-VALNOM
*  12-S******************************                                  (  77)**
**    Operand I-VALNOM is not declared
  3756              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  77)**
**    Operand J-VALNOM is not declared
  3758              ADD 1 TO J-VALNOM
*  12-S******************************                                  (  77)**
**    Operand J-VALNOM is not declared
  3759           END-IF
* 564-S****************                                                (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3761           ADD 1 TO I-VALNOM
*  12-S***************************                                     (  77)**
**    Operand I-VALNOM is not declared
  3762        END-IF
* 564-S*************                                                   (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3763     END-PERFORM
* 564-S***************                                                 (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3764     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
*  12-S***********************                                         (  77)**
**    Operand LETRAS-OK-VALNOM is not declared
  3765        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
*  12-S****************************                                    (  77)**
**    Operand LETRAS-OK-VALNOM is not declared
  3766     END-IF
* 564-S**********                                                      (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3767     ADD 1 TO K-VALNOM
*  12-S*********************                                           (  77)**
**    Operand K-VALNOM is not declared
  3768   END-PERFORM.
* 564-S*************                                                   (  77)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3769   MOVE 1 TO I-VALNOM
*  12-S********************                                            (  77)**
**    Operand I-VALNOM is not declared
  3770   PERFORM UNTIL I-VALNOM > 65
*  12-S************************                                        (  77)**
**    Operand I-VALNOM is not declared
  3771     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
*  12-S**********************                                          (  77)**
**    Operand V-NOMBRE-VALNOM is not declared
  3773        ADD 1 TO TOTLET-INP-VALNOM
*  12-S*********************************                               (  78)**
**    Operand TOTLET-INP-VALNOM is not declared
  3774     END-IF
* 564-S**********                                                      (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3775     ADD 1 TO I-VALNOM
*  12-S*********************                                           (  78)**
**    Operand I-VALNOM is not declared
  3776   END-PERFORM.
* 564-S*************                                                   (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3777   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
*  12-S******************                                              (  78)**
**    Operand A-VALNOM is not declared
  3779   IF A-VALNOM >= 75
*  12-S*************                                                   (  78)**
**    Operand A-VALNOM is not declared
  3780       ADD 1 TO BLOQOK-AUX-VALNOM
*  12-S********************************                                (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3781   END-IF.
* 564-S********                                                        (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3782    MOVE 0 TO K-VALNOM                                            GJC0003
*  12-S*********************                                           (  78)**
**    Operand K-VALNOM is not declared
  3783   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
*  12-S**********************                                          (  78)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3784      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
*  12-S************************                                        (  78)**
**    Operand A-VALNOM is not declared
  3785      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
*  12-S*****************************                                   (  78)**
**    Operand J-VALNOM is not declared
  3786               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  78)**
**    Operand V-NOMBRE-VALNOM is not declared
  3787                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  78)**
**    Operand V-NOMBRE-VALNOM is not declared
  3789                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
*  12-S**********************************************                  (  78)**
**    Operand CONT-LET-INPUT-VALNOM is not declared
  3790              END-IF                                              GJC0003
* 564-S*******************                                             (  78)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3791               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
*  12-S********************************                                (  78)**
**    Operand V-NOMBOK-VALNOM is not declared
  3792                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
*  12-S*************************************************               (  78)**
**    Operand V-NOMBOK-VALNOM is not declared
  3794                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
*  12-S*******************************************                     (  79)**
**    Operand CONT-LET-OK-VALNOM is not declared
  3795              END-IF                                              GJC0003
* 564-S*******************                                             (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3796      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3797      MOVE 0 TO I-VALNOM                                          GJC0003
*  12-S***********************                                         (  79)**
**    Operand I-VALNOM is not declared
  3798       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
*  12-S******************************                                  (  79)**
**    Operand J-VALNOM is not declared
  3799         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
*  12-S*****************************                                   (  79)**
**    Operand CONT-LET-OK-VALNOM is not declared
  3800            ADD 1 TO I-VALNOM                                     GJC0003
*  12-S****************************                                    (  79)**
**    Operand I-VALNOM is not declared
  3801            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
*  12-S********************************                                (  79)**
**    Operand CONT-LET-OK-VALNOM is not declared
  3803               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
*  12-S******************************                                  (  79)**
**    Operand L-VALNOM is not declared
  3805               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
*  12-S******************************                                  (  79)**
**    Operand L-VALNOM is not declared
  3808            END-IF                                                GJC0003
* 564-S*****************                                               (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3809         END-IF                                                   GJC0003
* 564-S**************                                                  (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3810      END-PERFORM                                                 GJC0003
* 564-S****************                                                (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3811      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
*  12-S*********************                                           (  79)**
**    Operand K-VALNOM is not declared
  3812       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
*  12-S******************                                              (  79)**
**    Operand A-VALNOM is not declared
  3815         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
*  12-S**********************************                              (  79)**
**    Operand BLOQOK-AUX-VALNOM is not declared
  3816       END-IF                                                     GJC0003
* 564-S************                                                    (  79)**
**    A scope-delimiter did not have a matching verb and was discarded.
  3817   END-IF.                                                        GJC0003
* 564-S********                                                        (  80)**
**    A scope-delimiter did not have a matching verb and was discarded.
* Total Messages:   352
* Unrecoverable :     0                    Severe  :   352
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       23748     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo $ls -la CARGAJUR*
-rw-rw-r--   1 icdgd    icdatacr   75586 May 15 17:16 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr  139008 May 15 17:16 CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr  270534 May 15 17:16 CARGAJUR.lst
/d/iccol/desarrollo $vi CARGAJUR.lst
"CARGAJUR.lst" 4737 lines, 270534 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 17:16 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.3 PROGRAM-ID.    ACTALEJUR.^"CARGAJUR.lst" 4737 lines, 270534 characters^/  2122         delimited by all spaces  2099
  2100
  2101 4900-GRABAR-ERROR.
  2102******************************************************************
  2103* El registro de JURAD tiene error: se graba en el archivo ERRS
  2104* con indicacion del error detectado
  2105******************************************************************
  2106* TODO: >>>> implementar la grabación del archivo ERRS
  2107     display "NO GRABA ERRS".
  2108
  2109
  2110 4320-ARMAR-TEXTO-ALERTA.
  2111****************************************************************
  2112* Hace el reemplazo de los valores adecuados en los templates
  2113* de las linea de alerta que corresponde
  2114****************************************************************
  2115*    según se trate de demandas o embargos
  2116     if JURAD-demandas-vigentes not = 0
  2117     or JURAD-demandas-terminadas not = 0
  2118set LAx to 1
  2119move high-values to LA-valores
  2120move JURAD-demandas-vigentes to LA-num
  2121unstring LA-num into LA-descarte LA-valor(1)
  2122delimited by all spaces
* 301-S*****************(   0)**
**    Unrecognized verb
  2123move JURAD-demandas-terminadas to LA-num
  2124unstring LA-num into LA-descarte LA-valor(2)
  2125delimited by all spaces
* 301-S*****************(  38)**
**    Unrecognized verb
  2126string LA-parte(LAx, 1) LA-valor(1)
  2127string LA-parte(LAx, 2) LA-valor(2)
*  83-S**************(  38)**
**    Reserved word missing - DELIMITED expected.
  2128string LA-parte(LAx, 3) LA-valor(3)
*  83-S**************(  38)**
**    Reserved word missing - DELIMITED expected.
  2129string LA-parte(LAx, 4) LA-valor(4)
*  83-S**************(  38)**
**    Reserved word missing - DELIMITED expected.
  2130string LA-parte(LAx, 5) LA-valor(5)
*  83-S**************(  38)**
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 17:16 Page  39
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
**    Reserved word missing - DELIMITED expected.
  2131string LA-parte(LAx, 6) LA-valor(6)
*  83-S**************(  38)**
**    Reserved word missing - DELIMITED expected.   1808     if JURAD-tipo-novedad = "E"
  1809exit paragraph
  1810     end-if
  1811*    Nombres y Apellidos
  1812     if JURAD-nombre = spaces
  1813call "PONERR" using "05" JURAD-reg E-errores
  1814     end-if
  1815*    Numero de demandas vigentes
  1816     if JURAD-demandas-vigentes is not numeric
  1817call "PONERR" using "06" JURAD-reg E-errores
  1818     end-if
  1819*    Numero de demandas terminadas
  1820     if JURAD-demandas-terminadas is not numeric
  1821call "PONERR" using "07" JURAD-reg E-errores
  1822     end-if
  1823*    Fecha ultima demanda vigente YYMMDD
  1824     if JURAD-demandas-fecha-ultima is not numeric
  1825call "PONERR" using "08" JURAD-reg E-errores
  1826     end-if
  1827     if JURAD-demandas-fecha-ultima(1:2) > "50"
  1828string "19" JURAD-demandas-fecha-ultima into
  1829VALIDACIONES-FECHAS
  1830     else
  1831string "20" JURAD-demandas-fecha-ultima into
  1832VALIDACIONES-FECHAS
  1833     end-if
  1834     if not ANO-VAL or not MES-VAL or not DIA-VAL
  1835call "PONERR" using "09" JURAD-reg E-errores
  1836     end-if
  1837*    Numero de embargos vigentes
  1838     if JURAD-embargos-vigentes not numeric
  1839call "PONERR" using "10" JURAD-reg E-errores
  1840     end-if
  1841*    Numero de embargos terminados
  1842     if JURAD-embargos-terminados not numeric
  1843call "PONERR" using "11" JURAD-reg E-errores
  1844     end-if
  1845*    Fecha ultimo embargo vigente YYMMDD
  1846     if JURAD-embargos-fecha-ultimo is not numeric
  1847call "PONERR" using "12" JURAD-reg E-errores
  1848     end-if
  1849     if JURAD-embargos-fecha-ultimo(1:2) > "50"
  1850string "19" JURAD-embargos-fecha-ultimo into
  1851VALIDACIONES-FECHAS
^L^M* Micro Focus Server ExpressV5.1 revision 000 15-May-14 17:16 Page  34
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/ICFILE.WS)
  1852     else
  1853string "20" JURAD-embargos-fecha-ultimo into
  1854VALIDACIONES-FECHASINPUT MODE*****************                                               (   0)**
INPUT MODE**    Unrecognized verb
INPUT MODE  2125         delimited by all spaces
INPUT MODE* 301-S*****************                                               (  38)**
INPUT MODE**    Unrecognized verb
INPUT MODE  2127         string LA-parte(LAx, 2) LA-valor(2)
INPUT MODE*  83-S**************                                                  (  38)**
INPUT MODE**    Reserved word missing - DELIMITED expected.
INPUT MODE  2128         string LA-parte(LAx, 3) LA-valor(3)
INPUT MODE*  83-S**************                                                  (  38)**
INPUT MODE**    Reserved word missing - DELIMITED expected.
INPUT MODE  2129         string LA-parte(LAx, 4) LA-valor(4)
INPUT MODE*  83-S**************                                                  (  38)**
INPUT MODE**    Reserved word missing - DELIMITED expected.
INPUT MODE  2130         string LA-parte(LAx, 5) LA-valor(5)
INPUT MODE*  83-S**************                                                  (  38)**
INPUT MODE**    Reserved word missing - DELIMITED expected.
INPUT MODE  2131         string LA-parte(LAx, 6) LA-valor(6)
INPUT MODE*  83-S**************                                                  (  38)**
INPUT MODE**    Reserved word missing - DE
INPUT MODE/d/iccol/desarrollo $^C
/d/iccol/desarrollo $^C
/d/iccol/desarrollo $:q
ksh: :q:  not found
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
03 E-hay-errorpic xx.*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input(1:80) not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay reg-input(1:80)move reg-input(1:80) to reg-input-anteriorend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchexit program.copy BDIIVIDE.PROC.copy VALNOM.PROC.end program PONERR.end program ACTALEJUR.


[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo $^[  /d/iccol/desarrollo $fg:qvi CARGAJUR.lstvi             ARGAJUR.lst
"ARGAJUR.lst" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"ARGAJUR.lst" [New file]:q/d/iccol/desarrollo $^[  /d/iccol/desarrollo $vi ARGAJUR.lstvi               
/d/iccol/desarrollo $fg
vi CARGAJUR.CBL
03 E-hay-errorpic xx.*    contador de registros con error03 E-cont-regs-con-error     pic 9(8).
*    tabla de errores03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).******************************************************************PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input(1:80) not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay reg-input(1:80)move reg-input(1:80) to reg-input-anteriorend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-errorwhen E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-searchexit program.copy BDIIVIDE.PROC.copy VALNOM.PROC.end program PONERR.end program ACTALEJUR.


:q/d/iccol/desarrollo $^D
