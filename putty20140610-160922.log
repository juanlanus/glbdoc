=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.06.10 16:09:22 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Tue Jun 10 07:50:11 2014 from 172.16.10.59
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
You have new mail.
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fu. visetvi CARGAJUR.CBL.errdes-c-v CARGAJUR   fg              vi CARGAJUR.CBL.errdes-c-v CARGAJUR   fg              vi CARGAJUR.CBL.errdes-c-v CARGAJUR   fg              vi CARGAJUR.CBL.errvi CARGAJUR.CBL    
"CARGAJUR.CBL" 1639 lines, 68786 characters $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"CARGAJUR.CBL" 1639 lines, 68786 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1639 lines deletedNo lines in buffer:set noai nosmAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           copy ICBDIR.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  NO-COINCIDE-REGIS            pic 9(7) value 0.

APPEND MODE       01  CONT-FALLECIDOS              pic 9(7) value 0.

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE      *  posible: COPY BDAMATCH.WS.

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4200-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificación contra las bases de

APPEND MODE      *    datos de validación de información BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cédula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE      *           MOVE "A"      TO ORIGEN-VAL

APPEND MODE                  PERFORM  301-GRABA-LOS-VALIDOS

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           copy BDAMATCH.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

"CARGAJUR.CBL" [Modified] line 1662 of 1662 --100%-- 
:qNo write since last change (:quit! overrides)
:w"CARGAJUR.CBL" 1662 lines, 70071 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi CARGAJUR.CBLfu             . visetvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:   101
* Unrecoverable :     0                    Severe  :   101
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1429196     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>vi  CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 303 lines, 35307 characters * Rejected - OPT
  3419add 1 to NO-COINCIDE-REGIS796
*   5-S******************************************(   0)**797
**    User-name NO-COINCIDE-REGIS not unique797
  3420add 1 to CONT-FALLECIDOS797
*   5-S****************************************(  60)**799
**    User-name CONT-FALLECIDOS not unique799
  4773MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017BDLDIR299
*  12-S****************************(  60)**299
**    Operand FECULT-DIRECC is not declared299
  4787MOVE FECULT-DIRECCAAM0017BDLDIR313
*  12-S****************************(  84)**314
**    Operand FECULT-DIRECC is not declared314
  4802MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017BDLDIR328
*  12-S****************************(  84)**328
**    Operand FECULT-DIRECC is not declared328
  4816MOVE FECULT-DIRECCAAM0017BDLDIR342
*  12-S****************************(  84)**343
**    Operand FECULT-DIRECC is not declared343
  4832MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017BDLDIR358
*  12-S****************************(  85)**358
**    Operand FECULT-DIRECC is not declared358
  4852IF FECDRES-DIRECC > 0VHF0015BDLDIR378
*  12-S***************************(  85)**378
**    Operand FECDRES-DIRECC is not declared378
  4853MOVE FECDRES-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR379
*  12-S********************************(  85)**379
**    Operand FECDRES-DIRECC is not declared379
  4854END-IFRMB0010BDLDIR380
* 564-S****************(  85)**381
**    A scope-delimiter did not have a matching verb and was discarded.381
  4856IF FECDLAB-DIRECC > 0VHF0015BDLDIR382
*  12-S***************************(  85)**382
**    Operand FECDLAB-DIRECC is not declared382
  4857MOVE FECDLAB-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR383
*  12-S********************************(  86)**383
**    Operand FECDLAB-DIRECC is not declared383
  4858END-IFRMB0010BDLDIR384
* 564-S****************(  86)**385
**    A scope-delimiter did not have a matching verb and was discarded.385
  4860IF FECDCOR-DIRECC > 0VHF0015BDLDIR386
*  12-S***************************(  86)**386
**    Operand FECDCOR-DIRECC is not declared386
  4861MOVE FECDCOR-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR387
*  12-S********************************(  86)**387
**    Operand FECDCOR-DIRECC is not declared387
  4862END-IFRMB0010BDLDIR388
* 564-S****************(  86)**389
**    A scope-delimiter did not have a matching verb and was discarded.389"CARGAJUR.CBL.err" 303 lines, 35307 characters* Rejected - OPT
  3419add 1 to NO-COINCIDE-REGIS796
*   5-S******************************************(   0)**797
**    User-name NO-COINCIDE-REGIS not unique797
  3420add 1 to CONT-FALLECIDOS797
*   5-S****************************************(  60)**799
**    User-name CONT-FALLECIDOS not unique799
  4773MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017BDLDIR299
*  12-S****************************(  60)**299
**    Operand FECULT-DIRECC is not declared299
  4787MOVE FECULT-DIRECCAAM0017BDLDIR313
*  12-S****************************(  84)**314
**    Operand FECULT-DIRECC is not declared314
  4802MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017BDLDIR328
*  12-S****************************(  84)**328
**    Operand FECULT-DIRECC is not declared328
  4816MOVE FECULT-DIRECCAAM0017BDLDIR342
*  12-S****************************(  84)**343
**    Operand FECULT-DIRECC is not declared343
  4832MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017BDLDIR358
*  12-S****************************(  85)**358
**    Operand FECULT-DIRECC is not declared358
  4852IF FECDRES-DIRECC > 0VHF0015BDLDIR378
*  12-S***************************(  85)**378
**    Operand FECDRES-DIRECC is not declared378
  4853MOVE FECDRES-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR379
*  12-S********************************(  85)**379
**    Operand FECDRES-DIRECC is not declared379
  4854END-IFRMB0010BDLDIR380
* 564-S****************(  85)**381
**    A scope-delimiter did not have a matching verb and was discarded.381
  4856IF FECDLAB-DIRECC > 0VHF0015BDLDIR382
*  12-S***************************(  85)**382
**    Operand FECDLAB-DIRECC is not declared382
  4857MOVE FECDLAB-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR383
*  12-S********************************(  86)**383
**    Operand FECDLAB-DIRECC is not declared383
  4858END-IFRMB0010BDLDIR384
* 564-S****************(  86)**385
**    A scope-delimiter did not have a matching verb and was discarded.385
  4860IF FECDCOR-DIRECC > 0VHF0015BDLDIR386
*  12-S***************************(  86)**386
**    Operand FECDCOR-DIRECC is not declared386
  4861MOVE FECDCOR-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR387
*  12-S********************************(  86)**387
**    Operand FECDCOR-DIRECC is not declared387
  4862END-IFRMB0010BDLDIR388
* 564-S****************(  86)**389
**    A scope-delimiter did not have a matching verb and was discarded.389
  4883IF FECTRES-DIRECC > 0VHF0015BDLDIR409    4883IF FECTRES-DIRECC > 0VHF0015BDLDIR409
*  12-S***************************(  86)**409
**    Operand FECTRES-DIRECC is not declared409
  4884MOVE FECTRES-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR410
*  12-S********************************(  86)**410
**    Operand FECTRES-DIRECC is not declared410
  4885END-IFVHF0015BDLDIR411
* 564-S****************(  86)**412
**    A scope-delimiter did not have a matching verb and was discarded.412
  4887IF FECTLAB-DIRECC > 0VHF0015BDLDIR413
*  12-S***************************(  86)**413
**    Operand FECTLAB-DIRECC is not declared413
  4888MOVE FECTLAB-DIRECC TO FECHA-MEJOR-BDLDIRVHF0015BDLDIR414
*  12-S********************************(  86)**414
**    Operand FECTLAB-DIRECC is not declared414
  4889END-IFVHF0015BDLDIR415
* 564-S****************(  86)**416
**    A scope-delimiter did not have a matching verb and was discarded.416
  5076IF CERRES-DIRECC NUMERICRMB0010BDLDIR602
*  12-S********************************(  86)**603
**    Operand CERRES-DIRECC is not declared603
  5077MOVE CERRES-DIRECC TO DIRCER-BDLDIRRMB0010BDLDIR603
*  12-S*************************************(  90)**603
**    Operand CERRES-DIRECC is not declared603
  5079IF ADIRES-DIRECC NUMERICRMB0010BDLDIR605
*  12-S********************************(  90)**606
**    Operand ADIRES-DIRECC is not declared606
  5080MOVE ADIRES-DIRECC TO PTSADI-BDLDIRRMB0010BDLDIR606
*  12-S*************************************(  90)**606
**    Operand ADIRES-DIRECC is not declared606
  5081END-IFRMB0010BDLDIR607
* 564-S**********************(  90)**608
**    A scope-delimiter did not have a matching verb and was discarded.608
  5087IF CERLAB-DIRECC NUMERICRMB0010BDLDIR613
*  12-S********************************(  90)**614
**    Operand CERLAB-DIRECC is not declared614
  5088MOVE CERLAB-DIRECC TO DIRCER-BDLDIRRMB0010BDLDIR614
*  12-S*************************************(  90)**614
**    Operand CERLAB-DIRECC is not declared614
  5089END-IFRMB0010BDLDIR615
* 564-S**********************(  90)**616
**    A scope-delimiter did not have a matching verb and was discarded.616
  5090IF ADILAB-DIRECC NUMERICRMB0010BDLDIR616
*  12-S********************************(  90)**617
**    Operand ADILAB-DIRECC is not declared617
  5091MOVE ADILAB-DIRECC TO PTSADI-BDLDIRRMB0010BDLDIR617
*  12-S*************************************(  90)**617
**    Operand ADILAB-DIRECC is not declared617
  5092END-IFRMB0010BDLDIR618  
* 564-S**********************(  90)**619* 564-S**********************(  90)**619
**    A scope-delimiter did not have a matching verb and was discarded.619
  5098IF CERCOR-DIRECC NUMERICRMB0010BDLDIR624
*  12-S********************************(  90)**625
**    Operand CERCOR-DIRECC is not declared625
  5099MOVE CERCOR-DIRECC TO DIRCER-BDLDIRRMB0010BDLDIR625
*  12-S*************************************(  91)**625
**    Operand CERCOR-DIRECC is not declared625
  5100END-IFRMB0010BDLDIR626
* 564-S**********************(  91)**627
**    A scope-delimiter did not have a matching verb and was discarded.627
  5101IF ADICOR-DIRECC NUMERICRMB0010BDLDIR627
*  12-S********************************(  91)**628
**    Operand ADICOR-DIRECC is not declared628
  5102MOVE ADICOR-DIRECC TO PTSADI-BDLDIRRMB0010BDLDIR628
*  12-S*************************************(  91)**628
**    Operand ADICOR-DIRECC is not declared628
  5103END-IFRMB0010BDLDIR629
* 564-S**********************(  91)**630
**    A scope-delimiter did not have a matching verb and was discarded.630
  5104END-EVALUATERMB0010BDLDIR630
* 564-S**********************(  91)**631
**    A scope-delimiter did not have a matching verb and was discarded.631
  5130END-PERFORMBDLDIR656
* 564-S******************(  91)**657
**    A scope-delimiter did not have a matching verb and was discarded.657
  5297     END-IF.BDLDIR823
* 564-S**********(  91)**823
**    A scope-delimiter did not have a matching verb and was discarded.823
  6503IF FEC-AAAAMM-BDLDI2 < FECRES-DIRECCRMB0028BDLDIR2029
*  12-S*******************************************(  94)**2030
**    Operand FECRES-DIRECC is not declared2030
  6504MOVE FEC-AAAAMM-BDLDI2 TO FECRES-DIRECCRMB0028BDLDIR2030
*  12-S*************************************************( 115)**2033
**    Operand FECRES-DIRECC is not declared2033
  6507IF FEC-AAAAMM-BDLDI2 < FECLAB-DIRECCRMB0028BDLDIR2033
*  12-S*******************************************( 115)**2034
**    Operand FECLAB-DIRECC is not declared2034
  6508MOVE FEC-AAAAMM-BDLDI2 TO FECLAB-DIRECCRMB0028BDLDIR2034
*  12-S*************************************************( 115)**2037
**    Operand FECLAB-DIRECC is not declared2037
  6509END-IFRMB0028BDLDIR2035
* 564-S*************( 115)**2037
**    A scope-delimiter did not have a matching verb and was discarded.2037
  6511IF FEC-AAAAMM-BDLDI2 < FECCOR-DIRECCRMB0028BDLDIR2037
*  12-S*******************************************( 115)**2038
**    Operand FECCOR-DIRECC is not declared2038
  6512MOVE FEC-AAAAMM-BDLDI2 TO FECCOR-DIRECCRMB0028BDLDIR2038
*  12-S*************************************************( 115)**2041
**    Operand FECCOR-DIRECC is not declared2041**    Operand FECCOR-DIRECC is not declared2041
  6513END-IFRMB0028BDLDIR2039
* 564-S*************( 115)**2041
**    A scope-delimiter did not have a matching verb and was discarded.2041
  6515IF FEC-AAAAMM-BDLDI2 < FECCEL-DIRECCRMB0028BDLDIR2041
*  12-S*******************************************( 115)**2042
**    Operand FECCEL-DIRECC is not declared2042
  6516MOVE FEC-AAAAMM-BDLDI2 TO FECCEL-DIRECCRMB0028BDLDIR2042
*  12-S*************************************************( 116)**2045
**    Operand FECCEL-DIRECC is not declared2045
  6517END-IFRMB0028BDLDIR2043
* 564-S*************( 116)**2045
**    A scope-delimiter did not have a matching verb and was discarded.2045
  6519IF FEC-AAAAMM-BDLDI2 < FECTRES-DIRECCRMB0028BDLDIR2045
*  12-S********************************************( 116)**2046
**    Operand FECTRES-DIRECC is not declared2046
  6520MOVE FEC-AAAAMM-BDLDI2 TO FECTRES-DIRECCRMB0028BDLDIR2046
*  12-S**************************************************( 116)**2049
**    Operand FECTRES-DIRECC is not declared2049
  6521END-IFRMB0028BDLDIR2047
* 564-S*************( 116)**2049
**    A scope-delimiter did not have a matching verb and was discarded.2049
  6523IF FEC-AAAAMM-BDLDI2 < FECTLAB-DIRECCRMB0028BDLDIR2049
*  12-S********************************************( 116)**2050
**    Operand FECTLAB-DIRECC is not declared2050
  6524MOVE FEC-AAAAMM-BDLDI2 TO FECTLAB-DIRECCRMB0028BDLDIR2050
*  12-S**************************************************( 116)**2053
**    Operand FECTLAB-DIRECC is not declared2053
  6525END-IFRMB0028BDLDIR2051
* 564-S*************( 116)**2053
**    A scope-delimiter did not have a matching verb and was discarded.2053
  6527IF FEC-AAAAMM-BDLDI2 < FECMAIL-DIRECCRMB0028BDLDIR2053
*  12-S********************************************( 116)**2054
**    Operand FECMAIL-DIRECC is not declared2054
  6528MOVE FEC-AAAAMM-BDLDI2 TO FECMAIL-DIRECCRMB0028BDLDIR2054
*  12-S**************************************************( 116)**2056
**    Operand FECMAIL-DIRECC is not declared2056
  6529END-IFRMB0028BDLDIR2055
* 564-S*************( 116)**2056
**    A scope-delimiter did not have a matching verb and was discarded.2056
  6530     END-IF.RMB0028BDLDIR2056
* 564-S**********( 116)**2056
**    A scope-delimiter did not have a matching verb and was discarded.2056
  8009 1000-U-RECORRER-CSV-BDAMATCH.BDAMATCH40
* 304-S*****************************( 116)**40
**    Procedure name 1000-U-RECORRER-CSV-BDAMATCH not unique40
  8096 1100-MAQUILLAR-NOMBRE-MAQ.RMB0004BDAMATCH     127
* 304-S**************************( 142)**127
**    Procedure name 1100-MAQUILLAR-NOMBRE-MAQ not unique127
  8222  1000-CAMBIAR-TILDE-MAQ.RMB0004BDAMATCH     253    8222  1000-CAMBIAR-TILDE-MAQ.RMB0004BDAMATCH     253
* 304-S************************( 143)**253
**    Procedure name 1000-CAMBIAR-TILDE-MAQ not unique253
  8245 1100-LLENAR-CSV-APE-BDAMATCH.RMB0004BDAMATCH     276
* 304-S*****************************( 145)**276
**    Procedure name 1100-LLENAR-CSV-APE-BDAMATCH not unique276
  8260 1100-LLENAR-AUX-BDAMATCH.RMB0004BDAMATCH     291
* 304-S*************************( 146)**291
**    Procedure name 1100-LLENAR-AUX-BDAMATCH not unique291
  8277 1100-UBICAR-CHKCRE-CSV-BDAMATCH.BDAMATCH     308
* 304-S********************************( 146)**308
**    Procedure name 1100-UBICAR-CHKCRE-CSV-BDAMATCH not unique308
  8326 1200-PROC-REG-CSV-BDAMATCH.BDAMATCH     357
* 304-S***************************( 146)**357
**    Procedure name 1200-PROC-REG-CSV-BDAMATCH not unique357
  8351 1210-DIRTEL-BDACSV-BDAMATCH.BDAMATCH     382
* 304-S****************************( 147)**382
**    Procedure name 1210-DIRTEL-BDACSV-BDAMATCH not unique382
  8416 1000-U-INICIALIZAR-BDAMATCH.BDAMATCH     447
* 304-S****************************( 148)**447
**    Procedure name 1000-U-INICIALIZAR-BDAMATCH not unique447
  8437 2000-U-INSERTAR-DIR-BDAMATCH.BDAMATCH     468
* 304-S*****************************( 149)**468
**    Procedure name 2000-U-INSERTAR-DIR-BDAMATCH not unique468
  8483 2000-U-INSERTAR-TEL-BDAMATCH.BDAMATCH     514
* 304-S*****************************( 149)**514
**    Procedure name 2000-U-INSERTAR-TEL-BDAMATCH not unique514
  8501 2000-U-INSERTAR-NOM-BDAMATCH.BDAMATCH     532
* 304-S*****************************( 150)**532
**    Procedure name 2000-U-INSERTAR-NOM-BDAMATCH not unique532
  8548 2000-U-INSERTAR-CTA-BDAMATCH.BDAMATCH     579
* 304-S*****************************( 151)**579
**    Procedure name 2000-U-INSERTAR-CTA-BDAMATCH not unique579
  8568 3000-U-ORDENAR-DIR-BDAMATCH.BDAMATCH     599
* 304-S****************************( 151)**599
**    Procedure name 3000-U-ORDENAR-DIR-BDAMATCH not unique599
  8614 3000-U-ORDENAR-TEL-BDAMATCH.BDAMATCH     645
* 304-S****************************( 152)**645
**    Procedure name 3000-U-ORDENAR-TEL-BDAMATCH not unique645
  8661 3000-U-ORDENAR-NOM-BDAMATCH.BDAMATCH     692
* 304-S****************************( 153)**692
**    Procedure name 3000-U-ORDENAR-NOM-BDAMATCH not unique692
  8810 4000-U-INTERELACIONAR-BDAMATCH.BDAMATCH     841
* 304-S*******************************( 153)**841
**    Procedure name 4000-U-INTERELACIONAR-BDAMATCH not unique841
  8840 4100-BUSCAR-RELACION-BDAMATCH.BDAMATCH     871
* 304-S******************************( 156)**871
**    Procedure name 4100-BUSCAR-RELACION-BDAMATCH not unique871
  8860 4110-MOVER-RELACIONES-BDAMATCH.BDAMATCH     891  
* 304-S*******************************( 157)**891* 304-S*******************************( 157)**891
**    Procedure name 4110-MOVER-RELACIONES-BDAMATCH not unique891
  8897 5000-U-MEJOR-PORTAFOL-BDAMATCH.BDAMATCH     928
* 304-S*******************************( 157)**928
**    Procedure name 5000-U-MEJOR-PORTAFOL-BDAMATCH not unique928
  8938 5100-CALCULAR-PESO-DIR-BDAMATCH.RMB0004BDAMATCH     969
* 304-S********************************( 158)**969
**    Procedure name 5100-CALCULAR-PESO-DIR-BDAMATCH not unique969
  8950 5200-CALCULAR-PESO-TEL-BDAMATCH.RMB0004BDAMATCH     981
* 304-S********************************( 158)**981
**    Procedure name 5200-CALCULAR-PESO-TEL-BDAMATCH not unique981
  8962 5300-CALCULAR-PESO-CTA-BDAMATCH.RMB0004BDAMATCH     993
* 304-S********************************( 159)**993
**    Procedure name 5300-CALCULAR-PESO-CTA-BDAMATCH not unique993
  8993 5400-DEDUCIR-MEJ-PORT-BDAMATCH.RMB0004BDAMATCH    1024
* 304-S*******************************( 159)**1024
**    Procedure name 5400-DEDUCIR-MEJ-PORT-BDAMATCH not unique1024
  9006 5410-DESEMPATAR-BDAMATCH.RMB0004BDAMATCH    1037
* 304-S*************************( 159)**1037
**    Procedure name 5410-DESEMPATAR-BDAMATCH not unique1037
  9030 5000-U-VALIDAR-CUENTA-BDAMATCH.BDAMATCH    1061
* 304-S*******************************( 160)**1061
**    Procedure name 5000-U-VALIDAR-CUENTA-BDAMATCH not unique1061
  9051 6000-U-MEJOR-DIR-BDAMATCH.BDAMATCH    1082
* 304-S**************************( 160)**1082
**    Procedure name 6000-U-MEJOR-DIR-BDAMATCH not unique1082
  9063 6000-U-MEJOR-TEL-BDAMATCH.BDAMATCH    1094
* 304-S**************************( 161)**1094
**    Procedure name 6000-U-MEJOR-TEL-BDAMATCH not unique1094
  9074 6000-U-MEJOR-NOM-BDAMATCH.BDAMATCH    1105
* 304-S**************************( 161)**1105
**    Procedure name 6000-U-MEJOR-NOM-BDAMATCH not unique1105
  9113 9000-U-REALIZAR-BDAMATCH.BDAMATCH    1144
* 304-S*************************( 161)**1144
**    Procedure name 9000-U-REALIZAR-BDAMATCH not unique1144
  9151 400-BUSCAR-SUSC-GRUPO-BDAMATCH.BDAMATCH    1182
* 304-S*******************************( 162)**1182
**    Procedure name 400-BUSCAR-SUSC-GRUPO-BDAMATCH not unique1182
  9444PERFORM 8000-U-VER-CTAABD07-BDAMATCHAMNISTIA     273
* 304-S*************************************************( 162)**274
**    Procedure name 8000-U-VER-CTAABD07-BDAMATCH not unique274
 10776PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002LEEMAEST     125
* 304-S****************************************************( 168)**127
**    Procedure name 8000-U-VER-CTAABD07-BDAMATCH not unique127
 10788PERFORM 8000-U-VER-CTAABD07-BDAMATCHLEEMAEST     137
* 304-S****************************************************( 190)**139
**    Procedure name 8000-U-VER-CTAABD07-BDAMATCH not unique139
 10871PERFORM 8000-U-VER-CTAABD07-BDAMATCHGJC0002LEEMAEST     220
* 304-S****************************************************( 191)**222
**    Procedure name 8000-U-VER-CTAABD07-BDAMATCH not unique222**    Procedure name 8000-U-VER-CTAABD07-BDAMATCH not unique222
 10883PERFORM 8000-U-VER-CTAABD07-BDAMATCHLEEMAEST     232
* 304-S****************************************************( 192)**234
**    Procedure name 8000-U-VER-CTAABD07-BDAMATCH not unique234
* 348-S***********************( 192)**1570
**    Procedure name 4240-CONTAR-TIPO-CUENTA undeclared, line 3245 (first usage)1570
* 348-S*********************( 196)**1570
**    Procedure name 301-GRABA-LOS-VALIDOS undeclared, line 4163 (first usage)1570
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q!/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1662 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           copy ICBDIR.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE           COPY ICBDIR0001.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificación contra las bases de

APPEND MODE      *    datos de validación de información BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cédula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4240-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1658 lines, 69825 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi  CARGAJUR.CBL.errdes-c-v CARGAJUR    
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:    90
* Unrecoverable :     0                    Severe  :    90
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1429668     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              vi  CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 271 lines, 31563 characters * Rejected - OPT
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
*   5-S************(  29)**511
**    User-name LLAVE-DIRECC not unique511
  4759IF CIURES-DIRECC NOT = SPACESRMB0010BDLDIR187
*   5-S**********************(  58)**187
**    User-name CIURES-DIRECC not unique187
  4760MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR188
*   5-S****************************(  84)**188
**    User-name CIURES-DIRECC not unique188
  4762MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*   5-S**********************************************************(  84)**192
**    User-name CIURES-DIRECC not unique192
  4763END-IFRMB0010BDLDIR191
* 564-S*************(  84)**192
**    A scope-delimiter did not have a matching verb and was discarded.192
  4764IF CIUCOR-DIRECC NOT = SPACESRMB0010BDLDIR192
*   5-S***********************(  84)**192
**    User-name CIUCOR-DIRECC not unique192
  4765MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR193
*   5-S****************************(  84)**193
**    User-name CIUCOR-DIRECC not unique193
  4767MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*   5-S**********************************************************(  84)**197
**    User-name CIUCOR-DIRECC not unique197
  4768END-IFRMB0010BDLDIR196
* 564-S*************(  84)**197
**    A scope-delimiter did not have a matching verb and was discarded.197
  4769IF CIULAB-DIRECC NOT = SPACESRMB0010BDLDIR197
*   5-S***********************(  84)**197
**    User-name CIULAB-DIRECC not unique197
  4770MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR198
*   5-S****************************(  84)**198
**    User-name CIULAB-DIRECC not unique198
  4772MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*   5-S**********************************************************(  84)**201
**    User-name CIULAB-DIRECC not unique201
  4773END-IF.RMB0010BDLDIR201
* 564-S*************(  84)**201
**    A scope-delimiter did not have a matching verb and was discarded.201
  4838     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIRRMB0010BDLDIR266
*   5-S**********************(  84)**266
**    User-name CIURES-DIRECC not unique266
  4839     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIRRMB0010BDLDIR267
*   5-S**********************(  86)**267
**    User-name CIULAB-DIRECC not unique267
  4840     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.RMB0010BDLDIR268"CARGAJUR.CBL.err" 271 lines, 31563 characters* Rejected - OPT
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
*   5-S************(  29)**511
**    User-name LLAVE-DIRECC not unique511
  4759IF CIURES-DIRECC NOT = SPACESRMB0010BDLDIR187
*   5-S**********************(  58)**187
**    User-name CIURES-DIRECC not unique187
  4760MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR188
*   5-S****************************(  84)**188
**    User-name CIURES-DIRECC not unique188
  4762MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*   5-S**********************************************************(  84)**192
**    User-name CIURES-DIRECC not unique192
  4763END-IFRMB0010BDLDIR191
* 564-S*************(  84)**192
**    A scope-delimiter did not have a matching verb and was discarded.192
  4764IF CIUCOR-DIRECC NOT = SPACESRMB0010BDLDIR192
*   5-S***********************(  84)**192
**    User-name CIUCOR-DIRECC not unique192
  4765MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR193
*   5-S****************************(  84)**193
**    User-name CIUCOR-DIRECC not unique193
  4767MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*   5-S**********************************************************(  84)**197
**    User-name CIUCOR-DIRECC not unique197
  4768END-IFRMB0010BDLDIR196
* 564-S*************(  84)**197
**    A scope-delimiter did not have a matching verb and was discarded.197
  4769IF CIULAB-DIRECC NOT = SPACESRMB0010BDLDIR197
*   5-S***********************(  84)**197
**    User-name CIULAB-DIRECC not unique197
  4770MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR198
*   5-S****************************(  84)**198
**    User-name CIULAB-DIRECC not unique198
  4772MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*   5-S**********************************************************(  84)**201
**    User-name CIULAB-DIRECC not unique201
  4773END-IF.RMB0010BDLDIR201
* 564-S*************(  84)**201
**    A scope-delimiter did not have a matching verb and was discarded.201
  4838     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIRRMB0010BDLDIR266
*   5-S**********************(  84)**266
**    User-name CIURES-DIRECC not unique266
  4839     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIRRMB0010BDLDIR267
*   5-S**********************(  86)**267
**    User-name CIULAB-DIRECC not unique267
  4840     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.RMB0010BDLDIR268
*   5-S**********************(  86)**268
**    User-name CIUCOR-DIRECC not unique268
  4860     IF CIURES-DIRECC NOT = SPACESBDLDIR288**    User-name CIUCOR-DIRECC not unique268
  4860     IF CIURES-DIRECC NOT = SPACESBDLDIR288
*   5-S********************(  86)**288
**    User-name CIURES-DIRECC not unique288
  4861IF DIRRES-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010BDLDIR289
*   5-S***********************(  86)**289
**    User-name DIRRES-DIRECC not unique289
  4862MOVE DIRRES-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR290
*   5-S****************************(  86)**290
**    User-name DIRRES-DIRECC not unique290
  4865MOVE CIURES-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR293
*   5-S****************************(  86)**293
**    User-name CIURES-DIRECC not unique293
  4866MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010BDLDIR294
*   5-S*****************************(  86)**294
**    User-name COD-SUS-DIRECC not unique294
  4867MOVE DIRRES-DIRECC TO T-CARDIR-BDLDIRRMB0010BDLDIR295
*   5-S****************************(  86)**295
**    User-name DIRRES-DIRECC not unique295
  4873END-IFBDLDIR301
* 564-S*************(  86)**302
**    A scope-delimiter did not have a matching verb and was discarded.302
  4874IF TELRES-DIRECC > 0 AND TEL-OK-BDLDIR < 100 ANDRMB0010BDLDIR302
*   5-S***********************(  87)**302
**    User-name TELRES-DIRECC not unique302
  4876MOVE CIURES-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010BDLDIR304
*   5-S****************************(  87)**304
**    User-name CIURES-DIRECC not unique304
  4877MOVE TELRES-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010BDLDIR305
*   5-S****************************(  87)**305
**    User-name TELRES-DIRECC not unique305
  4879MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010BDLDIR307
*   5-S*****************************(  87)**307
**    User-name COD-SUS-DIRECC not unique307
  4888     END-IF.BDLDIR316
* 564-S**********(  87)**316
**    A scope-delimiter did not have a matching verb and was discarded.316
  4889     IF CIULAB-DIRECC NOT = SPACESFAC0009BDLDIR317
*   5-S********************(  87)**317
**    User-name CIULAB-DIRECC not unique317
  4890IF DIRLAB-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010BDLDIR318
*   5-S***********************(  87)**318
**    User-name DIRLAB-DIRECC not unique318
  4891MOVE DIRLAB-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR319
*   5-S****************************(  87)**319
**    User-name DIRLAB-DIRECC not unique319
  4894MOVE CIULAB-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR322
*   5-S****************************(  87)**322
**    User-name CIULAB-DIRECC not unique322
  4895MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010BDLDIR323
*   5-S*****************************(  87)**323
**    User-name COD-SUS-DIRECC not unique323* Rejected - OPT
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
*   5-S************(  29)**511
**    User-name LLAVE-DIRECC not unique511
  4759IF CIURES-DIRECC NOT = SPACESRMB0010BDLDIR187
*   5-S**********************(  58)**187
**    User-name CIURES-DIRECC not unique187
  4760MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR188
*   5-S****************************(  84)**188
**    User-name CIURES-DIRECC not unique188
  4762MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECCRMB0010BDLDIR190
*   5-S**********************************************************(  84)**192
**    User-name CIURES-DIRECC not unique192
  4763END-IFRMB0010BDLDIR191
* 564-S*************(  84)**192
**    A scope-delimiter did not have a matching verb and was discarded.192
  4764IF CIUCOR-DIRECC NOT = SPACESRMB0010BDLDIR192
*   5-S***********************(  84)**192
**    User-name CIUCOR-DIRECC not unique192
  4765MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR193
*   5-S****************************(  84)**193
**    User-name CIUCOR-DIRECC not unique193
  4767MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECCRMB0010BDLDIR195
*   5-S**********************************************************(  84)**197
**    User-name CIUCOR-DIRECC not unique197
  4768END-IFRMB0010BDLDIR196
* 564-S*************(  84)**197
**    A scope-delimiter did not have a matching verb and was discarded.197
  4769IF CIULAB-DIRECC NOT = SPACESRMB0010BDLDIR197
*   5-S***********************(  84)**197
**    User-name CIULAB-DIRECC not unique197
  4770MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIURMB0010BDLDIR198
*   5-S****************************(  84)**198
**    User-name CIULAB-DIRECC not unique198
  4772MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECCRMB0010BDLDIR200
*   5-S**********************************************************(  84)**201
**    User-name CIULAB-DIRECC not unique201
  4773END-IF.RMB0010BDLDIR201
* 564-S*************(  84)**201
**    A scope-delimiter did not have a matching verb and was discarded.201
  4838     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIRRMB0010BDLDIR266
*   5-S**********************(  84)**266
**    User-name CIURES-DIRECC not unique266
  4839     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIRRMB0010BDLDIR267
*   5-S**********************(  86)**267
**    User-name CIULAB-DIRECC not unique267
  4840     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.RMB0010BDLDIR268
*   5-S**********************(  86)**268
**    User-name CIUCOR-DIRECC not unique268
  4860     IF CIURES-DIRECC NOT = SPACESBDLDIR288  
*   5-S********************(  86)**288*   5-S********************(  86)**288
**    User-name CIURES-DIRECC not unique288
  4861IF DIRRES-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010BDLDIR289
*   5-S***********************(  86)**289
**    User-name DIRRES-DIRECC not unique289
  4862MOVE DIRRES-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR290
*   5-S****************************(  86)**290
**    User-name DIRRES-DIRECC not unique290
  4865MOVE CIURES-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR293
*   5-S****************************(  86)**293
**    User-name CIURES-DIRECC not unique293
  4866MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010BDLDIR294
*   5-S*****************************(  86)**294
**    User-name COD-SUS-DIRECC not unique294
  4867MOVE DIRRES-DIRECC TO T-CARDIR-BDLDIRRMB0010BDLDIR295
*   5-S****************************(  86)**295
**    User-name DIRRES-DIRECC not unique295
  4873END-IFBDLDIR301
* 564-S*************(  86)**302
**    A scope-delimiter did not have a matching verb and was discarded.302
  4874IF TELRES-DIRECC > 0 AND TEL-OK-BDLDIR < 100 ANDRMB0010BDLDIR302
*   5-S***********************(  87)**302
**    User-name TELRES-DIRECC not unique302
  4876MOVE CIURES-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010BDLDIR304
*   5-S****************************(  87)**304
**    User-name CIURES-DIRECC not unique304
  4877MOVE TELRES-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010BDLDIR305
*   5-S****************************(  87)**305
**    User-name TELRES-DIRECC not unique305
  4879MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010BDLDIR307
*   5-S*****************************(  87)**307
**    User-name COD-SUS-DIRECC not unique307
  4888     END-IF.BDLDIR316
* 564-S**********(  87)**316
**    A scope-delimiter did not have a matching verb and was discarded.316
  4889     IF CIULAB-DIRECC NOT = SPACESFAC0009BDLDIR317
*   5-S********************(  87)**317
**    User-name CIULAB-DIRECC not unique317
  4890IF DIRLAB-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010BDLDIR318
*   5-S***********************(  87)**318
**    User-name DIRLAB-DIRECC not unique318
  4891MOVE DIRLAB-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR319
*   5-S****************************(  87)**319
**    User-name DIRLAB-DIRECC not unique319
  4894MOVE CIULAB-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010BDLDIR322
*   5-S****************************(  87)**322
**    User-name CIULAB-DIRECC not unique322
  4895MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010BDLDIR323
*   5-S*****************************(  87)**323
**    User-name COD-SUS-DIRECC not unique323
  4896MOVE DIRLAB-DIRECC TO T-CARDIR-BDLDIRRMB0010BDLDIR324
*   5-S****************************(  87)**324
**    User-name DIRLAB-DIRECC not unique324**    User-name DIRLAB-DIRECC not unique324
  4902END-IFFAC0009BDLDIR330
* 564-S*************(  87)**331
**    A scope-delimiter did not have a matching verb and was discarded.331
  4903IF TELLAB-DIRECC > 0 AND TEL-OK-BDLDIR < 100 ANDRMB0010BDLDIR331
*   5-S***********************(  87)**331
**    User-name TELLAB-DIRECC not unique331
  4905MOVE CIULAB-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010BDLDIR333
*   5-S****************************(  88)**333
**    User-name CIULAB-DIRECC not unique333
  4906MOVE TELLAB-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010BDLDIR334
*   5-S****************************(  88)**334
**    User-name TELLAB-DIRECC not unique334
  4908MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010BDLDIR336
*   5-S*****************************(  88)**336
**    User-name COD-SUS-DIRECC not unique336
  4917END-IFFAC0009BDLDIR345
* 564-S*************(  88)**346
**    A scope-delimiter did not have a matching verb and was discarded.346
  4918     END-IF.FAC0009BDLDIR346
* 564-S**********(  88)**346
**    A scope-delimiter did not have a matching verb and was discarded.346
  4919     IF CIUCOR-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100 AND    RMB0010BDLDIR347
*   5-S********************(  88)**347
**    User-name CIUCOR-DIRECC not unique347
  4921MOVE CIUCOR-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)   RMB0010BDLDIR349
*   5-S*************************(  88)**349
**    User-name CIUCOR-DIRECC not unique349
  4922MOVE DIRCOR-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)   RMB0010BDLDIR350
*   5-S*************************(  88)**350
**    User-name DIRCOR-DIRECC not unique350
  4923MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)     RMB0010BDLDIR351
*   5-S**************************(  88)**351
**    User-name COD-SUS-DIRECC not unique351
  4926MOVE DIRCOR-DIRECC TO T-CARDIR-BDLDIRRMB0010BDLDIR354
*   5-S*************************(  88)**354
**    User-name DIRCOR-DIRECC not unique354
  4932     END-IF.BDLDIR360
* 564-S**********(  88)**360
**    A scope-delimiter did not have a matching verb and was discarded.360
  4945     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016BDLDIR373
*   5-S**********************(  88)**373
**    User-name FECAPE-DIRECC not unique373
  4976     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016BDLDIR404
*   5-S**********************(  89)**404
**    User-name FECAPE-DIRECC not unique404
  6503     MOVE COD-SUS-DIRECC TO COD-SUSCRIP-ABD02.RMB0003BDLDIR1931
*   5-S***********************(  89)**1931
**    User-name COD-SUS-DIRECC not unique1931
  6534     MOVE TIPO-ID-DIRECC TO TIPO-ID-ABD07 TIPO-ID-ABD06FAC0009BDLDIR1962
*   5-S***********************( 116)**1962
**    User-name TIPO-ID-DIRECC not unique1962
  6535     MOVE NUM-ID-DIRECC  TO NUM-ID-ABD07  NUM-ID-ABD06FAC0009BDLDIR1963    6535     MOVE NUM-ID-DIRECC  TO NUM-ID-ABD07  NUM-ID-ABD06FAC0009BDLDIR1963
*   5-S**********************( 116)**1963
**    User-name NUM-ID-DIRECC not unique1963
  6536     MOVE COD-SUS-DIRECC TO COD-SUS-ABD07 COD-SUS-ABD06FAC0009BDLDIR1964
*   5-S***********************( 116)**1964
**    User-name COD-SUS-DIRECC not unique1964
  6537     MOVE COD-CTA-DIRECC TO COD-CTA-ABD07 COD-CTA-ABD06FAC0009BDLDIR1965
*   5-S***********************( 116)**1965
**    User-name COD-CTA-DIRECC not unique1965
  6538     MOVE NUM-CTA-DIRECC TO NUM-CTA-ABD07 NUM-CTA-ABD06FAC0009BDLDIR1966
*   5-S***********************( 116)**1966
**    User-name NUM-CTA-DIRECC not unique1966
  6540IF COD-CTA-DIRECC = 1RMB0003BDLDIR1968
*   5-S************************( 116)**1968
**    User-name COD-CTA-DIRECC not unique1968
  6565     END-IF.RMB0003BDLDIR1993
* 564-S**********( 116)**1993
**    A scope-delimiter did not have a matching verb and was discarded.1993
  6576     IF COD-CTA-DIRECC = 1RMB0028BDLDIR2004
*   5-S*********************( 117)**2004
**    User-name COD-CTA-DIRECC not unique2004
  6582     ELSERMB0028BDLDIR2010
* 562-S********( 117)**2011
**    An "ELSE" phrase did not have a matching IF and was discarded.2011
  6589     END-IF.RMB0028BDLDIR2017
* 564-S**********( 117)**2017
**    A scope-delimiter did not have a matching verb and was discarded.2017
  7236     MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.BDAMATCH     371
*   5-S*********************************************( 117)**371
**    User-name LLAVE-DIRECC not unique371
  7241MOVE SPACES TO LLAVE-DIRECCRMB0004BDAMATCH     376
*   5-S****************************************( 129)**377
**    User-name LLAVE-DIRECC not unique377
  7243     IF LLAVE-DIRECC <> SPACESRMB0004BDAMATCH     378
*   5-S*******************( 129)**378
**    User-name LLAVE-DIRECC not unique378
  7245     END-IF.RMB0004BDAMATCH     380
* 564-S**********( 129)**380
**    A scope-delimiter did not have a matching verb and was discarded.380
  7253     IF CIURES-DIRECC NOT = SPACESBDAMATCH     388
*   5-S********************( 129)**388
**    User-name CIURES-DIRECC not unique388
  7254IF DIRRES-DIRECC NOT = SPACESBDAMATCH     389
*   5-S***********************( 129)**389
**    User-name DIRRES-DIRECC not unique389
  7255MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCHBDAMATCH     390
*   5-S****************************( 129)**390
**    User-name DIRRES-DIRECC not unique390
  7257END-IFBDAMATCH     392
* 564-S*************( 129)**393
**    A scope-delimiter did not have a matching verb and was discarded.393
  7258IF TELRES-DIRECC > 0 ANDBDAMATCH     393  
*   5-S***********************( 129)**393*   5-S***********************( 129)**393
**    User-name TELRES-DIRECC not unique393
  7260MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCHBDAMATCH     395
*   5-S****************************( 129)**395
**    User-name TELRES-DIRECC not unique395
  7262END-IFBDAMATCH     397
* 564-S*************( 129)**398
**    A scope-delimiter did not have a matching verb and was discarded.398
  7263     END-IF.BDAMATCH     398
* 564-S**********( 129)**398
**    A scope-delimiter did not have a matching verb and was discarded.398
  7264     IF CIULAB-DIRECC NOT = SPACESBDAMATCH     399
*   5-S********************( 129)**399
**    User-name CIULAB-DIRECC not unique399
  7265IF DIRLAB-DIRECC NOT = SPACESBDAMATCH     400
*   5-S***********************( 129)**400
**    User-name DIRLAB-DIRECC not unique400
  7266MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCHBDAMATCH     401
*   5-S****************************( 130)**401
**    User-name DIRLAB-DIRECC not unique401
  7268END-IFBDAMATCH     403
* 564-S*************( 130)**404
**    A scope-delimiter did not have a matching verb and was discarded.404
  7269IF TELLAB-DIRECC > 0 ANDBDAMATCH     404
*   5-S***********************( 130)**404
**    User-name TELLAB-DIRECC not unique404
  7271MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCHBDAMATCH     406
*   5-S****************************( 130)**406
**    User-name TELLAB-DIRECC not unique406
  7273END-IFBDAMATCH     408
* 564-S*************( 130)**409
**    A scope-delimiter did not have a matching verb and was discarded.409
  7274     END-IF.BDAMATCH     409
* 564-S**********( 130)**409
**    A scope-delimiter did not have a matching verb and was discarded.409
  7275     IF CIUCOR-DIRECC NOT = SPACES ANDBDAMATCH     410
*   5-S********************( 130)**410
**    User-name CIUCOR-DIRECC not unique410
  7277MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCHBDAMATCH     412
*   5-S*************************( 130)**412
**    User-name DIRCOR-DIRECC not unique412
  7279     END-IF.BDAMATCH     414
* 564-S**********( 130)**414
**    A scope-delimiter did not have a matching verb and was discarded.414
  9907MOVE REG-DIRECCTO REG-ICBDIR-LEEMSTRS.LEEMAEST     360
*   5-S********************( 130)**360
**    User-name REG-DIRECC not unique360
  9942IF REG-DIRECC<> REG-ICBDIR-LEEMSTRS ANDLEEMAEST     395
*   5-S******************( 175)**395
**    User-name REG-DIRECC not unique395
  9944MOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECCLEEMAEST     397
*   5-S**********************************************( 176)**398
**    User-name REG-DIRECC not unique398**    User-name REG-DIRECC not unique398
  9945START MAESTRO-DIRECC KEY = LLAVE-DIRECCLEEMAEST     398
*   5-S***********************************************( 176)**399
**    User-name LLAVE-DIRECC not unique399
  9949END-STARTLEEMAEST     402
* 564-S*****************( 176)**403
**    A scope-delimiter did not have a matching verb and was discarded.403
  9950END-IF.LEEMAEST     403
* 564-S***********( 176)**403
**    A scope-delimiter did not have a matching verb and was discarded.403
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi  CARGAJUR.CBL.err  CARGAJUR.CBL.err  l  CARGAJUR.CBL.errs  CARGAJUR.CBL.err   CARGAJUR.CBL.err-  CARGAJUR.CBL.errl  CARGAJUR.CBL.errl  CARGAJUR        *
-rw-rw-r--   1 icjlud   icdatacr   61357 Jun 10 11:50 CARGAJUR-OLD.CBL
-rw-rw-r--   1 icdgd    icdatacr   69825 Jun 10 14:23 CARGAJUR.CBL
-rw-rw-r--   1 icjlud   icdatacr   31563 Jun 10 14:23 CARGAJUR.CBL.err
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
-rw-rw-r--   1 icjlud   icdatacr  266240 Jun  9 19:28 CARGAJUR.idy
-rw-rw-r--   1 icjlud   icdatacr  834289 Jun  9 19:28 CARGAJUR.lst
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>/cob64cob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>asm $FUENTES/PESVNOZZ.cbl                        <                                                  /d/iccol/desarrollo/fuentes>cob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>asm $FUENTES/CARGAJUR.CBL                        <cob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -o qqq -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
  1630 FD  MAESTRO-DIRECC.                                                                          ICBDIR00      32
*  82-S**                                                              (   0)**                                   32
**    COBOL Division or Section header encountered in incorrect order                                             32
*   5-S************                                                    (  29)**                                  511
**    User-name LLAVE-DIRECC not unique                                                                          511
".............COMPILANDO BDLDIR SIN MATCH **********
  4759       IF CIURES-DIRECC NOT = SPACES                              RMB0010                     BDLDIR       187
*   5-S**********************                                          (  58)**                                  187
**    User-name CIURES-DIRECC not unique                                                                         187
  4760           MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010                     BDLDIR       188
*   5-S****************************                                    (  84)**                                  188
**    User-name CIURES-DIRECC not unique                                                                         188
  4762           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECC       RMB0010                     BDLDIR       190
*   5-S**********************************************************      (  84)**                                  192
**    User-name CIURES-DIRECC not unique                                                                         192
  4763        END-IF                                                    RMB0010                     BDLDIR       191
* 564-S*************                                                   (  84)**                                  192
**    A scope-delimiter did not have a matching verb and was discarded.                                          192
  4764        IF CIUCOR-DIRECC NOT = SPACES                             RMB0010                     BDLDIR       192
*   5-S***********************                                         (  84)**                                  192
**    User-name CIUCOR-DIRECC not unique                                                                         192
  4765           MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010                     BDLDIR       193
*   5-S****************************                                    (  84)**                                  193
**    User-name CIUCOR-DIRECC not unique                                                                         193
  4767           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECC       RMB0010                     BDLDIR       195
*   5-S**********************************************************      (  84)**                                  197
**    User-name CIUCOR-DIRECC not unique                                                                         197
  4768        END-IF                                                    RMB0010                     BDLDIR       196
* 564-S*************                                                   (  84)**                                  197
**    A scope-delimiter did not have a matching verb and was discarded.                                          197
  4769        IF CIULAB-DIRECC NOT = SPACES                             RMB0010                     BDLDIR       197
*   5-S***********************                                         (  84)**                                  197
**    User-name CIULAB-DIRECC not unique                                                                         197
  4770           MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010                     BDLDIR       198
*   5-S****************************                                    (  84)**                                  198
**    User-name CIULAB-DIRECC not unique                                                                         198
  4772           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECC       RMB0010                     BDLDIR       200
*   5-S**********************************************************      (  84)**                                  201
**    User-name CIULAB-DIRECC not unique                                                                         201
  4773        END-IF.                                                   RMB0010                     BDLDIR       201
* 564-S*************                                                   (  84)**                                  201
**    A scope-delimiter did not have a matching verb and was discarded.                                          201
  4838     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIR           RMB0010                     BDLDIR       266
*   5-S**********************                                          (  84)**                                  266
**    User-name CIURES-DIRECC not unique                                                                         266
  4839     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIR           RMB0010                     BDLDIR       267
*   5-S**********************                                          (  86)**                                  267
**    User-name CIULAB-DIRECC not unique                                                                         267
  4840     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.          RMB0010                     BDLDIR       268
*   5-S**********************                                          (  86)**                                  268
**    User-name CIUCOR-DIRECC not unique                                                                         268
  4860     IF CIURES-DIRECC NOT = SPACES                                                            BDLDIR       288
*   5-S********************                                            (  86)**                                  288
**    User-name CIURES-DIRECC not unique                                                                         288
  4861        IF DIRRES-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010                     BDLDIR       289
*   5-S***********************                                         (  86)**                                  289
**    User-name DIRRES-DIRECC not unique                                                                         289
  4862           MOVE DIRRES-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       290
*   5-S****************************                                    (  86)**                                  290
**    User-name DIRRES-DIRECC not unique                                                                         290
  4865           MOVE CIURES-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       293
*   5-S****************************                                    (  86)**                                  293
**    User-name CIURES-DIRECC not unique                                                                         293
  4866           MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010                     BDLDIR       294
*   5-S*****************************                                   (  86)**                                  294
**    User-name COD-SUS-DIRECC not unique                                                                        294
  4867           MOVE DIRRES-DIRECC TO T-CARDIR-BDLDIR                  RMB0010                     BDLDIR       295
*   5-S****************************                                    (  86)**                                  295
**    User-name DIRRES-DIRECC not unique                                                                         295
  4873        END-IF                                                                                BDLDIR       301
* 564-S*************                                                   (  86)**                                  302
**    A scope-delimiter did not have a matching verb and was discarded.                                          302
  4874        IF TELRES-DIRECC > 0 AND TEL-OK-BDLDIR < 100 AND          RMB0010                     BDLDIR       302
*   5-S***********************                                         (  87)**                                  302
**    User-name TELRES-DIRECC not unique                                                                         302
  4876           MOVE CIURES-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010                     BDLDIR       304
*   5-S****************************                                    (  87)**                                  304
**    User-name CIURES-DIRECC not unique                                                                         304
  4877           MOVE TELRES-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010                     BDLDIR       305
*   5-S****************************                                    (  87)**                                  305
**    User-name TELRES-DIRECC not unique                                                                         305
  4879           MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010                     BDLDIR       307
*   5-S*****************************                                   (  87)**                                  307
**    User-name COD-SUS-DIRECC not unique                                                                        307
  4888     END-IF.                                                                                  BDLDIR       316
* 564-S**********                                                      (  87)**                                  316
**    A scope-delimiter did not have a matching verb and was discarded.                                          316
  4889     IF CIULAB-DIRECC NOT = SPACES                                FAC0009                     BDLDIR       317
*   5-S********************                                            (  87)**                                  317
**    User-name CIULAB-DIRECC not unique                                                                         317
  4890        IF DIRLAB-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010                     BDLDIR       318
*   5-S***********************                                         (  87)**                                  318
**    User-name DIRLAB-DIRECC not unique                                                                         318
  4891           MOVE DIRLAB-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       319
*   5-S****************************                                    (  87)**                                  319
**    User-name DIRLAB-DIRECC not unique                                                                         319
  4894           MOVE CIULAB-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       322
*   5-S****************************                                    (  87)**                                  322
**    User-name CIULAB-DIRECC not unique                                                                         322
  4895           MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010                     BDLDIR       323
*   5-S*****************************                                   (  87)**                                  323
**    User-name COD-SUS-DIRECC not unique                                                                        323
  4896           MOVE DIRLAB-DIRECC TO T-CARDIR-BDLDIR                  RMB0010                     BDLDIR       324
*   5-S****************************                                    (  87)**                                  324
**    User-name DIRLAB-DIRECC not unique                                                                         324
  4902        END-IF                                                    FAC0009                     BDLDIR       330
* 564-S*************                                                   (  87)**                                  331
**    A scope-delimiter did not have a matching verb and was discarded.                                          331
  4903        IF TELLAB-DIRECC > 0 AND TEL-OK-BDLDIR < 100 AND          RMB0010                     BDLDIR       331
*   5-S***********************                                         (  87)**                                  331
**    User-name TELLAB-DIRECC not unique                                                                         331
  4905           MOVE CIULAB-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010                     BDLDIR       333
*   5-S****************************                                    (  88)**                                  333
**    User-name CIULAB-DIRECC not unique                                                                         333
  4906           MOVE TELLAB-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010                     BDLDIR       334
*   5-S****************************                                    (  88)**                                  334
**    User-name TELLAB-DIRECC not unique                                                                         334
  4908           MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010                     BDLDIR       336
*   5-S*****************************                                   (  88)**                                  336
**    User-name COD-SUS-DIRECC not unique                                                                        336
  4917        END-IF                                                    FAC0009                     BDLDIR       345
* 564-S*************                                                   (  88)**                                  346
**    A scope-delimiter did not have a matching verb and was discarded.                                          346
  4918     END-IF.                                                      FAC0009                     BDLDIR       346
* 564-S**********                                                      (  88)**                                  346
**    A scope-delimiter did not have a matching verb and was discarded.                                          346
  4919     IF CIUCOR-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100 AND    RMB0010                     BDLDIR       347
*   5-S********************                                            (  88)**                                  347
**    User-name CIUCOR-DIRECC not unique                                                                         347
  4921        MOVE CIUCOR-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)   RMB0010                     BDLDIR       349
*   5-S*************************                                       (  88)**                                  349
**    User-name CIUCOR-DIRECC not unique                                                                         349
  4922        MOVE DIRCOR-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)   RMB0010                     BDLDIR       350
*   5-S*************************                                       (  88)**                                  350
**    User-name DIRCOR-DIRECC not unique                                                                         350
  4923        MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)     RMB0010                     BDLDIR       351
*   5-S**************************                                      (  88)**                                  351
**    User-name COD-SUS-DIRECC not unique                                                                        351
  4926        MOVE DIRCOR-DIRECC TO T-CARDIR-BDLDIR                     RMB0010                     BDLDIR       354
*   5-S*************************                                       (  88)**                                  354
**    User-name DIRCOR-DIRECC not unique                                                                         354
  4932     END-IF.                                                                                  BDLDIR       360
* 564-S**********                                                      (  88)**                                  360
**    A scope-delimiter did not have a matching verb and was discarded.                                          360
  4945     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016                     BDLDIR       373
*   5-S**********************                                          (  88)**                                  373
**    User-name FECAPE-DIRECC not unique                                                                         373
  4976     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016                     BDLDIR       404
*   5-S**********************                                          (  89)**                                  404
**    User-name FECAPE-DIRECC not unique                                                                         404
  6503     MOVE COD-SUS-DIRECC TO COD-SUSCRIP-ABD02.                    RMB0003                     BDLDIR      1931
*   5-S***********************                                         (  89)**                                 1931
**    User-name COD-SUS-DIRECC not unique                                                                       1931
  6534     MOVE TIPO-ID-DIRECC TO TIPO-ID-ABD07 TIPO-ID-ABD06           FAC0009                     BDLDIR      1962
*   5-S***********************                                         ( 116)**                                 1962
**    User-name TIPO-ID-DIRECC not unique                                                                       1962
  6535     MOVE NUM-ID-DIRECC  TO NUM-ID-ABD07  NUM-ID-ABD06            FAC0009                     BDLDIR      1963
*   5-S**********************                                          ( 116)**                                 1963
**    User-name NUM-ID-DIRECC not unique                                                                        1963
  6536     MOVE COD-SUS-DIRECC TO COD-SUS-ABD07 COD-SUS-ABD06           FAC0009                     BDLDIR      1964
*   5-S***********************                                         ( 116)**                                 1964
**    User-name COD-SUS-DIRECC not unique                                                                       1964
  6537     MOVE COD-CTA-DIRECC TO COD-CTA-ABD07 COD-CTA-ABD06           FAC0009                     BDLDIR      1965
*   5-S***********************                                         ( 116)**                                 1965
**    User-name COD-CTA-DIRECC not unique                                                                       1965
  6538     MOVE NUM-CTA-DIRECC TO NUM-CTA-ABD07 NUM-CTA-ABD06           FAC0009                     BDLDIR      1966
*   5-S***********************                                         ( 116)**                                 1966
**    User-name NUM-CTA-DIRECC not unique                                                                       1966
  6540        IF COD-CTA-DIRECC = 1                                     RMB0003                     BDLDIR      1968
*   5-S************************                                        ( 116)**                                 1968
**    User-name COD-CTA-DIRECC not unique                                                                       1968
  6565     END-IF.                                                      RMB0003                     BDLDIR      1993
* 564-S**********                                                      ( 116)**                                 1993
**    A scope-delimiter did not have a matching verb and was discarded.                                         1993
  6576     IF COD-CTA-DIRECC = 1                                        RMB0028                     BDLDIR      2004
*   5-S*********************                                           ( 117)**                                 2004
**    User-name COD-CTA-DIRECC not unique                                                                       2004
  6582     ELSE                                                         RMB0028                     BDLDIR      2010
* 562-S********                                                        ( 117)**                                 2011
**    An "ELSE" phrase did not have a matching IF and was discarded.                                            2011
  6589     END-IF.                                                      RMB0028                     BDLDIR      2017
* 564-S**********                                                      ( 117)**                                 2017
**    A scope-delimiter did not have a matching verb and was discarded.                                         2017
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
  7236     MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.                                               BDAMATCH     371
*   5-S*********************************************                   ( 117)**                                  371
**    User-name LLAVE-DIRECC not unique                                                                          371
  7241              MOVE SPACES TO LLAVE-DIRECC                         RMB0004                     BDAMATCH     376
*   5-S****************************************                        ( 129)**                                  377
**    User-name LLAVE-DIRECC not unique                                                                          377
  7243     IF LLAVE-DIRECC <> SPACES                                    RMB0004                     BDAMATCH     378
*   5-S*******************                                             ( 129)**                                  378
**    User-name LLAVE-DIRECC not unique                                                                          378
  7245     END-IF.                                                      RMB0004                     BDAMATCH     380
* 564-S**********                                                      ( 129)**                                  380
**    A scope-delimiter did not have a matching verb and was discarded.                                          380
  7253     IF CIURES-DIRECC NOT = SPACES                                                            BDAMATCH     388
*   5-S********************                                            ( 129)**                                  388
**    User-name CIURES-DIRECC not unique                                                                         388
  7254        IF DIRRES-DIRECC NOT = SPACES                                                         BDAMATCH     389
*   5-S***********************                                         ( 129)**                                  389
**    User-name DIRRES-DIRECC not unique                                                                         389
  7255           MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCH                                           BDAMATCH     390
*   5-S****************************                                    ( 129)**                                  390
**    User-name DIRRES-DIRECC not unique                                                                         390
  7257        END-IF                                                                                BDAMATCH     392
* 564-S*************                                                   ( 129)**                                  393
**    A scope-delimiter did not have a matching verb and was discarded.                                          393
  7258        IF TELRES-DIRECC > 0 AND                                                              BDAMATCH     393
*   5-S***********************                                         ( 129)**                                  393
**    User-name TELRES-DIRECC not unique                                                                         393
  7260           MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCH                                           BDAMATCH     395
*   5-S****************************                                    ( 129)**                                  395
**    User-name TELRES-DIRECC not unique                                                                         395
  7262        END-IF                                                                                BDAMATCH     397
* 564-S*************                                                   ( 129)**                                  398
**    A scope-delimiter did not have a matching verb and was discarded.                                          398
  7263     END-IF.                                                                                  BDAMATCH     398
* 564-S**********                                                      ( 129)**                                  398
**    A scope-delimiter did not have a matching verb and was discarded.                                          398
  7264     IF CIULAB-DIRECC NOT = SPACES                                                            BDAMATCH     399
*   5-S********************                                            ( 129)**                                  399
**    User-name CIULAB-DIRECC not unique                                                                         399
  7265        IF DIRLAB-DIRECC NOT = SPACES                                                         BDAMATCH     400
*   5-S***********************                                         ( 129)**                                  400
**    User-name DIRLAB-DIRECC not unique                                                                         400
  7266           MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCH                                           BDAMATCH     401
*   5-S****************************                                    ( 130)**                                  401
**    User-name DIRLAB-DIRECC not unique                                                                         401
  7268        END-IF                                                                                BDAMATCH     403
* 564-S*************                                                   ( 130)**                                  404
**    A scope-delimiter did not have a matching verb and was discarded.                                          404
  7269        IF TELLAB-DIRECC > 0 AND                                                              BDAMATCH     404
*   5-S***********************                                         ( 130)**                                  404
**    User-name TELLAB-DIRECC not unique                                                                         404
  7271           MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCH                                           BDAMATCH     406
*   5-S****************************                                    ( 130)**                                  406
**    User-name TELLAB-DIRECC not unique                                                                         406
  7273        END-IF                                                                                BDAMATCH     408
* 564-S*************                                                   ( 130)**                                  409
**    A scope-delimiter did not have a matching verb and was discarded.                                          409
  7274     END-IF.                                                                                  BDAMATCH     409
* 564-S**********                                                      ( 130)**                                  409
**    A scope-delimiter did not have a matching verb and was discarded.                                          409
  7275     IF CIUCOR-DIRECC NOT = SPACES AND                                                        BDAMATCH     410
*   5-S********************                                            ( 130)**                                  410
**    User-name CIUCOR-DIRECC not unique                                                                         410
  7277        MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCH                                              BDAMATCH     412
*   5-S*************************                                       ( 130)**                                  412
**    User-name DIRCOR-DIRECC not unique                                                                         412
  7279     END-IF.                                                                                  BDAMATCH     414
* 564-S**********                                                      ( 130)**                                  414
**    A scope-delimiter did not have a matching verb and was discarded.                                          414
  9907      MOVE REG-DIRECC      TO REG-ICBDIR-LEEMSTRS.                                            LEEMAEST     360
*   5-S********************                                            ( 130)**                                  360
**    User-name REG-DIRECC not unique                                                                            360
  9942      IF REG-DIRECC      <> REG-ICBDIR-LEEMSTRS AND                                           LEEMAEST     395
*   5-S******************                                              ( 175)**                                  395
**    User-name REG-DIRECC not unique                                                                            395
  9944         MOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECC                                               LEEMAEST     397
*   5-S**********************************************                  ( 176)**                                  398
**    User-name REG-DIRECC not unique                                                                            398
  9945         START MAESTRO-DIRECC KEY = LLAVE-DIRECC                                              LEEMAEST     398
*   5-S***********************************************                 ( 176)**                                  399
**    User-name LLAVE-DIRECC not unique                                                                          399
  9949         END-START                                                                            LEEMAEST     402
* 564-S*****************                                               ( 176)**                                  403
**    A scope-delimiter did not have a matching verb and was discarded.                                          403
  9950      END-IF.                                                                                 LEEMAEST     403
* 564-S***********                                                     ( 176)**                                  403
**    A scope-delimiter did not have a matching verb and was discarded.                                          403
* Total Messages:    90
* Unrecoverable :     0                    Severe  :    90
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1429668     Code:           0
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>ls -l  CARGAJUR*                                  /d/iccol/desarrollo/fuentes>vi  CARGAJUR.CBL.errvi  CARGAJUR.       lst
"CARGAJUR.lst" 10615 lines, 1226612 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING LISTWIDTH"120"1
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"120" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.23 PROGRAM-ID.    CARGAJUR.34******************************************************************45* Actualizacion del archivo de alertas con los datos provistos56* por Jurad6^"CARGAJUR.lst" 10615 lines, 1226612 characters^/llave-direcc   121* Archivos de base alterna50122******************************************************************51
*  123     copy BDACSV.FS.52
   124* BDACSV-FS.V.0001BDACSV1
   125* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DEBDACSV2
   126* DATOS OFICIALES DE REGIS, DIAN Y DASBDACSV3
   127     SELECT BDACSVBDACSV4
   128ASSIGN TO DISK "$DATABASE/BDACSV"BDACSV5
   129ORGANIZATION IS INDEXEDBDACSV6
   130ACCESS MODE IS DYNAMICBDACSV7
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page   4
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/BDACSV.FS)
   131RECORD KEY IS LLAVE-BDACSVBDACSV8
   132LOCK MODE IS MANUAL WITH LOCK ON RECORD.BDACSV9
*  133     copy ICBDIR.FS.53
   134* ICBDIR-fs.v01.002ICBDIR1
   135* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADAICBDIR2
   136* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   137 $SET IDXFORMAT"8"ICBDIR4
   138ICBDIR5
   139$SET CONSTANT SW-STATUS-ICBDIR"NO"ICBDIR6
   140     SELECT MAESTRO-DIRECCICBDIR7
   141ASSIGN TO DISK MAES-DIRECC-TITLEICBDIR8
   142ORGANIZATION IS INDEXEDICBDIR9
   143ACCESS MODE IS DYNAMICICBDIR10
   144RECORD KEY IS LLAVE-DIRECCICBDIR11
   145$IF SW-STATUS-ICBDIR = "NO"ICBDIR12
   146$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."ICBDIR13
   147$ELSEICBDIR14
   148$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."ICBDIR15
   149XFILE STATUS IS EST-ICBDIRICBDIR16
   150$ENDICBDIR17
   151LOCK MODE IS MANUAL WITH LOCK ON RECORD.ICBDIR18
   152 $SET IDXFORMAT"0"ICBDIR19
*  153     copy BDLCLI.FS.54
   154*BDLCLI-FS.v.0001BDLCLI1
   155*ARCHIVO DE  CLIENTES DE BASE DE DATOS DE LOCALIZACION CON INDICADOR YBDLCLI2
   156*PRIVILEGIO ACTUALIZADO.BDLCLI3
   157    SELECT BDLCLIBDLCLI4
   158ASSIGN TO DISK BDLCLI-TITLEBDLCLI5
   159ORGANIZATION IS INDEXEDBDLCLI6
   160ACCESS MODE IS DYNAMICBDLCLI7
   161RECORD KEY IS LLAVE-BDLCLIBDLCLI8
   162LOCK MODE IS AUTOMATIC.BDLCLI9
*  163     COPY ICBSUS.FS.55
   165$SET CONSTANT SW-STATUS-ICBSUS"NO"ICBSUS2
   166     SELECT SUSCRIPTORICBSUS3
   167ASSIGN TO DISK SUSCRIPTOR-TITLEICBSUS4
   168ORGANIZATION IS INDEXEDICBSUS5
   169ACCESS MODE IS DYNAMICICBSUS6
   170RECORD KEY IS LLAVE-SUSCRIPICBSUS7
   171$IF SW-STATUS-ICBSUS = "NO"ICBSUS8/   502     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002BDACSV34503*    03  FILLERPIC X(50).STT0003BDACSV35
   504     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003BDACSV36
   50505  DES-NOMBRE2-BDACSV    PIC X(12).STT0003BDACSV37
   50605  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003BDACSV38
   50705  DEP-EXP-BDACSVPIC 9(02).STT0003BDACSV39
   50805  MUNIC-EXP-BDACSVPIC 9(03).STT0003BDACSV40
   50905  ESTADO-VIG-BDACSV     PIC 9(02).STT0003BDACSV41
   51005  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003BDACSV42
   51105  IND-SEXO-BDACSVPIC X.STT0003BDACSV43
   51205  IND-ESTADO-BDACSV     PIC 9.STT0003BDACSV44
   51305  IND-CONSULADO-BDACSV  PIC 9(1).STT0003BDACSV45
   51405  COD-CONSULADO-BDACSV  PIC 9(3).STT0003BDACSV46
   515     03  FILLERPIC X(07).STT0003BDACSV47
   516*    03  FILLERPIC X(48).BDACSV48
   517BDACSV49
   518BDACSV50
   519BDACSV51
*  520     copy ICBDIR.FD.166
   521* ICBDIR-fd.v01.001.ICBDIR1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACATADO DE LAS  REPORTADASICBDIR2
   523* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   524*----------------------------------------------------------------*ICBDIR4
   525 FD  MAESTRO-DIRECC.ICBDIR5
   526 01  REG-DIRECC.ICBDIR6
   527     03  LLAVE-DIRECC.ICBDIR7
   52805  LLAVE-PRI-DIRECC.ICBDIR8
   52907  TIPO-ID-DIRECC    PIC 9(01).ICBDIR9
   53007  NUM-ID-DIRECC     PIC 9(11).ICBDIR10
   53105  LLAVE-ALT-DIRECC.ICBDIR11
   53207  COD-SUS-DIRECC    PIC 9(06).ICBDIR12
   53307  COD-CTA-DIRECC    PIC 9(02).ICBDIR13
   53407  NUM-CTA-DIRECC    PIC X(18).ICBDIR14
   535     03  CIURES-DIRECCPIC X(15).ICBDIR15
   536     03  DIRRES-DIRECCPIC X(30).ICBDIR16
   537     03  TELRES-DIRECCPIC 9(10) COMP-3.ICBDIR17
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR.FD)
   538     03  CIULAB-DIRECCPIC X(15).ICBDIR18
   539     03  TELLAB-DIRECCPIC 9(10) COMP-3.ICBDIR19
   540     03  CIUCOR-DIRECCPIC X(15).ICBDIR20
   541     03  DIRCOR-DIRECCPIC X(30).ICBDIR21
   542     03  FECACT-DIRECCPIC 9(06) COMP-3.ICBDIR22
   544     03  FECAPE-DIRECCPIC 9(06) COMP-3.ICBDIR24
   545     03  FECCRE-DIRECCPIC 9(06) COMP-3.ICBDIR25
   546     03  DIRLAB-DIRECCPIC X(23).ICBDIR26
*  547     copy BDLCLI.FD.167
   548*BDLCLI-FD.v.00003BDLCLI1
   549*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR YBDLCLI2
   550*PRIVILEGIO ACTUALIZADOS.BDLCLI3
   551*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADOBDLCLI4
   552*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONESBDLCLI5/  1609* FORERO*DIVISION DE DOCUMENTOS. TAMBIEN SE     *ICBDIR0011
  1610* JUL.11/2006  *CREARON CAMPOS QUE INDICAN SI LA*ICBDIR0012
  1611**DIRECCION FUE GEOREFERENCIADA.*ICBDIR0013
  1612******************************************************************ICBDIR0014
  1613* CAV0004* BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *ICBDIR0015
  1614* C VELASCO    *EL REGISTRO CORRESPONDE A UNA CUENTA   *ICBDIR0016
  1615* AGO/27/2007  *SIN VALIDAR IDENTIFICACION*ICBDIR0017
  1616******************************************************************ICBDIR0018
  1617* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *ICBDIR0019
  1618* VICTOR HUGO  *SE ADICIONAN FECHAS INDEPENDIENTES PARA*ICBDIR0020
  1619* FORERO*CADA TIPO DE DATOS DE LOCALIZACION     *ICBDIR0021
  1620* JUL.25/2008  **ICBDIR0022
  1621******************************************************************ICBDIR0023
  1622* RMB0006* DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*ICBDIR0024
  1623* R MARTINEZ   *S DE RESICENCIA,LABORAL Y CORRESPONDENC*ICBDIR0025
  1624* SEP/07/2011  *CIA.*ICBDIR0026
  1625******************************************************************ICBDIR0027
  1626* CAV0007* FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *ICBDIR0028
  1627* C.VELASCO    *IDENTIFICAR CUANDO ESTABA VACIO Y SE   *ICBDIR0029
  1628* OCT/25/2012  *ACTUALIZO.*ICBDIR0030
  1629******************************************************************ICBDIR0031
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
  1631 01  REG-DIRECC.ICBDIR0033
  1632     03  LLAVE-DIRECC.ICBDIR0034
  163305  LLAVE-PRI-DIRECC.ICBDIR0035
  163407  TIPO-ID-DIRECC    PIC 9(01).ICBDIR0036
  163507  NUM-ID-DIRECC     PIC 9(13).FAC0002ICBDIR0037
  163605  LLAVE-ALT-DIRECC.ICBDIR0038
  163707  COD-SUS-DIRECC    PIC 9(06).ICBDIR0039
  163807  COD-CTA-DIRECC    PIC 9(02).ICBDIR0040
  163907  NUM-CTA-DIRECC    PIC X(18).ICBDIR0041
  1640     03  FECAPE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0042
  1641     03  FECCRE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0043
  1642     03  FECACT-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0044
  1643     03  CIURES-DIRECCPIC X(20).FAC0002ICBDIR0045
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  30
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
  1644     03  DPTRES-DIRECCPIC X(20).FAC0002ICBDIR0046
  1645     03  DIRRES-DIRECCPIC X(60).FAC0002ICBDIR0047
  1646     03  TELRES-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0048
  1647     03  FECRES-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0049
  1648     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0050
  1649     03  CIULAB-DIRECCPIC X(20).FAC0002ICBDIR0051
  1650     03  DPTLAB-DIRECCPIC X(20).FAC0002ICBDIR0052
  1651     03  DIRLAB-DIRECCPIC X(60).FAC0002ICBDIR0053
  1652     03  TELLAB-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0054
  1653     03  FECLAB-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0055
  1654     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0056
  1655     03  CIUCOR-DIRECCPIC X(20).FAC0002ICBDIR0057
  1656     03  DPTCOR-DIRECCPIC X(20).FAC0002ICBDIR0058?   502     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002BDACSV34503*    03  FILLERPIC X(50).STT0003BDACSV35
   504     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003BDACSV36
   50505  DES-NOMBRE2-BDACSV    PIC X(12).STT0003BDACSV37
   50605  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003BDACSV38
   50705  DEP-EXP-BDACSVPIC 9(02).STT0003BDACSV39
   50805  MUNIC-EXP-BDACSVPIC 9(03).STT0003BDACSV40
   50905  ESTADO-VIG-BDACSV     PIC 9(02).STT0003BDACSV41
   51005  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003BDACSV42
   51105  IND-SEXO-BDACSVPIC X.STT0003BDACSV43
   51205  IND-ESTADO-BDACSV     PIC 9.STT0003BDACSV44
   51305  IND-CONSULADO-BDACSV  PIC 9(1).STT0003BDACSV45
   51405  COD-CONSULADO-BDACSV  PIC 9(3).STT0003BDACSV46
   515     03  FILLERPIC X(07).STT0003BDACSV47
   516*    03  FILLERPIC X(48).BDACSV48
   517BDACSV49
   518BDACSV50
   519BDACSV51
*  520     copy ICBDIR.FD.166
   521* ICBDIR-fd.v01.001.ICBDIR1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACATADO DE LAS  REPORTADASICBDIR2
   523* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   524*----------------------------------------------------------------*ICBDIR4
   525 FD  MAESTRO-DIRECC.ICBDIR5
   526 01  REG-DIRECC.ICBDIR6
   527     03  LLAVE-DIRECC.ICBDIR7
   52805  LLAVE-PRI-DIRECC.ICBDIR8
   52907  TIPO-ID-DIRECC    PIC 9(01).ICBDIR9
   53007  NUM-ID-DIRECC     PIC 9(11).ICBDIR10
   53105  LLAVE-ALT-DIRECC.ICBDIR11
   53207  COD-SUS-DIRECC    PIC 9(06).ICBDIR12
   53307  COD-CTA-DIRECC    PIC 9(02).ICBDIR13
   53407  NUM-CTA-DIRECC    PIC X(18).ICBDIR14
   535     03  CIURES-DIRECCPIC X(15).ICBDIR15
   536     03  DIRRES-DIRECCPIC X(30).ICBDIR16
   537     03  TELRES-DIRECCPIC 9(10) COMP-3.ICBDIR17
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR.FD)
   538     03  CIULAB-DIRECCPIC X(15).ICBDIR18
   539     03  TELLAB-DIRECCPIC 9(10) COMP-3.ICBDIR19
   540     03  CIUCOR-DIRECCPIC X(15).ICBDIR20
   541     03  DIRCOR-DIRECCPIC X(30).ICBDIR21
   542     03  FECACT-DIRECCPIC 9(06) COMP-3.ICBDIR22
   544     03  FECAPE-DIRECCPIC 9(06) COMP-3.ICBDIR24
   545     03  FECCRE-DIRECCPIC 9(06) COMP-3.ICBDIR25
   546     03  DIRLAB-DIRECCPIC X(23).ICBDIR26
*  547     copy BDLCLI.FD.167
   548*BDLCLI-FD.v.00003BDLCLI1
   549*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR YBDLCLI2
   550*PRIVILEGIO ACTUALIZADOS.BDLCLI3
   551*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADOBDLCLI4
   552*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONESBDLCLI5/  1609* FORERO*DIVISION DE DOCUMENTOS. TAMBIEN SE     *ICBDIR0011
  1610* JUL.11/2006  *CREARON CAMPOS QUE INDICAN SI LA*ICBDIR0012
  1611**DIRECCION FUE GEOREFERENCIADA.*ICBDIR0013
  1612******************************************************************ICBDIR0014
  1613* CAV0004* BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *ICBDIR0015
  1614* C VELASCO    *EL REGISTRO CORRESPONDE A UNA CUENTA   *ICBDIR0016
  1615* AGO/27/2007  *SIN VALIDAR IDENTIFICACION*ICBDIR0017
  1616******************************************************************ICBDIR0018
  1617* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *ICBDIR0019
  1618* VICTOR HUGO  *SE ADICIONAN FECHAS INDEPENDIENTES PARA*ICBDIR0020
  1619* FORERO*CADA TIPO DE DATOS DE LOCALIZACION     *ICBDIR0021
  1620* JUL.25/2008  **ICBDIR0022
  1621******************************************************************ICBDIR0023
  1622* RMB0006* DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*ICBDIR0024
  1623* R MARTINEZ   *S DE RESICENCIA,LABORAL Y CORRESPONDENC*ICBDIR0025
  1624* SEP/07/2011  *CIA.*ICBDIR0026
  1625******************************************************************ICBDIR0027
  1626* CAV0007* FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *ICBDIR0028
  1627* C.VELASCO    *IDENTIFICAR CUANDO ESTABA VACIO Y SE   *ICBDIR0029
  1628* OCT/25/2012  *ACTUALIZO.*ICBDIR0030
  1629******************************************************************ICBDIR0031
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
  1631 01  REG-DIRECC.ICBDIR0033
  1632     03  LLAVE-DIRECC.ICBDIR0034
  163305  LLAVE-PRI-DIRECC.ICBDIR0035
  163407  TIPO-ID-DIRECC    PIC 9(01).ICBDIR0036
  163507  NUM-ID-DIRECC     PIC 9(13).FAC0002ICBDIR0037
  163605  LLAVE-ALT-DIRECC.ICBDIR0038
  163707  COD-SUS-DIRECC    PIC 9(06).ICBDIR0039
  163807  COD-CTA-DIRECC    PIC 9(02).ICBDIR0040
  163907  NUM-CTA-DIRECC    PIC X(18).ICBDIR0041
  1640     03  FECAPE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0042
  1641     03  FECCRE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0043
  1642     03  FECACT-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0044
  1643     03  CIURES-DIRECCPIC X(20).FAC0002ICBDIR0045
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  30
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
  1644     03  DPTRES-DIRECCPIC X(20).FAC0002ICBDIR0046
  1645     03  DIRRES-DIRECCPIC X(60).FAC0002ICBDIR0047
  1646     03  TELRES-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0048
  1647     03  FECRES-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0049
  1648     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0050
  1649     03  CIULAB-DIRECCPIC X(20).FAC0002ICBDIR0051
  1650     03  DPTLAB-DIRECCPIC X(20).FAC0002ICBDIR0052
  1651     03  DIRLAB-DIRECCPIC X(60).FAC0002ICBDIR0053
  1652     03  TELLAB-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0054
  1653     03  FECLAB-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0055
  1654     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0056
  1655     03  CIUCOR-DIRECCPIC X(20).FAC0002ICBDIR0057
  1656     03  DPTCOR-DIRECCPIC X(20).FAC0002ICBDIR0058?   502     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002BDACSV34503*    03  FILLERPIC X(50).STT0003BDACSV35
   504     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003BDACSV36
   50505  DES-NOMBRE2-BDACSV    PIC X(12).STT0003BDACSV37
   50605  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003BDACSV38
   50705  DEP-EXP-BDACSVPIC 9(02).STT0003BDACSV39
   50805  MUNIC-EXP-BDACSVPIC 9(03).STT0003BDACSV40
   50905  ESTADO-VIG-BDACSV     PIC 9(02).STT0003BDACSV41
   51005  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003BDACSV42
   51105  IND-SEXO-BDACSVPIC X.STT0003BDACSV43
   51205  IND-ESTADO-BDACSV     PIC 9.STT0003BDACSV44
   51305  IND-CONSULADO-BDACSV  PIC 9(1).STT0003BDACSV45
   51405  COD-CONSULADO-BDACSV  PIC 9(3).STT0003BDACSV46
   515     03  FILLERPIC X(07).STT0003BDACSV47
   516*    03  FILLERPIC X(48).BDACSV48
   517BDACSV49
   518BDACSV50
   519BDACSV51
*  520     copy ICBDIR.FD.166
   521* ICBDIR-fd.v01.001.ICBDIR1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACATADO DE LAS  REPORTADASICBDIR2
   523* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   524*----------------------------------------------------------------*ICBDIR4
   525 FD  MAESTRO-DIRECC.ICBDIR5
   526 01  REG-DIRECC.ICBDIR6
   527     03  LLAVE-DIRECC.ICBDIR7
   52805  LLAVE-PRI-DIRECC.ICBDIR8
   52907  TIPO-ID-DIRECC    PIC 9(01).ICBDIR9
   53007  NUM-ID-DIRECC     PIC 9(11).ICBDIR10
   53105  LLAVE-ALT-DIRECC.ICBDIR11
   53207  COD-SUS-DIRECC    PIC 9(06).ICBDIR12
   53307  COD-CTA-DIRECC    PIC 9(02).ICBDIR13
   53407  NUM-CTA-DIRECC    PIC X(18).ICBDIR14
   535     03  CIURES-DIRECCPIC X(15).ICBDIR15
   536     03  DIRRES-DIRECCPIC X(30).ICBDIR16
   537     03  TELRES-DIRECCPIC 9(10) COMP-3.ICBDIR17
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR.FD)
   538     03  CIULAB-DIRECCPIC X(15).ICBDIR18
   539     03  TELLAB-DIRECCPIC 9(10) COMP-3.ICBDIR19
   540     03  CIUCOR-DIRECCPIC X(15).ICBDIR20
   541     03  DIRCOR-DIRECCPIC X(30).ICBDIR21
   542     03  FECACT-DIRECCPIC 9(06) COMP-3.ICBDIR22
   544     03  FECAPE-DIRECCPIC 9(06) COMP-3.ICBDIR24
   545     03  FECCRE-DIRECCPIC 9(06) COMP-3.ICBDIR25
   546     03  DIRLAB-DIRECCPIC X(23).ICBDIR26
*  547     copy BDLCLI.FD.167
   548*BDLCLI-FD.v.00003BDLCLI1
   549*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR YBDLCLI2
   550*PRIVILEGIO ACTUALIZADOS.BDLCLI3
   551*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADOBDLCLI4
   552*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONESBDLCLI5/  1609* FORERO*DIVISION DE DOCUMENTOS. TAMBIEN SE     *ICBDIR0011
  1610* JUL.11/2006  *CREARON CAMPOS QUE INDICAN SI LA*ICBDIR0012
  1611**DIRECCION FUE GEOREFERENCIADA.*ICBDIR0013
  1612******************************************************************ICBDIR0014
  1613* CAV0004* BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *ICBDIR0015
  1614* C VELASCO    *EL REGISTRO CORRESPONDE A UNA CUENTA   *ICBDIR0016
  1615* AGO/27/2007  *SIN VALIDAR IDENTIFICACION*ICBDIR0017
  1616******************************************************************ICBDIR0018
  1617* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *ICBDIR0019
  1618* VICTOR HUGO  *SE ADICIONAN FECHAS INDEPENDIENTES PARA*ICBDIR0020
  1619* FORERO*CADA TIPO DE DATOS DE LOCALIZACION     *ICBDIR0021
  1620* JUL.25/2008  **ICBDIR0022
  1621******************************************************************ICBDIR0023
  1622* RMB0006* DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*ICBDIR0024
  1623* R MARTINEZ   *S DE RESICENCIA,LABORAL Y CORRESPONDENC*ICBDIR0025
  1624* SEP/07/2011  *CIA.*ICBDIR0026
  1625******************************************************************ICBDIR0027
  1626* CAV0007* FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *ICBDIR0028
  1627* C.VELASCO    *IDENTIFICAR CUANDO ESTABA VACIO Y SE   *ICBDIR0029
  1628* OCT/25/2012  *ACTUALIZO.*ICBDIR0030
  1629******************************************************************ICBDIR0031
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
  1631 01  REG-DIRECC.ICBDIR0033
  1632     03  LLAVE-DIRECC.ICBDIR0034
  163305  LLAVE-PRI-DIRECC.ICBDIR0035
  163407  TIPO-ID-DIRECC    PIC 9(01).ICBDIR0036
  163507  NUM-ID-DIRECC     PIC 9(13).FAC0002ICBDIR0037
  163605  LLAVE-ALT-DIRECC.ICBDIR0038
  163707  COD-SUS-DIRECC    PIC 9(06).ICBDIR0039
  163807  COD-CTA-DIRECC    PIC 9(02).ICBDIR0040
  163907  NUM-CTA-DIRECC    PIC X(18).ICBDIR0041
  1640     03  FECAPE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0042
  1641     03  FECCRE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0043
  1642     03  FECACT-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0044
  1643     03  CIURES-DIRECCPIC X(20).FAC0002ICBDIR0045
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  30
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
  1644     03  DPTRES-DIRECCPIC X(20).FAC0002ICBDIR0046
  1645     03  DIRRES-DIRECCPIC X(60).FAC0002ICBDIR0047
  1646     03  TELRES-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0048
  1647     03  FECRES-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0049
  1648     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0050
  1649     03  CIULAB-DIRECCPIC X(20).FAC0002ICBDIR0051
  1650     03  DPTLAB-DIRECCPIC X(20).FAC0002ICBDIR0052
  1651     03  DIRLAB-DIRECCPIC X(60).FAC0002ICBDIR0053
  1652     03  TELLAB-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0054
  1653     03  FECLAB-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0055
  1654     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0056
  1655     03  CIUCOR-DIRECCPIC X(20).FAC0002ICBDIR0057
  1656     03  DPTCOR-DIRECCPIC X(20).FAC0002ICBDIR0058
    156103 L-BDLDIR OCCURS 30 TIMES PIC X(20).GJC0007BDLDIR383
  1562    02 T-NUMMEJ-BDLDIR.GJC0007BDLDIR384
  156304 V-NUMMEJ-BDLDIR    OCCURS 10 TIMES PIC 9(5).GJC0007BDLDIR385
  1564    02 T-CARMEJ-BDLDIR.GJC0007BDLDIR386
  156504 V-CARMEJ-BDLDIR OCCURS 60 TIMES PIC X.GJC0007BDLDIR387
  1566    02 T-LETRAS-BDLDIR.GJC0007BDLDIR388
  156704 V-LETRAS-BDLDIR OCCURS 200 TIMES PIC X.GJC0007BDLDIR389
  1568 01 VAR-NEWDIR.GJC0007BDLDIR390
  1569    02 OPEN-BDLNEWDIRBOG-BDLDIR     PIC 9 VALUE 0.GJC0007BDLDIR391
  1570    02 HAY-BDLNEWDIRBOG-BDLDIRPIC 9 VALUE 0.GJC0007BDLDIR392
  1571    02 CIUDAD-BTA-BDLDIRPIC X(15).GJC0007BDLDIR393
  1572    02 DIRECCION-BTA-BDLDIRPIC X(60).GJC0007BDLDIR394
  1573    02 SW-NNPIC 9 VALUE 0.PJV0012BDLDIR395
  1574 01 VAR-EMAIL-BDLDIR.CAV0014BDLDIR396
  1575    02 EMAIL-BDLDIRPIC X(60) VALUE SPACES.CAV0014BDLDIR397
  1576    02 TMP-EMAIL-BDLDIRPIC X(60) VALUE SPACES.CAV0014BDLDIR398
  1577    02 ERR-EMAIL-BDLDIRPIC 9(01) VALUE 0.CAV0014BDLDIR399
  1578    02 CONT-ESP-INIC-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR400
  1579    02 CONT-ARO-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR401
  1580    02 CONT-PUN-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR402
  1581    02 CONT-ERR-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR403
  1582    02 LONG-EMIAL-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR404
  1583 01 VAR-CELULAR-BDLDIR.CAV0014BDLDIR405
  1584    02 TEL-CELULAR-BDLDIRPIC 9(12).CAV0014BDLDIR406
  1585    02 ERR-CELULAR-BDLDIRPIC 9(01) VALUE 0.CAV0014BDLDIR407
  1586    02 TEL-AUX-CELULAR-BDLDIRPIC 9(12).CAV0014BDLDIR408
  1587    02 FILLER REDEFINES TEL-AUX-CELULAR-BDLDIR.CAV0014BDLDIR409
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  29
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  158804 P1-TEL-AUX-CEL-BDLDIR     PIC 9(2).CAV0014BDLDIR410
  158904 P2-TEL-AUX-CEL-BDLDIR     PIC 9(3).CAV0014BDLDIR411
  159088 ES-CELULAR-CEL-BDLDIR VALUES 300,301,   *>TIGOCAV0014BDLDIR412
  1591310,311,312,313,314,320,321, CAV0014BDLDIR413
  1592315,316,317,  *>MOVISTAR     CAV0014BDLDIR414
  1593350,*>AVANTELCAV0014BDLDIR415
  1594302,303,304,305,306,307,308, CAV0014BDLDIR416
  1595309,318,319,322,323,324,325, CAV0014BDLDIR417
  1596351,352,353,354,355. *>ASIGN CAV0014BDLDIR418
  1597     04 P3-TEL-AUX-CEL-BDLDIRPIC 9(7).CAV0014BDLDIR419
* 1598     COPY ICBDIR0001.FD.247
  1599* ICBDIR0001-FD.V01.007.ICBDIR001
  1600* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADASICBDIR002
  1601* POR LOS DIFERENTES SUSCRIPTORESICBDIR003
  1602******************************************************************ICBDIR004
  1603* FAC0002* AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DELICBDIR005
  1604* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DEICBDIR006
  1605* FEB.15/2006  * DATACLIENTES.ICBDIR007
  1606******************************************************************ICBDIR008
  1607* VHF0003* RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *ICBDIR009
  1608* VICTOR HUGO  *DIRECCION ESTA CERTIFICADA POR LA*ICBDIR0010
  1609* FORERO*DIVISION DE DOCUMENTOS. TAMBIEN SE     *ICBDIR0011
  1610* JUL.11/2006  *CREARON CAMPOS QUE INDICAN SI LA*ICBDIR0012  
* 1598     COPY ICBDIR0001.FD.247
  1599* ICBDIR0001-FD.V01.007.ICBDIR001
  1600* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADASICBDIR002
  1601* POR LOS DIFERENTES SUSCRIPTORESICBDIR003
  1602******************************************************************ICBDIR004
  1603* FAC0002* AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DELICBDIR005
  1604* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DEICBDIR006
  1605* FEB.15/2006  * DATACLIENTES.ICBDIR007
  1606******************************************************************ICBDIR008
  1607* VHF0003* RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *ICBDIR009
  1608* VICTOR HUGO  *DIRECCION ESTA CERTIFICADA POR LA*ICBDIR0010
  1609* FORERO*DIVISION DE DOCUMENTOS. TAMBIEN SE     *ICBDIR0011
  1610* JUL.11/2006  *CREARON CAMPOS QUE INDICAN SI LA*ICBDIR0012
  1611**DIRECCION FUE GEOREFERENCIADA.*ICBDIR0013
  1612******************************************************************ICBDIR0014
  1613* CAV0004* BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *ICBDIR0015
  1614* C VELASCO    *EL REGISTRO CORRESPONDE A UNA CUENTA   *ICBDIR0016
  1615* AGO/27/2007  *SIN VALIDAR IDENTIFICACION*ICBDIR0017
  1616******************************************************************ICBDIR0018
  1617* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *ICBDIR0019
  1618* VICTOR HUGO  *SE ADICIONAN FECHAS INDEPENDIENTES PARA*ICBDIR0020
  1619* FORERO*CADA TIPO DE DATOS DE LOCALIZACION     *ICBDIR0021
  1620* JUL.25/2008  **ICBDIR0022
  1621******************************************************************ICBDIR0023
  1622* RMB0006* DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*ICBDIR0024
  1623* R MARTINEZ   *S DE RESICENCIA,LABORAL Y CORRESPONDENC*ICBDIR0025
  1624* SEP/07/2011  *CIA.*ICBDIR0026
  1625******************************************************************ICBDIR0027
  1626* CAV0007* FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *ICBDIR0028
  1627* C.VELASCO    *IDENTIFICAR CUANDO ESTABA VACIO Y SE   *ICBDIR0029
  1628* OCT/25/2012  *ACTUALIZO.*ICBDIR0030
  1629******************************************************************ICBDIR0031
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
  1631 01  REG-DIRECC.ICBDIR0033
  1632     03  LLAVE-DIRECC.ICBDIR0034
  163305  LLAVE-PRI-DIRECC.ICBDIR0035
  163407  TIPO-ID-DIRECC    PIC 9(01).ICBDIR0036
  163507  NUM-ID-DIRECC     PIC 9(13).FAC0002ICBDIR0037
  163605  LLAVE-ALT-DIRECC.ICBDIR0038
  163707  COD-SUS-DIRECC    PIC 9(06).ICBDIR0039
  163807  COD-CTA-DIRECC    PIC 9(02).ICBDIR0040
  163907  NUM-CTA-DIRECC    PIC X(18).ICBDIR0041
  1640     03  FECAPE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0042
  1641     03  FECCRE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0043
  1642     03  FECACT-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0044
  1643     03  CIURES-DIRECCPIC X(20).FAC0002ICBDIR0045
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  30
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
  1644     03  DPTRES-DIRECCPIC X(20).FAC0002ICBDIR0046
  1645     03  DIRRES-DIRECCPIC X(60).FAC0002ICBDIR0047/  1550    02 ORDEN-ASCII-BDLDIRPIC 9(03) VALUE 0.GJC0007BDLDIR372
  1551    02 TOTAL-ASCII-BDLDIRPIC 9(10).GJC0007BDLDIR373
  1552    02 NN8-BDLDIRPIC 9(05).GJC0007BDLDIR374
  1553    02 NN9-BDLDIRPIC 9(05).GJC0007BDLDIR375
  1554    02 NN10-BDLDIRPIC 9(05).GJC0007BDLDIR376
  1555    02 I-MEJ-BDLDIRPIC 9(3) VALUE 0.GJC0007BDLDIR377
  1556    02 J-MEJ-BDLDIRPIC 9(3) VALUE 0.GJC0007BDLDIR378
  1557    02 K-MEJ-BDLDIRPIC 9(3) VALUE 0.GJC0007BDLDIR379
  1558*   02 CAR-ANT-BDLDIRPIC X(1) VALUE SPACES.GJC0007BDLDIR380
  1559*   02 CAR-ACT-BDLDIRPIC 9(1) VALUE 0.GJC0007BDLDIR381
  1560    02 T-L-BDLDIR.GJC0007BDLDIR382
  156103 L-BDLDIR OCCURS 30 TIMES PIC X(20).GJC0007BDLDIR383
  1562    02 T-NUMMEJ-BDLDIR.GJC0007BDLDIR384
  156304 V-NUMMEJ-BDLDIR    OCCURS 10 TIMES PIC 9(5).GJC0007BDLDIR385
  1564    02 T-CARMEJ-BDLDIR.GJC0007BDLDIR386
  156504 V-CARMEJ-BDLDIR OCCURS 60 TIMES PIC X.GJC0007BDLDIR387
  1566    02 T-LETRAS-BDLDIR.GJC0007BDLDIR388
  156704 V-LETRAS-BDLDIR OCCURS 200 TIMES PIC X.GJC0007BDLDIR389
  1568 01 VAR-NEWDIR.GJC0007BDLDIR390
  1569    02 OPEN-BDLNEWDIRBOG-BDLDIR     PIC 9 VALUE 0.GJC0007BDLDIR391
  1570    02 HAY-BDLNEWDIRBOG-BDLDIRPIC 9 VALUE 0.GJC0007BDLDIR392
  1571    02 CIUDAD-BTA-BDLDIRPIC X(15).GJC0007BDLDIR393
  1572    02 DIRECCION-BTA-BDLDIRPIC X(60).GJC0007BDLDIR394
  1573    02 SW-NNPIC 9 VALUE 0.PJV0012BDLDIR395
  1574 01 VAR-EMAIL-BDLDIR.CAV0014BDLDIR396
  1575    02 EMAIL-BDLDIRPIC X(60) VALUE SPACES.CAV0014BDLDIR397
  1576    02 TMP-EMAIL-BDLDIRPIC X(60) VALUE SPACES.CAV0014BDLDIR398
  1577    02 ERR-EMAIL-BDLDIRPIC 9(01) VALUE 0.CAV0014BDLDIR399
  1578    02 CONT-ESP-INIC-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR400
  1579    02 CONT-ARO-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR401
  1580    02 CONT-PUN-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR402
  1581    02 CONT-ERR-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR403
  1582    02 LONG-EMIAL-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR404
  1583 01 VAR-CELULAR-BDLDIR.CAV0014BDLDIR405
  1584    02 TEL-CELULAR-BDLDIRPIC 9(12).CAV0014BDLDIR406
  1585    02 ERR-CELULAR-BDLDIRPIC 9(01) VALUE 0.CAV0014BDLDIR407
  1586    02 TEL-AUX-CELULAR-BDLDIRPIC 9(12).CAV0014BDLDIR408
  1587    02 FILLER REDEFINES TEL-AUX-CELULAR-BDLDIR.CAV0014BDLDIR409
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  29
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  158804 P1-TEL-AUX-CEL-BDLDIR     PIC 9(2).CAV0014BDLDIR410
  158904 P2-TEL-AUX-CEL-BDLDIR     PIC 9(3).CAV0014BDLDIR411
  159088 ES-CELULAR-CEL-BDLDIR VALUES 300,301,   *>TIGOCAV0014BDLDIR412
  1591310,311,312,313,314,320,321, CAV0014BDLDIR413
  1592315,316,317,  *>MOVISTAR     CAV0014BDLDIR414
  1593350,*>AVANTELCAV0014BDLDIR415
  1594302,303,304,305,306,307,308, CAV0014BDLDIR416
  1595309,318,319,322,323,324,325, CAV0014BDLDIR417
  1596351,352,353,354,355. *>ASIGN CAV0014BDLDIR418
  1597     04 P3-TEL-AUX-CEL-BDLDIRPIC 9(7).CAV0014BDLDIR419
* 1598     COPY ICBDIR0001.FD.247
  1599* ICBDIR0001-FD.V01.007.ICBDIR001    1502 01  FDA-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR324
  1503 01  IND-TIPCAR-BDLDIRPIC X(01).RMB0006BDLDIR325
  1504 01  TIPCAR-WS-BDLDIRPIC X(01).RMB0006BDLDIR326
  1505 01  ENC-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR327
  1506*01 TABLA-DIR-ESTANDAR-BDLDIROCCURS 500 TIMESRMB0006BDLDIR328
  1507 01 TABLA-DIR-ESTANDAR-BDLDIROCCURS 2000 TIMESPJV0013BDLDIR329
  1508    ASCENDING KEY IS DIR-ORIGINAL-BDLDIRRMB0006BDLDIR330
  1509    INDEXED   BY  I-DIR-ESTANDAR-BDLDIR.RMB0006BDLDIR331
  1510    03 DIR-ORIGINAL-BDLDIRPIC X(20).RMB0006BDLDIR332
  1511    03 DIR-ESTANDAR-BDLDIRPIC X(10).RMB0006BDLDIR333
  1512* 01 TABLA-DIR-COMPUESTAS-BDLDIR.RMB0006BDLDIR334
  1513*    03 DIR-COMPUESTAS-AST-BDLDIRPIC X(20) OCCURS 90 TIMES. RMB0006BDLDIR335
  1514*    03 DIR-COMPUESTAS-BLN-BDLDIRPIC X(20) OCCURS 90 TIMES. RMB0006BDLDIR336
  1515*    03 DIR-COMPUESTAS-LON-BDLDIRPIC 9(02) OCCURS 90 TIMES. RMB0006BDLDIR337
  1516*    03 DIR-COMPUESTAS-TIP-BDLDIRPIC 9(01) OCCURS 90 TIMES. RMB0006BDLDIR338
  1517 01 TABLA-DIR-COMPUESTAS-BDLDIR.PJV0013BDLDIR339
  1518    03 DIR-COMPUESTAS-AST-BDLDIRPIC X(20) OCCURS 500 TIMES. PJV0013BDLDIR340
  1519    03 DIR-COMPUESTAS-BLN-BDLDIRPIC X(20) OCCURS 500 TIMES. PJV0013BDLDIR341
  1520    03 DIR-COMPUESTAS-LON-BDLDIRPIC 9(02) OCCURS 500 TIMES. PJV0013BDLDIR342
  1521    03 DIR-COMPUESTAS-TIP-BDLDIRPIC 9(01) OCCURS 500 TIMES. PJV0013BDLDIR343
  1522 01 TIP-NUEVA-DIRECCION-BDLDIR.RMB0006BDLDIR344
  1523    03 TIP-NVA-DIR-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR345
  1524 01 NUEVA-DIRECCION-BDLDIR.RMB0006BDLDIR346
  1525    03 NVA-DIR-BDLDIRPIC X(60) OCCURS 60 TIMES.  RMB0006BDLDIR347
  1526 01 DIRECCION-A-ESTANDARIZAR-BDLDIR.RMB0006BDLDIR348
  1527    03 DIR-A-EST-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR349
  1528 01 DIR-A-STD-BDLDIR REDEFINES DIRECCION-A-ESTANDARIZAR-BDLDIR.   CAV0014BDLDIR350
  1529    02 FILLER PIC X(60).CAV0014BDLDIR351
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  28
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1530*** VARIABLES QUE CONTIENE LA CIUDAD ORIGINALRMB0006BDLDIR352
  1531 01 CIUDAD-RES-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR353
  1532 01 CIUDAD-LAB-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR354
  1533 01 CIUDAD-COR-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR355
  1534 01 PART-A-ESTANDARIZAR-BDLDIR.RMB0006BDLDIR356
  1535    03 PART-A-ESTAN-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR357
  1536 01 PART-ESTANDARIZADA-BDLDIRPIC X(60).RMB0006BDLDIR358
  1537 01 PRIPART-ESTANDARIZADA-BDLDIRPIC X(60).HGO0011BDLDIR359
  1538 01 SEGPART-ESTANDARIZADA-BDLDIRPIC X(60).HGO0011BDLDIR360
  1539 01 DIRECCION-ESTANDARIZADA-BDLDIR    PIC X(60).RMB0006BDLDIR361
  1540 01 DIRECCION-AUX-BDLDIRPIC X(60).RMB0006BDLDIR362
  1541 01 DIRECCION-62-BDLDIR.RMB0006BDLDIR363
  1542    03 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR364
  1543    03 DIRECCION-60-BDLDIRPIC X(60).RMB0006BDLDIR365
  1544    03 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR366
  1545 01 DIR-COMPUESTAS-BLN-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006BDLDIR367
  1546 01 DIR-COMPUESTAS-AST-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006BDLDIR368
  1547 01 CASO-NUMEROLETRA-BDLDIRPIC 9(01) VALUE 0.RMB0006BDLDIR369
  1548 01 VAR-RUTINA-NEWDIRBOG-BDLDIR.GJC0007BDLDIR370
  1549    02 LETRA-BDLDIRPIC X.GJC0007BDLDIR371
  1550    02 ORDEN-ASCII-BDLDIRPIC 9(03) VALUE 0.GJC0007BDLDIR372
  1551    02 TOTAL-ASCII-BDLDIRPIC 9(10).GJC0007BDLDIR373    1454    03 E-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR276
  1455    03 F-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR277
  1456    03 G-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR278
  1457    03 H-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR279
  1458    03 I-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR280
  1459    03 J-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR281
  1460    03 J1-BDLDIRPIC 9(05) VALUE 0.HGO0011BDLDIR282
  1461    03 J2-BDLDIRPIC 9(05) VALUE 0.HGO0011BDLDIR283
  1462    03 CONTADOR-TEMPORAL-BDLDIRPIC 9(03).HGO0011BDLDIR284
  1463    03 M-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR285
  1464    03 N-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR286
  1465    03 K-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR287
  1466    03 II-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR288
  1467    03 JJ-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR289
  1468    03 NUM-OK-SEND-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR290
  1469    03 I-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR291
  1470    03 J-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR292
  1471    03 K-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR293
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  27
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1472    03 II-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR294
  1473    03 JJ-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR295
  1474    03 KK-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR296
  1475    03 CALIFICA-DIR-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR297
  1476    03 CON-PART-ESTANDARIZADA-BDLDIR  PIC 9(03) VALUE 0.HGO0011BDLDIR298
  1477    03 CALIFICA-DIRPART1-BDLDIRPIC 9(03) VALUE 0.HGO0011BDLDIR299
  1478    03 CALIFICA-DIRPART2-BDLDIRPIC 9(03) VALUE 0.HGO0011BDLDIR300
  1479    03 CALIFICA-REAL-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR301
  1480    03 CAMPOS-N-DIR-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR302
  1481    03 COSI-DIR-BDLDIRPIC 9(09) VALUE 0.RMB0006BDLDIR303
  1482    03 RESI-DIR-BDLDIRPIC 9(09) VALUE 0.RMB0006BDLDIR304
  1483    03 TELE-DIR-BDLDIRPIC 9(12) VALUE 0.RMB0006BDLDIR305
  1484*** NOMBRE DEL ARCHIVO DE DIRECCIONES CERTIFICADASRMB0006BDLDIR306
  1485    03 TITLE-BDLSTDCERPIC X(80) VALUERMB0006BDLDIR307
  1486"$DATABASE/BDLSTDCER".RMB0006BDLDIR308
  1487*** LA SIGUIENTE VARIBALE INDICA EL TIPO DE DATO EN PROCESO ASI:  RMB0006BDLDIR309
  1488*** R - RESIDENCIARMB0006BDLDIR310
  1489*** L - LABORALRMB0006BDLDIR311
  1490*** C - CORRESPONDENCIARMB0006BDLDIR312
  1491    03 IND-DATO-BDLDIRPIC X(01).RMB0006BDLDIR313
  1492*** VARIABLE QUE CONTIENE LA SUMATORIA DE LOS DIGITOS DE LASRMB0006BDLDIR314
  1493*** PARTICULAS NUMERICAS DE UNA DIRECCIONRMB0006BDLDIR315
  1494    03 SUM-DIGITOS-BDLDIRPIC 9(10).RMB0006BDLDIR316
  1495    03 CAL-TEL-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR317
  1496    02 TELEFONO-BDLDIRPIC 9(12) VALUE 0.RMB0006BDLDIR318
  1497***************************VARIABLES DE STANDARIZAR************** RMB0006BDLDIR319
  1498 01 DIRACC-BDLDIR-BDLDIR.RMB0006BDLDIR320
  1499    03 VALIDACION-DIR-OUT-BDLDIRPIC 9(01).RMB0006BDLDIR321
  1500    03 PRIVILEGIO-INPUT-BDLDIRPIC 9(01).RMB0006BDLDIR322
  1501    03 NIT-CONSULTANTE-INPUT-BDLDIR   PIC 9(11).RMB0006BDLDIR323
  1502 01  FDA-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR324
  1503 01  IND-TIPCAR-BDLDIRPIC X(01).RMB0006BDLDIR325    1502 01  FDA-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR324
  1503 01  IND-TIPCAR-BDLDIRPIC X(01).RMB0006BDLDIR325
  1504 01  TIPCAR-WS-BDLDIRPIC X(01).RMB0006BDLDIR326
  1505 01  ENC-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR327
  1506*01 TABLA-DIR-ESTANDAR-BDLDIROCCURS 500 TIMESRMB0006BDLDIR328
  1507 01 TABLA-DIR-ESTANDAR-BDLDIROCCURS 2000 TIMESPJV0013BDLDIR329
  1508    ASCENDING KEY IS DIR-ORIGINAL-BDLDIRRMB0006BDLDIR330
  1509    INDEXED   BY  I-DIR-ESTANDAR-BDLDIR.RMB0006BDLDIR331
  1510    03 DIR-ORIGINAL-BDLDIRPIC X(20).RMB0006BDLDIR332
  1511    03 DIR-ESTANDAR-BDLDIRPIC X(10).RMB0006BDLDIR333
  1512* 01 TABLA-DIR-COMPUESTAS-BDLDIR.RMB0006BDLDIR334
  1513*    03 DIR-COMPUESTAS-AST-BDLDIRPIC X(20) OCCURS 90 TIMES. RMB0006BDLDIR335
  1514*    03 DIR-COMPUESTAS-BLN-BDLDIRPIC X(20) OCCURS 90 TIMES. RMB0006BDLDIR336
  1515*    03 DIR-COMPUESTAS-LON-BDLDIRPIC 9(02) OCCURS 90 TIMES. RMB0006BDLDIR337
  1516*    03 DIR-COMPUESTAS-TIP-BDLDIRPIC 9(01) OCCURS 90 TIMES. RMB0006BDLDIR338
  1517 01 TABLA-DIR-COMPUESTAS-BDLDIR.PJV0013BDLDIR339
  1518    03 DIR-COMPUESTAS-AST-BDLDIRPIC X(20) OCCURS 500 TIMES. PJV0013BDLDIR340
  1519    03 DIR-COMPUESTAS-BLN-BDLDIRPIC X(20) OCCURS 500 TIMES. PJV0013BDLDIR341
  1520    03 DIR-COMPUESTAS-LON-BDLDIRPIC 9(02) OCCURS 500 TIMES. PJV0013BDLDIR342
  1521    03 DIR-COMPUESTAS-TIP-BDLDIRPIC 9(01) OCCURS 500 TIMES. PJV0013BDLDIR343
  1522 01 TIP-NUEVA-DIRECCION-BDLDIR.RMB0006BDLDIR344
  1523    03 TIP-NVA-DIR-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR345
  1524 01 NUEVA-DIRECCION-BDLDIR.RMB0006BDLDIR346
  1525    03 NVA-DIR-BDLDIRPIC X(60) OCCURS 60 TIMES.  RMB0006BDLDIR347
  1526 01 DIRECCION-A-ESTANDARIZAR-BDLDIR.RMB0006BDLDIR348
  1527    03 DIR-A-EST-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR349
  1528 01 DIR-A-STD-BDLDIR REDEFINES DIRECCION-A-ESTANDARIZAR-BDLDIR.   CAV0014BDLDIR350
  1529    02 FILLER PIC X(60).CAV0014BDLDIR351
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  28
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1530*** VARIABLES QUE CONTIENE LA CIUDAD ORIGINALRMB0006BDLDIR352
  1531 01 CIUDAD-RES-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR353
  1532 01 CIUDAD-LAB-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR354
  1533 01 CIUDAD-COR-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR355
  1534 01 PART-A-ESTANDARIZAR-BDLDIR.RMB0006BDLDIR356
  1535    03 PART-A-ESTAN-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR357
  1536 01 PART-ESTANDARIZADA-BDLDIRPIC X(60).RMB0006BDLDIR358
  1537 01 PRIPART-ESTANDARIZADA-BDLDIRPIC X(60).HGO0011BDLDIR359
  1538 01 SEGPART-ESTANDARIZADA-BDLDIRPIC X(60).HGO0011BDLDIR360
  1539 01 DIRECCION-ESTANDARIZADA-BDLDIR    PIC X(60).RMB0006BDLDIR361
  1540 01 DIRECCION-AUX-BDLDIRPIC X(60).RMB0006BDLDIR362
  1541 01 DIRECCION-62-BDLDIR.RMB0006BDLDIR363
  1542    03 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR364
  1543    03 DIRECCION-60-BDLDIRPIC X(60).RMB0006BDLDIR365
  1544    03 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR366
  1545 01 DIR-COMPUESTAS-BLN-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006BDLDIR367
  1546 01 DIR-COMPUESTAS-AST-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006BDLDIR368
  1547 01 CASO-NUMEROLETRA-BDLDIRPIC 9(01) VALUE 0.RMB0006BDLDIR369
  1548 01 VAR-RUTINA-NEWDIRBOG-BDLDIR.GJC0007BDLDIR370
  1549    02 LETRA-BDLDIRPIC X.GJC0007BDLDIR371
  1550    02 ORDEN-ASCII-BDLDIRPIC 9(03) VALUE 0.GJC0007BDLDIR372
  1551    02 TOTAL-ASCII-BDLDIRPIC 9(10).GJC0007BDLDIR373    1550    02 ORDEN-ASCII-BDLDIRPIC 9(03) VALUE 0.GJC0007BDLDIR372
  1551    02 TOTAL-ASCII-BDLDIRPIC 9(10).GJC0007BDLDIR373
  1552    02 NN8-BDLDIRPIC 9(05).GJC0007BDLDIR374
  1553    02 NN9-BDLDIRPIC 9(05).GJC0007BDLDIR375
  1554    02 NN10-BDLDIRPIC 9(05).GJC0007BDLDIR376
  1555    02 I-MEJ-BDLDIRPIC 9(3) VALUE 0.GJC0007BDLDIR377
  1556    02 J-MEJ-BDLDIRPIC 9(3) VALUE 0.GJC0007BDLDIR378
  1557    02 K-MEJ-BDLDIRPIC 9(3) VALUE 0.GJC0007BDLDIR379
  1558*   02 CAR-ANT-BDLDIRPIC X(1) VALUE SPACES.GJC0007BDLDIR380
  1559*   02 CAR-ACT-BDLDIRPIC 9(1) VALUE 0.GJC0007BDLDIR381
  1560    02 T-L-BDLDIR.GJC0007BDLDIR382
  156103 L-BDLDIR OCCURS 30 TIMES PIC X(20).GJC0007BDLDIR383
  1562    02 T-NUMMEJ-BDLDIR.GJC0007BDLDIR384
  156304 V-NUMMEJ-BDLDIR    OCCURS 10 TIMES PIC 9(5).GJC0007BDLDIR385
  1564    02 T-CARMEJ-BDLDIR.GJC0007BDLDIR386
  156504 V-CARMEJ-BDLDIR OCCURS 60 TIMES PIC X.GJC0007BDLDIR387
  1566    02 T-LETRAS-BDLDIR.GJC0007BDLDIR388
  156704 V-LETRAS-BDLDIR OCCURS 200 TIMES PIC X.GJC0007BDLDIR389
  1568 01 VAR-NEWDIR.GJC0007BDLDIR390
  1569    02 OPEN-BDLNEWDIRBOG-BDLDIR     PIC 9 VALUE 0.GJC0007BDLDIR391
  1570    02 HAY-BDLNEWDIRBOG-BDLDIRPIC 9 VALUE 0.GJC0007BDLDIR392
  1571    02 CIUDAD-BTA-BDLDIRPIC X(15).GJC0007BDLDIR393
  1572    02 DIRECCION-BTA-BDLDIRPIC X(60).GJC0007BDLDIR394
  1573    02 SW-NNPIC 9 VALUE 0.PJV0012BDLDIR395
  1574 01 VAR-EMAIL-BDLDIR.CAV0014BDLDIR396
  1575    02 EMAIL-BDLDIRPIC X(60) VALUE SPACES.CAV0014BDLDIR397
  1576    02 TMP-EMAIL-BDLDIRPIC X(60) VALUE SPACES.CAV0014BDLDIR398
  1577    02 ERR-EMAIL-BDLDIRPIC 9(01) VALUE 0.CAV0014BDLDIR399
  1578    02 CONT-ESP-INIC-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR400
  1579    02 CONT-ARO-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR401
  1580    02 CONT-PUN-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR402
  1581    02 CONT-ERR-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR403
  1582    02 LONG-EMIAL-BDLDIRPIC 9(4) VALUE ZEROS.CAV0014BDLDIR404
  1583 01 VAR-CELULAR-BDLDIR.CAV0014BDLDIR405
  1584    02 TEL-CELULAR-BDLDIRPIC 9(12).CAV0014BDLDIR406
  1585    02 ERR-CELULAR-BDLDIRPIC 9(01) VALUE 0.CAV0014BDLDIR407
  1586    02 TEL-AUX-CELULAR-BDLDIRPIC 9(12).CAV0014BDLDIR408
  1587    02 FILLER REDEFINES TEL-AUX-CELULAR-BDLDIR.CAV0014BDLDIR409
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  29
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  158804 P1-TEL-AUX-CEL-BDLDIR     PIC 9(2).CAV0014BDLDIR410
  158904 P2-TEL-AUX-CEL-BDLDIR     PIC 9(3).CAV0014BDLDIR411
  159088 ES-CELULAR-CEL-BDLDIR VALUES 300,301,   *>TIGOCAV0014BDLDIR412
  1591310,311,312,313,314,320,321, CAV0014BDLDIR413
  1592315,316,317,  *>MOVISTAR     CAV0014BDLDIR414
  1593350,*>AVANTELCAV0014BDLDIR415
  1594302,303,304,305,306,307,308, CAV0014BDLDIR416
  1595309,318,319,322,323,324,325, CAV0014BDLDIR417
  1596351,352,353,354,355. *>ASIGN CAV0014BDLDIR418
  1597     04 P3-TEL-AUX-CEL-BDLDIRPIC 9(7).CAV0014BDLDIR419
* 1598     COPY ICBDIR0001.FD.247
  1599* ICBDIR0001-FD.V01.007.ICBDIR001    1502 01  FDA-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR324
  1503 01  IND-TIPCAR-BDLDIRPIC X(01).RMB0006BDLDIR325
  1504 01  TIPCAR-WS-BDLDIRPIC X(01).RMB0006BDLDIR326
  1505 01  ENC-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR327
  1506*01 TABLA-DIR-ESTANDAR-BDLDIROCCURS 500 TIMESRMB0006BDLDIR328
  1507 01 TABLA-DIR-ESTANDAR-BDLDIROCCURS 2000 TIMESPJV0013BDLDIR329
  1508    ASCENDING KEY IS DIR-ORIGINAL-BDLDIRRMB0006BDLDIR330
  1509    INDEXED   BY  I-DIR-ESTANDAR-BDLDIR.RMB0006BDLDIR331
  1510    03 DIR-ORIGINAL-BDLDIRPIC X(20).RMB0006BDLDIR332
  1511    03 DIR-ESTANDAR-BDLDIRPIC X(10).RMB0006BDLDIR333
  1512* 01 TABLA-DIR-COMPUESTAS-BDLDIR.RMB0006BDLDIR334
  1513*    03 DIR-COMPUESTAS-AST-BDLDIRPIC X(20) OCCURS 90 TIMES. RMB0006BDLDIR335
  1514*    03 DIR-COMPUESTAS-BLN-BDLDIRPIC X(20) OCCURS 90 TIMES. RMB0006BDLDIR336
  1515*    03 DIR-COMPUESTAS-LON-BDLDIRPIC 9(02) OCCURS 90 TIMES. RMB0006BDLDIR337
  1516*    03 DIR-COMPUESTAS-TIP-BDLDIRPIC 9(01) OCCURS 90 TIMES. RMB0006BDLDIR338
  1517 01 TABLA-DIR-COMPUESTAS-BDLDIR.PJV0013BDLDIR339
  1518    03 DIR-COMPUESTAS-AST-BDLDIRPIC X(20) OCCURS 500 TIMES. PJV0013BDLDIR340
  1519    03 DIR-COMPUESTAS-BLN-BDLDIRPIC X(20) OCCURS 500 TIMES. PJV0013BDLDIR341
  1520    03 DIR-COMPUESTAS-LON-BDLDIRPIC 9(02) OCCURS 500 TIMES. PJV0013BDLDIR342
  1521    03 DIR-COMPUESTAS-TIP-BDLDIRPIC 9(01) OCCURS 500 TIMES. PJV0013BDLDIR343
  1522 01 TIP-NUEVA-DIRECCION-BDLDIR.RMB0006BDLDIR344
  1523    03 TIP-NVA-DIR-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR345
  1524 01 NUEVA-DIRECCION-BDLDIR.RMB0006BDLDIR346
  1525    03 NVA-DIR-BDLDIRPIC X(60) OCCURS 60 TIMES.  RMB0006BDLDIR347
  1526 01 DIRECCION-A-ESTANDARIZAR-BDLDIR.RMB0006BDLDIR348
  1527    03 DIR-A-EST-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR349
  1528 01 DIR-A-STD-BDLDIR REDEFINES DIRECCION-A-ESTANDARIZAR-BDLDIR.   CAV0014BDLDIR350
  1529    02 FILLER PIC X(60).CAV0014BDLDIR351
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  28
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1530*** VARIABLES QUE CONTIENE LA CIUDAD ORIGINALRMB0006BDLDIR352
  1531 01 CIUDAD-RES-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR353
  1532 01 CIUDAD-LAB-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR354
  1533 01 CIUDAD-COR-A-ESTANDAR-BDLDIRPIC X(20).RMB0006BDLDIR355
  1534 01 PART-A-ESTANDARIZAR-BDLDIR.RMB0006BDLDIR356
  1535    03 PART-A-ESTAN-BDLDIRPIC X(01) OCCURS 60 TIMES.  RMB0006BDLDIR357
  1536 01 PART-ESTANDARIZADA-BDLDIRPIC X(60).RMB0006BDLDIR358
  1537 01 PRIPART-ESTANDARIZADA-BDLDIRPIC X(60).HGO0011BDLDIR359
  1538 01 SEGPART-ESTANDARIZADA-BDLDIRPIC X(60).HGO0011BDLDIR360
  1539 01 DIRECCION-ESTANDARIZADA-BDLDIR    PIC X(60).RMB0006BDLDIR361
  1540 01 DIRECCION-AUX-BDLDIRPIC X(60).RMB0006BDLDIR362
  1541 01 DIRECCION-62-BDLDIR.RMB0006BDLDIR363
  1542    03 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR364
  1543    03 DIRECCION-60-BDLDIRPIC X(60).RMB0006BDLDIR365
  1544    03 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR366
  1545 01 DIR-COMPUESTAS-BLN-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006BDLDIR367
  1546 01 DIR-COMPUESTAS-AST-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006BDLDIR368
  1547 01 CASO-NUMEROLETRA-BDLDIRPIC 9(01) VALUE 0.RMB0006BDLDIR369
  1548 01 VAR-RUTINA-NEWDIRBOG-BDLDIR.GJC0007BDLDIR370
  1549    02 LETRA-BDLDIRPIC X.GJC0007BDLDIR371
  1550    02 ORDEN-ASCII-BDLDIRPIC 9(03) VALUE 0.GJC0007BDLDIR372
  1551    02 TOTAL-ASCII-BDLDIRPIC 9(10).GJC0007BDLDIR373    1454    03 E-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR276
  1455    03 F-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR277
  1456    03 G-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR278
  1457    03 H-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR279
  1458    03 I-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR280
  1459    03 J-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR281
  1460    03 J1-BDLDIRPIC 9(05) VALUE 0.HGO0011BDLDIR282
  1461    03 J2-BDLDIRPIC 9(05) VALUE 0.HGO0011BDLDIR283
  1462    03 CONTADOR-TEMPORAL-BDLDIRPIC 9(03).HGO0011BDLDIR284
  1463    03 M-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR285
  1464    03 N-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR286
  1465    03 K-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR287
  1466    03 II-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR288
  1467    03 JJ-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR289
  1468    03 NUM-OK-SEND-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR290
  1469    03 I-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR291
  1470    03 J-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR292
  1471    03 K-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR293
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  27
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1472    03 II-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR294
  1473    03 JJ-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR295
  1474    03 KK-STA-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR296
  1475    03 CALIFICA-DIR-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR297
  1476    03 CON-PART-ESTANDARIZADA-BDLDIR  PIC 9(03) VALUE 0.HGO0011BDLDIR298
  1477    03 CALIFICA-DIRPART1-BDLDIRPIC 9(03) VALUE 0.HGO0011BDLDIR299
  1478    03 CALIFICA-DIRPART2-BDLDIRPIC 9(03) VALUE 0.HGO0011BDLDIR300
  1479    03 CALIFICA-REAL-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR301
  1480    03 CAMPOS-N-DIR-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR302
  1481    03 COSI-DIR-BDLDIRPIC 9(09) VALUE 0.RMB0006BDLDIR303
  1482    03 RESI-DIR-BDLDIRPIC 9(09) VALUE 0.RMB0006BDLDIR304
  1483    03 TELE-DIR-BDLDIRPIC 9(12) VALUE 0.RMB0006BDLDIR305
  1484*** NOMBRE DEL ARCHIVO DE DIRECCIONES CERTIFICADASRMB0006BDLDIR306
  1485    03 TITLE-BDLSTDCERPIC X(80) VALUERMB0006BDLDIR307
  1486"$DATABASE/BDLSTDCER".RMB0006BDLDIR308
  1487*** LA SIGUIENTE VARIBALE INDICA EL TIPO DE DATO EN PROCESO ASI:  RMB0006BDLDIR309
  1488*** R - RESIDENCIARMB0006BDLDIR310
  1489*** L - LABORALRMB0006BDLDIR311
  1490*** C - CORRESPONDENCIARMB0006BDLDIR312
  1491    03 IND-DATO-BDLDIRPIC X(01).RMB0006BDLDIR313
  1492*** VARIABLE QUE CONTIENE LA SUMATORIA DE LOS DIGITOS DE LASRMB0006BDLDIR314
  1493*** PARTICULAS NUMERICAS DE UNA DIRECCIONRMB0006BDLDIR315
  1494    03 SUM-DIGITOS-BDLDIRPIC 9(10).RMB0006BDLDIR316
  1495    03 CAL-TEL-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR317
  1496    02 TELEFONO-BDLDIRPIC 9(12) VALUE 0.RMB0006BDLDIR318
  1497***************************VARIABLES DE STANDARIZAR************** RMB0006BDLDIR319
  1498 01 DIRACC-BDLDIR-BDLDIR.RMB0006BDLDIR320
  1499    03 VALIDACION-DIR-OUT-BDLDIRPIC 9(01).RMB0006BDLDIR321
  1500    03 PRIVILEGIO-INPUT-BDLDIRPIC 9(01).RMB0006BDLDIR322
  1501    03 NIT-CONSULTANTE-INPUT-BDLDIR   PIC 9(11).RMB0006BDLDIR323
  1502 01  FDA-DIREST-BDLDIRPIC 9(01).RMB0006BDLDIR324
  1503 01  IND-TIPCAR-BDLDIRPIC X(01).RMB0006BDLDIR325    140604 V-PRIDIGFINAUX-BDLDIRPIC 9(10).HGO0008BDLDIR228
  140704 V-VECFINAUX-BDLDIRPIC X(12).HGO0008BDLDIR229
  140804 V-STAFINAUX-BDLDIRPIC X(60).HGO0008BDLDIR230
  140904 V-CALFINAUX-BDLDIRPIC 9(03).HGO0008BDLDIR231
  141004 V-CALFINAUX-PART1-BDLDIR    PIC 9(03).HGO0011BDLDIR232
  141104 V-CALFINAUX-PART2-BDLDIR    PIC 9(03).HGO0011BDLDIR233
  141204 V-FECULTFINAUX-BDLDIRPIC 9(06).HGO0008BDLDIR234
  141304 V-NUENOMFINAUX-BDLDIRPIC 9(01).HGO0008BDLDIR235
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  26
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  141404 V-NUMDIRFINAUX-BDLDIRPIC X(60).HGO0008BDLDIR236
  1415    03 TABLA-DIR-BDLDIR.RMB0006BDLDIR237
  141604 T-DIR-BDLDIROCCURS 100 TIMES.RMB0006BDLDIR238
  141705 T-NUMDIR-BDLDIR .RMB0006BDLDIR239
  141806 V-NUMDIR-BDLDIROCCURS 10 TIMES PIC 9(5).   RMB0006BDLDIR240
  141905 V-CIUDADDIR-BDLDIRPIC X(20).RMB0006BDLDIR241
  142005 V-DIRECCION-BDLDIRPIC X(60).RMB0006BDLDIR242
  142105 V-TIPODIR-BDLDIRPIC X(01).RMB0006BDLDIR243
  142205 V-FECHADIR-BDLDIRPIC 9(06).RMB0006BDLDIR244
  142305 V-SUSDIR-BDLDIRPIC 9(06).RMB0006BDLDIR245
  142405 V-HASDIR-BDLDIRPIC X(100).RMB0006BDLDIR246
  142505 V-PRIDIG-BDLDIRPIC 9(10).RMB0006BDLDIR247
  142605 V-FECULT-BDLDIRPIC 9(06).HGO0008BDLDIR248
  142705 V-NUENOM-BDLDIRPIC 9(01) VALUES 0.HGO0008BDLDIR249
  1428    03   TABLA-FECHADIR-AUX-BDLDIR.RMB0006BDLDIR250
  142904 O-FECHADIR-AUX-BDLDIR    OCCURS 100 TIMES.RMB0006BDLDIR251
  143005 V-FECHADIR-AUX-BDLDIR PIC 9(06).RMB0006BDLDIR252
  1431    03 FECHA-RUTINA-BDLDIR.RMB0006BDLDIR253
  143205 ANO-RUTINA-BDLDIRPIC 9(04).RMB0006BDLDIR254
  143305 MES-RUTINA-BDLDIRPIC 9(02).RMB0006BDLDIR255
  1434    03 VEC-HIS-BDLDIRPIC X(12).RMB0006BDLDIR256
  1435    03 NUMDIR-BDLDIRPIC X(50).RMB0006BDLDIR257
  1436    03 DIRECCION-BDLDIRPIC X(60).HGO0011BDLDIR258
  1437    03 T-CARDIR-BDLDIR.RMB0006BDLDIR259
  143804 V-CARDIR-BDLDIROCCURS 60 TIMES PIC X(01).  RMB0006BDLDIR260
  1439    03 T-CARTOT-BDLDIR.RMB0006BDLDIR261
  144004 V-CARTOT-BDLDIROCCURS 10 TIMES PIC 9(05).  RMB0006BDLDIR262
  1441    03 CAR-ANT-BDLDIRPIC X(01).RMB0006BDLDIR263
  1442    03 CAR-ACT-BDLDIRPIC 9(01).RMB0006BDLDIR264
  1443    03 FECHA-MEJOR-BDLDIRPIC 9(06) VALUE 0.RMB0006BDLDIR265
  1444    03 IND-DIRCER-BDLDIRPIC 9(01) VALUE 0.RMB0006BDLDIR266
  1445    03 COMPOPIC 9(05) VALUE 0.HGO0008BDLDIR267
  1446    03 RMAYORPIC 9(01) VALUE 0.HGO0008BDLDIR268
  1447    03 CAMBIOPIC 9(01) VALUE 0.HGO0008BDLDIR269
  1448    03 NNPIC 9(01) VALUE 0.HGO0008BDLDIR270
  1449    03 CONTAPIC 9(05) VALUE 0.HGO0008BDLDIR271
  1450    03 CONTA1PIC 9(05) VALUE 0.HGO0008BDLDIR272
  1451    03 DIRECCIONPIC X(60) VALUE SPACES.     HGO0008BDLDIR273
  1452    03 DIRECCION1PIC X(60) VALUE SPACES.     HGO0008BDLDIR274
  1453    03 DIRECCION2PIC X(60) VALUE SPACES.     HGO0008BDLDIR275
  1454    03 E-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR276
  1455    03 F-BDLDIRPIC 9(05) VALUE 0.HGO0008BDLDIR277    1356    03 TABLA-DIRFINALES-BDLDIR.RMB0006BDLDIR178
  135704 T-DIRFINALES-BDLDIROCCURS 100 TIMES.RMB0006BDLDIR179
  135805 V-DIRFIN-BDLDIRPIC X(60).RMB0006BDLDIR180
  135905 V-PRIPARTFIN-BDLDIRPIC X(60).HGO0011BDLDIR181
  136005 V-SEGPARTFIN-BDLDIRPIC X(60).HGO0011BDLDIR182
  136105 V-CIUFIN-BDLDIRPIC X(20).RMB0006BDLDIR183
  136205 V-TIPFIN-BDLDIRPIC X(01).RMB0006BDLDIR184
  136305 V-FECFIN-BDLDIRPIC 9(06).RMB0006BDLDIR185
  136405 V-NUMFIN-BDLDIRPIC 9(03).RMB0006BDLDIR186
  136505 V-SUSFIN-BDLDIRPIC 9(06).RMB0006BDLDIR187
  136605 V-HASDIRFIN-BDLDIRPIC X(100).RMB0006BDLDIR188
  136705 V-PRIDIGFIN-BDLDIRPIC 9(10).RMB0006BDLDIR189
  136805 V-VECFIN-BDLDIRPIC X(12).RMB0006BDLDIR190
  136905 V-STAFIN-BDLDIRPIC X(60).RMB0006BDLDIR191
  137005 V-CALFIN-BDLDIRPIC 9(03).RMB0006BDLDIR192
  137105 V-CALFIN-PART1-BDLDIR    PIC 9(03).HGO0011BDLDIR193
  137205 V-CALFIN-PART2-BDLDIR    PIC 9(03).HGO0011BDLDIR194
  137305 V-FECULTFIN-BDLDIRPIC 9(06).HGO0008BDLDIR195
  137405 V-NUENOMFIN-BDLDIRPIC 9(01).HGO0008BDLDIR196
  137505 V-NUMDIRFIN-BDLDIRPIC X(60).HGO0008BDLDIR197
  1376    03 TABLA-DIRFINALESFIN-BDLDIR.HGO0008BDLDIR198
  137704 T-DIRFINALESFIN-BDLDIROCCURS 100 TIMES.HGO0008BDLDIR199
  137805 V-DIRFINFIN-BDLDIRPIC X(60).HGO0008BDLDIR200
  137905 V-PRIPARTFINFIN-BDLDIR   PIC X(60).HGO0011BDLDIR201
  138005 V-SEGPARTFINFIN-BDLDIR   PIC X(60).HGO0011BDLDIR202
  138105 V-CIUFINFIN-BDLDIRPIC X(20).HGO0008BDLDIR203
  138205 V-TIPFINFIN-BDLDIRPIC X(01).HGO0008BDLDIR204
  138305 V-FECFINFIN-BDLDIRPIC 9(06).HGO0008BDLDIR205
  138405 V-NUMFINFIN-BDLDIRPIC 9(03).HGO0008BDLDIR206
  138505 V-SUSFINFIN-BDLDIRPIC 9(06).HGO0008BDLDIR207
  138605 V-HASDIRFINFIN-BDLDIR    PIC X(100).HGO0008BDLDIR208
  138705 V-PRIDIGFINFIN-BDLDIR    PIC 9(10).HGO0008BDLDIR209
  138805 V-VECFINFIN-BDLDIRPIC X(12).HGO0008BDLDIR210
  138905 V-STAFINFIN-BDLDIRPIC X(60).HGO0008BDLDIR211
  139005 V-CALFINFIN-BDLDIRPIC 9(03).HGO0008BDLDIR212
  139105 V-CALFINFIN-PART1-BDLDIR PIC 9(03).HGO0011BDLDIR213
  139205 V-CALFINFIN-PART2-BDLDIR PIC 9(03).HGO0011BDLDIR214
  139305 V-FECULTFINFIN-BDLDIR    PIC 9(06).HGO0008BDLDIR215
  139405 V-NUENOMFINFIN-BDLDIR    PIC 9(01).HGO0008BDLDIR216
  139505 V-NUMDIRFINFIN-BDLDIR    PIC X(60).HGO0008BDLDIR217
  1396    03 T-DIRFINALESAUX-BDLDIR.HGO0008BDLDIR218
  139704 V-DIRFINAUX-BDLDIRPIC X(60).HGO0008BDLDIR219
  139804 V-PRIPARTFINAUX-BDLDIRPIC X(60).HGO0011BDLDIR220
  139904 V-SEGPARTFINAUX-BDLDIRPIC X(60).HGO0011BDLDIR221
  140004 V-CIUFINAUX-BDLDIRPIC X(20).HGO0008BDLDIR222
  140104 V-TIPFINAUX-BDLDIRPIC X(01).HGO0008BDLDIR223
  140204 V-FECFINAUX-BDLDIRPIC 9(06).HGO0008BDLDIR224
  140304 V-NUMFINAUX-BDLDIRPIC 9(03).HGO0008BDLDIR225
  140404 V-SUSFINAUX-BDLDIRPIC 9(06).HGO0008BDLDIR226
  140504 V-HASDIRFINAUX-BDLDIRPIC X(100).HGO0008BDLDIR227
  140604 V-PRIDIGFINAUX-BDLDIRPIC 9(10).HGO0008BDLDIR228
  140704 V-VECFINAUX-BDLDIRPIC X(12).HGO0008BDLDIR229    1308     03 FILLERPIC X(12) VALUE "     1992070".HGO0008BDLDIR130
  1309     03 FILLERPIC X(12) VALUE "     1993020".HGO0008BDLDIR131
  1310     03 FILLERPIC X(12) VALUE "     1995091".HGO0010BDLDIR132
  1311     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR133
  1312     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR134
  1313     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR135
  1314     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR136
  1315     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR137
  1316     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR138
  1317     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR139
  1318     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR140
  1319     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR141
  1320     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR142
  1321     03 FILLERPIC X(12) VALUE "".HGO0010BDLDIR143
  1322 01  FILLERREDEFINES TELS-EXCLU.HGO0008BDLDIR144
  1323*TELEXC     02 T-TELS-EXCLUPIC X(12) OCCURS 12 TIMEHGO0010BDLDIR145
  1324     02 T-TELS-EXCLUPIC X(12) OCCURS 24 TIMES.     HGO0010BDLDIR146
  1325 01 VARIABLES-BDLDIR.RMB0006BDLDIR147
  1326    03 TEL-OK-BDLDIRPIC 9(05) VALUE 0.RMB0006BDLDIR148
  1327    03 TABLA-TELFINALES-BDLDIR.RMB0006BDLDIR149
  132804 T-TELFINALES-BDLDIROCCURS 100 TIMES.RMB0006BDLDIR150
  1329*05 V-TELFIN-BDLDIRPIC X(12).HGO0008BDLDIR151
  1330*05 V-TELFIN-BDLDIR.RGH0009BDLDIR152
  133105 V-TELFIN-BDLDIRPIC X(12).RGH0009BDLDIR153
  133205 V-TELFIN-BDLDIR-RREDEFINESRGH0009BDLDIR154
  1333V-TELFIN-BDLDIR.RGH0009BDLDIR155
  133410 V-TELFIN-BDLDIR-1     PIC X(05).HGO0008BDLDIR156
  133510 V-TELFIN-BDLDIR-2     PIC X(07).HGO0008BDLDIR157
  133605 V-CIUTELFIN-BDLDIRPIC X(20).RMB0006BDLDIR158
  133705 V-FECTELFIN-BDLDIRPIC 9(06).RMB0006BDLDIR159
  133805 V-TIPTELFIN-BDLDIRPIC X(01).RMB0006BDLDIR160
  133905 V-NUMTELFIN-BDLDIRPIC 9(03).RMB0006BDLDIR161
  134005 V-SUSTELFIN-BDLDIRPIC 9(06).RMB0006BDLDIR162
  134105 V-HASTELFIN-BDLDIRPIC X(50).RMB0006BDLDIR163
  134205 V-VECTELFIN-BDLDIRPIC X(50).RMB0006BDLDIR164
  134305 V-CALTELFIN-BDLDIRPIC 9(03).RMB0006BDLDIR165
  134405 V-FECULTTELFIN-BDLDIR    PIC 9(06).HGO0008BDLDIR166
  1345    03 TABLA-TEL-BDLDIR.RMB0006BDLDIR167
  134604 T-TEL-BDLDIROCCURS 100 TIMES.RMB0006BDLDIR168
  134705 V-TELEFONO-BDLDIRPIC X(12).RMB0006BDLDIR169
  134805 V-CIUDADTEL-BDLDIRPIC X(20).RMB0006BDLDIR170
  134905 V-TIPOTEL-BDLDIRPIC X(15).RMB0006BDLDIR171
  135005 V-FECHATEL-BDLDIRPIC 9(06).RMB0006BDLDIR172
  135105 V-SUSTEL-BDLDIRPIC 9(06).RMB0006BDLDIR173
  135205 V-HASTEL-BDLDIRPIC X(50).RMB0006BDLDIR174
  135305 V-FECULTTEL-BDLDIRPIC 9(06).HGO0008BDLDIR175
  1354    03 NUMTEL-BDLDIRPIC X(12).RMB0006BDLDIR176
  1355    03 DIR-OK-BDLDIRPIC 9(05).RMB0006BDLDIR177
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  25
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1356    03 TABLA-DIRFINALES-BDLDIR.RMB0006BDLDIR178
  135704 T-DIRFINALES-BDLDIROCCURS 100 TIMES.RMB0006BDLDIR179    1260    02 POLITICA-EXC-MAL-DIR-BDLDIR    PIC 9(02) VALUE 1.RMB0006BDLDIR82
  1261*** PARAMETROS DE INDICADOR DE DIRECCION CERTIFICADARMB0006BDLDIR83
  1262    02 DIRCER-BDLDIRPIC 9(01).RMB0006BDLDIR84
  1263*** PARAMETROS DE PUNTOS ADICIONALESRMB0006BDLDIR85
  1264    02 PTSADI-BDLDIRPIC 9(02).RMB0006BDLDIR86
  1265*** PARANETRO DE CIUDAD ORIGINALRMB0006BDLDIR87
  1266    02 CIUDAD-BDLDIRPIC X(20).RMB0006BDLDIR88
  1267 01 VARIABLES-CIU.RMB0006BDLDIR89
  1268    02 I-CIU-BDLDIRPIC 9(04).RMB0006BDLDIR90
  1269    02 J-CIU-BDLDIRPIC 9(04).RMB0006BDLDIR91
  1270    02 CIUDAD-ESTANDAR-CIU-BDLDIR     PIC X(30).RMB0006BDLDIR92
  1271    02 PATRON-CIU-BDLDIRPIC 9(03) VALUE 0.RMB0006BDLDIR93
  1272    02 CAMPO-CIU-BDLDIRPIC X(30) VALUE SPACES.     RMB0006BDLDIR94
  1273    02 CODIGO-DANE-CIU-BDLDIRPIC X(08) VALUE SPACES.     RMB0006BDLDIR95
  1274    02 CODIGO-DANE-N-CIU-BDLDIRREDEFINESRMB0006BDLDIR96
  1275CODIGO-DANE-CIU-BDLDIRPIC 9(08).RMB0006BDLDIR97
  1276    02 LLAVE-AUX21-CIU-BDLDIR.RMB0006BDLDIR98
  127703 FILLERPIC X(01) VALUE SPACES.     RMB0006BDLDIR99
  127803 LLAVE-AUX-CIU-BDLDIRPIC X(20) VALUE SPACES.     RMB0006BDLDIR100
  1279    02 OPEN-BDLSTDCIU-BDLDIRPIC 9(01) VALUE 0.RMB0006BDLDIR101
  1280    02 BASURA-CIU-BDLDIRPIC X(01) VALUE SPACES.     RMB0006BDLDIR102
  1281 01 VARIABLES-TELEXC.HGO0008BDLDIR103
  1282     03  W-OCURRPIC 99999.HGO0008BDLDIR104
  1283     03  W-IPIC 99999.HGO0008BDLDIR105
  1284     03  W-POSIUNIPIC 99999.HGO0008BDLDIR106
  1285     03  W-TELANTPIC X(12).HGO0008BDLDIR107
  1286     03  W-TELDESPIC X(12).HGO0008BDLDIR108
  1287     03  W-POSANTPIC 99999.HGO0008BDLDIR109
  1288     03  W-POSDESPIC 99999.HGO0008BDLDIR110
  1289     03  W-POSRCPIC 99999.HGO0008BDLDIR111
  1290     03  SW-1PIC 9.HGO0008BDLDIR112
  1291     03  SW-2PIC 9.HGO0008BDLDIR113
  1292     03  SW-ENCUENTRA-PIPIC 9.HGO0008BDLDIR114
  1293     03  W-POSIPIC 99999.HGO0008BDLDIR115
  1294     03  LONGCOMP-EXCLUPIC 99999.HGO0008BDLDIR116
  1295     03  POSI-EXCLUPIC 99999.HGO0008BDLDIR117
  1296     03  IQPIC 99999.HGO0008BDLDIR118
  1297 01  TELS-EXCLU.HGO0008BDLDIR119
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  24
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1298     03 FILLERPIC X(12) VALUE "     0000000".HGO0008BDLDIR120
  1299     03 FILLERPIC X(12) VALUE "     1111111".HGO0008BDLDIR121
  1300     03 FILLERPIC X(12) VALUE "     1234546".HGO0008BDLDIR122
  1301     03 FILLERPIC X(12) VALUE "     1475632".HGO0008BDLDIR123
  1302     03 FILLERPIC X(12) VALUE "     1477500".HGO0008BDLDIR124
  1303     03 FILLERPIC X(12) VALUE "     1756874".HGO0008BDLDIR125
  1304     03 FILLERPIC X(12) VALUE "     1975090".HGO0008BDLDIR126
  1305     03 FILLERPIC X(12) VALUE "     1978030".HGO0008BDLDIR127
  1306     03 FILLERPIC X(12) VALUE "     1985110".HGO0008BDLDIR128
  1307     03 FILLERPIC X(12) VALUE "     1986090".HGO0008BDLDIR129
  1308     03 FILLERPIC X(12) VALUE "     1992070".HGO0008BDLDIR130
  1309     03 FILLERPIC X(12) VALUE "     1993020".HGO0008BDLDIR131    1212* INTERSCHEMES *EN LA SALIDA EL CAMPO FECHA ULTIMO REP *BDLDIR34
  1213** TELEXC - SE UNIFICAN TELEFONOS QUE COINCIDAN CON*BDLDIR35
  1214**LOS ULTIMOS 7 NUMEROS DEL TELEFONO. SE *BDLDIR36
  1215**CREA TABLA PARA LA EXCLUSION DE TELEFO-*BDLDIR37
  1216**NOS. SE AGREGA EN EL REPORTE FECHA     *BDLDIR38
  1217**ULTIMO REPORTE.*BDLDIR39
  1218******************************************************************BDLDIR40
  1219* RGH0009* TELEX9 - UTILIZAR REDEFINICION PARA VARIABLE    *BDLDIR41
  1220* R.GALVIS     *V-TELFIN-BDLDIR*BDLDIR42
  1221* MARZO/2009   **BDLDIR43
  1222* INTERSCHEMES **BDLDIR44
  1223******************************************************************BDLDIR45
  1224* HGO0010* TEXTEL - Se agregan nuevas exclusiones en la   *BDLDIR46
  1225* H. GARCIA O.  *tabla de telefonos y se amplia el     *BDLDIR47
  1226* SEP.01/2009   *numero de ocurrencias*BDLDIR48
  1227* INTERSCHEMES  **BDLDIR49
  1228******************************************************************BDLDIR50
  1229* HGO0011* PYSPAR - AJUSTE QUE BUSCAR GENERAR CALIFICACION*BDLDIR51
  1230* H. GARCIA O.  *PARA LA PRIMERA Y SEGUNDA PARTICULA Y *BDLDIR52
  1231* AGO. 25/2009  *LUEGO UNIFICAR TENIENDO EN CUENTA ESTE*BDLDIR53
  1232* INTERSCHEMES. *CRITERIO*BDLDIR54
  1233******************************************************************BDLDIR55
  1234* PJV0012* NN0012 - AJUSTE, PARA EVITAR QUE SE REPITAN     *BDLDIR56
  1235* P.VARGAS     *DIRECCIONES EN EL MISMO REPORTE CUNADO *BDLDIR57
  1236* JUL 01/2010  *SE TRATAN DE NUEVAS NOMENCLATURAS EN   *BDLDIR58
  1237* DATACREDITO  *BOGOTA.*BDLDIR59
  1238******************************************************************BDLDIR60
  1239* PJV0013* AMP013 -SE AMPLIAN LOS LIMITES DE LAS TABLAS DE *BDLDIR61
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  23
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1240* P.VARGAS     *ACEPCIONES QUE SE CARGAN EN MEMORIA.    *BDLDIR62
  1241* SEP 09/2010  *TAMBIEN SE AJUSTA PARA EVITAR LA*BDLDIR63
  1242* DATACREDITO  *REPETICION DE DIRECCIONES PARA UNA MISMA*BDLDIR64
  1243**IDENTIFICACION.*BDLDIR65
  1244******************************************************************BDLDIR66
  1245* CAV0014* CALDYT - SE ADICIONA LAS VARIABLES PARA VALIDAR *BDLDIR67
  1246* C.VELASCO.   *LOS CAMPOS EMAIL Y TELEFONO CELULAR.   *BDLDIR68
  1247* SEP 18/2012  **BDLDIR69
  1248******************************************************************BDLDIR70
  1249* RMB0015* FCRGCR- SE INTEGRA EL AJUSTE DE FECHAS DE*BDLDIR71
  1250* R.MARTINEZ   *DIRECCIONES DE CUENTAS CERRADAS*BDLDIR72
  1251* OCT 16/2012  *PARA IGUALAR CON LA RUTINA BDLDI2*BDLDIR73
  1252******************************************************************BDLDIR74
  1253*BDLDIR75
  1254 01  FECHAS-BDLDI2.RMB0015BDLDIR76
  1255     02 FEC-AAAAMM-BDLDI2PIC 9(06).RMB0015BDLDIR77
  1256     02 FEC-MMAA-BDLDI2PIC 9(04).RMB0015BDLDIR78
  1257     02 CTA-ACTIVAPIC 9(01).RMB0015BDLDIR79
  1258 01 PARAMETROS-BDLDIR.RMB0006BDLDIR80
  1259    02 POLITICA-EXC-CAL-DIR-BDLDIR    PIC 9(02) VALUE 0.RMB0006BDLDIR81
  1260    02 POLITICA-EXC-MAL-DIR-BDLDIR    PIC 9(02) VALUE 1.RMB0006BDLDIR82
  1261*** PARAMETROS DE INDICADOR DE DIRECCION CERTIFICADARMB0006BDLDIR83    1164 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.232
  1165 01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.233
  1166 01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.234
  1167 01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.235
  1168 01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.236
  1169 01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.237
  1170 01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.238
  1171 01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.239
  1172 01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.240
  1173241
  1174 01 MAS-DATOS.242
  1175     03 IPIC 9(02) VALUE ZERO.243
  1176     03 JPIC 9(02) VALUE ZERO.244
  1177245
* 1178     COPY  BDLDIR.WS.246
  1179*BDLDIR-WS.v.0015BDLDIR1
  1180*******************************************************************BDLDIR2
  1181* RMB0002* ALG001 - SE AUMENTAN LAS VARIABLES NECESARIAS PORBDLDIR3
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  22
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1182** ALG001 - EL CAMBIO EN EL ORDEN DE LA DIRECCION MASBDLDIR4
  1183* FEB-15-2003  *PROBABLE AUMENTANDO UN PESO CON BASE A LABDLDIR5
  1184* R.MARTINEZ   *CONFORMACION DE LA DIRECCION O DEL TELEFONOBDLDIR6
  1185*******************************************************************BDLDIR7
  1186* RMB0003* DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOSBDLDIR8
  1187* MAR-15-2003  *PERMISOS DE ACCESO A LA BASE DE DATOS DEBDLDIR9
  1188* R.MARTINEZ   *DIRECCIONESBDLDIR10
  1189*******************************************************************BDLDIR11
  1190* VHF0004* ESTAN1 - SE AUMENTAN LOS TAMANOS DE VARIABLESBDLDIR12
  1191* MAY-27-2003  *PARA PERMITIR MAXIMO HASTA 30 PARTICULASBDLDIR13
  1192* V.FORERO     *PARA UNA DIRECCIONBDLDIR14
  1193*******************************************************************BDLDIR15
  1194* FAC0005* AMPDIR - AMPLIACION DE LA ESTRUCTURA DE ARCHIVOBDLDIR16
  1195* F.CUADROS C. *ICBDIRBDLDIR17
  1196* FEB.15/2006  * DOMICI - SEÑAL PARA MATCH DE DOMICILIACIONBDLDIR18
  1197*******************************************************************BDLDIR19
  1198* RMB0006* RCNCER - OPTIMIZACION PARA PRODUCTO RECONOCER.  *BDLDIR20
  1199* R.MARTINEZ   *SE CAMBIAN VARIABLES QUE UTILIZA LA    *BDLDIR21
  1200* JUN.15/2006  *RUTINA PARA ESTANDARIZACION ADEMAS DE  *BDLDIR22
  1201**LA DEFINICION DE NUEVAS VARIABLES PARA *BDLDIR23
  1202**OPTIMIZACION (VER DETALLES EN PATCH DE *BDLDIR24
  1203**BDLDIR.PROC).BDLDIR25
  1204******************************************************************BDLDIR26
  1205* GJC0007* NWDIRB - VARIABLES PARA IDENTIFICAR CUANDO UNA  *BDLDIR27
  1206* G.JIMENEZ    *DIRECCION DE BOGOTA TIENE NUEVA NOMEN- *BDLDIR28
  1207* FEBRERO/2007 *CLATURA*BDLDIR29
  1208******************************************************************BDLDIR30
  1209* HGO0008* UNIDIR - UNIFICAR DIRECCIONES QUE TENGAN*BDLDIR31
  1210* H.GARCIA     *COINCIDENCIAS CON OTRAS DIRECCIONES CON*BDLDIR32
  1211* MARZO/2009   *MAYOR CANTIDAD DE INFORMACION - INCLUIR*BDLDIR33
  1212* INTERSCHEMES *EN LA SALIDA EL CAMPO FECHA ULTIMO REP *BDLDIR34
  1213** TELEXC - SE UNIFICAN TELEFONOS QUE COINCIDAN CON*BDLDIR35    1116 01  pgmpic x(10) value "CARGAJUR".184
  1117185
  1118186
  1119******************************************************************187
  1120* Datos para la búsqueda en base alterna188
  1121 01  W-DERECHOSPIC 9 value 0.189
  1122 01  CODIGO-ERRORpic 99 value 00.190
  1123191
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  21
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/BDIIALE.FD
  1124 01  SW-BDIIALEpic 9 value 0.192
  1125 01  HACER-MATCHPIC 9 value 0.193
  1126 01  CADENA-ENTRAPIC X(60).194
  1127 01  CADENA-SALEPIC X(60).195
  1128 01  IND-ALFABETICOPIC  X(01).196
  1129     88 SI-ALFABETICOVALUE " " "A" "B" "C" "D" "E" "F"197
  1130"G" "H" "I" "J" "K" "L" "M"198
  1131"N" "/" "O" "P" "Q" "R" "S"199
  1132"T" "U" "V" "W" "X" "Y" "Z"200
  1133"Ñ".201
  1134 01  OPEN-DIRPIC 9 value 0.202
  1135 01  W-BLOQUESPIC 9 value 2.203
  1136204
  1137 01  DATOS-E.205
  1138     03 TIPOID-Epic 9.206
  1139     03 NUMID-Epic 9(11).207
  1140     03 NOMBRE-Epic x(45).208
  1141209
  1142 01  REG-VALIDAS.210
  1143     03 TIP-VALPIC 9.211
  1144     03 CED-VALPIC 9(11).212
  1145     03 NOM-VALPIC X(45).213
  1146     03 FEC-EXP-VALPIC 9(08).214
  1147     03 MUN-EXP-VALPIC X(15).215
  1148     03 DEP-EXP-VALPIC X(15).216
  1149     03 VIG-VALPIC X(02).217
  1150     03 GENERO-VALPIC X(01).218
  1151     03 EDAD-VALPIC X(03).219
  1152     03 EDAD-RANGOPIC X(05).220
  1153     03 FILLER-2-VALPIC X(51).221
  1154222
  1155 01  W-CONTADORES.223
  1156     03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.224
  1157     03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.225
  1158     03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.226
  1159     03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.227
  1160     03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.228
  1161229
  1162 01  SUSCRIPTOR-AUXPIC 9(06).230
  1163 01  REG-LEIDOSPIC 9(07) VALUE ZEROS.231
  1164 01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.232
  1165 01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.233  ^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*list("CARGAJUR.lst")1$SET LIST SETTING LISTWIDTH"120"1
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*"ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*"CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"120" LITVAL-SIZE"4" LOCKTYPE
*"0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*NOZEROLENGTHFALSE NOZEROSEQ NOZWB2 IDENTIFICATION DIVISION.23 PROGRAM-ID.    CARGAJUR.34******************************************************************45* Actualizacion del archivo de alertas con los datos provistos56* por Jurad6^/   121* Archivos de base alterna50122******************************************************************51
*  123     copy BDACSV.FS.52
   124* BDACSV-FS.V.0001BDACSV1
   125* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DEBDACSV2
   126* DATOS OFICIALES DE REGIS, DIAN Y DASBDACSV3
   127     SELECT BDACSVBDACSV4
   128ASSIGN TO DISK "$DATABASE/BDACSV"BDACSV5
   129ORGANIZATION IS INDEXEDBDACSV6
   130ACCESS MODE IS DYNAMICBDACSV7
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page   4
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBLys/BDACSV.FS)
   131RECORD KEY IS LLAVE-BDACSVBDACSV8
   132LOCK MODE IS MANUAL WITH LOCK ON RECORD.BDACSV9
*  133     copy ICBDIR.FS.53
   134* ICBDIR-fs.v01.002ICBDIR1
   135* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADAICBDIR2
   136* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   137 $SET IDXFORMAT"8"ICBDIR4
   138ICBDIR5
   139$SET CONSTANT SW-STATUS-ICBDIR"NO"ICBDIR6
   140     SELECT MAESTRO-DIRECCICBDIR7
   141ASSIGN TO DISK MAES-DIRECC-TITLEICBDIR8
   142ORGANIZATION IS INDEXEDICBDIR9
   143ACCESS MODE IS DYNAMICICBDIR10
   144RECORD KEY IS LLAVE-DIRECCICBDIR11
   145$IF SW-STATUS-ICBDIR = "NO"ICBDIR12
   146$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."ICBDIR13
   147$ELSEICBDIR14
   148$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."ICBDIR15
   149XFILE STATUS IS EST-ICBDIRICBDIR16
   150$ENDICBDIR17
   151LOCK MODE IS MANUAL WITH LOCK ON RECORD.ICBDIR18
   152 $SET IDXFORMAT"0"ICBDIR19
*  153     copy BDLCLI.FS.54
   154*BDLCLI-FS.v.0001BDLCLI1
   155*ARCHIVO DE  CLIENTES DE BASE DE DATOS DE LOCALIZACION CON INDICADOR YBDLCLI2
   156*PRIVILEGIO ACTUALIZADO.BDLCLI3
   157    SELECT BDLCLIBDLCLI4
   158ASSIGN TO DISK BDLCLI-TITLEBDLCLI5
   159ORGANIZATION IS INDEXEDBDLCLI6
   160ACCESS MODE IS DYNAMICBDLCLI7
   161RECORD KEY IS LLAVE-BDLCLIBDLCLI8
   162LOCK MODE IS AUTOMATIC.BDLCLI9
*  163     COPY ICBSUS.FS.55
   165$SET CONSTANT SW-STATUS-ICBSUS"NO"ICBSUS2
   166     SELECT SUSCRIPTORICBSUS3
   167ASSIGN TO DISK SUSCRIPTOR-TITLEICBSUS4
   168ORGANIZATION IS INDEXEDICBSUS5
   169ACCESS MODE IS DYNAMICICBSUS6
   170RECORD KEY IS LLAVE-SUSCRIPICBSUS7
   171$IF SW-STATUS-ICBSUS = "NO"ICBSUS8/   502     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002BDACSV34503*    03  FILLERPIC X(50).STT0003BDACSV35
   504     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003BDACSV36
   50505  DES-NOMBRE2-BDACSV    PIC X(12).STT0003BDACSV37
   50605  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003BDACSV38
   50705  DEP-EXP-BDACSVPIC 9(02).STT0003BDACSV39
   50805  MUNIC-EXP-BDACSVPIC 9(03).STT0003BDACSV40
   50905  ESTADO-VIG-BDACSV     PIC 9(02).STT0003BDACSV41
   51005  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003BDACSV42
   51105  IND-SEXO-BDACSVPIC X.STT0003BDACSV43
   51205  IND-ESTADO-BDACSV     PIC 9.STT0003BDACSV44
   51305  IND-CONSULADO-BDACSV  PIC 9(1).STT0003BDACSV45
   51405  COD-CONSULADO-BDACSV  PIC 9(3).STT0003BDACSV46
   515     03  FILLERPIC X(07).STT0003BDACSV47
   516*    03  FILLERPIC X(48).BDACSV48
   517BDACSV49
   518BDACSV50
   519BDACSV51
*  520     copy ICBDIR.FD.166
   521* ICBDIR-fd.v01.001.ICBDIR1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACATADO DE LAS  REPORTADASICBDIR2
   523* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   524*----------------------------------------------------------------*ICBDIR4
   525 FD  MAESTRO-DIRECC.ICBDIR5
   526 01  REG-DIRECC.ICBDIR6
   527     03  LLAVE-DIRECC.ICBDIR7
   52805  LLAVE-PRI-DIRECC.ICBDIR8
   52907  TIPO-ID-DIRECC    PIC 9(01).ICBDIR9
   53007  NUM-ID-DIRECC     PIC 9(11).ICBDIR10
   53105  LLAVE-ALT-DIRECC.ICBDIR11
   53207  COD-SUS-DIRECC    PIC 9(06).ICBDIR12
   53307  COD-CTA-DIRECC    PIC 9(02).ICBDIR13
   53407  NUM-CTA-DIRECC    PIC X(18).ICBDIR14
   535     03  CIURES-DIRECCPIC X(15).ICBDIR15
   536     03  DIRRES-DIRECCPIC X(30).ICBDIR16
   537     03  TELRES-DIRECCPIC 9(10) COMP-3.ICBDIR17
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR.FD)
   538     03  CIULAB-DIRECCPIC X(15).ICBDIR18
   539     03  TELLAB-DIRECCPIC 9(10) COMP-3.ICBDIR19
   540     03  CIUCOR-DIRECCPIC X(15).ICBDIR20
   541     03  DIRCOR-DIRECCPIC X(30).ICBDIR21
   542     03  FECACT-DIRECCPIC 9(06) COMP-3.ICBDIR22
   544     03  FECAPE-DIRECCPIC 9(06) COMP-3.ICBDIR24
   545     03  FECCRE-DIRECCPIC 9(06) COMP-3.ICBDIR25
   546     03  DIRLAB-DIRECCPIC X(23).ICBDIR26
*  547     copy BDLCLI.FD.167
   548*BDLCLI-FD.v.00003BDLCLI1
   549*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR YBDLCLI2
   550*PRIVILEGIO ACTUALIZADOS.BDLCLI3
   551*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADOBDLCLI4
   552*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONESBDLCLI5   *  520     copy ICBDIR.FD.166521* ICBDIR-fd.v01.001.ICBDIR1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACATADO DE LAS  REPORTADASICBDIR2
   523* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   524*----------------------------------------------------------------*ICBDIR4
   525 FD  MAESTRO-DIRECC.ICBDIR5
   526 01  REG-DIRECC.ICBDIR6
   527     03  LLAVE-DIRECC.ICBDIR7
   52805  LLAVE-PRI-DIRECC.ICBDIR8
   52907  TIPO-ID-DIRECC    PIC 9(01).ICBDIR9
   53007  NUM-ID-DIRECC     PIC 9(11).ICBDIR10
   53105  LLAVE-ALT-DIRECC.ICBDIR11
   53207  COD-SUS-DIRECC    PIC 9(06).ICBDIR12
   53307  COD-CTA-DIRECC    PIC 9(02).ICBDIR13
   53407  NUM-CTA-DIRECC    PIC X(18).ICBDIR14
   535     03  CIURES-DIRECCPIC X(15).ICBDIR15
   536     03  DIRRES-DIRECCPIC X(30).ICBDIR16
   537     03  TELRES-DIRECCPIC 9(10) COMP-3.ICBDIR17
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR.FD)
   538     03  CIULAB-DIRECCPIC X(15).ICBDIR18
   539     03  TELLAB-DIRECCPIC 9(10) COMP-3.ICBDIR19
   540     03  CIUCOR-DIRECCPIC X(15).ICBDIR20
   541     03  DIRCOR-DIRECCPIC X(30).ICBDIR21
   542     03  FECACT-DIRECCPIC 9(06) COMP-3.ICBDIR22
   544     03  FECAPE-DIRECCPIC 9(06) COMP-3.ICBDIR24
   545     03  FECCRE-DIRECCPIC 9(06) COMP-3.ICBDIR25
   546     03  DIRLAB-DIRECCPIC X(23).ICBDIR26
*  547     copy BDLCLI.FD.167
   548*BDLCLI-FD.v.00003BDLCLI1
   549*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR YBDLCLI2
   550*PRIVILEGIO ACTUALIZADOS.BDLCLI3
   551*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADOBDLCLI4
   552*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONESBDLCLI5
   553************************************************************BDLCLI6
   554*NDG0002    * INF-CR  : INDICADOR SI EL SUSCRIPTOR ENTREGA *BDLCLI7
   555*N.DUARTE   *INFORMACION CREDITICIA*BDLCLI8
   556*FEB/2003   *0 - NO ENTREGA INFORMACION*BDLCLI9
   557**1 - SI ENTREGA INFORMACION*BDLCLI10
   558** VALDB   : INDICADOR PARA VALIDAR LA BASE DE  *BDLCLI11
   559**DATOS CUANDO GENERE EL REPORTE     *BDLCLI12
   560**S - SI VALIDA CONTRA BASE DATOS  *BDLCLI13
   561**N - NO VALIDA CONTRA BASE DATOS  *BDLCLI14
   562***BDLCLI15
   563************************************************************BDLCLI16
   564*RMB0003    * BLOQ01  : INDICADOR PARA BLOQUEAR LA INFORMA *BDLCLI17
   565*R.MARTINEZ *CION DE UN NIT*BDLCLI18
   566*OCT-1-2011 *"B" = INFORMACION BLOQUEADA*BDLCLI19
   567************************************************************BDLCLI20
   568 FD  BDLCLI.BDLCLI21
   569 01  COMPLETO-BDLCLI.BDLCLI22
   570     03  LLAVE-BDLCLI.BDLCLI23//  1609* FORERO*DIVISION DE DOCUMENTOS. TAMBIEN SE     *ICBDIR0011
  1610* JUL.11/2006  *CREARON CAMPOS QUE INDICAN SI LA*ICBDIR0012
  1611**DIRECCION FUE GEOREFERENCIADA.*ICBDIR0013
  1612******************************************************************ICBDIR0014
  1613* CAV0004* BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *ICBDIR0015
  1614* C VELASCO    *EL REGISTRO CORRESPONDE A UNA CUENTA   *ICBDIR0016
  1615* AGO/27/2007  *SIN VALIDAR IDENTIFICACION*ICBDIR0017
  1616******************************************************************ICBDIR0018
  1617* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *ICBDIR0019
  1618* VICTOR HUGO  *SE ADICIONAN FECHAS INDEPENDIENTES PARA*ICBDIR0020
  1619* FORERO*CADA TIPO DE DATOS DE LOCALIZACION     *ICBDIR0021
  1620* JUL.25/2008  **ICBDIR0022
  1621******************************************************************ICBDIR0023
  1622* RMB0006* DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*ICBDIR0024
  1623* R MARTINEZ   *S DE RESICENCIA,LABORAL Y CORRESPONDENC*ICBDIR0025
  1624* SEP/07/2011  *CIA.*ICBDIR0026
  1625******************************************************************ICBDIR0027
  1626* CAV0007* FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *ICBDIR0028
  1627* C.VELASCO    *IDENTIFICAR CUANDO ESTABA VACIO Y SE   *ICBDIR0029
  1628* OCT/25/2012  *ACTUALIZO.*ICBDIR0030
  1629******************************************************************ICBDIR0031
  1630 FD  MAESTRO-DIRECC.ICBDIR0032
*  82-S**(   0)**32
**    COBOL Division or Section header encountered in incorrect order32
  1631 01  REG-DIRECC.ICBDIR0033
  1632     03  LLAVE-DIRECC.ICBDIR0034
  163305  LLAVE-PRI-DIRECC.ICBDIR0035
  163407  TIPO-ID-DIRECC    PIC 9(01).ICBDIR0036
  163507  NUM-ID-DIRECC     PIC 9(13).FAC0002ICBDIR0037
  163605  LLAVE-ALT-DIRECC.ICBDIR0038
  163707  COD-SUS-DIRECC    PIC 9(06).ICBDIR0039
  163807  COD-CTA-DIRECC    PIC 9(02).ICBDIR0040
  163907  NUM-CTA-DIRECC    PIC X(18).ICBDIR0041
  1640     03  FECAPE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0042
  1641     03  FECCRE-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0043
  1642     03  FECACT-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0044
  1643     03  CIURES-DIRECCPIC X(20).FAC0002ICBDIR0045
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  30
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
  1644     03  DPTRES-DIRECCPIC X(20).FAC0002ICBDIR0046
  1645     03  DIRRES-DIRECCPIC X(60).FAC0002ICBDIR0047
  1646     03  TELRES-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0048
  1647     03  FECRES-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0049
  1648     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0050
  1649     03  CIULAB-DIRECCPIC X(20).FAC0002ICBDIR0051
  1650     03  DPTLAB-DIRECCPIC X(20).FAC0002ICBDIR0052
  1651     03  DIRLAB-DIRECCPIC X(60).FAC0002ICBDIR0053
  1652     03  TELLAB-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0054
  1653     03  FECLAB-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0055
  1654     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0056
  1655     03  CIUCOR-DIRECCPIC X(20).FAC0002ICBDIR0057
  1656     03  DPTCOR-DIRECCPIC X(20).FAC0002ICBDIR0058  1657     03  DIRCOR-DIRECCPIC X(60).FAC0002ICBDIR0059  1658     03  FECCOR-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0060  1659     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005ICBDIR0061  1660     03  E-MAIL-DIRECCPIC X(40).FAC0002ICBDIR0062  1661     03  TELCEL-DIRECCPIC 9(12) COMP-3.FAC0002ICBDIR0063  1662     03  FECOTR-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0064  1663     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005ICBDIR0065  1664     03  FECULT-DIRECCPIC 9(06) COMP-3.FAC0002ICBDIR0066  1665***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SONVHF0003ICBDIR0067  1666***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003ICBDIR0068  1667***  COR-CORRESPONDENCIA)VHF0003ICBDIR0069  1668***     CER???-DIRECC:VHF0003ICBDIR0070  1669***0 - DIRECCION NO HA SIDO CERTIFICADAVHF0003ICBDIR0071  1670***1 - DIRECCION FUE CERTIFICADA EXITOSAMENTEVHF0003ICBDIR0072  1671***2 - DIRECCION CERTIFICADA SIN EXITOVHF0003ICBDIR0073  1672***     ADI???-DIRECC:VHF0003ICBDIR0074?   502     03  TIPO7-6-BDACSVPIC X(01). *> 5=T6,1=T7RMB0002BDACSV34503*    03  FILLERPIC X(50).STT0003BDACSV35
   504     03  CAMPOS-REGISTRADURIA-BDACSV.STT0003BDACSV36
   50505  DES-NOMBRE2-BDACSV    PIC X(12).STT0003BDACSV37
   50605  FECHA-EXPEDI-BDACSV   PIC 9(8).STT0003BDACSV38
   50705  DEP-EXP-BDACSVPIC 9(02).STT0003BDACSV39
   50805  MUNIC-EXP-BDACSVPIC 9(03).STT0003BDACSV40
   50905  ESTADO-VIG-BDACSV     PIC 9(02).STT0003BDACSV41
   51005  FECHA-NACIMNTO-BDACSV PIC 9(08).STT0003BDACSV42
   51105  IND-SEXO-BDACSVPIC X.STT0003BDACSV43
   51205  IND-ESTADO-BDACSV     PIC 9.STT0003BDACSV44
   51305  IND-CONSULADO-BDACSV  PIC 9(1).STT0003BDACSV45
   51405  COD-CONSULADO-BDACSV  PIC 9(3).STT0003BDACSV46
   515     03  FILLERPIC X(07).STT0003BDACSV47
   516*    03  FILLERPIC X(48).BDACSV48
   517BDACSV49
   518BDACSV50
   519BDACSV51
*  520     copy ICBDIR.FD.166
   521* ICBDIR-fd.v01.001.ICBDIR1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACATADO DE LAS  REPORTADASICBDIR2
   523* POR LOS DIFERENTES SUSCRIPTORESICBDIR3
   524*----------------------------------------------------------------*ICBDIR4
   525 FD  MAESTRO-DIRECC.ICBDIR5
   526 01  REG-DIRECC.ICBDIR6
   527     03  LLAVE-DIRECC.ICBDIR7
   52805  LLAVE-PRI-DIRECC.ICBDIR8
   52907  TIPO-ID-DIRECC    PIC 9(01).ICBDIR9
   53007  NUM-ID-DIRECC     PIC 9(11).ICBDIR10
   53105  LLAVE-ALT-DIRECC.ICBDIR11
   53207  COD-SUS-DIRECC    PIC 9(06).ICBDIR12
   53307  COD-CTA-DIRECC    PIC 9(02).ICBDIR13
   53407  NUM-CTA-DIRECC    PIC X(18).ICBDIR14
   535     03  CIURES-DIRECCPIC X(15).ICBDIR15
   536     03  DIRRES-DIRECCPIC X(30).ICBDIR16
   537     03  TELRES-DIRECCPIC 9(10) COMP-3.ICBDIR17
^L^M* Micro Focus Server ExpressV5.1 revision 000 10-Jun-14 14:33 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR.FD)
   538     03  CIULAB-DIRECCPIC X(15).ICBDIR18
   539     03  TELLAB-DIRECCPIC 9(10) COMP-3.ICBDIR19
   540     03  CIUCOR-DIRECCPIC X(15).ICBDIR20
   541     03  DIRCOR-DIRECCPIC X(30).ICBDIR21
   542     03  FECACT-DIRECCPIC 9(06) COMP-3.ICBDIR22
   544     03  FECAPE-DIRECCPIC 9(06) COMP-3.ICBDIR24
   545     03  FECCRE-DIRECCPIC 9(06) COMP-3.ICBDIR25
   546     03  DIRLAB-DIRECCPIC X(23).ICBDIR26
*  547     copy BDLCLI.FD.167
   548*BDLCLI-FD.v.00003BDLCLI1
   549*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR YBDLCLI2
   550*PRIVILEGIO ACTUALIZADOS.BDLCLI3
   551*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADOBDLCLI4
   552*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONESBDLCLI5 10030move cod-error to E-errores-reg(errIndex:2)1642
 10031add 3 to errIndex1643
 10032move E-descripcion(Ex) to E-errores-reg(errIndex:59)1644
 10033add 59 to errIndex1645
 10034     end-if1646
 100351647
 10036     exit program.1648
 100371649
 100381650
 10039 end program PONERR.1651
 100401652
 10041 end program CARGAJUR.1653
 100421654
 10043******************************************************************1655
 10044******************************************************************1656
 100451657
 100461658
* Micro Focus Server ExpressV5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*REF GNR-015065005AF
* Last message on page:  176
* Total Messages:    90
* Unrecoverable :     0Severe  :    90
* Errors:     0Warnings:     0
* Informational :     0Flags   :     0
* Data:     1429668     Code:0
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/icbdir* Archivos de base alterna
******************************************************************
copy BDACSV.FS.
copy ICBDIR.FS.
/*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.copy ICBDIR.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00./03  W-CONT-TIPO-5PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-6PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-7PIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-PJPIC 9(6) VALUE ZEROS.03  W-CONT-TIPO-5-REPPIC 9(6) VALUE ZEROS.01  SUSCRIPTOR-AUXPIC 9(06).
01  REG-LEIDOSPIC 9(07) VALUE ZEROS.
01  CONT-FALLECIDOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOSPIC 9(07) VALUE ZEROS.
01  REG-CORRECTOS-RPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-DIANPIC 9(07) VALUE ZEROS.
01  NO-COINCIDE-REGISPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-DIANPIC 9(07) VALUE ZEROS.
01  NO-EXISTE-REGISPIC 9(07) VALUE ZEROS.
01  SI-EXISTE-CSVPIC 9(07) VALUE ZEROS.
01  TIPO-ID-INVALIDOPIC 9(07) VALUE ZEROS.01 MAS-DATOS.
03 IPIC 9(02) VALUE ZERO.03 JPIC 9(02) VALUE ZERO.COPY  BDLDIR.WS.COPY ICBDIR0001.FD.******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************
copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con la la base BDIIALE de alertas online
******************************************************************
copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validación de nombres
******************************************************************
copy LEEMAESTROS.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************
copy ICFILE.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo
* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".?*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.copy ICBDIR.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.
COPY ICBDIR0001.FD.:w"CARGAJUR.CBL" 1657 lines, 69798 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi  CARGAJUR.lstcob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>ls -l  CARGAJUR*                                  /d/iccol/desarrollo/fuentes>vi  CARGAJUR.CBL.errdes-c-v CARGAJUR    
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430184     Code:       90643
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429424  Code:    106500  Literals:      2648  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
*    Causa del rechazo03 ERRS-causa-rechazopic x(61).******************************************************************
* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Archivos de base alterna
******************************************************************copy BDACSV.FD.COPY ICBDIR0001.FD.copy BDLCLI.FD.COPY ICBSUS.FD.COPY ICBCHK.FD.COPY ICBCRE.FD.COPY BDLSTDCIU.FD.COPY DIREST.FD.COPY BDLNEWDIRBOG.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Datos para la búsqueda en base alterna
01  W-DERECHOSPIC 9 value 0.
01  CODIGO-ERRORpic 99 value 00.$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1657 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           COPY ICBDIR0001.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificación contra las bases de

APPEND MODE      *    datos de validación de información BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cédula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4240-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1657 lines, 69798 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgdes-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430184     Code:       90643
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429424  Code:    106500  Literals:      2648  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              des-c-v CARGAJURfg              vi  CARGAJUR.lstcob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC lstpath/d/iccol/desarrollo/temporales -uv -g -P -o qqq -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430184     Code:       90667
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429424  Code:    118020  Literals:      2808  Dynamic:   2752512
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cob64 lstpath"/d/iccol/desarrollo/temporales" -uv>/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR                                  /d/iccol/desarrollo/fuentes>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430184     Code:       90643
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429424  Code:    106500  Literals:      2648  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>/ls ls -l  CARGAJUR*
-rw-rw-r--   1 icjlud   icdatacr   61357 Jun 10 11:50 CARGAJUR-OLD.CBL
-rw-rw-r--   1 icdgd    icdatacr   69798 Jun 10 15:00 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
-rw-rw-r--   1 icjlud   icdatacr  134772 Jun 10 15:01 CARGAJUR.gnt
-rw-rw-r--   1 icjlud   icdatacr  439808 Jun 10 15:01 CARGAJUR.idy
-rw-rw-r--   1 icjlud   icdatacr  108544 Jun 10 15:01 CARGAJUR.int
-rw-rw-r--   1 icjlud   icdatacr 1201632 Jun 10 15:01 CARGAJUR.lst
-rw-rw-r--   1 icjlud   icdatacr 1005531 Jun 10 15:01 CARGAJUR.s
/d/iccol/desarrollo/fuentes>clear
/d/iccol/desarrollo/fuentes>cat CARGAJUR.lst
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   1
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
* Options: int("CARGAJUR.int") anim csi verbose nolist sourceasm endp
*          list("CARGAJUR.lst")
     1$SET LIST SETTING LISTWIDTH"120"                                                                             1
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*          NOANIMPREP ANS85 NOAPOST NOAREACHECK ARITHMETIC"MF" ASSIGN"DYNAMIC"
*          NOASSIGN-PRINTER NOAUTOLOCK NOBELL BOUND NOBRIEF NOBS2000 BWZSTAR
*          NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS NOCALLRECOVERY CALLSORT
*          "EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE CHARSET"ASCII" CHECKDIV
*          "ANSI" NOCHECKREFMOD NOCICS CICS-CPY NOCICSOPTIMIZE NOCMPR2
*          NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR NOCOMP COMP-5"2" COMP-6
*          "2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE COPYEXT",cbl,cpy"
*          NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI CURRENCY-SIGN"36"
*          CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0" NODATA-CONTEXT DATE
*          DBCHECK DBCS"3" NODBCSSOSI DBSPACE DE-EDIT"2" DEFAULTBYTE"32"
*          NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF" NODIRECTIVES-IN-COMMENTS
*          NODOSVS NODPCINSUBSCRIPT DYNAM NOEARLY-RELEASE ECHO NOECHOALL
*          NOEDITOR ENSUITE"0" NOENTCOBOL ERRFORMAT"1" ERRLIST"EMBED" NOERRQ
*          FASTSORT FCD3 NOFCDREG NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG
*          NOFLAGAS NOFLAGCD NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD
*          NOFOLDCALLNAME NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING
*          NOHOSTARITHMETIC NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE
*          NOHOSTFD NOHOSTRW NOIBM-MS NOIBMCOMP IDXFORMAT"0" NOILGEN
*          IMPLICITSCOPE NOINDD INFORETURN"0" NOINITCALL INITPTR INT
*          "CARGAJUR.int" INTDATE"ANSI" INTLEVEL"5" IOCONV NOISO2002
*          NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK KEYCOMPRESS"0" NOLIBRARIAN
*          NOLINE-COUNT LIST LISTPATH"" LISTWIDTH"120" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD P64 NOPANVALET PERFORM-TYPE"MF" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY QUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF
*          NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS
*          NORM RTNCODE-SIZE"8" NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL
*          "RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII"
*          NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT"FIXED"
*          SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE TRUNC"ANSI" NOTRUNCCALLNAME NOTRUNCCOPY
*          TRUNCINC"10" UNICODE"NATIVE" VERBOSE NOVSC2 WARNING"1" NOWB NOWB2
*          NOWB3 WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.                                                                                    2
     3 PROGRAM-ID.    CARGAJUR.                                                                                    3
     4******************************************************************                                           4
     5* Actualizacion del archivo de alertas con los datos provistos                                               5
     6* por Jurad                                                                                                  6
     7* Procesa el archivo JURAD. Controla cada registro: si es OK usa                                             7
     8* los datos para actualizar BDIIALE, si tiene defecto lo graba en                                            8
     9* el archivo ERRS.                                                                                           9
    10******************************************************************                                          10
    11 AUTHOR.        Globant JL.                                                                                 11
    12 DATE-WRITTEN.                                                                                              12
    13 DATE-COMPILED. 10-Jun-14 15:01.                                                                            13
    14 CONFIGURATION section.                                                                                     14
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   2
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
    15 SOURCE-COMPUTER. microfocus.                                                                               15
    16 OBJECT-COMPUTER. microfocus.                                                                               16
    17 INPUT-OUTPUT section.                                                                                      17
    18 FILE-CONTROL.                                                                                              18
    19                                                                                                            19
    20******************************************************************                                          20
    21******************************************************************                                          21
    22 select JURAD assign to P-file-path                                                                         22
    23     organization is line sequential                                                                        23
    24     file status is JURAD-fs.                                                                               24
    25                                                                                                            25
    26******************************************************************                                          26
    27******************************************************************                                          27
    28 select ERRS assign to ERRS-file-name                                                                       28
    29     organization is line sequential                                                                        29
    30     file status is ERRS-fs.                                                                                30
    31                                                                                                            31
    32******************************************************************                                          32
    33******************************************************************                                          33
*   34     copy BDIIREGI.FS.                                                                                      34
    35* BDIIREGI.v.03.0001                                                                          BDIIREGI       1
    36*===============================================================                              BDIIREGI       2
    37* ESTRUCTURA DEL ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL                              BDIIREGI       3
    38*===============================================================                              BDIIREGI       4
    39 $SET IDXFORMAT"8"                                                                            BDIIREGI       5
    40                                                                                              BDIIREGI       6
    41$SET CONSTANT SW-STATUS-BDIIREGI"NO"                                                          BDIIREGI       7
    42     SELECT BDIIREGI                                                                          BDIIREGI       8
    43            ASSIGN TO DISK TITLE-BDIIREGI                                                     BDIIREGI       9
    44            ORGANIZATION IS INDEXED                                                           BDIIREGI      10
    45            ACCESS MODE IS DYNAMIC                                                            BDIIREGI      11
    46            RECORD KEY IS LLAVE-BDIIREGI                                                      BDIIREGI      12
    47$IF SW-STATUS-BDIIREGI = "NO"                                                                 BDIIREGI      13
    48$DISPLAY ".............COMPILANDO BDIIREGI SIN STATUS.........."                              BDIIREGI      14
    49$ELSE                                                                                         BDIIREGI      15
    50$DISPLAY ".............COMPILANDO BDIIREGI CON STATUS.........."                              BDIIREGI      16
    51X           FILE STATUS IS COD-RETORNO-BDIIREGI                                               BDIIREGI      17
    52$END                                                                                          BDIIREGI      18
    53            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          BDIIREGI      19
    54                                                                                              BDIIREGI      20
    55$SET IDXFORMAT"0"                                                                             BDIIREGI      21
    56                                                                                                            35
    57******************************************************************                                          36
    58******************************************************************                                          37
*   59     copy BDIIDIAN.FS.                                                                                      38
    60* BDIIDIAN.v.03.0001                                                                          BDIIDIAN       1
    61*==================================================================                           BDIIDIAN       2
    62* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADAS                           BDIIDIAN       3
    63* POR LA DIAN                                                                                 BDIIDIAN       4
    64*==================================================================                           BDIIDIAN       5
    65$SET CONSTANT SW-STATUS-BDIIDIAN"NO"                                                          BDIIDIAN       6
    66     SELECT BDIIDIAN ASSIGN TO DISK TITLE-BDIIDIAN                                            BDIIDIAN       7
    67            ORGANIZATION IS INDEXED                                                           BDIIDIAN       8
    68            ACCESS MODE  IS DYNAMIC                                                           BDIIDIAN       9
    69            RECORD KEY   IS LLAVE-BDIIDIAN                                                    BDIIDIAN      10
    70$IF SW-STATUS-BDIIDIAN = "NO"                                                                 BDIIDIAN      11
    71$DISPLAY ".............COMPILANDO BDIIDIAN SIN STATUS.........."                              BDIIDIAN      12
    72$ELSE                                                                                         BDIIDIAN      13
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   3
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/BDIIDIAN.F
    73$DISPLAY ".............COMPILANDO BDIIDIAN CON STATUS.........."                              BDIIDIAN      14
    74X           FILE STATUS IS COD-RETORNO-BDIIDIAN                                               BDIIDIAN      15
    75$END                                                                                          BDIIDIAN      16
    76            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          BDIIDIAN      17
    77                                                                                                            39
    78******************************************************************                                          40
    79******************************************************************                                          41
*   80     copy BDIIDAS.FS.                                                                                       42
    81* BDIIDAS.v.03.0001                                                                           BDIIDAS        1
    82*=====================================================================                        BDIIDAS        2
    83* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA, PROPORCIONADAS POR EL DAS                        BDIIDAS        3
    84*=====================================================================                        BDIIDAS        4
    85$SET CONSTANT SW-STATUS-BDIIDAS"NO"                                                           BDIIDAS        5
    86     SELECT BDIIDAS ASSIGN TO DISK TITLE-BDIIDAS                                              BDIIDAS        6
    87           ORGANIZATION IS INDEXED                                                            BDIIDAS        7
    88           ACCESS MODE IS DYNAMIC                                                             BDIIDAS        8
    89           RECORD KEY IS LLAVE-BDIIDAS                                                        BDIIDAS        9
    90$IF SW-STATUS-BDIIDAS = "NO"                                                                  BDIIDAS       10
    91$DISPLAY ".............COMPILANDO BDIIDAS SIN STATUS.........."                               BDIIDAS       11
    92$ELSE                                                                                         BDIIDAS       12
    93$DISPLAY ".............COMPILANDO BDIIDAS CON STATUS.........."                               BDIIDAS       13
    94X           FILE STATUS IS COD-RETORNO-BDIIDAS                                                BDIIDAS       14
    95$END                                                                                          BDIIDAS       15
    96            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          BDIIDAS       16
    97                                                                                                            43
    98******************************************************************                                          44
    99******************************************************************                                          45
*  100     copy BDIIALE.FS replacing == on record.== by == on record                                              46
*  101        file status is EST-BDIIALE.==.                                                                      47
   102* BDIIALE-FS.v01.0001                                                                         BDIIALE        1
   103* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTOTRES                                             BDIIALE        2
   104                                                                                              BDIIALE        3
   105$SET CONSTANT SW-STATUS-BDIIALE"NO"                                                           BDIIALE        4
   106     SELECT BDIIALE                                                                           BDIIALE        6
   107            ASSIGN TO DISK MAES-BDIIALE-TITLE                                                 BDIIALE        7
   108            ORGANIZATION IS INDEXED                                                           BDIIALE        8
   109            ACCESS MODE IS DYNAMIC                                                            BDIIALE        9
   110            RECORD KEY IS LLAVE-BDIIALE                                                       BDIIALE       10
   111$IF SW-STATUS-BDIIALE = "NO"                                                                  BDIIALE       10
   112$DISPLAY ".............COMPILANDO BDIIALE SIN STATUS.........."                               BDIIALE       11
   113$ELSE                                                                                         BDIIALE       13
   114$DISPLAY ".............COMPILANDO BDIIALE CON STATUS.........."                               BDIIALE       13
   115X           FILE STATUS IS EST-BDIIALE                                                        BDIIALE       14
   116$END                                                                                          BDIIALE       15
   117            LOCK MODE IS MANUAL WITH LOCK            on record                                BDIIALE       16
   118        file status is EST-BDIIALE.                                                           BDIIALE       17
   119                                                                                                            48
   120******************************************************************                                          49
   121* Archivos de base alterna                                                                                  50
   122******************************************************************                                          51
*  123     copy BDACSV.FS.                                                                                        52
   124* BDACSV-FS.V.0001                                                                            BDACSV         1
   125* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE                                  BDACSV         2
   126* DATOS OFICIALES DE REGIS, DIAN Y DAS                                                        BDACSV         3
   127     SELECT BDACSV                                                                            BDACSV         4
   128            ASSIGN TO DISK "$DATABASE/BDACSV"                                                 BDACSV         5
   129            ORGANIZATION IS INDEXED                                                           BDACSV         6
   130            ACCESS MODE IS DYNAMIC                                                            BDACSV         7
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   4
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/BDACSV.FS)
   131            RECORD KEY IS LLAVE-BDACSV                                                        BDACSV         8
   132            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          BDACSV         9
*  133     copy ICBDIR.FS.                                                                                        53
   134* ICBDIR-fs.v01.002                                                                           ICBDIR         1
   135* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA                                ICBDIR         2
   136* POR LOS DIFERENTES SUSCRIPTORES                                                             ICBDIR         3
   137 $SET IDXFORMAT"8"                                                                            ICBDIR         4
   138                                                                                              ICBDIR         5
   139$SET CONSTANT SW-STATUS-ICBDIR"NO"                                                            ICBDIR         6
   140     SELECT MAESTRO-DIRECC                                                                    ICBDIR         7
   141            ASSIGN TO DISK MAES-DIRECC-TITLE                                                  ICBDIR         8
   142            ORGANIZATION IS INDEXED                                                           ICBDIR         9
   143            ACCESS MODE IS DYNAMIC                                                            ICBDIR        10
   144            RECORD KEY IS LLAVE-DIRECC                                                        ICBDIR        11
   145$IF SW-STATUS-ICBDIR = "NO"                                                                   ICBDIR        12
   146$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."                                ICBDIR        13
   147$ELSE                                                                                         ICBDIR        14
   148$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."                                ICBDIR        15
   149X           FILE STATUS IS EST-ICBDIR                                                         ICBDIR        16
   150$END                                                                                          ICBDIR        17
   151            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          ICBDIR        18
   152 $SET IDXFORMAT"0"                                                                            ICBDIR        19
*  153     copy BDLCLI.FS.                                                                                        54
   154*BDLCLI-FS.v.0001                                                                             BDLCLI         1
   155*ARCHIVO DE  CLIENTES DE BASE DE DATOS DE LOCALIZACION CON INDICADOR Y                        BDLCLI         2
   156*PRIVILEGIO ACTUALIZADO.                                                                      BDLCLI         3
   157    SELECT BDLCLI                                                                             BDLCLI         4
   158            ASSIGN TO DISK BDLCLI-TITLE                                                       BDLCLI         5
   159            ORGANIZATION IS INDEXED                                                           BDLCLI         6
   160            ACCESS MODE IS DYNAMIC                                                            BDLCLI         7
   161            RECORD KEY IS LLAVE-BDLCLI                                                        BDLCLI         8
   162            LOCK MODE IS AUTOMATIC.                                                           BDLCLI         9
*  163     COPY ICBSUS.FS.                                                                                        55
   165$SET CONSTANT SW-STATUS-ICBSUS"NO"                                                            ICBSUS         2
   166     SELECT SUSCRIPTOR                                                                        ICBSUS         3
   167            ASSIGN TO DISK SUSCRIPTOR-TITLE                                                   ICBSUS         4
   168            ORGANIZATION IS INDEXED                                                           ICBSUS         5
   169            ACCESS MODE IS DYNAMIC                                                            ICBSUS         6
   170            RECORD KEY IS LLAVE-SUSCRIP                                                       ICBSUS         7
   171$IF SW-STATUS-ICBSUS = "NO"                                                                   ICBSUS         8
   172$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."                                ICBSUS         9
   173$ELSE                                                                                         ICBSUS        10
   174$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."                                ICBSUS        11
   175X           FILE STATUS IS COD-RETORNO-ICBSUS                                                 ICBSUS        12
   176$END                                                                                          ICBSUS        13
   177            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          ICBSUS        14
   178                                                                                              ICBSUS        15
*  179     COPY ICBCHK.FS.                                                                                        56
   180* EST027.v.02.002                                                                             ICBCHK         1
   181* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO                             ICBCHK         2
   182* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                                                  ICBCHK         3
   183                                                                                              ICBCHK         4
   184     SELECT MAESTRO-CHECK                                                                     ICBCHK         5
   185            ASSIGN TO DISK MAES-CHECK-TITLE                                                   ICBCHK         6
   186            ORGANIZATION IS INDEXED                                                           ICBCHK         7
   187            ACCESS MODE IS DYNAMIC                                                            ICBCHK         8
   188            RECORD KEY IS LLAVE-MAES-CHECK                                                    ICBCHK         9
   189*           ALTERNATE RECORD KEY IS LLAVE-MAES-CHECK-ALT                                      ICBCHK        10
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   5
* /d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICBCHK.FS)
   190            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          ICBCHK        11
*  191     COPY ICBCRE.FS.                                                                                        57
   192* EST029.v.02.003                                                                             ICBCRE         1
   193* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS                          ICBCRE         2
   194* POR LOS DIFERENTES SUSCRIPTORES                                                             ICBCRE         3
   195 $SET IDXFORMAT"8"                                                                            ICBCRE         4
   196                                                                                              ICBCRE         5
   197     SELECT MAESTRO-CREDIT                                                                    ICBCRE         6
   198            ASSIGN TO DISK MAES-CREDIT-TITLE                                                  ICBCRE         7
   199            ORGANIZATION IS INDEXED                                                           ICBCRE         8
   200            ACCESS MODE IS DYNAMIC                                                            ICBCRE         9
   201            RECORD KEY IS LLAVE-MAES-CREDIT                                                   ICBCRE        10
   202*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT                                     ICBCRE        11
   203            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          ICBCRE        12
   204                                                                                              ICBCRE        13
   205 $SET IDXFORMAT"0"                                                                            ICBCRE        14
*  206     COPY BDLSTDCIU.FS.                                                                                     58
   207* BDLSTDCIU-FS.v.0001                                                                         BDLSTDCI       1
   208******************************************************************                            BDLSTDCI       2
   209* DEFINICION DE ARCHIVO DE ACEPCIONES DE CIUDADES.               *                            BDLSTDCI       3
   210******************************************************************                            BDLSTDCI       4
   211     SELECT BDLSTDCIU                                                                         BDLSTDCI       5
   212            ASSIGN TO DISK TITLE-BDLSTDCIU                                                    BDLSTDCI       6
   213            ORGANIZATION IS INDEXED                                                           BDLSTDCI       7
   214            ACCESS MODE IS DYNAMIC                                                            BDLSTDCI       8
   215            RECORD KEY IS LLAVE-BDLSTDCIU                                                     BDLSTDCI       9
   216            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          BDLSTDCI      10
*  217     COPY DIREST.FS.                                                                                        59
   218*DIREST-FS.v.0001                                                                             DIREST         1
   219******************************************************************                            DIREST         2
   220* ARCHIVO DE ESTANDARIZACION DE DIRECCIONES                      *                            DIREST         3
   221******************************************************************                            DIREST         4
   222     SELECT DIREST ASSIGN TO DISK TITLE-DIREST                                                DIREST         5
   223            ORGANIZATION  IS LINE SEQUENTIAL.                                                 DIREST         6
*  224     COPY BDLNEWDIRBOG.FS.                                                                                  60
   225* BDLNEWDIRBOG-FS.0002                                                                        BDLNEWDI       1
   226* ARCHIVO DE NUEVAS DIRECCIONES DE BOGOTA                                                     BDLNEWDI       2
   227************************************************************************                      BDLNEWDI       3
   228* RMB0002    * DIRB02  SE CAMBIA AL DIRECTORIO $DIRECCIONES EL ARCHIVO                        BDLNEWDI       4
   229* R.MARTINEZ *         DE NUEVA NOMENCLATURA                                                  BDLNEWDI       5
   230* 26/FEB/2007*                                                                                BDLNEWDI       6
   231************************************************************************                      BDLNEWDI       7
   232     SELECT BDLNEWDIRBOG                                                                      BDLNEWDI       8
   233            ASSIGN TO DISK "$DIRECCIONES/BDLNEWDIRBOG"            RMB0002                     BDLNEWDI       9
   234            ORGANIZATION IS INDEXED                                                           BDLNEWDI      10
   235            ACCESS MODE IS DYNAMIC                                                            BDLNEWDI      11
   236            RECORD KEY IS LLAVE-BDLNEWDIRBOG                                                  BDLNEWDI      12
   237            LOCK MODE IS MANUAL WITH LOCK ON RECORD.                                          BDLNEWDI      13
   238                                                                                                            61
   239******************************************************************                                          62
   240******************************************************************                                          63
   241 DATA DIVISION.                                                                                             64
   242 FILE section.                                                                                              65
   243                                                                                                            66
   244******************************************************************                                          67
   245* Archivo de entrada con los datos de demandas y embargos de JURAD                                          68
   246******************************************************************                                          69
   247 FD JURAD.                                                                                                  70
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   6
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/BDLNEWDIRB
   248 01  JURAD-reg.                                                                                             71
   249* Registros de movimientos I, M, E                                                                          72
   250*    Tipo de Novedad {I, M, E} Inser/Modif/Elim                                                             73
   251     03 JURAD-tipo-novedad        pic x.                                                                    74
   252*    Tipo de identificacion Numero {1, 2, 3, 4}                                                             75
   253     03 JURAD-id-tipo             pic x.                                                                    76
   254*    Numero de identificacion                                                                               77
   255     03 JURAD-id-numeroX          pic x(11).                                                                78
   256     03 JURAD-id-numero           redefines JURAD-id-numeroX                                                79
   257                                  pic 9(11).                                                                80
   258*    Nombres y Apellidos                                                                                    81
   259     03 JURAD-nombre              pic x(45).                                                                82
   260*    Numero de demandas vigentes                                                                            83
   261     03 JURAD-demandas-vigentes   pic 999.                                                                  84
   262*    Numero de demandas terminadas                                                                          85
   263     03 JURAD-demandas-terminadas pic 999.                                                                  86
   264*    Fecha ultima demanda vigente YYYYMMDD                                                                  87
   265     03 JURAD-demandas-fecha-ultima pic x(8).                                                               88
   266*    Numero de embargos vigentes                                                                            89
   267     03 JURAD-embargos-vigentes   pic 999.                                                                  90
   268*    Numero de embargos terminados                                                                          91
   269     03 JURAD-embargos-terminados pic 999.                                                                  92
   270*    Fecha ultimo embargo vigente YYYYMMDD                                                                  93
   271     03 JURAD-embargos-fecha-ultimo pic x(8).                                                               94
   272                                                                                                            95
   273 01  JURADT-reg.                                                                                            96
   274* Registro de totales de control T                                                                          97
   275*    Tipo de Novedad = "T"                                                                                  98
   276     03 JURADT-tipo-novedad       pic x.                                                                    99
   277     03                           pic x.                                                                   100
   278*    Cantidad de registros                                                                                 101
   279     03 JURADT-registros          pic 9(11).                                                               102
   280     03                           pic x.                                                                   103
   281* $$$$ El formato a continuación no está confirmedo, no se usa                                             104
   282*    Total numero de demandas vigentes                                                                     105
   283     03 JURADT-demandas-vigentes  pic 9(7).                                                                106
   284     03                           pic x.                                                                   107
   285*    Total numero de demandas terminadas                                                                   108
   286     03 JURADT-demandas-terminadas pic 9(7).                                                               109
   287     03                           pic x.                                                                   110
   288*    Total numero de embargos vigentes                                                                     111
   289     03 JURADT-embargos-vigentes  pic 9(7).                                                                112
   290     03                           pic x.                                                                   113
   291*    Total numero de embargos terminados                                                                   114
   292     03 JURADT-embargos-terminados pic 9(7).                                                               115
   293     03                           pic x(41).                                                               116
   294                                                                                                           117
   295******************************************************************                                         118
   296* Archivo de salida con los registros defectuosos del arch JURAD                                           119
   297******************************************************************                                         120
   298 FD ERRS.                                                                                                  121
   299 01  ERRS-reg.                                                                                             122
   300*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales                                                 123
   301     03 ERRS-tipo-novedad         pic x.                                                                   124
   302*    Tipo de identificacion Numero {1, 2, 3, 4}                                                            125
   303     03 ERRS-id-tipo              pic x.                                                                   126
   304*    Numero de identificacion                                                                              127
   305     03 ERRS-id-numero            pic x(11).                                                               128
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   7
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/BDLNEWDIRB
   306*    Nombres y Apellidos                                                                                   129
   307     03 ERRS-nombre               pic x(45).                                                               130
   308*    Numero de demandas vigentes                                                                           131
   309     03 ERRS-demandas-vigentes    pic 999.                                                                 132
   310*    Numero de demandas terminadas                                                                         133
   311     03 ERRS-demandas-terminadas  pic 999.                                                                 134
   312*    Fecha ultima demanda vigente YYMMDD                                                                   135
   313     03 ERRS-demandas-fecha-ultima pic x(8).                                                               136
   314*    Numero de embargos vigentes                                                                           137
   315     03 ERRS-embargos-vigentes    pic 999.                                                                 138
   316*    Numero de embargos terminados                                                                         139
   317     03 ERRS-embargos-terminados  pic 999.                                                                 140
   318*    Fecha ultimo embargo vigente YYMMDD                                                                   141
   319     03 ERRS-embargos-fecha-ultimo pic x(8).                                                               142
   320*    Causa del rechazo                                                                                     143
   321     03 ERRS-causa-rechazo        pic x(61).                                                               144
   322                                                                                                           145
   323******************************************************************                                         146
   324* Contiene los ids y nombres de personas                                                                   147
   325******************************************************************                                         148
*  326 copy BDIIREGI.FD.                                                                                         149
   327* BDIIREGI.v.03.0006                                                                          BDIIREGI       1
   328*=================================================================                            BDIIREGI       2
   329* ESTRUCTURA DEL ARCHIVO ENTREGADO POR LA REGISTRADURIA NACIONAL                              BDIIREGI       3
   330*=================================================================                            BDIIREGI       4
   331* GJC0002   * BLQTUT * CAMPO PARA MARCAR LAS IDENDIFICACIONES                                 BDIIREGI       5
   332* G.JIMENEZ * QUE HAN SIDO BLOQUEADAS POR TUTELAS PERDIDAS                                    BDIIREGI       6
   333* SEPT.18/03*                                                                                 BDIIREGI       7
   334******************************************************************                            BDIIREGI       8
   335* FAC0003   * FECMOD * FECHA DE CREACION Y DE MODIFICACION DE LAS                             BDIIREGI       9
   336* F.CUADROS * IDENTIFICACIONES. ADEMAS INCLUSION DE INDICADOR CON                             BDIIREGI      10
   337* SEPT.16/05* LA FUENTE: A-ARCHIVO REGIS, C-COMUNICACION ESCRITA                              BDIIREGI      11
   338*           * REGISTRADURIA, S-SOLICITUD INTERNA CAS.                                         BDIIREGI      12
   339******************************************************************                            BDIIREGI      13
   340* GJC0004   * INDMOD * SE CREA CAMPO PARA DEJAR INDICADOR DE MOFI-                            BDIIREGI      14
   341* F.CUADROS * FICACIONES, QUEDA IGUAL QUE EN EL OTRO INDICADOR                                BDIIREGI      15
   342* ENERO/2007* LA FUENTE: A-ARCHIVO REGIS, C-COMUNICACION ESCRITA                              BDIIREGI      16
   343*           * REGISTRADURIA, S-SOLICITUD INTERNA CAS T-TERCERO.                               BDIIREGI      17
   344******************************************************************                            BDIIREGI      18
   345* CAV0005   *CONSUL * SE ADICIONAN LOS CAMPOS PARA IDENTIFICAR                                BDIIREGI      19
   346* C.VELASCO *QUE LA CEDULA CORRESPONDE A UN CONSULADO Y EL CODIGO                             BDIIREGI      20
   347* ABRIL/2007*DEL CONSULADO ,ARCHIVO CONSULADOS.DAT, PAIS Y CIUDAD                             BDIIREGI      21
   348******************************************************************                            BDIIREGI      22
   349* CAV0006   *INDE01 * SE ADICIONAN LOS CAMPOS PARA IDENTIFICAR                                BDIIREGI      23
   350* C.VELASCO *         SI EL REGISTRO CORRESPONDE A INDEPENDIENTE                              BDIIREGI      24
   351* SEPTI/2013*         DE CAMARA C O BURO. (INDEPTES CON TIPO ID 9)                            BDIIREGI      25
   352*                     SE MARCA CAMPO IND-CREACION-BDIIREGI = "I"                              BDIIREGI      26
   353******************************************************************                            BDIIREGI      27
   354 FD  BDIIREGI.                                                                                BDIIREGI      28
   355 01  REG-BDIIREGI.                                                                            BDIIREGI      29
   356     03  LLAVE-BDIIREGI          PIC 9(12).                                                   BDIIREGI      30
   357     03  LLAVE-BDIIREGI-R        REDEFINES LLAVE-BDIIREGI.                                    BDIIREGI      31
   358         05  TIPO-ID-BDIIREGI    PIC 9.                                                       BDIIREGI      32
   359         05  CEDULA-BDIIREGI     PIC 9(11).                                                   BDIIREGI      33
   360     03  DES-NOMBRE1-BDIIREGI    PIC X(12).                                                   BDIIREGI      34
   361     03  DES-NOMBRE2-BDIIREGI    PIC X(12).                                                   BDIIREGI      35
   362     03  APELLIDO1-BDIIREGI      PIC X(16).                                                   BDIIREGI      36
   363     03  APELLIDO2-BDIIREGI      PIC X(16).                                                   BDIIREGI      37
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   8
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIREGI.F
   364     03  ESTADO-CIVIL-BDIIREGI   PIC 9.                                                       BDIIREGI      38
   365     03  FECHA-EXPEDI-BDIIREGI.                                                               BDIIREGI      39
   366         05  SIGLO-EXP-BDIIREGI  PIC 9(2).                                                    BDIIREGI      40
   367         05  FECHA-EXP-BDIIREGI  PIC 9(6).                                                    BDIIREGI      41
   368     03  INF-NUMERICA-BDIIREGI   PIC 9(7).                                                    BDIIREGI      42
   369     03  INF-NUMERICA-BDIIREGI-R REDEFINES INF-NUMERICA-BDIIREGI.                             BDIIREGI      43
   370         05 DEP-EXP-BDIIREGI     PIC 99.                                                      BDIIREGI      44
   371         05 MUNIC-EXP-BDIIREGI   PIC 999.                                                     BDIIREGI      45
   372         05 ESTADO-VIG-BDIIREGI  PIC 99.                                                      BDIIREGI      46
   373     03  FECHA-NACIMNTO-BDIIREGI.                                                             BDIIREGI      47
   374         05  SIGLO-NAC-BDIIREGI  PIC 9(2).                                                    BDIIREGI      48
   375         05  FECHA-NAC-BDIIREGI  PIC 9(6).                                                    BDIIREGI      49
   376     03  FECHA-EDICTO-BDIIREGI.                                                               BDIIREGI      50
   377         05  SIGLO-EDI-BDIIREGI  PIC 9(2).                                                    BDIIREGI      51
   378         05  FECHA-EDI-BDIIREGI  PIC 9(6).                                                    BDIIREGI      52
   379     03  IND-SEXO-BDIIREGI       PIC X.                                                       BDIIREGI      53
   380     03  IND-ESTADO-BDIIREGI     PIC 9.                                                       BDIIREGI      54
   381     03  NUM-RESOLUC-BDIIREGI    PIC 9(4).                                                    BDIIREGI      55
   382     03  ANO-RESOLUC-BDIIREGI    PIC 9(2).                                                    BDIIREGI      56
   383     03  BLOQUEO-TUTELA-BDIIREGI PIC X(1).                        GJC0002                     BDIIREGI      57
   384     03  FECHA-CREAC-BDIIREGI    PIC 9(8).                        FAC0003                     BDIIREGI      58
   385     03  FECHA-MODIF-BDIIREGI    PIC 9(8).                        FAC0003                     BDIIREGI      59
   386     03  IND-MODIF-BDIIREGI      PIC X(1).                        FAC0003                     BDIIREGI      60
   387     03  IND-CREACION-BDIIREGI REDEFINES                          GJC0004                     BDIIREGI      61
   388              IND-MODIF-BDIIREGI PIC X(1).                        GJC0004                     BDIIREGI      62
   389     03  IND-CAMBIO-BDIIREGI     PIC X(1).                        GJC0004                     BDIIREGI      63
   390     03  IND-CONSULADO-BDIIREGI  PIC 9(1).                        CAV0005                     BDIIREGI      64
   391     03  COD-CONSULADO-BDIIREGI  PIC 9(3).                        CAV0005                     BDIIREGI      65
   392     03  ES-IND-CAMARA-BDIIREGI  PIC 9(1).                        CAV0006                     BDIIREGI      66
   393     03  ES-IND-BURO-BDIIREGI    PIC 9(1).                        CAV0006                     BDIIREGI      67
   394     03  FILLER-BDIIREGI         PIC X(27).                       CAV0006                     BDIIREGI      68
   395*----------------------------------------------------------------*                            BDIIREGI      69
   396                                                                                                           150
   397******************************************************************                                         151
   398* Maestro de personas juridicas nacionales y extranjeras reportada                                         152
   399* por la DIAN                                                                                              153
   400******************************************************************                                         154
*  401 copy BDIIDIAN.FD.                                                                                         155
   402* BDIIDIAN.v.03.0004                                                                          BDIIDIAN       1
   403*==================================================================                           BDIIDIAN       2
   404* MAESTRO DE PERSONAS JURIDICAS NACIONALES Y EXTRANJERAS REPORTADAS                           BDIIDIAN       3
   405* POR LA DIAN                                                                                 BDIIDIAN       4
   406*==================================================================                           BDIIDIAN       5
   407* FAC0002 * INCIIU* INCLUSION DE CODIGO DE ACTIVIDAD ECONOMICA- CIIU                          BDIIDIAN       6
   408* JUL.17/2003 * Y FECHA DE INSCRIPCION                                                        BDIIDIAN       7
   409*==================================================================                           BDIIDIAN       8
   410* CAV0003 * INDMOD* INCLUSION DE FECHA-CREACION,FECHA-MODIFCACION E                           BDIIDIAN       9
   411* C. VELASCO  * INDICADOR MODIFICACION: A-ARCHIVO DIAN,                                       BDIIDIAN      10
   412* OCT/25/2007 * C-COMUNICACION DIAN, S-SOLICTUD CAS.                                          BDIIDIAN      11
   413*==================================================================                           BDIIDIAN      12
   414* RMB0004     * INDE01* INCLUSION DE MARCAS PARA :                                            BDIIDIAN      13
   415* R.MARTINEZ  *       A)  ES CLIENTE DE EXPERIAN-DATACREDITO                                  BDIIDIAN      14
   416* SEP/20/2013 *       B)  CLIENTE QUE VERA A LOS INDEPENDIENTES                               BDIIDIAN      15
   417* C.VELASCO.  *       SE CREA CAMPO FECHA-MODIF-INDE-BDIIDIAN                                 BDIIDIAN      16
   418*==================================================================                           BDIIDIAN      17
   419 FD  BDIIDIAN.                                                                                BDIIDIAN      18
   420 01  REG-BDIIDIAN.                                                                            BDIIDIAN      19
   421     03 LLAVE-BDIIDIAN.                                                                       BDIIDIAN      20
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page   9
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIDIAN.F
   422        05 NITS-BDIIDIAN            PIC X(11).                                                BDIIDIAN      21
   423        05 NITS-R-BDIIDIAN REDEFINES NITS-BDIIDIAN                                            BDIIDIAN      22
   424                                    PIC 9(11).                                                BDIIDIAN      23
   425     03 DIGITO-CONTROL-BDIIDIAN     PIC X(01).                                                BDIIDIAN      24
   426     03 DESCRIPCION1-BDIIDIAN       PIC X(80).                                                BDIIDIAN      25
   427     03 DESCRIPCION1-BDIIDIAN-R REDEFINES DESCRIPCION1-BDIIDIAN.                              BDIIDIAN      26
   428        05 DESCRIPCION-BDIIDIAN     PIC X(79).                                                BDIIDIAN      27
   429        05 ESTADO-BDIIDIAN          PIC 9.                                                    BDIIDIAN      28
   430     03 COD-CIIU-BDIIDIAN           PIC 9(4).                     FAC0002                     BDIIDIAN      29
   431     03 FEC-INSCRIP-BDIIDIAN        PIC 9(8).                     FAC0002                     BDIIDIAN      30
   432     03 FECHA-CREAC-BDIIDIAN        PIC 9(8).                     CAV0003                     BDIIDIAN      31
   433     03 FECHA-MODIF-BDIIDIAN        PIC 9(8).                     CAV0003                     BDIIDIAN      32
   434     03 IND-MODIF-BDIIDIAN          PIC X(1).                     CAV0003                     BDIIDIAN      33
   435     03 ES-CLIENTE-DATACR-BDIIDIAN  PIC X(1). *> S,N              RMB0004                     BDIIDIAN      34
   436     03 VE-INDEPENDIENTES-BDIIDIAN  PIC X(1). *> S,N              RMB0004                     BDIIDIAN      35
   437     03 FECHA-MODIF-INDE-BDIIDIAN   PIC 9(04). *> AAMM            CAV0004                     BDIIDIAN      36
   438*    03 FILLER-BDIIDIAN             PIC X(19).                    RMB0004                     BDIIDIAN      37
   439     03 FILLER-BDIIDIAN             PIC X(13).                    CAV0004                     BDIIDIAN      38
   440                                                                                                           156
   441******************************************************************                                         157
   442* Archivo maestro de cedulas de extranjeria suministrado por DAS                                           158
   443******************************************************************                                         159
*  444 copy BDIIDAS.FD.                                                                                          160
   445* BDIIDAS.v.03.0002                                                                           BDIIDAS        1
   446*====================================================================                         BDIIDAS        2
   447* ARCHIVO MAESTRO DE CEDULAS DE EXTRANJERIA SUMINISTRADAS POR EL DAS                          BDIIDAS        3
   448*====================================================================                         BDIIDAS        4
   449* CAV0002 * INDMOD* INCLUSION DE FECHA-CREACION FECHA MODIFCACION E                           BDIIDAS        5
   450* C. VELASCO  * INDICADOR MODIFICACION, A-ARCHIVO DAS,                                        BDIIDAS        6
   451* OCT/25/2007 * C-COMUNICACION DAS, S-SOLICTUD CAS.                                           BDIIDAS        7
   452*==================================================================                           BDIIDAS        8
   453 FD  BDIIDAS.                                                                                 BDIIDAS        9
   454 01  REG-BDIIDAS.                                                                             BDIIDAS       10
   455     03 LLAVE-BDIIDAS.                                                                        BDIIDAS       11
   456        05 TIPO-ID-BDIIDAS           PIC 9.                                                   BDIIDAS       12
   457        05 NUM-ID-BDIIDAS            PIC 9(11).                                               BDIIDAS       13
   458     03 NACIO-BDIIDAS                PIC X(15).                                               BDIIDAS       14
   459     03 NOMBRE-BDIIDAS               PIC X(45).                                               BDIIDAS       15
   460     03 FECHA-CREAC-BDIIDAS          PIC 9(8).                    CAV0002                     BDIIDAS       16
   461     03 FECHA-MODIF-BDIIDAS          PIC 9(8).                    CAV0002                     BDIIDAS       17
   462     03 IND-MODIF-BDIIDAS            PIC X(1).                    CAV0002                     BDIIDAS       18
   463     03 FILLER-BDIIDAS               PIC X(31).                   CAV0002                     BDIIDAS       19
   464                                                                                                           161
   465******************************************************************                                         162
   466* Archivos de base alterna                                                                                 163
   467******************************************************************                                         164
*  468     copy BDACSV.FD.                                                                                       165
   469* BDACSV-FD.v.0003                                                                            BDACSV         1
   470* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE                                  BDACSV         2
   471* DATOS OFICIALES DE REGIS, DIAN Y DAS                                                        BDACSV         3
   472******************************************************************                            BDACSV         4
   473* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO                                      BDACSV         5
   474* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O                              BDACSV         6
   475* R.MARTINEZ *          POR T7                                                                BDACSV         7
   476******************************************************************                            BDACSV         8
   477* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION                            BDACSV         9
   478* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE                                 BDACSV        10
   479* LUIS GOMEZ *          CONFIABLE                                                             BDACSV        11
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  10
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDACSV.FD)
   480******************************************************************                            BDACSV        12
   481 FD  BDACSV.                                                                                  BDACSV        13
   482 01  REG-BDACSV.                                                                              BDACSV        14
   483     03 LLAVE-BDACSV.                                                                         BDACSV        15
   484        05  TIPO-ID-BDACSV    PIC 9(01).                                                      BDACSV        16
   485        05  NUM-ID-BDACSV     PIC 9(15).                                                      BDACSV        17
   486        05  COD-SUS-BDACSV    PIC 9(06).                                                      BDACSV        18
   487        05  COD-CTA-BDACSV    PIC 9(02).                                                      BDACSV        19
   488        05  NUM-CTA-BDACSV    PIC X(25).                                                      BDACSV        20
   489     03  NOMBRE-BDACSV        PIC X(45).                                                      BDACSV        21
   490     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003                     BDACSV        22
   491        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003                     BDACSV        23
   492        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003                     BDACSV        24
   493        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003                     BDACSV        25
   494     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003                     BDACSV        26
   495     03  FECHA-CREA-BDACSV       PIC 9(08).                                                   BDACSV        27
   496     03  NUM-PORTAF-BDACSV    PIC 9(02).                                                      BDACSV        28
   497     03  IND-NOMBRE-BDACSV    PIC 9(02).                                                      BDACSV        29
   498     03  MEJOR-PORTAF-BDACSV  PIC 9(02).                                                      BDACSV        30
   499     03  IND-ACTUALIZ-BDACSV  PIC 9(02).                                                      BDACSV        31
   500     03  FUENTE-REG-BDACSV    PIC 9(02).                                                      BDACSV        32
   501     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002                     BDACSV        33
   502     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002                     BDACSV        34
   503*    03  FILLER               PIC X(50).                          STT0003                     BDACSV        35
   504     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003                     BDACSV        36
   505         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003                     BDACSV        37
   506         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003                     BDACSV        38
   507         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003                     BDACSV        39
   508         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003                     BDACSV        40
   509         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003                     BDACSV        41
   510         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003                     BDACSV        42
   511         05  IND-SEXO-BDACSV       PIC X.                         STT0003                     BDACSV        43
   512         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003                     BDACSV        44
   513         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003                     BDACSV        45
   514         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003                     BDACSV        46
   515     03  FILLER                    PIC X(07).                     STT0003                     BDACSV        47
   516*    03  FILLER               PIC X(48).                                                      BDACSV        48
   517                                                                                              BDACSV        49
   518                                                                                              BDACSV        50
   519                                                                                              BDACSV        51
*  520     COPY ICBDIR0001.FD.                                                                                   166
   521* ICBDIR0001-FD.V01.007.                                                                      ICBDIR00       1
   522* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS                              ICBDIR00       2
   523* POR LOS DIFERENTES SUSCRIPTORES                                                             ICBDIR00       3
   524******************************************************************                            ICBDIR00       4
   525* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL                             ICBDIR00       5
   526* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE                            ICBDIR00       6
   527* FEB.15/2006  * DATACLIENTES.                                                                ICBDIR00       7
   528******************************************************************                            ICBDIR00       8
   529* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *                            ICBDIR00       9
   530* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *                            ICBDIR00      10
   531* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *                            ICBDIR00      11
   532* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *                            ICBDIR00      12
   533*              *          DIRECCION FUE GEOREFERENCIADA.         *                            ICBDIR00      13
   534******************************************************************                            ICBDIR00      14
   535* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *                            ICBDIR00      15
   536* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *                            ICBDIR00      16
   537* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *                            ICBDIR00      17
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  11
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
   538******************************************************************                            ICBDIR00      18
   539* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *                             ICBDIR00      19
   540* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*                            ICBDIR00      20
   541* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *                            ICBDIR00      21
   542* JUL.25/2008  *                                                 *                            ICBDIR00      22
   543******************************************************************                            ICBDIR00      23
   544* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*                            ICBDIR00      24
   545* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*                            ICBDIR00      25
   546* SEP/07/2011  *          CIA.                                   *                            ICBDIR00      26
   547******************************************************************                            ICBDIR00      27
   548* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *                            ICBDIR00      28
   549* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *                            ICBDIR00      29
   550* OCT/25/2012  *          ACTUALIZO.                             *                            ICBDIR00      30
   551******************************************************************                            ICBDIR00      31
   552 FD  MAESTRO-DIRECC.                                                                          ICBDIR00      32
   553 01  REG-DIRECC.                                                                              ICBDIR00      33
   554     03  LLAVE-DIRECC.                                                                        ICBDIR00      34
   555         05  LLAVE-PRI-DIRECC.                                                                ICBDIR00      35
   556             07  TIPO-ID-DIRECC    PIC 9(01).                                                 ICBDIR00      36
   557             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002                     ICBDIR00      37
   558         05  LLAVE-ALT-DIRECC.                                                                ICBDIR00      38
   559             07  COD-SUS-DIRECC    PIC 9(06).                                                 ICBDIR00      39
   560             07  COD-CTA-DIRECC    PIC 9(02).                                                 ICBDIR00      40
   561             07  NUM-CTA-DIRECC    PIC X(18).                                                 ICBDIR00      41
   562     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      42
   563     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      43
   564     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      44
   565     03  CIURES-DIRECC             PIC X(20).                     FAC0002                     ICBDIR00      45
   566     03  DPTRES-DIRECC             PIC X(20).                     FAC0002                     ICBDIR00      46
   567     03  DIRRES-DIRECC             PIC X(60).                     FAC0002                     ICBDIR00      47
   568     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002                     ICBDIR00      48
   569     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      49
   570     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005                     ICBDIR00      50
   571     03  CIULAB-DIRECC             PIC X(20).                     FAC0002                     ICBDIR00      51
   572     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002                     ICBDIR00      52
   573     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002                     ICBDIR00      53
   574     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002                     ICBDIR00      54
   575     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      55
   576     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005                     ICBDIR00      56
   577     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002                     ICBDIR00      57
   578     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002                     ICBDIR00      58
   579     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002                     ICBDIR00      59
   580     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      60
   581     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005                     ICBDIR00      61
   582     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002                     ICBDIR00      62
   583     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002                     ICBDIR00      63
   584     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      64
   585     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005                     ICBDIR00      65
   586     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002                     ICBDIR00      66
   587***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003                     ICBDIR00      67
   588***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003                     ICBDIR00      68
   589***  COR-CORRESPONDENCIA)                                         VHF0003                     ICBDIR00      69
   590***     CER???-DIRECC:                                            VHF0003                     ICBDIR00      70
   591***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003                     ICBDIR00      71
   592***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003                     ICBDIR00      72
   593***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003                     ICBDIR00      73
   594***     ADI???-DIRECC:                                            VHF0003                     ICBDIR00      74
   595***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003                     ICBDIR00      75
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  12
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBDIR0001
   596***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003                     ICBDIR00      76
   597***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003                     ICBDIR00      77
   598     03  CERRES-DIRECC             PIC 9(01).                     VHF0003                     ICBDIR00      78
   599     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003                     ICBDIR00      79
   600     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003                     ICBDIR00      80
   601     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003                     ICBDIR00      81
   602     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003                     ICBDIR00      82
   603     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003                     ICBDIR00      83
   604     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004                     ICBDIR00      84
   605     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005                     ICBDIR00      85
   606     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005                     ICBDIR00      86
   607     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005                     ICBDIR00      87
   608*    03  FILLER-DIRECC             PIC X(40).                     VHF0005                     ICBDIR00      88
   609*    03  FILLER-DIRECC             PIC X(28).                     RMB0006                     ICBDIR00      89
   610     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006                     ICBDIR00      90
   611     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006                     ICBDIR00      91
   612     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006                     ICBDIR00      92
   613     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007                     ICBDIR00      93
   614     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007                     ICBDIR00      94
   615     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007                     ICBDIR00      95
   616     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007                     ICBDIR00      96
   617     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007                     ICBDIR00      97
   618     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007                     ICBDIR00      98
   619     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007                     ICBDIR00      99
   620*    03  FILLER-DIRECC             PIC X(13).                     CAV0007                     ICBDIR00     100
   621     03  FILLER-DIRECC             PIC X(06).                     CAV0007                     ICBDIR00     101
*  622     copy BDLCLI.FD.                                                                                       167
   623*BDLCLI-FD.v.00003                                                                            BDLCLI         1
   624*ARCHIVO DE CLIENTES DE BASE DE DATOS LOCALIZACION CON INDICADOR Y                            BDLCLI         2
   625*PRIVILEGIO ACTUALIZADOS.                                                                     BDLCLI         3
   626*INDICADOR : 0 = NO AUTORIZADO    1 = SI AUTORIZADO                                           BDLCLI         4
   627*PRIVILEGIO: 1 = LOS AUTORIZADOS  2 = TODAS LAS DIRECCIONES                                   BDLCLI         5
   628************************************************************                                  BDLCLI         6
   629*NDG0002    * INF-CR  : INDICADOR SI EL SUSCRIPTOR ENTREGA *                                  BDLCLI         7
   630*N.DUARTE   *           INFORMACION CREDITICIA             *                                  BDLCLI         8
   631*FEB/2003   *             0 - NO ENTREGA INFORMACION       *                                  BDLCLI         9
   632*           *             1 - SI ENTREGA INFORMACION       *                                  BDLCLI        10
   633*           * VALDB   : INDICADOR PARA VALIDAR LA BASE DE  *                                  BDLCLI        11
   634*           *           DATOS CUANDO GENERE EL REPORTE     *                                  BDLCLI        12
   635*           *             S - SI VALIDA CONTRA BASE DATOS  *                                  BDLCLI        13
   636*           *             N - NO VALIDA CONTRA BASE DATOS  *                                  BDLCLI        14
   637*           *                                              *                                  BDLCLI        15
   638************************************************************                                  BDLCLI        16
   639*RMB0003    * BLOQ01  : INDICADOR PARA BLOQUEAR LA INFORMA *                                  BDLCLI        17
   640*R.MARTINEZ *           CION DE UN NIT                     *                                  BDLCLI        18
   641*OCT-1-2011 *           "B" = INFORMACION BLOQUEADA        *                                  BDLCLI        19
   642************************************************************                                  BDLCLI        20
   643 FD  BDLCLI.                                                                                  BDLCLI        21
   644 01  COMPLETO-BDLCLI.                                                                         BDLCLI        22
   645     03  LLAVE-BDLCLI.                                                                        BDLCLI        23
   646         05  NIT-ID-BDLCLI           PIC 9(11).                                               BDLCLI        24
   647     03  INDICADOR-BDLCLI            PIC 9(01).                                               BDLCLI        25
   648     03  PRIVILEGIO-BDLCLI           PIC 9(01).                                               BDLCLI        26
   649     03  INF-CREDITICIA-BDLCLI       PIC 9(01).                    NDG0002                    BDLCLI        27
   650     03  VALIDAR-DB-BDLCLI           PIC X(01).                    NDG0002                    BDLCLI        28
   651     03  IND-BLOQUEO-INF-BDLCLI      PIC X(01).  *> B=BLOQUEADA    RMB0003                    BDLCLI        29
   652*    03  FILLER                      PIC X(98).                    RMB0003                    BDLCLI        30
   653     03  FILLER                      PIC X(97).                    RMB0003                    BDLCLI        31
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  13
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/BDLCLI.FD)
*  654     COPY ICBSUS.FD.                                                                                       168
   657*******************************************************************                           ICBSUS         3
   658* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR                                ICBSUS         4
   659* F.CUADROS *         DATAHOST                                                                ICBSUS         5
   660* FEB.2003  *                                                                                 ICBSUS         6
   661*******************************************************************                           ICBSUS         7
   662* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES                         ICBSUS         8
   663* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.                           ICBSUS         9
   664* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES                          ICBSUS        10
   665******************************************************************                            ICBSUS        11
   666* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL                                 ICBSUS        12
   667* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR                            ICBSUS        13
   668* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.                                                ICBSUS        14
   669******************************************************************                            ICBSUS        15
   670* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE                           ICBSUS        16
   671* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL                            ICBSUS        17
   672* ENE. 07/2004 * HABITO DE PAGO.                                                              ICBSUS        18
   673******************************************************************                            ICBSUS        19
   674* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE                             ICBSUS        20
   675* F.CUADROS C. * FRAUDE                                                                       ICBSUS        21
   676* JUN. 04/2004 *                                                                              ICBSUS        22
   677******************************************************************                            ICBSUS        23
   678* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES                             ICBSUS        24
   679* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.                                            ICBSUS        25
   680* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL                             ICBSUS        26
   681*              * A SUI, 2-PASO AUTOMATICO A SUI.                                              ICBSUS        27
   682******************************************************************                            ICBSUS        28
   683* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE                               ICBSUS        29
   684* F.CUADROS C. * ENDEUDAMIENTO GLOBAL                                                         ICBSUS        30
   685* MAR. 14/2005 *                                                                              ICBSUS        31
   686******************************************************************                            ICBSUS        32
   687* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO                           ICBSUS        33
   688* R.MARTINEZ   * A TRAVES DE DATA WEB                                                         ICBSUS        34
   689* ABR. 21/2005 *                                                                              ICBSUS        35
   690******************************************************************                            ICBSUS        36
   691* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS                               ICBSUS        37
   692* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-                             ICBSUS        38
   693* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO                                                     ICBSUS        39
   694******************************************************************                            ICBSUS        40
   695* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *                            ICBSUS        41
   696* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *                            ICBSUS        42
   697* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *                            ICBSUS        43
   698******************************************************************                            ICBSUS        44
   699* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *                            ICBSUS        45
   700* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *                            ICBSUS        46
   701* NOV. 01/2005 *                                                 *                            ICBSUS        47
   702******************************************************************                            ICBSUS        48
   703* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *                            ICBSUS        49
   704* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *                            ICBSUS        50
   705* MAR.17/2006  *                                                                              ICBSUS        51
   706******************************************************************                            ICBSUS        52
   707* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*                            ICBSUS        53
   708* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *                            ICBSUS        54
   709* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *                            ICBSUS        55
   710******************************************************************                            ICBSUS        56
   711* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIÓN DE *                            ICBSUS        57
   712* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *                            ICBSUS        58
   713* JUL.05/2006  *                                                 *                            ICBSUS        59
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  14
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBSUS.FD)
   714******************************************************************                            ICBSUS        60
   715* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*                            ICBSUS        61
   716* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *                            ICBSUS        62
   717* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *                            ICBSUS        63
   718******************************************************************                            ICBSUS        64
   719* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *                            ICBSUS        65
   720* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*                            ICBSUS        66
   721* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *                            ICBSUS        67
   722******************************************************************                            ICBSUS        68
   723* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*                            ICBSUS        69
   724* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*                            ICBSUS        70
   725* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *                            ICBSUS        71
   726******************************************************************                            ICBSUS        72
   727* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *                            ICBSUS        73
   728* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *                            ICBSUS        74
   729* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *                            ICBSUS        75
   730*              * S- SI -DEFAULT                                                               ICBSUS        76
   731******************************************************************                            ICBSUS        77
   732* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *                            ICBSUS        78
   733* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*                            ICBSUS        79
   734* JULIO /2009  *         LIZADOR O NO.                           *                            ICBSUS        80
   735******************************************************************                            ICBSUS        81
   736* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *                            ICBSUS        82
   737* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *                            ICBSUS        83
   738* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO ASÍ: 0-NO CERTI*                            ICBSUS        84
   739*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *                            ICBSUS        85
   740*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*                            ICBSUS        86
   741*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *                            ICBSUS        87
   742*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *                            ICBSUS        88
   743*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *                            ICBSUS        89
   744******************************************************************                            ICBSUS        90
   745* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS                            ICBSUS        91
   746* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *                            ICBSUS        92
   747* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*                            ICBSUS        93
   748*              *         PRODUCTO) = 0                                                        ICBSUS        94
   749*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO                            ICBSUS        95
   750*              *          = 1                                                                 ICBSUS        96
   751*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*                            ICBSUS        97
   752*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *                            ICBSUS        98
   753*              *         CONSULTA DATAHOST O WEBSERVICE          *                            ICBSUS        99
   754******************************************************************                            ICBSUS       100
   755* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*                            ICBSUS       101
   756* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*                            ICBSUS       102
   757* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*                            ICBSUS       103
   758*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *                            ICBSUS       104
   759******************************************************************                            ICBSUS       105
   760* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *                            ICBSUS       106
   761* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *                            ICBSUS       107
   762* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *                            ICBSUS       108
   763******************************************************************                            ICBSUS       109
   764* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *                            ICBSUS       110
   765* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *                            ICBSUS       111
   766* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *                            ICBSUS       112
   767*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *                            ICBSUS       113
   768******************************************************************                            ICBSUS       114
   769* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *                            ICBSUS       115
   770* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *                            ICBSUS       116
   771* FEBRERO/2013 *         DE SUSCRIPTOR.                          *                            ICBSUS       117
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  15
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBSUS.FD)
   772*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *                            ICBSUS       118
   773*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*                            ICBSUS       119
   774*              *         NUMERO DE TARJETA.                      *                            ICBSUS       120
   775*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *                            ICBSUS       121
   776******************************************************************                            ICBSUS       122
   777 FD  SUSCRIPTOR.                                                                              ICBSUS       123
   778 01  REG-SUSCRIPTOR.                                                                          ICBSUS       124
   779     03  COD-SUSCRIP-ABD02       PIC 9(6).                                                    ICBSUS       125
   780     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02                                          ICBSUS       126
   781                                 PIC X(6).                                                    ICBSUS       127
   782     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.                                            ICBSUS       128
   783     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012                     ICBSUS       129
   784     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012                     ICBSUS       130
   785     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.                                                  ICBSUS       131
   786*        04 FILLER               PIC X(16).                       FAC0012                     ICBSUS       132
   787         04 NOM-COR1-ABD02       PIC X(14).                                                   ICBSUS       133
   788         04 NOM-COR2-ABD02       PIC X(14).                                                   ICBSUS       134
   789         04 IND-COR-ABD02        PIC 9.                                                       ICBSUS       135
   790     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009                     ICBSUS       136
   791     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.                                            ICBSUS       137
   792     03  IND-REGIST-ABD02        PIC 99    COMP-3.                                            ICBSUS       138
   793     03  ESTADO-ABD02            PIC 9     COMP-3.                                            ICBSUS       139
   794     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.                                            ICBSUS       140
   795     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.                                            ICBSUS       141
   796     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.                                            ICBSUS       142
   797     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.                                            ICBSUS       143
   798     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5                     ICBSUS       144
   799     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1                     ICBSUS       145
   800     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1                     ICBSUS       146
   801     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017                     ICBSUS       147
   802     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015                     ICBSUS       148
   803     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008                     ICBSUS       149
   804     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008                     ICBSUS       150
   805     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008                     ICBSUS       151
   806     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009                     ICBSUS       152
   807     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009                     ICBSUS       153
   808     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009                     ICBSUS       154
   809     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009                     ICBSUS       155
   810     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009                     ICBSUS       156
   811     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010                     ICBSUS       157
   812     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011                     ICBSUS       158
   813     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013                      ICBSUS       159
   814     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014                     ICBSUS       160
   815     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016                     ICBSUS       161
   816     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018                     ICBSUS       162
   817     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019                     ICBSUS       163
   818     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020                     ICBSUS       164
   819     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021                     ICBSUS       165
   820     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022                     ICBSUS       166
   821     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023                     ICBSUS       167
   822     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024                     ICBSUS       168
   823     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025                     ICBSUS       169
   824     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026                     ICBSUS       170
   825     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027                     ICBSUS       171
   826     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028                     ICBSUS       172
   827     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029                     ICBSUS       173
   828     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029                     ICBSUS       174
   829     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030                     ICBSUS       175
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  16
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBSUS.FD)
   830     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030                     ICBSUS       176
   831     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031                     ICBSUS       177
   832     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031                     ICBSUS       178
   833     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032                     ICBSUS       179
   834     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033                     ICBSUS       180
   835     03  DIRRES-ABD02            PIC X(01).                       RMB0034                     ICBSUS       181
   836     03  TELRES-ABD02            PIC X(01).                       RMB0034                     ICBSUS       182
   837     03  DIRLAB-ABD02            PIC X(01).                       RMB0034                     ICBSUS       183
   838     03  TELLAB-ABD02            PIC X(01).                       RMB0034                     ICBSUS       184
   839     03  DIRCOR-ABD02            PIC X(01).                       RMB0034                     ICBSUS       185
   840     03  TELCEL-ABD02            PIC X(01).                       RMB0034                     ICBSUS       186
   841     03  E-MAIL-ABD02            PIC X(01).                       RMB0034                     ICBSUS       187
   842     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036                     ICBSUS       188
   843     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036                     ICBSUS       189
   844     03  FILLER-ABD02-2          PIC X(05).                       CAV0036                     ICBSUS       190
   845*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036                     ICBSUS       191
   846*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034                     ICBSUS       192
   847*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033                     ICBSUS       193
*  848     COPY ICBCHK.FD.                                                                                       169
   849* ICBCHK.-FD.v.0009                                                                           ICBCHK         1
   850* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO                             ICBCHK         2
   851* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                                                  ICBCHK         3
   852*----------------------------------------------------------------*                            ICBCHK         4
   853******************************************************************                            ICBCHK         5
   854* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *                            ICBCHK         6
   855* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *                            ICBCHK         7
   856* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *                            ICBCHK         8
   857* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *                            ICBCHK         9
   858* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *                            ICBCHK        10
   859*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *                            ICBCHK        11
   860*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *                            ICBCHK        12
   861*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *                            ICBCHK        13
   862*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *                            ICBCHK        14
   863******************************************************************                            ICBCHK        15
   864* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*                            ICBCHK        16
   865* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *                            ICBCHK        17
   866*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *                            ICBCHK        18
   867* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *                            ICBCHK        19
   868*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *                            ICBCHK        20
   869******************************************************************                            ICBCHK        21
   870* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *                            ICBCHK        22
   871* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *                            ICBCHK        23
   872* 04/MAY/2009 *          CREDITO.                                *                            ICBCHK        24
   873******************************************************************                            ICBCHK        25
   874* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *                            ICBCHK        26
   875* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *                            ICBCHK        27
   876* 04/ENE/2010 *                                                  *                            ICBCHK        28
   877******************************************************************                            ICBCHK        29
   878* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *                            ICBCHK        30
   879* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *                            ICBCHK        31
   880* OCTUBRE/2010*          SON MÁS DE 10                           *                            ICBCHK        32
   881******************************************************************                            ICBCHK        33
   882                                                                                              ICBCHK        34
   883 FD  MAESTRO-CHECK.                                                                           ICBCHK        35
   884*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2                                               ICBCHK        36
   885 01  COMPLETO-ABD06.                                                                          ICBCHK        37
   886     03  LLAVE-MAES-CHECK.                                                                    ICBCHK        38
   887         05  LLAVE-MAES-CHECK-PRI.                                                            ICBCHK        39
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  17
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBCHK.FD)
   888             07  TIPO-ID-ABD06     PIC 9.                                                     ICBCHK        40
   889             07  NUM-ID-ABD06      PIC 9(11).                                                 ICBCHK        41
   890         05  LLAVE-MAES-CHECK-ALT.                                                            ICBCHK        42
   891             07  COD-SUS-ABD06     PIC 9(6).                                                  ICBCHK        43
   892             07  COD-CTA-ABD06     PIC 99.                                                    ICBCHK        44
   893             07  NUM-CTA-ABD06     PIC X(18).                                                 ICBCHK        45
   894     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.                                          ICBCHK        46
   895     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.                                          ICBCHK        47
   896     03  CALIFIC-ABD06             PIC 9     COMP-3.                                          ICBCHK        48
   897     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.                                          ICBCHK        49
   898     03  NOV-REPORT-ABD06          PIC 99    COMP-3.                                          ICBCHK        50
   899     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.                                          ICBCHK        51
   900     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.                                          ICBCHK        52
   901     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.                                          ICBCHK        53
   902     03  ADJETIVO-ABD06            PIC 9     COMP-3.                                          ICBCHK        54
   903     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.                                          ICBCHK        55
   904     03  ART15-ABD06               PIC 9     COMP-3.                                          ICBCHK        56
   905     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005                     ICBCHK        57
   906         REDEFINES                 ART15-ABD06.                   VHF0005                     ICBCHK        58
   907     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.                                          ICBCHK        59
   908     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005                     ICBCHK        60
   909                                   PIC 9(3).                      FAC0005                     ICBCHK        61
   910     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005                     ICBCHK        62
   911         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005                     ICBCHK        63
   912         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006                     ICBCHK        64
   913         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006                     ICBCHK        65
   914                                                                                              ICBCHK        66
   915     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH                      ICBCHK        67
   916*    03  FILLER-ABD06              PIC X(8).                      AMPLIA                      ICBCHK        68
   917     03  OFICINA-ABD06             PIC X(15).                     AMPINF5                     ICBCHK        69
   918     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5                     ICBCHK        70
   920     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004                     ICBCHK        72
   921     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008                     ICBCHK        73
   922         REDEFINES FEC-NOVANT-ABD06.                              CAV0008                     ICBCHK        74
   923     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004                     ICBCHK        75
   924*    03  FILLER-ABD06              PIC X(4).                      CAV0007                     ICBCHK        76
   925     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007                     ICBCHK        77
   926     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007                     ICBCHK        78
   927     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007                     ICBCHK        79
   928     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009                     ICBCHK        80
*  929     COPY ICBCRE.FD.                                                                                       170
   930* ICBCRE-FD.v.02.0013                                                                         ICBCRE         1
   931* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS                            ICBCRE         2
   932* POR LOS DIFERENTES SUSCRIPTORES                                                             ICBCRE         3
   933*----------------------------------------------------------------*                            ICBCRE         4
   934******************************************************************                            ICBCRE         5
   935* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *                            ICBCRE         6
   936* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *                            ICBCRE         7
   937* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *                            ICBCRE         8
   938* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *                            ICBCRE         9
   939* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *                            ICBCRE        10
   940*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *                            ICBCRE        11
   941*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *                            ICBCRE        12
   942*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *                            ICBCRE        13
   943*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *                            ICBCRE        14
   944******************************************************************                            ICBCRE        15
   945* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*                            ICBCRE        16
   946* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *                            ICBCRE        17
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  18
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBCRE.FD)
   947*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *                            ICBCRE        18
   948* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *                            ICBCRE        19
   949*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *                            ICBCRE        20
   950******************************************************************                            ICBCRE        21
   951* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *                            ICBCRE        22
   952* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *                            ICBCRE        23
   953*             *          CUARTO AÑO DE HISTORIA CREDITICIA       *                            ICBCRE        24
   954* 09/AGO/2007 *                                                  *                            ICBCRE        25
   955******************************************************************                            ICBCRE        26
   956* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *                            ICBCRE        27
   957* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *                            ICBCRE        28
   958* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *                            ICBCRE        29
   959*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *                            ICBCRE        30
   960*             *          ENDEUDAMIENTO                           *                            ICBCRE        31
   961******************************************************************                            ICBCRE        32
   962* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *                            ICBCRE        33
   963* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *                            ICBCRE        34
   964* OCTUBRE/2010*          SON MÁS DE 10                           *                            ICBCRE        35
   965******************************************************************                            ICBCRE        36
   966* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *                            ICBCRE        37
   967* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *                            ICBCRE        38
   968* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *                            ICBCRE        39
   969******************************************************************                            ICBCRE        40
   970 FD  MAESTRO-CREDIT.                                                                          ICBCRE        41
   971 01  COMPLETO-ABD07.                                                                          ICBCRE        42
   972     03  LLAVE-MAES-CREDIT.                                                                   ICBCRE        43
   973         05  LLAVE-MAES-CREDIT-PRI.                                                           ICBCRE        44
   974             07  TIPO-ID-ABD07     PIC 9.                                                     ICBCRE        45
   975             07  NUM-ID-ABD07      PIC 9(11).                                                 ICBCRE        46
   976         05  LLAVE-MAES-CREDIT-ALT.                                                           ICBCRE        47
   977             07  COD-SUS-ABD07     PIC 9(6).                                                  ICBCRE        48
   978             07  COD-CTA-ABD07     PIC 99.                                                    ICBCRE        49
   979             07  NUM-CTA-ABD07     PIC X(18).                                                 ICBCRE        50
   980             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA                     ICBCRE        51
   981                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA                     ICBCRE        52
   982                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA                     ICBCRE        53
   983     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.                                          ICBCRE        54
   984     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.                                          ICBCRE        55
   985     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.                                          ICBCRE        56
   986     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.                                          ICBCRE        57
   987     03  CALIFIC-ABD07             PIC 9     COMP-3.                                          ICBCRE        58
   988     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.                                          ICBCRE        59
   989     03  NOV-REPORT-ABD07          PIC 99    COMP-3.                                          ICBCRE        60
   990     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.                                          ICBCRE        61
   991     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.                                          ICBCRE        62
   992     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.                                          ICBCRE        63
   993     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AÑO 1   JGR0010                    ICBCRE        64
   994         REDEFINES                 ESTADO-MES-ABD07.               JGR0010                    ICBCRE        65
   995     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.                                          ICBCRE        66
   996     03  ADJETIVO1-ABD07           PIC 9     COMP-3.                                          ICBCRE        67
   997     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.                                          ICBCRE        68
   998     03  ADJETIVO2-ABD07           PIC 9     COMP-3.                                          ICBCRE        69
   999     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.                                          ICBCRE        70
  1000     03  ADJETIVO3-ABD07           PIC 9     COMP-3.                                          ICBCRE        71
  1001     03  ART15-ABD07               PIC 9     COMP-3.                                          ICBCRE        72
  1002     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008                     ICBCRE        73
  1003         REDEFINES                 ART15-ABD07.                   VHF0008                     ICBCRE        74
  1004     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.                                          ICBCRE        75
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  19
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBCRE.FD)
  1005     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008                     ICBCRE        76
  1006                                   PIC 9(3).                      FAC0008                     ICBCRE        77
  1007     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008                     ICBCRE        78
  1008         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008                     ICBCRE        79
  1009         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009                     ICBCRE        80
  1010         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009                     ICBCRE        81
  1011         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011                     ICBCRE        82
  1012            FILLER-RECLAMO-ABD07.                                 GJC0011                     ICBCRE        83
  1013         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011                     ICBCRE        84
  1014            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011                     ICBCRE        85
  1015         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011                     ICBCRE        86
  1016            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011                     ICBCRE        87
  1017*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013                     ICBCRE        88
  1018     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013                     ICBCRE        89
  1019     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013                     ICBCRE        90
  1020         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013                     ICBCRE        91
  1021     03  CALIFIC-R-ABD07           PIC 9     COMP-3.                                          ICBCRE        92
  1022     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.                                          ICBCRE        93
  1023     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007                     ICBCRE        94
  1024                                   PIC 9     COMP-3.                                          ICBCRE        95
  1025     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.                                          ICBCRE        96
  1026     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.                                          ICBCRE        97
  1027     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.                                          ICBCRE        98
  1028     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007                     ICBCRE        99
  1029                                   PIC X(02).                     FAC0007                     ICBCRE       100
  1030     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.                                          ICBCRE       101
  1031     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AÑO 3   JGR0010                    ICBCRE       102
  1032         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010                    ICBCRE       103
  1033     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.                                          ICBCRE       104
  1034     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA                     ICBCRE       105
  1035*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011                     ICBCRE       106
  1036*                              *> CAMPOS                          GJC0011                     ICBCRE       107
  1037*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011                     ICBCRE       108
  1038*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011                     ICBCRE       109
  1039*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011                     ICBCRE       110
  1040*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011                     ICBCRE       111
  1041*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011                     ICBCRE       112
  1042*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011                     ICBCRE       113
  1043*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011                     ICBCRE       114
  1044*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011                     ICBCRE       115
  1045     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011                     ICBCRE       116
  1046* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011                     ICBCRE       117
  1047        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011                     ICBCRE       118
  1048        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011                     ICBCRE       119
  1049        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011                     ICBCRE       120
  1050        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011                     ICBCRE       121
  1051        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011                     ICBCRE       122
  1052* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011                     ICBCRE       123
  1053         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011                     ICBCRE       124
  1054         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011                     ICBCRE       125
  1055         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011                     ICBCRE       126
  1056         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011                     ICBCRE       127
  1057         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011                     ICBCRE       128
  1058         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011                     ICBCRE       129
  1059             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011                     ICBCRE       130
  1060         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011                     ICBCRE       131
  1061             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011                     ICBCRE       132
  1062         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011                     ICBCRE       133
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  20
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICBCRE.FD)
  1063         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011                     ICBCRE       134
  1064         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011                     ICBCRE       135
  1065*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012                     ICBCRE       136
  1066         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012                     ICBCRE       137
  1067* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011                     ICBCRE       138
  1068     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA                     ICBCRE       139
  1069     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA                     ICBCRE       140
  1070     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA                     ICBCRE       141
  1071     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA                     ICBCRE       142
  1072     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA                     ICBCRE       143
  1073     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA                     ICBCRE       144
  1074     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA                     ICBCRE       145
  1075     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA                     ICBCRE       146
  1076     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA                     ICBCRE       147
  1077     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA                     ICBCRE       148
  1078     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA                     ICBCRE       149
  1079     03  SITUACION-ABD07            PIC X.                         AMPLIA                     ICBCRE       150
  1080     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA                     ICBCRE       151
  1081     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011                     ICBCRE       152
  1082         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011                     ICBCRE       153
  1083         05  CAMPOS-TARJETA-ABD07.                                GJC0011                     ICBCRE       154
  1084             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011                     ICBCRE       155
  1085             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011                     ICBCRE       156
  1086                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011                     ICBCRE       157
  1087         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012                     ICBCRE       158
  1088     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH                     ICBCRE       159
  1089     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA                     ICBCRE       160
  1090     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA                     ICBCRE       161
  1091*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA                     ICBCRE       162
  1092     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7                    ICBCRE       163
  1093     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA                     ICBCRE       164
  1094     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010                    ICBCRE       165
  1095         REDEFINES                  VECTOR-2-ABD07.     *> AÑO 2   JGR0010                    ICBCRE       166
  1096     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5                    ICBCRE       167
  1097     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5                    ICBCRE       168
  1098     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5                    ICBCRE       169
  1099     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5                    ICBCRE       170
  1100     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7                    ICBCRE       171
  1101     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002                    ICBCRE       172
  1102     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AÑO 4   JGR0010                    ICBCRE       173
  1103         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010                    ICBCRE       174
  1104                                                                                              ICBCRE       175
* 1105     COPY BDLSTDCIU.FD.                                                                                    171
  1106* BDLSTDCIU-FD.v.0002                                                                         BDLSTDCI       1
  1107******************************************************************                            BDLSTDCI       2
  1108* ESTRUCTURA DE ARCHIVO DE ACEPCIONES DE CIUDADES.               *                            BDLSTDCI       3
  1109******************************************************************                            BDLSTDCI       4
  1110******************************************************************                            BDLSTDCI       5
  1111* RGH0002       * MOD002 - INCLUIR CAMPOS EN EL FILLER           *                            BDLSTDCI       6
  1112* R. GALVIS H.  *          ACTIVO                                *                            BDLSTDCI       7
  1113* ENE. 01/2010  *          ULTFEC                                *                            BDLSTDCI       8
  1114* INTERSCHEMES. *          ULTUSR                                *                            BDLSTDCI       9
  1115******************************************************************                            BDLSTDCI      10
  1116 FD BDLSTDCIU.                                                                                BDLSTDCI      11
  1117 01 REG-BDLSTDCIU.                                                                            BDLSTDCI      12
  1118    02 LLAVE-BDLSTDCIU   PIC X(30).                                                           BDLSTDCI      13
  1119    02 CIUDAD-BDLSTDCIU  PIC X(30).                                                           BDLSTDCI      14
  1120    02 CODIGO-BDLSTDCIU  PIC 9(08).                                                           BDLSTDCI      15
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  21
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLSTDCIU.
  1121*   02 FILLER            PIC X(30).                               RGH0002                     BDLSTDCI      16
  1122    02 ACTIVO-BDLSTDCIU  PIC X(01).                               RGH0002                     BDLSTDCI      17
  1123    02 ULTFEC-BDLSTDCIU  PIC X(08).                               RGH0002                     BDLSTDCI      18
  1124    02 ULTUSR-BDLSTDCIU  PIC X(08).                               RGH0002                     BDLSTDCI      19
  1125    02 FILLER            PIC X(13).                               RGH0002                     BDLSTDCI      20
* 1126     COPY DIREST.FD.                                                                                       172
  1127*DIREST-FD.v.0002                                                                             DIREST         1
  1128******************************************************************                            DIREST         2
  1129* ARCHIVO DE ESTANDARIZACION DE DIRECCIONES                      *                            DIREST         3
  1130******************************************************************                            DIREST         4
  1131* RMB0002   * AMPL01 : SE AMPLIO LA ESTRUCTURA PARA ADMITIR CO-  *                            DIREST         5
  1132* SEPT/2006 *          MENTARIOS Y FECHAS DE ACTULIZACION        *                            DIREST         6
  1133******************************************************************                            DIREST         7
  1134 FD  DIREST.                                                                                  DIREST         8
  1135 01  REG-DIREST.                                                                              DIREST         9
  1136     03  DIR-ORIG-DIREST         PIC X(20).                                                   DIREST        10
  1137     03  DIR-ESTAN-DIREST        PIC X(10).                                                   DIREST        11
  1138     03  FILLER                  PIC X(100).                      RMB0002                     DIREST        12
* 1139     COPY BDLNEWDIRBOG.FD.                                                                                 173
  1142 FD BDLNEWDIRBOG.                                                                             BDLNEWDI       3
  1143 01 REG-BDLNEWDIRBOG.                                                                         BDLNEWDI       4
  1144    02 LLAVE-BDLNEWDIRBOG.                                                                    BDLNEWDI       5
  1145       03 AVENIDA-BDLNEWDIRBOG         PIC X(02).                                             BDLNEWDI       6
  1146       03 NUMEROS-BDLNEWDIRBOG.                                                               BDLNEWDI       7
  1147          04 CODIGO-BDLNEWDIRBOG OCCURS 10 TIMES.                                             BDLNEWDI       8
  1148             05 NUMCOD-BDLNEWDIRBOG    PIC 9(05).                                             BDLNEWDI       9
  1149    02 DIRORI-BDLNEWDIRBOG             PIC X(60).                                             BDLNEWDI      10
  1150    02 DIRNEW-BDLNEWDIRBOG             PIC X(60).                                             BDLNEWDI      11
  1151                                                                                                           174
  1152******************************************************************                                         175
  1153* Maestro de alertas reportadas por suscriptores                                                           176
  1154******************************************************************                                         177
* 1155 copy BDIIALE.FD.                                                                                          178
  1156* BDIIALE-FD.v01.0003.                                                                        BDIIALE        1
  1157* MAESTRO DE ALERTAS REPORTADAS POR SUSCRIPTORES                                              BDIIALE        2
  1158*----------------------------------------------------------------*                            BDIIALE        3
  1159*****************************************************************                             BDIIALE        4
  1160* RMB0003   * CIU001: SE INCLUYE EL CODIGO DE LA ALERTA DENTRO DE                             BDIIALE        5
  1161* R.MARTINEZ* LA LLAVE, SE CAMBIA LA LONGITUD DE LLAVE-SECUNDARIA                             BDIIALE        6
  1162* OCTUB/2006* Y SE MANEJAN ALERTAS DE TEXTO FIJO                                              BDIIALE        7
  1163******************************************************************                            BDIIALE        8
  1164                                                                                              BDIIALE        9
  1165 FD BDIIALE.                                                                                  BDIIALE       10
  1166 01 REG-BDIIALE.                                                                              BDIIALE       11
  1167    02 LLAVE-BDIIALE.                                                                         BDIIALE       12
  1168       03 TIP-IDE-BDIIALE        PIC 9(01).                                                   BDIIALE       13
  1169       03 NUM-IDE-BDIIALE        PIC 9(11).                                                   BDIIALE       14
  1170       03 FUENTE-BDIIALE         PIC 9(06).                                                   BDIIALE       15
  1171       03 COD-ALERTA-BDIIALE     PIC 9(03).                       RMB0003                     BDIIALE       16
  1172       03 LLASEC-BDIIALE         PIC X(08).                       RMB0003                     BDIIALE       17
  1173    02 ENCABEZADO-BDIIALE.                                                                    BDIIALE       18
  1174       03 FEC-NOV-BDIIALE        PIC 9(08).                       RMB0003                     BDIIALE       19
  1175       03 FEC-VEN-BDIIALE        PIC 9(08).                       RMB0003                     BDIIALE       20
  1176       03 FEC-REP-BDIIALE        PIC 9(08).                       RMB0003                     BDIIALE       21
  1177       03 BLOQUEO-BDIIALE        PIC 9(01).                                                   BDIIALE       22
  1178       03 FILLER-BDIIALE         PIC X(10).                       RMB0003                     BDIIALE       23
  1179       03 INF-DATAHOST-BDIIALE   PIC X(18).                       RMB0003                     BDIIALE       24
  1180       03 LINEAS-BDIIALE.                                         RMB0003                     BDIIALE       25
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  22
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIALE.FD
  1181          04 LINEA1-BDIIALE      PIC X(50).                       RMB0003                     BDIIALE       26
  1182          04 LINEA2-BDIIALE      PIC X(50).                       RMB0003                     BDIIALE       27
  1183       03 FILLER REDEFINES LINEAS-BDIIALE.                        RMB0003                     BDIIALE       28
  1184          04 DATOS-BDIIALE       PIC X(100).                      RMB0003                     BDIIALE       29
  1185                                                                                              BDIIALE       30
  1186                                                                                                           179
  1187******************************************************************                                         180
  1188 WORKING-STORAGE section.                                                                                  181
  1189******************************************************************                                         182
  1190* Nombre del programa                                                                                      183
  1191 01  pgm                          pic x(10) value "CARGAJUR".                                              184
  1192                                                                                                           185
  1193                                                                                                           186
  1194******************************************************************                                         187
  1195* Datos para la búsqueda en base alterna                                                                   188
  1196 01  W-DERECHOS                   PIC 9 value 0.                                                           189
  1197 01  CODIGO-ERROR                 pic 99 value 00.                                                         190
  1198                                                                                                           191
  1199 01  SW-BDIIALE                   pic 9 value 0.                                                           192
  1200 01  HACER-MATCH                  PIC 9 value 0.                                                           193
  1201 01  CADENA-ENTRA                 PIC X(60).                                                               194
  1202 01  CADENA-SALE                  PIC X(60).                                                               195
  1203 01  IND-ALFABETICO              PIC  X(01).                                                               196
  1204     88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"                                          197
  1205                                      "G" "H" "I" "J" "K" "L" "M"                                          198
  1206                                      "N" "/" "O" "P" "Q" "R" "S"                                          199
  1207                                      "T" "U" "V" "W" "X" "Y" "Z"                                          200
  1208                                      "Ñ".                                                                 201
  1209 01  OPEN-DIR                     PIC 9 value 0.                                                           202
  1210 01  W-BLOQUES                    PIC 9 value 2.                                                           203
  1211                                                                                                           204
  1212 01  DATOS-E.                                                                                              205
  1213     03 TIPOID-E                  pic 9.                                                                   206
  1214     03 NUMID-E                   pic 9(11).                                                               207
  1215     03 NOMBRE-E                  pic x(45).                                                               208
  1216                                                                                                           209
  1217 01  REG-VALIDAS.                                                                                          210
  1218     03 TIP-VAL                   PIC 9.                                                                   211
  1219     03 CED-VAL                   PIC 9(11).                                                               212
  1220     03 NOM-VAL                   PIC X(45).                                                               213
  1221     03 FEC-EXP-VAL               PIC 9(08).                                                               214
  1222     03 MUN-EXP-VAL               PIC X(15).                                                               215
  1223     03 DEP-EXP-VAL               PIC X(15).                                                               216
  1224     03 VIG-VAL                   PIC X(02).                                                               217
  1225     03 GENERO-VAL                PIC X(01).                                                               218
  1226     03 EDAD-VAL                  PIC X(03).                                                               219
  1227     03 EDAD-RANGO                PIC X(05).                                                               220
  1228     03 FILLER-2-VAL              PIC X(51).                                                               221
  1229                                                                                                           222
  1230 01  W-CONTADORES.                                                                                         223
  1231     03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.                                                    224
  1232     03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.                                                    225
  1233     03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.                                                    226
  1234     03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.                                                    227
  1235     03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.                                                    228
  1236                                                                                                           229
  1237 01  SUSCRIPTOR-AUX               PIC 9(06).                                                               230
  1238 01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.                                                   231
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  23
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/BDIIALE.FD
  1239 01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.                                                   232
  1240 01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.                                                   233
  1241 01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.                                                   234
  1242 01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.                                                   235
  1243 01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.                                                   236
  1244 01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.                                                   237
  1245 01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.                                                   238
  1246 01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.                                                   239
  1247 01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.                                                   240
  1248                                                                                                           241
  1249 01 MAS-DATOS.                                                                                             242
  1250     03 I                         PIC 9(02) VALUE ZERO.                                                    243
  1251     03 J                         PIC 9(02) VALUE ZERO.                                                    244
  1252                                                                                                           245
* 1253     COPY  BDLDIR.WS.                                                                                      246
  1254*BDLDIR-WS.v.0015                                                                             BDLDIR         1
  1255*******************************************************************                           BDLDIR         2
  1256* RMB0002      * ALG001 - SE AUMENTAN LAS VARIABLES NECESARIAS POR                            BDLDIR         3
  1257*              * ALG001 - EL CAMBIO EN EL ORDEN DE LA DIRECCION MAS                           BDLDIR         4
  1258* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA                           BDLDIR         5
  1259* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO                         BDLDIR         6
  1260*******************************************************************                           BDLDIR         7
  1261* RMB0003      * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS                            BDLDIR         8
  1262* MAR-15-2003  *          PERMISOS DE ACCESO A LA BASE DE DATOS DE                            BDLDIR         9
  1263* R.MARTINEZ   *          DIRECCIONES                                                         BDLDIR        10
  1264*******************************************************************                           BDLDIR        11
  1265* VHF0004      * ESTAN1 - SE AUMENTAN LOS TAMANOS DE VARIABLES                                BDLDIR        12
  1266* MAY-27-2003  *          PARA PERMITIR MAXIMO HASTA 30 PARTICULAS                            BDLDIR        13
  1267* V.FORERO     *          PARA UNA DIRECCION                                                  BDLDIR        14
  1268*******************************************************************                           BDLDIR        15
  1269* FAC0005      * AMPDIR - AMPLIACION DE LA ESTRUCTURA DE ARCHIVO                              BDLDIR        16
  1270* F.CUADROS C. *          ICBDIR                                                              BDLDIR        17
  1271* FEB.15/2006  * DOMICI - SEÑAL PARA MATCH DE DOMICILIACION                                   BDLDIR        18
  1272*******************************************************************                           BDLDIR        19
  1273* RMB0006      * RCNCER - OPTIMIZACION PARA PRODUCTO RECONOCER.  *                            BDLDIR        20
  1274* R.MARTINEZ   *          SE CAMBIAN VARIABLES QUE UTILIZA LA    *                            BDLDIR        21
  1275* JUN.15/2006  *          RUTINA PARA ESTANDARIZACION ADEMAS DE  *                            BDLDIR        22
  1276*              *          LA DEFINICION DE NUEVAS VARIABLES PARA *                            BDLDIR        23
  1277*              *          OPTIMIZACION (VER DETALLES EN PATCH DE *                            BDLDIR        24
  1278*              *          BDLDIR.PROC).                                                       BDLDIR        25
  1279******************************************************************                            BDLDIR        26
  1280* GJC0007      * NWDIRB - VARIABLES PARA IDENTIFICAR CUANDO UNA  *                            BDLDIR        27
  1281* G.JIMENEZ    *          DIRECCION DE BOGOTA TIENE NUEVA NOMEN- *                            BDLDIR        28
  1282* FEBRERO/2007 *          CLATURA                                *                            BDLDIR        29
  1283******************************************************************                            BDLDIR        30
  1284* HGO0008      * UNIDIR - UNIFICAR DIRECCIONES QUE TENGAN        *                            BDLDIR        31
  1285* H.GARCIA     *          COINCIDENCIAS CON OTRAS DIRECCIONES CON*                            BDLDIR        32
  1286* MARZO/2009   *          MAYOR CANTIDAD DE INFORMACION - INCLUIR*                            BDLDIR        33
  1287* INTERSCHEMES *          EN LA SALIDA EL CAMPO FECHA ULTIMO REP *                            BDLDIR        34
  1288*              * TELEXC - SE UNIFICAN TELEFONOS QUE COINCIDAN CON*                            BDLDIR        35
  1289*              *          LOS ULTIMOS 7 NUMEROS DEL TELEFONO. SE *                            BDLDIR        36
  1290*              *          CREA TABLA PARA LA EXCLUSION DE TELEFO-*                            BDLDIR        37
  1291*              *          NOS. SE AGREGA EN EL REPORTE FECHA     *                            BDLDIR        38
  1292*              *          ULTIMO REPORTE.                        *                            BDLDIR        39
  1293******************************************************************                            BDLDIR        40
  1294* RGH0009      * TELEX9 - UTILIZAR REDEFINICION PARA VARIABLE    *                            BDLDIR        41
  1295* R.GALVIS     *          V-TELFIN-BDLDIR                        *                            BDLDIR        42
  1296* MARZO/2009   *                                                 *                            BDLDIR        43
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  24
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1297* INTERSCHEMES *                                                 *                            BDLDIR        44
  1298******************************************************************                            BDLDIR        45
  1299* HGO0010       * TEXTEL - Se agregan nuevas exclusiones en la   *                            BDLDIR        46
  1300* H. GARCIA O.  *          tabla de telefonos y se amplia el     *                            BDLDIR        47
  1301* SEP.01/2009   *          numero de ocurrencias                 *                            BDLDIR        48
  1302* INTERSCHEMES  *                                                *                            BDLDIR        49
  1303******************************************************************                            BDLDIR        50
  1304* HGO0011       * PYSPAR - AJUSTE QUE BUSCAR GENERAR CALIFICACION*                            BDLDIR        51
  1305* H. GARCIA O.  *          PARA LA PRIMERA Y SEGUNDA PARTICULA Y *                            BDLDIR        52
  1306* AGO. 25/2009  *          LUEGO UNIFICAR TENIENDO EN CUENTA ESTE*                            BDLDIR        53
  1307* INTERSCHEMES. *          CRITERIO                              *                            BDLDIR        54
  1308******************************************************************                            BDLDIR        55
  1309* PJV0012      * NN0012 - AJUSTE, PARA EVITAR QUE SE REPITAN     *                            BDLDIR        56
  1310* P.VARGAS     *          DIRECCIONES EN EL MISMO REPORTE CUNADO *                            BDLDIR        57
  1311* JUL 01/2010  *          SE TRATAN DE NUEVAS NOMENCLATURAS EN   *                            BDLDIR        58
  1312* DATACREDITO  *          BOGOTA.                                *                            BDLDIR        59
  1313******************************************************************                            BDLDIR        60
  1314* PJV0013      * AMP013 -SE AMPLIAN LOS LIMITES DE LAS TABLAS DE *                            BDLDIR        61
  1315* P.VARGAS     *         ACEPCIONES QUE SE CARGAN EN MEMORIA.    *                            BDLDIR        62
  1316* SEP 09/2010  *         TAMBIEN SE AJUSTA PARA EVITAR LA        *                            BDLDIR        63
  1317* DATACREDITO  *         REPETICION DE DIRECCIONES PARA UNA MISMA*                            BDLDIR        64
  1318*              *         IDENTIFICACION.                         *                            BDLDIR        65
  1319******************************************************************                            BDLDIR        66
  1320* CAV0014      * CALDYT - SE ADICIONA LAS VARIABLES PARA VALIDAR *                            BDLDIR        67
  1321* C.VELASCO.   *          LOS CAMPOS EMAIL Y TELEFONO CELULAR.   *                            BDLDIR        68
  1322* SEP 18/2012  *                                                 *                            BDLDIR        69
  1323******************************************************************                            BDLDIR        70
  1324* RMB0015      * FCRGCR- SE INTEGRA EL AJUSTE DE FECHAS DE       *                            BDLDIR        71
  1325* R.MARTINEZ   *         DIRECCIONES DE CUENTAS CERRADAS         *                            BDLDIR        72
  1326* OCT 16/2012  *         PARA IGUALAR CON LA RUTINA BDLDI2       *                            BDLDIR        73
  1327******************************************************************                            BDLDIR        74
  1328*                                                                                             BDLDIR        75
  1329 01  FECHAS-BDLDI2.                                               RMB0015                     BDLDIR        76
  1330     02 FEC-AAAAMM-BDLDI2              PIC 9(06).                 RMB0015                     BDLDIR        77
  1331     02 FEC-MMAA-BDLDI2                PIC 9(04).                 RMB0015                     BDLDIR        78
  1332     02 CTA-ACTIVA                     PIC 9(01).                 RMB0015                     BDLDIR        79
  1333 01 PARAMETROS-BDLDIR.                                            RMB0006                     BDLDIR        80
  1334    02 POLITICA-EXC-CAL-DIR-BDLDIR    PIC 9(02) VALUE 0.          RMB0006                     BDLDIR        81
  1335    02 POLITICA-EXC-MAL-DIR-BDLDIR    PIC 9(02) VALUE 1.          RMB0006                     BDLDIR        82
  1336*** PARAMETROS DE INDICADOR DE DIRECCION CERTIFICADA              RMB0006                     BDLDIR        83
  1337    02 DIRCER-BDLDIR                  PIC 9(01).                  RMB0006                     BDLDIR        84
  1338*** PARAMETROS DE PUNTOS ADICIONALES                              RMB0006                     BDLDIR        85
  1339    02 PTSADI-BDLDIR                  PIC 9(02).                  RMB0006                     BDLDIR        86
  1340*** PARANETRO DE CIUDAD ORIGINAL                                  RMB0006                     BDLDIR        87
  1341    02 CIUDAD-BDLDIR                  PIC X(20).                  RMB0006                     BDLDIR        88
  1342 01 VARIABLES-CIU.                                                RMB0006                     BDLDIR        89
  1343    02 I-CIU-BDLDIR                   PIC 9(04).                  RMB0006                     BDLDIR        90
  1344    02 J-CIU-BDLDIR                   PIC 9(04).                  RMB0006                     BDLDIR        91
  1345    02 CIUDAD-ESTANDAR-CIU-BDLDIR     PIC X(30).                  RMB0006                     BDLDIR        92
  1346    02 PATRON-CIU-BDLDIR              PIC 9(03) VALUE 0.          RMB0006                     BDLDIR        93
  1347    02 CAMPO-CIU-BDLDIR               PIC X(30) VALUE SPACES.     RMB0006                     BDLDIR        94
  1348    02 CODIGO-DANE-CIU-BDLDIR         PIC X(08) VALUE SPACES.     RMB0006                     BDLDIR        95
  1349    02 CODIGO-DANE-N-CIU-BDLDIR       REDEFINES                   RMB0006                     BDLDIR        96
  1350       CODIGO-DANE-CIU-BDLDIR         PIC 9(08).                  RMB0006                     BDLDIR        97
  1351    02 LLAVE-AUX21-CIU-BDLDIR.                                    RMB0006                     BDLDIR        98
  1352       03 FILLER                      PIC X(01) VALUE SPACES.     RMB0006                     BDLDIR        99
  1353       03 LLAVE-AUX-CIU-BDLDIR        PIC X(20) VALUE SPACES.     RMB0006                     BDLDIR       100
  1354    02 OPEN-BDLSTDCIU-BDLDIR          PIC 9(01) VALUE 0.          RMB0006                     BDLDIR       101
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  25
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1355    02 BASURA-CIU-BDLDIR              PIC X(01) VALUE SPACES.     RMB0006                     BDLDIR       102
  1356 01 VARIABLES-TELEXC.                                             HGO0008                     BDLDIR       103
  1357     03  W-OCURR                      PIC 99999.                  HGO0008                     BDLDIR       104
  1358     03  W-I                          PIC 99999.                  HGO0008                     BDLDIR       105
  1359     03  W-POSIUNI                    PIC 99999.                  HGO0008                     BDLDIR       106
  1360     03  W-TELANT                     PIC X(12).                  HGO0008                     BDLDIR       107
  1361     03  W-TELDES                     PIC X(12).                  HGO0008                     BDLDIR       108
  1362     03  W-POSANT                     PIC 99999.                  HGO0008                     BDLDIR       109
  1363     03  W-POSDES                     PIC 99999.                  HGO0008                     BDLDIR       110
  1364     03  W-POSRC                      PIC 99999.                  HGO0008                     BDLDIR       111
  1365     03  SW-1                         PIC 9.                      HGO0008                     BDLDIR       112
  1366     03  SW-2                         PIC 9.                      HGO0008                     BDLDIR       113
  1367     03  SW-ENCUENTRA-PI              PIC 9.                      HGO0008                     BDLDIR       114
  1368     03  W-POSI                       PIC 99999.                  HGO0008                     BDLDIR       115
  1369     03  LONGCOMP-EXCLU               PIC 99999.                  HGO0008                     BDLDIR       116
  1370     03  POSI-EXCLU                   PIC 99999.                  HGO0008                     BDLDIR       117
  1371     03  IQ                           PIC 99999.                  HGO0008                     BDLDIR       118
  1372 01  TELS-EXCLU.                                                  HGO0008                     BDLDIR       119
  1373     03 FILLER                     PIC X(12) VALUE "     0000000".HGO0008                     BDLDIR       120
  1374     03 FILLER                     PIC X(12) VALUE "     1111111".HGO0008                     BDLDIR       121
  1375     03 FILLER                     PIC X(12) VALUE "     1234546".HGO0008                     BDLDIR       122
  1376     03 FILLER                     PIC X(12) VALUE "     1475632".HGO0008                     BDLDIR       123
  1377     03 FILLER                     PIC X(12) VALUE "     1477500".HGO0008                     BDLDIR       124
  1378     03 FILLER                     PIC X(12) VALUE "     1756874".HGO0008                     BDLDIR       125
  1379     03 FILLER                     PIC X(12) VALUE "     1975090".HGO0008                     BDLDIR       126
  1380     03 FILLER                     PIC X(12) VALUE "     1978030".HGO0008                     BDLDIR       127
  1381     03 FILLER                     PIC X(12) VALUE "     1985110".HGO0008                     BDLDIR       128
  1382     03 FILLER                     PIC X(12) VALUE "     1986090".HGO0008                     BDLDIR       129
  1383     03 FILLER                     PIC X(12) VALUE "     1992070".HGO0008                     BDLDIR       130
  1384     03 FILLER                     PIC X(12) VALUE "     1993020".HGO0008                     BDLDIR       131
  1385     03 FILLER                     PIC X(12) VALUE "     1995091".HGO0010                     BDLDIR       132
  1386     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       133
  1387     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       134
  1388     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       135
  1389     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       136
  1390     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       137
  1391     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       138
  1392     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       139
  1393     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       140
  1394     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       141
  1395     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       142
  1396     03 FILLER                     PIC X(12) VALUE "            ".HGO0010                     BDLDIR       143
  1397 01  FILLER                        REDEFINES TELS-EXCLU.          HGO0008                     BDLDIR       144
  1398*TELEXC     02 T-TELS-EXCLU               PIC X(12) OCCURS 12 TIMEHGO0010                     BDLDIR       145
  1399     02 T-TELS-EXCLU               PIC X(12) OCCURS 24 TIMES.     HGO0010                     BDLDIR       146
  1400 01 VARIABLES-BDLDIR.                                             RMB0006                     BDLDIR       147
  1401    03 TEL-OK-BDLDIR                  PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       148
  1402    03 TABLA-TELFINALES-BDLDIR.                                   RMB0006                     BDLDIR       149
  1403       04 T-TELFINALES-BDLDIR         OCCURS 100 TIMES.           RMB0006                     BDLDIR       150
  1404*         05 V-TELFIN-BDLDIR          PIC X(12).                  HGO0008                     BDLDIR       151
  1405*         05 V-TELFIN-BDLDIR.                                     RGH0009                     BDLDIR       152
  1406          05 V-TELFIN-BDLDIR          PIC X(12).                  RGH0009                     BDLDIR       153
  1407          05 V-TELFIN-BDLDIR-R        REDEFINES                   RGH0009                     BDLDIR       154
  1408             V-TELFIN-BDLDIR.                                     RGH0009                     BDLDIR       155
  1409             10 V-TELFIN-BDLDIR-1     PIC X(05).                  HGO0008                     BDLDIR       156
  1410             10 V-TELFIN-BDLDIR-2     PIC X(07).                  HGO0008                     BDLDIR       157
  1411          05 V-CIUTELFIN-BDLDIR       PIC X(20).                  RMB0006                     BDLDIR       158
  1412          05 V-FECTELFIN-BDLDIR       PIC 9(06).                  RMB0006                     BDLDIR       159
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  26
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1413          05 V-TIPTELFIN-BDLDIR       PIC X(01).                  RMB0006                     BDLDIR       160
  1414          05 V-NUMTELFIN-BDLDIR       PIC 9(03).                  RMB0006                     BDLDIR       161
  1415          05 V-SUSTELFIN-BDLDIR       PIC 9(06).                  RMB0006                     BDLDIR       162
  1416          05 V-HASTELFIN-BDLDIR       PIC X(50).                  RMB0006                     BDLDIR       163
  1417          05 V-VECTELFIN-BDLDIR       PIC X(50).                  RMB0006                     BDLDIR       164
  1418          05 V-CALTELFIN-BDLDIR       PIC 9(03).                  RMB0006                     BDLDIR       165
  1419          05 V-FECULTTELFIN-BDLDIR    PIC 9(06).                  HGO0008                     BDLDIR       166
  1420    03 TABLA-TEL-BDLDIR.                                          RMB0006                     BDLDIR       167
  1421       04 T-TEL-BDLDIR                OCCURS 100 TIMES.           RMB0006                     BDLDIR       168
  1422          05 V-TELEFONO-BDLDIR        PIC X(12).                  RMB0006                     BDLDIR       169
  1423          05 V-CIUDADTEL-BDLDIR       PIC X(20).                  RMB0006                     BDLDIR       170
  1424          05 V-TIPOTEL-BDLDIR         PIC X(15).                  RMB0006                     BDLDIR       171
  1425          05 V-FECHATEL-BDLDIR        PIC 9(06).                  RMB0006                     BDLDIR       172
  1426          05 V-SUSTEL-BDLDIR          PIC 9(06).                  RMB0006                     BDLDIR       173
  1427          05 V-HASTEL-BDLDIR          PIC X(50).                  RMB0006                     BDLDIR       174
  1428          05 V-FECULTTEL-BDLDIR       PIC 9(06).                  HGO0008                     BDLDIR       175
  1429    03 NUMTEL-BDLDIR                  PIC X(12).                  RMB0006                     BDLDIR       176
  1430    03 DIR-OK-BDLDIR                  PIC 9(05).                  RMB0006                     BDLDIR       177
  1431    03 TABLA-DIRFINALES-BDLDIR.                                   RMB0006                     BDLDIR       178
  1432       04 T-DIRFINALES-BDLDIR         OCCURS 100 TIMES.           RMB0006                     BDLDIR       179
  1433          05 V-DIRFIN-BDLDIR          PIC X(60).                  RMB0006                     BDLDIR       180
  1434          05 V-PRIPARTFIN-BDLDIR      PIC X(60).                  HGO0011                     BDLDIR       181
  1435          05 V-SEGPARTFIN-BDLDIR      PIC X(60).                  HGO0011                     BDLDIR       182
  1436          05 V-CIUFIN-BDLDIR          PIC X(20).                  RMB0006                     BDLDIR       183
  1437          05 V-TIPFIN-BDLDIR          PIC X(01).                  RMB0006                     BDLDIR       184
  1438          05 V-FECFIN-BDLDIR          PIC 9(06).                  RMB0006                     BDLDIR       185
  1439          05 V-NUMFIN-BDLDIR          PIC 9(03).                  RMB0006                     BDLDIR       186
  1440          05 V-SUSFIN-BDLDIR          PIC 9(06).                  RMB0006                     BDLDIR       187
  1441          05 V-HASDIRFIN-BDLDIR       PIC X(100).                 RMB0006                     BDLDIR       188
  1442          05 V-PRIDIGFIN-BDLDIR       PIC 9(10).                  RMB0006                     BDLDIR       189
  1443          05 V-VECFIN-BDLDIR          PIC X(12).                  RMB0006                     BDLDIR       190
  1444          05 V-STAFIN-BDLDIR          PIC X(60).                  RMB0006                     BDLDIR       191
  1445          05 V-CALFIN-BDLDIR          PIC 9(03).                  RMB0006                     BDLDIR       192
  1446          05 V-CALFIN-PART1-BDLDIR    PIC 9(03).                  HGO0011                     BDLDIR       193
  1447          05 V-CALFIN-PART2-BDLDIR    PIC 9(03).                  HGO0011                     BDLDIR       194
  1448          05 V-FECULTFIN-BDLDIR       PIC 9(06).                  HGO0008                     BDLDIR       195
  1449          05 V-NUENOMFIN-BDLDIR       PIC 9(01).                  HGO0008                     BDLDIR       196
  1450          05 V-NUMDIRFIN-BDLDIR       PIC X(60).                  HGO0008                     BDLDIR       197
  1451    03 TABLA-DIRFINALESFIN-BDLDIR.                                HGO0008                     BDLDIR       198
  1452       04 T-DIRFINALESFIN-BDLDIR      OCCURS 100 TIMES.           HGO0008                     BDLDIR       199
  1453          05 V-DIRFINFIN-BDLDIR       PIC X(60).                  HGO0008                     BDLDIR       200
  1454          05 V-PRIPARTFINFIN-BDLDIR   PIC X(60).                  HGO0011                     BDLDIR       201
  1455          05 V-SEGPARTFINFIN-BDLDIR   PIC X(60).                  HGO0011                     BDLDIR       202
  1456          05 V-CIUFINFIN-BDLDIR       PIC X(20).                  HGO0008                     BDLDIR       203
  1457          05 V-TIPFINFIN-BDLDIR       PIC X(01).                  HGO0008                     BDLDIR       204
  1458          05 V-FECFINFIN-BDLDIR       PIC 9(06).                  HGO0008                     BDLDIR       205
  1459          05 V-NUMFINFIN-BDLDIR       PIC 9(03).                  HGO0008                     BDLDIR       206
  1460          05 V-SUSFINFIN-BDLDIR       PIC 9(06).                  HGO0008                     BDLDIR       207
  1461          05 V-HASDIRFINFIN-BDLDIR    PIC X(100).                 HGO0008                     BDLDIR       208
  1462          05 V-PRIDIGFINFIN-BDLDIR    PIC 9(10).                  HGO0008                     BDLDIR       209
  1463          05 V-VECFINFIN-BDLDIR       PIC X(12).                  HGO0008                     BDLDIR       210
  1464          05 V-STAFINFIN-BDLDIR       PIC X(60).                  HGO0008                     BDLDIR       211
  1465          05 V-CALFINFIN-BDLDIR       PIC 9(03).                  HGO0008                     BDLDIR       212
  1466          05 V-CALFINFIN-PART1-BDLDIR PIC 9(03).                  HGO0011                     BDLDIR       213
  1467          05 V-CALFINFIN-PART2-BDLDIR PIC 9(03).                  HGO0011                     BDLDIR       214
  1468          05 V-FECULTFINFIN-BDLDIR    PIC 9(06).                  HGO0008                     BDLDIR       215
  1469          05 V-NUENOMFINFIN-BDLDIR    PIC 9(01).                  HGO0008                     BDLDIR       216
  1470          05 V-NUMDIRFINFIN-BDLDIR    PIC X(60).                  HGO0008                     BDLDIR       217
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  27
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1471    03 T-DIRFINALESAUX-BDLDIR.                                    HGO0008                     BDLDIR       218
  1472       04 V-DIRFINAUX-BDLDIR          PIC X(60).                  HGO0008                     BDLDIR       219
  1473       04 V-PRIPARTFINAUX-BDLDIR      PIC X(60).                  HGO0011                     BDLDIR       220
  1474       04 V-SEGPARTFINAUX-BDLDIR      PIC X(60).                  HGO0011                     BDLDIR       221
  1475       04 V-CIUFINAUX-BDLDIR          PIC X(20).                  HGO0008                     BDLDIR       222
  1476       04 V-TIPFINAUX-BDLDIR          PIC X(01).                  HGO0008                     BDLDIR       223
  1477       04 V-FECFINAUX-BDLDIR          PIC 9(06).                  HGO0008                     BDLDIR       224
  1478       04 V-NUMFINAUX-BDLDIR          PIC 9(03).                  HGO0008                     BDLDIR       225
  1479       04 V-SUSFINAUX-BDLDIR          PIC 9(06).                  HGO0008                     BDLDIR       226
  1480       04 V-HASDIRFINAUX-BDLDIR       PIC X(100).                 HGO0008                     BDLDIR       227
  1481       04 V-PRIDIGFINAUX-BDLDIR       PIC 9(10).                  HGO0008                     BDLDIR       228
  1482       04 V-VECFINAUX-BDLDIR          PIC X(12).                  HGO0008                     BDLDIR       229
  1483       04 V-STAFINAUX-BDLDIR          PIC X(60).                  HGO0008                     BDLDIR       230
  1484       04 V-CALFINAUX-BDLDIR          PIC 9(03).                  HGO0008                     BDLDIR       231
  1485       04 V-CALFINAUX-PART1-BDLDIR    PIC 9(03).                  HGO0011                     BDLDIR       232
  1486       04 V-CALFINAUX-PART2-BDLDIR    PIC 9(03).                  HGO0011                     BDLDIR       233
  1487       04 V-FECULTFINAUX-BDLDIR       PIC 9(06).                  HGO0008                     BDLDIR       234
  1488       04 V-NUENOMFINAUX-BDLDIR       PIC 9(01).                  HGO0008                     BDLDIR       235
  1489       04 V-NUMDIRFINAUX-BDLDIR       PIC X(60).                  HGO0008                     BDLDIR       236
  1490    03 TABLA-DIR-BDLDIR.                                          RMB0006                     BDLDIR       237
  1491       04 T-DIR-BDLDIR                OCCURS 100 TIMES.           RMB0006                     BDLDIR       238
  1492          05 T-NUMDIR-BDLDIR .                                    RMB0006                     BDLDIR       239
  1493             06 V-NUMDIR-BDLDIR       OCCURS 10 TIMES PIC 9(5).   RMB0006                     BDLDIR       240
  1494          05 V-CIUDADDIR-BDLDIR       PIC X(20).                  RMB0006                     BDLDIR       241
  1495          05 V-DIRECCION-BDLDIR       PIC X(60).                  RMB0006                     BDLDIR       242
  1496          05 V-TIPODIR-BDLDIR         PIC X(01).                  RMB0006                     BDLDIR       243
  1497          05 V-FECHADIR-BDLDIR        PIC 9(06).                  RMB0006                     BDLDIR       244
  1498          05 V-SUSDIR-BDLDIR          PIC 9(06).                  RMB0006                     BDLDIR       245
  1499          05 V-HASDIR-BDLDIR          PIC X(100).                 RMB0006                     BDLDIR       246
  1500          05 V-PRIDIG-BDLDIR          PIC 9(10).                  RMB0006                     BDLDIR       247
  1501          05 V-FECULT-BDLDIR          PIC 9(06).                  HGO0008                     BDLDIR       248
  1502          05 V-NUENOM-BDLDIR          PIC 9(01) VALUES 0.         HGO0008                     BDLDIR       249
  1503    03   TABLA-FECHADIR-AUX-BDLDIR.                               RMB0006                     BDLDIR       250
  1504          04 O-FECHADIR-AUX-BDLDIR    OCCURS 100 TIMES.           RMB0006                     BDLDIR       251
  1505             05 V-FECHADIR-AUX-BDLDIR PIC 9(06).                  RMB0006                     BDLDIR       252
  1506    03 FECHA-RUTINA-BDLDIR.                                       RMB0006                     BDLDIR       253
  1507       05 ANO-RUTINA-BDLDIR           PIC 9(04).                  RMB0006                     BDLDIR       254
  1508       05 MES-RUTINA-BDLDIR           PIC 9(02).                  RMB0006                     BDLDIR       255
  1509    03 VEC-HIS-BDLDIR                 PIC X(12).                  RMB0006                     BDLDIR       256
  1510    03 NUMDIR-BDLDIR                  PIC X(50).                  RMB0006                     BDLDIR       257
  1511    03 DIRECCION-BDLDIR               PIC X(60).                  HGO0011                     BDLDIR       258
  1512    03 T-CARDIR-BDLDIR.                                           RMB0006                     BDLDIR       259
  1513       04 V-CARDIR-BDLDIR             OCCURS 60 TIMES PIC X(01).  RMB0006                     BDLDIR       260
  1514    03 T-CARTOT-BDLDIR.                                           RMB0006                     BDLDIR       261
  1515       04 V-CARTOT-BDLDIR             OCCURS 10 TIMES PIC 9(05).  RMB0006                     BDLDIR       262
  1516    03 CAR-ANT-BDLDIR                 PIC X(01).                  RMB0006                     BDLDIR       263
  1517    03 CAR-ACT-BDLDIR                 PIC 9(01).                  RMB0006                     BDLDIR       264
  1518    03 FECHA-MEJOR-BDLDIR             PIC 9(06) VALUE 0.          RMB0006                     BDLDIR       265
  1519    03 IND-DIRCER-BDLDIR              PIC 9(01) VALUE 0.          RMB0006                     BDLDIR       266
  1520    03 COMPO                          PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       267
  1521    03 RMAYOR                         PIC 9(01) VALUE 0.          HGO0008                     BDLDIR       268
  1522    03 CAMBIO                         PIC 9(01) VALUE 0.          HGO0008                     BDLDIR       269
  1523    03 NN                             PIC 9(01) VALUE 0.          HGO0008                     BDLDIR       270
  1524    03 CONTA                          PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       271
  1525    03 CONTA1                         PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       272
  1526    03 DIRECCION                      PIC X(60) VALUE SPACES.     HGO0008                     BDLDIR       273
  1527    03 DIRECCION1                     PIC X(60) VALUE SPACES.     HGO0008                     BDLDIR       274
  1528    03 DIRECCION2                     PIC X(60) VALUE SPACES.     HGO0008                     BDLDIR       275
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  28
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1529    03 E-BDLDIR                       PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       276
  1530    03 F-BDLDIR                       PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       277
  1531    03 G-BDLDIR                       PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       278
  1532    03 H-BDLDIR                       PIC 9(05) VALUE 0.          HGO0008                     BDLDIR       279
  1533    03 I-BDLDIR                       PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       280
  1534    03 J-BDLDIR                       PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       281
  1535    03 J1-BDLDIR                      PIC 9(05) VALUE 0.          HGO0011                     BDLDIR       282
  1536    03 J2-BDLDIR                      PIC 9(05) VALUE 0.          HGO0011                     BDLDIR       283
  1537    03 CONTADOR-TEMPORAL-BDLDIR       PIC 9(03).                  HGO0011                     BDLDIR       284
  1538    03 M-BDLDIR                       PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       285
  1539    03 N-BDLDIR                       PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       286
  1540    03 K-BDLDIR                       PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       287
  1541    03 II-BDLDIR                      PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       288
  1542    03 JJ-BDLDIR                      PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       289
  1543    03 NUM-OK-SEND-BDLDIR             PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       290
  1544    03 I-STA-BDLDIR                   PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       291
  1545    03 J-STA-BDLDIR                   PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       292
  1546    03 K-STA-BDLDIR                   PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       293
  1547    03 II-STA-BDLDIR                  PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       294
  1548    03 JJ-STA-BDLDIR                  PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       295
  1549    03 KK-STA-BDLDIR                  PIC 9(05) VALUE 0.          RMB0006                     BDLDIR       296
  1550    03 CALIFICA-DIR-BDLDIR            PIC 9(03) VALUE 0.          RMB0006                     BDLDIR       297
  1551    03 CON-PART-ESTANDARIZADA-BDLDIR  PIC 9(03) VALUE 0.          HGO0011                     BDLDIR       298
  1552    03 CALIFICA-DIRPART1-BDLDIR       PIC 9(03) VALUE 0.          HGO0011                     BDLDIR       299
  1553    03 CALIFICA-DIRPART2-BDLDIR       PIC 9(03) VALUE 0.          HGO0011                     BDLDIR       300
  1554    03 CALIFICA-REAL-BDLDIR           PIC 9(03) VALUE 0.          RMB0006                     BDLDIR       301
  1555    03 CAMPOS-N-DIR-BDLDIR            PIC 9(03) VALUE 0.          RMB0006                     BDLDIR       302
  1556    03 COSI-DIR-BDLDIR                PIC 9(09) VALUE 0.          RMB0006                     BDLDIR       303
  1557    03 RESI-DIR-BDLDIR                PIC 9(09) VALUE 0.          RMB0006                     BDLDIR       304
  1558    03 TELE-DIR-BDLDIR                PIC 9(12) VALUE 0.          RMB0006                     BDLDIR       305
  1559*** NOMBRE DEL ARCHIVO DE DIRECCIONES CERTIFICADAS                RMB0006                     BDLDIR       306
  1560    03 TITLE-BDLSTDCER                PIC X(80) VALUE             RMB0006                     BDLDIR       307
  1561       "$DATABASE/BDLSTDCER".                                     RMB0006                     BDLDIR       308
  1562*** LA SIGUIENTE VARIBALE INDICA EL TIPO DE DATO EN PROCESO ASI:  RMB0006                     BDLDIR       309
  1563*** R - RESIDENCIA                                                RMB0006                     BDLDIR       310
  1564*** L - LABORAL                                                   RMB0006                     BDLDIR       311
  1565*** C - CORRESPONDENCIA                                           RMB0006                     BDLDIR       312
  1566    03 IND-DATO-BDLDIR                PIC X(01).                  RMB0006                     BDLDIR       313
  1567*** VARIABLE QUE CONTIENE LA SUMATORIA DE LOS DIGITOS DE LAS      RMB0006                     BDLDIR       314
  1568*** PARTICULAS NUMERICAS DE UNA DIRECCION                         RMB0006                     BDLDIR       315
  1569    03 SUM-DIGITOS-BDLDIR             PIC 9(10).                  RMB0006                     BDLDIR       316
  1570    03 CAL-TEL-BDLDIR                 PIC 9(03) VALUE 0.          RMB0006                     BDLDIR       317
  1571    02 TELEFONO-BDLDIR                PIC 9(12) VALUE 0.          RMB0006                     BDLDIR       318
  1572***************************VARIABLES DE STANDARIZAR************** RMB0006                     BDLDIR       319
  1573 01 DIRACC-BDLDIR-BDLDIR.                                         RMB0006                     BDLDIR       320
  1574    03 VALIDACION-DIR-OUT-BDLDIR      PIC 9(01).                  RMB0006                     BDLDIR       321
  1575    03 PRIVILEGIO-INPUT-BDLDIR        PIC 9(01).                  RMB0006                     BDLDIR       322
  1576    03 NIT-CONSULTANTE-INPUT-BDLDIR   PIC 9(11).                  RMB0006                     BDLDIR       323
  1577 01  FDA-DIREST-BDLDIR                PIC 9(01).                  RMB0006                     BDLDIR       324
  1578 01  IND-TIPCAR-BDLDIR                PIC X(01).                  RMB0006                     BDLDIR       325
  1579 01  TIPCAR-WS-BDLDIR                 PIC X(01).                  RMB0006                     BDLDIR       326
  1580 01  ENC-DIREST-BDLDIR                PIC 9(01).                  RMB0006                     BDLDIR       327
  1581*01 TABLA-DIR-ESTANDAR-BDLDIR         OCCURS 500 TIMES            RMB0006                     BDLDIR       328
  1582 01 TABLA-DIR-ESTANDAR-BDLDIR         OCCURS 2000 TIMES           PJV0013                     BDLDIR       329
  1583    ASCENDING KEY IS DIR-ORIGINAL-BDLDIR                          RMB0006                     BDLDIR       330
  1584    INDEXED   BY  I-DIR-ESTANDAR-BDLDIR.                          RMB0006                     BDLDIR       331
  1585    03 DIR-ORIGINAL-BDLDIR            PIC X(20).                  RMB0006                     BDLDIR       332
  1586    03 DIR-ESTANDAR-BDLDIR            PIC X(10).                  RMB0006                     BDLDIR       333
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  29
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1587* 01 TABLA-DIR-COMPUESTAS-BDLDIR.                                 RMB0006                     BDLDIR       334
  1588*    03 DIR-COMPUESTAS-AST-BDLDIR      PIC X(20) OCCURS 90 TIMES. RMB0006                     BDLDIR       335
  1589*    03 DIR-COMPUESTAS-BLN-BDLDIR      PIC X(20) OCCURS 90 TIMES. RMB0006                     BDLDIR       336
  1590*    03 DIR-COMPUESTAS-LON-BDLDIR      PIC 9(02) OCCURS 90 TIMES. RMB0006                     BDLDIR       337
  1591*    03 DIR-COMPUESTAS-TIP-BDLDIR      PIC 9(01) OCCURS 90 TIMES. RMB0006                     BDLDIR       338
  1592 01 TABLA-DIR-COMPUESTAS-BDLDIR.                                  PJV0013                     BDLDIR       339
  1593    03 DIR-COMPUESTAS-AST-BDLDIR      PIC X(20) OCCURS 500 TIMES. PJV0013                     BDLDIR       340
  1594    03 DIR-COMPUESTAS-BLN-BDLDIR      PIC X(20) OCCURS 500 TIMES. PJV0013                     BDLDIR       341
  1595    03 DIR-COMPUESTAS-LON-BDLDIR      PIC 9(02) OCCURS 500 TIMES. PJV0013                     BDLDIR       342
  1596    03 DIR-COMPUESTAS-TIP-BDLDIR      PIC 9(01) OCCURS 500 TIMES. PJV0013                     BDLDIR       343
  1597 01 TIP-NUEVA-DIRECCION-BDLDIR.                                   RMB0006                     BDLDIR       344
  1598    03 TIP-NVA-DIR-BDLDIR             PIC X(01) OCCURS 60 TIMES.  RMB0006                     BDLDIR       345
  1599 01 NUEVA-DIRECCION-BDLDIR.                                       RMB0006                     BDLDIR       346
  1600    03 NVA-DIR-BDLDIR                 PIC X(60) OCCURS 60 TIMES.  RMB0006                     BDLDIR       347
  1601 01 DIRECCION-A-ESTANDARIZAR-BDLDIR.                              RMB0006                     BDLDIR       348
  1602    03 DIR-A-EST-BDLDIR               PIC X(01) OCCURS 60 TIMES.  RMB0006                     BDLDIR       349
  1603 01 DIR-A-STD-BDLDIR REDEFINES DIRECCION-A-ESTANDARIZAR-BDLDIR.   CAV0014                     BDLDIR       350
  1604    02 FILLER PIC X(60).                                          CAV0014                     BDLDIR       351
  1605*** VARIABLES QUE CONTIENE LA CIUDAD ORIGINAL                     RMB0006                     BDLDIR       352
  1606 01 CIUDAD-RES-A-ESTANDAR-BDLDIR      PIC X(20).                  RMB0006                     BDLDIR       353
  1607 01 CIUDAD-LAB-A-ESTANDAR-BDLDIR      PIC X(20).                  RMB0006                     BDLDIR       354
  1608 01 CIUDAD-COR-A-ESTANDAR-BDLDIR      PIC X(20).                  RMB0006                     BDLDIR       355
  1609 01 PART-A-ESTANDARIZAR-BDLDIR.                                   RMB0006                     BDLDIR       356
  1610    03 PART-A-ESTAN-BDLDIR            PIC X(01) OCCURS 60 TIMES.  RMB0006                     BDLDIR       357
  1611 01 PART-ESTANDARIZADA-BDLDIR         PIC X(60).                  RMB0006                     BDLDIR       358
  1612 01 PRIPART-ESTANDARIZADA-BDLDIR      PIC X(60).                  HGO0011                     BDLDIR       359
  1613 01 SEGPART-ESTANDARIZADA-BDLDIR      PIC X(60).                  HGO0011                     BDLDIR       360
  1614 01 DIRECCION-ESTANDARIZADA-BDLDIR    PIC X(60).                  RMB0006                     BDLDIR       361
  1615 01 DIRECCION-AUX-BDLDIR              PIC X(60).                  RMB0006                     BDLDIR       362
  1616 01 DIRECCION-62-BDLDIR.                                          RMB0006                     BDLDIR       363
  1617    03 FILLER                         PIC X(01) VALUE SPACES.     RMB0006                     BDLDIR       364
  1618    03 DIRECCION-60-BDLDIR            PIC X(60).                  RMB0006                     BDLDIR       365
  1619    03 FILLER                         PIC X(01) VALUE SPACES.     RMB0006                     BDLDIR       366
  1620 01 DIR-COMPUESTAS-BLN-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006                     BDLDIR       367
  1621 01 DIR-COMPUESTAS-AST-AUX-BDLDIR     PIC X(20) VALUE SPACES.     RMB0006                     BDLDIR       368
  1622 01 CASO-NUMEROLETRA-BDLDIR           PIC 9(01) VALUE 0.          RMB0006                     BDLDIR       369
  1623 01 VAR-RUTINA-NEWDIRBOG-BDLDIR.                                  GJC0007                     BDLDIR       370
  1624    02 LETRA-BDLDIR             PIC X.                            GJC0007                     BDLDIR       371
  1625    02 ORDEN-ASCII-BDLDIR       PIC 9(03) VALUE 0.                GJC0007                     BDLDIR       372
  1626    02 TOTAL-ASCII-BDLDIR       PIC 9(10).                        GJC0007                     BDLDIR       373
  1627    02 NN8-BDLDIR               PIC 9(05).                        GJC0007                     BDLDIR       374
  1628    02 NN9-BDLDIR               PIC 9(05).                        GJC0007                     BDLDIR       375
  1629    02 NN10-BDLDIR              PIC 9(05).                        GJC0007                     BDLDIR       376
  1630    02 I-MEJ-BDLDIR          PIC 9(3) VALUE 0.                    GJC0007                     BDLDIR       377
  1631    02 J-MEJ-BDLDIR          PIC 9(3) VALUE 0.                    GJC0007                     BDLDIR       378
  1632    02 K-MEJ-BDLDIR          PIC 9(3) VALUE 0.                    GJC0007                     BDLDIR       379
  1633*   02 CAR-ANT-BDLDIR        PIC X(1) VALUE SPACES.               GJC0007                     BDLDIR       380
  1634*   02 CAR-ACT-BDLDIR        PIC 9(1) VALUE 0.                    GJC0007                     BDLDIR       381
  1635    02 T-L-BDLDIR.                                                GJC0007                     BDLDIR       382
  1636       03 L-BDLDIR OCCURS 30 TIMES PIC X(20).                     GJC0007                     BDLDIR       383
  1637    02 T-NUMMEJ-BDLDIR.                                           GJC0007                     BDLDIR       384
  1638       04 V-NUMMEJ-BDLDIR    OCCURS 10 TIMES PIC 9(5).            GJC0007                     BDLDIR       385
  1639    02 T-CARMEJ-BDLDIR.                                           GJC0007                     BDLDIR       386
  1640       04 V-CARMEJ-BDLDIR OCCURS 60 TIMES PIC X.                  GJC0007                     BDLDIR       387
  1641    02 T-LETRAS-BDLDIR.                                           GJC0007                     BDLDIR       388
  1642       04 V-LETRAS-BDLDIR OCCURS 200 TIMES PIC X.                 GJC0007                     BDLDIR       389
  1643 01 VAR-NEWDIR.                                                   GJC0007                     BDLDIR       390
  1644    02 OPEN-BDLNEWDIRBOG-BDLDIR     PIC 9 VALUE 0.                GJC0007                     BDLDIR       391
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  30
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.WS)
  1645    02 HAY-BDLNEWDIRBOG-BDLDIR      PIC 9 VALUE 0.                GJC0007                     BDLDIR       392
  1646    02 CIUDAD-BTA-BDLDIR            PIC X(15).                    GJC0007                     BDLDIR       393
  1647    02 DIRECCION-BTA-BDLDIR         PIC X(60).                    GJC0007                     BDLDIR       394
  1648    02 SW-NN                        PIC 9 VALUE 0.                PJV0012                     BDLDIR       395
  1649 01 VAR-EMAIL-BDLDIR.                                             CAV0014                     BDLDIR       396
  1650    02 EMAIL-BDLDIR                 PIC X(60) VALUE SPACES.       CAV0014                     BDLDIR       397
  1651    02 TMP-EMAIL-BDLDIR             PIC X(60) VALUE SPACES.       CAV0014                     BDLDIR       398
  1652    02 ERR-EMAIL-BDLDIR             PIC 9(01) VALUE 0.            CAV0014                     BDLDIR       399
  1653    02 CONT-ESP-INIC-BDLDIR         PIC 9(4) VALUE ZEROS.         CAV0014                     BDLDIR       400
  1654    02 CONT-ARO-BDLDIR              PIC 9(4) VALUE ZEROS.         CAV0014                     BDLDIR       401
  1655    02 CONT-PUN-BDLDIR              PIC 9(4) VALUE ZEROS.         CAV0014                     BDLDIR       402
  1656    02 CONT-ERR-BDLDIR              PIC 9(4) VALUE ZEROS.         CAV0014                     BDLDIR       403
  1657    02 LONG-EMIAL-BDLDIR            PIC 9(4) VALUE ZEROS.         CAV0014                     BDLDIR       404
  1658 01 VAR-CELULAR-BDLDIR.                                           CAV0014                     BDLDIR       405
  1659    02 TEL-CELULAR-BDLDIR           PIC 9(12).                    CAV0014                     BDLDIR       406
  1660    02 ERR-CELULAR-BDLDIR           PIC 9(01) VALUE 0.            CAV0014                     BDLDIR       407
  1661    02 TEL-AUX-CELULAR-BDLDIR       PIC 9(12).                    CAV0014                     BDLDIR       408
  1662    02 FILLER REDEFINES TEL-AUX-CELULAR-BDLDIR.                   CAV0014                     BDLDIR       409
  1663       04 P1-TEL-AUX-CEL-BDLDIR     PIC 9(2).                     CAV0014                     BDLDIR       410
  1664       04 P2-TEL-AUX-CEL-BDLDIR     PIC 9(3).                     CAV0014                     BDLDIR       411
  1665          88 ES-CELULAR-CEL-BDLDIR VALUES 300,301,   *>TIGO       CAV0014                     BDLDIR       412
  1666                                     310,311,312,313,314,320,321, CAV0014                     BDLDIR       413
  1667                                     315,316,317,  *>MOVISTAR     CAV0014                     BDLDIR       414
  1668                                     350,          *>AVANTEL      CAV0014                     BDLDIR       415
  1669                                     302,303,304,305,306,307,308, CAV0014                     BDLDIR       416
  1670                                     309,318,319,322,323,324,325, CAV0014                     BDLDIR       417
  1671                                     351,352,353,354,355. *>ASIGN CAV0014                     BDLDIR       418
  1672     04 P3-TEL-AUX-CEL-BDLDIR        PIC 9(7).                    CAV0014                     BDLDIR       419
  1673                                                                                                           247
  1674******************************************************************                                         248
  1675* Variables para rutina de validacion de identificaciones                                                  249
  1676******************************************************************                                         250
* 1677 copy BDIIVIDE.WS.                                                                                         251
  1678*BDIIVIDE.WS.v03.0003.                                                                        BDIIVIDE       1
  1679*VARIABLES PARA RUTINA DE VALIDACION DE IDENTIFICACIONES                                      BDIIVIDE       2
  1680*----------------------------------------------------------------*                            BDIIVIDE       3
  1681* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR TIPO DE                                   BDIIVIDE       4
  1682* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS.                                BDIIVIDE       5
  1683* FAC0002     * NUIP01 * ESTO SI NO VIENE CORRECTO EL TIPO-ID.                                BDIIVIDE       6
  1684*----------------------------------------------------------------*                            BDIIVIDE       7
  1685* F.CUADROS   * INCLUSION DE VALIDACION PARA TIPO-ID. = 2 y                                   BDIIVIDE       8
  1686* JUL.19/2004 * QUITAR EL DIGITO DE CHEQUEO SI ES EL CASO.                                    BDIIVIDE       9
  1687* FAC0003     *                                                                               BDIIVIDE      10
  1688*----------------------------------------------------------------*                            BDIIVIDE      11
  1689 01  NUM-ID-W-BDIIVIDE.                                                                       BDIIVIDE      12
  1690     03  NUM-ID-W11-BDIIVIDE           PIC 9(11) VALUE ZEROS.     FAC0003                     BDIIVIDE      13
  1691     03  NUM-ID-W11-R-BDIIVIDE REDEFINES NUM-ID-W11-BDIIVIDE.     FAC0003                     BDIIVIDE      14
  1692         05 NUM-ID-W10-BDIIVIDE        PIC 9(10).                 FAC0003                     BDIIVIDE      15
  1693         05 RESTO-NUM-ID-BDIIVIDE      PIC 9.                     FAC0003                     BDIIVIDE      16
  1694 01  NOMBRES-AUX-W-BDIIVIDE.                                                                  BDIIVIDE      17
  1695     03 PRIMER-APELLIDO-BDIIVIDE       PIC X(15) VALUE SPACES.                                BDIIVIDE      18
  1696     03 SEGUNDO-APELLIDO-BDIIVIDE      PIC X(15) VALUE SPACES.                                BDIIVIDE      19
  1697     03 PRIMER-NOMBRE-BDIIVIDE         PIC X(15) VALUE SPACES.                                BDIIVIDE      20
  1698     03 SEGUNDO-NOMBRE-BDIIVIDE        PIC X(15) VALUE SPACES.                                BDIIVIDE      21
  1699     03 NOM-LEIDO-BDIIVIDE             PIC X(65) VALUE SPACES.                                BDIIVIDE      22
  1700                                                                                              BDIIVIDE      23
  1701 01 PARAMETROS-ENTRADA-BDIIVIDE        PIC X(100) VALUE SPACES.   FAC0002                     BDIIVIDE      24
  1702 01 PARAMETROS-ENTRADA-R-BDIIVIDE REDEFINES                                                   BDIIVIDE      25
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  31
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIVIDE.W
  1703                                      PARAMETROS-ENTRADA-BDIIVIDE.                            BDIIVIDE      26
  1704     03 TIP-IDE-BDIIVIDE               PIC X.                                                 BDIIVIDE      27
  1705     03 NUM-IDE-BDIIVIDE               PIC X(11) JUSTIFIED RIGHT.                             BDIIVIDE      28
  1706     03 NUM-IDE-BDIIVIDE-R REDEFINES   NUM-IDE-BDIIVIDE           FAC0002                     BDIIVIDE      29
  1707                                       PIC 9(11).                 FAC0002                     BDIIVIDE      30
  1708     03 NOMBRE-BDIIVIDE                PIC X(65).                                             BDIIVIDE      31
  1709     03 SW-VERIFNOM-BDIIVIDE           PIC 9.                                                 BDIIVIDE      32
  1710     03 NUM-BLOQUES-BDIIVIDE           PIC 9.                                                 BDIIVIDE      33
  1711     03 SW-VALTIPID-BDIIVIDE           PIC 9.                     FAC0002                     BDIIVIDE      34
  1712     03 SW-ASGTIPID-BDIIVIDE           PIC 9.                     FAC0002                     BDIIVIDE      35
  1713     03 SW-DIGCHEQUEO-BDIIVIDE         PIC 9.                     FAC0003                     BDIIVIDE      36
  1714     03 FILLER-BDIIVIDE                PIC X(18).                 FAC0003                     BDIIVIDE      37
  1715                                                                                              BDIIVIDE      38
  1716 01 PARAMETROS-SALIDA-BDIIVIDE.                                                               BDIIVIDE      39
  1717    03 NOM-VAL-BDIIVIDE                PIC X(65) VALUE SPACES.                                BDIIVIDE      40
  1718    03 SW-ID-BDIIVIDE                  PIC 9 VALUE 0.                                         BDIIVIDE      41
  1719    03 SW-NOMBRES-BDIIVIDE             PIC 9 VALUE 0.                                         BDIIVIDE      42
  1720    03 SW-TID-BDIIVIDE                 PIC 9 VALUE 0.             FAC0002                     BDIIVIDE      43
  1721                                                                                                           252
  1722******************************************************************                                         253
  1723* Variables relacionadas con la la base BDIIALE de alertas online                                          254
  1724******************************************************************                                         255
* 1725 copy BDIIALE.WS.                                                                                          256
  1726* BDIIALE-WS.v01.0007                                                                         BDIIALE        1
  1727* VARIABLES RELACIONADAS CON LAS ALERTAS DEL SISTEMA                                          BDIIALE        2
  1728**************************************************************************                    BDIIALE        3
  1729* RMB0002   * TIPALE: CREACION DE DIFERENTES TIPOS DE ALERTA, QUE SE                          BDIIALE        4
  1730* R.MARTINEZ* PUEDEN GENERAR SOBRE DIFERENTES TIPOS DE INFORMACION                            BDIIALE        5
  1731* ABRIL/2006* (ARCHIVOS)                                                                      BDIIALE        6
  1732*************************************************************************                     BDIIALE        7
  1733* RMB0003   * CIU001: AJUSTES PARA MANEJO DE ALERTAS DE CIUDADANOS DE                         BDIIALE        8
  1734* R.MARTINEZ* COLOMBIA.                                                                       BDIIALE        9
  1735* NOV./2006 *                                                                                 BDIIALE       10
  1736*************************************************************************                     BDIIALE       11
  1737* VHF0004     * REFCOM - SE AJUSTA EL TAMAÑO DE LAS LINEAS DE    *                            BDIIALE       12
  1738* VICTOR HUGO *          DETALLE DE ALERTA YA QUE SU TAMAÑO      *                            BDIIALE       13
  1739* FORERO      *          ESTABA DE 81 Y NO DE 80 QUE ES ESTANDAR *                            BDIIALE       14
  1740* OCT.29/2008 *                                                  *                            BDIIALE       15
  1741******************************************************************                            BDIIALE       16
  1742* GJC0005     * LEY001 - SE CAMBIA EL GUIN INICIAL DE LA PRESENTACION                         BDIIALE       17
  1743* G.JIMENEZ   *          DE LA ALEERTA POR UN ESPACIO EN BLANCO. ESTO                         BDIIALE       18
  1744* MARZO 2/2009*          PARA EVITAR QUE SE INTERPRETE COMO ALGO                              BDIIALE       19
  1745*             *          NEGATIVO                                                             BDIIALE       20
  1746******************************************************************                            BDIIALE       21
  1747* RMB0006     * INDE01 - SE AGREGA VARIABLE QUE INDICA QUE YA SE SABE                         BDIIALE       22
  1748* R.MARTINEZ  *          QUE LA OTRA IDENTIFICACION TIENE CUENTAS                             BDIIALE       23
  1749* JUNIO 4/2013*          PORQUE SE DETERMINO ANTES QUE ERA INDEPENDIENTE                      BDIIALE       24
  1750******************************************************************                            BDIIALE       25
  1751 01 VARIABLES-BDIIALE.                                                                        BDIIALE       26
  1752    02 ES-INDEPENDIENTE-BDIIALE           PIC 9(01) VALUE 0.      RMB0006                     BDIIALE       27
  1753    02 MIRO-SIES-INDEPENDIENTE-BDIIALE    PIC 9(01) VALUE 0.      RMB0006                     BDIIALE       28
  1754    02 MAES-BDIIALE-TITLE    PIC X(20)                            RMB0003                     BDIIALE       29
  1755                             VALUE "$DATABASE/BDIIALE".           RMB0003                     BDIIALE       30
  1756    02 EST-BDIIALE           PIC X(02) VALUE "00".                                            BDIIALE       31
  1757    02 FIN-BDIIALE           PIC 9(01) VALUE 0.                                               BDIIALE       32
  1758    02 PROCESAR-BDIIALE      PIC 9(01) VALUE 0.                   RMB0002                     BDIIALE       33
  1759    02 CONT-LINEAS-BDIIALE   PIC 9(03) VALUE 0.                                               BDIIALE       34
  1760    02 ABIERTO-BDIIALE       PIC 9(01) VALUE 0.                                               BDIIALE       35
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  32
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIALE.WS
  1761    02 TIP-IDE-AUX-BDIIALE   PIC 9(01) VALUE 0.                                               BDIIALE       36
  1762    02 NUM-IDE-AUX-BDIIALE   PIC 9(11) VALUE 0.                                               BDIIALE       37
  1763    02 MARCAR-ICBTCO-BDIIALE PIC 9(01) VALUE 0.                   VHF0004                     BDIIALE       38
  1764    02 FECHA-AUX-BDIIALE     PIC 9(08) VALUE 0.                   RMB0003                     BDIIALE       39
  1765    02 FECHA-NOV-AUX-BDIIALE PIC 9(08) VALUE 0.                   RMB0003                     BDIIALE       40
  1766    02 FECHA-VEN-AUX-BDIIALE PIC 9(08) VALUE 0.                   RMB0003                     BDIIALE       41
  1767    02 FECHA-REP-AUX-BDIIALE PIC 9(08) VALUE 0.                   RMB0003                     BDIIALE       42
  1768    02 FUENTE-AUX-BDIIALE    PIC 9(06) VALUE 0.                   RMB0003                     BDIIALE       43
  1769    02 NOMFUE1-AUX-BDIIALE   PIC X(14) VALUE SPACES.              RMB0003                     BDIIALE       44
  1770    02 NOMFUE2-AUX-BDIIALE   PIC X(14) VALUE SPACES.              RMB0003                     BDIIALE       45
  1771    02 CODALE-AUX-BDIIALE    PIC 9(03) VALUE 0.                   RMB0003                     BDIIALE       46
  1772    02 TIPALE-AUX-BDIIALE    PIC X(01) VALUE SPACES.              RMB0003                     BDIIALE       47
  1773    02 TEXTO1-AUX-BDIIALE    PIC X(50) VALUE SPACES.              RMB0003                     BDIIALE       48
  1774    02 TEXTO2-AUX-BDIIALE    PIC X(50) VALUE SPACES.              RMB0003                     BDIIALE       49
  1775    02 INF-DATAHOST-AUX-BDIIALE      PIC X(18) VALUE SPACES.      RMB0003                     BDIIALE       50
  1776    02 PAR-CODBLOALER        PIC 9(1)  VALUE 1.                   RMB0002                     BDIIALE       51
  1777    02 PAR-MSGBLOALER        PIC X(60) VALUE                      RMB0002                     BDIIALE       52
  1778       " ALERTA DADA POR LA ENTIDAD".                             RMB0002                     BDIIALE       53
  1779 01 M-ALERTA.                                                     RMB0002                     BDIIALE       54
  1780    03 V-ALERTA   OCCURS 40 TIMES PIC 9(02).                      RMB0002                     BDIIALE       55
  1781 01 TITULOS-BDIIALE.                                                                          BDIIALE       56
  1782    02 FILLER                PIC X(30) VALUE ALL "=".                                         BDIIALE       57
  1783    02 FILLER    PIC X(20) VALUE "==== [ ALERTAS ] ===".                                      BDIIALE       58
  1784    02 FILLER                PIC X(30) VALUE ALL "=".                                         BDIIALE       59
  1785    02 FILLER    PIC X(20) VALUE "FUENTE           FEC".                                      BDIIALE       60
  1786    02 FILLER    PIC X(20) VALUE "HA           DESCRIP".                                      BDIIALE       61
  1787    02 FILLER    PIC X(20) VALUE "CION                ".                                      BDIIALE       62
  1788    02 FILLER    PIC X(20) VALUE "                    ".                                      BDIIALE       63
  1789    02 FILLER                PIC X(80) VALUE ALL "=".                                         BDIIALE       64
  1790 01 LINEA1-BDIIALE-TIT.                                           RMB0003                     BDIIALE       65
  1791    02 RAYA-BDIIALE          PIC X(01) VALUE " ".                 GJC0005                     BDIIALE       66
  1792    02 NOMFUE-LIN1-BDIIALE   PIC X(14) VALUE SPACES.              RMB0003                     BDIIALE       67
  1793    02 FILLER                PIC X(01) VALUE SPACES.              RMB0003                     BDIIALE       68
  1794    02 FEC-NOV-LIN1-BDIIALE  PIC X(11) VALUE SPACES.              RMB0003                     BDIIALE       69
  1795    02 FILLER                PIC X(01) VALUE SPACES.              RMB0003                     BDIIALE       70
  1796    02 TEXTO-LIN1-BDIIALE    PIC X(50) VALUE SPACES.              RMB0003                     BDIIALE       71
  1797    02 FILLER                PIC X(02) VALUE SPACES.              VHF0004                     BDIIALE       72
  1798 01 LINEA2-BDIIALE-TIT.                                           RMB0003                     BDIIALE       73
  1799    02 FILLER                PIC X(01) VALUE SPACES.              RMB0003                     BDIIALE       74
  1800    02 NOMFUE-LIN2-BDIIALE   PIC X(14) VALUE SPACES.              RMB0003                     BDIIALE       75
  1801    02 FILLER                PIC X(01) VALUE SPACES.              RMB0003                     BDIIALE       76
  1802    02 FILLER                PIC X(11) VALUE SPACES.              RMB0003                     BDIIALE       77
  1803    02 FILLER                PIC X(01) VALUE SPACES.              RMB0003                     BDIIALE       78
  1804    02 TEXTO-LIN2-BDIIALE    PIC X(50) VALUE SPACES.              RMB0003                     BDIIALE       79
  1805    02 FILLER                PIC X(02) VALUE SPACES.              VHF0004                     BDIIALE       80
  1806                                                                                              BDIIALE       81
  1807                                                                                                           257
  1808******************************************************************                                         258
  1809* Datos para las rutinas de validación de nombres                                                          259
  1810******************************************************************                                         260
* 1811 copy LEEMAESTROS.WS.                                                                                      261
  1812*LEEMAESTROS.WS.v.0003.                                                                       LEEMAEST       1
  1813********************************************************************                          LEEMAEST       2
  1814* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA                             LEEMAEST       3
  1815* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA                                    LEEMAEST       4
  1816* AMNISTIA (AMNISTIA21.WS).                                                                   LEEMAEST       5
  1817********************************************************************                          LEEMAEST       6
  1818* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*                        LEEMAEST       7
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  33
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  1819* G.JIMENEZ  *          ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *                        LEEMAEST       8
  1820* MAY 18/2009*                                                       *                        LEEMAEST       9
  1821**********************************************************************                        LEEMAEST      10
  1822* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*                        LEEMAEST      11
  1823* G.JIMENEZ  *          BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *                        LEEMAEST      12
  1824* AGO 25/2009*          NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *                        LEEMAEST      13
  1825*            *          PES,ETC) SI LAS DEBEN TENER EN CUENTA        *                        LEEMAEST      14
  1826**********************************************************************                        LEEMAEST      15
* 1827 COPY BDAMATCH.WS.                                                                            LEEMAEST      16
  1828*BDAMATCH-WS.v.0003.                                                                          BDAMATCH       1
  1829********************************************************************                          BDAMATCH       2
  1830* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR                            BDAMATCH       3
  1831* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS                              BDAMATCH       4
  1832* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.                                                     BDAMATCH       5
  1833********************************************************************                          BDAMATCH       6
  1834* RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE                                 BDAMATCH       7
  1835*         *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO                          BDAMATCH       8
  1836********************************************************************                          BDAMATCH       9
  1837* RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *                          BDAMATCH      10
  1838* R-MARTINEZ. *          DEL PORTAFOLIO .                          *                          BDAMATCH      11
  1839* 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  *                          BDAMATCH      12
  1840*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH          *                          BDAMATCH      13
  1841*             * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *                          BDAMATCH      14
  1842********************************************************************                          BDAMATCH      15
  1843 01 VARIABLES-MAQ.                                                RMB0003                     BDAMATCH      16
  1844     03 I-MAQ                    PIC 9(03)  VALUE 0.              RMB0003                     BDAMATCH      17
  1845     03 J-MAQ                    PIC 9(03)  VALUE 0.              RMB0003                     BDAMATCH      18
  1846     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.              RMB0003                     BDAMATCH      19
  1847     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.         RMB0003                     BDAMATCH      20
  1848     03 NOMBRE-OUTMAQ-OK         PIC X(45)  VALUE SPACES.         RMB0003                     BDAMATCH      21
  1849     03 NOMBRE-INPMAQ-X.                                          RMB0003                     BDAMATCH      22
  1850        04 FILLER                PIC X(02)  VALUE "A ".           RMB0003                     BDAMATCH      23
  1851        04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.         RMB0003                     BDAMATCH      24
  1852     03 PARTICULAS-INPMAQ.                                        RMB0003                     BDAMATCH      25
  1853        04 BASURA-INPMAQ            PIC X(45).                    RMB0003                     BDAMATCH      26
  1854        04 P1-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      27
  1855        04 P2-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      28
  1856        04 P3-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      29
  1857        04 P4-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      30
  1858        04 P5-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      31
  1859        04 P6-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      32
  1860        04 P7-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      33
  1861        04 P8-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      34
  1862        04 P9-INPMAQ                PIC X(45).                    RMB0003                     BDAMATCH      35
  1863        04 P10-INPMAQ               PIC X(45).                    RMB0003                     BDAMATCH      36
  1864 01  SIG-MAQ                     PIC X(1).                        RMB0003                     BDAMATCH      37
  1865     88 SIG-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003                     BDAMATCH      38
  1866 01  ANT-MAQ                     PIC X(1).                        RMB0003                     BDAMATCH      39
  1867     88 ANT-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003                     BDAMATCH      40
  1868 01  ACTUAL-MAQ                  PIC X(1).                        RMB0003                     BDAMATCH      41
  1869     88 TILDE-MAQ   VALUE "Á" "É" "Í" "Ó" "Ú" "á" "é" "í" "ó" "ú".RMB0003                     BDAMATCH      42
  1870     88 QUITAR-MAQ  VALUE  "'" "´"  "`" '"' .                     RMB0003                     BDAMATCH      43
  1871     88 BORRAR-MAQ  VALUE "-" "." "1" "2" "3" "4"                 RMB0003                     BDAMATCH      44
  1872                          "5" "6" "7" "8" "9" '0' ")" "," .       RMB0003                     BDAMATCH      45
  1873     88 ELIMINAR-MAQ VALUE "(" .                                  RMB0003                     BDAMATCH      46
  1874     88 VALIDO-MAQ   VALUE "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"RMB0003                     BDAMATCH      47
  1875                           "K" "L" "M" "N" "O" "P" "Q" "R" "S"    RMB0003                     BDAMATCH      48
  1876                           "T" "U" "V" "W" "X" "Y" "Z" " ".       RMB0003                     BDAMATCH      49
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  34
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.W
  1877 01 LLAVE-AUX11-BDAMATCH.                                                                     BDAMATCH      50
  1878    02  TIPO-ID-AUX11-BDAMATCH    PIC 9(01).                                                  BDAMATCH      51
  1879    02  NUM-ID-AUX11-BDAMATCH     PIC 9(11).                                                  BDAMATCH      52
  1880    02  COD-SUS-AUX11-BDAMATCH    PIC 9(06).                                                  BDAMATCH      53
  1881    02  COD-CTA-AUX11-BDAMATCH    PIC 9(02).                                                  BDAMATCH      54
  1882    02  NUM-CTA-AUX11-BDAMATCH    PIC X(18).                                                  BDAMATCH      55
  1883 01 LLAVE-AUX13-BDAMATCH.                                                                     BDAMATCH      56
  1884    02  TIPO-ID-AUX13-BDAMATCH    PIC 9(01).                                                  BDAMATCH      57
  1885    02  NUM-ID-AUX13-BDAMATCH     PIC 9(13).                                                  BDAMATCH      58
  1886    02  COD-SUS-AUX13-BDAMATCH    PIC 9(06).                                                  BDAMATCH      59
  1887    02  COD-CTA-AUX13-BDAMATCH    PIC 9(02).                                                  BDAMATCH      60
  1888    02  NUM-CTA-AUX13-BDAMATCH    PIC X(18).                                                  BDAMATCH      61
  1889 01 VARIABLES-BDAMATCH.                                                                       BDAMATCH      62
  1890    02 I2-BDAMATCH                PIC 9(2).                       RMB0003                     BDAMATCH      63
  1891    02 TIPCTA-BDAMATCH.                                           RMB0003                     BDAMATCH      64
  1892*******2=CK,1=CR,2=BS,3=CC,4=OT,9=INVALIDO                        RMB0003                     BDAMATCH      65
  1893       03 FILLER PIC X(30) VALUE "211422244444224442444433442444".RMB0003                     BDAMATCH      66
  1894       03 FILLER PIC X(30) VALUE "444444444444444444442999999999".RMB0003                     BDAMATCH      67
  1895       03 FILLER PIC X(30) VALUE "999999999999999999999999999999".RMB0003                     BDAMATCH      68
  1896       03 FILLER PIC X(10) VALUE "9999999999".                    RMB0003                     BDAMATCH      69
  1897    02 FILLER REDEFINES TIPCTA-BDAMATCH.                          RMB0003                     BDAMATCH      70
  1898       03 V-TIPCTA-BDAMATCH  OCCURS 100 TIMES PIC 9.              RMB0003                     BDAMATCH      71
  1899    02 APELLIDO-INPUT-BDAMATCH    PIC X(60) VALUE SPACES.         RMB0003                     BDAMATCH      72
  1900    02 ENT-FIN-PORT-BDAMATCH      PIC 9(3)  VALUE 0.              RMB0003                     BDAMATCH      73
  1901    02 ENT-UNICAS-PORT-BDAMATCH   PIC 9(3)  VALUE 0.              RMB0003                     BDAMATCH      74
  1902    02 ENT-FIN-MEJ-PORT-BDAMATCH  PIC 9(3)  VALUE 0.              RMB0003                     BDAMATCH      75
  1903    02 FALLECIDO-BDAMATCH         PIC 9(01) VALUE 0.              RMB0002                     BDAMATCH      76
  1904    02 IDE-TIPO-BDAMATCH          PIC 9(01) VALUE 0.                                          BDAMATCH      77
  1905    02 ABIERTO-BDAMATCH           PIC 9(01) VALUE 0.                                          BDAMATCH      78
  1906    02 PROCESAR-BDAMATCH          PIC 9(01) VALUE 0.                                          BDAMATCH      79
  1907    02 FIN-BDAMATCH               PIC 9(01) VALUE 0.                                          BDAMATCH      80
  1908    02 NUM-IDE-INPUT-BDAMATCH     PIC 9(11).                                                  BDAMATCH      81
  1909    02 TIP-IDE-INPUT-BDAMATCH     PIC 9(01).                                                  BDAMATCH      82
  1910    02 I-GRU-BDAMATCH             PIC 9(5) VALUE 0.                                           BDAMATCH      83
  1911    02 GRU-NOM-BDAMATCH           PIC 9(5) VALUE 0.                                           BDAMATCH      84
  1912    02 MOVIDO-BDAMATCH            PIC 9(1) VALUE 0.                                           BDAMATCH      85
  1913    02 BUSCADO-D-BDAMATCH.                                                                    BDAMATCH      86
  1914       03 BUSCADO-BDAMATCH        PIC 9(3) VALUE 0.                                           BDAMATCH      87
  1915       03 FILLER                  PIC X(1) VALUE " ".                                         BDAMATCH      88
  1916    02 PORINSERTAR-D-BDAMATCH.                                                                BDAMATCH      89
  1917       03 PORINSERTAR-BDAMATCH    PIC 9(03) VALUE 0.                                          BDAMATCH      90
  1918       03 FILLER                  PIC X(1) VALUE " ".                                         BDAMATCH      91
  1919    02 EXISTE-BDAMATCH            PIC 9(05) VALUE 0.                                          BDAMATCH      92
  1920    02 MEJOR-PORTAFOLIO-BDAMATCH  PIC 9(05) VALUE 0.                                          BDAMATCH      93
  1921    02 GRU-ANT-BDAMATCH           PIC 9(05) VALUE 0.                                          BDAMATCH      94
  1922    02 MAX-CUENTAS-BDAMATCH       PIC 9(05) VALUE 5.                                          BDAMATCH      95
  1923    02 MAX-REL-BDAMATCH           PIC 9(05) VALUE 5.                                          BDAMATCH      96
  1924    02 MAXREL-PER-BDAMATCH        PIC 9(05) VALUE 0.                                          BDAMATCH      97
  1925    02 FIN-FUENTE-BDAMATCH        PIC 9(05) VALUE 0.                                          BDAMATCH      98
  1926    02 FIL-BUS-BDAMATCH           PIC 9(05) VALUE 0.                                          BDAMATCH      99
  1927    02 COL-BUS-BDAMATCH           PIC 9(05) VALUE 0.                                          BDAMATCH     100
  1928    02 FIN-BUSCADO-BDAMATCH       PIC 9(05) VALUE 0.                                          BDAMATCH     101
  1929    02 LIBRE-BUSCADO-BDAMATCH     PIC 9(05) VALUE 0.                                          BDAMATCH     102
  1930    02 FIL-FUE-BDAMATCH           PIC 9(05) VALUE 0.                                          BDAMATCH     103
  1931    02 COL-FUE-BDAMATCH           PIC 9(05) VALUE 0.                                          BDAMATCH     104
  1932    02 I-BDAMATCH                 PIC 9(08) VALUE 0.                                          BDAMATCH     105
  1933    02 J-BDAMATCH                 PIC 9(08) VALUE 0.                                          BDAMATCH     106
  1934    02 I-DIR-BDAMATCH             PIC 9(05) VALUE 0.                                          BDAMATCH     107
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  35
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.W
  1935    02 I-TEL-BDAMATCH             PIC 9(05) VALUE 0.                                          BDAMATCH     108
  1936    02 I-NOM-BDAMATCH             PIC 9(05) VALUE 0.                                          BDAMATCH     109
  1937    02 I-CTA-BDAMATCH             PIC 9(05) VALUE 0.                                          BDAMATCH     110
  1938    02 NUM-DIR-ANT-BDAMATCH       PIC X(50).                                                  BDAMATCH     111
  1939    02 NUM-TEL-ANT-BDAMATCH       PIC 9(15).                                                  BDAMATCH     112
  1940    02 CTA-DIR-ANT-BDAMATCH       PIC 9(05).                                                  BDAMATCH     113
  1941    02 CTA-TEL-ANT-BDAMATCH       PIC 9(05).                                                  BDAMATCH     114
  1942    02 CTA-NOM-ANT-BDAMATCH       PIC 9(05).                                                  BDAMATCH     115
  1943    02 GRU-NOM-ANT-BDAMATCH       PIC 9(05).                                                  BDAMATCH     116
  1944    02 TABLA-DIR-BDAMATCH.                                                                    BDAMATCH     117
  1945       03 T-DIR-BDAMATCH OCCURS 501 TIMES.                                                    BDAMATCH     118
  1946          04 CTA-DIR-BDAMATCH     PIC 9(03).                                                  BDAMATCH     119
  1947          04 NUM-DIR-BDAMATCH     PIC X(50).                                                  BDAMATCH     120
  1948          04 NUM-CTAS-DIR-BDAMATCH PIC 9(03).                                                 BDAMATCH     121
  1949          04 SUS-DIR-BDAMATCH     PIC 9(06).                                                  BDAMATCH     122
  1950          04 LNG-DIR-BDAMATCH     PIC 9(03).                                                  BDAMATCH     123
  1951    02 TABLA-TEL-BDAMATCH.                                                                    BDAMATCH     124
  1952       03 T-TEL-BDAMATCH   OCCURS 501 TIMES.                                                  BDAMATCH     125
  1953          04 CTA-TEL-BDAMATCH     PIC 9(03).                                                  BDAMATCH     126
  1954          04 NUM-TEL-BDAMATCH     PIC 9(15).                                                  BDAMATCH     127
  1955          04 NUM-CTAS-TEL-BDAMATCH PIC 9(03).                                                 BDAMATCH     128
  1956          04 SUS-TEL-BDAMATCH     PIC 9(06).                                                  BDAMATCH     129
  1957    02 TABLA-NOM-BDAMATCH.                                                                    BDAMATCH     130
  1958       03 T-NOM-BDAMATCH OCCURS 501 TIMES.                                                    BDAMATCH     131
  1959          04 CTA-NOM-BDAMATCH     PIC 9(03).                                                  BDAMATCH     132
  1960          04 NOM-NOM-BDAMATCH     PIC X(60).                                                  BDAMATCH     133
  1961          04 SUS-NOM-BDAMATCH     PIC 9(06).                                                  BDAMATCH     134
  1962          04 GRU-NOMS-BDAMATCH     PIC 9(03).                                                 BDAMATCH     135
  1963          04 LNG-NOM-BDAMATCH     PIC 9(02).                                                  BDAMATCH     136
  1964    02 TABLA-CUENTAS-BDAMATCH.                                                                BDAMATCH     137
  1965       03 T-CUENTAS-BDAMATCH OCCURS 501 TIMES.                                                BDAMATCH     138
  1966          04 CTA-CUENTAS-BDAMATCH PIC X(38).                                                  BDAMATCH     139
  1967          04 CTA-FALLECIDO-BDAMATCH   PIC 9(1).                   RMB0002                     BDAMATCH     140
  1968          04 FUEEXT-CUENTAS-BDAMATCH   PIC 9(1).                  RMB0003                     BDAMATCH     141
  1969    02 TABLA-GRUNOM-BDAMATCH.                                                                 BDAMATCH     142
  1970       03 T-GRUNOM-BDAMATCH OCCURS 501 TIMES.                                                 BDAMATCH     143
  1971          04 GRUPO-GRUNOM-BDAMATCH PIC 9(03).                                                 BDAMATCH     144
  1972          04 NOM-GRUNOM-BDAMATCH   PIC X(60).                                                 BDAMATCH     145
  1973          04 NUM-CTAS-GRUNOM-BDAMATCH PIC 9(03).                                              BDAMATCH     146
  1974          04 LNG-GRUNOM-BDAMATCH   PIC 9(02).                                                 BDAMATCH     147
  1975          04 APE-GRUNOM-BDAMATCH   PIC 9(03).                     RMB0003                     BDAMATCH     148
  1976    02  WS-PESOS-CUENTAS-BDAMATCH.                                                            BDAMATCH     149
  1977      03  ESTA-CTA-BDAMATCH        PIC  9(01)  VALUE  ZEROS.                                  BDAMATCH     150
  1978      03  INV-BDAMATCH             PIC 9(04) VALUE ZEROS.                                     BDAMATCH     151
  1979      03  SUSC-CTAS-BDAMATCH       PIC 9(06) VALUE ZEROS.                                     BDAMATCH     152
  1980      03  SUSC-GRUPO-BDAMATCH.                                                                BDAMATCH     153
  1981        05  SUSC-GRUP-SUS-BDAMATCH PIC  9(06)  VALUE  ZEROS.                                  BDAMATCH     154
  1982        05  SUSC-GRUP-GRU-BDAMATCH PIC  9(03)  VALUE  ZEROS.                                  BDAMATCH     155
  1983      03  PESO-CTAS-TOT-BDAMATCH   PIC 9(12) VALUE ZEROS.                                     BDAMATCH     156
  1984      03  PESOS-CTRL-BDAMATCH      PIC 9(12) VALUE ZEROS.                                     BDAMATCH     157
  1985      03  NOM-LIMPI-BDAMATCH       PIC X(60) VALUE SPACES.                                    BDAMATCH     158
  1986      03  CTA-A-BUSCAR-BDAMATCH    PIC 9(03) VALUE ZEROS.                                     BDAMATCH     159
  1987      03  PESO-TEL-BDAMATCH        PIC 9(02) VALUE 1.                                         BDAMATCH     160
  1988      03  PESO-DIR-BDAMATCH        PIC 9(02) VALUE 3.                                         BDAMATCH     161
  1989      03  PESO-NOM-BDAMATCH        PIC 9(02) VALUE 9.                                         BDAMATCH     162
  1990      03  POSIC-TEL-BDAMATCH       PIC 9(02) VALUE ZEROS.                                     BDAMATCH     163
  1991      03  POSIC-DIR-BDAMATCH       PIC 9(02) VALUE ZEROS.                                     BDAMATCH     164
  1992      03  POSIC-NOM-BDAMATCH       PIC 9(02) VALUE ZEROS.                                     BDAMATCH     165
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  36
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.W
  1993      03  POSIC-GRU-BDAMATCH       PIC 9(02) VALUE ZEROS.                                     BDAMATCH     166
  1994      03  NRO-VECES-1-BDAMATCH     PIC 9(03) VALUE ZEROS.                                     BDAMATCH     167
  1995      03  NRO-VECES-2-BDAMATCH     PIC 9(03) VALUE ZEROS.                                     BDAMATCH     168
  1996      03  NRO-VECES-3-BDAMATCH     PIC 9(03) VALUE ZEROS.                                     BDAMATCH     169
  1997      03  POSIC-SUMA-BDAMATCH      PIC 9(03) VALUE ZEROS.                                     BDAMATCH     170
  1998      03  POSIC-SUSC-BDAMATCH      PIC 9(03) VALUE ZEROS.                                     BDAMATCH     171
  1999      03  POSIC-SUS-GRU-BDAMATCH   PIC 9(03) VALUE ZEROS.                                     BDAMATCH     172
  2000 01 V-INTERRELAC-BDAMATCH.                                                                    BDAMATCH     173
  2001    02 CARAC-REL-BDAMATCH  OCCURS 501 TIMES PIC X(03).                                        BDAMATCH     174
  2002    02 FILA-REL-BDAMATCH OCCURS 501 TIMES.                                                    BDAMATCH     175
  2003       03 COLUMNA-REL-BDAMATCH OCCURS 501 TIMES.                                              BDAMATCH     176
  2004          04 CAJA-BDAMATCH         PIC 9(03).                                                 BDAMATCH     177
  2005          04 DELIMITADOR-BDAMATCH  PIC X(01).                                                 BDAMATCH     178
  2006 01 VARIABLES-NOMBRES-BDAMATCH.                                                               BDAMATCH     179
  2007    03 LIM-BDAMATCH                PIC  9(03) VALUE 500.                                      BDAMATCH     180
  2008    03 DIR-INPUT-BDAMATCH          PIC  X(60).                                                BDAMATCH     181
  2009    03 DIR-OUTPUT-BDAMATCH         PIC  X(60).                                                BDAMATCH     182
  2010    03 CTA-INPUT-BDAMATCH          PIC  X(38).                                                BDAMATCH     183
  2011    03 TEL-INPUT-BDAMATCH          PIC  9(15).                                                BDAMATCH     184
  2012    03 TEL-OUTPUT-BDAMATCH         PIC  9(15).                                                BDAMATCH     185
  2013    03 NOM-INPUT-BDAMATCH          PIC  X(60).                                                BDAMATCH     186
  2014    03 NOM-OUTPUT-BDAMATCH         PIC  X(60).                                                BDAMATCH     187
  2015    03 NUM-MUERTOS-OUTPUT-BDAMATCH PIC  9(03).                    RMB0002                     BDAMATCH     188
  2016    03 NUM-CTAS-OUTPUT-BDAMATCH    PIC  9(03).                    RMB0002                     BDAMATCH     189
  2017    03 VALCTA-OUTPUT-BDAMATCH      PIC  9(01).                                                BDAMATCH     190
  2018    03 CAR-ANT-BDAMATCH            PIC  X(01).                                                BDAMATCH     191
  2019    03 CAR-ACT-BDAMATCH            PIC  9(01).                                                BDAMATCH     192
  2020    03 T-CARDIR-BDAMATCH.                                                                     BDAMATCH     193
  2021       04 V-CARDIR-BDAMATCH       OCCURS 60 TIMES PIC X(01).                                  BDAMATCH     194
  2022    03 T-CARTOT-BDAMATCH.                                                                     BDAMATCH     195
  2023       04 V-CARTOT-BDAMATCH       OCCURS 10 TIMES PIC 9(05).                                  BDAMATCH     196
  2024 01  TABLA-SUSC-DIR-BDAMATCH.                                                                 BDAMATCH     197
  2025   03  REG-SUSC-DIR-BDAMATCH   OCCURS 501 TIMES                                               BDAMATCH     198
  2026       ASCENDING KEY IS COD-SUSC-DIR-BDAMATCH  INDEXED BY                                     BDAMATCH     199
  2027                                               IND-DIR-BDAMATCH.                              BDAMATCH     200
  2028     05  COD-SUSC-DIR-BDAMATCH     PIC 9(06).                                                 BDAMATCH     201
  2029     05  FLAG-YA-CTA-BDAMATCH      PIC 9(01).                                                 BDAMATCH     202
  2030     05  FLAG-YA-DIR-BDAMATCH      PIC 9(01).                                                 BDAMATCH     203
  2031     05  FLAG-YA-TEL-BDAMATCH      PIC 9(01).                                                 BDAMATCH     204
  2032     05  FLAG-YA-NOM-BDAMATCH      PIC 9(01).                                                 BDAMATCH     205
  2033 01  TABLA-SUSC-NOMBRE-BDAMATCH.                                                              BDAMATCH     206
  2034   03  REG-SUSC-NOM-BDAMATCH        OCCURS 501 TIMES                                          BDAMATCH     207
  2035       ASCENDING  KEY  IS  KEY-SUSC-NOM-BDAMATCH  INDEXED                                     BDAMATCH     208
  2036                           BY IND-NOM-BDAMATCH.                                               BDAMATCH     209
  2037     05  KEY-SUSC-NOM-BDAMATCH.                                                               BDAMATCH     210
  2038       07  COD-SUSC-NOM-BDAMATCH   PIC 9(06).                                                 BDAMATCH     211
  2039       07  GRUPO-SUS-NOM-BDAMATCH  PIC 9(03).                                                 BDAMATCH     212
* 2040 COPY AMNISTIA21.WS.                                                                          LEEMAEST      17
  2041* AMNISTIA21.v.0004                                                                           AMNISTIA       1
  2042*******************************************************************                           AMNISTIA       2
  2043* VARIABLES DEFINIDAS PARA APLICACION DE LEYES, AMNISTIA, PARA                                AMNISTIA       3
  2044* CLEENTES SEGUN FECHA DE PROMULGACION DE LA LEY                                              AMNISTIA       4
  2045*******************************************************************                           AMNISTIA       5
  2046* JGR  FECHA:20/08/2007 06:19:07 p.m.                                                         AMNISTIA       6
  2047* CAV  FECHA:16/01/2008                                                                       AMNISTIA       7
  2048******************************************************************                            AMNISTIA       8
  2049* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*                            AMNISTIA       9
  2050* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *                            AMNISTIA      10
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  37
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2051* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *                            AMNISTIA      11
  2052******************************************************************                            AMNISTIA      12
  2053* GJC0003    | LEY002 - DEFINICIONES PARA APLICACION DE LEY DEFINI*                           AMNISTIA      13
  2054* G. JIMENEZ |  TIVO. DOBLE EL TIEMPODE LA MORA                   *                           AMNISTIA      14
  2055* 23-ENE-2009|                                                    *                           AMNISTIA      15
  2056*******************************************************************                           AMNISTIA      16
  2057* GJC0004    | CADUC1 - SE DEFINEN LAS VARIABLES NECESARIAS PARA  *                           AMNISTIA      17
  2058* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE  *                           AMNISTIA      18
  2059* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13         *                           AMNISTIA      19
  2060*******************************************************************                           AMNISTIA      20
  2061 01  ABD07-AMNIST21             PIC  X(220) VALUE SPACES.                                     AMNISTIA      21
  2062 01  MESES-FALTAN-AMNIST21      PIC  9(03)  VALUE 999.                                        AMNISTIA      22
  2063 01  FECHA-INI-AMNIST21         PIC 9(06) VALUE ZEROS.                                        AMNISTIA      23
  2064 01  FECHA-INI-AMNIST21-R REDEFINES FECHA-INI-AMNIST21.                                       AMNISTIA      24
  2065     03 ANO-INI-AMNIST21        PIC 9(04).                                                    AMNISTIA      25
  2066     03 MES-INI-AMNIST21        PIC 9(02).                                                    AMNISTIA      26
  2067 01  VERSION-AMNIST21           PIC 9      VALUE ZEROS.                                       AMNISTIA      27
  2068 01  MESES-GRACIA-AMNIST21      PIC 9(02)  VALUE 06.                                          AMNISTIA      28
  2069 01  MESES-CANCELAC-AMNIST21    PIC 9(02)  VALUE 12.                                          AMNISTIA      29
  2070                                                                                              AMNISTIA      30
  2071 01  WORK-CLIENTE-AMNIST21.                                                                   AMNISTIA      31
  2072     03 CTAS-MEN12-AMNIST21     PIC  9(01) VALUE ZEROS.                                       AMNISTIA      32
  2073     03 CTAS-MAY12-AMNIST21     PIC  9(01) VALUE ZEROS.                                       AMNISTIA      33
  2074     03 MESES-NOV-AMNIST21      PIC  9(04) VALUE ZEROS.                                       AMNISTIA      34
  2075     03 MESES-VEC-AMNIST21      PIC  9(04) VALUE ZEROS.                                       AMNISTIA      35
  2076     03 MESES-GRC-AMNIST21      PIC  9(04) VALUE ZEROS.                                       AMNISTIA      36
  2077     03 MORAS-ACTUAL-AMNIST21   PIC  9(05) VALUE ZEROS.                                       AMNISTIA      37
  2078     03 TIPO-ID-MAES-AMNIST21   PIC  9(01) VALUE ZEROS.                                       AMNISTIA      38
  2079     03 NUM-ID-MAES-AMNIST21    PIC  9(11) VALUE ZEROS.                                       AMNISTIA      39
  2080     03 K-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003                     AMNISTIA      40
  2081     03 L-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003                     AMNISTIA      41
  2082     03 M-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003                     AMNISTIA      42
  2083     03 X-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003                     AMNISTIA      43
  2084     03 Z-AMNIST21              PIC  9(03)  VALUE ZEROS.          GJC0003                     AMNISTIA      44
  2085     03 IND-APLICO-CAD-AMNIST21 PIC  9(01) VALUE ZEROS.           GJC0004                     AMNISTIA      45
  2086     03 FEC-NOVEDAD-AMNIST21.                                                                 AMNISTIA      46
  2087        05 ANO-NOV-AMNIST21     PIC  9(04) VALUE ZEROS.                                       AMNISTIA      47
  2088        05 MES-NOV-AMNIST21     PIC  9(02) VALUE ZEROS.                                       AMNISTIA      48
  2089     03 FECHA-AUX-AMNIST21      PIC  9(04).                                                   AMNISTIA      49
  2090     03 FECHA-AUX-AMNIST21-R REDEFINES FECHA-AUX-AMNIST21.                                    AMNISTIA      50
  2091        05 MES-AUX-AMNIST21     PIC  9(02).                                                   AMNISTIA      51
  2092        05 ANO-AUX-AMNIST21     PIC  9(02).                                                   AMNISTIA      52
  2093*---------------------------------------------------------------*                             AMNISTIA      53
  2094 01  LLAVE-INI-AMNIST21.                                                                      AMNISTIA      54
  2095     03 TIPO-ID-AMNIST21        PIC  9.                                                       AMNISTIA      55
  2096     03 NUM-ID-AMNIST21         PIC  9(11).                                                   AMNISTIA      56
  2097     03 COD-SUS-AMNIST21        PIC  9(6).                                                    AMNISTIA      57
  2098     03 COD-CTA-AMNIST21        PIC  99.                                                      AMNISTIA      58
  2099     03 NUM-CTA-AMNIST21        PIC  X(18).                                                   AMNISTIA      59
  2100*---------------------------------------------------------------*                             AMNISTIA      60
  2101 01  REG-SUSCRIPTOR-AMNISTIA21  PIC X(220).                                                   AMNISTIA      61
  2102*01  SW-CANDIDATO-AMNIST21      PIC 9(01) VALUE ZEROS.            GJC0003                     AMNISTIA      62
  2103*---------------------------------------------------------------*                             AMNISTIA      63
  2104 01  MUMERO-ID-AMNIST21.                                                                      AMNISTIA      64
  2105     03 SW-AMNIST21             PIC  9(01) VALUE ZEROS.                                       AMNISTIA      65
  2106     03 SW-SALIR-VECT           PIC  9(01) VALUE ZEROS.                                       AMNISTIA      66
  2107     03 TIPO-ID-INI-AMNIST21    PIC  9(01) VALUE ZEROS.                                       AMNISTIA      67
  2108     03 NUME-ID-INI-AMNIST21    PIC  9(11) VALUE ZEROS.                                       AMNISTIA      68
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  38
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2109*---------------------------------------------------------------*                             AMNISTIA      69
  2110 01  FECHA-MILENIO-AMNIST21.                                                                  AMNISTIA      70
  2111     03 FMILENIO-SIGLO-AMNIST21 PIC  9(02).                                                   AMNISTIA      71
  2112     03 FMILENIO-ANIO-AMNIST21  PIC  9(02).                                                   AMNISTIA      72
  2113     03 FMILENIO-MES-AMNIST21   PIC  9(02).                                                   AMNISTIA      73
  2114*---------------------------------------------------------------*                             AMNISTIA      74
  2115*   PRUEBAS  FECHA 200608                                       *                             AMNISTIA      75
  2116*---------------------------------------------------------------*                             AMNISTIA      76
  2117 01  FECHA-HOY-AMNIST21         PIC X(08).                                                    AMNISTIA      77
  2118 01  FECHA-HOY-AMNIST21-R  REDEFINES FECHA-HOY-AMNIST21.                                      AMNISTIA      78
  2119     03 FECHA-SYS-AMNIST21.                                                                   AMNISTIA      79
  2120        05 ANO-HOY-AMNIST21     PIC 9(04).                                                    AMNISTIA      80
  2121        05 MES-HOY-AMNIST21     PIC 9(02).                                                    AMNISTIA      81
  2122     03 DIA-HOY-AMNIST21        PIC 9(02).                                                    AMNISTIA      82
  2123*---------------------------------------------------------------*                             AMNISTIA      83
  2124 01  FECHA-GRACIA-AMNIST21.                                                                   AMNISTIA      84
  2125     05 ANO-GRACIA-AMNIST21     PIC  9(04) VALUE ZEROS.                                       AMNISTIA      85
  2126     05 MES-GRACIA-AMNIST21     PIC  9(02) VALUE ZEROS.                                       AMNISTIA      86
  2127*---------------------------------------------------------------                              AMNISTIA      87
  2128 01  VECTOR-AMNISTA21.                                                                        AMNISTIA      88
  2129     03 VECTOR1-AMNIST21        PIC 9(12) VALUE ZEROS.                                        AMNISTIA      89
  2130     03 VECTOR2-AMNIST21        PIC 9(12) VALUE ZEROS.                                        AMNISTIA      90
  2131     03 VECTOR3-AMNIST21        PIC 9(12) VALUE ZEROS.                                        AMNISTIA      91
  2132     03 VECTOR4-AMNIST21        PIC 9(12) VALUE ZEROS.                                        AMNISTIA      92
  2133*---------------------------------------------------------------                              AMNISTIA      93
  2134 01  VECT-AMNIST21.                                                                           AMNISTIA      94
  2135     03 VECT1-AMNIST21          PIC 9(12).                                                    AMNISTIA      95
  2136     03 VECT2-AMNIST21          PIC 9(12).                                                    AMNISTIA      96
  2137     03 VECT3-AMNIST21          PIC 9(12).                                                    AMNISTIA      97
  2138     03 VECT4-AMNIST21          PIC 9(12).                                                    AMNISTIA      98
  2139     03 HISTORIA-TOTAL-AMNIST21.                                                              AMNISTIA      99
  2140        05 VECTOR-TOT-AMNIST21  PIC X(48).                                                    AMNISTIA     100
  2141     03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.                                             AMNISTIA     101
  2142        05 V-VEC-AMNIST21  OCCURS 48 TIMES PIC X.                                             AMNISTIA     102
  2143*---------------------------------------------------------------                              AMNISTIA     103
  2144*TABLA QUE IDENTIFICA EL ESTADO DEL REGISTRO POR LA NOVEDAD                                   AMNISTIA     104
  2145* 0-OBLIGACION CANCELADA                                                                      AMNISTIA     105
  2146* 1-OBLIGACIONES ABIERTAS                                                                     AMNISTIA     106
  2147*---------------------------------------------------------------                              AMNISTIA     107
  2148 01  TAB-VIGENTES-AMNIST21.                                                                   AMNISTIA     108
  2149     03 TABLA-VIGENTES-AMNIST21.                                                              AMNISTIA     109
  2150        05 FILLER        PIC X(10)   VALUE  "1000000000".                                     AMNISTIA     110
  2151        05 FILLER        PIC X(10)   VALUE  "0011111111".                                     AMNISTIA     111
  2152        05 FILLER        PIC X(10)   VALUE  "1111111111".                                     AMNISTIA     112
  2153        05 FILLER        PIC X(10)   VALUE  "1111111111".                                     AMNISTIA     113
  2154        05 FILLER        PIC X(10)   VALUE  "1111101101".                                     AMNISTIA     114
  2155     03 TABLA-VIGENTES-AMNIST21-R REDEFINES                                                   AMNISTIA     115
  2156        TABLA-VIGENTES-AMNIST21.                                                              AMNISTIA     116
  2157        05 TAB-VIG-CART-AMNIST21   OCCURS 50 TIMES  PIC 9(01).                                AMNISTIA     117
  2158*---------------------------------------------------------------*                             AMNISTIA     118
  2159 01  TABLAS-CR-AMNIST21.                                                                      AMNISTIA     119
  2160     03 TABLA-NOV-CAR-AMNIST21.                                   GJC0003                     AMNISTIA     120
  2161        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     121
  2162            "01 01 5 AL DIA         1718192001 5".                GJC0003                     AMNISTIA     122
  2163        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     123
  2164            "02 02 5 TDC NO RECLAMAD0000000000 0".                GJC0003                     AMNISTIA     124
  2165        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     125
  2166            "08 03 5 TDC CANC.MALMAN0000000000 0".                GJC0003                     AMNISTIA     126
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  39
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2167        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     127
  2168            "04 04 5 TDC ROBADA     0000000000 0".                GJC0003                     AMNISTIA     128
  2169        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     129
  2170            "05 05 5 CANCEL.VOLUNTAR0000000000 0".                GJC0003                     AMNISTIA     130
  2171        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     131
  2172            "06 06 5 CANCEL.MMX<60  0000000000 0".                GJC0003                     AMNISTIA     132
  2173        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     133
  2174            "07 07 5 TDC EXTRAVIADA 0000000000 0".                GJC0003                     AMNISTIA     134
  2175        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     135
  2176            "03 08 5 PAGO VOLUNT.SAT0000000000 0".                GJC0003                     AMNISTIA     136
  2177        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     137
  2178            "03 09 5 PAGO.MMX.A.30  09EEEEEE08 0".                GJC0003                     AMNISTIA     138
  2179        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     139
  2180            "03 10 5 PAGO.MMX.A.60  0910EEEE08 0".                GJC0003                     AMNISTIA     140
  2181        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     141
  2182            "03 11 5 PAGO.MORA.90   091011EE08 0".                GJC0003                     AMNISTIA     142
  2183        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     143
  2184            "03 12 5 PAGO.VOL.MOR1200910111208 0".                GJC0003                     AMNISTIA     144
  2185        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     145
  2186            "01 13 5 MORA.30.AL.DIA 1727282913 1".                GJC0003                     AMNISTIA     146
  2187        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     147
  2188            "01 14 5 MORA.60.AL.DIA 3031323314 2".                GJC0003                     AMNISTIA     148
  2189        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     149
  2190            "01 15 5 MORA.90.AL.DIA 3435363715 3".                GJC0003                     AMNISTIA     150
  2191        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     151
  2192            "01 16 5 MORA.120.AL.DIA3839404116 4".                GJC0003                     AMNISTIA     152
  2193        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     153
  2194            "12 17 1 ESTA.MORA.30   1718192013 1".                GJC0003                     AMNISTIA     154
  2195        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     155
  2196            "13 18 2 ESTA.MORA.60   2118192014 2".                GJC0003                     AMNISTIA     156
  2197        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     157
  2198            "14 19 3 ESTA.MORA.90   2223192015 3".                GJC0003                     AMNISTIA     158
  2199        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     159
  2200            "15 20 4 ESTA.MORA.120  2425262016 4".                GJC0003                     AMNISTIA     160
  2201        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     161
  2202            "12 21 1 FU.60.Y.ESTA.302118192014 2".                GJC0003                     AMNISTIA     162
  2203        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     163
  2204            "12 22 1 FU.90.Y.ESTA.302223192015 3".                GJC0003                     AMNISTIA     164
  2205        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     165
  2206            "13 23 2 FU.90.Y.ESTA.602223192015 3".                GJC0003                     AMNISTIA     166
  2207        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     167
  2208            "12 24 1 FU.120.ESTA.30 2425262016 4".                GJC0003                     AMNISTIA     168
  2209        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     169
  2210            "13 25 2 FU.120.ESTA.60 2425262016 4".                GJC0003                     AMNISTIA     170
  2211        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     171
  2212            "14 26 3 FU.120.ESTA.90 2425262016 4".                GJC0003                     AMNISTIA     172
  2213        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     173
  2214            "13 27 2 RE.30.ESTA.60  2127282914 2".                GJC0003                     AMNISTIA     174
  2215        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     175
  2216            "14 28 3 RE.30.Y.ESTA.902223282915 3".                GJC0003                     AMNISTIA     176
  2217        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     177
  2218            "15 29 4 RE.30.ESTA.120 2425262916 4".                GJC0003                     AMNISTIA     178
  2219        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     179
  2220            "12 30 1 RE.60.Y.ESTA.303031323314 2".                GJC0003                     AMNISTIA     180
  2221        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     181
  2222            "13 31 2 RE.60.Y.ESTA.602131323314 2".                GJC0003                     AMNISTIA     182
  2223        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     183
  2224            "14 32 3 RE.60.Y.ESTA.902223323315 3".                GJC0003                     AMNISTIA     184
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  40
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2225        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     185
  2226            "15 33 4 RE.60.ESTA.120 2425263316 4".                GJC0003                     AMNISTIA     186
  2227        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     187
  2228            "12 34 1 RE.90.Y.ESTA.303435363715 3".                GJC0003                     AMNISTIA     188
  2229        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     189
  2230            "13 35 2 RE.90.Y.ESTA.603435363715 3".                GJC0003                     AMNISTIA     190
  2231        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     191
  2232            "14 36 3 RE.90.Y.ESTA.902223363715 3".                GJC0003                     AMNISTIA     192
  2233        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     193
  2234            "15 37 4 RE.90.ESTA.120 2425263716 4".                GJC0003                     AMNISTIA     194
  2235        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     195
  2236            "12 38 1 RE.120.ESTA.30 3839404116 4".                GJC0003                     AMNISTIA     196
  2237        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     197
  2238            "13 39 2 RE.120.ESTA.60 3839404116 4".                GJC0003                     AMNISTIA     198
  2239        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     199
  2240            "14 40 3 RE.120.ESTA.90 3839404116 4".                GJC0003                     AMNISTIA     200
  2241        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     201
  2242            "15 41 4 RE.120.ESTA.1202425264116 4".                GJC0003                     AMNISTIA     202
  2243        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     203
  2244            "20 42   ADJ.NO.LOCALIZA0000000000 0".                GJC0003                     AMNISTIA     204
  2245        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     205
  2246            "21 43   ADJ.CTA.COBRADO0000000000 0".                GJC0003                     AMNISTIA     206
  2247        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     207
  2248            "22 44   FALLECIDO      0000000000 0".                GJC0003                     AMNISTIA     208
  2249        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     209
  2250            "09 45 4 CARTERA.CASTIGA0000000000 4".                GJC0003                     AMNISTIA     210
  2251        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     211
  2252            "10 46 5 CARTERA.RECUPER0000000000 5".                GJC0003                     AMNISTIA     212
  2253        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     213
  2254            "11 47 4 DUDOSO.RECAUDO 0000000000 4".                GJC0003                     AMNISTIA     214
  2255        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     215
  2256            "23 48   CONSULTA       0000000000 0".                GJC0003                     AMNISTIA     216
  2257        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     217
  2258            "49 49 5 NO RENOVADA    0000000000 0".                GJC0003                     AMNISTIA     218
  2259        05  FILLER  PIC X(35) VALUE                               GJC0003                     AMNISTIA     219
  2260            "50                     0000000000 0".                GJC0003                     AMNISTIA     220
  2261     03  TABLA-NOV-CAR-AMNIST21-R  REDEFINES                                                  AMNISTIA     221
  2262                                     TABLA-NOV-CAR-AMNIST21.                                  AMNISTIA     222
  2263         05  TAB-NOV-CARTERA-AMNIST21   OCCURS  50  TIMES.                                    AMNISTIA     223
  2264             07 NOV-CART-CODINT-AMNIST21 PIC 9(02).                                           AMNISTIA     224
  2265             07 FILLER                   PIC X.                   GJC0003                     AMNISTIA     225
  2266             07 NOV-CART-COD-AMNIST21    PIC 9(02).                                           AMNISTIA     226
  2267             07 FILLER                   PIC X.                   GJC0003                     AMNISTIA     227
  2268             07 NOV-CART-MORA-AMNIST21   PIC 9(01).               GJC0003                     AMNISTIA     228
  2269             07 FILLER                   PIC X.                   GJC0003                     AMNISTIA     229
  2270             07 NOV-CART-NOM-AMNIST21    PIC X(15).                                           AMNISTIA     230
  2271             07 NOV-CRUCES-AMNIST21   OCCURS 5 TIMES PIC X(2).    GJC0003                     AMNISTIA     231
  2272             07 FILLER                   PIC X.                   GJC0003                     AMNISTIA     232
  2273             07 NOV-CART-MORMAX-AMNIST21 PIC 9(01).               GJC0003                     AMNISTIA     233
  2274*---------------------------------------------------------------*                             AMNISTIA     234
  2275* DEFINICION DE VARIABLES DE AMBIENTE                                                         AMNISTIA     235
  2276*---------------------------------------------------------------*                             AMNISTIA     236
  2277  01 VAR-AMBIENTE-AMNIST21          PIC X(10) VALUE "FECHA_AMNI".                             AMNISTIA     237
  2278  01 VAR-AMB-HOY-AMNIST21           PIC X(10) VALUE "FECHA_HOY ". GJC0003                     AMNISTIA     238
  2279  01 VAR-FEC-AMB-AMNIST21.                                        GJC0003                     AMNISTIA     239
  2280     03 ANO-VAR-FEC-AMB-AMNIST21    PIC 9(04).                    GJC0003                     AMNISTIA     240
  2281     03 MES-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003                     AMNISTIA     241
  2282     03 DIA-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003                     AMNISTIA     242
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  41
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2283* 01  WS-FECHA-HISTORICA         PIC  9(08) VALUE  ZEROS.         GJC0003                     AMNISTIA     243
  2284* 01                       REDEFINES  WS-FECHA-HISTORICA.         GJC0003                     AMNISTIA     244
  2285*   03  WS-FECHA-HIST-ANNO       PIC  9(04).                      GJC0003                     AMNISTIA     245
  2286*   03  WS-FECHA-HIST-MES        PIC  9(02).                      GJC0003                     AMNISTIA     246
  2287*   03  WS-FECHA-HIST-DIA        PIC  9(02).                      GJC0003                     AMNISTIA     247
  2288                                                                                              AMNISTIA     248
  2289*----------------------------------------------------------------*                            AMNISTIA     249
  2290*DEFINICION DE LAS VALIABLES QUE SE UTILIZAN PARA EL CALCULO DE  *                            AMNISTIA     250
  2291*LEY ARTICULO 13 DOBLE DEL TIEMPO DE LA MORA                                                  AMNISTIA     251
  2292*----------------------------------------------------------------*                            AMNISTIA     252
  2293  01 VAR-LEY-DOBLE-DE-MORA-AMNIST21.                              GJC0003                     AMNISTIA     253
  2294     03 SW-ART13-AMNIST21   PIC 9 VALUE 1. *> APLICAR SIEMPRE LEY GJC0003                     AMNISTIA     254
  2295     03 VECTORES-13-AMNIST21.                                     GJC0003                     AMNISTIA     255
  2296* VECTOR DE MORAS DE LA PERSONA                                   GJC0003                     AMNISTIA     256
  2297        05 VECTOR-MORAS-IDE-13-AMNIST21 PIC X(100) VALUE ALL "5". GJC0003                     AMNISTIA     257
  2298        05 VEC-MOR-IDE-13-AMNIST21 REDEFINES                      GJC0003                     AMNISTIA     258
  2299           VECTOR-MORAS-IDE-13-AMNIST21 PIC 9 OCCURS 100 TIMES.   GJC0003                     AMNISTIA     259
  2300* VECTOR DE LA CUENTA REAL                                        GJC0003                     AMNISTIA     260
  2301        05 VECTOR-TOT-CTA-AMNIST21.                               GJC0003                     AMNISTIA     261
  2302           07  VECTOR-4-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003                     AMNISTIA     262
  2303           07  VECTOR4-A-CTA-AMNIST21 REDEFINES                   GJC0003                     AMNISTIA     263
  2304               VECTOR-4-CTA-AMNIST21  PIC X(12).                  GJC0003                     AMNISTIA     264
  2305           07  VECTOR-3-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003                     AMNISTIA     265
  2306           07  VECTOR3A-CTA-AMNIST21 REDEFINES                    GJC0003                     AMNISTIA     266
  2307               VECTOR-3-CTA-AMNIST21  PIC X(12).                  GJC0003                     AMNISTIA     267
  2308           07  VECTOR-2-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003                     AMNISTIA     268
  2309           07  VECTOR2-A-CTA-AMNIST21 REDEFINES                   GJC0003                     AMNISTIA     269
  2310               VECTOR-2-CTA-AMNIST21  PIC X(12).                  GJC0003                     AMNISTIA     270
  2311           07  VECTOR-1-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003                     AMNISTIA     271
  2312           07  VECTOR1-A-CTA-AMNIST21 REDEFINES                   GJC0003                     AMNISTIA     272
  2313               VECTOR-1-CTA-AMNIST21  PIC X(12).                  GJC0003                     AMNISTIA     273
  2314           07  MOR-EST-CTA-AMNIST21   PIC 9     VALUE 0.          GJC0003                     AMNISTIA     274
  2315        05 VEC-TOT-CTA-AMNIST21 REDEFINES                         GJC0003                     AMNISTIA     275
  2316              VECTOR-TOT-CTA-AMNIST21 OCCURS 49 TIMES PIC 9.      GJC0003                     AMNISTIA     276
  2317* VECTOR DE LA CUENTA SOBRE EL QUE SE BUSCA SI SE PERDONA         GJC0003                     AMNISTIA     277
  2318       05 VECTOR-TOT-CTA2-AMNIST21.                               GJC0003                     AMNISTIA     278
  2319           07  VECTOR-4-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003                     AMNISTIA     279
  2320           07  VECTOR4-A-CTA2-AMNIST21 REDEFINES                  GJC0003                     AMNISTIA     280
  2321               VECTOR-4-CTA2-AMNIST21  PIC X(12).                 GJC0003                     AMNISTIA     281
  2322           07  VECTOR-3-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003                     AMNISTIA     282
  2323           07  VECTOR3A-CTA2-AMNIST21 REDEFINES                   GJC0003                     AMNISTIA     283
  2324               VECTOR-3-CTA2-AMNIST21  PIC X(12).                 GJC0003                     AMNISTIA     284
  2325           07  VECTOR-2-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003                     AMNISTIA     285
  2326           07  VECTOR2-A-CTA2-AMNIST21 REDEFINES                  GJC0003                     AMNISTIA     286
  2327               VECTOR-2-CTA2-AMNIST21  PIC X(12).                 GJC0003                     AMNISTIA     287
  2328           07  VECTOR-1-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003                     AMNISTIA     288
  2329           07  VECTOR1-A-CTA2-AMNIST21 REDEFINES                  GJC0003                     AMNISTIA     289
  2330               VECTOR-1-CTA2-AMNIST21  PIC X(12).                 GJC0003                     AMNISTIA     290
  2331           07  MOR-EST-CTA2-AMNIST21   PIC 9     VALUE 0.         GJC0003                     AMNISTIA     291
  2332           07  MOR-MORA-CTA2-AMNIST21  PIC 9     VALUE 1.         GJC0003                     AMNISTIA     292
  2333        05 VEC-TOT-CTA2-AMNIST21 REDEFINES                        GJC0003                     AMNISTIA     293
  2334              VECTOR-TOT-CTA2-AMNIST21 OCCURS 50 TIMES PIC 9.     GJC0003                     AMNISTIA     294
  2335* VECTOR DE CUENTA EN 100 POSICIONES NORMALIZADO                  GJC0003                     AMNISTIA     295
  2336        05 VECTOR-100-CTA-AMNIST21     PIC X(101).                GJC0003                     AMNISTIA     296
  2337        05 VEC-100-CTA-AMNIST21 REDEFINES                         GJC0003                     AMNISTIA     297
  2338           VECTOR-100-CTA-AMNIST21 pic 9 OCCURS 101 TIMES.        GJC0003                     AMNISTIA     298
  2339* VECTOR DE LAPSOS DE MORAS                                       GJC0003                     AMNISTIA     299
  2340        05 VECTOR-LAPSOS OCCURS 30 TIMES.                         GJC0003                     AMNISTIA     300
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  42
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2341           07 PERDON-GRUPO-AMNIST21  PIC 9(01).                   GJC0003                     AMNISTIA     301
  2342           07 INI-GRUPO-AMNIST21     PIC 9(02).                   GJC0003                     AMNISTIA     302
  2343           07 LONG-GRUPO-AMNIST21    PIC 9(02).                   GJC0003                     AMNISTIA     303
  2344                                                                  GJC0003                     AMNISTIA     304
  2345     03 VARIALES-MORAS-13-AMNIST21.                               GJC0003                     AMNISTIA     305
  2346        05 LONG-LAPSO-13-AMNIST21 PIC 9(02) VALUE 0.              GJC0003                     AMNISTIA     306
  2347        05 MAX-LONG-LAPSO-13-AMNIST21 PIC 9(02).                  GJC0003                     AMNISTIA     307
  2348     03  OTRAS-VAR-13-AMNIS21.                                    GJC0003                     AMNISTIA     308
  2349        05 CINCOS-AMNIST21        PIC X(100) VALUE ALL "5".       GJC0003                     AMNISTIA     309
  2350        05 UNOS-AMNIST21          PIC X(100) VALUE ALL "1".       GJC0003                     AMNISTIA     310
  2351        05 MAYOR-LAPSO-AMNIST21   PIC 9(02).                      GJC0003                     AMNISTIA     311
  2352        05 SALIR-AMNIST21         PIC 9.                          GJC0003                     AMNISTIA     312
  2353        05 CTA-PERDONADA-AMNIST21 PIC 9.                          GJC0003                     AMNISTIA     313
  2354        05 LAPSO-AMNIST21         PIC 9(02).                      GJC0003                     AMNISTIA     314
  2355        05 MESES-MORAS-AMNIST21   PIC 9(02).                      GJC0003                     AMNISTIA     315
  2356        05 ESTOY-MOROSO-AMNIST21  PIC 9.                          GJC0003                     AMNISTIA     316
  2357        05 MESES-AMNIST21         PIC 9(3).                       GJC0003                     AMNISTIA     317
  2358        05 FEC-NOV-AUX-AMNIST21 PIC 9(4).                         GJC0003                     AMNISTIA     318
  2359        05 FEC-NOV-AUX1-AMNIST21 PIC 9(4).                        GJC0003                     AMNISTIA     319
  2360        05 FEC-SIT-45Y47-AMNIST21 PIC 9(6).                       GJC0003                     AMNISTIA     320
  2361        05 FEC-SIT-45Y47-R-AMNIST21 REDEFINES                     GJC0003                     AMNISTIA     321
  2362           FEC-SIT-45Y47-AMNIST21.                                GJC0003                     AMNISTIA     322
  2363           07 MES-SIT-AMNIST21     PIC 9(02).                     GJC0003                     AMNISTIA     323
  2364           07 ANO-SIT-AMNIST21     PIC 9(04).                     GJC0003                     AMNISTIA     324
  2365*DEFINICION DE VARIABLES PARA HACER RECALCULO DE ESTADO Y OTROS CAGJC0003                     AMNISTIA     325
  2366 01 VARIABLES-RECALCULO.                                          GJC0003                     AMNISTIA     326
  2367    03 HISTORIA-TOTAL-AMNIST21.                                   GJC0003                     AMNISTIA     327
  2368       05 VECTOR-1-AMNIST21        PIC X(12).                     GJC0003                     AMNISTIA     328
  2369       05 VECTOR-2-AMNIST21        PIC X(12).                     GJC0003                     AMNISTIA     329
  2370       05 VECTOR-3-AMNIST21        PIC X(12).                     GJC0003                     AMNISTIA     330
  2371       05 VECTOR-4-AMNIST21        PIC X(12).                     GJC0003                     AMNISTIA     331
  2372       05 EST-HIST-AMNIST21        PIC X(1).                      GJC0003                     AMNISTIA     332
  2373    03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.                  GJC0003                     AMNISTIA     333
  2374       05 V-VECTOR-AMNIST21   OCCURS 49 TIMES PIC X.              GJC0003                     AMNISTIA     334
  2375    03 FIN-AMNIST21                 PIC 9 VALUE 0.                GJC0003                     AMNISTIA     335
  2376    03 FIN-MATRIZ-AMNIST21          PIC 99 VALUE 0.               GJC0003                     AMNISTIA     336
  2377    03 ESTADO-AMNIST21              PIC 99.                       GJC0003                     AMNISTIA     337
  2378    03 ESTADO-INI-AMNIST21          PIC 99.                       GJC0003                     AMNISTIA     338
  2379    03 ESTADO-FIN-AMNIST21          PIC 99.                       GJC0003                     AMNISTIA     339
  2380    03 ESTADO-INI48-AMNIST21          PIC 99.                     GJC0003                     AMNISTIA     340
  2381    03 ESTADO-FIN48-AMNIST21          PIC 99.                     GJC0003                     AMNISTIA     341
  2382    03 FECHA-AMNIST21.                                            GJC0003                     AMNISTIA     342
  2383       05 ANO-T-AMNIST21            PIC 9(4).                     GJC0003                     AMNISTIA     343
  2384       05 FILLER REDEFINES ANO-T-AMNIST21.                        GJC0003                     AMNISTIA     344
  2385          07 SIGLO-AMNIST21         PIC 99.                       GJC0003                     AMNISTIA     345
  2386          07 ANO-AMNIST21           PIC 9(2).                     GJC0003                     AMNISTIA     346
  2387       05 MES-AMNIST21              PIC 9(2).                     GJC0003                     AMNISTIA     347
  2388    03 FECHA-1-AMNIST21.                                          GJC0003                     AMNISTIA     348
  2389       05 ANO-T-1-AMNIST21          PIC 9(4).                     GJC0003                     AMNISTIA     349
  2390       05 FILLER REDEFINES ANO-T-1-AMNIST21.                      GJC0003                     AMNISTIA     350
  2391          07 SIGLO-1-AMNIST21       PIC 99.                       GJC0003                     AMNISTIA     351
  2392          07 ANO-1-AMNIST21         PIC 9(2).                     GJC0003                     AMNISTIA     352
  2393       05 MES-1-AMNIST21            PIC 9(2).                     GJC0003                     AMNISTIA     353
  2394    03 FEC-INI-MOR-AMNIST21         PIC 9(6).                     GJC0003                     AMNISTIA     354
  2395    03 MES-MORA-MAX-AMNIST21        PIC 9(2).                     GJC0003                     AMNISTIA     355
  2396    03 MES-MORA-MAX-48-AMNIST21        PIC 9(2).                  GJC0003                     AMNISTIA     356
  2397    03 FEC-MM-AA-AMNIST21           PIC 9(4).                     GJC0003                     AMNISTIA     357
  2398    03 FEC-MM-AAAA-AMNIST21         PIC 9(6).                     GJC0003                     AMNISTIA     358
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  43
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  2399    03 NOV-ENT-AMNIST21             PIC 9(02).                    GJC0003                     AMNISTIA     359
  2400    03 FEC-NOV-AMNIST21             PIC 9(04).                    GJC0003                     AMNISTIA     360
  2401    03 FEC-MORMAX-AMNIST21          PIC 9(06).                    GJC0003                     AMNISTIA     361
  2402    03 FEC-MORMAX-48-AMNIST21       PIC 9(06).                    GJC0003                     AMNISTIA     362
  2403    03 MORMAX-AMNIST21              PIC 9(01).                    GJC0003                     AMNISTIA     363
  2404    03 MORMAX48-AMNIST21            PIC 9(01).                    GJC0003                     AMNISTIA     364
  2405    03 NUM-MOR30-AMNIST21           PIC 9(02).                    GJC0003                     AMNISTIA     365
  2406    03 NUM-MOR30-48-AMNIST21        PIC 9(02).                    GJC0003                     AMNISTIA     366
  2407    03 NOV-SAL-AMNIST21             PIC 9(02).                    GJC0003                     AMNISTIA     367
  2408    03 FEC-NOV-48-AMNIST21          PIC 9(04).                    GJC0003                     AMNISTIA     368
  2409    03 NOV-SAL-48-AMNIST21          PIC 9(02).                    GJC0003                     AMNISTIA     369
  2410    03 POSICION-INI-AMNIST21        PIC 9(03).                    GJC0003                     AMNISTIA     370
  2411                                                                                              AMNISTIA     371
  2412                                                                                              AMNISTIA     372
* 2413 COPY VALNOM.WS.                                                                              LEEMAEST      18
  2418* GJC0002    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION                     VALNOM         5
  2419* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES                      VALNOM         6
  2420* MARZO/2003 *                                                                                VALNOM         7
  2421*************************************************************************                     VALNOM         8
  2422  01 VARIABLES-VALNOM.                                                                        VALNOM         9
  2423     03 VECTOR-INPUT-VALNOM.                                                                  VALNOM        10
  2424       04 VM-INPUT-VALNOM     OCCURS 20 TIMES .                                               VALNOM        11
  2425          05 VMM-INPUT-VALNOM OCCURS 15 TIMES PIC X.                                          VALNOM        12
  2426     03 VECTOR-OK-VALNOM.                                                                     VALNOM        13
  2427       04 VM-OK-VALNOM         OCCURS 20 TIMES.                                               VALNOM        14
  2428          05 VMM-OK-VALNOM    OCCURS 15 TIMES PIC X.                                          VALNOM        15
  2429     03 BLOQOK-AUX-VALNOM           PIC 9(2).                                                 VALNOM        16
  2430     03 CADENA-VALNOM.                                                                        VALNOM        17
  2431        04 FILLER                   PIC X(2) VALUE "A ".                                      VALNOM        18
  2432        04 NOMBRE-AUX-VALNOM        PIC X(65).                                                VALNOM        19
  2433        04 FILLER REDEFINES NOMBRE-AUX-VALNOM.                                                VALNOM        20
  2434           05 VNOM-AUX-VALNOM OCCURS 65 TIMES PIC X.                                          VALNOM        21
  2435     03 BASURA-VALNOM               PIC X(10).                                                VALNOM        22
  2436     03 BLOQUES-INPUT-VALNOM        PIC 9(2).                                                 VALNOM        23
  2437     03 NOMBRE-INPUT-VALNOM         PIC X(65).                                                VALNOM        24
  2438     03 FILLER REDEFINES NOMBRE-INPUT-VALNOM.                                                 VALNOM        25
  2439        05 V-NOMBRE-VALNOM          PIC X OCCURS 65 TIMES.                                    VALNOM        26
  2440     03 NOMBOK-INPUT-VALNOM         PIC X(65).                                                VALNOM        27
  2441     03 FILLER REDEFINES NOMBOK-INPUT-VALNOM.                                                 VALNOM        28
  2442        05 V-NOMBOK-VALNOM          PIC X OCCURS 65 TIMES.                                    VALNOM        29
  2443     03 TIP-ID-INPUT-VALNOM         PIC 9(02).                                                VALNOM        30
  2444     03 MATCH-OK-OUT-VALNOM         PIC 9(01).                                                VALNOM        31
  2445     03 A-VALNOM                    PIC 9(05).                                                VALNOM        32
  2446     03 I-VALNOM                    PIC 9(05).                    GJC0002                     VALNOM        33
  2447     03 J-VALNOM                    PIC 9(05).                    GJC0002                     VALNOM        34
  2448     03 K-VALNOM                    PIC 9(05).                    GJC0002                     VALNOM        35
  2449     03 L-VALNOM                    PIC 9(05).                    GJC0002                     VALNOM        36
  2450     03 M-VALNOM                    PIC 9(05).                    GJC0002                     VALNOM        37
  2451     03 INI-VALNOM                  PIC 9(02).                                                VALNOM        38
  2452     03 LON-VALNOM                  PIC 9(02).                                                VALNOM        39
  2453     03 LETRAS-OK-VALNOM            PIC 9(02).                                                VALNOM        40
  2454     03 LETRAS-OK2-VALNOM           PIC 9(02).                                                VALNOM        41
  2455     03 TOTLET-OK-VALNOM            PIC 9(02).                                                VALNOM        42
  2456     03 TOTLET-INP-VALNOM           PIC 9(02).                                                VALNOM        43
  2457     03 PEDAZO-VALNOM               PIC X(15).                                                VALNOM        44
  2458     03 POR-TOT-VALNOM              PIC 9(05).                                                VALNOM        45
  2459     03 POR-INP-VALNOM              PIC 9(05).                                                VALNOM        46
  2460     03 APROX-TOT-VALNOM            PIC 9(05).                                                VALNOM        47
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  44
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.WS)
  2461     03 APROX-INP-VALNOM            PIC 9(05).                                                VALNOM        48
  2462     03 VECTORES-VALNOM.                                          GJC0002                     VALNOM        49
  2463        04 FILLER                   OCCURS 256 TIMES.             GJC0002                     VALNOM        50
  2464           05 CONT-LET-INPUT-VALNOM PIC 9(2).                     GJC0002                     VALNOM        51
  2465           05 CONT-LET-OK-VALNOM    PIC 9(2).                     GJC0002                     VALNOM        52
  2466     03 VAL-APELLIDO-VALNOM         PIC 9.                        GJC0002                     VALNOM        53
* 2467 COPY DIRECC.WS.                                                                              LEEMAEST      19
  2472* VHF0004     * SE ADICIONAN NOMBRES DE ARCHIVOS DE              *                            DIRECC         5
  2473* VICTOR HUGO * ESTANDARIZACION DE DIRECCIONES                  *                             DIRECC         6
  2474* FORERO      *                                                  *                            DIRECC         7
  2475* JUL.08/2002 *                                                  *                            DIRECC         8
  2476******************************************************************                            DIRECC         9
  2477* FAC0005     * HDIR01 * INCLUSION RUTA PARA MAESTRO HISTORICO DE*                            DIRECC        10
  2478* F.CUADROS C.* DIRECCIONES                                      *                            DIRECC        11
  2479* MAR.04/2003 *                                                  *                            DIRECC        12
  2481* FAC0006     * BDLLOC * AMPLIACION DE LAS OCURRENCIAS DEL VECTOR*                            DIRECC        14
  2482* F.CUADROS C.* T-LOCALIZACION PARA NUEVOS CAMPOS DE MAESTROS DEL*                            DIRECC        15
  2483* DIC.11/2003 * CLUB BDLCLI                                                                   DIRECC        16
  2485* FAC0007     * AMPDIR * AMPLIACIÓN DE LA ESTRUCTURA DE ARCHIVOS*                             DIRECC        18
  2486* F.CUADROS C.* ICBDIR Y BDUHDIR. SE AMPLIAN LOS TAMAÑOS DE LOS *                             DIRECC        19
  2487* FEB.14/2006 * CAMPOS: TELÉFONOS, DIRECCIONES, CIUDADES, DPTOS.*                             DIRECC        20
  2489* VHF0008     * RCNCER - SE INCLUYE TITULO DE ARCHIVO DE        *                             DIRECC        22
  2490* VICTOR HUGO *          ACEPCIONES DE CIUDADES PARA OPTIMIZAR  *                             DIRECC        23
  2491* FORERO      *          PRODUCTO RECONOCER.                    *                             DIRECC        24
  2492* JUL.06/2006 *                                                 *                             DIRECC        25
  2493* FAC0008     *          SE INCLUYEN CONTROLES EN HISTÓRICO PARA*                             DIRECC        26
  2494* JUL.18/2006 *          GEORREFERENCIACIÓN                     *                             DIRECC        27
  2495*****************************************************************                             DIRECC        28
  2496* CAV0009      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI  *                             DIRECC        29
  2497* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA  *                             DIRECC        30
  2498* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION            *                             DIRECC        31
  2499*****************************************************************                             DIRECC        32
  2500* VHF0010      * FASEII - SE ADICIONAN NUEVAS VARIABLES PARA EL  *                            DIRECC        33
  2501* VICTOR HUGO  *          ACTUALIZADOR                           *                            DIRECC        34
  2502* FORERO       *                                                 *                            DIRECC        35
  2503* JUL.25/2008  *                                                 *                            DIRECC        36
  2504******************************************************************                            DIRECC        37
  2505 01 CONTADORES-DIRECC.                                                                        DIRECC        38
  2506    03 TOTAL-DIRECC            PIC 9(8) VALUE 0.                                              DIRECC        39
  2507    03 CAMBIOS-DIRECC          PIC 9(8) VALUE 0.                                              DIRECC        40
  2508    03 SINCAMBIOS-DIRECC       PIC 9(8) VALUE 0.                                              DIRECC        41
  2509    03 CREACIONES-DIRECC       PIC 9(8) VALUE 0.                                              DIRECC        42
  2510    03 ERRORES-DIRECC          PIC 9(8) VALUE 0.                                              DIRECC        43
  2511    03 CAMPOSVACIOS-DIRECC     PIC 9(8) VALUE 0.                                              DIRECC        44
  2512    03 MENOSACTUAL-DIRECC      PIC 9(8) VALUE 0.                                              DIRECC        45
  2513    03 ERRLLAVE-DIRECC         PIC 9(8) VALUE 0.                                              DIRECC        46
  2514 01 VARIABLES-DIRECC.                                                                         DIRECC        47
  2515    03 IND-DIRECC              PIC 9 VALUE 0.                                                 DIRECC        48
  2516    03 FECHA6-DIRECC           PIC 9(06).                                                     DIRECC        49
  2517    03 ERROR-DIRECC            PIC 9 VALUE 0.                                                 DIRECC        50
  2518    03 CAMBIO-DIRECC           PIC 9 VALUE 0.                                                 DIRECC        51
  2519    03 REG-CSV-DIRECC          PIC 9(1).                          CAV0009                     DIRECC        52
  2520    03 MAES-DIRECC-TITLE PIC X(50) VALUE "$DIRECCIONES/ICBDIR".                               DIRECC        53
  2521    03 TITLE-DIREST            PIC X(40) VALUE                    VHF0004                     DIRECC        54
  2522       "$DIRECCIONES/DIREST".                                     VHF0004                     DIRECC        55
  2523    03 TITLE-DIRCON            PIC X(40) VALUE                    VHF0004                     DIRECC        56
  2524       "$DIRECCIONES/DIRCON".                                     VHF0004                     DIRECC        57
  2525    03 VALLOC-DIRECC.                                                                         DIRECC        58
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  45
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/DIRECC.WS)
  2526       04 T-LOCALIZACION OCCURS 15 TIMES PIC 9.                   FAC0006                     DIRECC        59
  2527    03 MAES-BDUHDIR-TITLE PIC X(20) VALUE "$DIRECCIONES/BDUHDIR". FAC0005                     DIRECC        60
  2528    03 TITLE-BDLSTDCIU    PIC X(80)  VALUE "$DATABASE/BDLSTDCIU". VHF0008                     DIRECC        61
  2529 01 VARIABLES-TRAB-DIRECC.                                        FAC0003                     DIRECC        62
  2530    03 TEL-W1                  PIC X(12).                         FAC0007                     DIRECC        63
  2531    03 TEL-W2                  PIC X(12).                         FAC0007                     DIRECC        64
  2532    03 TEL-WW2                 PIC X(12).                         FAC0007                     DIRECC        65
  2533    03 CAR-W                   PIC 9(1).                          FAC0003                     DIRECC        66
  2534    03 CAR-WW                  PIC 9(2).                          FAC0003                     DIRECC        67
  2535    03 NUM-CAR-W               PIC 9(2).                          FAC0003                     DIRECC        68
  2536 01 VARIABLES-NEW-DIRECC.                                         VHF0010                     DIRECC        69
  2537    03 SW-HACER-CAMBIO         PIC 9.                             VHF0010                     DIRECC        70
  2538    03 DIR-ACTUAL              PIC X(60).                         VHF0010                     DIRECC        71
  2539    03 DIR-NUEVA               PIC X(60).                         VHF0010                     DIRECC        72
  2540 01 REG-BDUHDIR-WS.                                               FAC0005                     DIRECC        73
  2541    03  LLAVE-BDUHDIR-WS.                                         FAC0005                     DIRECC        74
  2542        05  LLAVE-PRI-BDUHDIR-WS.                                 FAC0005                     DIRECC        75
  2543            07  TIPO-ID-BDUHDIR-WS    PIC 9(01).                  FAC0005                     DIRECC        76
  2544            07  NUM-ID-BDUHDIR-WS     PIC 9(13).                  FAC0007                     DIRECC        77
  2545        05  LLAVE-ALT-BDUHDIR-WS.                                 FAC0005                     DIRECC        78
  2546            07  COD-SUS-BDUHDIR-WS    PIC 9(06).                  FAC0005                     DIRECC        79
  2547            07  COD-CTA-BDUHDIR-WS    PIC 9(02).                  FAC0005                     DIRECC        80
  2548            07  NUM-CTA-BDUHDIR-WS    PIC X(18).                  FAC0005                     DIRECC        81
  2549        05  LLAVE-CONSEC-BDUHDIR-WS.                              FAC0005                     DIRECC        82
  2550            07  NUM-CONSEC-BDUHDIR-WS PIC 9(3).                   FAC0005                     DIRECC        83
  2551     03  FECAPE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007                     DIRECC        84
  2552     03  FECCRE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007                     DIRECC        85
  2553     03  FECACT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007                     DIRECC        86
  2554     03  CIURES-BDUHDIR-WS            PIC X(20).                  FAC0007                     DIRECC        87
  2555     03  DPTRES-BDUHDIR-WS            PIC X(20).                  FAC0007                     DIRECC        88
  2556     03  DIRRES-BDUHDIR-WS            PIC X(60).                  FAC0007                     DIRECC        89
  2557     03  TELRES-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007                     DIRECC        90
  2558*    03  FECRES-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010                     DIRECC        91
  2559     03  FECDRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010                     DIRECC        92
  2560     03  CIULAB-BDUHDIR-WS            PIC X(20).                  FAC0007                     DIRECC        93
  2561     03  DPTLAB-BDUHDIR-WS            PIC X(20).                  FAC0007                     DIRECC        94
  2562     03  DIRLAB-BDUHDIR-WS            PIC X(60).                  FAC0007                     DIRECC        95
  2563     03  TELLAB-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007                     DIRECC        96
  2564*    03  FECLAB-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010                     DIRECC        97
  2565     03  FECDLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010                     DIRECC        98
  2566     03  CIUCOR-BDUHDIR-WS            PIC X(20).                  FAC0007                     DIRECC        99
  2567     03  DPTCOR-BDUHDIR-WS            PIC X(20).                  FAC0007                     DIRECC       100
  2568     03  DIRCOR-BDUHDIR-WS            PIC X(60).                  FAC0007                     DIRECC       101
  2569*    03  FECCOR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010                     DIRECC       102
  2570     03  FECDCOR-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010                     DIRECC       103
  2571     03  E-MAIL-BDUHDIR-WS            PIC X(40).                  FAC0007                     DIRECC       104
  2572     03  TELCEL-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007                     DIRECC       105
  2573*    03  FECOTR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010                     DIRECC       106
  2574     03  FECCEL-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010                     DIRECC       107
  2575     03  FECSIS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007                     DIRECC       108
  2576     03  FECSUS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007                     DIRECC       109
  2577     03  FECULT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007                     DIRECC       110
  2578     03  CERRES-BDUHDIR-WS            PIC 9(01).                  FAC0008                     DIRECC       111
  2579     03  ADIRES-BDUHDIR-WS            PIC 9(02).                  FAC0008                     DIRECC       112
  2580     03  CERLAB-BDUHDIR-WS            PIC 9(01).                  FAC0008                     DIRECC       113
  2581     03  ADILAB-BDUHDIR-WS            PIC 9(02).                  FAC0008                     DIRECC       114
  2582     03  CERCOR-BDUHDIR-WS            PIC 9(01).                  FAC0008                     DIRECC       115
  2583     03  ADICOR-BDUHDIR-WS            PIC 9(02).                  FAC0008                     DIRECC       116
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  46
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/DIRECC.WS)
  2584     03  INDCSV-BDUHDIR-WS            PIC 9(01).                  CAV0009                     DIRECC       117
  2585     03  FECTRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010                     DIRECC       118
  2586     03  FECTLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010                     DIRECC       119
  2587     03  FECMAIL-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010                     DIRECC       120
  2588*    03  FILLER-BDUHDIR-WS            PIC X(40).                  VHF0010                     DIRECC       121
  2589     03  FILLER-BDUHDIR-WS            PIC X(28).                  VHF0010                     DIRECC       122
  2590                                                                                              LEEMAEST      20
  2591                                                                                              LEEMAEST      21
  2592********************************************************************                          LEEMAEST      22
  2593* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA                             LEEMAEST      23
  2594* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.                                                   LEEMAEST      24
  2595 01  HACERMATCH-LEEMSTRS        PIC 9(01)  VALUE 1.                                           LEEMAEST      25
  2596 01  AMNISTIA21-LEEMSTRS        PIC 9(01)  VALUE 1.                                           LEEMAEST      26
  2597********************************************************************                          LEEMAEST      27
  2598 01  SW-LECTURA-MAESTROS        PIC 9(01)  VALUE ZEROS.                                       LEEMAEST      28
  2599 01  TIP-IDE-ANT-LEEMSTRS       PIC 9(01)  VALUE ZEROS.                                       LEEMAEST      29
  2600 01  NUM-IDE-ANT-LEEMSTRS       PIC 9(11)  VALUE ZEROS.                                       LEEMAEST      30
  2601 01  REG-ICMCRE-LEEMSTRS        PIC X(220) VALUE SPACES.                                      LEEMAEST      31
  2602 01  REG-ICMCHK-LEEMSTRS        PIC X(94)  VALUE SPACES.                                      LEEMAEST      32
  2603 01  REG-ICBSUS-LEEMSTRS        PIC X(200) VALUE SPACES.                                      LEEMAEST      33
  2604 01  REG-ICBDIR-LEEMSTRS        PIC X(483) VALUE SPACES.                                      LEEMAEST      34
  2605 01  TIPO-ID-LEEMSTRS           PIC 9(01)  VALUE ZEROS.                                       LEEMAEST      35
  2606 01  NRO-ID-LEEMSTRS            PIC 9(11)  VALUE ZEROS.                                       LEEMAEST      36
  2607 01  SW-FCHGRACIA-LEEMSTRS      PIC 9(01)  VALUE ZEROS.                                       LEEMAEST      37
  2608 01  SW-NOV-48-LEEMSTRS         PIC 9(01)  VALUE 1.               GJC0002                     LEEMAEST      38
  2609 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003                     LEEMAEST      39
  2610                                                                                                           262
  2611*****************************************************************                                          263
  2612* Direcciones de los archivos en el file system                                                            264
  2613*****************************************************************                                          265
* 2614 copy ICFILE.WS.                                                                                           266
  2615* ICFILE-WS.v.0043.                                                                           ICFILE         1
  2616* COPY PARA DIRECCIONAR LOS ARCHIVOS.                                                         ICFILE         2
  2617*****************************************************************                             ICFILE         3
  2618* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS                                ICFILE         4
  2619*R.MARTINEZ   * UNIVERSAL.                                                                    ICFILE         5
  2620******************************************************************                            ICFILE         6
  2621* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *                            ICFILE         7
  2622* VICTOR HUGO *                                                  *                            ICFILE         8
  2623* FORERO      *                                                  *                            ICFILE         9
  2624* DIC.01/2000 *                                                  *                            ICFILE        10
  2625******************************************************************                            ICFILE        11
  2626* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *                            ICFILE        12
  2627* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *                            ICFILE        13
  2628* FORERO      * NOMREG - REGISTRADURIA                           *                            ICFILE        14
  2629* SEP.10/2001 * NOMDAS - DAS                                     *                            ICFILE        15
  2630*             * NMDIAN - DIAN                                    *                            ICFILE        16
  2631******************************************************************                            ICFILE        17
  2632* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *                            ICFILE        18
  2633* VICTOR HUGO * BYINGTON                                         *                            ICFILE        19
  2634* FORERO      *                                                  *                            ICFILE        20
  2635* FEB.18/2002 *                                                  *                            ICFILE        21
  2636******************************************************************                            ICFILE        22
  2637* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *                            ICFILE        23
  2638* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *                            ICFILE        24
  2639* SEP.04/2002 *                                                  *                            ICFILE        25
  2640* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*                            ICFILE        26
  2641* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *                            ICFILE        27
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  47
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICFILE.WS)
  2642* OCT.29/2002 *                                                  *                            ICFILE        28
  2643******************************************************************                            ICFILE        29
  2644* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *                            ICFILE        30
  2645* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *                            ICFILE        31
  2646* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *                            ICFILE        32
  2647* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*                            ICFILE        33
  2648*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *                            ICFILE        34
  2649*             *          ENTRADA-ENTIDAD                         *                            ICFILE        35
  2650*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *                            ICFILE        36
  2651* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *                            ICFILE        37
  2652*             *          CIONES Y TELEFONOS                      *                            ICFILE        38
  2653*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *                            ICFILE        39
  2654*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *                            ICFILE        40
  2655*             *          RRIENTES CON RECLAMOS VIGENTES          *                            ICFILE        41
  2656******************************************************************                            ICFILE        42
  2657* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *                            ICFILE        43
  2658* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *                            ICFILE        44
  2659* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*                            ICFILE        45
  2660*             *          NOMBRE                                  *                            ICFILE        46
  2661******************************************************************                            ICFILE        47
  2662* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *                            ICFILE        48
  2663* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *                            ICFILE        49
  2664* FEB.14/2003 *                                                  *                            ICFILE        50
  2665******************************************************************                            ICFILE        51
  2666* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *                            ICFILE        52
  2667* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *                            ICFILE        53
  2668* MAR.03/2003 *          CON NUEVOS DISENOS.                     *                            ICFILE        54
  2669******************************************************************                            ICFILE        55
  2670* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *                            ICFILE        56
  2671* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *                            ICFILE        57
  2672* JUN.05/2003 *                                                  *                            ICFILE        58
  2673* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *                            ICFILE        59
  2674* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *                            ICFILE        60
  2675* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *                            ICFILE        61
  2676******************************************************************                            ICFILE        62
  2677* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *                            ICFILE        63
  2678* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *                            ICFILE        64
  2679* JUL.09/2003 *          en $TRABAJO/logs                        *                            ICFILE        65
  2680******************************************************************                            ICFILE        66
  2681* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*                            ICFILE        67
  2682* G.JIMENEZ  .*                                                  *                            ICFILE        68
  2683* SEP.11/2003 *                                                  *                            ICFILE        69
  2684******************************************************************                            ICFILE        70
  2685* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *                            ICFILE        71
  2686* G.JIMENEZ  .*                                                  *                            ICFILE        72
  2687* OCT.14/2004 *                                                  *                            ICFILE        73
  2688******************************************************************                            ICFILE        74
  2689* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *                            ICFILE        75
  2690* G.JIMENEZ   *          PRODUCTOS                               *                            ICFILE        76
  2691* ABR/2005    *                                                  *                            ICFILE        77
  2692******************************************************************                            ICFILE        78
  2693* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *                            ICFILE        79
  2694* F.CUADROS   *          FRAINQ.DAT                              *                            ICFILE        80
  2695* JUN.23/2005 *                                                  *                            ICFILE        81
  2696******************************************************************                            ICFILE        82
  2697* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *                            ICFILE        83
  2698* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *                            ICFILE        84
  2699* SEP.02/2005 *                                                  *                            ICFILE        85
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  48
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICFILE.WS)
  2700******************************************************************                            ICFILE        86
  2701* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *                            ICFILE        87
  2702* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *                            ICFILE        88
  2703* OCT.28/2005 *          TIPO 8                                  *                            ICFILE        89
  2704*             *                                                  *                            ICFILE        90
  2705******************************************************************                            ICFILE        91
  2706* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *                            ICFILE        92
  2707* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *                            ICFILE        93
  2708* OCT.17/2006 *                                                  *                            ICFILE        94
  2709******************************************************************                            ICFILE        95
  2710* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *                            ICFILE        96
  2711* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *                            ICFILE        97
  2712* SEP.11/2007 *                                                  *                            ICFILE        98
  2713******************************************************************                            ICFILE        99
  2714* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *                            ICFILE       100
  2715* F.LOZANO T. *          SCORES MENSUALES.                       *                            ICFILE       101
  2716* OCT.31/2007 *                                                  *                            ICFILE       102
  2717******************************************************************                            ICFILE       103
  2718* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *                            ICFILE       104
  2719* C.VELASCO   *          DE LOS PROCESOS DE CALIDAD EJECUTADOS   *                            ICFILE       105
  2720* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP        *                            ICFILE       106
  2721******************************************************************                            ICFILE       107
  2722* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *                            ICFILE       108
  2723* E.ALVAREZ   *          PARA PROCESAR 48 MESES DEL ARCHIVO      *                            ICFILE       109
  2724* JUN.19/2009 *                                                  *                            ICFILE       110
  2725******************************************************************                            ICFILE       111
  2726* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES        *                            ICFILE       112
  2727* R.GALVIS    *          MAES-DIRECTORY ARCHIVOS ICMVLR          *                            ICFILE       113
  2728* JUL.09/2009 *          DE 17 A 16 POSICIONES                   *                            ICFILE       114
  2729*             * CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *                            ICFILE       115
  2730*             *          CHEQUES                                 *                            ICFILE       116
  2731******************************************************************                            ICFILE       117
  2732* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *                            ICFILE       118
  2733* V.FORERO    *          CLIENTES                                *                            ICFILE       119
  2734* SEP.28/2009 *                                                  *                            ICFILE       120
  2735******************************************************************                            ICFILE       121
  2736* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *                            ICFILE       122
  2737* C.VELASCO   *          MARCAS PRIVADAS PARA TARJETAS           *                            ICFILE       123
  2738* OCT.09/2009 *                                                  *                            ICFILE       124
  2739******************************************************************                            ICFILE       125
  2740* RGH0032       * MOD032 - INCLUIR ARCHIVOS DE RECONOCER +       *                            ICFILE       126
  2741* R. GALVIS H.  *          BDLDIRACE                             *                            ICFILE       127
  2742* ENE. 01/2010  *          BDLMAIEXC                             *                            ICFILE       128
  2743* INTERSCHEMES. *          BDLTELEXC                             *                            ICFILE       129
  2744******************************************************************                            ICFILE       130
  2745* LAG0033       * SCOPRE - INCLUIR ARCHIVO SCOREPREC             *                            ICFILE       131
  2746* AGO. 02/2010  *          BDLMAIEXC                             *                            ICFILE       132
  2747* G.DESARROLLO  *          BDLTELEXC                             *                            ICFILE       133
  2748* GJC0033       * FRZMYR - SE INCLUYE MANEJO DE ARCHIVO DE DES-  *                            ICFILE       134
  2749* G.JIMENEZ     *          PLAZADOS Y SECUESTRADOS - FUERZA MA-  *                            ICFILE       135
  2750* OCT./2010     *          YOR                                   *                            ICFILE       136
  2751******************************************************************                            ICFILE       137
  2752* GJC0034       * BDANOM - SE INCLUYE MANEJO DE ARCHIVO DE POR-  *                            ICFILE       138
  2753* G.JIMENEZ     *          CENTAJE DE NOMBRES Y APELLIDOS BDANOM *                            ICFILE       139
  2754* FEB./2011     *                                                *                            ICFILE       140
  2755******************************************************************                            ICFILE       141
  2756* CAV0035       * AJDANE - SE INCLUYE MANEJO DE ARCHIVO DANE DE  *                            ICFILE       142
  2757* C.VELASCO     *          CIUDADES,DEPARTEAMENTOS Y CABECERAS O *                            ICFILE       143
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  49
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICFILE.WS)
  2758* ABR./2011     *          CENTROS POBLADOS (DVPDANE)            *                            ICFILE       144
  2759******************************************************************                            ICFILE       145
  2760* CAV0036       * CARIND - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *                            ICFILE       146
  2761* C.VELASCO     *          CARACTERISTICAS USA PRECALCULADAS     *                            ICFILE       147
  2762* MAY./2011     *          TITLE-CARACT-IND                      *                            ICFILE       148
  2763******************************************************************                            ICFILE       149
  2764* FARF037       * FRABDU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *                            ICFILE       150
  2765* F.RODRIGUEZ   *          DE DATOS UNIVERSAL DE PREGUNTAS       *                            ICFILE       151
  2766* JUN.22/2011   *                                                *                            ICFILE       152
  2767******************************************************************                            ICFILE       153
  2768* CAV0038       * AJCIIU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *                            ICFILE       154
  2769* C.VELASCO.    *          HISTORICA DE CODIGOS CIIU Y ACTIVIDAD *                            ICFILE       155
  2770* SEP.21/2011   *          ECONOMICA                             *                            ICFILE       156
  2771******************************************************************                            ICFILE       157
  2772* CAV0039       * MCREHI - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *                            ICFILE       158
  2773* C.VELASCO     *          ICMCREH QUE CONTIENE EL HISTORICO     *                            ICFILE       159
  2774* JUN./2011     *          DE REGISTRO CERRADOS > 5 AÑOS         *                            ICFILE       160
  2775******************************************************************                            ICFILE       161
  2776* CAV0040       * NUECMP - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *                            ICFILE       162
  2777* C.VELASCO     *          ICMCONTTRJ  CONTIENE LA RELACION DE   *                            ICFILE       163
  2778* 09/ABR./2013  *          CONTRATO-TARJETA PARA TIPO CTA = 02.  *                            ICFILE       164
  2779******************************************************************                            ICFILE       165
  2780* GJC0041       * VALOR1 - REQUERIMIENTO 15452 CREACION PRODUCTO *                            ICFILE       166
  2781* G.JIMENEZ     *          VALORA. DEFINICION DE ARCHIVO QUE MA- *                            ICFILE       167
  2782* 20/SEP./2013  *          NEJA LOS COBROS EN 2 MOMENTOS, UN     *                            ICFILE       168
  2783*               *          QUE COBRA Y LOS OTROS NO                                           ICFILE       169
  2784******************************************************************                            ICFILE       170
  2785* GLB0042       * EVID03 - MEJORAS SISTEMA EVIDENTE              *                            ICFILE       171
  2786* GLOBANT       *          PROD00006585                          *                            ICFILE       172
  2787* NOV-2013      * SPRINT3                                        *                            ICFILE       173
  2788******************************************************************                            ICFILE       174
  2789* JJM0043       * SCORPJ - SE INCLUYE UN NUEVO TITLE PARA EL     *                            ICFILE       175
  2790* J. MELGAREJO  *          SCORE PJ.                             *                            ICFILE       176
  2791* MAR-2014      * SCOSTB - SE INCLUYE UN NUEVO TITLE PARA EL     *                            ICFILE       177
  2792*               *          SCORE STABILITY  (BDSCOREHIS)                                      ICFILE       178
  2793******************************************************************                            ICFILE       179
  2794*                                                                                             ICFILE       180
  2795 01  FILE-TITLES.                                                                             ICFILE       181
  2796     05  BDUUNI-TITLE        PIC X(80) VALUE "$BDU/BDUUNI".       RMB0008                     ICFILE       182
  2797     05  NOMB-APEL-TITLE     PIC X(80) VALUE "$DATABASE/ICBNAP".                              ICFILE       183
  2798     05  CLAVE-TITLE         PIC X(80) VALUE "$DATABASE/ICBCLA".                              ICFILE       184
  2799     05  TERM-TITLE          PIC X(80) VALUE "$DATABASE/ICBTER".                              ICFILE       185
  2800     05  MAES-PERSON-TITLE   PIC X(80) VALUE "$DATABASE/ICMPER".                              ICFILE       186
  2801     05  MAES-CHECK-TITLE    PIC X(80) VALUE "$DATABASE/ICMCHK".                              ICFILE       187
  2802     05  MAES-CREDIT-TITLE   PIC X(80) VALUE "$DATABASE/ICMCRE".                              ICFILE       188
  2803     05  MAES-MICROC-TITLE   PIC X(80) VALUE "$DATABASE/ICMMCR".  DLM0001                     ICFILE       189
  2804     05  MAES-ICMCHQ-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQ".  GJC0029                     ICFILE       190
  2805     05  INDEXADO-TITLE      PIC X(80) VALUE "$DATABASE/ICBCON".                              ICFILE       191
  2806     05  SECUENCIAL-TITLE    PIC X(80) VALUE "$DATABASE/ICBTCO".                              ICFILE       192
  2807     05  SUSCRIPTOR-TITLE    PIC X(80) VALUE "$DATABASE/ICBSUS".                              ICFILE       193
  2808     05  ARCHNITS-TITLE      PIC X(80) VALUE "ICDIAN".                                        ICFILE       194
  2809     05  ARCHIVO-CLIENTE     PIC X(80) VALUE "$DATABASE/ICMCLI".                              ICFILE       195
  2810     05  MAES-ICMCLN-TITLE   PIC X(80) VALUE "$DATABASE/ICMCLN".  VHF0030                     ICFILE       196
  2811     05  ARCHIVO-PREPAGOS    PIC X(80) VALUE "$DATABASE/ICMPRE".                              ICFILE       197
  2812     05  ARCHIVO-USUARIOS    PIC X(80) VALUE "$DATABASE/ICMUSU".                              ICFILE       198
  2813     05  TITLE-SCODTB        PIC X(80) VALUE "$DATABASE/SCODTB".                              ICFILE       199
  2814     05  TITLE-BDIRMAE1      PIC X(80) VALUE "$DATABASE/BDIRMAE1".                            ICFILE       200
  2815     05  TITLE-BDIRMAE2      PIC X(80) VALUE "$DATABASE/BDIRMAE2".                            ICFILE       201
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  50
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICFILE.WS)
  2816     05  TITLE-BDIRMAE3      PIC X(80) VALUE "$DATABASE/BDIRMAE3".                            ICFILE       202
  2817     05  TITLE-BDIRMAE4      PIC X(80) VALUE "$DATABASE/BDIRMAE4".                            ICFILE       203
  2818     05  TITLE-BDIRCTR       PIC X(80) VALUE "$DATABASE/BDIRCTR".                             ICFILE       204
  2819     05  TITLE-BDIMHIS       PIC X(80) VALUE "$DATABASE/BDIMHIS". FAC0023                     ICFILE       205
  2820     05  BDAPRVTR-TITLE      PIC X(80) VALUE "$DATABASE/BDAPRVTR".CAV0031                     ICFILE       206
  2821     05  TITLE-DTCABD.                                                                        ICFILE       207
  2822         07 FILLER           PIC X(13) VALUE "$DATOS/DTCABD".     GJC0014                     ICFILE       208
  2823         07 ANOMESDIA-DTCABD PIC 9(08) VALUE ZEROS.               GJC0014                     ICFILE       209
  2824     05  BDLCLI-TITLE        PIC X(80) VALUE "$DATABASE/BDLCLI".  GJC0013                     ICFILE       210
  2825     05  SCOREPREC-TITLE     PIC X(80) VALUE "$DATOS/SCOREPREC".  LAG0033                     ICFILE       211
  2826     05  ARCHIVO-LOGS        PIC X(80) VALUE                                                  ICFILE       212
  2827         "/ic/datacred/desarrollo/logs/ICL325".                                               ICFILE       213
  2828     05  ARCHIVO-TEMPORAL    PIC X(80) VALUE                                                  ICFILE       214
  2829                                 "$TEMPORALES/TEMPORAL".                                      ICFILE       215
  2830     05  ESTAD-CADUC         PIC X(80) VALUE                                                  ICFILE       216
  2831                                 "$TEMPORALES/ESTCAD.DAT".                                    ICFILE       217
  2832     05  MATRIZ-CADUC        PIC X(80) VALUE                                                  ICFILE       218
  2833                                 "$DATABASE/ICTCAD".                                          ICFILE       219
  2834     05  ETQ-CIN             PIC X(80) VALUE                                                  ICFILE       220
  2835                                 "$TEMPORALES/ICINCO.DAT".                                    ICFILE       221
  2836     05  RECLACOM-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCM".                              ICFILE       222
  2837     05  RECLAMOS-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCL".                              ICFILE       223
  2838     05 MAESTRO-FACUCLI      PIC X(80) VALUE "$DATABASE/FACUCLI".                             ICFILE       224
  2839     05 TITLE-FACUCLP        PIC X(80) VALUE "$DATABASE/FACUCLP".                             ICFILE       225
  2840     05 TITLE-FACUAUT        PIC X(80) VALUE "$DATABASE/FACUAUT".                             ICFILE       226
  2841     05 TITLE-FACULOG        PIC X(80) VALUE "$DATABASE/FACULOG".                             ICFILE       227
  2842     05 TITLE-FACUPAR        PIC X(80) VALUE                                                  ICFILE       228
  2843                                 "$DATABASE/FACUPAR.DAT".                                     ICFILE       229
  2844     05 MAES-ICMCREH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCREH". CAV0039                     ICFILE       230
  2845     05 MAES-ICMCHKH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHKH". CAV0039                     ICFILE       231
  2846     05 MAES-ICMCHQH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQH". CAV0039                     ICFILE       232
  2847                                                                                              ICFILE       233
  2848     05 TITLE-CIIU          PIC X(80) VALUE "$DATABASE/ICTCIIU".  VHF0009                     ICFILE       234
  2849     05 TITLE-BDINCCB       PIC X(80) VALUE "$ICREGIS/BDINCCB".   VHF0010                     ICFILE       235
  2850     05 TITLE-BDINREG       PIC X(80) VALUE "$ICREGIS/BDINREG".   VHF0010                     ICFILE       236
  2851     05 TITLE-BDINDAS       PIC X(80) VALUE "$ICREGIS/BDINDAS".   VHF0010                     ICFILE       237
  2852     05 TITLE-BDINDIAN      PIC X(80) VALUE "$ICREGIS/BDINDIAN".  VHF0010                     ICFILE       238
  2853     05 TITLE-CONRAZ        PIC X(80)                             GJC0019                     ICFILE       239
  2854                            VALUE "$DATABASE/CONRAZ.DAT".         GJC0019                     ICFILE       240
  2855     05 TITLE-FRALOG        PIC x(80) VALUE "$DATABASE/FRALOG".   GJC0020                     ICFILE       241
  2856     05 TITLE-FRAINQ        PIC X(80) VALUE                       FAC0022                     ICFILE       242
  2857                            "$DATABASE/FRAINQ.DAT".               FAC0022                     ICFILE       243
  2858     05 TITLE-FRAINQGR      PIC X(80) VALUE                       CAV0025                     ICFILE       244
  2859                            "$DATABASE/FRAINQGR.DAT".             CAV0025                     ICFILE       245
  2860     05 TITLE-BDSCORES.                                           FLT0026                     ICFILE       246
  2861        07 FILLER           PIC X(15) VALUE "$SCORES/BDSCORE".    FLT0026                     ICFILE       247
  2862        07 T-FECHA-PROC     PIC 9(04).                            FLT0026                     ICFILE       248
  2863     05 TITLE-ICBPRO        PIC x(80) VALUE "$DATABASE/ICBPRO".   GJC0021                     ICFILE       249
  2864     05 TITLE-DTRLLA        PIC x(80) VALUE "$DATABASE/DTRLLA".                               ICFILE       250
  2865     05 TITLE-DTCLOG        PIC X(80) VALUE "$DATABASE/DTCLOG".   GJC0012                     ICFILE       251
  2866     05 TITLE-DTCCOM        PIC X(80) VALUE "$DATABASE/DTCCOM".   GJC0017                     ICFILE       252
  2867     05 TITLE-DTCING        PIC X(80) VALUE "$DATABASE/DTCING".   VHF0013                     ICFILE       253
  2868     05 TITLE-DTCFAL        PIC X(80) VALUE "$DATABASE/DTCFAL".   VHF0013                     ICFILE       254
  2869     05 TITLE-DTCMDF        PIC X(80) VALUE "$DATABASE/DTCMDF".   VHF0013                     ICFILE       255
  2870     05 TITLE-DTCTRA        PIC X(80) VALUE "$DATABASE/DTCTRA".   VHF0013                     ICFILE       256
  2871     05 TITLE-BDINBYN       PIC X(80) VALUE "$ICREGIS/BDINBYN".   VHF0011                     ICFILE       257
  2872     05 SI-BDIEMSUP         PIC X(80) VALUE "$DBSUPER/BDIEMSUP".  FAC0012                     ICFILE       258
  2873     05 TITLE-BDIEMSUP      PIC X(80) VALUE "$DBSUPER/BDIESU".    FAC0023                     ICFILE       259
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  51
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICFILE.WS)
  2874     05 TITLE-UTLESTACT     PIC X(80) VALUE "$DATABASE/UTLESTACT".GLB0042                     ICFILE       260
  2875     05 SI-BDIEENTI         PIC X(80) VALUE "$DBSUPER/BDIEENTI".  FAC0012                     ICFILE       261
  2876     05 SI-BDIEMPER         PIC X(80) VALUE "$DBSUPER/BDIEMPER".  FAC0012                     ICFILE       262
  2877     05 SI-BDIETEMA         PIC X(80) VALUE "$DBSUPER/BDIETEMA".  FAC0012                     ICFILE       263
  2878     05 SI-BDIEAPER         PIC X(80) VALUE "$DBSUPER/BDIEAPER".  FAC0012                     ICFILE       264
  2879     05 SI-BDIEMENT         PIC X(80) VALUE "$DBSUPER/BDIEMENT".  FAC0012                     ICFILE       265
  2880     05 SI-BDIEMOVI         PIC X(80) VALUE "$DBSUPER/BDIEMOVI".  FAC0012                     ICFILE       266
  2881     05 SI-BDIEHSUP         PIC X(80) VALUE "$DBSUPER/BDIEHSUP".  FAC0012                     ICFILE       267
  2882     05 SI-BDIERECL         PIC X(80) VALUE "$DBSUPER/BDIERECL".  FAC0012                     ICFILE       268
  2883     05 SI-BDIEMTOT         PIC X(80) VALUE "$DBSUPER/BDIEMTOT".  FAC0012                     ICFILE       269
  2884     05 NOMBRE-WEB-SAL.                                           FAC0015                     ICFILE       270
  2885        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/WEB-SAL.".     FAC0015                     ICFILE       271
  2886        07 FECHA-WEB-SAL   PIC 9(8).                              FAC0015                     ICFILE       272
  2887     05 NOMBRE-RAS-SAL.                                           FAC0015                     ICFILE       273
  2888        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/RAS-SAL.".     FAC0015                     ICFILE       274
  2889        07 FECHA-RAS-SAL   PIC 9(8).                              FAC0015                     ICFILE       275
  2890     05 NOMBRE-CLAVE-WEB.                                         FAC0015                     ICFILE       276
  2891        07 NOMBRE-WEB-W    PIC X(80) VALUE "$DATABASE/ARCH-WEB".  FAC0015                     ICFILE       277
  2892     05 NOMBRE-RAS-LOG.                                           FAC0015                     ICFILE       278
  2893        07 NOM-RAS-LOG     PIC X(19) VALUE                        FAC0015                     ICFILE       279
  2894                           "$DATOS/WEB-RAS.LOG.".                 FAC0015                     ICFILE       280
  2895        07 FECHA-RAS-LOG   PIC 9(8).                              FAC0015                     ICFILE       281
  2896     05 TITLE-BDIIDIAN     PIC X(80)  VALUE "$DATABASE/BDIIDIAN". FAC0016                     ICFILE       282
  2897     05 TITLE-BDIIREGI     PIC X(80)  VALUE "$ICREGIS/BDIIRE".    FAC0016                     ICFILE       283
  2898     05 TITLE-BDIIDAS      PIC X(80)  VALUE "$DATABASE/BDIIDAS".  FAC0016                     ICFILE       284
  2899     05 TITLE-DTCNHAB      PIC X(80)  VALUE "$DATABASE/DTCNHAB".  VHF0017                     ICFILE       285
  2900     05 TITLE-ICDACT       PIC X(80)  VALUE                       VHF0017                     ICFILE       286
  2901                           "$TEMPORALES/ICDACT.DAT".              VHF0017                     ICFILE       287
  2902     05 NOMBRE-ACTALOG     PIC X(80)  VALUE                       FAC0018                     ICFILE       288
  2903                           "$TRABAJO/logs/ACTALOG".               FAC0018                     ICFILE       289
  2904     05 NOMBRE-VALVEST     PIC X(80)  VALUE                       FAC0018                     ICFILE       290
  2905                           "$TRABAJO/logs/VALVEST.DAT".           FAC0018                     ICFILE       291
  2906     05 NOMBRE-CALIDLOG.                                          CAV0027                     ICFILE       292
  2907        07 NOM-CALIDLOG    PIC X(23)  VALUE                       CAV0027                     ICFILE       293
  2908                           "$TRABAJO/logs/CALIDLOG-".             CAV0027                     ICFILE       294
  2909        07 FCH-CALIDLOG    PIC 9(8).                              CAV0027                     ICFILE       295
  2910     05 NOMBRE-CALIDDRP.                                          CAV0027                     ICFILE       296
  2911        07 NOM-CALIDDRP    PIC X(24) VALUE                        CAV0027                     ICFILE       297
  2912                           "$TEMPORALES/CALIDAD-DRP.".            CAV0027                     ICFILE       298
  2913        07 FCH-CALIDDRP    PIC 9(8).                              CAV0027                     ICFILE       299
  2914     05  MAES-ICMVLR-TITLE.                                       EAL0028                     ICFILE       300
  2915         07 MAES-DIRECTORY1          PIC X(16) VALUE              RGH0029                     ICFILE       301
  2916                                              "$VALORES/ICMVLR-". EAL0028                     ICFILE       302
  2917         07 MAES-FILE1               PIC X(63).                   EAL0028                     ICFILE       303
  2918                                                                  EAL0028                     ICFILE       304
  2919     05  MAES-ICMVLR-TITLE2.                                      EAL0028                     ICFILE       305
  2920         07 MAES-DIRECTORY2          PIC X(16) VALUE              RGH0029                     ICFILE       306
  2921                                              "$VALORES/ICMVLR-". EAL0028                     ICFILE       307
  2922         07 MAES-FILE2               PIC X(63).                   EAL0028                     ICFILE       308
  2923                                                                  EAL0028                     ICFILE       309
  2924     05  MAES-ICMVLR-TITLE3.                                      EAL0028                     ICFILE       310
  2925         07 MAES-DIRECTORY3          PIC X(16) VALUE              RGH0029                     ICFILE       311
  2926                                              "$VALORES/ICMVLR-". EAL0028                     ICFILE       312
  2927         07 MAES-FILE3               PIC X(63).                   EAL0028                     ICFILE       313
  2928                                                                  EAL0028                     ICFILE       314
  2929     05  MAES-ICMVLR-TITLE4.                                      EAL0028                     ICFILE       315
  2930         07 MAES-DIRECTORY4          PIC X(16) VALUE              RGH0029                     ICFILE       316
  2931                                              "$VALORES/ICMVLR-". EAL0028                     ICFILE       317
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  52
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/ICFILE.WS)
  2932         07 MAES-FILE4               PIC X(63).                   EAL0028                     ICFILE       318
  2933                                                                  EAL0028                     ICFILE       319
  2934     05  MAES-ICMVLR-TITLE5.                                      EAL0028                     ICFILE       320
  2935         07 MAES-DIRECTORY5          PIC X(16) VALUE              RGH0029                     ICFILE       321
  2936                                              "$VALORES/ICMVLR-". EAL0028                     ICFILE       322
  2937         07 MAES-FILE5               PIC X(63).                   EAL0028                     ICFILE       323
  2938                                                                  EAL0028                     ICFILE       324
  2939     05  MAES-ICMVLR-TITLE6.                                      EAL0028                     ICFILE       325
  2940         07 MAES-DIRECTORY6          PIC X(16) VALUE              RGH0029                     ICFILE       326
  2941                                              "$VALORES/ICMVLR-". EAL0028                     ICFILE       327
  2942         07 MAES-FILE6               PIC X(63).                   EAL0028                     ICFILE       328
  2943     05 TITLE-BDLDIRACE  PIC X(80) VALUE "$DATABASE/BDLDIRACE".   RGH0032                     ICFILE       329
  2944     05 TITLE-BDLMAIEXC  PIC X(80) VALUE "$DATABASE/BDLMAIEXC".   RGH0032                     ICFILE       330
  2945     05 TITLE-BDLTELEXC  PIC X(80) VALUE "$DATABASE/BDLTELEXC".   RGH0032                     ICFILE       331
  2946     05 TITLE-BDANOM     PIC X(80) VALUE "$DATABASE/BDANOM".      GJC0034                     ICFILE       332
  2947     05 TITLE-FRZMYR     PIC X(80) VALUE "$DATABASE/FRZMYR".      GJC0033                     ICFILE       333
  2948     05 TITLE-DVPDANE    PIC X(80) VALUE "$DATABASE/DVPDANE.DAT". CAV0035                     ICFILE       334
  2949     05 TITLE-CARACT-IND PIC X(80) VALUE                          CAV0036                     ICFILE       335
  2950                                   "$DATABASE/CARACTUSA-INDCL".   CAV0036                     ICFILE       336
  2951     05 FRABDU-TITLE     PIC X(25) VALUE                          FARF037                     ICFILE       337
  2952                                 "$VALORES/frabduact/FRABDU".     FARF037                     ICFILE       338
  2953     05 FRABDV-TITLE     PIC X(29) VALUE                          FARF037                     ICFILE       339
  2954                                 "$VALORES/frabduact/FRABDU.NEW". FARF037                     ICFILE       340
  2955     05 MAES-ICMHCIIU-TITLE PIC X(80) VALUE "$DATABASE/ICMHCIIU". CAV0038                     ICFILE       341
  2956     05 MAES-ICMCONTTRJ-TITLE PIC X(80) VALUE                     CAV0040                     ICFILE       342
  2957                                    "$DATABASE/ICMCONTTRJ".       CAV0040                     ICFILE       343
  2958     05 TITLE-ICBCOB     PIC X(16) VALUE "$DATABASE/ICBCOB".      GJC0041                     ICFILE       344
  2959     05 TITLE-SCODAPJA   PIC X(37) VALUE "$DATABASE/SCODAPJA".    JJM0043                     ICFILE       345
  2960 01 TITLE-BDSCOREHIS.                                             JJM0043                     ICFILE       346
  2961    02 FILLER          PIC X(21) VALUE "$DATABASE/BDSCOREHIS.".   JJM0043                     ICFILE       347
  2962    02 ANO-ANT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2013.            JJM0043                     ICFILE       348
  2963    02 FILLER                    PIC X(01) VALUE "-".             JJM0043                     ICFILE       349
  2964    02 ANO-ACT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2014.            JJM0043                     ICFILE       350
  2965                                                                                                           267
  2966******************************************************************                                         268
  2967* Indica que se termino el proceso, por agotamiento del archivo                                            269
  2968* de entrada (normal) o alguna otra condicion (error)                                                      270
  2969 01  IND-fin-proceso              pic xx value "NO".                                                       271
  2970                                                                                                           272
  2971* Copia del ultimo reg de input, para mensajes (Ult reg: ...)                                              273
  2972 01  JURAD-reg-anterior           pic x(100) value "(vacio)".                                              274
  2973 01  JURAD-fs                     pic xx value spaces.                                                     275
  2974                                                                                                           276
  2975 01  ERRS-fs                      pic xx value spaces.                                                     277
  2976                                                                                                           278
  2977* Datos de demandas o embargos que van en el registro BDIIALE                                              279
  2978 01 D-datahost.                                                                                            280
  2979     05 D-vigentes                pic 9(5).                                                                281
  2980     05 D-terminados              pic 9(5).                                                                282
  2981     05 D-fecha-ultima            pic x(8).                                                                283
  2982******************************************************************                                         284
  2983* Parametros iniciales, de la linea de comando                                                             285
  2984* La linea de comando que contiene los parametros                                                          286
  2985 01 P-command-line                pic x(80) value spaces.                                                  287
  2986 01 P-parametros.                                                                                          288
  2987*    Proceso real: contiene "1" para activar, "2" por defecto                                              289
  2988     03 P-proceso-real            pic x value "2".                                                         290
  2989     88 PROCESO-REAL              value "1".                                                               291
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  53
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  2990                                                                                                           292
  2991*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt                                                 293
  2992     03 P-file-name               pic x(80) value spaces.                                                  294
  2993     03 P-file-name-R             redefines P-file-name.                                                   295
  2994*        JJJJJJ = Codigo de suscriptor JURAD en Experian                                                   296
  2995         05 P-cod-suscriptor      pic 9(6).                                                                297
  2996*        aaa = Codificacion del producto ("100")                                                           298
  2997         05 P-producto            pic xxx.                                                                 299
  2998*        DDMMAA = Fecha de proceso                                                                         300
  2999         05 P-fecha-proceso       pic x(6).                                                                301
  3000*        bb =  01 a CI                                                                                     302
  3001         05 P-ci-bi               pic xx.                                                                  303
  3002*        XX = Tipo de proceso                                                                              304
  3003*        01 Envio Original - Carga TOTAL - primera vez                                                     305
  3004*        02 Archivo Semanal - Carga PARCIAL                                                                306
  3005*        03 Archivo Mensual - Carga PARCIAL                                                                307
  3006*        04 Refresque Total - Carga TOTAL                                                                  308
  3007         05 P-tipo-proceso        pic xx.                                                                  309
  3008*        extension del archivo ".txt"                                                                      310
  3009         05 P-extension           pic x(4).                                                                311
  3010         05                       pic x(57).                                                               312
  3011     03 P-file-path               pic x(80) value spaces.                                                  313
  3012* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs                                                   314
  3013    03 ERRS-file-name             pic x(80) value spaces.                                                  315
  3014                                                                                                           316
  3015* Fecha de proceso editada YYYYMMDD                                                                        317
  3016 01 P-fecha-proceso-YYYYMMDD      pic x(8).                                                                318
  3017* Fecha de proceso + 50 años                                                                               319
  3018 01 P-fecha-proceso-50.                                                                                    320
  3019     03  P-fecha-proceso-50YYYY   pic 9999.                                                                321
  3020     03                           pic x(4).                                                                322
  3021******************************************************************                                         323
  3022* Datos para el reporte final                                                                              324
  3023 01 W-tiempo.                                                                                              325
  3024     03 W-hora-inicio             pic 9(8).                                                                326
  3025     03 W-hora-fin                pic 9(8).                                                                327
  3026 01 N-edit                        pic z(8)B.                                                               328
  3027 01 N-editp100                    redefines N-edit                                                         329
  3028                                  pic z(5)9.9B.                                                            330
  3029 01 N-contadores.                                                                                          331
  3030*    Registros en el archivo de entrada                                                                    332
  3031     03 N-reg-leidos              pic 9(8) value zero.                                                     333
  3032*    Registros procesados sin error                                                                        334
  3033     03 N-reg-OK                  pic 9(8) value zero.                                                     335
  3034*    Registros con error                                                                                   336
  3035     03 N-reg-con-error           pic 9(8) value zero.                                                     337
  3036                                                                                                           338
  3037*    Cantidades de registros por tipo de novedad                                                           339
  3038     03 N-reg-tipo-I-OK           pic 9(8) value zero.                                                     340
  3039     03 N-reg-tipo-M-OK           pic 9(8) value zero.                                                     341
  3040     03 N-reg-tipo-E-OK           pic 9(8) value zero.                                                     342
  3041     03 N-reg-tipo-I-err          pic 9(8) value zero.                                                     343
  3042     03 N-reg-tipo-M-err          pic 9(8) value zero.                                                     344
  3043     03 N-reg-tipo-E-err          pic 9(8) value zero.                                                     345
  3044                                                                                                           346
  3045*    Alertas borradas previo al refresque total                                                            347
  3046     03 N-ale-leidas              pic 9(8) value zero.                                                     348
  3047     03 N-ale-borradas            pic 9(8) value zero.                                                     349
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  54
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3048*    Alertas insertadas                                                                                    350
  3049     03 N-ale-insertadas          pic 9(8) value zero.                                                     351
  3050*    Alertas modificadas                                                                                   352
  3051     03 N-ale-modificadas         pic 9(8) value zero.                                                     353
  3052*    Alertas eliminadas                                                                                    354
  3053     03 N-ale-eliminadas          pic 9(8) value zero.                                                     355
  3054*    Insercion de alerta existente                                                                         356
  3055     03 N-ale-ya-existe           pic 9(8) value zero.                                                     357
  3056*    Modificacion o eliminacion de alerta inexistente                                                      358
  3057     03 N-ale-no-existe           pic 9(8) value zero.                                                     359
  3058                                                                                                           360
  3059*    Sumas de cantidades de demandas y embargos                                                            361
  3060     03 N-demandas-vigentes       pic 9(7).                                                                362
  3061     03 N-demandas-terminadas     pic 9(7).                                                                363
  3062     03 N-embargos-vigentes       pic 9(7).                                                                364
  3063     03 N-embargos-terminados     pic 9(7).                                                                365
  3064                                                                                                           366
  3065******************************************************************                                         367
  3066* Armado de las lineas de alerta                                                                           368
  3067 01 LA-lineas-alerta.                                                                                      369
  3068*    Los modelos a continuacion deberan obtenerse de un                                                    370
  3069*    archivo, como BDIIALE-ALERTAS                                                                         371
  3070     03 LAend                     pic 999 comp value 0.                                                    372
  3071     03 LA-modelos.                                                                                        373
  3072*         12345678901234567890123456789012345678901234567890                                               374
  3073         05 pic x(50) value                                                                                375
  3074         "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".                                             376
  3075         05 pic x(50) value                                                                                377
  3076         "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".                                              378
  3077         05 pic x(50) value                                                                                379
  3078         "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".                                             380
  3079         05 pic x(50) value                                                                                381
  3080         "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".                                             382
  3081         05 pic x(50) value high-values. *> end marker                                                     383
  3082     03 LA-modelos2               redefines LA-modelos.                                                    384
  3083         05 LA-modelo             pic x(50) occurs 5                                                       385
  3084                                  indexed LAm.                                                             386
  3085*    Funcionamiento de los templates.                                                                      387
  3086*    Hay dos templates por de alerta, uno por linea.                                                       388
  3087*    Cada template consiste en hasta 10 frases fijas con                                                   389
  3088*    ampersands (&) donde se van a reemplazar los valores.                                                 390
  3089*    Por ejemplo:                                                                                          391
  3090*    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS                                                            392
  3091*    tiene 3 frases fijas y 2 reemplazos.                                                                  393
  3092*    La cantidad de ampersands es irrelevante, pero parece                                                 394
  3093*    conveniente que informe sobre el tamanio del contenido.                                               395
  3094     03 LA-templates.                                                                                      396
  3095         05 LA-template           occurs 4 indexed LAx.                                                    397
  3096             07 LA-parte          pic x(50)                                                                398
  3097                                  occurs 10 indexed LAy.                                                   399
  3098*    Las dos lineas armadas                                                                                400
  3099     03 LA-lineas.                                                                                         401
  3100         05 LA-linea1             pic x(50).                                                               402
  3101         05 LA-linea2             pic x(50).                                                               403
  3102*    Los valores a insertar en una linea                                                                   404
  3103     03 LA-valores.                                                                                        405
  3104         05 LA-valor              pic x(50)                                                                406
  3105                                  occurs 10 indexed LAv.                                                   407
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  55
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3106*    Datos para editar valores a insertar                                                                  408
  3107     03 LA-num                    pic -(11)0.                                                              409
  3108     03 LA-numX                   redefines LA-num                                                         410
  3109                                  pic x(12).                                                               411
  3110     03 LA-descarte               pic x(50).                                                               412
  3111                                                                                                           413
  3112                                                                                                           414
  3113******************************************************************                                         415
  3114* Errores de consistencia del input                                                                        416
  3115* Cada error tiene un codigo de 2 digitos, un espacio, contador                                            417
  3116* de ocurrencias de 7 digitos, un espacio, y descripcion de 59                                             418
  3117 01 E-errores.                                                                                             419
  3118*    indica si el registro actual tiene error                                                              420
  3119     03 E-hay-error               pic xx value "NO".                                                       421
  3120*    errores del registro actual                                                                           422
  3121     03 E-errores-reg             pic x(300) value spaces.                                                 423
  3122*    contador de registros con error                                                                       424
  3123     03 E-cont-regs-con-error     pic 9(8) value zero.                                                     425
  3124*    tabla de errores                                                                                      426
  3125     03 pic x(11) value "01 0000000 ".                                                                     427
  3126     03 pic x(59) value                                                                                    428
  3127     "Tipo de movimiento invalido, debe ser I M E T".                                                      429
  3128     03 pic x(11) value "02 0000000 ".                                                                     430
  3129     03 pic x(59) value                                                                                    431
  3130     "Tipo de identificacion invalido, debe ser 1 2 3 4".                                                  432
  3131     03 pic x(11) value "03 0000000 ".                                                                     433
  3132     03 pic x(59) value                                                                                    434
  3133     "Numero de identificacion invalido, debe ser numerico".                                               435
  3134     03 pic x(11) value "04 0000000 ".                                                                     436
  3135     03 pic x(59) value                                                                                    437
  3136     "Tipo de identificacion debe ser mayor que cero".                                                     438
  3137     03 pic x(11) value "05 0000000 ".                                                                     439
  3138     03 pic x(59) value                                                                                    440
  3139     "Falta el nombre o denominacion".                                                                     441
  3140     03 pic x(11) value "06 0000000 ".                                                                     442
  3141     03 pic x(59) value                                                                                    443
  3142     "Numero de demandas vigentes: debe ser numerico".                                                     444
  3143     03 pic x(11) value "07 0000000 ".                                                                     445
  3144     03 pic x(59) value                                                                                    446
  3145     "Numero de demandas terminadas: debe ser numerico".                                                   447
  3146     03 pic x(11) value "08 0000000 ".                                                                     448
  3147     03 pic x(59) value                                                                                    449
  3148     "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".                                           450
  3149     03 pic x(11) value "09 0000000 ".                                                                     451
  3150     03 pic x(59) value                                                                                    452
  3151     "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".                                              453
  3152     03 pic x(11) value "10 0000000 ".                                                                     454
  3153     03 pic x(59) value                                                                                    455
  3154     "Numero de embargos vigentes: debe ser numerico".                                                     456
  3155     03 pic x(11) value "11 0000000 ".                                                                     457
  3156     03 pic x(59) value                                                                                    458
  3157     "Numero de embargos terminados: debe ser numerico".                                                   459
  3158     03 pic x(11) value "12 0000000 ".                                                                     460
  3159     03 pic x(59) value                                                                                    461
  3160     "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".                                           462
  3161     03 pic x(11) value "13 0000000 ".                                                                     463
  3162     03 pic x(59) value                                                                                    464
  3163     "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".                                              465
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  56
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3164     03 pic x(11) value "14 0000000 ".                                                                     466
  3165     03 pic x(59) value                                                                                    467
  3166     "El numero de id no se encuentra en el archivo maestro".                                              468
  3167     03 pic x(11) value "15 0000000 ".                                                                     469
  3168     03 pic x(59) value                                                                                    470
  3169     "El nombre en el input no coincide con el registrado".                                                471
  3170     03 pic x(11) value "16 0000000 ".                                                                     472
  3171     03 pic x(59) value                                                                                    473
  3172     "Numero de id fuera del rango del tipo de id informado".                                              474
  3173     03 pic x(11) value "17 0000000 ".                                                                     475
  3174     03 pic x(59) value                                                                                    476
  3175     "Modificación de alerta inexistente".                                                                 477
  3176     03 pic x(11) value "18 0000000 ".                                                                     478
  3177     03 pic x(59) value                                                                                    479
  3178     "Eliminación de alerta inexistente".                                                                  480
  3179*----------------- insertar nuevos items aqui -------------------                                          481
  3180     03 pic x(11) value "00 0000000 ".                                                                     482
  3181     03 pic x(59) value "--- fin de la lista (cod 00) ---".                                                483
  3182     03                           pic x(3500). *> los 50 items                                             484
  3183 01 E-errores-2                   redefines E-errores.                                                     485
  3184     03                           pic xx.                                                                  486
  3185     03                           pic x(300).                                                              487
  3186     03                           pic 9(8).                                                                488
  3187     03 E-error                   occurs 50 indexed Ex.                                                    489
  3188         05 E-codigo              pic xx.                                                                  490
  3189         05                       pic x.                                                                   491
  3190         05 E-contador            pic 9(7).                                                                492
  3191         05                       pic x.                                                                   493
  3192         05 E-descripcion         pic x(59).                                                               494
  3193 01 E-edit                        pic z(8)B.                                                               495
  3194                                                                                                           496
  3195******************************************************************                                         497
  3196* Control de rangos de valores de las fechas del input                                                     498
  3197 01 VALIDACIONES-FECHAS.                                                                                   499
  3198     02 ANO-VAL-X                 pic 9(04).                                                               500
  3199        88 ANO-VAL                value 1900 thru 2050.                                                    501
  3200     02 MES-VAL-X                 pic 9(02).                                                               502
  3201        88 MES-VAL                value 01   thru 12.                                                      503
  3202     02 DIA-VAL-X                 pic 9(02).                                                               504
  3203        88 DIA-VAL                value 01   thru 31.                                                      505
  3204                                                                                                           506
  3205                                                                                                           507
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  57
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3206/*****************************************************************                                         508
  3207******************************************************************                                         509
  3208 PROCEDURE DIVISION.                                                                                       510
  3209                                                                                                           511
  3210* 0000-PROGRAMA-PRINCIPAL                                                                                  512
  3211* 4000-PROCESAR-REGISTRO                                                                                   513
  3212* 4000-PROCESAR-REGISTRO-2                                                                                 514
  3213* 4100-VALIDACION-FORMAL                                                                                   515
  3214* 4200-VALIDACION-SEMANTICA                                                                                516
  3215* 4300-MODIFICAR-BDIIALE                                                                                   517
  3216* 4300-MODIFICAR-BDIIALE-DATOS                                                                             518
  3217* 4300-MODIFICAR-BDIIALE-I                                                                                 519
  3218* 4300-MODIFICAR-BDIIALE-M                                                                                 520
  3219* 4300-MODIFICAR-BDIIALE-E                                                                                 521
  3220* 4333-LEER-BDIIALE-RANDOM                                                                                 522
  3221* 4333-GRABAR-BDIIALE                                                                                      523
  3222* 4333-REGRABAR-BDIIALE                                                                                    524
  3223* 4333-ELIMINAR-BDIIALE                                                                                    525
  3224* 4800-PROCESO-REG-T                                                                                       526
  3225* 4900-GRABAR-ERROR                                                                                        527
  3226* 4320-ARMAR-TEXTO-ALERTA                                                                                  528
  3227* 1000-RUTINA-INICIAL                                                                                      529
  3228* 1022-CARGAR-INCONSISTENTES                                                                               530
  3229* 1000-NOT-USED                                                                                            531
  3230* 1001-ELIMINAR-TODO                                                                                       532
  3231* 7000-RUTINA-FINAL                                                                                        533
  3232* 9000-CANCELAR-PROGRAMA                                                                                   534
  3233                                                                                                           535
  3234                                                                                                           536
  3235 0000-PROGRAMA-PRINCIPAL.                                                                                  537
  3236******************************************************************                                         538
  3237*    inicializa el ambiente y abre los archivos                                                            539
  3238     perform 1000-RUTINA-INICIAL                                                                           540
  3239*    procesa cada uno de los registros del archivo JURAD hasta                                             541
  3240*    encontrar el registro "T" de totales                                                                  542
  3241     perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"                                           543
  3242*    cierra archivos y produce el reporte final                                                            544
  3243     perform 7000-RUTINA-FINAL                                                                             545
  3244     goback.                                                                                               546
  3245                                                                                                           547
  3246 4000-PROCESAR-REGISTRO.                                                                                   548
  3247****************************************************************                                           549
  3248* Proceso de un registro del archivo de entrada JURAD                                                      550
  3249* Lectura y control del file status del archivo                                                            551
  3250****************************************************************                                           552
  3251*    lectura del proximo registro                                                                          553
  3252     read JURAD                                                                                            554
  3253     evaluate JURAD-fs                                                                                     555
  3254     when "00"                                                                                             556
  3255*        controla el reg y lo aplica si es OK                                                              557
  3256         perform 4000-PROCESAR-REGISTRO-2                                                                  558
  3257         move JURAD-reg to JURAD-reg-anterior                                                              559
  3258     when "10"                                                                                             560
  3259*        fin del archivo de input:                                                                         561
  3260*        esto es un error, no se encontro el registro "T" antes                                            562
  3261*        de que se terminara el archivo                                                                    563
  3262         display "Falta el reg de totales del archivo JURAD "                                              564
  3263         display "Nombre del archivo: " P-file-name                                                        565
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  58
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3264         display "File status: " JURAD-fs                                                                  566
  3265         display "Ultimo registro leido: " N-reg-leidos                                                    567
  3266         display JURAD-reg-anterior                                                                        568
  3267         perform 9000-CANCELAR-PROGRAMA                                                                    569
  3268     when other                                                                                            570
  3269*        error de lectura: cancelacion del proceso                                                         571
  3270         display "Error en lectura del archivo JURAD "                                                     572
  3271         display "Nombre del archivo: " P-file-name                                                        573
  3272         display "File status: " JURAD-fs                                                                  574
  3273         display "Ultimo registro leido: " N-reg-leidos                                                    575
  3274         display JURAD-reg-anterior                                                                        576
  3275         perform 9000-CANCELAR-PROGRAMA                                                                    577
  3276     end-evaluate.                                                                                         578
  3277                                                                                                           579
  3278                                                                                                           580
  3279 4000-PROCESAR-REGISTRO-2.                                                                                 581
  3280****************************************************************                                           582
  3281* Controla los datos de un registro de JURAD y si es OK lo usa                                             583
  3282* para actualizar el archivo de alertas en linea                                                           584
  3283* La informacion esta leida en JURAD-reg                                                                   585
  3284****************************************************************                                           586
  3285     move "NO" to E-hay-error                                                                              587
  3286                                                                                                           588
  3287*    validacion del tipo de movimiento                                                                     589
  3288     if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"                                               590
  3289         call "PONERR" using "01" JURAD-reg E-errores                                                      591
  3290     end-if                                                                                                592
  3291                                                                                                           593
  3292*    si es el registro "T" hay que señalar el fin de proceso                                               594
  3293     if JURAD-tipo-novedad = "T"                                                                           595
  3294         move "SI" to IND-fin-proceso                                                                      596
  3295         perform 4800-PROCESO-REG-T                                                                        597
  3296         exit paragraph                                                                                    598
  3297     end-if                                                                                                599
  3298                                                                                                           600
  3299     add 1 to N-reg-leidos                                                                                 601
  3300                                                                                                           602
  3301*    validacion formal de los datos                                                                        603
  3302     move 0 to codigo-error                                                                                604
  3303     perform 4100-VALIDACION-FORMAL                                                                        605
  3304     if E-hay-error = "SI"                                                                                 606
  3305         perform 4900-GRABAR-ERROR                                                                         607
  3306         perform 4240-CONTAR-TIPO-CUENTA                                                                   608
  3307         exit paragraph                                                                                    609
  3308     end-if                                                                                                610
  3309                                                                                                           611
  3310*    si la validacion formal dio OK se hace validacion semantica                                           612
  3311     perform 4200-VALIDACION-SEMANTICA                                                                     613
  3312     if E-hay-error = "SI"                                                                                 614
  3313         perform 4900-GRABAR-ERROR                                                                         615
  3314         perform 4240-CONTAR-TIPO-CUENTA                                                                   616
  3315         exit paragraph                                                                                    617
  3316     end-if                                                                                                618
  3317                                                                                                           619
  3318     perform 4240-CONTAR-TIPO-CUENTA                                                                       620
  3319                                                                                                           621
  3320*    intento de actualizacion de BDIIALE                                                                   622
  3321     perform 4300-MODIFICAR-BDIIALE                                                                        623
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  59
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3322     add 1 to N-reg-OK.                                                                                    624
  3323                                                                                                           625
  3324                                                                                                           626
  3325                                                                                                           627
  3326 4100-VALIDACION-FORMAL.                                                                                   628
  3327******************************************************************                                         629
  3328* Validacion formal de los datos del input                                                                 630
  3329******************************************************************                                         631
  3330*    Tipo de identificacion Numero {1, 2, 3, 4}                                                            632
  3331     if JURAD-id-tipo not = "1" and "2" and "3" and "4"                                                    633
  3332         call "PONERR" using "02" JURAD-reg E-errores                                                      634
  3333         move 05 to codigo-error                                                                           635
  3334     end-if                                                                                                636
  3335*    Numero de identificacion                                                                              637
  3336     if JURAD-id-numeroX is not numeric                                                                    638
  3337         call "PONERR" using "03" JURAD-reg E-errores                                                      639
  3338     end-if                                                                                                640
  3339     if JURAD-id-numero not > 0                                                                            641
  3340         call "PONERR" using "04" JURAD-reg E-errores                                                      642
  3341     end-if                                                                                                643
  3342*    si el movimiento es una eliminacion los datos subsiguientes                                           644
  3343*    no se controlan                                                                                       645
  3344     if JURAD-tipo-novedad = "E"                                                                           646
  3345         exit paragraph                                                                                    647
  3346     end-if                                                                                                648
  3347*    Nombres y Apellidos                                                                                   649
  3348     if JURAD-nombre = spaces                                                                              650
  3349         call "PONERR" using "05" JURAD-reg E-errores                                                      651
  3350     end-if                                                                                                652
  3351*    Numero de demandas vigentes                                                                           653
  3352     if JURAD-demandas-vigentes is not numeric                                                             654
  3353         call "PONERR" using "06" JURAD-reg E-errores                                                      655
  3354     end-if                                                                                                656
  3355*    Numero de demandas terminadas                                                                         657
  3356     if JURAD-demandas-terminadas is not numeric                                                           658
  3357         call "PONERR" using "07" JURAD-reg E-errores                                                      659
  3358     end-if                                                                                                660
  3359*    Fecha ultima demanda vigente YYMMDD                                                                   661
  3360     if JURAD-demandas-fecha-ultima is not numeric                                                         662
  3361         call "PONERR" using "08" JURAD-reg E-errores                                                      663
  3362     end-if                                                                                                664
  3363     move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS                                               665
  3364     if not ANO-VAL or not MES-VAL or not DIA-VAL                                                          666
  3365         call "PONERR" using "09" JURAD-reg E-errores                                                      667
  3366     end-if                                                                                                668
  3367*    Numero de embargos vigentes                                                                           669
  3368     if JURAD-embargos-vigentes not numeric                                                                670
  3369         call "PONERR" using "10" JURAD-reg E-errores                                                      671
  3370     end-if                                                                                                672
  3371*    Numero de embargos terminados                                                                         673
  3372     if JURAD-embargos-terminados not numeric                                                              674
  3373         call "PONERR" using "11" JURAD-reg E-errores                                                      675
  3374     end-if                                                                                                676
  3375*    Fecha ultimo embargo vigente YYMMDD                                                                   677
  3376     if JURAD-embargos-fecha-ultimo is not numeric                                                         678
  3377         call "PONERR" using "12" JURAD-reg E-errores                                                      679
  3378     end-if                                                                                                680
  3379     move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS                                               681
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  60
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3380     if not ANO-VAL or not MES-VAL or not DIA-VAL                                                          682
  3381         call "PONERR" using "13" JURAD-reg E-errores                                                      683
  3382     end-if.                                                                                               684
  3383                                                                                                           685
  3384                                                                                                           686
  3385 4200-VALIDACION-SEMANTICA.                                                                                687
  3386****************************************************************                                           688
  3387* Validacion del numero de identificacion y de su relacion con                                             689
  3388* el nombre                                                                                                690
  3389****************************************************************                                           691
  3390     move JURAD-id-tipo to TIP-IDE-BDIIVIDE                                                                692
  3391     move JURAD-id-numero to NUM-IDE-BDIIVIDE-R                                                            693
  3392     move JURAD-nombre to NOMBRE-BDIIVIDE                                                                  694
  3393                                                                                                           695
  3394     move JURAD-id-tipo to TIPOID-E                                                                        696
  3395     move JURAD-id-numero to NUMID-E                                                                       697
  3396     move JURAD-nombre to NOMBRE-E                                                                         698
  3397                                                                                                           699
  3398     move 1 to SW-VERIFNOM-BDIIVIDE                                                                        700
  3399     move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE                                                 701
  3400     IF TIP-IDE-BDIIVIDE = 2 OR 3                                                                          702
  3401         MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE                                                                  703
  3402     END-IF                                                                                                704
  3403     MOVE 2 TO NUM-BLOQUES-BDIIVIDE                                                                        705
  3404*    Valida el numero de identificación contra las bases de                                                706
  3405*    datos de validación de información BDIIDIAN, BDIIDAS,                                                 707
  3406*    BDIIREGI y verifica la coincidencia del nombre reportado                                              708
  3407*    Retorna SW-ID-BDIIVIDE=1 si hay error                                                                 709
  3408     perform 80100-VALIDAR-IDENTIFICACION                                                                  710
  3409*    a ver si la validacion cambio el tipo de ide                                                          711
  3410     if JURAD-id-tipo not = TIP-IDE-BDIIVIDE                                                               712
  3411         call "PONERR" using "16" JURAD-reg E-errores                                                      713
  3412         display "Tipo ide cambiado de " JURAD-id-tipo " a "                                               714
  3413         TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero                                                     715
  3414     end-if                                                                                                716
  3415*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe                                                     717
  3416     if SW-ID-BDIIVIDE = 1                                                                                 718
  3417*        es un id inválido                                                                                 719
  3418         call "PONERR" using "14" JURAD-reg E-errores                                                      720
  3419*        valida contra la base alterna                                                                     721
  3420         call "PONERR" using "14" JURAD-reg E-errores                                                      722
  3421         perform 4210-VALIDACION-ID-NO-FIGURA                                                              723
  3422     else                                                                                                  724
  3423*        existe id, a ver si el nombre coincide                                                            725
  3424         if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide                                               726
  3425             call "PONERR" using "15" JURAD-reg E-errores                                                  727
  3426             display "novedad:  " JURAD-nombre                                                             728
  3427             display "registro: " NOM-LEIDO-BDIIVIDE                                                       729
  3428*            validación en base alterna                                                                    730
  3429             perform 4220-VALIDA-NOMBRE-NO-COINCIDE                                                        731
  3430         else                                                                                              732
  3431             perform 4222-VALIDA-NOMBRE-COINCIDE                                                           733
  3432         end-if                                                                                            734
  3433     end-if.                                                                                               735
  3434                                                                                                           736
  3435                                                                                                           737
  3436 4220-VALIDA-NOMBRE-NO-COINCIDE.                                                                           738
  3437******************************************************************                                         739
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  61
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3438* Validación de IDs que figuran OK pero el nombre no coincide                                              740
  3439******************************************************************                                         741
  3440*    nombre no coincide                                                                                    742
  3441     IF TIP-IDE-BDIIVIDE = 1                                                                               743
  3442*        es una cédula                                                                                     744
  3443         MOVE 02 TO CODIGO-ERROR                                                                           745
  3444     ELSE                                                                                                  746
  3445*        no es una cédula                                                                                  747
  3446         MOVE 01 TO CODIGO-ERROR                                                                           748
  3447     END-IF.                                                                                               749
  3448                                                                                                           750
  3449                                                                                                           751
  3450 4222-VALIDA-NOMBRE-COINCIDE.                                                                              752
  3451******************************************************************                                         753
  3452* Validación de IDs que figuran OK pero el nombre coincide                                                 754
  3453******************************************************************                                         755
  3454*    nombre coincide: busca ID en BDIIALE                                                                  756
  3455     initialize LLAVE-BDIIALE                                                                              757
  3456     move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE                                                              758
  3457     move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE                                                            759
  3458     move 990003 to FUENTE-BDIIALE                                                                         760
  3459     start BDIIALE key not < LLAVE-BDIIALE INVALID KEY                                                     761
  3460         move 1 TO SW-BDIIALE                                                                              762
  3461     not invalid key                                                                                       763
  3462         move 0 to SW-BDIIALE                                                                              764
  3463         read BDIIALE next record                                                                          765
  3464         at end                                                                                            766
  3465             move 1 to SW-BDIIALE                                                                          767
  3466         end-read                                                                                          768
  3467     end-start                                                                                             769
  3468                                                                                                           770
  3469     perform until SW-BDIIALE = 1                                                                          771
  3470     or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE                                                                772
  3471     or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE                                                                773
  3472         if FUENTE-BDIIALE = 990003                                                                        774
  3473         and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD                                                   775
  3474         and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD                                                   776
  3475         and BLOQUEO-BDIIALE = 0                                                                           777
  3476*             encontrado                                                                                   778
  3477              move 1 to SW-BDIIALE                                                                         779
  3478         end-if                                                                                            780
  3479         if SW-BDIIALE = 0                                                                                 781
  3480             read BDIIALE next record at end                                                               782
  3481                 move 1 to SW-BDIIALE                                                                      783
  3482             end-read                                                                                      784
  3483         end-if                                                                                            785
  3484     end-perform.                                                                                          786
  3485                                                                                                           787
  3486     if TIP-IDE-BDIIVIDE = 1                                                                               788
  3487         if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1                                                    789
  3488             move 07 to CODIGO-ERROR                                                                       790
  3489         else                                                                                              791
  3490             if ESTADO-VIG-BDIIREGI = 21                                                                   792
  3491                 move 06 to CODIGO-ERROR                                                                   793
  3492                 add 1 to NO-COINCIDE-REGIS                                                                794
  3493                 add 1 to CONT-FALLECIDOS                                                                  795
  3494             end-if                                                                                        796
  3495         end-if                                                                                            797
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  62
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3496     end-if.                                                                                               798
  3497                                                                                                           799
  3498                                                                                                           800
  3499 4240-CONTAR-TIPO-CUENTA.                                                                                  801
  3500******************************************************************                                         802
  3501*    Conteo de los registros por "tipo", dependiendo del código                                            803
  3502*    de error:                                                                                             804
  3503*    tipo 5: sin error                                                                                     805
  3504*    tipo 6: 01 02 06 07                                                                                   806
  3505*    tipo 7: 03 04 05                                                                                      807
  3506******************************************************************                                         808
  3507     IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07                                                                809
  3508         ADD 1 TO W-CONT-TIPO-6                                                                            810
  3509     ELSE                                                                                                  811
  3510         IF CODIGO-ERROR = 03 OR 04 OR 05                                                                  812
  3511             ADD 1 TO W-CONT-TIPO-7                                                                        813
  3512         ELSE                                                                                              814
  3513*            registros correctos, repetidos o no                                                           815
  3514             ADD 1 TO W-CONT-TIPO-5                                                                        816
  3515*            si es una empresa                                                                             817
  3516             IF TIPOID-E = 2 OR 3                                                                          818
  3517                 ADD 1 TO W-CONT-TIPO-5-PJ                                                                 819
  3518             END-IF                                                                                        820
  3519         END-IF                                                                                            821
  3520     END-IF.                                                                                               822
  3521                                                                                                           823
  3522                                                                                                           824
  3523 4210-VALIDACION-ID-NO-FIGURA.                                                                             825
  3524******************************************************************                                         826
  3525* Validación de IDs que no figuran en las bases normales                                                   827
  3526******************************************************************                                         828
  3527     MOVE 0 TO HACER-MATCH                                                                                 829
  3528     MOVE 0 TO IDE-TIPO-BDAMATCH                                                                           830
  3529*    valida si la identificación está en la base de datos                                                  831
  3530*    alterna                                                                                               832
  3531     PERFORM 513-VALIDA-EN-CSV                                                                             833
  3532     IF IDE-TIPO-BDAMATCH = 0                                                                              834
  3533         IF TIP-IDE-BDIIVIDE = 1                                                                           835
  3534*            es una cédula                                                                                 836
  3535             MOVE 04 TO CODIGO-ERROR                                                                       837
  3536         else                                                                                              838
  3537*            no es una cédula                                                                              839
  3538             MOVE 03 TO CODIGO-ERROR                                                                       840
  3539         END-IF                                                                                            841
  3540     END-IF.                                                                                               842
  3541                                                                                                           843
  3542                                                                                                           844
  3543 4300-MODIFICAR-BDIIALE.                                                                                   845
  3544******************************************************************                                         846
  3545* Se impacta el archivo BDIIALE con una o dos inserciones,                                                 847
  3546* modificaciones o eliminaciones segun haya o no demandas y                                                848
  3547* embargos                                                                                                 849
  3548******************************************************************                                         850
  3549     initialize REG-BDIIALE                                                                                851
  3550                                                                                                           852
  3551*    si hay demandas                                                                                       853
  3552     if JURAD-demandas-vigentes > zero                                                                     854
  3553     or JURAD-demandas-terminadas > zero                                                                   855
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  63
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3554         move "J001" to LLASEC-BDIIALE                                                                     856
  3555*        arma datos de demandas                                                                            857
  3556         move JURAD-demandas-vigentes to D-vigentes                                                        858
  3557         move JURAD-demandas-terminadas to D-terminados                                                    859
  3558         string "20" JURAD-demandas-fecha-ultima                                                           860
  3559         delimited size into D-fecha-ultima                                                                861
  3560         perform 4300-MODIFICAR-BDIIALE-DATOS                                                              862
  3561     end-if.                                                                                               863
  3562                                                                                                           864
  3563*    si hay embargos                                                                                       865
  3564     if JURAD-embargos-vigentes > zero                                                                     866
  3565     or JURAD-embargos-terminados > zero                                                                   867
  3566         move "J002" to LLASEC-BDIIALE                                                                     868
  3567*        arma datos de embargos                                                                            869
  3568         move JURAD-embargos-vigentes to D-vigentes                                                        870
  3569         move JURAD-embargos-terminados to D-terminados                                                    871
  3570         string "20" JURAD-embargos-fecha-ultimo                                                           872
  3571         delimited size into D-fecha-ultima                                                                873
  3572         perform 4300-MODIFICAR-BDIIALE-DATOS                                                              874
  3573     end-if.                                                                                               875
  3574                                                                                                           876
  3575                                                                                                           877
  3576                                                                                                           878
  3577 4300-MODIFICAR-BDIIALE-DATOS.                                                                             879
  3578******************************************************************                                         880
  3579* Parte de la carga de datos en el registro BDIIALE y grabacion                                            881
  3580* del mismo que es comun a demandas y embargos                                                             882
  3581* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"                                                          883
  3582******************************************************************                                         884
  3583*    completa la clave e intenta leer la alerta, si se leyo OK                                             885
  3584*    el file status de BDIIALE queda con "00"                                                              886
  3585     perform 4333-LEER-BDIIALE-RANDOM                                                                      887
  3586                                                                                                           888
  3587*    procesa segun el tipo de novedad I M E                                                                889
  3588     evaluate JURAD-tipo-novedad                                                                           890
  3589     when "I"                                                                                              891
  3590         add 1 to N-reg-tipo-I-OK                                                                          892
  3591         perform 4300-MODIFICAR-BDIIALE-I                                                                  893
  3592     when "M"                                                                                              894
  3593         add 1 to N-reg-tipo-M-OK                                                                          895
  3594         perform 4300-MODIFICAR-BDIIALE-M                                                                  896
  3595     when "E"                                                                                              897
  3596         add 1 to N-reg-tipo-E-OK                                                                          898
  3597         perform 4300-MODIFICAR-BDIIALE-E                                                                  899
  3598     when other                                                                                            900
  3599*        esto es "imposible" por control de consistencia anterior                                          901
  3600         display "error de logica: tipo-novedad="                                                          902
  3601         JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos                                                      903
  3602         display "Registro de JURAD: " display JURAD-reg                                                   904
  3603         perform 9000-CANCELAR-PROGRAMA                                                                    905
  3604     end-evaluate.                                                                                         906
  3605                                                                                                           907
  3606                                                                                                           908
  3607 4300-MODIFICAR-BDIIALE-I.                                                                                 909
  3608******************************************************************                                         910
  3609* Insercion de una alerta nueva                                                                            911
  3610* Si ya existia muestra un mensaje y continua                                                              912
  3611******************************************************************                                         913
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  64
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3612*    si el registro existia es un error                                                                    914
  3613     if EST-BDIIALE = "00"                                                                                 915
  3614         display "Insercion de alerta nueva que ya existe "                                                916
  3615         " key: " LLAVE-BDIIALE                                                                            917
  3616         display "Registro de input: "                                                                     918
  3617         display JURAD-reg                                                                                 919
  3618         display "Datos en la alerta: " INF-DATAHOST-BDIIALE                                               920
  3619         add 1 to N-ale-ya-existe                                                                          921
  3620     end-if                                                                                                922
  3621                                                                                                           923
  3622*    completa los datos del registro                                                                       924
  3623     initialize ENCABEZADO-BDIIALE                                                                         925
  3624     move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE                                                      926
  3625     FEC-REP-BDIIALE                                                                                       927
  3626     move P-fecha-proceso-50 to FEC-VEN-BDIIALE                                                            928
  3627     move 0 to BLOQUEO-BDIIALE                                                                             929
  3628     move D-datahost to INF-DATAHOST-BDIIALE                                                               930
  3629     perform 4320-ARMAR-TEXTO-ALERTA                                                                       931
  3630     if EST-BDIIALE = "00"                                                                                 932
  3631         perform 4333-REGRABAR-BDIIALE                                                                     933
  3632     else                                                                                                  934
  3633         perform 4333-GRABAR-BDIIALE                                                                       935
  3634     end-if.                                                                                               936
  3635*    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE                                                   937
  3636*    " fs:" EST-BDIIALE.                                                                                   938
  3637                                                                                                           939
  3638                                                                                                           940
  3639 4300-MODIFICAR-BDIIALE-M.                                                                                 941
  3640******************************************************************                                         942
  3641* Modificacion de una alerta existente                                                                     943
  3642* Si no existia muestra un mensaje y continua                                                              944
  3643******************************************************************                                         945
  3644*    si el registro no existia es un error                                                                 946
  3645     if EST-BDIIALE not = "00"                                                                             947
  3646         display "Modificacion de alerta inexistente "                                                     948
  3647         " key: " LLAVE-BDIIALE                                                                            949
  3648         display "Registro de input: "                                                                     950
  3649         display JURAD-reg                                                                                 951
  3650         display "Datos en la alerta: " INF-DATAHOST-BDIIALE                                               952
  3651         add 1 to N-ale-no-existe                                                                          953
  3652         call "PONERR" using "17" JURAD-reg E-errores                                                      954
  3653     end-if                                                                                                955
  3654*    reemplaza la fecha de reporte y los valores                                                           956
  3655     move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE                                                      957
  3656     move D-datahost to INF-DATAHOST-BDIIALE                                                               958
  3657     perform 4320-ARMAR-TEXTO-ALERTA                                                                       959
  3658     if EST-BDIIALE = "00"                                                                                 960
  3659         perform 4333-REGRABAR-BDIIALE                                                                     961
  3660     else                                                                                                  962
  3661         perform 4333-GRABAR-BDIIALE                                                                       963
  3662     end-if.                                                                                               964
  3663*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE                                                   965
  3664*    " fs:" EST-BDIIALE.                                                                                   966
  3665                                                                                                           967
  3666                                                                                                           968
  3667 4300-MODIFICAR-BDIIALE-E.                                                                                 969
  3668******************************************************************                                         970
  3669* Eliminacion de una alerta                                                                                971
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  65
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3670* Si no existia muestra un mensaje y continua                                                              972
  3671******************************************************************                                         973
  3672*    elimina el registro                                                                                   974
  3673     if EST-BDIIALE = "00"                                                                                 975
  3674         perform 4333-ELIMINAR-BDIIALE                                                                     976
  3675     else                                                                                                  977
  3676         display "Eliminacion de alerta inexistente "                                                      978
  3677         " key: " LLAVE-BDIIALE                                                                            979
  3678         display "Registro de input: "                                                                     980
  3679         display JURAD-reg                                                                                 981
  3680         add 1 to N-ale-no-existe                                                                          982
  3681         call "PONERR" using "18" JURAD-reg E-errores                                                      983
  3682     end-if.                                                                                               984
  3683*    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE                                                   985
  3684*    " fs:" EST-BDIIALE.                                                                                   986
  3685                                                                                                           987
  3686                                                                                                           988
  3687 4333-LEER-BDIIALE-RANDOM.                                                                                 989
  3688******************************************************************                                         990
  3689* Arma clave exacta y lee un registro de BDIIALE                                                           991
  3690* Usa los datos del reg input, excepto LLASEC que esta precargado                                          992
  3691* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"                                            993
  3692******************************************************************                                         994
  3693     move JURAD-id-tipo to TIP-IDE-BDIIALE                                                                 995
  3694     move JURAD-id-numero to NUM-IDE-BDIIALE                                                               996
  3695     move P-cod-suscriptor to FUENTE-BDIIALE                                                               997
  3696     move 000 to COD-ALERTA-BDIIALE                                                                        998
  3697*    LLASEC-BDIIALE fué previamente cargado con J001 o J002                                                999
  3698                                                                                                          1000
  3699     read BDIIALE                                                                                         1001
  3700     evaluate EST-BDIIALE                                                                                 1002
  3701     when "00"                                                                                            1003
  3702         continue                                                                                         1004
  3703     when "23"                                                                                            1005
  3704         continue                                                                                         1006
  3705     when other                                                                                           1007
  3706         display "Error al leer BDIIALE fs: " EST-BDIIALE                                                 1008
  3707         " key: " LLAVE-BDIIALE                                                                           1009
  3708         display "Ultimo registro procesado: "                                                            1010
  3709         display JURAD-reg-anterior                                                                       1011
  3710         perform 9000-CANCELAR-PROGRAMA                                                                   1012
  3711     end-evaluate.                                                                                        1013
  3712*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE                                                  1014
  3713*    " fs:" EST-BDIIALE.                                                                                  1015
  3714                                                                                                          1016
  3715                                                                                                          1017
  3716 4333-GRABAR-BDIIALE.                                                                                     1018
  3717******************************************************************                                        1019
  3718* Inserta un registro nuevo en BDIIALE                                                                    1020
  3719******************************************************************                                        1021
  3720     if not PROCESO-REAL                                                                                  1022
  3721         exit paragraph                                                                                   1023
  3722     end-if                                                                                               1024
  3723     write REG-BDIIALE                                                                                    1025
  3724     evaluate EST-BDIIALE                                                                                 1026
  3725     when "00"                                                                                            1027
  3726         add 1 to N-ale-insertadas                                                                        1028
  3727     when other                                                                                           1029
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  66
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3728         display "Error al grabar BDIIALE fs: " EST-BDIIALE                                               1030
  3729         " key: " LLAVE-BDIIALE                                                                           1031
  3730         display "Registro BDIIALE: "                                                                     1032
  3731         display REG-BDIIALE                                                                              1033
  3732         perform 9000-CANCELAR-PROGRAMA                                                                   1034
  3733     end-evaluate.                                                                                        1035
  3734                                                                                                          1036
  3735                                                                                                          1037
  3736 4333-REGRABAR-BDIIALE.                                                                                   1038
  3737******************************************************************                                        1039
  3738* Regraba un registro modificado en BDIIALE                                                               1040
  3739******************************************************************                                        1041
  3740     if not PROCESO-REAL                                                                                  1042
  3741         exit paragraph                                                                                   1043
  3742     end-if                                                                                               1044
  3743     rewrite REG-BDIIALE                                                                                  1045
  3744     evaluate EST-BDIIALE                                                                                 1046
  3745     when "00"                                                                                            1047
  3746         add 1 to N-ale-modificadas                                                                       1048
  3747     when other                                                                                           1049
  3748         display "Error al regrabar BDIIALE fs: " EST-BDIIALE                                             1050
  3749         " key: " LLAVE-BDIIALE                                                                           1051
  3750         display "Registro BDIIALE: "                                                                     1052
  3751         display REG-BDIIALE                                                                              1053
  3752         perform 9000-CANCELAR-PROGRAMA                                                                   1054
  3753     end-evaluate.                                                                                        1055
  3754                                                                                                          1056
  3755                                                                                                          1057
  3756 4333-ELIMINAR-BDIIALE.                                                                                   1058
  3757******************************************************************                                        1059
  3758* Elimina un registro de BDIIALE                                                                          1060
  3759******************************************************************                                        1061
  3760     if not PROCESO-REAL                                                                                  1062
  3761         exit paragraph                                                                                   1063
  3762     end-if                                                                                               1064
  3763     delete BDIIALE                                                                                       1065
  3764     evaluate EST-BDIIALE                                                                                 1066
  3765     when "00"                                                                                            1067
  3766         add 1 to N-ale-eliminadas                                                                        1068
  3767     when other                                                                                           1069
  3768         display "Error al deletear BDIIALE fs: " EST-BDIIALE                                             1070
  3769         " key: " LLAVE-BDIIALE                                                                           1071
  3770         display "Registro BDIIALE: "                                                                     1072
  3771         display REG-BDIIALE                                                                              1073
  3772         perform 9000-CANCELAR-PROGRAMA                                                                   1074
  3773     end-evaluate.                                                                                        1075
  3774                                                                                                          1076
  3775 4800-PROCESO-REG-T.                                                                                      1077
  3776******************************************************************                                        1078
  3777* El registro leido en el archivo JURAD es tipo "T" con totales                                           1079
  3778* de control, y debería ser el ultimo del archivo                                                         1080
  3779******************************************************************                                        1081
  3780* Control de los totales calculados contra los esperados                                                  1082
  3781     move "NO" to E-hay-error                                                                             1083
  3782*    cantidad de registros I M E                                                                          1084
  3783     if function numval(JURADT-registros) = N-reg-leidos                                                  1085
  3784         continue                                                                                         1086
  3785     else                                                                                                 1087
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  67
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3786         display " "                                                                                      1088
  3787         display "No coincide la cantidad de registros:"                                                  1089
  3788         JURADT-registros " con los leidos:" N-reg-leidos                                                 1090
  3789         move "SI" to E-hay-error                                                                         1091
  3790     end-if                                                                                               1092
  3791                                                                                                          1093
  3792*    Sumas de cantidades de demandas y embargos                                                           1094
  3793     if function numval(JURADT-demandas-terminadas)                                                       1095
  3794     = N-demandas-terminadas                                                                              1096
  3795         continue                                                                                         1097
  3796     else                                                                                                 1098
  3797         display " "                                                                                      1099
  3798         display "No coincide total de demandas terminadas:"                                              1100
  3799         JURADT-demandas-terminadas " con el calculado:"                                                  1101
  3800         N-demandas-terminadas                                                                            1102
  3801         move "SI" to E-hay-error                                                                         1103
  3802     end-if                                                                                               1104
  3803                                                                                                          1105
  3804     if function numval(JURADT-embargos-vigentes)                                                         1106
  3805     = N-embargos-vigentes                                                                                1107
  3806         continue                                                                                         1108
  3807     else                                                                                                 1109
  3808         display " "                                                                                      1110
  3809         display "No coincide total de embargos vigentes:"                                                1111
  3810         JURADT-embargos-vigentes " con el calculado:"                                                    1112
  3811         N-embargos-vigentes                                                                              1113
  3812         move "SI" to E-hay-error                                                                         1114
  3813     end-if                                                                                               1115
  3814                                                                                                          1116
  3815     if function numval(JURADT-embargos-terminados)                                                       1117
  3816     = N-embargos-terminados                                                                              1118
  3817         continue                                                                                         1119
  3818     else                                                                                                 1120
  3819         display " "                                                                                      1121
  3820         display "No coincide total de embargos terminados:"                                              1122
  3821         JURADT-embargos-terminados " con el calculado:"                                                  1123
  3822         N-embargos-terminados                                                                            1124
  3823         move "SI" to E-hay-error                                                                         1125
  3824     end-if.                                                                                              1126
  3825                                                                                                          1127
  3826*    si hubo cualquier cosa se invalida el proceso                                                        1128
  3827     if E-hay-error = "SI"                                                                                1129
  3828         display "Error en registro T de totales de control"                                              1130
  3829         display "Nombre del archivo: " ERRS-file-name                                                    1131
  3830         perform 9000-CANCELAR-PROGRAMA                                                                   1132
  3831     end-if.                                                                                              1133
  3832                                                                                                          1134
  3833                                                                                                          1135
  3834 4900-GRABAR-ERROR.                                                                                       1136
  3835******************************************************************                                        1137
  3836* El registro de JURAD tiene error: se graba en el archivo ERRS                                           1138
  3837* con indicacion del error detectado                                                                      1139
  3838******************************************************************                                        1140
  3839     move JURAD-reg to ERRS-reg                                                                           1141
  3840     move E-errores-reg to ERRS-causa-rechazo                                                             1142
  3841*    lista de los codigos de los errores del registro                                                     1143
  3842     move E-errores-reg to ERRS-causa-rechazo                                                             1144
  3843     write ERRS-reg                                                                                       1145
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  68
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3844     evaluate ERRS-fs                                                                                     1146
  3845         when "00"                                                                                        1147
  3846             continue                                                                                     1148
  3847         when other                                                                                       1149
  3848             display "Error al grabar el archivo de errores "                                             1150
  3849             display "Nombre del archivo: " ERRS-file-name                                                1151
  3850             display "File status: " ERRS-fs                                                              1152
  3851             perform 9000-CANCELAR-PROGRAMA                                                               1153
  3852             goback                                                                                       1154
  3853     end-evaluate.                                                                                        1155
  3854                                                                                                          1156
  3855                                                                                                          1157
  3856 4320-ARMAR-TEXTO-ALERTA.                                                                                 1158
  3857****************************************************************                                          1159
  3858* Hace el reemplazo de los valores adecuados en los templates                                             1160
  3859* de las linea de alerta que corresponde                                                                  1161
  3860****************************************************************                                          1162
  3861*    segun se trate de demandas o embargos                                                                1163
  3862     if JURAD-demandas-vigentes not = 0                                                                   1164
  3863     or JURAD-demandas-terminadas not = 0                                                                 1165
  3864         set LAx to 1                                                                                     1166
  3865         move high-values to LA-valores                                                                   1167
  3866         move JURAD-demandas-vigentes to LA-num                                                           1168
  3867* >>>> esto esta anulado x que no se como hacer para que lo compile                                       1169
  3868*        unstring LA-numX into LA-descarte LA-valor(1)                                                    1170
  3869*        delimited by all space                                                                           1171
  3870         move LA-numx(9:12) to LA-valor(1)                                                                1172
  3871         move JURAD-demandas-terminadas to LA-num                                                         1173
  3872* >>>> esto esta anulado x que no se como hacer para que lo compile                                       1174
  3873*        unstring LA-numX into LA-descarte LA-valor(2)                                                    1175
  3874*        delimited by all space                                                                           1176
  3875         move LA-numx(9:12) to LA-valor(2)                                                                1177
  3876                                                                                                          1178
  3877* >>>> esto esta anulado x que no se como hacer para que lo compile                                       1179
  3878* >>>> da error en el end-if                                                                              1180
  3879*        string LA-parte(LAx, 1) LA-valor(1)                                                              1181
  3880*        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)                                        1182
  3881*        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)                                        1183
  3882*        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)                                        1184
  3883*        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)                                        1185
  3884*        LA-parte(LAx, 10) LA-valor(10)                                                                   1186
  3885*        delimited by high-value                                                                          1187
  3886     end-if.                                                                                              1188
  3887                                                                                                          1189
  3888                                                                                                          1190
  3889 1000-RUTINA-INICIAL.                                                                                     1191
  3890******************************************************************                                        1192
  3891* Todas las operaciones que se realizan una sola vez, al comienzo                                         1193
  3892* del programa:                                                                                           1194
  3893*   - obtencion de los parametros                                                                         1195
  3894*   - apertura del archivo de entrada                                                                     1196
  3895*   - apertura de todos los demas archivos                                                                1197
  3896*   - eliminacion de datos existentes si es refresque completo                                            1198
  3897*   - carga en memoria de los IDs de inconsistentes                                                       1199
  3898******************************************************************                                        1200
  3899* Registra hora de inicio                                                                                 1201
  3900     accept W-hora-inicio from time                                                                       1202
  3901                                                                                                          1203
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  69
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3902* Obtiene informacion sobre la corrida de la linea de comando: el                                         1204
  3903* nombre del archivo de entrada (que contiene el tipo de proceso),                                        1205
  3904* el indicador de proceso real o en falso (default)                                                       1206
  3905     accept P-command-line from COMMAND-LINE                                                              1207
  3906     display "Parametros: " P-command-line                                                                1208
  3907     unstring P-command-line delimited by all " " into                                                    1209
  3908     P-file-name P-proceso-real                                                                           1210
  3909                                                                                                          1211
  3910* El programa se anuncia en la consola                                                                    1212
  3911* TODO: se usa un anuncio mas vistoso?                                                                    1213
  3912     if PROCESO-REAL                                                                                      1214
  3913         display pgm " Carga de archivo JURAD - proceso REAL"                                             1215
  3914     else                                                                                                 1216
  3915         display pgm " Carga de archivo JURAD - proceso en falso"                                         1217
  3916     end-if                                                                                               1218
  3917                                                                                                          1219
  3918* El indicador de proceso real debe ser 1 o 2                                                             1220
  3919     if P-proceso-real not = "1" and "2"                                                                  1221
  3920         display "El indicador de proceso real es invalido"                                               1222
  3921         display "debe ser 1 o 2"                                                                         1223
  3922         perform 9000-CANCELAR-PROGRAMA                                                                   1224
  3923     end-if                                                                                               1225
  3924                                                                                                          1226
  3925* TODO: controlar los componentes del filename                                                            1227
  3926     evaluate P-tipo-proceso                                                                              1228
  3927     when "01"                                                                                            1229
  3928         display "01 Envio Original - Carga TOTAL 1a vez"                                                 1230
  3929     when "02"                                                                                            1231
  3930         display "02 Archivo Semanal - Carga PARCIAL"                                                     1232
  3931     when "03"                                                                                            1233
  3932         display "03 Archivo Mensual - Carga PARCIAL"                                                     1234
  3933     when "04"                                                                                            1235
  3934         display "04 Refresque Total - Carga TOTAL"                                                       1236
  3935     when other                                                                                           1237
  3936*        valor invalido                                                                                   1238
  3937         display "El tipo de proceso " P-tipo-proceso                                                     1239
  3938         " es invalido (debe ser 01 02 03 o 04)"                                                          1240
  3939         perform 9000-CANCELAR-PROGRAMA                                                                   1241
  3940     end-evaluate.                                                                                        1242
  3941                                                                                                          1243
  3942* Edita la fecha de proceso DDMMAA del parametro en formato                                               1244
  3943* YYYYMMDD                                                                                                1245
  3944     string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)                                                1246
  3945     P-fecha-proceso(1:2) delimited size                                                                  1247
  3946     into P-fecha-proceso-YYYYMMDD                                                                        1248
  3947     display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD                                                1249
  3948                                                                                                          1250
  3949* Calcula una fecha 50 anios posterior a la de proceso                                                    1251
  3950     move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50                                                  1252
  3951     add 50 to P-fecha-proceso-50YYYY                                                                     1253
  3952                                                                                                          1254
  3953* Apertura del archivo de entrada                                                                         1255
  3954     string "$TEMPORALES/" P-file-name into P-file-path                                                   1256
  3955     open input JURAD                                                                                     1257
  3956     evaluate JURAD-fs                                                                                    1258
  3957         when "00"                                                                                        1259
  3958              continue                                                                                    1260
  3959         when other                                                                                       1261
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  70
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  3960             display "Error en open del archivo JURAD "                                                   1262
  3961             display "Path del archivo: " P-file-path                                                     1263
  3962             display "File status: " JURAD-fs                                                             1264
  3963             perform 9000-CANCELAR-PROGRAMA *> no retorna                                                 1265
  3964             goback                                                                                       1266
  3965     end-evaluate.                                                                                        1267
  3966                                                                                                          1268
  3967* Apertura del archivo de errores                                                                         1269
  3968     string "$TEMPORALES/" P-file-name(1:19) ".errs"                                                      1270
  3969     into ERRS-file-name                                                                                  1271
  3970     open output ERRS                                                                                     1272
  3971     evaluate ERRS-fs                                                                                     1273
  3972         when "00"                                                                                        1274
  3973              continue                                                                                    1275
  3974         when other                                                                                       1276
  3975             display "Error en open del archivo de errores "                                              1277
  3976             display "Nombre del archivo: " ERRS-file-name                                                1278
  3977             display "File status: " ERRS-fs                                                              1279
  3978             perform 9000-CANCELAR-PROGRAMA *> no retorna                                                 1280
  3979             goback                                                                                       1281
  3980     end-evaluate.                                                                                        1282
  3981                                                                                                          1283
  3982* Apertura de los archivos maestros                                                                       1284
  3983* TODO: falta capturar el status de estas operaciones?                                                    1285
  3984     open input BDIIREGI                                                                                  1286
  3985     open input BDIIDIAN                                                                                  1287
  3986     open input BDIIDAS.                                                                                  1288
  3987                                                                                                          1289
  3988* Apertura del archivo de alertas en linea                                                                1290
  3989     if PROCESO-REAL                                                                                      1291
  3990         open i-o BDIIALE                                                                                 1292
  3991     else                                                                                                 1293
  3992         open input BDIIALE                                                                               1294
  3993     end-if.                                                                                              1295
  3994                                                                                                          1296
  3995* Si es un refresque total (codigo 04) se eliminan los registros                                          1297
  3996* de Jurad existentes                                                                                     1298
  3997     if P-tipo-proceso = "04" and PROCESO-REAL                                                            1299
  3998         perform 1001-ELIMINAR-TODO                                                                       1300
  3999     end-if.                                                                                              1301
  4000                                                                                                          1302
  4001                                                                                                          1303
  4002 1000-NOT-USED.                                                                                           1304
  4003******************************************************************                                        1305
  4004* Aunque tengo instrucciones de dejar los textos de alertas en                                            1306
  4005* blanco, me parece que se deberían cargar, aunque sea de manera                                          1307
  4006* precaria, por si justo cae una consulta para uno de los IDs                                             1308
  4007* involucrados. La persona que consulta va a ver <spaces>, hasta                                          1309
  4008* que se ejecute el programa que genera los textos.                                                       1310
  4009******************************************************************                                        1311
  4010* >>>> esto da un error de compilacion que no puedo resolver                                              1312
  4011* >>>> por ahora esta anulado                                                                             1313
  4012******************************************************************                                        1314
  4013* Carga de los templates para armar el texto de alertas                                                   1315
  4014* TODO: por ahora los templates son literales                                                             1316
  4015     set LAx to 0                                                                                         1317
  4016     move high-values to LA-templates                                                                     1318
  4017     perform varying LAm from 1 by 1                                                                      1319
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  71
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  4018     until LA-modelo(LAm) = high-values                                                                   1320
  4019         set LAx up by 1                                                                                  1321
  4020*        separa las partes de la linea                                                                    1322
  4021*        unstring LA-modelo(LAm) into LA-parte(LAx, 1)                                                    1323
  4022*        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)                                               1324
  4023*        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)                                               1325
  4024*        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)                                              1326
  4025*        delimited by all "&"                                                                             1327
  4026*        prepara para omitir los espacios al final de c/parte                                             1328
  4027         perform varying LAy from 1 by 1 until LAy > 10                                                   1329
  4028             inspect LA-parte(LAx, LAy) replacing trailing                                                1330
  4029             spaces by high-values                                                                        1331
  4030             inspect LA-parte(LAx, LAy) replacing first                                                   1332
  4031             high-value by space                                                                          1333
  4032         end-perform                                                                                      1334
  4033     end-perform.                                                                                         1335
  4034                                                                                                          1336
  4035                                                                                                          1337
  4036 1001-ELIMINAR-TODO.                                                                                      1338
  4037******************************************************************                                        1339
  4038* Elimina los registros de alertas existentes en el archivo de                                            1340
  4039* alertas en linea, previo a un refresque total                                                           1341
  4040******************************************************************                                        1342
  4041     display "Eliminando toda la informacion con fuente JURAD"                                            1343
  4042*    posiciona en el primer reg de JURAD                                                                  1344
  4043     move zero to TIP-IDE-BDIIALE                                                                         1345
  4044     move zero to NUM-IDE-BDIIALE                                                                         1346
  4045     move P-cod-suscriptor to FUENTE-BDIIALE                                                              1347
  4046     move zeros to COD-ALERTA-BDIIALE                                                                     1348
  4047     move low-values to LLASEC-BDIIALE                                                                    1349
  4048     start BDIIALE key > LLAVE-BDIIALE                                                                    1350
  4049*    display "Start BDIIALE k:" LLAVE-BDIIALE                                                             1351
  4050     evaluate EST-BDIIALE                                                                                 1352
  4051     when "00"                                                                                            1353
  4052*        posicionado                                                                                      1354
  4053         continue                                                                                         1355
  4054     when other                                                                                           1356
  4055*        no hay registros                                                                                 1357
  4056         display "No hay registros a eliminar fs:" EST-BDIIALE                                            1358
  4057         exit paragraph                                                                                   1359
  4058     end-evaluate.                                                                                        1360
  4059                                                                                                          1361
  4060*    lee secuencialmente y elimina los registros de JURAD                                                 1362
  4061*    hasta el fin del archivo                                                                             1363
  4062     perform until EST-BDIIALE not = "00"                                                                 1364
  4063         read BDIIALE next record                                                                         1365
  4064         evaluate EST-BDIIALE                                                                             1366
  4065         when "00"                                                                                        1367
  4066*            display "BDIIALE leido fs:" EST-BDIIALE                                                      1368
  4067*            " k:" LLAVE-BDIIALE                                                                          1369
  4068             if FUENTE-BDIIALE = P-cod-suscriptor                                                         1370
  4069*                es un alerta de JURAD                                                                    1371
  4070                 delete BDIIALE                                                                           1372
  4071                 if EST-BDIIALE = "00"                                                                    1373
  4072*                    display "BDIIALE eliminado k:" LLAVE-BDIIALE                                         1374
  4073                     add 1 to N-ale-borradas                                                              1375
  4074                 else                                                                                     1376
  4075*                    error en la eliminacion                                                              1377
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  72
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  4076                     display "Error al eliminar un registro de "                                          1378
  4077                     "BDIIALE vaciando los datos"                                                         1379
  4078                     display "Clave: " LLAVE-BDIIALE                                                      1380
  4079                     display "Reg borrados: " N-ale-borradas                                              1381
  4080                     perform 9000-CANCELAR-PROGRAMA                                                       1382
  4081                 end-if                                                                                   1383
  4082             end-if                                                                                       1384
  4083         when "10"                                                                                        1385
  4084*            fin de archivo: sale normalmente                                                             1386
  4085             display "Fin de los registros a eliminar - leídos:"                                          1387
  4086             N-ale-leidas                                                                                 1388
  4087         when other                                                                                       1389
  4088*            lectura anormal: cancelacion del programa                                                    1390
  4089             display "Error en lectura del archivo de alertas "                                           1391
  4090             "online"                                                                                     1392
  4091             display "File status: " EST-BDIIALE                                                          1393
  4092             perform 9000-CANCELAR-PROGRAMA *> no retorna                                                 1394
  4093         end-evaluate                                                                                     1395
  4094     end-perform.                                                                                         1396
  4095     display "Termino la eliminacion total de JURAD"                                                      1397
  4096     display "Reg borrados: " N-ale-borradas.                                                             1398
  4097                                                                                                          1399
  4098                                                                                                          1400
  4099 7000-RUTINA-FINAL.                                                                                       1401
  4100******************************************************************                                        1402
  4101* Registra hora de finalizacion                                                                           1403
  4102     accept W-hora-fin from time                                                                          1404
  4103                                                                                                          1405
  4104* Leer JURAD a ver si hay registros despues del "T"                                                       1406
  4105                                                                                                          1407
  4106* Close todos los archivos                                                                                1408
  4107     close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.                                                  1409
  4108                                                                                                          1410
  4109     display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD                                                1411
  4110* Emision de contadores de registros                                                                      1412
  4111     display " "                                                                                          1413
  4112     display "Totales de registros:"                                                                      1414
  4113     display " "                                                                                          1415
  4114*    porcentaje registros procesados OK                                                                   1416
  4115     compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos                                         1417
  4116     display N-editp100 "% de registros correctos"                                                        1418
  4117*    porcentaje registros inconsistentes                                                                  1419
  4118     compute N-editp100 rounded = 100.0 * E-cont-regs-con-error                                           1420
  4119     / N-reg-leidos                                                                                       1421
  4120     display N-editp100 "% de registros inconsistentes"                                                   1422
  4121*    cantidad de registros leídos (excluído el registro "T")                                              1423
  4122     move N-reg-leidos to N-edit                                                                          1424
  4123     display N-edit "Registros IME en el archivo de entrada"                                              1425
  4124*    cantidad de registros procesados sin error                                                           1426
  4125     move N-reg-OK to N-edit                                                                              1427
  4126     display N-edit "Registros procesados sin error"                                                      1428
  4127                                                                                                          1429
  4128* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la                                          1430
  4129* definicion de estos contadores                                                                          1431
  4130*    move N-reg-tipo-I-OK to N-edit                                                                       1432
  4131*    display N-edit "Registros tipo I aceptados"                                                          1433
  4132*    move N-reg-tipo-M-OK to N-edit                                                                       1434
  4133*    display N-edit "Registros tipo M aceptados"                                                          1435
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  73
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  4134*    move N-reg-tipo-E-OK to N-edit                                                                       1436
  4135*    display N-edit "Registros tipo E aceptados"                                                          1437
  4136                                                                                                          1438
  4137*    cantidad de registros con error                                                                      1439
  4138     move E-cont-regs-con-error to N-reg-con-error                                                        1440
  4139     move N-reg-con-error to N-edit                                                                       1441
  4140     display N-edit "Registros con error"                                                                 1442
  4141*    cantidades de alertas afectadas                                                                      1443
  4142     if P-tipo-proceso = "04"                                                                             1444
  4143         move N-ale-borradas to N-edit                                                                    1445
  4144         display N-edit                                                                                   1446
  4145         "Alertas borradas previo al refresque total"                                                     1447
  4146     end-if                                                                                               1448
  4147     move N-ale-insertadas to N-edit                                                                      1449
  4148     display N-edit "Alertas insertadas"                                                                  1450
  4149     move N-ale-modificadas to N-edit                                                                     1451
  4150     display N-edit "Alertas modificadas"                                                                 1452
  4151     move N-ale-eliminadas to N-edit                                                                      1453
  4152     display N-edit "Alertas eliminadas"                                                                  1454
  4153     move N-ale-ya-existe to N-edit                                                                       1455
  4154     display N-edit "Insercion de alerta existente"                                                       1456
  4155     move N-ale-no-existe to N-edit                                                                       1457
  4156     display N-edit "Modif o elim de alerta inexistente".                                                 1458
  4157                                                                                                          1459
  4158* Emision del reporte de errores                                                                          1460
  4159     display " "                                                                                          1461
  4160     display "Totales por tipo de error detectado:"                                                       1462
  4161     perform varying Ex from 1 by 1 until Ex > 50                                                         1463
  4162     or E-codigo(Ex) = "00"                                                                               1464
  4163         if E-contador(Ex) not = 0                                                                        1465
  4164             move E-contador(ex) to E-edit                                                                1466
  4165             display E-edit E-codigo(Ex) "-" E-descripcion(Ex)                                            1467
  4166         end-if                                                                                           1468
  4167     end-perform.                                                                                         1469
  4168                                                                                                          1470
  4169                                                                                                          1471
  4170 9000-CANCELAR-PROGRAMA.                                                                                  1472
  4171******************************************************************                                        1473
  4172* Procedimiento standard de cancelacion de programa batch                                                 1474
  4173******************************************************************                                        1475
  4174* TODO: hay un standard para comunicar una cancelacion de proceso?                                        1476
  4175     display " "                                                                                          1477
  4176     display pgm " - proceso cancelado"                                                                   1478
  4177     goback returning 99.                                                                                 1479
  4178                                                                                                          1480
  4179                                                                                                          1481
  4180 513-VALIDA-EN-CSV.                                                                                       1482
  4181**************************************************************                                            1483
  4182* Valida si la identificación está en la base de datos alterna                                            1484
  4183**************************************************************                                            1485
  4184*    hace validacion de tipo de identificacion                                                            1486
  4185     MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE                                                                 1487
  4186     MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE                                                                 1488
  4187     PERFORM 80400-VALIDAR-TIPO-ID                                                                        1489
  4188     IF SW-TID-BDIIVIDE = 0                                                                               1490
  4189     IF HACER-MATCH = ZEROS                                                                               1491
  4190        IF OPEN-DIR = ZEROS                                                                               1492
  4191           OPEN INPUT MAESTRO-DIRECC                                                                      1493
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  74
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  4192           OPEN INPUT BDLCLI                                                                              1494
  4193           OPEN INPUT SUSCRIPTOR                                                                          1495
  4194           OPEN INPUT MAESTRO-CREDIT                                                                      1496
  4195           OPEN INPUT MAESTRO-CHECK                                                                       1497
  4196           PERFORM 06000-U-CARGAR-TABLA-DIRESTAN                                                          1498
  4197           MOVE 1 TO OPEN-DIR                                                                             1499
  4198         END-IF                                                                                           1500
  4199         MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH                                                          1501
  4200         MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH                                                          1502
  4201         PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                                             1503
  4202         MOVE 1 TO HACERMATCH-LEEMSTRS                                                                    1504
  4203         IF IDE-TIPO-BDAMATCH = 1                                                                         1505
  4204            IF TIPOID-E = 1 OR 4                                                                          1506
  4205               INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL                                                  1507
  4206                  "," BY " ", ";" BY " "                                                                  1508
  4207            END-IF                                                                                        1509
  4208            MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM                                               1510
  4209            MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM                                               1511
  4210            MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM                                              1512
  4211            MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                                             1513
  4212            PERFORM 10000-MATCH-NOMBRES-VALNOM                                                            1514
  4213            IF MATCH-OK-OUT-VALNOM = 1                                                                    1515
  4214               MOVE 1 TO IDE-TIPO-BDAMATCH                                                                1516
  4215            ELSE                                                                                          1517
  4216              IF W-BLOQUES > 0                                                                            1518
  4217                 MOVE 0 TO IDE-TIPO-BDAMATCH                                                              1519
  4218              END-IF                                                                                      1520
  4219            END-IF                                                                                        1521
  4220         END-IF                                                                                           1522
  4221                                                                                                          1523
  4222         IF IDE-TIPO-BDAMATCH = 1                                                                         1524
  4223            MOVE TIPOID-E TO TIP-VAL                                                                      1525
  4224            MOVE NUMID-E  TO CED-VAL                                                                      1526
  4225            MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA                                                      1527
  4226            PERFORM 9800-FILTRAR-ALFABETICO                                                               1528
  4227            MOVE CADENA-SALE TO  NOM-VAL                                                                  1529
  4228            MOVE ZEROS    TO FEC-EXP-VAL                                                                  1530
  4229            MOVE SPACES   TO MUN-EXP-VAL                                                                  1531
  4230            MOVE SPACES   TO DEP-EXP-VAL                                                                  1532
  4231            MOVE SPACES   TO VIG-VAL                                                                      1533
  4232            MOVE SPACES   TO GENERO-VAL                                                                   1534
  4233            MOVE SPACES   TO EDAD-VAL                                                                     1535
  4234            MOVE SPACES   TO EDAD-RANGO                                                                   1536
  4235            ADD 1 TO SI-EXISTE-CSV                                                                        1537
  4236          END-IF                                                                                          1538
  4237       END-IF.                                                                                            1539
  4238                                                                                                          1540
  4239 9800-FILTRAR-ALFABETICO.                                                                                 1541
  4240******************************************************************                                        1542
  4241* SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA                                            1543
  4242******************************************************************                                        1544
  4243     MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA                                              1545
  4244     INITIALIZE CADENA-SALE                                                                               1546
  4245     MOVE 1 TO J                                                                                          1547
  4246     PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60                                                           1548
  4247        MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO                                                         1549
  4248        IF SI-ALFABETICO                                                                                  1550
  4249           MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)                                                   1551
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  75
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/ICFILE.WS)
  4250           ADD 1 TO J                                                                                     1552
  4251        END-IF                                                                                            1553
  4252     END-PERFORM.                                                                                         1554
  4253******************************************************************                                        1555
  4254                                                                                                          1556
  4255                                                                                                          1557
  4256                                                                                                          1558
* 4257     copy BDIIVIDE.PROC.                                                                                  1559
  4258*BDIIVIDE.PROC.v.03.0008                                                                      BDIIVIDE       1
  4259******************************************************************                            BDIIVIDE       2
  4260*RUTINA DE VALIDACION DE IDENTIFICACIONES                                                     BDIIVIDE       3
  4261******************************************************************                            BDIIVIDE       4
  4262* F.CUADROS   * INCLUSION DE PARAMETRO PARA ASIGNAR EL TIPO DE                                BDIIVIDE       5
  4263* JUN.17/2004 * IDENTIFICACION DE ACUERDO A RANGOS PERMITIDOS                                 BDIIVIDE       6
  4264*             * NUIP01 * RUTINA 80300-ASIGNAR-TIPO-ID                                         BDIIVIDE       7
  4265*             * INCLUSION DE PARAMETRO PARA VALIDAR EL TIPO-ID                                BDIIVIDE       8
  4266* FAC0002     * NUIP01 * RUTINA 80400-VALIDAR-TIPO-ID.                                        BDIIVIDE       9
  4267******************************************************************                            BDIIVIDE      10
  4268* F.CUADROS   * RELLENAR DE CEROS EL NUMERO DE IDENTIFICAICON                                 BDIIVIDE      11
  4269* JUL.16/2004 * CUANDO SE LE QUITA EL DIGITO DE CHEQUEO                                       BDIIVIDE      12
  4270* FAC0003     * NUIP02 * VALIDACION DE IDENTIFICACION SI TIPO-ID 2                            BDIIVIDE      13
  4271******************************************************************                            BDIIVIDE      14
  4272* F.CUADROS   * NUIP03: INCLUSION DE RUTINA PARA ELIMINAR EL                                  BDIIVIDE      15
  4273* AGO.11/2004 * DIGITO DE CHEQUEO.                                                            BDIIVIDE      16
  4274* FAC0004     * CAMBIO DE TIPO ID = 2 POR 3 SI EL NIT NO                                      BDIIVIDE      17
  4275*             * CORRESPONDE AL RANGO.                                                         BDIIVIDE      18
  4276******************************************************************                            BDIIVIDE      19
  4277* F.CUADROS   * RANGO5: DEFINICION DE NUEVOS RANGOS PARA TIPO ID 3:                           BDIIVIDE      20
  4278* OCT.22/2004 * ENTRE 700.000.001 Y 799.999.999 (OTROS DOCUMENTOS)                            BDIIVIDE      21
  4279* FAC0005     * DEFINICION DE NUEVOS RANGOS PARA TIPO ID 2:                                   BDIIVIDE      22
  4280*             * ENTRE 900.000.000 Y 999.999.999 (MUISCA)                                      BDIIVIDE      23
  4281******************************************************************                            BDIIVIDE      24
  4282* F.CUADROS   * NUIP04: INCLUSION DE RANGO PARA TIPO ID. 2 EN                                 BDIIVIDE      25
  4283* OCT.19/2005 * RUTINA VALIDAR-TIPO-ID PARA NITS QUE SON NUIPS                                BDIIVIDE      26
  4284* FAC006C     *                                                                               BDIIVIDE      27
  4285******************************************************************                            BDIIVIDE      28
  4286* C.VELASCO   * SE VUELVE A LA VERSION ANTES DE MODIFICAR LOS                                 BDIIVIDE      29
  4287* JUL.12/2012 * RANGOS DE IDENTIFICACIONES,  LOS AJUSTES DE LA                                BDIIVIDE      30
  4288* CAV0008     * VERSION 07, IMPACTA APERTURAS Y PROCESOS ESPEC.                               BDIIVIDE      31
  4289******************************************************************                            BDIIVIDE      32
  4290 80100-VALIDAR-IDENTIFICACION.                                                                BDIIVIDE      33
  4291*===================================*                                                         BDIIVIDE      34
  4292*80100-VALIDAR-IDENTIFICACION.                                                                BDIIVIDE      35
  4293* Valida el numero de identificacion contra las bases de datos                                BDIIVIDE      36
  4294* de validacion de informacion BDIIDIAN, BDIIDAS, BDIIREGI                                    BDIIVIDE      37
  4295* y verifica la coincidencia del nombre reportado                                             BDIIVIDE      38
  4296*===================================*                                                         BDIIVIDE      39
  4297    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE VARIABLES-VALNOM                                    BDIIVIDE      40
  4298               NOMBRES-AUX-W-BDIIVIDE                                                         BDIIVIDE      41
  4299    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"                                         BDIIVIDE      42
  4300    IF SW-VERIFNOM-BDIIVIDE NOT NUMERIC                           FAC0002                     BDIIVIDE      43
  4301       MOVE ZEROS TO SW-VERIFNOM-BDIIVIDE                         FAC0002                     BDIIVIDE      44
  4302    END-IF                                                        FAC0002                     BDIIVIDE      45
  4303    IF SW-ASGTIPID-BDIIVIDE NOT NUMERIC                           FAC0002                     BDIIVIDE      46
  4304       MOVE ZEROS TO SW-ASGTIPID-BDIIVIDE                         FAC0002                     BDIIVIDE      47
  4305    END-IF                                                        FAC0002                     BDIIVIDE      48
  4306    IF SW-VALTIPID-BDIIVIDE NOT NUMERIC                           FAC0002                     BDIIVIDE      49
  4307       MOVE ZEROS TO SW-VALTIPID-BDIIVIDE                         FAC0002                     BDIIVIDE      50
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  76
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIVIDE.P
  4308    END-IF                                                        FAC0002                     BDIIVIDE      51
  4309    IF SW-DIGCHEQUEO-BDIIVIDE NOT NUMERIC                         FAC0003                     BDIIVIDE      52
  4310       MOVE ZEROS TO SW-DIGCHEQUEO-BDIIVIDE                       FAC0003                     BDIIVIDE      53
  4311    END-IF                                                        FAC0003                     BDIIVIDE      54
  4312    IF NUM-IDE-BDIIVIDE IS NUMERIC AND NUM-IDE-BDIIVIDE <> ZEROS                              BDIIVIDE      55
  4313      IF SW-ASGTIPID-BDIIVIDE = 1                                 FAC0002                     BDIIVIDE      56
  4314         PERFORM 80300-ASIGNAR-TIPO-ID                            FAC0002                     BDIIVIDE      57
  4315      END-IF                                                      FAC0002                     BDIIVIDE      58
  4316      IF SW-VALTIPID-BDIIVIDE = 1                                 FAC0002                     BDIIVIDE      59
  4317         PERFORM 80400-VALIDAR-TIPO-ID                            FAC0002                     BDIIVIDE      60
  4318      END-IF                                                      FAC0002                     BDIIVIDE      61
  4319      IF SW-DIGCHEQUEO-BDIIVIDE = 1                               FAC0004                     BDIIVIDE      62
  4320         PERFORM 80500-ELIMINAR-DIGITO-CHEQUEO                    FAC0004                     BDIIVIDE      63
  4321      END-IF                                                      FAC0004                     BDIIVIDE      64
  4322      IF SW-VALTIPID-BDIIVIDE = 0 OR                              FAC0004                     BDIIVIDE      65
  4323         (SW-VALTIPID-BDIIVIDE = 1 AND SW-TID-BDIIVIDE = 0)       FAC0002                     BDIIVIDE      66
  4324       PERFORM 80200-VALIDAR-ID                                                               BDIIVIDE      67
  4325       INITIALIZE NOM-VAL-BDIIVIDE                                                            BDIIVIDE      68
  4326       MOVE NOM-LEIDO-BDIIVIDE TO NOM-VAL-BDIIVIDE                                            BDIIVIDE      69
  4327       IF SW-VERIFNOM-BDIIVIDE = 1                                                            BDIIVIDE      70
  4328          MOVE TIP-IDE-BDIIVIDE TO TIP-ID-INPUT-VALNOM                                        BDIIVIDE      71
  4329          MOVE NOMBRE-BDIIVIDE TO NOMBRE-INPUT-VALNOM                                         BDIIVIDE      72
  4330          MOVE NOM-VAL-BDIIVIDE TO NOMBOK-INPUT-VALNOM                                        BDIIVIDE      73
  4331          IF SW-ID-BDIIVIDE = 0                                                               BDIIVIDE      74
  4332             IF NUM-BLOQUES-BDIIVIDE NUMERIC AND                                              BDIIVIDE      75
  4333                NUM-BLOQUES-BDIIVIDE <> ZEROS                                                 BDIIVIDE      76
  4334                MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM                             BDIIVIDE      77
  4335             ELSE IF TIP-ID-INPUT-VALNOM = 1                                                  BDIIVIDE      78
  4336                     MOVE 2 TO BLOQUES-INPUT-VALNOM                                           BDIIVIDE      79
  4337                  ELSE MOVE 1 TO BLOQUES-INPUT-VALNOM                                         BDIIVIDE      80
  4338                  END-IF                                                                      BDIIVIDE      81
  4339             END-IF                                                                           BDIIVIDE      82
  4340             PERFORM 10000-MATCH-NOMBRES-VALNOM                                               BDIIVIDE      83
  4341             IF MATCH-OK-OUT-VALNOM = 0                                                       BDIIVIDE      84
  4342                MOVE 1 TO SW-NOMBRES-BDIIVIDE                                                 BDIIVIDE      85
  4343             END-IF                                                                           BDIIVIDE      86
  4344          END-IF                                                                              BDIIVIDE      87
  4345       END-IF                                                                                 BDIIVIDE      88
  4346      ELSE IF SW-TID-BDIIVIDE = 1                                 FAC0002                     BDIIVIDE      89
  4347              MOVE 1 TO SW-ID-BDIIVIDE                            FAC0002                     BDIIVIDE      90
  4348           END-IF                                                 FAC0002                     BDIIVIDE      91
  4349      END-IF                                                      FAC0002                     BDIIVIDE      92
  4350    ELSE MOVE 1 TO SW-ID-BDIIVIDE                                                             BDIIVIDE      93
  4351    END-IF.                                                                                   BDIIVIDE      94
  4352                                                                                              BDIIVIDE      95
  4353 80200-VALIDAR-ID.                                                                            BDIIVIDE      96
  4354*===================================*                                                         BDIIVIDE      97
  4355*80200-VALIDAR-ID.                                                                            BDIIVIDE      98
  4356*Validacion del numero de identificacion                                                      BDIIVIDE      99
  4357*con las BASES DE DATOS DE LA REGISTRADURIA, DAS, DIAN:                                       BDIIVIDE     100
  4358*BDIAREGI, BDIADAS, BDIADIAN respectivamente                                                  BDIIVIDE     101
  4359*Dependiendo del tipo de identificacion                                                       BDIIVIDE     102
  4360*===================================*                                                         BDIIVIDE     103
  4361     EVALUATE TIP-IDE-BDIIVIDE                                                                BDIIVIDE     104
  4362       WHEN 1                                                                                 BDIIVIDE     105
  4363         PERFORM 85010-UBICA-CEDULA                                                           BDIIVIDE     106
  4364       WHEN 2                                                                                 BDIIVIDE     107
  4365         PERFORM 85020-UBICA-NIT                                                              BDIIVIDE     108
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  77
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIVIDE.P
  4366       WHEN 3                                                                                 BDIIVIDE     109
  4367         PERFORM 85020-UBICA-NIT                                                              BDIIVIDE     110
  4368       WHEN 4                                                                                 BDIIVIDE     111
  4369         PERFORM 85030-UBICA-EXT                                                              BDIIVIDE     112
  4370       WHEN OTHER                                                                             BDIIVIDE     113
  4371         MOVE 1 TO SW-ID-BDIIVIDE                                                             BDIIVIDE     114
  4372     END-EVALUATE.                                                                            BDIIVIDE     115
  4373                                                                                              BDIIVIDE     116
  4374 80300-ASIGNAR-TIPO-ID.                                           FAC0002                     BDIIVIDE     117
  4375*================================================================                             BDIIVIDE     118
  4376*80300-ASIGNAR-TIPO-ID.                                           FAC0002                     BDIIVIDE     119
  4377*ASIGNACION DEL TIPO DE IDENTIFICACION. PARAMETRO DE ENTRADA      FAC0002                     BDIIVIDE     120
  4378*SW-ASGTIPID-BDIVIIDE = 1; RETORNA TIPID-VAL-BDIIVIDE                                         BDIIVIDE     121
  4379*================================================================                             BDIIVIDE     122
  4380    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE TIP-IDE-BDIIVIDE        FAC0002                     BDIIVIDE     123
  4381    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002                     BDIIVIDE     124
  4382      IF (NUM-IDE-BDIIVIDE-R >= 1 AND                             FAC0002                     BDIIVIDE     125
  4383         NUM-IDE-BDIIVIDE-R  <= 99999999) OR                      FAC0002                     BDIIVIDE     126
  4384         (NUM-IDE-BDIIVIDE-R >= 1000000000 AND                    FAC0002                     BDIIVIDE     127
  4385         NUM-IDE-BDIIVIDE-R  <  8000000000)                       FAC0003                     BDIIVIDE     128
  4386         MOVE 1 TO TIP-IDE-BDIIVIDE                               FAC0002                     BDIIVIDE     129
  4387      ELSE                                                        FAC0002                     BDIIVIDE     130
  4388        IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                   FAC0002                     BDIIVIDE     131
  4389           NUM-IDE-BDIIVIDE-R  <= 999999999) OR                   FAC0005                     BDIIVIDE     132
  4390           (NUM-IDE-BDIIVIDE-R >= 8000000000 AND                  FAC0003                     BDIIVIDE     133
  4391           NUM-IDE-BDIIVIDE-R  <= 9999999999)                     FAC0005                     BDIIVIDE     134
  4392           MOVE 2 TO TIP-IDE-BDIIVIDE                             FAC0002                     BDIIVIDE     135
  4393*          IF NUM-IDE-BDIIVIDE-R >= 8000000000                    FAC0004                     BDIIVIDE     136
  4394*             MOVE NUM-IDE-BDIIVIDE-R TO NUM-ID-W11-BDIIVIDE      FAC0004                     BDIIVIDE     137
  4395*             MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R      FAC0004                     BDIIVIDE     138
  4396*          END-IF                                                 FAC0004                     BDIIVIDE     139
  4397        ELSE                                                      FAC0002                     BDIIVIDE     140
  4398          IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                 FAC0002                     BDIIVIDE     141
  4399             NUM-IDE-BDIIVIDE-R  <  800000000) OR                 FAC0005                     BDIIVIDE     142
  4400             (NUM-IDE-BDIIVIDE-R >= 6000000000 AND                FAC0002                     BDIIVIDE     143
  4401             NUM-IDE-BDIIVIDE-R  <  8000000000)                   FAC0005                     BDIIVIDE     144
  4402             MOVE 3 TO TIP-IDE-BDIIVIDE                           FAC0002                     BDIIVIDE     145
  4403          ELSE MOVE 4 TO TIP-IDE-BDIIVIDE                         FAC0002                     BDIIVIDE     146
  4404          END-IF.                                                 FAC0002                     BDIIVIDE     147
  4405                                                                                              BDIIVIDE     148
  4406 80400-VALIDAR-TIPO-ID.                                           FAC0002                     BDIIVIDE     149
  4407*================================================================                             BDIIVIDE     150
  4408*80400-VALIDAR-TIPO-ID.                                           FAC0002                     BDIIVIDE     151
  4409*VALIDACION DEL TIPO DE IDENTIFICACION DE ACUERDO AL RANGO        FAC0002                     BDIIVIDE     152
  4410*CONTENIDO EN EL NUMERO DE IDENTIFICACION. SE PREGUNTA AL REVES.  FAC0002                     BDIIVIDE     153
  4411*PARAMETRO DE ENTRADA SW-VALTIPID-BDIVIIDE = 1;                   FAC0002                     BDIIVIDE     154
  4412*RETORNA SW-TID-BDIIVIDE = 1 SI ESTA ERRADO.                      FAC0002                     BDIIVIDE     155
  4413*================================================================                             BDIIVIDE     156
  4414    INITIALIZE PARAMETROS-SALIDA-BDIIVIDE                         FAC0002                     BDIIVIDE     157
  4415    INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0"             FAC0002                     BDIIVIDE     158
  4416    EVALUATE TIP-IDE-BDIIVIDE                                     FAC0002                     BDIIVIDE     159
  4417      WHEN 1                                                      FAC0002                     BDIIVIDE     160
  4418       IF NUM-IDE-BDIIVIDE-R > 9999999999                         FAC0002                     BDIIVIDE     161
  4419          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002                     BDIIVIDE     162
  4420       END-IF                                                     FAC0002                     BDIIVIDE     163
  4421      WHEN 2                                                      FAC0002                     BDIIVIDE     164
  4422       IF NUM-IDE-BDIIVIDE-R >  9999999999 OR                     FAC006C                     BDIIVIDE     165
  4423          (NUM-IDE-BDIIVIDE-R <= 800000000 AND >= 600000000)      FAC0005                     BDIIVIDE     166
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  78
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIVIDE.P
  4424          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002                     BDIIVIDE     167
  4425       END-IF                                                     FAC0002                     BDIIVIDE     168
  4426      WHEN 3                                                      FAC0002                     BDIIVIDE     169
  4427       IF NUM-IDE-BDIIVIDE-R > 800000000 OR < 600000000           FAC0005                     BDIIVIDE     170
  4428          MOVE 1 TO SW-TID-BDIIVIDE                               FAC0002                     BDIIVIDE     171
  4429       END-IF                                                     FAC0002                     BDIIVIDE     172
  4430    END-EVALUATE.                                                 FAC0002                     BDIIVIDE     173
  4431                                                                                              BDIIVIDE     174
  4432 80500-ELIMINAR-DIGITO-CHEQUEO.                                   FAC0004                     BDIIVIDE     175
  4433*================================================================                             BDIIVIDE     176
  4434*80500-ELIMINAR-DIGITO-CHEQUEO.                                   FAC0004                     BDIIVIDE     177
  4435*Elimina el digito de chequeo y cambia el tipo de identificacion                              BDIIVIDE     178
  4436*de acuerdo a los rangos para tipo id = 2 y 3                                                 BDIIVIDE     179
  4437*================================================================                             BDIIVIDE     180
  4438      IF (NUM-IDE-BDIIVIDE-R >= 600000000 AND                     FAC0004                     BDIIVIDE     181
  4439         NUM-IDE-BDIIVIDE-R  <  800000000) OR                     FAC0005                     BDIIVIDE     182
  4440         (NUM-IDE-BDIIVIDE-R >= 6000000000 AND                    FAC0004                     BDIIVIDE     183
  4441          NUM-IDE-BDIIVIDE-R  < 8000000000)                       FAC0005                     BDIIVIDE     184
  4442          MOVE 3 TO TIP-IDE-BDIIVIDE                              FAC0004                     BDIIVIDE     185
  4443      END-IF                                                      FAC0004                     BDIIVIDE     186
  4444      IF (NUM-IDE-BDIIVIDE-R >= 800000000 AND                     FAC0004                     BDIIVIDE     187
  4445         NUM-IDE-BDIIVIDE-R  <= 999999999) OR                     FAC0005                     BDIIVIDE     188
  4446         (NUM-IDE-BDIIVIDE-R >= 8000000000 AND                    FAC0004                     BDIIVIDE     189
  4447         NUM-IDE-BDIIVIDE-R  <= 9999999999)                       FAC0005                     BDIIVIDE     190
  4448          MOVE 2 TO TIP-IDE-BDIIVIDE                              FAC0004                     BDIIVIDE     191
  4449      END-IF                                                      FAC0004                     BDIIVIDE     192
  4450      IF (TIP-IDE-BDIIVIDE = 2 AND                                FAC0004                     BDIIVIDE     193
  4451         (NUM-IDE-BDIIVIDE-R >= 10000000000) OR                   FAC0004                     BDIIVIDE     194
  4452         (NUM-IDE-BDIIVIDE-R >= 8000000000 AND                    FAC0004                     BDIIVIDE     195
  4453          NUM-IDE-BDIIVIDE-R <= 9999999999)) OR                   FAC0005                     BDIIVIDE     196
  4454         (TIP-IDE-BDIIVIDE = 3 AND                                FAC0004                     BDIIVIDE     197
  4455         (NUM-IDE-BDIIVIDE-R >= 6000000000 AND                    FAC0004                     BDIIVIDE     198
  4456          NUM-IDE-BDIIVIDE-R <  8000000000))                      FAC0005                     BDIIVIDE     199
  4457          MOVE NUM-IDE-BDIIVIDE TO NUM-ID-W11-BDIIVIDE            FAC0004                     BDIIVIDE     200
  4458          MOVE NUM-ID-W10-BDIIVIDE TO NUM-IDE-BDIIVIDE-R          FAC0004                     BDIIVIDE     201
  4459      END-IF                                                      FAC0004                     BDIIVIDE     202
  4460      INSPECT NUM-IDE-BDIIVIDE REPLACING ALL " " BY "0".          FAC0004                     BDIIVIDE     203
  4461                                                                                              BDIIVIDE     204
  4462 85010-UBICA-CEDULA.                                                                          BDIIVIDE     205
  4463*================================================================                             BDIIVIDE     206
  4464*85010-UBICA-CEDULA.                                                                          BDIIVIDE     207
  4465*Ubica la identificacion dada la llave en BDIIREGI                                            BDIIVIDE     208
  4466*Arma el nombre completo en una sola variable                                                 BDIIVIDE     209
  4467*================================================================                             BDIIVIDE     210
  4468     MOVE NUM-IDE-BDIIVIDE TO CEDULA-BDIIREGI                                                 BDIIVIDE     211
  4469     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIREGI                                                BDIIVIDE     212
  4470     READ BDIIREGI INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE                                       BDIIVIDE     213
  4471     END-READ                                                                                 BDIIVIDE     214
  4472     IF SW-ID-BDIIVIDE = 0                                                                    BDIIVIDE     215
  4473        MOVE APELLIDO1-BDIIREGI TO PRIMER-APELLIDO-BDIIVIDE                                   BDIIVIDE     216
  4474        MOVE APELLIDO2-BDIIREGI TO SEGUNDO-APELLIDO-BDIIVIDE                                  BDIIVIDE     217
  4475        MOVE DES-NOMBRE2-BDIIREGI TO SEGUNDO-NOMBRE-BDIIVIDE                                  BDIIVIDE     218
  4476        MOVE DES-NOMBRE1-BDIIREGI TO PRIMER-NOMBRE-BDIIVIDE                                   BDIIVIDE     219
  4477        IF ESTADO-CIVIL-BDIIREGI = 0                                                          BDIIVIDE     220
  4478            STRING                                                                            BDIIVIDE     221
  4479             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",                                     BDIIVIDE     222
  4480             "*" DELIMITED BY SIZE ,                                                          BDIIVIDE     223
  4481             PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",                                     BDIIVIDE     224
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  79
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIVIDE.P
  4482             "*" DELIMITED BY SIZE ,                                                          BDIIVIDE     225
  4483             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,                                     BDIIVIDE     226
  4484             ";" DELIMITED BY SIZE ,                                                          BDIIVIDE     227
  4485             INTO NOM-LEIDO-BDIIVIDE                                                          BDIIVIDE     228
  4486         END-IF                                                                               BDIIVIDE     229
  4487         IF ESTADO-CIVIL-BDIIREGI = 1                                                         BDIIVIDE     230
  4488             STRING                                                                           BDIIVIDE     231
  4489             "DE" DELIMITED BY SIZE,                                                          BDIIVIDE     232
  4490             "*"  DELIMITED BY SIZE,                                                          BDIIVIDE     233
  4491             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",                                     BDIIVIDE     234
  4492             "*"  DELIMITED BY SIZE,                                                          BDIIVIDE     235
  4493             PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",                                     BDIIVIDE     236
  4494             "*"  DELIMITED BY SIZE,                                                          BDIIVIDE     237
  4495             SEGUNDO-NOMBRE-BDIIVIDE   DELIMITED BY SIZE,                                     BDIIVIDE     238
  4496             ";"  DELIMITED BY SIZE,                                                          BDIIVIDE     239
  4497             INTO NOM-LEIDO-BDIIVIDE                                                          BDIIVIDE     240
  4498         END-IF                                                                               BDIIVIDE     241
  4499         IF ESTADO-CIVIL-BDIIREGI = 2                                                         BDIIVIDE     242
  4500            STRING                                                                            BDIIVIDE     243
  4501             "VDA DE" DELIMITED BY SIZE,                                                      BDIIVIDE     244
  4502             "*"      DELIMITED BY SIZE,                                                      BDIIVIDE     245
  4503             SEGUNDO-APELLIDO-BDIIVIDE DELIMITED BY "  ",                                     BDIIVIDE     246
  4504             "*"      DELIMITED BY SIZE,                                                      BDIIVIDE     247
  4505             PRIMER-NOMBRE-BDIIVIDE    DELIMITED BY "  ",                                     BDIIVIDE     248
  4506             "*"      DELIMITED BY SIZE,                                                      BDIIVIDE     249
  4507             SEGUNDO-NOMBRE-BDIIVIDE DELIMITED BY SIZE,                                       BDIIVIDE     250
  4508             ";"      DELIMITED BY SIZE,                                                      BDIIVIDE     251
  4509         INTO NOM-LEIDO-BDIIVIDE                                                              BDIIVIDE     252
  4510         END-IF                                                                               BDIIVIDE     253
  4511         STRING PRIMER-APELLIDO-BDIIVIDE DELIMITED BY "  ",                                   BDIIVIDE     254
  4512            "*"             DELIMITED BY SIZE,                                                BDIIVIDE     255
  4513            NOM-LEIDO-BDIIVIDE     DELIMITED BY SIZE, "*",                                    BDIIVIDE     256
  4514                          DELIMITED BY SIZE,                                                  BDIIVIDE     257
  4515            INTO NOM-VAL-BDIIVIDE                                                             BDIIVIDE     258
  4516                                                                                              BDIIVIDE     259
  4517         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL "*" BY " "                                    BDIIVIDE     260
  4518         INSPECT NOM-VAL-BDIIVIDE REPLACING ALL ";" BY " "                                    BDIIVIDE     261
  4519         INITIALIZE NOM-LEIDO-BDIIVIDE                                                        BDIIVIDE     262
  4520         MOVE NOM-VAL-BDIIVIDE TO NOM-LEIDO-BDIIVIDE.                                         BDIIVIDE     263
  4521                                                                                              BDIIVIDE     264
  4522 85020-UBICA-NIT.                                                                             BDIIVIDE     265
  4523*================================================================                             BDIIVIDE     266
  4524*85020-UBICA-NIT.                                                                             BDIIVIDE     267
  4525*Ubica NIT en archivo de la DIAN, BDIIDIAN                                                    BDIIVIDE     268
  4526*================================================================                             BDIIVIDE     269
  4527     MOVE NUM-IDE-BDIIVIDE TO NITS-R-BDIIDIAN                                                 BDIIVIDE     270
  4528     READ BDIIDIAN INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE                                       BDIIVIDE     271
  4529     END-READ                                                                                 BDIIVIDE     272
  4530     IF SW-ID-BDIIVIDE = 0                                                                    BDIIVIDE     273
  4531        MOVE DESCRIPCION-BDIIDIAN TO NOM-LEIDO-BDIIVIDE                                       BDIIVIDE     274
  4532     END-IF.                                                                                  BDIIVIDE     275
  4533                                                                                              BDIIVIDE     276
  4534 85030-UBICA-EXT.                                                                             BDIIVIDE     277
  4535*================================================================                             BDIIVIDE     278
  4536*85030-UBICA-EXT.                                                                             BDIIVIDE     279
  4537*Ubica cedula de extranjeria en archivo del DAS                                               BDIIVIDE     280
  4538*================================================================                             BDIIVIDE     281
  4539     MOVE NUM-IDE-BDIIVIDE TO NUM-ID-BDIIDAS                                                  BDIIVIDE     282
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  80
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDIIVIDE.P
  4540     MOVE TIP-IDE-BDIIVIDE TO TIPO-ID-BDIIDAS                                                 BDIIVIDE     283
  4541     READ BDIIDAS INVALID KEY MOVE 1 TO SW-ID-BDIIVIDE                                        BDIIVIDE     284
  4542     END-READ                                                                                 BDIIVIDE     285
  4543     IF SW-ID-BDIIVIDE = 0                                                                    BDIIVIDE     286
  4544        MOVE NOMBRE-BDIIDAS TO NOM-LEIDO-BDIIVIDE.                                            BDIIVIDE     287
* 4545     copy BDLDIR.PROC.                                                                                    1560
  4546*BDLDIR.PROC.v.0028                                                                           BDLDIR         1
  4547$SET CONSTANT HACERMATCH"NO"                                      RMB0013                     BDLDIR         2
  4548$IF HACERMATCH = "SI"                                             RMB0013                     BDLDIR         3
  4549$DISPLAY ".............COMPILANDO BDLDIR CON MATCH **********     RMB0013                     BDLDIR         4
  4550$ELSE                                                             RMB0013                     BDLDIR         5
  4551$DISPLAY ".............COMPILANDO BDLDIR SIN MATCH **********     RMB0013                     BDLDIR         6
  4552$END                                                              RMB0013                     BDLDIR         7
  4553******************************************************************                            BDLDIR         8
  4554* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS                            BDLDIR         9
  4555* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.                               BDLDIR        10
  4556*    2010-U-INICIAR-TABLAS   INICIA LAS TABLAS DE ORDENAMIENTO                                BDLDIR        11
  4557*    2018-U-PASAR-REG-ICBDIR ALMACENA EN MEMORIA LOS DATOS DEL                                BDLDIR        12
  4558*                            REGISTRO DIRECC .                                                BDLDIR        13
  4559*    2017-U-ELEGIR-DIRECCIONES SE UNIFICAN LAS DIRECCIONES Y SE                               BDLDIR        14
  4560*                              ORDENAN DE ACUERDO A LO DEFINIDO                               BDLDIR        15
  4561*    2017-U-ELEGIR-TELEFONOS   SE UNIFICAN LOS TELEFONOS Y SE                                 BDLDIR        16
  4562*                              ORDENAN DE ACUERDO A LO DEFINIDO                               BDLDIR        17
  4563*    06000-U-CARGAR-TABLA-DIRESTAN SE CARGAN EN MEMORIA LAS TABLAS                            BDLDIR        18
  4564*                                  DE ESTANDARIZACION DE NOMBRES DE                           BDLDIR        19
  4565*                                  COMPONENTES DE LAS DIRECCIONES                             BDLDIR        20
  4566*    6100-U-ESTANDARIZAR-DIRECC SE ESTANDARIZA LA DIRECCION DE ACUERDO                        BDLDIR        21
  4567*                               A LAS TABLAS DE SINONIMOS LEIDA.                              BDLDIR        22
  4568*******************************************************************                           BDLDIR        23
  4569* RMB0002      * ALG001 - SE CAMBIA EL ORDEN DE LA DIRECCION MAS                              BDLDIR        24
  4570* FEB-15-2003  *          PROBABLE AUMENTANDO UN PESO CON BASE A LA                           BDLDIR        25
  4571* R.MARTINEZ   *          CONFORMACION DE LA DIRECCION O DEL TELEFONO                         BDLDIR        26
  4572*******************************************************************                           BDLDIR        27
  4573* RMB0003      * DIRACC - SE DEJA COMO RUTINA LA VALIDACION DE LOS                            BDLDIR        28
  4574* MAR-15-2003  *          PERMISOS DE ACCESO A LA BASE DE DATOS DE                            BDLDIR        29
  4575* R.MARTINEZ   *          DIRECCIONES                                                         BDLDIR        30
  4576*******************************************************************                           BDLDIR        31
  4577* RMB0004      * VEC001 - SE CORRIGE PROBLEMA EN EL VECTOR DE TELE                            BDLDIR        32
  4578* ABR-15-2003  *          FONOS YA QUE USABA LA FECHA DE DIRECCIONES                          BDLDIR        33
  4579* R.MARTINEZ   *          Y NO LA V-FECHATEL                                                  BDLDIR        34
  4580*******************************************************************                           BDLDIR        35
  4581* RMB0005      * UBI001 - SE CORRIGE PROBLEMA DE REFLEGAR EN EL                               BDLDIR        36
  4582* ABR-15-2003  *          INFORME LA MISMA DIRECCION COMO R,L,C DIF-                          BDLDIR        37
  4583* R.MARTINEZ   *          ENTE EN DETALLE Y RESUMEN                                           BDLDIR        38
  4584*******************************************************************                           BDLDIR        39
  4585* VHF0006      * ESTAN1 - SE PERMITE QUE LAS PARTICULAS PARA                                  BDLDIR        40
  4586* MAY-27-2003  *          ESTANDARIZAR SEAN DE HASTA 30 CARACTERES                            BDLDIR        41
  4587* V.FORERO     *                                                                              BDLDIR        42
  4588*******************************************************************                           BDLDIR        43
  4589* RMB0007     * VALPRI- SE ARREGLA PROBLEMA DE SACAR TIPO-5 SI   *                            BDLDIR        44
  4590* R.MARTINEZ  *         LA PERSONA TENIA SOLO UNA CUENTA Y ESTABA*                            BDLDIR        45
  4591* MAR.13/2003 *         BLOQUEADA                                *                            BDLDIR        46
  4592******************************************************************                            BDLDIR        47
  4593* RMB0008     * VEC002- SE CORRIGE PROBLEMA ADICIONAL EN EL VECTO*                            BDLDIR        48
  4594* R.MARTINEZ  *         R DE TELEFONOS AL USAR LA FECHA DE LA    *                            BDLDIR        49
  4595* JUNIO /2003 *         DIRECCION                                *                            BDLDIR        50
  4596******************************************************************                            BDLDIR        51
  4597* FAC0009     * AMPDIR * AMPLIACIÓN DE LA ESTRUCTURA DE ARCHIVO  *                            BDLDIR        52
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  81
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4598* F.CUADROS C.*          ICBDIR. SE AMPLIAN LOS TAMAÑOS DE CAMPOS*                            BDLDIR        53
  4599* FEB.14/2006 *          TELÉFONOS, DIRECCIONES, CIUDADES, DPTOS.*                            BDLDIR        54
  4600*             * DOMICI - SEÑAL PARA MATCH DE DOMICILIACION                                    BDLDIR        55
  4602* RMB0010     * RCNCER - OPTIMIZACION PARA PRODUCTO RECONOCER. SE*                            BDLDIR        57
  4603* R.MARTINEZ  *          INCLUYO ESTANDARIZACION DE CIUDADES CON *                            BDLDIR        58
  4604* JUN.15/2006 *          BASE EN ARCHIVO DE ESTANDARIZACION DE   *                            BDLDIR        59
  4605*             *          CIUDADES DE OUTSOURCING DE DOCUMENTOS,  *                            BDLDIR        60
  4606*             *          SE ADICIONARON NUEVAS PARTICULAS        *                            BDLDIR        61
  4607*             *          ESTANDARIZADAS PARA DIRECCIONES, SE     *                            BDLDIR        62
  4608*             *          OPTIMIZO ALGORITMO PAR SELECCION DE     *                            BDLDIR        63
  4609*             *          TELEFONOS Y SE ADICIONARON LOS CONCEPTOS*                            BDLDIR        64
  4610*             *          DE DIRECCIONES CERTIFICADAS Y PUNTOS    *                            BDLDIR        65
  4611*             *          ADICIONALES (PARA GEOREFERENCIACION)    *                            BDLDIR        66
  4612******************************************************************                            BDLDIR        67
  4613* GJC0011     * NWDIRB - SE INCLUYE RUTINA EN LA QUE PARA LAS DI-*                            BDLDIR        68
  4614* G.JIMENEZ   *          RECCIONES DE BOGOTA IDENTIFICA SI EXIS- *                            BDLDIR        69
  4615* FEBRERO/2007*          TE NUEVA NOMENCLATURA                   *                            BDLDIR        70
  4616******************************************************************                            BDLDIR        71
  4617* RMB0012     * DIRB02 - SE ELIMINA LLENADO INOFICIOSO DE LA    -*                            BDLDIR        72
  4618* G.JIMENEZ   *          LLAVE DEL ARCHIVO DE NUEVA NOMENCLATURA *                            BDLDIR        73
  4619* FEB.26/2007 *          (ERROR    EN LCLZCN PROD = LOCALIZACION *                            BDLDIR        74
  4620******************************************************************                            BDLDIR        75
  4621* DLM0013     * UNLSUS - QUITAR EL LOCK AL MOMENTO DE LEER LOS   *                            BDLDIR        76
  4622* DARIO LASSO.*   REGISTROS.                                     *                            BDLDIR        77
  4623* RMB0013     * MATCH1 - MANEJO DEL MATCH DE NOMBRES A PARTIR DE *                            BDLDIR        78
  4624* R.MARTINEZ  *          LAS ESTRUCTURAS BASE DE DATACREDITO                                  BDLDIR        79
  4625******************************************************************                            BDLDIR        80
  4626* CAV0014     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *                            BDLDIR        81
  4627* C. VELASCO. *          LA TABLA V-CARTOT-BDLDIR NO EXCEDA LAS  *                            BDLDIR        82
  4628* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *                            BDLDIR        83
  4629******************************************************************                            BDLDIR        84
  4630* VHF0015     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER  *                            BDLDIR        85
  4631* VICTOR HUGO *          SE MODIFICA EL ALOGORITMO PARA LA       *                            BDLDIR        86
  4632* FORERO      *          SELECCION DE LA MEJOR DIRECCION         *                            BDLDIR        87
  4633* JUL.25/2008 *                                                  *                            BDLDIR        88
  4634******************************************************************                            BDLDIR        89
  4635* RMB0016     * FECH01 - SE TOMA COMO DEFAULT LA FECHA DE APERTUR*                            BDLDIR        90
  4636* RICARDO MART*          COMO MEJOR FECHA, ESTO SI LA INDIVIDUAL *                            BDLDIR        91
  4637*             *          ESTA EN CEROS, CASO QUE SERIA UN ERROR  *                            BDLDIR        92
  4638* FEB.09/2009 *          LA MEJOR SIEMPRE ES LA INDIVIDUAL       *                            BDLDIR        93
  4639******************************************************************                            BDLDIR        94
  4640* AAM0017       * TELEXC - Se agrega validación para la exclusión*                            BDLDIR        95
  4641* A. ALGARIN M. *          de teléfonos y unificación de los que *                            BDLDIR        96
  4642* MAR.12/2009   *          coincidan en los últimos 7 números.   *                            BDLDIR        97
  4643* INTERSCHEMES  *          Se agrega en la salida el campo fecha *                            BDLDIR        98
  4644*               *          último reporte.                       *                            BDLDIR        99
  4645*               * UNIDIR - UNIFICAR DIRECCIONES QUE TENGAN       *                            BDLDIR       100
  4646*               *          COINCIDENCIAS CON OTRAS DIRECCIONES   *                            BDLDIR       101
  4647*               *          CON MAYOR CANTIDAD DE INFORMACION -   *                            BDLDIR       102
  4648*               *          INCLUIR EN LA SALIDA EL CAMPO FECHA   *                            BDLDIR       103
  4649*               *          ULTIMO REP                            *                            BDLDIR       104
  4650******************************************************************                            BDLDIR       105
  4651* AAM0018       * INIVAR - Se inicializa variable de control de  *                            BDLDIR       106
  4652* A. ALGARIN M. *          unificación de direcciones.           *                            BDLDIR       107
  4653* MAR.26/2009   *                                                *                            BDLDIR       108
  4654* INTERSCHEMES  *                                                *                            BDLDIR       109
  4655******************************************************************                            BDLDIR       110
  4656* HGO0019       * UNIDI1 - Se ajusta por si existe una direccion *                            BDLDIR       111
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  82
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4657* H. GARCIA O.  *          con basura y al estandarizar queda    *                            BDLDIR       112
  4658* JUN.30/2009   *          en espacios                           *                            BDLDIR       113
  4659* INTERSCHEMES  *                                                *                            BDLDIR       114
  4660******************************************************************                            BDLDIR       115
  4661* HGO0020       * TEXTEL - Se agregan nuevas exclusiones en la   *                            BDLDIR       116
  4662* H. GARCIA O.  *          tabla de telefonos y se amplia el     *                            BDLDIR       117
  4663* SEP.01/2009   *          numero de ocurrencias                 *                            BDLDIR       118
  4664* INTERSCHEMES  *                                                *                            BDLDIR       119
  4665******************************************************************                            BDLDIR       120
  4666* HGO0021       * PYSPAR - AJUSTE QUE BUSCAR GENERAR CALIFICACION*                            BDLDIR       121
  4667* H. GARCIA O.  *          PARA LA PRIMERA Y SEGUNDA PARTICULA Y *                            BDLDIR       122
  4668* AGO. 25/2009  *          LUEGO UNIFICAR TENIENDO EN CUENTA ESTE*                            BDLDIR       123
  4669* INTERSCHEMES. *          CRITERIO                              *                            BDLDIR       124
  4670******************************************************************                            BDLDIR       125
  4671* RGH0022      * MOD022 - PARA LAS DIRECCIONES QUE SE UNIFICA    *                            BDLDIR       126
  4672* R.GALVIS     *          SE DEJA COMO FECHA DE ULTIMO REPORTE   *                            BDLDIR       127
  4673* DIC.25/2009  *          LA FECHA MAS RESIENTE DE LOS REGISTROS *                            BDLDIR       128
  4674* INTERSCHEMES *          QUE SE UNIFICAN                        *                            BDLDIR       129
  4675******************************************************************                            BDLDIR       130
  4676* PJV0023      * NN0023 - AJUSTE, PARA EVITAR QUE SE REPITAN     *                            BDLDIR       131
  4677* P.VARGAS     *          DIRECCIONES EN EL MISMO REPORTE CUNADO *                            BDLDIR       132
  4678* JUL 01/2010  *          SE TRATAN DE NUEVAS NOMENCLATURAS EN   *                            BDLDIR       133
  4679* DATACREDITO  *          BOGOTA.                                *                            BDLDIR       134
  4680******************************************************************                            BDLDIR       135
  4681* PJV0024      * AMP024 -SE AMPLIAN LOS LIMITES DE LAS TABLAS DE *                            BDLDIR       136
  4682* P.VARGAS     *         ACEPCIONES QUE SE CARGAN EN MEMORIA.    *                            BDLDIR       137
  4683* SEP 09/2010  *         TAMBIEN SE AJUSTA PARA EVITAR LA        *                            BDLDIR       138
  4684* DATACREDITO  *         REPETICION DE DIRECCIONES PARA UNA MISMA*                            BDLDIR       139
  4685*              *         IDENTIFICACION.                         *                            BDLDIR       140
  4686******************************************************************                            BDLDIR       141
  4687* PJV0025      * TEL025 -NO MOSTRAR TELÉFONOS NI CELULARES CON 1 *                            BDLDIR       142
  4688* P.VARGAS     *         Ó 9 EN LA POSICIÓN 7 DE DERECHA A       *                            BDLDIR       143
  4689* SEP 21/2010  *         IZQUIERDA                               *                            BDLDIR       144
  4690* DATACREDITO  *                                                 *                            BDLDIR       145
  4691******************************************************************                            BDLDIR       146
  4692* RMB0026      * BLOQ01 -SE ADICIONA CONTROL DE BLOQUEO DE       *                            BDLDIR       147
  4693* R.MARTINEZ   *         LA INFORMACION DE DIRECCIONES           *                            BDLDIR       148
  4694* OCT 01/2011  *                                                 *                            BDLDIR       149
  4695*                                                                                             BDLDIR       150
  4696* FARF026      * AJUCAL - SE AJUSTA PARA SUBIR DE 30 A 40 LOS                                 BDLDIR       151
  4697* F.RODRIGUEZ  *          VALORES DE V-CALFIN-BDLDIR PARA                                     BDLDIR       152
  4698* OCT 11/2011  *          DESEMPATAR POR FECHA                                                BDLDIR       153
  4699*                                                                                             BDLDIR       154
  4700* FARF026      * AJUACE - SE AJUSTA PARA QUE  MUEVA LAS PARTICULAS                            BDLDIR       155
  4701* F.RODRIGUEZ  *          DE LAS ACCEPCIONES COMPUESTAS.                                      BDLDIR       156
  4702* OCT 12/2011  *                                                                              BDLDIR       157
  4703******************************************************************                            BDLDIR       158
  4704* CAV0027      * CALDYT - SE ADICIONA LAS RUTINAS   PARA VALIDAR *                            BDLDIR       159
  4705* C.VELASCO.   *          LOS CAMPOS EMAIL Y TELEFONO CELULAR.   *                            BDLDIR       160
  4706* SEP 18/2012  *          8500-VALIDAR-EMAIL-BDLDIR.             *                            BDLDIR       161
  4707*              *          8600-VALIDAR-CELULAR-BDLDIR.           *                            BDLDIR       162
  4708******************************************************************                            BDLDIR       163
  4709* RMB0028      * FCRGCR- SE INTEGRA EL AJUSTE DE FECHAS DE       *                            BDLDIR       164
  4710* R.MARTINEZ   *         DIRECCIONES DE CUENTAS CERRADAS         *                            BDLDIR       165
  4711* OCT 16/2012  *         PARA IGUALAR CON LA RUTINA BDLDI2       *                            BDLDIR       166
  4712******************************************************************                            BDLDIR       167
  4713*                                                                                             BDLDIR       168
  4714*-----------------INICIALIZACION               --------------------                           BDLDIR       169
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  83
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4715 2010-U-INICIAR-TABLAS.                                                                       BDLDIR       170
  4716     MOVE 0 TO NUM-OK-SEND-BDLDIR.                                RMB0010                     BDLDIR       171
  4717     MOVE 1 TO DIR-OK-BDLDIR.                                     RMB0010                     BDLDIR       172
  4718     MOVE 1 TO TEL-OK-BDLDIR.                                     RMB0010                     BDLDIR       173
  4719     INITIALIZE TABLA-DIR-BDLDIR.                                 RMB0010                     BDLDIR       174
  4720     INITIALIZE TABLA-TEL-BDLDIR.                                 RMB0010                     BDLDIR       175
  4721     INITIALIZE TABLA-DIRFINALES-BDLDIR.                          RMB0010                     BDLDIR       176
  4722     INITIALIZE TABLA-TELFINALES-BDLDIR.                          RMB0010                     BDLDIR       177
  4723     INITIALIZE TABLA-DIRFINALESFIN-BDLDIR.                       AAM0017                     BDLDIR       178
  4724     INITIALIZE T-DIRFINALESAUX-BDLDIR.                           AAM0017                     BDLDIR       179
  4725*--------------------- LLENADO DE DATOS  --------------------                                 BDLDIR       180
  4726 2011-ESTANDARIZAR-CIUDAD.                                        RMB0010                     BDLDIR       181
  4727       PERFORM 2018-TOMAR-CIUDADES-ORIGINALES                     RMB0010                     BDLDIR       182
  4728       IF OPEN-BDLSTDCIU-BDLDIR = 0                               RMB0010                     BDLDIR       183
  4729          MOVE 1 TO OPEN-BDLSTDCIU-BDLDIR                         RMB0010                     BDLDIR       184
  4730          OPEN INPUT BDLSTDCIU                                    RMB0010                     BDLDIR       185
  4731       END-IF.                                                    RMB0010                     BDLDIR       186
  4732       IF CIURES-DIRECC NOT = SPACES                              RMB0010                     BDLDIR       187
  4733           MOVE CIURES-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010                     BDLDIR       188
  4734           PERFORM 1000-PROCESAR-CIU                              RMB0010                     BDLDIR       189
  4735           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIURES-DIRECC       RMB0010                     BDLDIR       190
  4736        END-IF                                                    RMB0010                     BDLDIR       191
  4737        IF CIUCOR-DIRECC NOT = SPACES                             RMB0010                     BDLDIR       192
  4738           MOVE CIUCOR-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010                     BDLDIR       193
  4739           PERFORM 1000-PROCESAR-CIU                              RMB0010                     BDLDIR       194
  4740           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIUCOR-DIRECC       RMB0010                     BDLDIR       195
  4741        END-IF                                                    RMB0010                     BDLDIR       196
  4742        IF CIULAB-DIRECC NOT = SPACES                             RMB0010                     BDLDIR       197
  4743           MOVE CIULAB-DIRECC TO LLAVE-BDLSTDCIU                  RMB0010                     BDLDIR       198
  4744           PERFORM 1000-PROCESAR-CIU                              RMB0010                     BDLDIR       199
  4745           MOVE CIUDAD-ESTANDAR-CIU-BDLDIR TO CIULAB-DIRECC       RMB0010                     BDLDIR       200
  4746        END-IF.                                                   RMB0010                     BDLDIR       201
  4747 1000-PROCESAR-CIU.                                               RMB0010                     BDLDIR       202
  4748     MOVE FUNCTION UPPER-CASE(LLAVE-BDLSTDCIU) TO LLAVE-BDLSTDCIU.RMB0010                     BDLDIR       203
  4749     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '"' BY " ".            RMB0010                     BDLDIR       204
  4750     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '*' BY " ".            RMB0010                     BDLDIR       205
  4751     INSPECT LLAVE-BDLSTDCIU REPLACING ALL '_' BY " ".            RMB0010                     BDLDIR       206
  4752     MOVE 0 TO PATRON-CIU-BDLDIR CODIGO-DANE-CIU-BDLDIR.          RMB0010                     BDLDIR       207
  4753     MOVE SPACES TO CODIGO-DANE-CIU-BDLDIR.                       RMB0010                     BDLDIR       208
  4754     MOVE 0 TO I-CIU-BDLDIR.                                      RMB0010                     BDLDIR       209
  4755     INSPECT LLAVE-BDLSTDCIU TALLYING I-CIU-BDLDIR FOR ALL "BOGOT"RMB0010                     BDLDIR       210
  4756     IF I-CIU-BDLDIR > 0                                          RMB0010                     BDLDIR       211
  4757        MOVE 1 TO PATRON-CIU-BDLDIR                               RMB0010                     BDLDIR       212
  4758        MOVE "BOGOTA" TO LLAVE-BDLSTDCIU                          RMB0010                     BDLDIR       213
  4759     ELSE                                                         RMB0010                     BDLDIR       214
  4760        MOVE LLAVE-BDLSTDCIU TO LLAVE-AUX-CIU-BDLDIR              RMB0010                     BDLDIR       215
  4761        UNSTRING LLAVE-AUX21-CIU-BDLDIR DELIMITED BY ALL " " INTO RMB0010                     BDLDIR       216
  4762           BASURA-CIU-BDLDIR CODIGO-DANE-CIU-BDLDIR               RMB0010                     BDLDIR       217
  4763        INSPECT CODIGO-DANE-CIU-BDLDIR REPLACING ALL " " BY "0"   RMB0010                     BDLDIR       218
  4764     END-IF.                                                      RMB0010                     BDLDIR       219
  4765     MOVE SPACES TO CAMPO-CIU-BDLDIR                              RMB0010                     BDLDIR       220
  4766     MOVE 1 TO I-CIU-BDLDIR J-CIU-BDLDIR                          RMB0010                     BDLDIR       221
  4767     PERFORM UNTIL I-CIU-BDLDIR > 30                              RMB0010                     BDLDIR       222
  4768        IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) <> " "                 RMB0010                     BDLDIR       223
  4769           IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) =                   RMB0010                     BDLDIR       224
  4770              ("(" OR "-" OR "." OR "," OR "/" OR "\" )           RMB0010                     BDLDIR       225
  4771                                  AND J-CIU-BDLDIR > 4            RMB0010                     BDLDIR       226
  4772              MOVE 50 TO I-CIU-BDLDIR                             RMB0010                     BDLDIR       227
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  84
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4773           ELSE                                                   RMB0010                     BDLDIR       228
  4774              IF LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1) NOT NUMERIC      RMB0010                     BDLDIR       229
  4775                 MOVE LLAVE-BDLSTDCIU(I-CIU-BDLDIR:1)             RMB0010                     BDLDIR       230
  4776                      TO CAMPO-CIU-BDLDIR(J-CIU-BDLDIR:1)         RMB0010                     BDLDIR       231
  4777                 ADD 1 TO J-CIU-BDLDIR                            RMB0010                     BDLDIR       232
  4778              END-IF                                              RMB0010                     BDLDIR       233
  4779           END-IF                                                 RMB0010                     BDLDIR       234
  4780        END-IF                                                    RMB0010                     BDLDIR       235
  4781        ADD 1 TO I-CIU-BDLDIR                                     RMB0010                     BDLDIR       236
  4782     END-PERFORM.                                                 RMB0010                     BDLDIR       237
  4783     IF CAMPO-CIU-BDLDIR = SPACES                                 RMB0010                     BDLDIR       238
  4784        IF CODIGO-DANE-CIU-BDLDIR NUMERIC AND                     RMB0010                     BDLDIR       239
  4785           CODIGO-DANE-N-CIU-BDLDIR > 01000000                    RMB0010                     BDLDIR       240
  4786           MOVE CODIGO-DANE-CIU-BDLDIR TO CAMPO-CIU-BDLDIR        RMB0010                     BDLDIR       241
  4787        END-IF                                                    RMB0010                     BDLDIR       242
  4788     END-IF.                                                      RMB0010                     BDLDIR       243
  4789     MOVE CAMPO-CIU-BDLDIR TO LLAVE-BDLSTDCIU                     RMB0010                     BDLDIR       244
  4790     READ BDLSTDCIU INVALID KEY                                   RMB0010                     BDLDIR       245
  4791            MOVE SPACES        TO CIUDAD-ESTANDAR-CIU-BDLDIR      RMB0010                     BDLDIR       246
  4792        NOT INVALID KEY                                           RMB0010                     BDLDIR       247
  4793            MOVE CIUDAD-BDLSTDCIU TO CIUDAD-ESTANDAR-CIU-BDLDIR   RMB0010                     BDLDIR       248
  4794     END-READ.                                                    RMB0010                     BDLDIR       249
  4795 2018-U-PASAR-REG-ICBDIR.                                                                     BDLDIR       250
  4796******************************************************************                            BDLDIR       251
  4797* SE VERIFICA QUE NO SEAN MAS DE 500 DIRECCIONES LAS QUE SE VAN  *                            BDLDIR       252
  4798* A ENCADENAR                                                    *                            BDLDIR       253
  4799******************************************************************                            BDLDIR       254
  4800     IF NUM-OK-SEND-BDLDIR <= 500                                 RMB0010                     BDLDIR       255
  4801        PERFORM 2018-TOMAR-DATOS                                                              BDLDIR       256
  4802     END-IF.                                                                                  BDLDIR       257
  4803     ADD 1 TO NUM-OK-SEND-BDLDIR.                                 RMB0010                     BDLDIR       258
  4804                                                                                              BDLDIR       259
  4805 2018-TOMAR-CIUDADES-ORIGINALES.                                  RMB0010                     BDLDIR       260
  4806******************************************************************RMB0010                     BDLDIR       261
  4807*2018-TOMAR-CIUDADES-ORIGINALES.                                 *RMB0010                     BDLDIR       262
  4808*    TOMA LAS CIUDADES ORIGINALES DEL ARCHIVO DE DIRECCIONES     *RMB0010                     BDLDIR       263
  4809*    PARA CADA TIPO DE INFORMACION (RESIDENCIAL, LABORAL, ETC)   *RMB0010                     BDLDIR       264
  4810******************************************************************RMB0010                     BDLDIR       265
  4811     MOVE CIURES-DIRECC TO CIUDAD-RES-A-ESTANDAR-BDLDIR           RMB0010                     BDLDIR       266
  4812     MOVE CIULAB-DIRECC TO CIUDAD-LAB-A-ESTANDAR-BDLDIR           RMB0010                     BDLDIR       267
  4813     MOVE CIUCOR-DIRECC TO CIUDAD-COR-A-ESTANDAR-BDLDIR.          RMB0010                     BDLDIR       268
  4814                                                                                              BDLDIR       269
  4815 2018-TOMAR-DATOS.                                                                            BDLDIR       270
  4816******************************************************************                            BDLDIR       271
  4817* SE TOMAN LOS DATOS DEL REGISTRO DE DIRECCIONES Y SE PASAN A LOS*                            BDLDIR       272
  4818* SIGUIENTES VECTORES:                                           *                            BDLDIR       273
  4819*        DIRECCIONES     V-DIRECCION      DIRECCION                                           BDLDIR       274
  4820*                        V-TIPODIR        UBICACION                                           BDLDIR       275
  4821*                        V-CIUDADDIR      CIUDAD                                              BDLDIR       276
  4822*                        V-SUSDIR         CODIGO SUSCRIPTOR                                   BDLDIR       277
  4823*                        V-FECHADIR       FECHA MEJOR                                         BDLDIR       278
  4824*                        V-TNUMDIR        VECTOR DE NUMEROS ORDENAD                           BDLDIR       279
  4825*                        V-HASDIR         STRING DE NUMEROS ORDENAD                           BDLDIR       280
  4826*        TELEFONOS       V-TELEFONO       TELEFONO                                            BDLDIR       281
  4827*                        V-TIPOTEL        UBICACION                                           BDLDIR       282
  4828*                        V-CIUDTEL        CIUDAD                                              BDLDIR       283
  4829*                        V-SUSTEL         CODIGO SUSCRIPTOR                                   BDLDIR       284
  4830*                        V-FECHATEL       FECHA MEJOR                                         BDLDIR       285
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  85
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4831******************************************************************                            BDLDIR       286
  4832     PERFORM 2011-ESTANDARIZAR-CIUDAD.                            RMB0010                     BDLDIR       287
  4833     IF CIURES-DIRECC NOT = SPACES                                                            BDLDIR       288
  4834        IF DIRRES-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010                     BDLDIR       289
  4835           MOVE DIRRES-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       290
  4836           MOVE "R"           TO V-TIPODIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010                     BDLDIR       291
  4837                                 IND-DATO-BDLDIR                  RMB0010                     BDLDIR       292
  4838           MOVE CIURES-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       293
  4839           MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010                     BDLDIR       294
  4840           MOVE DIRRES-DIRECC TO T-CARDIR-BDLDIR                  RMB0010                     BDLDIR       295
  4841           PERFORM 2019-ELEGIR-FECHA-DIR                          VHF0015                     BDLDIR       296
  4842           MOVE FECHA-MEJOR-BDLDIR                                RMB0010                     BDLDIR       297
  4843                TO V-FECHADIR-BDLDIR(DIR-OK-BDLDIR)               RMB0010                     BDLDIR       298
  4844           MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017                     BDLDIR       299
  4845           PERFORM 2020-U-BUSCAR-NUMEROS                                                      BDLDIR       300
  4846        END-IF                                                                                BDLDIR       301
  4847        IF TELRES-DIRECC > 0 AND TEL-OK-BDLDIR < 100 AND          RMB0010                     BDLDIR       302
  4848           TELRES-DIRECC < 9999999999                                                         BDLDIR       303
  4849           MOVE CIURES-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010                     BDLDIR       304
  4850           MOVE TELRES-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010                     BDLDIR       305
  4851                                 V-HASTEL-BDLDIR(TEL-OK-BDLDIR)   RMB0010                     BDLDIR       306
  4852           MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010                     BDLDIR       307
  4853           MOVE "R"           TO V-TIPOTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010                     BDLDIR       308
  4854                                 IND-DATO-BDLDIR                  RMB0010                     BDLDIR       309
  4855           PERFORM 2019-ELEGIR-FECHA-TEL                          VHF0015                     BDLDIR       310
  4856           MOVE FECHA-MEJOR-BDLDIR                                RMB0010                     BDLDIR       311
  4857                TO V-FECHATEL-BDLDIR(TEL-OK-BDLDIR)               RMB0010                     BDLDIR       312
  4858           MOVE FECULT-DIRECC                                     AAM0017                     BDLDIR       313
  4859                TO V-FECULTTEL-BDLDIR(TEL-OK-BDLDIR)              AAM0017                     BDLDIR       314
  4860           ADD 1 TO TEL-OK-BDLDIR                                 RMB0010                     BDLDIR       315
  4861     END-IF.                                                                                  BDLDIR       316
  4862     IF CIULAB-DIRECC NOT = SPACES                                FAC0009                     BDLDIR       317
  4863        IF DIRLAB-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100     RMB0010                     BDLDIR       318
  4864           MOVE DIRLAB-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       319
  4865           MOVE "L"           TO V-TIPODIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010                     BDLDIR       320
  4866                                 IND-DATO-BDLDIR                  RMB0010                     BDLDIR       321
  4867           MOVE CIULAB-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)RMB0010                     BDLDIR       322
  4868           MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)  RMB0010                     BDLDIR       323
  4869           MOVE DIRLAB-DIRECC TO T-CARDIR-BDLDIR                  RMB0010                     BDLDIR       324
  4870           PERFORM 2019-ELEGIR-FECHA-DIR                          VHF0015                     BDLDIR       325
  4871           MOVE FECHA-MEJOR-BDLDIR                                RMB0010                     BDLDIR       326
  4872                TO V-FECHADIR-BDLDIR(DIR-OK-BDLDIR)               RMB0010                     BDLDIR       327
  4873           MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017                     BDLDIR       328
  4874           PERFORM 2020-U-BUSCAR-NUMEROS                          FAC0009                     BDLDIR       329
  4875        END-IF                                                    FAC0009                     BDLDIR       330
  4876        IF TELLAB-DIRECC > 0 AND TEL-OK-BDLDIR < 100 AND          RMB0010                     BDLDIR       331
  4877           TELLAB-DIRECC < 9999999999                             FAC0009                     BDLDIR       332
  4878           MOVE CIULAB-DIRECC TO V-CIUDADTEL-BDLDIR(TEL-OK-BDLDIR)RMB0010                     BDLDIR       333
  4879           MOVE TELLAB-DIRECC TO V-TELEFONO-BDLDIR(TEL-OK-BDLDIR) RMB0010                     BDLDIR       334
  4880                              V-HASTEL-BDLDIR(TEL-OK-BDLDIR)      RMB0010                     BDLDIR       335
  4881           MOVE COD-SUS-DIRECC TO V-SUSTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010                     BDLDIR       336
  4882           MOVE "L"           TO V-TIPOTEL-BDLDIR(TEL-OK-BDLDIR)  RMB0010                     BDLDIR       337
  4883                                 IND-DATO-BDLDIR                  RMB0010                     BDLDIR       338
  4884           PERFORM 2019-ELEGIR-FECHA-TEL                          VHF0015                     BDLDIR       339
  4885           MOVE FECHA-MEJOR-BDLDIR                                RMB0010                     BDLDIR       340
  4886                TO V-FECHATEL-BDLDIR(TEL-OK-BDLDIR)               RMB0010                     BDLDIR       341
  4887           MOVE FECULT-DIRECC                                     AAM0017                     BDLDIR       342
  4888                TO V-FECULTTEL-BDLDIR(TEL-OK-BDLDIR)              AAM0017                     BDLDIR       343
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  86
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4889           ADD 1 TO TEL-OK-BDLDIR                                 RMB0010                     BDLDIR       344
  4890        END-IF                                                    FAC0009                     BDLDIR       345
  4891     END-IF.                                                      FAC0009                     BDLDIR       346
  4892     IF CIUCOR-DIRECC NOT = SPACES AND DIR-OK-BDLDIR < 100 AND    RMB0010                     BDLDIR       347
  4893        DIRCOR-DIRECC NOT = SPACES                                                            BDLDIR       348
  4894        MOVE CIUCOR-DIRECC TO V-CIUDADDIR-BDLDIR(DIR-OK-BDLDIR)   RMB0010                     BDLDIR       349
  4895        MOVE DIRCOR-DIRECC TO V-DIRECCION-BDLDIR(DIR-OK-BDLDIR)   RMB0010                     BDLDIR       350
  4896        MOVE COD-SUS-DIRECC TO V-SUSDIR-BDLDIR(DIR-OK-BDLDIR)     RMB0010                     BDLDIR       351
  4897        MOVE "C"           TO V-TIPODIR-BDLDIR(DIR-OK-BDLDIR)     RMB0010                     BDLDIR       352
  4898                              IND-DATO-BDLDIR                     RMB0010                     BDLDIR       353
  4899        MOVE DIRCOR-DIRECC TO T-CARDIR-BDLDIR                     RMB0010                     BDLDIR       354
  4900        PERFORM 2019-ELEGIR-FECHA-DIR                             VHF0015                     BDLDIR       355
  4901        MOVE FECHA-MEJOR-BDLDIR                                   RMB0010                     BDLDIR       356
  4902             TO V-FECHADIR-BDLDIR(DIR-OK-BDLDIR)                  RMB0010                     BDLDIR       357
  4903           MOVE FECULT-DIRECC TO V-FECULT-BDLDIR(DIR-OK-BDLDIR)   AAM0017                     BDLDIR       358
  4904        PERFORM 2020-U-BUSCAR-NUMEROS                                                         BDLDIR       359
  4905     END-IF.                                                                                  BDLDIR       360
  4906 2019-ELEGIR-FECHA-DIR.                                           VHF0015                     BDLDIR       361
  4907******************************************************************RMB0010                     BDLDIR       362
  4908*2019-ELEGIR-FECHA-DIR.                                          *VHF0015                     BDLDIR       363
  4909*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *RMB0010                     BDLDIR       364
  4910******************************************************************RMB0010                     BDLDIR       365
  4911***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION RMB0010                     BDLDIR       366
  4912***  Y LA DE CREACION                                             RMB0010                     BDLDIR       367
  4913*    IF FECACT-DIRECC >  FECCRE-DIRECC                            RMB0016                     BDLDIR       368
  4914*       MOVE FECACT-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016                     BDLDIR       369
  4915*    ELSE                                                         RMB0016                     BDLDIR       370
  4916*       MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016                     BDLDIR       371
  4917*    END-IF.                                                      RMB0016                     BDLDIR       372
  4918     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016                     BDLDIR       373
  4919***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA  RMB0010                     BDLDIR       374
  4920***  MEJOR                                                                                    BDLDIR       375
  4921     EVALUATE IND-DATO-BDLDIR                                     RMB0010                     BDLDIR       376
  4922        WHEN "R"                                                  RMB0010                     BDLDIR       377
  4923           IF FECDRES-DIRECC > 0                                  VHF0015                     BDLDIR       378
  4924              MOVE FECDRES-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015                     BDLDIR       379
  4925           END-IF                                                 RMB0010                     BDLDIR       380
  4926        WHEN "L"                                                  RMB0010                     BDLDIR       381
  4927           IF FECDLAB-DIRECC > 0                                  VHF0015                     BDLDIR       382
  4928              MOVE FECDLAB-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015                     BDLDIR       383
  4929           END-IF                                                 RMB0010                     BDLDIR       384
  4930        WHEN "C"                                                  RMB0010                     BDLDIR       385
  4931           IF FECDCOR-DIRECC > 0                                  VHF0015                     BDLDIR       386
  4932              MOVE FECDCOR-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015                     BDLDIR       387
  4933           END-IF                                                 RMB0010                     BDLDIR       388
  4934     END-EVALUATE.                                                RMB0010                     BDLDIR       389
  4935                                                                                              BDLDIR       390
  4936 2019-ELEGIR-FECHA-TEL.                                           VHF0015                     BDLDIR       391
  4937******************************************************************VHF0015                     BDLDIR       392
  4938*2019-ELEGIR-FECHA-TEL.                                          *VHF0015                     BDLDIR       393
  4939*    FECHAS PARA EL MEJOR TELEFONO                               *VHF0015                     BDLDIR       394
  4940*    RUTINA PARA SELECCIONAR LA MEJOR FECHA DEL DATO EN PROCESO  *VHF0015                     BDLDIR       395
  4941******************************************************************VHF0015                     BDLDIR       396
  4942***  POR DEFECTO SE TOMA LA MEJOR FECHA ENTRE LA DE ACTUALIZACION VHF0015                     BDLDIR       397
  4943***  Y LA DE CREACION                                             VHF0015                     BDLDIR       398
  4944*    IF FECACT-DIRECC >  FECCRE-DIRECC                            RMB0016                     BDLDIR       399
  4945*       MOVE FECACT-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016                     BDLDIR       400
  4946*    ELSE                                                         RMB0016                     BDLDIR       401
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  87
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  4947*       MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR                  RMB0016                     BDLDIR       402
  4948*    END-IF.                                                      RMB0016                     BDLDIR       403
  4949     MOVE FECAPE-DIRECC TO FECHA-MEJOR-BDLDIR *> DEFAULT SI ES 0  RMB0016                     BDLDIR       404
  4950***  SI EXISTE LA FECHA ASOCIADA AL TIPO DE DATO SE TOMA COMO LA  VHF0015                     BDLDIR       405
  4951***  MEJOR                                                        VHF0015                     BDLDIR       406
  4952     EVALUATE IND-DATO-BDLDIR                                     VHF0015                     BDLDIR       407
  4953        WHEN "R"                                                  VHF0015                     BDLDIR       408
  4954           IF FECTRES-DIRECC > 0                                  VHF0015                     BDLDIR       409
  4955              MOVE FECTRES-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015                     BDLDIR       410
  4956           END-IF                                                 VHF0015                     BDLDIR       411
  4957        WHEN "L"                                                  VHF0015                     BDLDIR       412
  4958           IF FECTLAB-DIRECC > 0                                  VHF0015                     BDLDIR       413
  4959              MOVE FECTLAB-DIRECC TO FECHA-MEJOR-BDLDIR           VHF0015                     BDLDIR       414
  4960           END-IF                                                 VHF0015                     BDLDIR       415
  4961     END-EVALUATE.                                                VHF0015                     BDLDIR       416
  4962                                                                                              BDLDIR       417
  4963 2020-U-BUSCAR-NUMEROS.                                                                       BDLDIR       418
  4964     MOVE 1 TO I-BDLDIR.                                          RMB0010                     BDLDIR       419
  4965     MOVE 0 TO J-BDLDIR.                                          RMB0010                     BDLDIR       420
  4966     MOVE " " TO CAR-ANT-BDLDIR.                                  RMB0010                     BDLDIR       421
  4967     INITIALIZE T-CARTOT-BDLDIR.                                  RMB0010                     BDLDIR       422
  4968     PERFORM UNTIL I-BDLDIR > 60 OR J-BDLDIR >= 10                CAV0014                     BDLDIR       423
  4969       IF V-CARDIR-BDLDIR(I-BDLDIR) NUMERIC                       RMB0010                     BDLDIR       424
  4970          MOVE V-CARDIR-BDLDIR(I-BDLDIR) TO CAR-ACT-BDLDIR        RMB0010                     BDLDIR       425
  4971          IF CAR-ANT-BDLDIR NUMERIC                               RMB0010                     BDLDIR       426
  4972             COMPUTE V-CARTOT-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       427
  4973                     = V-CARTOT-BDLDIR(J-BDLDIR)                  RMB0010                     BDLDIR       428
  4974                     * 10 + CAR-ACT-BDLDIR                        RMB0010                     BDLDIR       429
  4975          ELSE                                                                                BDLDIR       430
  4976             ADD 1 TO J-BDLDIR                                    RMB0010                     BDLDIR       431
  4977             MOVE V-CARDIR-BDLDIR(I-BDLDIR)                       RMB0010                     BDLDIR       432
  4978                  TO V-CARTOT-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       433
  4979          END-IF                                                                              BDLDIR       434
  4980       END-IF                                                                                 BDLDIR       435
  4981       MOVE V-CARDIR-BDLDIR(I-BDLDIR) TO CAR-ANT-BDLDIR           RMB0010                     BDLDIR       436
  4982       ADD 1 TO I-BDLDIR                                          RMB0010                     BDLDIR       437
  4983     END-PERFORM.                                                                             BDLDIR       438
  4984     MOVE T-CARTOT-BDLDIR(1:10) TO V-PRIDIG-BDLDIR(DIR-OK-BDLDIR).RMB0010                     BDLDIR       439
  4985     SORT V-CARTOT-BDLDIR DESCENDING.                             RMB0010                     BDLDIR       440
  4986     MOVE 1 TO I-BDLDIR.                                          RMB0010                     BDLDIR       441
  4987     PERFORM UNTIL I-BDLDIR > J-BDLDIR                            RMB0010                     BDLDIR       442
  4988       MOVE V-CARTOT-BDLDIR(I-BDLDIR)                             RMB0010                     BDLDIR       443
  4989            TO V-NUMDIR-BDLDIR(DIR-OK-BDLDIR,I-BDLDIR)            RMB0010                     BDLDIR       444
  4990       ADD 1 TO I-BDLDIR                                          RMB0010                     BDLDIR       445
  4991     END-PERFORM.                                                                             BDLDIR       446
  4992     MOVE T-CARTOT-BDLDIR    TO V-HASDIR-BDLDIR(DIR-OK-BDLDIR).   RMB0010                     BDLDIR       447
  4993     ADD 1 TO DIR-OK-BDLDIR.                                      RMB0010                     BDLDIR       448
  4994*-----------------MEJORES DIRECCIONES -----------------------------                           BDLDIR       449
  4995 2017-U-ELEGIR-DIRECCIONES.                                                                   BDLDIR       450
  4996*******************************************************************                           BDLDIR       451
  4997* SE UNIFICAN LAS DIRECCIONES Y SE ORDENAN POR EL CRITERIO DE LA                              BDLDIR       452
  4998* MEJOR FECHA Y EL NUMERO DE OCURRENCIAS.                                                     BDLDIR       453
  4999* LA RUTINA DEVUELVE UN ARREGLO CON ESTAS DIRECCIONES ORDENADAS                               BDLDIR       454
  5000*         05 V-DIRFIN       PIC X(60) DIRECCION                   FAC0009                     BDLDIR       455
  5001*         05 V-CIUFIN       PIC X(20) CIUDAD                      FAC0009                     BDLDIR       456
  5002*         05 V-TIPFIN       PIC X(01) UBICACION                                               BDLDIR       457
  5003*         05 V-FECFIN       PIC 9(6)  FECHA MEJOR.                                            BDLDIR       458
  5004*         05 V-NUMFIN       PIC 9(3)  NUMERO DE COINCIDENCIAS.                                BDLDIR       459
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  88
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5005*         05 V-SUSFIN       PIC 9(6)  CODIGO DE SUSCRIPTOR.                                   BDLDIR       460
  5006*         05 V-HASDIRFIN    PIC X(50) STRING DE NUMEROS.                                      BDLDIR       461
  5007*******************************************************************                           BDLDIR       462
  5008     MOVE 0 TO J-BDLDIR.                                          RMB0010                     BDLDIR       463
  5009     MOVE 0 TO J2-BDLDIR                                          HGO0021                     BDLDIR       464
  5010     INITIALIZE DIRECCION-BDLDIR                                  HGO0021                     BDLDIR       465
  5011     IF DIR-OK-BDLDIR > 1                                         RMB0010                     BDLDIR       466
  5012        SORT T-DIR-BDLDIR                                         RMB0010                     BDLDIR       467
  5013*RCNCER             DESCENDING T-NUMDIR-BDLDIR V-TIPODIR-BDLDIR   HGO0021                     BDLDIR       468
  5014             DESCENDING V-DIRECCION-BDLDIR V-TIPODIR-BDLDIR       HGO0021                     BDLDIR       469
  5015        MOVE ALL "9" TO NUMDIR-BDLDIR                             RMB0010                     BDLDIR       470
  5016        MOVE 1 TO I-BDLDIR                                        RMB0010                     BDLDIR       471
  5017        MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR                 RMB0010                     BDLDIR       472
  5018        MOVE 1 TO K-BDLDIR                                        RMB0010                     BDLDIR       473
  5019        PERFORM UNTIL I-BDLDIR >= DIR-OK-BDLDIR                   RMB0010                     BDLDIR       474
  5020          IF T-NUMDIR-BDLDIR(I-BDLDIR) = ZEROS                    HGO0021                     BDLDIR       475
  5021            IF I-BDLDIR > 1                                       HGO0021                     BDLDIR       476
  5022                PERFORM 2017-CALCULAR-VECTOR-RES                  HGO0021                     BDLDIR       477
  5023                MOVE VEC-HIS-BDLDIR                               HGO0021                     BDLDIR       478
  5024                     TO V-VECFIN-BDLDIR(J-BDLDIR)                 HGO0021                     BDLDIR       479
  5025             END-IF                                               HGO0021                     BDLDIR       480
  5026             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     HGO0021                     BDLDIR       481
  5027                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              HGO0021                     BDLDIR       482
  5028             ADD 1 TO K-BDLDIR                                    HGO0021                     BDLDIR       483
  5029             ADD 1 TO J-BDLDIR                                    HGO0021                     BDLDIR       484
  5030             MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                    HGO0021                     BDLDIR       485
  5031                  TO V-DIRFIN-BDLDIR(J-BDLDIR)                    HGO0021                     BDLDIR       486
  5032                     DIRECCION-BDLDIR                             HGO0021                     BDLDIR       487
  5033             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     HGO0021                     BDLDIR       488
  5034                  TO V-FECFIN-BDLDIR(J-BDLDIR)                    HGO0021                     BDLDIR       489
  5035             MOVE V-CIUDADDIR-BDLDIR(I-BDLDIR)                    HGO0021                     BDLDIR       490
  5036                  TO V-CIUFIN-BDLDIR(J-BDLDIR)                    HGO0021                     BDLDIR       491
  5037             MOVE V-TIPODIR-BDLDIR(I-BDLDIR)                      HGO0021                     BDLDIR       492
  5038                  TO V-TIPFIN-BDLDIR(J-BDLDIR)                    HGO0021                     BDLDIR       493
  5039             MOVE V-SUSDIR-BDLDIR (I-BDLDIR)                      HGO0021                     BDLDIR       494
  5040                  TO V-SUSFIN-BDLDIR(J-BDLDIR)                    HGO0021                     BDLDIR       495
  5041             MOVE V-HASDIR-BDLDIR (I-BDLDIR)                      HGO0021                     BDLDIR       496
  5042                  TO V-HASDIRFIN-BDLDIR(J-BDLDIR)                 HGO0021                     BDLDIR       497
  5043             MOVE V-PRIDIG-BDLDIR (I-BDLDIR)                      HGO0021                     BDLDIR       498
  5044                  TO V-PRIDIGFIN-BDLDIR(J-BDLDIR)                 HGO0021                     BDLDIR       499
  5045             MOVE V-FECULT-BDLDIR(I-BDLDIR)                       HGO0021                     BDLDIR       500
  5046                  TO V-FECULTFIN-BDLDIR(J-BDLDIR)                 HGO0021                     BDLDIR       501
  5047             MOVE V-NUENOM-BDLDIR(I-BDLDIR)                       HGO0021                     BDLDIR       502
  5048                  TO V-NUENOMFIN-BDLDIR(J-BDLDIR)                 HGO0021                     BDLDIR       503
  5049             MOVE 1                  TO V-NUMFIN-BDLDIR(J-BDLDIR) HGO0021                     BDLDIR       504
  5050             MOVE T-NUMDIR-BDLDIR(I-BDLDIR)    TO NUMDIR-BDLDIR   HGO0021                     BDLDIR       505
  5051          END-IF                                                  HGO0021                     BDLDIR       506
  5052*RCNCER          IF NUMDIR-BDLDIR NOT = T-NUMDIR-BDLDIR (I-BDLDIR)HGO0021                     BDLDIR       507
  5053          IF DIRECCION-BDLDIR NOT = V-DIRECCION-BDLDIR(I-BDLDIR)  HGO0021                     BDLDIR       508
  5054          AND T-NUMDIR-BDLDIR(I-BDLDIR) NOT = ZEROS               HGO0021                     BDLDIR       509
  5055             IF I-BDLDIR > 1                                      RMB0010                     BDLDIR       510
  5056                PERFORM 2017-CALCULAR-VECTOR-RES                                              BDLDIR       511
  5057                MOVE VEC-HIS-BDLDIR                               RMB0010                     BDLDIR       512
  5058                     TO V-VECFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       513
  5059             END-IF                                                                           BDLDIR       514
  5060             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR       515
  5061                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010                     BDLDIR       516
  5062             ADD 1 TO K-BDLDIR                                    RMB0010                     BDLDIR       517
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  89
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5063             ADD 1 TO J-BDLDIR                                    RMB0010                     BDLDIR       518
  5064             MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                    RMB0010                     BDLDIR       519
  5065                  TO V-DIRFIN-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       520
  5066                     DIRECCION-BDLDIR                             HGO0021                     BDLDIR       521
  5067             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR       522
  5068                  TO V-FECFIN-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       523
  5069             MOVE V-CIUDADDIR-BDLDIR(I-BDLDIR)                    RMB0010                     BDLDIR       524
  5070                  TO V-CIUFIN-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       525
  5071             MOVE V-TIPODIR-BDLDIR(I-BDLDIR)                      RMB0010                     BDLDIR       526
  5072                  TO V-TIPFIN-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       527
  5073             MOVE V-SUSDIR-BDLDIR (I-BDLDIR)                      RMB0010                     BDLDIR       528
  5074                  TO V-SUSFIN-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR       529
  5075             MOVE V-HASDIR-BDLDIR (I-BDLDIR)                      RMB0010                     BDLDIR       530
  5076                  TO V-HASDIRFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       531
  5077             MOVE V-PRIDIG-BDLDIR (I-BDLDIR)                      RMB0010                     BDLDIR       532
  5078                  TO V-PRIDIGFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       533
  5079             MOVE V-FECULT-BDLDIR(I-BDLDIR)                       AAM0017                     BDLDIR       534
  5080                  TO V-FECULTFIN-BDLDIR(J-BDLDIR)                 AAM0017                     BDLDIR       535
  5081             MOVE V-NUENOM-BDLDIR(I-BDLDIR)                       AAM0017                     BDLDIR       536
  5082                  TO V-NUENOMFIN-BDLDIR(J-BDLDIR)                 AAM0017                     BDLDIR       537
  5083             MOVE 1                  TO V-NUMFIN-BDLDIR(J-BDLDIR) RMB0010                     BDLDIR       538
  5084             MOVE T-NUMDIR-BDLDIR(I-BDLDIR)    TO NUMDIR-BDLDIR   RMB0010                     BDLDIR       539
  5085          ELSE                                                                                BDLDIR       540
  5086             IF T-NUMDIR-BDLDIR(I-BDLDIR) NOT = ZEROS             HGO0021                     BDLDIR       541
  5087             MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR       542
  5088                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010                     BDLDIR       543
  5089             ADD 1 TO K-BDLDIR                                                                BDLDIR       544
  5090             ADD  1 TO V-NUMFIN-BDLDIR(J-BDLDIR)                  RMB0010                     BDLDIR       545
  5091             IF V-FECHADIR-BDLDIR(I-BDLDIR) >                     RMB0010                     BDLDIR       546
  5092                V-FECFIN-BDLDIR(J-BDLDIR)                         RMB0010                     BDLDIR       547
  5093                MOVE V-FECHADIR-BDLDIR(I-BDLDIR)                  RMB0010                     BDLDIR       548
  5094                     TO V-FECFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       549
  5095                MOVE V-DIRECCION-BDLDIR(I-BDLDIR)                 RMB0010                     BDLDIR       550
  5096                     TO V-DIRFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       551
  5097                MOVE V-CIUDADDIR-BDLDIR(I-BDLDIR)                 RMB0010                     BDLDIR       552
  5098                     TO V-CIUFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       553
  5099                MOVE V-TIPODIR-BDLDIR(I-BDLDIR)                   RMB0010                     BDLDIR       554
  5100                     TO V-TIPFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       555
  5101                MOVE V-SUSDIR-BDLDIR (I-BDLDIR)                   RMB0010                     BDLDIR       556
  5102                     TO V-SUSFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR       557
  5103*               MOVE V-FECULT-BDLDIR(I-BDLDIR)                    RGH0022                     BDLDIR       558
  5104*                    TO V-FECULTFIN-BDLDIR(J-BDLDIR)              RGH0022                     BDLDIR       559
  5105                IF V-FECULT-BDLDIR(I-BDLDIR) >                    RGH0022                     BDLDIR       560
  5106                   V-FECULTFIN-BDLDIR(J-BDLDIR)                   RGH0022                     BDLDIR       561
  5107                   MOVE V-FECULT-BDLDIR(I-BDLDIR)  TO             RGH0022                     BDLDIR       562
  5108                        V-FECULTFIN-BDLDIR(J-BDLDIR)              RGH0022                     BDLDIR       563
  5109                END-IF                                            RGH0022                     BDLDIR       564
  5110                MOVE V-NUENOM-BDLDIR(I-BDLDIR)                    AAM0017                     BDLDIR       565
  5111                     TO V-NUENOMFIN-BDLDIR(J-BDLDIR)              AAM0017                     BDLDIR       566
  5112             END-IF                                                                           BDLDIR       567
  5113             END-IF                                               HGO0021                     BDLDIR       568
  5114          END-IF                                                                              BDLDIR       569
  5115          ADD 1 TO I-BDLDIR                                       RMB0010                     BDLDIR       570
  5116        END-PERFORM                                                                           BDLDIR       571
  5117* DESPLEGAR DESPUES DE CALCULOS                                   PJV0024                     BDLDIR       572
  5118*        MOVE 1 TO CONTADOR-TEMPORAL-BDLDIR                       HGO0021                     BDLDIR       573
  5119*        DISPLAY "VECTOR UNIFICADO NUMERICO Y FECHA"              HGO0021                     BDLDIR       574
  5120*      DISPLAY "DIRECCION                                        "HGO0021                     BDLDIR       575
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  90
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5121*-             "          FECHA REPORTES"                         HGO0021                     BDLDIR       576
  5122*        PERFORM UNTIL CONTADOR-TEMPORAL-BDLDIR > J-BDLDIR        HGO0021                     BDLDIR       577
  5123*         DISPLAY V-DIRFIN-BDLDIR(CONTADOR-TEMPORAL-BDLDIR)       HGO0021                     BDLDIR       578
  5124*         V-FECFIN-BDLDIR(CONTADOR-TEMPORAL-BDLDIR)               HGO0021                     BDLDIR       579
  5125*         V-NUMFIN-BDLDIR(CONTADOR-TEMPORAL-BDLDIR)               HGO0021                     BDLDIR       580
  5126*         ADD 1 TO CONTADOR-TEMPORAL-BDLDIR                       HGO0021                     BDLDIR       581
  5127*        END-PERFORM                                              HGO0021                     BDLDIR       582
  5128*        DISPLAY "VECTOR CARACTERES ESTANDARIZADO"                HGO0021                     BDLDIR       583
  5129*        DISPLAY "DIRECCION                                      "HGO0021                     BDLDIR       584
  5130*-             "            REPORTES"                             HGO0021                     BDLDIR       585
  5131        IF I-BDLDIR > 1                                           RMB0010                     BDLDIR       586
  5132           PERFORM 2017-CALCULAR-VECTOR-RES                                                   BDLDIR       587
  5133           MOVE VEC-HIS-BDLDIR TO V-VECFIN-BDLDIR(J-BDLDIR)       RMB0010                     BDLDIR       588
  5134        END-IF                                                                                BDLDIR       589
  5135     END-IF.                                                                                  BDLDIR       590
  5136     IF J-BDLDIR > 0                                              RMB0010                     BDLDIR       591
  5137        MOVE 1 TO I-BDLDIR                                        RMB0010                     BDLDIR       592
  5138        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         RMB0010                     BDLDIR       593
  5139           MOVE V-DIRFIN-BDLDIR (I-BDLDIR)                        RMB0010                     BDLDIR       594
  5140                TO DIRECCION-A-ESTANDARIZAR-BDLDIR                RMB0010                     BDLDIR       595
  5141           EVALUATE V-TIPFIN-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR       596
  5142              WHEN "R"                                            RMB0010                     BDLDIR       597
  5143                 MOVE CIUDAD-RES-A-ESTANDAR-BDLDIR                RMB0010                     BDLDIR       598
  5144                      TO CIUDAD-BDLDIR                            RMB0010                     BDLDIR       599
  5145                 MOVE 0 TO DIRCER-BDLDIR                          RMB0010                     BDLDIR       600
  5146                 MOVE 0 TO PTSADI-BDLDIR                          RMB0010                     BDLDIR       601
  5147                 IF CERRES-DIRECC NUMERIC                         RMB0010                     BDLDIR       602
  5148                    MOVE CERRES-DIRECC TO DIRCER-BDLDIR           RMB0010                     BDLDIR       603
  5149                 END-IF                                           RMB0010                     BDLDIR       604
  5150                 IF ADIRES-DIRECC NUMERIC                         RMB0010                     BDLDIR       605
  5151                    MOVE ADIRES-DIRECC TO PTSADI-BDLDIR           RMB0010                     BDLDIR       606
  5152                 END-IF                                           RMB0010                     BDLDIR       607
  5153              WHEN "L"                                            RMB0010                     BDLDIR       608
  5154                 MOVE CIUDAD-LAB-A-ESTANDAR-BDLDIR                RMB0010                     BDLDIR       609
  5155                      TO CIUDAD-BDLDIR                            RMB0010                     BDLDIR       610
  5156                 MOVE 0 TO DIRCER-BDLDIR                          RMB0010                     BDLDIR       611
  5157                 MOVE 0 TO PTSADI-BDLDIR                          RMB0010                     BDLDIR       612
  5158                 IF CERLAB-DIRECC NUMERIC                         RMB0010                     BDLDIR       613
  5159                    MOVE CERLAB-DIRECC TO DIRCER-BDLDIR           RMB0010                     BDLDIR       614
  5160                 END-IF                                           RMB0010                     BDLDIR       615
  5161                 IF ADILAB-DIRECC NUMERIC                         RMB0010                     BDLDIR       616
  5162                    MOVE ADILAB-DIRECC TO PTSADI-BDLDIR           RMB0010                     BDLDIR       617
  5163                 END-IF                                           RMB0010                     BDLDIR       618
  5164              WHEN "C"                                            RMB0010                     BDLDIR       619
  5165                 MOVE CIUDAD-COR-A-ESTANDAR-BDLDIR                RMB0010                     BDLDIR       620
  5166                      TO CIUDAD-BDLDIR                            RMB0010                     BDLDIR       621
  5167                 MOVE 0 TO DIRCER-BDLDIR                          RMB0010                     BDLDIR       622
  5168                 MOVE 0 TO PTSADI-BDLDIR                          RMB0010                     BDLDIR       623
  5169                 IF CERCOR-DIRECC NUMERIC                         RMB0010                     BDLDIR       624
  5170                    MOVE CERCOR-DIRECC TO DIRCER-BDLDIR           RMB0010                     BDLDIR       625
  5171                 END-IF                                           RMB0010                     BDLDIR       626
  5172                 IF ADICOR-DIRECC NUMERIC                         RMB0010                     BDLDIR       627
  5173                    MOVE ADICOR-DIRECC TO PTSADI-BDLDIR           RMB0010                     BDLDIR       628
  5174                 END-IF                                           RMB0010                     BDLDIR       629
  5175           END-EVALUATE                                           RMB0010                     BDLDIR       630
  5176           PERFORM 6100-U-ESTANDARIZAR-DIRECC                                                 BDLDIR       631
  5177* DESPLEGAR DESPUES DE CALCULOS                                   PJV0024                     BDLDIR       632
  5178*          DISPLAY DIRECCION-ESTANDARIZADA-BDLDIR                 HGO0021                     BDLDIR       633
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  91
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5179*          V-NUMFIN-BDLDIR(I-BDLDIR)                              HGO0021                     BDLDIR       634
  5180           MOVE DIRECCION-ESTANDARIZADA-BDLDIR                    RMB0010                     BDLDIR       635
  5181                TO V-STAFIN-BDLDIR(I-BDLDIR)                      RMB0010                     BDLDIR       636
  5182           MOVE PRIPART-ESTANDARIZADA-BDLDIR TO                   HGO0021                     BDLDIR       637
  5183            V-PRIPARTFIN-BDLDIR(I-BDLDIR)                         HGO0021                     BDLDIR       638
  5184           MOVE SEGPART-ESTANDARIZADA-BDLDIR TO                   HGO0021                     BDLDIR       639
  5185            V-SEGPARTFIN-BDLDIR(I-BDLDIR)                         HGO0021                     BDLDIR       640
  5186           MOVE CALIFICA-DIR-BDLDIR TO V-CALFIN-BDLDIR(I-BDLDIR)  RMB0010                     BDLDIR       641
  5187           IF V-CALFIN-BDLDIR(I-BDLDIR) >= 30                     FARF026                     BDLDIR       642
  5188              MOVE 40 TO V-CALFIN-BDLDIR(I-BDLDIR)                FARF026                     BDLDIR       643
  5189           END-IF                                                 FARF026                     BDLDIR       644
  5190*                                                                                             BDLDIR       645
  5191           MOVE CALIFICA-DIRPART1-BDLDIR TO                       HGO0021                     BDLDIR       646
  5192            V-CALFIN-PART1-BDLDIR(I-BDLDIR)                       HGO0021                     BDLDIR       647
  5193           MOVE CALIFICA-DIRPART2-BDLDIR TO                       HGO0021                     BDLDIR       648
  5194            V-CALFIN-PART2-BDLDIR(I-BDLDIR)                       HGO0021                     BDLDIR       649
  5195***        SE ELIMINAN LAS DIRECCIONES MENORES A LA POLITICA      RMB0010                     BDLDIR       650
  5196           IF CALIFICA-DIR-BDLDIR < POLITICA-EXC-CAL-DIR-BDLDIR ORRMB0010                     BDLDIR       651
  5197              CALIFICA-DIR-BDLDIR = 0                             RMB0010                     BDLDIR       652
  5198              MOVE 0                  TO V-FECFIN-BDLDIR(I-BDLDIR)RMB0010                     BDLDIR       653
  5199           END-IF                                                 RMB0010                     BDLDIR       654
  5200           ADD 1 TO I-BDLDIR                                      RMB0010                     BDLDIR       655
  5201        END-PERFORM                                                                           BDLDIR       656
  5202        MOVE 1 TO I-BDLDIR                                        AAM0017                     BDLDIR       657
  5203        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         AAM0017                     BDLDIR       658
  5204         MOVE V-CIUFIN-BDLDIR(I-BDLDIR)  TO CIUDAD-BTA-BDLDIR     AAM0017                     BDLDIR       659
  5205         MOVE V-STAFIN-BDLDIR(I-BDLDIR)  TO DIRECCION-BTA-BDLDIR  AAM0017                     BDLDIR       660
  5206         PERFORM 2590-NVA-DIRECC-BOGOTA                           AAM0017                     BDLDIR       661
  5207         IF HAY-BDLNEWDIRBOG-BDLDIR = 1                           AAM0017                     BDLDIR       662
  5208          MOVE DIRNEW-BDLNEWDIRBOG TO V-STAFIN-BDLDIR(I-BDLDIR)   AAM0017                     BDLDIR       663
  5209          MOVE 1 TO V-NUENOMFIN-BDLDIR(I-BDLDIR)                  AAM0017                     BDLDIR       664
  5210         END-IF                                                   AAM0017                     BDLDIR       665
  5211         ADD 1 TO I-BDLDIR                                        AAM0017                     BDLDIR       666
  5212        END-PERFORM                                               AAM0017                     BDLDIR       667
  5213        MOVE 1 TO I-BDLDIR                                        AAM0017                     BDLDIR       668
  5214        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         AAM0017                     BDLDIR       669
  5215         MOVE V-STAFIN-BDLDIR(I-BDLDIR) TO DIRECCION              AAM0017                     BDLDIR       670
  5216         PERFORM 2017-VECTOR-UNO                                  AAM0017                     BDLDIR       671
  5217         MOVE DIRECCION1 TO V-NUMDIRFIN-BDLDIR(I-BDLDIR)          AAM0017                     BDLDIR       672
  5218         ADD 1 TO I-BDLDIR                                        AAM0017                     BDLDIR       673
  5219        END-PERFORM                                               AAM0017                     BDLDIR       674
  5220        MOVE 0 TO CAMBIO                                          AAM0017                     BDLDIR       675
  5221        MOVE 0 TO RMAYOR                                          AAM0018                     BDLDIR       676
  5222*UNIDIR        SORT T-DIRFINALES-BDLDIR DESCENDING V-NUMDIRFIN-BDLHGO0021                     BDLDIR       677
  5223*UNIDIR                                            V-NUENOMFIN-BDLHGO0021                     BDLDIR       678
  5224        SORT T-DIRFINALES-BDLDIR DESCENDING V-NUENOMFIN-BDLDIR    HGO0021                     BDLDIR       679
  5225* DESPLEGAR DESPUES DE CALCULOS                                   PJV0024                     BDLDIR       680
  5226*       MOVE 1 TO CON-PART-ESTANDARIZADA-BDLDIR                   HGO0021                     BDLDIR       681
  5227*        DISPLAY "ARREGLO ORDENADO POR NN"                        HGO0021                     BDLDIR       682
  5228*        DISPLAY "DIRECCION                                      "HGO0021                     BDLDIR       683
  5229*-             "            REPNCP1CP2CFN"                        HGO0021                     BDLDIR       684
  5230*        PERFORM UNTIL CON-PART-ESTANDARIZADA-BDLDIR > J-BDLDIR   HGO0021                     BDLDIR       685
  5231*         DISPLAY V-STAFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)  HGO0021                     BDLDIR       686
  5232*         V-NUMFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)          HGO0021                     BDLDIR       687
  5233*         V-NUENOMFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)       HGO0021                     BDLDIR       688
  5234*         V-CALFIN-PART1-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)    HGO0021                     BDLDIR       689
  5235*         V-CALFIN-PART2-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)    HGO0021                     BDLDIR       690
  5236*         V-CALFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)          HGO0021                     BDLDIR       691
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  92
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5237*         ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                  HGO0021                     BDLDIR       692
  5238*        END-PERFORM                                              HGO0021                     BDLDIR       693
  5239        MOVE 1 TO J1-BDLDIR                                       HGO0021                     BDLDIR       694
  5240        MOVE 1 TO G-BDLDIR                                        HGO0021                     BDLDIR       695
  5241        PERFORM UNTIL J1-BDLDIR > J-BDLDIR                        HGO0021                     BDLDIR       696
  5242         IF V-NUENOMFIN-BDLDIR(J1-BDLDIR) = 1 AND                 HGO0021                     BDLDIR       697
  5243         V-STAFIN-BDLDIR(J1-BDLDIR) <> SPACES                     HGO0021                     BDLDIR       698
  5244            MOVE 0 TO CONTA                                       HGO0021                     BDLDIR       699
  5245            INSPECT V-NUMDIRFIN-BDLDIR(J1-BDLDIR) TALLYING CONTA  HGO0021                     BDLDIR       700
  5246            FOR CHARACTERS BEFORE INITIAL "  "                    HGO0021                     BDLDIR       701
  5247            COMPUTE H-BDLDIR = J1-BDLDIR + 1                      HGO0021                     BDLDIR       702
  5248            MOVE 0 TO SW-NN                                       PJV0023                     BDLDIR       703
  5249            PERFORM UNTIL H-BDLDIR > J-BDLDIR                     HGO0021                     BDLDIR       704
  5250              MOVE 1 TO SW-NN                                     PJV0023                     BDLDIR       705
  5251              MOVE 0 TO CONTA1                                    HGO0021                     BDLDIR       706
  5252              INSPECT V-NUMDIRFIN-BDLDIR(H-BDLDIR) TALLYING CONTA1HGO0021                     BDLDIR       707
  5253              FOR CHARACTERS BEFORE INITIAL "   "                 HGO0021                     BDLDIR       708
  5254               IF CONTA >= CONTA1 AND CONTA1 > 0 AND              HGO0021                     BDLDIR       709
  5255               (V-NUMDIRFIN-BDLDIR(J1-BDLDIR)(1:CONTA1) =         HGO0021                     BDLDIR       710
  5256               V-NUMDIRFIN-BDLDIR(H-BDLDIR)(1:CONTA1))            HGO0021                     BDLDIR       711
  5257                  PERFORM 2017-UNINN                              HGO0021                     BDLDIR       712
  5258               ELSE                                               HGO0021                     BDLDIR       713
  5259                  IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =          HGO0021                     BDLDIR       714
  5260                  V-NUMDIRFINAUX-BDLDIR                           HGO0021                     BDLDIR       715
  5261                     MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO       HGO0021                     BDLDIR       716
  5262                     T-DIRFINALESAUX-BDLDIR                       HGO0021                     BDLDIR       717
  5263                  END-IF                                          HGO0021                     BDLDIR       718
  5264               END-IF                                             HGO0021                     BDLDIR       719
  5265               ADD 1 TO H-BDLDIR                                  HGO0021                     BDLDIR       720
  5266            END-PERFORM                                           HGO0021                     BDLDIR       721
  5267            IF SW-NN = 0                                          PJV0023                     BDLDIR       722
  5268               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             PJV0023                     BDLDIR       723
  5269                    T-DIRFINALESAUX-BDLDIR                        PJV0023                     BDLDIR       724
  5270            END-IF                                                PJV0023                     BDLDIR       725
  5271            INITIALIZE T-DIRFINALES-BDLDIR(J1-BDLDIR)             HGO0021                     BDLDIR       726
  5272            ADD 1 TO J2-BDLDIR                                    HGO0021                     BDLDIR       727
  5273            MOVE T-DIRFINALESAUX-BDLDIR TO                        HGO0021                     BDLDIR       728
  5274               T-DIRFINALESFIN-BDLDIR(G-BDLDIR)                   HGO0021                     BDLDIR       729
  5275            INITIALIZE T-DIRFINALESAUX-BDLDIR                     PJV0023                     BDLDIR       730
  5276            ADD 1 TO G-BDLDIR                                     HGO0021                     BDLDIR       731
  5277            ADD 1 TO J1-BDLDIR                                    HGO0021                     BDLDIR       732
  5278         ELSE                                                     HGO0021                     BDLDIR       733
  5279            COMPUTE J1-BDLDIR = J-BDLDIR + 1                      HGO0021                     BDLDIR       734
  5280         END-IF                                                   HGO0021                     BDLDIR       735
  5281        END-PERFORM                                               HGO0021                     BDLDIR       736
  5282        SORT T-DIRFINALES-BDLDIR DESCENDING V-NUMDIRFIN-BDLDIR    HGO0021                     BDLDIR       737
  5283                                            V-CALFIN-BDLDIR       HGO0021                     BDLDIR       738
  5284                                            V-STAFIN-BDLDIR       HGO0021                     BDLDIR       739
  5285*        ADD 1 TO J2-BDLDIR                                       HGO0021                     BDLDIR       740
  5286        COMPUTE J-BDLDIR = J-BDLDIR - J2-BDLDIR                   HGO0021                     BDLDIR       741
  5287* DESPLEGAR DESPUES DE CALCULOS                                   PJV0024                     BDLDIR       742
  5288*        MOVE 1 TO CON-PART-ESTANDARIZADA-BDLDIR                  HGO0021                     BDLDIR       743
  5289*        DISPLAY "DESPUES DE T-DIRFINALES-BDLDIR ***"             HGO0021                     BDLDIR       744
  5290*        DISPLAY "DIRECCION                                      "HGO0021                     BDLDIR       745
  5291*-             "            REPCP1CP2CFN"                         HGO0021                     BDLDIR       746
  5292*        PERFORM UNTIL CON-PART-ESTANDARIZADA-BDLDIR > J-BDLDIR   HGO0021                     BDLDIR       747
  5293*         DISPLAY                                                                             BDLDIR       748
  5294*         V-STAFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) "|"      HGO0021                     BDLDIR       749
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  93
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5295*         V-NUMFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) "|"                                  BDLDIR       750
  5296*         V-CALFIN-PART1-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) "|"                            BDLDIR       751
  5297*         V-CALFIN-PART2-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) "|"                            BDLDIR       752
  5298*         V-CALFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)       "|"                            BDLDIR       753
  5299*         ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                                              BDLDIR       754
  5300*        END-PERFORM                                                                          BDLDIR       755
  5301                                                                                              BDLDIR       756
  5302        MOVE 1 TO J1-BDLDIR                                       HGO0021                     BDLDIR       757
  5303        PERFORM UNTIL J1-BDLDIR > J-BDLDIR                        HGO0021                     BDLDIR       758
  5304         MOVE 0 TO COMPO                                          AAM0017                     BDLDIR       759
  5305         INSPECT V-STAFIN-BDLDIR(J1-BDLDIR) TALLYING COMPO        HGO0021                     BDLDIR       760
  5306         FOR ALL SPACE BEFORE INITIAL "  "                        AAM0017                     BDLDIR       761
  5307         IF COMPO > 0 AND V-CALFIN-BDLDIR(J1-BDLDIR) > 0          HGO0021                     BDLDIR       762
  5308          MOVE 0 TO CONTA                                         AAM0017                     BDLDIR       763
  5309          INSPECT V-NUMDIRFIN-BDLDIR(J1-BDLDIR) TALLYING CONTA    HGO0021                     BDLDIR       764
  5310          FOR CHARACTERS BEFORE INITIAL "  "                      AAM0017                     BDLDIR       765
  5311          COMPUTE H-BDLDIR = J1-BDLDIR + 1                        HGO0021                     BDLDIR       766
  5312          PERFORM UNTIL H-BDLDIR > J-BDLDIR                       HGO0021                     BDLDIR       767
  5313*           IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) = SPACES                                         BDLDIR       768
  5314*            MOVE ZEROS TO V-NUMDIRFIN-BDLDIR(J1-BDLDIR)                                      BDLDIR       769
  5315*           END-IF                                                                            BDLDIR       770
  5316           IF V-NUMDIRFIN-BDLDIR(H-BDLDIR) = SPACES               PJV0024                     BDLDIR       771
  5317            MOVE ZEROS TO V-NUMDIRFIN-BDLDIR(H-BDLDIR)            PJV0024                     BDLDIR       772
  5318           END-IF                                                 PJV0024                     BDLDIR       773
  5319           IF V-NUMDIRFIN-BDLDIR(H-BDLDIR) = SPACES                                           BDLDIR       774
  5320            MOVE ZEROS TO V-NUMDIRFIN-BDLDIR(H-BDLDIR)                                        BDLDIR       775
  5321           END-IF                                                                             BDLDIR       776
  5322           MOVE 0 TO CONTA1                                       AAM0017                     BDLDIR       777
  5323           INSPECT V-NUMDIRFIN-BDLDIR(H-BDLDIR) TALLYING CONTA1   AAM0017                     BDLDIR       778
  5324           FOR CHARACTERS BEFORE INITIAL "   "                    AAM0017                     BDLDIR       779
  5325            IF (V-PRIPARTFIN-BDLDIR(J1-BDLDIR) =                  HGO0021                     BDLDIR       780
  5326              V-PRIPARTFIN-BDLDIR(H-BDLDIR) OR                    HGO0021                     BDLDIR       781
  5327              V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                    HGO0021                     BDLDIR       782
  5328              V-SEGPARTFIN-BDLDIR(H-BDLDIR) OR                    HGO0021                     BDLDIR       783
  5329              V-PRIPARTFIN-BDLDIR(J1-BDLDIR) =                    HGO0021                     BDLDIR       784
  5330              V-SEGPARTFIN-BDLDIR(H-BDLDIR) OR                    HGO0021                     BDLDIR       785
  5331              V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                    HGO0021                     BDLDIR       786
  5332              V-PRIPARTFIN-BDLDIR(H-BDLDIR))                      HGO0021                     BDLDIR       787
  5333             PERFORM 2017-UNIMAYOR                                AAM0017                     BDLDIR       788
  5334            ELSE                                                  AAM0017                     BDLDIR       789
  5335               IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =             HGO0021                     BDLDIR       790
  5336               V-NUMDIRFINAUX-BDLDIR                              HGO0021                     BDLDIR       791
  5337                  MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO          HGO0021                     BDLDIR       792
  5338                   T-DIRFINALESAUX-BDLDIR                         AAM0017                     BDLDIR       793
  5339               END-IF                                             HGO0021                     BDLDIR       794
  5340            END-IF                                                AAM0017                     BDLDIR       795
  5341           ADD 1 TO H-BDLDIR                                      HGO0021                     BDLDIR       796
  5342          END-PERFORM                                             AAM0017                     BDLDIR       797
  5343          IF H-BDLDIR > J-BDLDIR                                  HGO0021                     BDLDIR       798
  5344            IF ((V-CALFIN-PART1-BDLDIR(J1-BDLDIR) > 6 AND         HGO0021                     BDLDIR       799
  5345            V-STAFIN-BDLDIR(J1-BDLDIR) NOT =                      HGO0021                     BDLDIR       800
  5346            V-STAFINAUX-BDLDIR) OR                                HGO0021                     BDLDIR       801
  5347            (V-CALFIN-PART1-BDLDIR(J1-BDLDIR) > 6 AND             HGO0021                     BDLDIR       802
  5348            V-NUMDIRFIN-BDLDIR(J1-BDLDIR) = SPACES)) AND          HGO0021                     BDLDIR       803
  5349            V-DIRFIN-BDLDIR(J1-BDLDIR) NOT =                      HGO0021                     BDLDIR       804
  5350            V-DIRFINAUX-BDLDIR                                    HGO0021                     BDLDIR       805
  5351               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             HGO0021                     BDLDIR       806
  5352               T-DIRFINALESAUX-BDLDIR                             AAM0017                     BDLDIR       807
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  94
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5353            END-IF                                                HGO0021                     BDLDIR       808
  5354          END-IF                                                  HGO0021                     BDLDIR       809
  5355         END-IF                                                   AAM0017                     BDLDIR       810
  5356         MOVE 0 TO CONTA1                                         HGO0021                     BDLDIR       811
  5357         INSPECT V-PRIPARTFIN-BDLDIR(J1-BDLDIR) TALLYING CONTA1   HGO0021                     BDLDIR       812
  5358         FOR CHARACTERS BEFORE INITIAL "   "                      HGO0021                     BDLDIR       813
  5359         IF V-CALFIN-PART1-BDLDIR(J1-BDLDIR) > 6 AND              HGO0021                     BDLDIR       814
  5360            V-CALFIN-BDLDIR(J1-BDLDIR) > 0 AND CONTA1 > 1         HGO0021                     BDLDIR       815
  5361            MOVE T-DIRFINALESAUX-BDLDIR TO                        HGO0021                     BDLDIR       816
  5362            T-DIRFINALESFIN-BDLDIR(G-BDLDIR )                     HGO0021                     BDLDIR       817
  5363            ADD 1 TO G-BDLDIR                                     HGO0021                     BDLDIR       818
  5364         END-IF                                                   HGO0021                     BDLDIR       819
  5365         ADD 1 TO J1-BDLDIR                                       HGO0021                     BDLDIR       820
  5366        END-PERFORM                                               AAM0017                     BDLDIR       821
  5367        PERFORM PASAR-A-TABLA-FINAL                               PJV0024                     BDLDIR       822
  5368     END-IF.                                                                                  BDLDIR       823
  5369*                                                                                             BDLDIR       824
  5370 PASAR-A-TABLA-FINAL.                                                                         BDLDIR       825
  5371     INITIALIZE T-DIRFINALESAUX-BDLDIR                                                        BDLDIR       826
  5372     MOVE 1 TO CON-PART-ESTANDARIZADA-BDLDIR                                                  BDLDIR       827
  5373     PERFORM UNTIL CON-PART-ESTANDARIZADA-BDLDIR > J-BDLDIR       PJV0024                     BDLDIR       828
  5374        IF V-STAFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) =       PJV00                    BDLDIR       829
  5375              V-STAFINAUX-BDLDIR                                                              BDLDIR       830
  5376            MOVE V-STAFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)PJV0024                     BDLDIR       831
  5377              TO V-STAFINAUX-BDLDIR                                                           BDLDIR       832
  5378           INITIALIZE                                                                         BDLDIR       833
  5379             T-DIRFINALESFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR)PJV0024                     BDLDIR       834
  5380        ELSE                                                                                  BDLDIR       835
  5381           MOVE V-STAFINFIN-BDLDIR(CON-PART-ESTANDARIZADA-BDLDIR) PJV0024                     BDLDIR       836
  5382             TO V-STAFINAUX-BDLDIR                                                            BDLDIR       837
  5383        END-IF                                                                                BDLDIR       838
  5384        ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                                                BDLDIR       839
  5385     END-PERFORM                                                                              BDLDIR       840
  5386     MOVE TABLA-DIRFINALESFIN-BDLDIR TO TABLA-DIRFINALES-BDLDIR   PJV0024                     BDLDIR       841
  5387     SORT T-DIRFINALES-BDLDIR DESCENDING V-CALFIN-BDLDIR          PJV0024                     BDLDIR       842
  5388                              DESCENDING V-FECFIN-BDLDIR          PJV0024                     BDLDIR       843
  5389                              DESCENDING V-NUMFIN-BDLDIR.         PJV0024                     BDLDIR       844
  5390*                                                                                             BDLDIR       845
  5391 2017-UNINN.                                                      AAM0017                     BDLDIR       846
  5392******************************************************************                            BDLDIR       847
  5393*2017-UNINN.                                                     *                            BDLDIR       848
  5394*    SE CALCULA UNIFICACION DE DIRECCIONES NUEVA NOMENCALTURA    *                            BDLDIR       849
  5395******************************************************************                            BDLDIR       850
  5396     IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT = V-NUMDIRFINAUX-BDLDIR HGO0021                     BDLDIR       851
  5397      MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO                      HGO0021                     BDLDIR       852
  5398      T-DIRFINALESAUX-BDLDIR                                      HGO0021                     BDLDIR       853
  5399       COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +          AAM0017                     BDLDIR       854
  5400               V-NUMFIN-BDLDIR(H-BDLDIR)                          AAM0017                     BDLDIR       855
  5401       IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR          AAM0017                     BDLDIR       856
  5402        MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO V-CALFINAUX-BDLDIR      AAM0017                     BDLDIR       857
  5403       END-IF                                                     AAM0017                     BDLDIR       858
  5404       IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR          AAM0017                     BDLDIR       859
  5405        MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO V-FECFINAUX-BDLDIR      AAM0017                     BDLDIR       860
  5406       END-IF                                                     AAM0017                     BDLDIR       861
  5407       IF V-FECULTFIN-BDLDIR(H-BDLDIR) >                          RGH0022                     BDLDIR       862
  5408          V-FECULTFINAUX-BDLDIR                                   RGH0022                     BDLDIR       863
  5409          MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO                    RGH0022                     BDLDIR       864
  5410               V-FECULTFINAUX-BDLDIR                              RGH0022                     BDLDIR       865
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  95
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5411       END-IF                                                     RGH0022                     BDLDIR       866
  5412      ELSE                                                        AAM0017                     BDLDIR       867
  5413       COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +          AAM0017                     BDLDIR       868
  5414               V-NUMFIN-BDLDIR(H-BDLDIR)                          AAM0017                     BDLDIR       869
  5415       IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR          AAM0017                     BDLDIR       870
  5416        MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO V-CALFINAUX-BDLDIR      AAM0017                     BDLDIR       871
  5417       END-IF                                                     AAM0017                     BDLDIR       872
  5418       IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR          AAM0017                     BDLDIR       873
  5419        MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO V-FECFINAUX-BDLDIR      AAM0017                     BDLDIR       874
  5420       END-IF                                                     AAM0017                     BDLDIR       875
  5421       IF V-FECULTFIN-BDLDIR(H-BDLDIR) >                          RGH0022                     BDLDIR       876
  5422          V-FECULTFINAUX-BDLDIR                                   RGH0022                     BDLDIR       877
  5423          MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO                    RGH0022                     BDLDIR       878
  5424               V-FECULTFINAUX-BDLDIR                              RGH0022                     BDLDIR       879
  5425       END-IF                                                     RGH0022                     BDLDIR       880
  5426      END-IF                                                      AAM0017                     BDLDIR       881
  5427     INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)                     HGO0021                     BDLDIR       882
  5428     ADD 1 TO J2-BDLDIR.                                          HGO0021                     BDLDIR       883
  5429                                                                                              BDLDIR       884
  5430 2017-UNIMAYOR.                                                   AAM0017                     BDLDIR       885
  5431******************************************************************                            BDLDIR       886
  5432*2017-UNIMAYOR.                                                  *                            BDLDIR       887
  5433*    SE CALCULA UNIFICACION DE DIRECCIONES MAS COMPLETAS         *                            BDLDIR       888
  5434******************************************************************                            BDLDIR       889
  5435     IF V-PRIPARTFIN-BDLDIR(J1-BDLDIR) =                          HGO0021                     BDLDIR       890
  5436     V-PRIPARTFIN-BDLDIR(H-BDLDIR) AND                            HGO0021                     BDLDIR       891
  5437     V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                             HGO0021                     BDLDIR       892
  5438     V-SEGPARTFIN-BDLDIR(H-BDLDIR)                                HGO0021                     BDLDIR       893
  5439      IF CONTA1 = 0                                               HGO0021                     BDLDIR       894
  5440         MOVE 1 TO CONTA1                                         HGO0021                     BDLDIR       895
  5441      END-IF                                                      HGO0021                     BDLDIR       896
  5442      IF (V-NUMDIRFIN-BDLDIR(J1-BDLDIR)(1:CONTA1) =               HGO0021                     BDLDIR       897
  5443      V-NUMDIRFIN-BDLDIR(H-BDLDIR)(1:CONTA1))                     HGO0021                     BDLDIR       898
  5444         IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =                   HGO0021                     BDLDIR       899
  5445         V-NUMDIRFINAUX-BDLDIR OR V-DIRFIN-BDLDIR(J1-BDLDIR)      HGO0021                     BDLDIR       900
  5446         NOT =  V-DIRFINAUX-BDLDIR                                HGO0021                     BDLDIR       901
  5447            MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO                HGO0021                     BDLDIR       902
  5448            T-DIRFINALESAUX-BDLDIR                                HGO0021                     BDLDIR       903
  5449            COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +     HGO0021                     BDLDIR       904
  5450            V-NUMFIN-BDLDIR(H-BDLDIR)                             HGO0021                     BDLDIR       905
  5451            IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR     HGO0021                     BDLDIR       906
  5452             MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO V-CALFINAUX-BDLDIR HGO0021                     BDLDIR       907
  5453            END-IF                                                HGO0021                     BDLDIR       908
  5454            IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR     HGO0021                     BDLDIR       909
  5455             MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO V-FECFINAUX-BDLDIR HGO0021                     BDLDIR       910
  5456            END-IF                                                HGO0021                     BDLDIR       911
  5457            IF V-FECULTFIN-BDLDIR(H-BDLDIR) >                     RGH0022                     BDLDIR       912
  5458               V-FECULTFINAUX-BDLDIR                              RGH0022                     BDLDIR       913
  5459               MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO               RGH0022                     BDLDIR       914
  5460                    V-FECULTFINAUX-BDLDIR                         RGH0022                     BDLDIR       915
  5461            END-IF                                                RGH0022                     BDLDIR       916
  5462            INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)              HGO0021                     BDLDIR       917
  5463         ELSE                                                     HGO0021                     BDLDIR       918
  5464            COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +     HGO0021                     BDLDIR       919
  5465            V-NUMFIN-BDLDIR(H-BDLDIR)                             HGO0021                     BDLDIR       920
  5466            IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR     HGO0021                     BDLDIR       921
  5467             MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO V-CALFINAUX-BDLDIR HGO0021                     BDLDIR       922
  5468            END-IF                                                HGO0021                     BDLDIR       923
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  96
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5469            IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR     HGO0021                     BDLDIR       924
  5470             MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO V-FECFINAUX-BDLDIR HGO0021                     BDLDIR       925
  5471            END-IF                                                HGO0021                     BDLDIR       926
  5472            IF V-FECULTFIN-BDLDIR(H-BDLDIR) >                     RGH0022                     BDLDIR       927
  5473               V-FECULTFINAUX-BDLDIR                              RGH0022                     BDLDIR       928
  5474               MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO               RGH0022                     BDLDIR       929
  5475                    V-FECULTFINAUX-BDLDIR                         RGH0022                     BDLDIR       930
  5476            END-IF                                                RGH0022                     BDLDIR       931
  5477            INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)              HGO0021                     BDLDIR       932
  5478         END-IF                                                   HGO0021                     BDLDIR       933
  5479      ELSE                                                        HGO0021                     BDLDIR       934
  5480         IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =                   HGO0021                     BDLDIR       935
  5481         V-NUMDIRFINAUX-BDLDIR                                    HGO0021                     BDLDIR       936
  5482            MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO                HGO0021                     BDLDIR       937
  5483            T-DIRFINALESAUX-BDLDIR                                HGO0021                     BDLDIR       938
  5484         END-IF                                                   HGO0021                     BDLDIR       939
  5485      END-IF                                                      HGO0021                     BDLDIR       940
  5486     ELSE                                                         HGO0021                     BDLDIR       941
  5487      IF V-SEGPARTFIN-BDLDIR(J1-BDLDIR) =                         HGO0021                     BDLDIR       942
  5488      V-PRIPARTFIN-BDLDIR(H-BDLDIR)                               HGO0021                     BDLDIR       943
  5489         IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR)(1:CONTA1) =             HGO0021                     BDLDIR       944
  5490         V-NUMDIRFIN-BDLDIR(H-BDLDIR)(1:CONTA1)                   HGO0021                     BDLDIR       945
  5491            IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =                HGO0021                     BDLDIR       946
  5492            V-NUMDIRFINAUX-BDLDIR                                 HGO0021                     BDLDIR       947
  5493               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             HGO0021                     BDLDIR       948
  5494               T-DIRFINALESAUX-BDLDIR                             HGO0021                     BDLDIR       949
  5495               COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +  HGO0021                     BDLDIR       950
  5496               V-NUMFIN-BDLDIR(H-BDLDIR)                          HGO0021                     BDLDIR       951
  5497               IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR  HGO0021                     BDLDIR       952
  5498                  MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO               HGO0021                     BDLDIR       953
  5499                  V-CALFINAUX-BDLDIR                              HGO0021                     BDLDIR       954
  5500               END-IF                                             HGO0021                     BDLDIR       955
  5501               IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR  HGO0021                     BDLDIR       956
  5502                  MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO               HGO0021                     BDLDIR       957
  5503                  V-FECFINAUX-BDLDIR                              HGO0021                     BDLDIR       958
  5504               END-IF                                             HGO0021                     BDLDIR       959
  5505               IF V-FECULTFIN-BDLDIR(H-BDLDIR) >                  RGH0022                     BDLDIR       960
  5506                  V-FECULTFINAUX-BDLDIR                           RGH0022                     BDLDIR       961
  5507                  MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO            RGH0022                     BDLDIR       962
  5508                       V-FECULTFINAUX-BDLDIR                      RGH0022                     BDLDIR       963
  5509               END-IF                                             RGH0022                     BDLDIR       964
  5510               INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)           HGO0021                     BDLDIR       965
  5511            ELSE                                                  HGO0021                     BDLDIR       966
  5512               COMPUTE V-NUMFINAUX-BDLDIR = V-NUMFINAUX-BDLDIR +  HGO0021                     BDLDIR       967
  5513               V-NUMFIN-BDLDIR(H-BDLDIR)                          HGO0021                     BDLDIR       968
  5514               IF V-CALFIN-BDLDIR(H-BDLDIR) > V-CALFINAUX-BDLDIR  HGO0021                     BDLDIR       969
  5515                  MOVE V-CALFIN-BDLDIR(H-BDLDIR) TO               HGO0021                     BDLDIR       970
  5516                  V-CALFINAUX-BDLDIR                              HGO0021                     BDLDIR       971
  5517               END-IF                                             HGO0021                     BDLDIR       972
  5518               IF V-FECFIN-BDLDIR(H-BDLDIR) > V-FECFINAUX-BDLDIR  HGO0021                     BDLDIR       973
  5519                  MOVE V-FECFIN-BDLDIR(H-BDLDIR) TO               HGO0021                     BDLDIR       974
  5520                  V-FECFINAUX-BDLDIR                              HGO0021                     BDLDIR       975
  5521               END-IF                                             HGO0021                     BDLDIR       976
  5522               IF V-FECULTFIN-BDLDIR(H-BDLDIR) >                  RGH0022                     BDLDIR       977
  5523                  V-FECULTFINAUX-BDLDIR                           RGH0022                     BDLDIR       978
  5524                  MOVE V-FECULTFIN-BDLDIR(H-BDLDIR) TO            RGH0022                     BDLDIR       979
  5525                       V-FECULTFINAUX-BDLDIR                      RGH0022                     BDLDIR       980
  5526               END-IF                                             RGH0022                     BDLDIR       981
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  97
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5527               INITIALIZE T-DIRFINALES-BDLDIR(H-BDLDIR)           HGO0021                     BDLDIR       982
  5528            END-IF                                                HGO0021                     BDLDIR       983
  5529         ELSE                                                     HGO0021                     BDLDIR       984
  5530            IF V-NUMDIRFIN-BDLDIR(J1-BDLDIR) NOT =                HGO0021                     BDLDIR       985
  5531            V-NUMDIRFINAUX-BDLDIR                                 HGO0021                     BDLDIR       986
  5532               MOVE T-DIRFINALES-BDLDIR(J1-BDLDIR) TO             HGO0021                     BDLDIR       987
  5533               T-DIRFINALESAUX-BDLDIR                             HGO0021                     BDLDIR       988
  5534            END-IF                                                HGO0021                     BDLDIR       989
  5535         END-IF                                                   HGO0021                     BDLDIR       990
  5536       END-IF                                                     HGO0021                     BDLDIR       991
  5537     END-IF.                                                      HGO0021                     BDLDIR       992
  5538                                                                                              BDLDIR       993
  5539*UNIDIR     IF V-NUMDIRFIN-BDLDIR(H-BDLDIR) NOT = V-NUMDIRFINAUX-BHGO0021                     BDLDIR       994
  5540*UNIDIR      MOVE T-DIRFINALES-BDLDIR(H-BDLDIR) TO                HGO0021                     BDLDIR       995
  5541*UNIDIR           T-DIRFINALESAUX-BDLDIR                          HGO0021                     BDLDIR       996
  5542*UNIDIR      MOVE V-NUMFIN-BDLDIR(J-BDLDIR) TO V-NUMFINAUX-BDLDIR HGO0021                     BDLDIR       997
  5543*UNIDIR      IF V-CALFIN-BDLDIR(J-BDLDIR) > V-CALFINAUX-BDLDIR    HGO0021                     BDLDIR       998
  5544*UNIDIR       MOVE V-CALFIN-BDLDIR(J-BDLDIR) TO V-CALFINAUX-BDLDIRHGO0021                     BDLDIR       999
  5545*UNIDIR      END-IF                                               HGO0021                     BDLDIR      1000
  5546*UNIDIR      IF V-FECFIN-BDLDIR(J-BDLDIR) > V-FECFINAUX-BDLDIR    HGO0021                     BDLDIR      1001
  5547*UNIDIR       MOVE V-FECFIN-BDLDIR(J-BDLDIR) TO V-FECFINAUX-BDLDIRHGO0021                     BDLDIR      1002
  5548*UNIDIR      END-IF                                               HGO0021                     BDLDIR      1003
  5549*UNIDIR     ELSE                                                  HGO0021                     BDLDIR      1004
  5550*UNIDIR      MOVE V-NUMFIN-BDLDIR(J-BDLDIR) TO V-NUMFINAUX-BDLDIR HGO0021                     BDLDIR      1005
  5551*UNIDIR      IF V-CALFIN-BDLDIR(J-BDLDIR) > V-CALFINAUX-BDLDIR    HGO0021                     BDLDIR      1006
  5552*UNIDIR       MOVE V-CALFIN-BDLDIR(J-BDLDIR) TO V-CALFINAUX-BDLDIRHGO0021                     BDLDIR      1007
  5553*UNIDIR      END-IF                                               HGO0021                     BDLDIR      1008
  5554*UNIDIR      IF V-FECFIN-BDLDIR(J-BDLDIR) > V-FECFINAUX-BDLDIR    HGO0021                     BDLDIR      1009
  5555*UNIDIR       MOVE V-FECFIN-BDLDIR(J-BDLDIR) TO V-FECFINAUX-BDLDIRHGO0021                     BDLDIR      1010
  5556*UNIDIR      END-IF                                               HGO0021                     BDLDIR      1011
  5557*UNIDIR     END-IF                                                HGO0021                     BDLDIR      1012
  5558*UNIDIR     MOVE 1 TO RMAYOR.                                     HGO0021                     BDLDIR      1013
  5559 2017-VECTOR-UNO.                                                 AAM0017                     BDLDIR      1014
  5560******************************************************************                            BDLDIR      1015
  5561*2017-VECTOR-UNO.                                                *                            BDLDIR      1016
  5562*    SE CALCULA EL VECTOR DE COMPONENTES DE DIRECCION 1          *                            BDLDIR      1017
  5563******************************************************************                            BDLDIR      1018
  5564     MOVE 1 TO E-BDLDIR                                           AAM0017                     BDLDIR      1019
  5565     MOVE 1 TO F-BDLDIR                                           AAM0017                     BDLDIR      1020
  5566     MOVE SPACES TO DIRECCION1                                    AAM0017                     BDLDIR      1021
  5567     PERFORM UNTIL E-BDLDIR > 60                                  AAM0017                     BDLDIR      1022
  5568      IF DIRECCION(E-BDLDIR:1) IS NUMERIC                         AAM0017                     BDLDIR      1023
  5569         OR DIRECCION(E-BDLDIR:1) = SPACES                        AAM0017                     BDLDIR      1024
  5570       IF F-BDLDIR > 1                                            AAM0017                     BDLDIR      1025
  5571        IF DIRECCION(E-BDLDIR:1) NOT = SPACES                     AAM0017                     BDLDIR      1026
  5572         MOVE DIRECCION(E-BDLDIR:1) TO DIRECCION1(F-BDLDIR:1)     AAM0017                     BDLDIR      1027
  5573         ADD 1 TO F-BDLDIR                                        AAM0017                     BDLDIR      1028
  5574        END-IF                                                    AAM0017                     BDLDIR      1029
  5575        IF DIRECCION(E-BDLDIR:1) = SPACES                         AAM0017                     BDLDIR      1030
  5576           AND DIRECCION1(F-BDLDIR - 1:1) NOT = SPACES            AAM0017                     BDLDIR      1031
  5577         MOVE DIRECCION(E-BDLDIR:1) TO DIRECCION1(F-BDLDIR:1)     AAM0017                     BDLDIR      1032
  5578         ADD 1 TO F-BDLDIR                                        AAM0017                     BDLDIR      1033
  5579        END-IF                                                    AAM0017                     BDLDIR      1034
  5580       END-IF                                                     AAM0017                     BDLDIR      1035
  5581       IF F-BDLDIR = 1 AND DIRECCION(E-BDLDIR:1) NOT = SPACES     AAM0017                     BDLDIR      1036
  5582        MOVE DIRECCION(E-BDLDIR:1) TO DIRECCION1(F-BDLDIR:1)      AAM0017                     BDLDIR      1037
  5583        ADD 1 TO F-BDLDIR                                         AAM0017                     BDLDIR      1038
  5584       END-IF                                                     AAM0017                     BDLDIR      1039
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  98
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5585      END-IF                                                      AAM0017                     BDLDIR      1040
  5586      ADD 1 TO E-BDLDIR                                           AAM0017                     BDLDIR      1041
  5587     END-PERFORM.                                                 AAM0017                     BDLDIR      1042
  5588 2017-CALCULAR-VECTOR-RES.                                                                    BDLDIR      1043
  5589******************************************************************                            BDLDIR      1044
  5590*2018-CALCULAR-VECTOR-RES-DI4.                                   *                            BDLDIR      1045
  5591*    SE CALCULA EL VECTOR DE CAMBIOS DE DIRECCION                *                            BDLDIR      1046
  5592******************************************************************                            BDLDIR      1047
  5593     SORT O-FECHADIR-AUX-BDLDIR DESCENDING V-FECHADIR-AUX-BDLDIR. RMB0010                     BDLDIR      1048
  5594     MOVE V-FECHADIR-AUX-BDLDIR(1) TO FECHA-RUTINA-BDLDIR.        RMB0010                     BDLDIR      1049
  5595     MOVE 1 TO  JJ-BDLDIR.                                        RMB0010                     BDLDIR      1050
  5596     MOVE 2 TO  II-BDLDIR.                                        RMB0010                     BDLDIR      1051
  5597     MOVE SPACES TO VEC-HIS-BDLDIR.                               RMB0010                     BDLDIR      1052
  5598     PERFORM 2017-UN-MES-ATRAS                                                                BDLDIR      1053
  5599     PERFORM UNTIL II-BDLDIR >= K-BDLDIR OR                       RMB0010                     BDLDIR      1054
  5600                   JJ-BDLDIR > 12                                 RMB0010                     BDLDIR      1055
  5601        IF FECHA-RUTINA-BDLDIR =                                  RMB0010                     BDLDIR      1056
  5602           V-FECHADIR-AUX-BDLDIR(II-BDLDIR)                       RMB0010                     BDLDIR      1057
  5603           MOVE "R" TO VEC-HIS-BDLDIR(JJ-BDLDIR:1)                RMB0010                     BDLDIR      1058
  5604           ADD 1 TO JJ-BDLDIR                                     RMB0010                     BDLDIR      1059
  5605           PERFORM 2017-UN-MES-ATRAS                                                          BDLDIR      1060
  5606           ADD 1 TO II-BDLDIR                                     RMB0010                     BDLDIR      1061
  5607         ELSE                                                                                 BDLDIR      1062
  5608           IF FECHA-RUTINA-BDLDIR >                               RMB0010                     BDLDIR      1063
  5609              V-FECHADIR-AUX-BDLDIR(II-BDLDIR)                    RMB0010                     BDLDIR      1064
  5610              MOVE "I" TO VEC-HIS-BDLDIR(JJ-BDLDIR:1)             RMB0010                     BDLDIR      1065
  5611              ADD 1 TO JJ-BDLDIR                                  RMB0010                     BDLDIR      1066
  5612              PERFORM 2017-UN-MES-ATRAS                                                       BDLDIR      1067
  5613           ELSE                                                                               BDLDIR      1068
  5614              ADD 1 TO II-BDLDIR                                  RMB0010                     BDLDIR      1069
  5615           END-IF                                                                             BDLDIR      1070
  5616        END-IF                                                                                BDLDIR      1071
  5617     END-PERFORM.                                                                             BDLDIR      1072
  5618     MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR.                   RMB0010                     BDLDIR      1073
  5619     MOVE 1 TO K-BDLDIR.                                          RMB0010                     BDLDIR      1074
  5620 2017-UN-MES-ATRAS.                                                                           BDLDIR      1075
  5621******************************************************************                            BDLDIR      1076
  5622*2017-UN-MES-ATRAS.                                              *                            BDLDIR      1077
  5623*    SE CALCULA EL MES ANTERIOR DE LA FECHA DADA PARA HACER LA   *                            BDLDIR      1078
  5624*    LINEA DE BALANCE Y UBICAR EL VECTOR DE CAMBIOS DE DIRECCION *                            BDLDIR      1079
  5625******************************************************************                            BDLDIR      1080
  5626     SUBTRACT 1 FROM MES-RUTINA-BDLDIR.                           RMB0010                     BDLDIR      1081
  5627     IF MES-RUTINA-BDLDIR = 0                                     RMB0010                     BDLDIR      1082
  5628        SUBTRACT 1 FROM ANO-RUTINA-BDLDIR                         RMB0010                     BDLDIR      1083
  5629        MOVE 12 TO MES-RUTINA-BDLDIR                              RMB0010                     BDLDIR      1084
  5630     END-IF.                                                                                  BDLDIR      1085
  5631*-----------------MEJORES TELEFONOS     ---------------------------                           BDLDIR      1086
  5632 2017-U-ELEGIR-TELEFONOS.                                                                     BDLDIR      1087
  5633*******************************************************************                           BDLDIR      1088
  5634* SE UNIFICAN LAS TELEFONOS   Y SE ORDENAN POR EL CRITERIO DE LA                              BDLDIR      1089
  5635* MEJOR FECHA Y EL NUMERO DE OCURRENCIAS.                                                     BDLDIR      1090
  5636* LA RUTINA DEVUELVE UN ARREGLO CON ESTOS TELEFONOS   ORDENADOS                               BDLDIR      1091
  5637*         05 V-TELFIN       PIC X(12) TELEFONO                    FAC0009                     BDLDIR      1092
  5638*         05 V-CIUTELFIN    PIC X(20) CIUDAD                      FAC0009                     BDLDIR      1093
  5639*         05 V-TIPTELFIN    PIC X(01) UBICACION                                               BDLDIR      1094
  5640*         05 V-FECTELFIN    PIC 9(6)  FECHA MEJOR.                                            BDLDIR      1095
  5641*         05 V-NUMTELFIN    PIC 9(3)  NUMERO DE COINCIDENCIAS.                                BDLDIR      1096
  5642*         05 V-SUSTELFIN    PIC 9(6)  CODIGO DE SUSCRIPTOR.                                   BDLDIR      1097
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page  99
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5643*******************************************************************                           BDLDIR      1098
  5644     MOVE 0 TO J-BDLDIR.                                          RMB0010                     BDLDIR      1099
  5645     IF TEL-OK-BDLDIR > 1                                         RMB0010                     BDLDIR      1100
  5646        SORT T-TEL-BDLDIR                                         RMB0010                     BDLDIR      1101
  5647             DESCENDING V-TELEFONO-BDLDIR V-TIPOTEL-BDLDIR        RMB0010                     BDLDIR      1102
  5648        MOVE ALL "9" TO NUMTEL-BDLDIR                             RMB0010                     BDLDIR      1103
  5649        MOVE 1 TO I-BDLDIR                                        RMB0010                     BDLDIR      1104
  5650        MOVE ALL "0" TO TABLA-FECHADIR-AUX-BDLDIR                 RMB0010                     BDLDIR      1105
  5651        MOVE 1 TO K-BDLDIR                                        RMB0010                     BDLDIR      1106
  5652        PERFORM UNTIL I-BDLDIR >= TEL-OK-BDLDIR                   RMB0010                     BDLDIR      1107
  5653          IF NUMTEL-BDLDIR NOT = V-TELEFONO-BDLDIR (I-BDLDIR)     RMB0010                     BDLDIR      1108
  5654             IF I-BDLDIR > 1                                      RMB0010                     BDLDIR      1109
  5655                PERFORM 2017-CALCULAR-VECTOR-RES                                              BDLDIR      1110
  5656                MOVE VEC-HIS-BDLDIR                               RMB0010                     BDLDIR      1111
  5657                     TO V-VECTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1112
  5658             END-IF                                                                           BDLDIR      1113
  5659             MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR      1114
  5660                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010                     BDLDIR      1115
  5661             ADD 1 TO K-BDLDIR                                    RMB0010                     BDLDIR      1116
  5662             ADD 1 TO J-BDLDIR                                    RMB0010                     BDLDIR      1117
  5663             MOVE V-TELEFONO-BDLDIR (I-BDLDIR)                    RMB0010                     BDLDIR      1118
  5664                  TO V-TELFIN-BDLDIR(J-BDLDIR)                    RMB0010                     BDLDIR      1119
  5665             MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR      1120
  5666                  TO V-FECTELFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR      1121
  5667             MOVE V-CIUDADTEL-BDLDIR(I-BDLDIR)                    RMB0010                     BDLDIR      1122
  5668                  TO V-CIUTELFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR      1123
  5669             MOVE V-TIPOTEL-BDLDIR(I-BDLDIR)                      RMB0010                     BDLDIR      1124
  5670                  TO V-TIPTELFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR      1125
  5671             MOVE V-SUSTEL-BDLDIR (I-BDLDIR)                      RMB0010                     BDLDIR      1126
  5672                  TO V-SUSTELFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR      1127
  5673             MOVE V-HASTEL-BDLDIR (I-BDLDIR)                      RMB0010                     BDLDIR      1128
  5674                  TO V-HASTELFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR      1129
  5675             MOVE 1  TO V-NUMTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1130
  5676             MOVE V-TELEFONO-BDLDIR(I-BDLDIR)  TO NUMTEL-BDLDIR   RMB0010                     BDLDIR      1131
  5677             MOVE V-FECULTTEL-BDLDIR(I-BDLDIR)                    AAM0017                     BDLDIR      1132
  5678                  TO V-FECULTTELFIN-BDLDIR(J-BDLDIR)              AAM0017                     BDLDIR      1133
  5679          ELSE                                                                                BDLDIR      1134
  5680             MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                     RMB0010                     BDLDIR      1135
  5681                  TO V-FECHADIR-AUX-BDLDIR(K-BDLDIR)              RMB0010                     BDLDIR      1136
  5682             ADD 1 TO K-BDLDIR                                    RMB0010                     BDLDIR      1137
  5683             ADD 1 TO V-NUMTELFIN-BDLDIR(J-BDLDIR)                RMB0010                     BDLDIR      1138
  5684             IF V-FECHATEL-BDLDIR(I-BDLDIR) >                     RMB0010                     BDLDIR      1139
  5685                V-FECTELFIN-BDLDIR(J-BDLDIR)                      RMB0010                     BDLDIR      1140
  5686                MOVE V-FECHATEL-BDLDIR(I-BDLDIR)                  RMB0010                     BDLDIR      1141
  5687                     TO V-FECTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1142
  5688                MOVE V-TELEFONO-BDLDIR (I-BDLDIR)                 RMB0010                     BDLDIR      1143
  5689                     TO V-TELFIN-BDLDIR(J-BDLDIR)                 RMB0010                     BDLDIR      1144
  5690                MOVE V-CIUDADTEL-BDLDIR(I-BDLDIR)                 RMB0010                     BDLDIR      1145
  5691                     TO V-CIUTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1146
  5692                MOVE V-TIPOTEL-BDLDIR(I-BDLDIR)                   RMB0010                     BDLDIR      1147
  5693                     TO V-TIPTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1148
  5694                MOVE V-SUSTEL-BDLDIR (I-BDLDIR)                   RMB0010                     BDLDIR      1149
  5695                     TO V-SUSTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1150
  5696                MOVE V-HASTEL-BDLDIR (I-BDLDIR)                   RMB0010                     BDLDIR      1151
  5697                     TO V-HASTELFIN-BDLDIR(J-BDLDIR)              RMB0010                     BDLDIR      1152
  5698                MOVE V-FECULTTEL-BDLDIR(I-BDLDIR)                 AAM0017                     BDLDIR      1153
  5699                     TO V-FECULTTELFIN-BDLDIR(J-BDLDIR)           AAM0017                     BDLDIR      1154
  5700             END-IF                                                                           BDLDIR      1155
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 100
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5701          END-IF                                                                              BDLDIR      1156
  5702          ADD 1 TO I-BDLDIR                                       RMB0010                     BDLDIR      1157
  5703        END-PERFORM                                                                           BDLDIR      1158
  5704        IF I-BDLDIR > 1                                           RMB0010                     BDLDIR      1159
  5705           PERFORM 2017-CALCULAR-VECTOR-RES                                                   BDLDIR      1160
  5706           MOVE VEC-HIS-BDLDIR                                    RMB0010                     BDLDIR      1161
  5707                TO V-VECTELFIN-BDLDIR(J-BDLDIR)                   RMB0010                     BDLDIR      1162
  5708        END-IF                                                                                BDLDIR      1163
  5709     END-IF.                                                                                  BDLDIR      1164
  5710     IF J-BDLDIR > 0                                              RMB0010                     BDLDIR      1165
  5711        MOVE 1 TO I-BDLDIR                                        RMB0010                     BDLDIR      1166
  5712        PERFORM UNTIL I-BDLDIR > J-BDLDIR                         RMB0010                     BDLDIR      1167
  5713           MOVE V-TELFIN-BDLDIR(I-BDLDIR) TO TELEFONO-BDLDIR      RMB0010                     BDLDIR      1168
  5714           PERFORM 2017-U-CALIFICAR-TELEFONOS                     RMB0010                     BDLDIR      1169
  5715           MOVE CAL-TEL-BDLDIR TO V-CALTELFIN-BDLDIR(I-BDLDIR)    RMB0010                     BDLDIR      1170
  5716*-------- Se Excluyen Teléfonos según tabla de exclusión --------*AAM0017                     BDLDIR      1171
  5717           IF CAL-TEL-BDLDIR <> 0                                 AAM0017                     BDLDIR      1172
  5718              PERFORM 2018-EVALUA-EXCLUSION-TEL                   AAM0017                     BDLDIR      1173
  5719           END-IF                                                 AAM0017                     BDLDIR      1174
  5720***        SE ELIMINAN LOS TELEFONOS CALIFICADOS EN CERO          RMB0010                     BDLDIR      1175
  5721           IF CAL-TEL-BDLDIR = 0                                  RMB0010                     BDLDIR      1176
  5722              MOVE 0 TO V-FECTELFIN-BDLDIR(I-BDLDIR)              RMB0010                     BDLDIR      1177
  5723           END-IF                                                 RMB0010                     BDLDIR      1178
  5724           ADD  1 TO I-BDLDIR                                     RMB0010                     BDLDIR      1179
  5725        END-PERFORM                                               RMB0010                     BDLDIR      1180
  5726        PERFORM 2020-UNIFICA-TELEFONOS                            AAM0017                     BDLDIR      1181
  5727        SORT T-TELFINALES-BDLDIR DESCENDING V-CALTELFIN-BDLDIR    RMB0010                     BDLDIR      1182
  5728                                 DESCENDING V-FECTELFIN-BDLDIR    RMB0010                     BDLDIR      1183
  5729                                 DESCENDING V-NUMTELFIN-BDLDIR    RMB0010                     BDLDIR      1184
  5730        MOVE 1 TO I-BDLDIR                                        RMB0010                     BDLDIR      1185
  5731     END-IF.                                                      RMB0010                     BDLDIR      1186
  5732*    IF J-DIR > 0                                                 RMB0010                     BDLDIR      1187
  5733*       MOVE 1 TO I-DIR                                           RMB0010                     BDLDIR      1188
  5734*       PERFORM UNTIL I-DIR > J-DIR                               RMB0010                     BDLDIR      1189
  5735*          IF V-TELFIN(I-DIR) NUMERIC                             RMB0010                     BDLDIR      1190
  5736*             MOVE V-TELFIN(I-DIR) TO TELE-DIR                    RMB0010                     BDLDIR      1191
  5737*             DIVIDE TELE-DIR BY 1000000 GIVING COSI-DIR          RMB0010                     BDLDIR      1192
  5738*                             REMAINDER         RESI-DIR          RMB0010                     BDLDIR      1193
  5739*             IF COSI-DIR >= 1 AND RESI-DIR > 0                   RMB0010                     BDLDIR      1194
  5740*                ADD 10 TO V-CALTELFIN(I-DIR)                     RMB0010                     BDLDIR      1195
  5741*             ELSE                                                RMB0010                     BDLDIR      1196
  5742*                DIVIDE TELE-DIR BY 100000 GIVING COSI-DIR        RMB0010                     BDLDIR      1197
  5743*                                REMAINDER        RESI-DIR        RMB0010                     BDLDIR      1198
  5744*                IF COSI-DIR >= 1 AND RESI-DIR > 0                RMB0010                     BDLDIR      1199
  5745*                   ADD 5  TO V-CALTELFIN(I-DIR)                  RMB0010                     BDLDIR      1200
  5746*                END-IF                                           RMB0010                     BDLDIR      1201
  5747*             END-IF                                              RMB0010                     BDLDIR      1202
  5748*          END-IF                                                 RMB0010                     BDLDIR      1203
  5749*          ADD 1 TO I-DIR                                         RMB0010                     BDLDIR      1204
  5750*       END-PERFORM                                               RMB0010                     BDLDIR      1205
  5751*       SORT T-TELFINALES DESCENDING V-CALTELFIN                  RMB0010                     BDLDIR      1206
  5752*                         DESCENDING V-FECTELFIN                  RMB0010                     BDLDIR      1207
  5753*                         DESCENDING V-NUMTELFIN                  RMB0010                     BDLDIR      1208
  5754*    END-IF.                                                                                  BDLDIR      1209
  5755*----------------- CALIFICAR TELEFONOS  --------------------------RMB0010                     BDLDIR      1210
  5756 2017-U-CALIFICAR-TELEFONOS.                                      RMB0010                     BDLDIR      1211
  5757     MOVE 1 TO M-BDLDIR                                           RMB0010                     BDLDIR      1212
  5758     PERFORM UNTIL TELEFONO-BDLDIR(M-BDLDIR:1) NOT = "0"          RMB0010                     BDLDIR      1213
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 101
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5759       ADD 1 TO M-BDLDIR                                          RMB0010                     BDLDIR      1214
  5760       IF M-BDLDIR > 12                                           RMB0010                     BDLDIR      1215
  5761          NEXT SENTENCE                                           RMB0010                     BDLDIR      1216
  5762       END-IF                                                     RMB0010                     BDLDIR      1217
  5763     END-PERFORM                                                  RMB0010                     BDLDIR      1218
  5764     MOVE 0 TO CAL-TEL-BDLDIR                                     RMB0010                     BDLDIR      1219
  5765     IF TELEFONO-BDLDIR(6:1) = "0" OR                             PJV0025                     BDLDIR      1220
  5766        TELEFONO-BDLDIR(6:1) = "1" OR                             PJV0025                     BDLDIR      1221
  5767        TELEFONO-BDLDIR(6:1) = "9"                                PJV0025                     BDLDIR      1222
  5768        MOVE 1 TO M-BDLDIR                                        PJV0025                     BDLDIR      1223
  5769     END-IF                                                       PJV0025                     BDLDIR      1224
  5770     EVALUATE M-BDLDIR                                            RMB0010                     BDLDIR      1225
  5771       WHEN 6                                                     RMB0010                     BDLDIR      1226
  5772         MOVE 15 TO CAL-TEL-BDLDIR                                RMB0010                     BDLDIR      1227
  5773       WHEN 4                                                     RMB0010                     BDLDIR      1228
  5774         IF TELEFONO-BDLDIR(6:1) NOT = "0"                        RMB0010                     BDLDIR      1229
  5775            IF TELEFONO-BDLDIR(4:1) = "9" OR "7" OR "5"           RMB0010                     BDLDIR      1230
  5776               MOVE 15 TO CAL-TEL-BDLDIR                          RMB0010                     BDLDIR      1231
  5777            END-IF                                                RMB0010                     BDLDIR      1232
  5778         END-IF                                                   RMB0010                     BDLDIR      1233
  5779       WHEN 3                                                     RMB0010                     BDLDIR      1234
  5780          IF TELEFONO-BDLDIR(6:1) NOT = "0"                       RMB0010                     BDLDIR      1235
  5781             IF TELEFONO-BDLDIR(3:2) = "57" AND                   RMB0010                     BDLDIR      1236
  5782                (TELEFONO-BDLDIR(5:1) NOT = "3" OR "9")           RMB0010                     BDLDIR      1237
  5783                MOVE 15 TO CAL-TEL-BDLDIR                         RMB0010                     BDLDIR      1238
  5784             END-IF                                               RMB0010                     BDLDIR      1239
  5785             IF TELEFONO-BDLDIR(3:1) = "3"                        RMB0010                     BDLDIR      1240
  5786                MOVE 15 TO CAL-TEL-BDLDIR                         RMB0010                     BDLDIR      1241
  5787             END-IF                                               RMB0010                     BDLDIR      1242
  5788          END-IF                                                  RMB0010                     BDLDIR      1243
  5789     END-EVALUATE.                                                RMB0010                     BDLDIR      1244
  5790*----------------- EVALUA EXCLUSION DE TELEFONOS ----------------*AAM0017                     BDLDIR      1245
  5791 2018-EVALUA-EXCLUSION-TEL.                                       AAM0017                     BDLDIR      1246
  5792     MOVE 1 TO IQ                                                 AAM0017                     BDLDIR      1247
  5793*TELEXC     PERFORM UNTIL IQ > 12 OR CAL-TEL-BDLDIR = 0           HGO0020                     BDLDIR      1248
  5794     PERFORM UNTIL IQ > 24 OR CAL-TEL-BDLDIR = 0                  HGO0020                     BDLDIR      1249
  5795        PERFORM 2019-BUSCA-POSINI-LONG-TELEXCLU                   AAM0017                     BDLDIR      1250
  5796        IF POSI-EXCLU < 7                                         AAM0017                     BDLDIR      1251
  5797           IF T-TELS-EXCLU(IQ)(POSI-EXCLU:LONGCOMP-EXCLU)         AAM0017                     BDLDIR      1252
  5798              = TELEFONO-BDLDIR(POSI-EXCLU:LONGCOMP-EXCLU)        AAM0017                     BDLDIR      1253
  5799              MOVE 0 TO CAL-TEL-BDLDIR                            AAM0017                     BDLDIR      1254
  5800           END-IF                                                 AAM0017                     BDLDIR      1255
  5801        END-IF                                                    AAM0017                     BDLDIR      1256
  5802        ADD 1 TO IQ                                               AAM0017                     BDLDIR      1257
  5803     END-PERFORM.                                                 AAM0017                     BDLDIR      1258
  5804******************************************************************AAM0017                     BDLDIR      1259
  5805*2019-BUSCA-POSINI-LONG-TELEXCLU                                  AAM0017                     BDLDIR      1260
  5806*    BUSCA POSICION INICIAL Y LONGITUD DE REGISTRO DE TELEFONOS A AAM0017                     BDLDIR      1261
  5807*    EXCLUIR.                                                     AAM0017                     BDLDIR      1262
  5808******************************************************************AAM0017                     BDLDIR      1263
  5809 2019-BUSCA-POSINI-LONG-TELEXCLU.                                 AAM0017                     BDLDIR      1264
  5810     MOVE 0                TO SW-ENCUENTRA-PI                     AAM0017                     BDLDIR      1265
  5811     MOVE 1                TO W-POSI                              AAM0017                     BDLDIR      1266
  5812     INSPECT T-TELS-EXCLU(IQ) REPLACING ALL LOW-VALUES            AAM0017                     BDLDIR      1267
  5813                                        BY SPACES                 AAM0017                     BDLDIR      1268
  5814     PERFORM UNTIL SW-ENCUENTRA-PI = 1 OR W-POSI > 12             AAM0017                     BDLDIR      1269
  5815        IF T-TELS-EXCLU(IQ)(W-POSI:1) NOT EQUAL " "               AAM0017                     BDLDIR      1270
  5816           MOVE 1          TO SW-ENCUENTRA-PI                     AAM0017                     BDLDIR      1271
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 102
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5817           MOVE W-POSI     TO POSI-EXCLU                          AAM0017                     BDLDIR      1272
  5818           COMPUTE LONGCOMP-EXCLU = 12 - ( W-POSI - 1 )           AAM0017                     BDLDIR      1273
  5819        END-IF                                                    AAM0017                     BDLDIR      1274
  5820        ADD 1              TO W-POSI                              AAM0017                     BDLDIR      1275
  5821     END-PERFORM                                                  AAM0017                     BDLDIR      1276
  5822     IF W-POSI > 12                                               AAM0017                     BDLDIR      1277
  5823        MOVE 12            TO POSI-EXCLU                          AAM0017                     BDLDIR      1278
  5824        MOVE 0             TO LONGCOMP-EXCLU                      AAM0017                     BDLDIR      1279
  5825     END-IF.                                                      AAM0017                     BDLDIR      1280
  5826******************************************************************AAM0017                     BDLDIR      1281
  5827*2020-UNIFICA-TELEFONOS                                           AAM0017                     BDLDIR      1282
  5828*    UNIFICA TELEFONOS REPETIDOS                                  AAM0017                     BDLDIR      1283
  5829******************************************************************AAM0017                     BDLDIR      1284
  5830 2020-UNIFICA-TELEFONOS.                                          AAM0017                     BDLDIR      1285
  5831     SORT T-TELFINALES-BDLDIR DESCENDING V-TELFIN-BDLDIR-2        AAM0017                     BDLDIR      1286
  5832     MOVE 1                      TO W-I                           AAM0017                     BDLDIR      1287
  5833*    MOVE W-I                    TO W-POSRC                       AAM0017                     BDLDIR      1288
  5834     MOVE 0                      TO SW-1 SW-2                     AAM0017                     BDLDIR      1289
  5835     MOVE 0                      TO W-OCURR                       AAM0017                     BDLDIR      1290
  5836     PERFORM UNTIL W-I > 99  OR SW-1 = 1                          AAM0017                     BDLDIR      1291
  5837       IF V-CALTELFIN-BDLDIR(W-I) > 0                             AAM0017                     BDLDIR      1292
  5838         MOVE 1                   TO SW-1                         AAM0017                     BDLDIR      1293
  5839         MOVE W-I                 TO W-POSRC                      AAM0017                     BDLDIR      1294
  5840         COMPUTE W-I = W-I - 1                                    AAM0017                     BDLDIR      1295
  5841       END-IF                                                     AAM0017                     BDLDIR      1296
  5842       ADD 1 TO W-I                                               AAM0017                     BDLDIR      1297
  5843     END-PERFORM                                                  AAM0017                     BDLDIR      1298
  5844     IF W-I < 100                                                 AAM0017                     BDLDIR      1299
  5845       MOVE V-TELFIN-BDLDIR(W-POSRC) TO W-TELANT                  AAM0017                     BDLDIR      1300
  5846       MOVE V-NUMTELFIN-BDLDIR(W-POSRC) TO W-OCURR                AAM0017                     BDLDIR      1301
  5847       MOVE 0 TO SW-1                                             AAM0017                     BDLDIR      1302
  5848     END-IF                                                       AAM0017                     BDLDIR      1303
  5849     PERFORM UNTIL W-I > 99  OR SW-1 = 1                          AAM0017                     BDLDIR      1304
  5850       MOVE V-TELFIN-BDLDIR(W-I + 1) TO W-TELDES                  AAM0017                     BDLDIR      1305
  5851       MOVE 1                     TO W-POSIUNI                    AAM0017                     BDLDIR      1306
  5852       IF W-TELDES(6:7) = "       "                               AAM0017                     BDLDIR      1307
  5853        MOVE 1                    TO SW-1                         AAM0017                     BDLDIR      1308
  5854       END-IF                                                     AAM0017                     BDLDIR      1309
  5855       IF V-CALTELFIN-BDLDIR(W-I + 1) > 0                         AAM0017                     BDLDIR      1310
  5856        IF W-TELANT(6:7) = W-TELDES(6:7)                          AAM0017                     BDLDIR      1311
  5857         COMPUTE W-OCURR = W-OCURR +                              AAM0017                     BDLDIR      1312
  5858                           V-NUMTELFIN-BDLDIR(W-I + 1)            AAM0017                     BDLDIR      1313
  5859         MOVE 0 TO SW-2                                           AAM0017                     BDLDIR      1314
  5860         PERFORM UNTIL W-POSIUNI > 12 OR SW-2 = 1                 AAM0017                     BDLDIR      1315
  5861          INSPECT W-TELANT REPLACING ALL LOW-VALUES BY SPACES     AAM0017                     BDLDIR      1316
  5862          INSPECT W-TELDES REPLACING ALL LOW-VALUES BY SPACES     AAM0017                     BDLDIR      1317
  5863          IF W-TELANT(W-POSIUNI:1) <> "0"                         AAM0017                     BDLDIR      1318
  5864           MOVE W-POSIUNI TO W-POSANT                             AAM0017                     BDLDIR      1319
  5865           MOVE 1         TO SW-2                                 AAM0017                     BDLDIR      1320
  5866          END-IF                                                  AAM0017                     BDLDIR      1321
  5867          ADD 1           TO W-POSIUNI                            AAM0017                     BDLDIR      1322
  5868         END-PERFORM                                              AAM0017                     BDLDIR      1323
  5869         IF W-POSIUNI > 12                                        AAM0017                     BDLDIR      1324
  5870          MOVE 12         TO W-POSANT                             AAM0017                     BDLDIR      1325
  5871         END-IF                                                   AAM0017                     BDLDIR      1326
  5872         MOVE 0           TO SW-2                                 AAM0017                     BDLDIR      1327
  5873         MOVE 1           TO W-POSIUNI                            AAM0017                     BDLDIR      1328
  5874         PERFORM UNTIL W-POSIUNI > 12 OR SW-2 = 1                 AAM0017                     BDLDIR      1329
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 103
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5875          IF W-TELDES(W-POSIUNI:1) <> "0"                         AAM0017                     BDLDIR      1330
  5876           MOVE W-POSIUNI TO W-POSDES                             AAM0017                     BDLDIR      1331
  5877           MOVE 1         TO SW-2                                 AAM0017                     BDLDIR      1332
  5878          END-IF                                                  AAM0017                     BDLDIR      1333
  5879          ADD 1           TO W-POSIUNI                            AAM0017                     BDLDIR      1334
  5880         END-PERFORM                                              AAM0017                     BDLDIR      1335
  5881         IF W-POSIUNI > 12                                        AAM0017                     BDLDIR      1336
  5882          MOVE 12         TO W-POSDES                             AAM0017                     BDLDIR      1337
  5883         END-IF                                                   AAM0017                     BDLDIR      1338
  5884         MOVE 0           TO SW-2                                 AAM0017                     BDLDIR      1339
  5885         IF W-POSANT < W-POSDES                                   AAM0017                     BDLDIR      1340
  5886*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017                     BDLDIR      1341
  5887          IF V-FECTELFIN-BDLDIR(W-POSRC) <                        AAM0017                     BDLDIR      1342
  5888             V-FECTELFIN-BDLDIR(W-I + 1)                          AAM0017                     BDLDIR      1343
  5889           MOVE V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1344
  5890             TO V-FECTELFIN-BDLDIR(W-POSRC)                       AAM0017                     BDLDIR      1345
  5891          END-IF                                                  AAM0017                     BDLDIR      1346
  5892          IF V-CALTELFIN-BDLDIR(W-POSRC) <                        AAM0017                     BDLDIR      1347
  5893             V-CALTELFIN-BDLDIR(W-I + 1)                          AAM0017                     BDLDIR      1348
  5894           MOVE V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1349
  5895             TO V-CALTELFIN-BDLDIR(W-POSRC)                       AAM0017                     BDLDIR      1350
  5896          END-IF                                                  AAM0017                     BDLDIR      1351
  5897*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1352
  5898          MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)                   AAM0017                     BDLDIR      1353
  5899          MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)                   AAM0017                     BDLDIR      1354
  5900         ELSE                                                     AAM0017                     BDLDIR      1355
  5901          IF W-POSANT = W-POSDES                                  AAM0017                     BDLDIR      1356
  5902           IF V-NUMTELFIN-BDLDIR(W-POSRC) >                       AAM0017                     BDLDIR      1357
  5903              V-NUMTELFIN-BDLDIR(W-I + 1)                         AAM0017                     BDLDIR      1358
  5904*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017                     BDLDIR      1359
  5905            IF V-FECTELFIN-BDLDIR(W-POSRC) <                      AAM0017                     BDLDIR      1360
  5906               V-FECTELFIN-BDLDIR(W-I + 1)                        AAM0017                     BDLDIR      1361
  5907             MOVE V-FECTELFIN-BDLDIR(W-I + 1)                     AAM0017                     BDLDIR      1362
  5908               TO V-FECTELFIN-BDLDIR(W-POSRC)                     AAM0017                     BDLDIR      1363
  5909            END-IF                                                AAM0017                     BDLDIR      1364
  5910            IF V-CALTELFIN-BDLDIR(W-POSRC) <                      AAM0017                     BDLDIR      1365
  5911               V-CALTELFIN-BDLDIR(W-I + 1)                        AAM0017                     BDLDIR      1366
  5912             MOVE V-CALTELFIN-BDLDIR(W-I + 1)                     AAM0017                     BDLDIR      1367
  5913               TO V-CALTELFIN-BDLDIR(W-POSRC)                     AAM0017                     BDLDIR      1368
  5914            END-IF                                                AAM0017                     BDLDIR      1369
  5915*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1370
  5916            MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)                 AAM0017                     BDLDIR      1371
  5917            MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)                 AAM0017                     BDLDIR      1372
  5918           ELSE                                                   AAM0017                     BDLDIR      1373
  5919            IF V-NUMTELFIN-BDLDIR(W-POSRC) =                      AAM0017                     BDLDIR      1374
  5920               V-NUMTELFIN-BDLDIR(W-I + 1)                        AAM0017                     BDLDIR      1375
  5921*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017                     BDLDIR      1376
  5922             IF V-FECTELFIN-BDLDIR(W-POSRC) <                     AAM0017                     BDLDIR      1377
  5923                V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1378
  5924              MOVE V-FECTELFIN-BDLDIR(W-I + 1)                    AAM0017                     BDLDIR      1379
  5925                TO V-FECTELFIN-BDLDIR(W-POSRC)                    AAM0017                     BDLDIR      1380
  5926             END-IF                                               AAM0017                     BDLDIR      1381
  5927             IF V-CALTELFIN-BDLDIR(W-POSRC) <                     AAM0017                     BDLDIR      1382
  5928                V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1383
  5929              MOVE V-CALTELFIN-BDLDIR(W-I + 1)                    AAM0017                     BDLDIR      1384
  5930                TO V-CALTELFIN-BDLDIR(W-POSRC)                    AAM0017                     BDLDIR      1385
  5931             END-IF                                               AAM0017                     BDLDIR      1386
  5932*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1387
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 104
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5933             IF V-CALTELFIN-BDLDIR(W-POSRC) >                     AAM0017                     BDLDIR      1388
  5934                V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1389
  5935*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017                     BDLDIR      1390
  5936              IF V-FECTELFIN-BDLDIR(W-POSRC) <                    AAM0017                     BDLDIR      1391
  5937                 V-FECTELFIN-BDLDIR(W-I + 1)                      AAM0017                     BDLDIR      1392
  5938               MOVE V-FECTELFIN-BDLDIR(W-I + 1)                   AAM0017                     BDLDIR      1393
  5939                 TO V-FECTELFIN-BDLDIR(W-POSRC)                   AAM0017                     BDLDIR      1394
  5940              END-IF                                              AAM0017                     BDLDIR      1395
  5941*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1396
  5942              MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)               AAM0017                     BDLDIR      1397
  5943              MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)               AAM0017                     BDLDIR      1398
  5944             ELSE                                                 AAM0017                     BDLDIR      1399
  5945              IF V-CALTELFIN-BDLDIR(W-POSRC) =                    AAM0017                     BDLDIR      1400
  5946                 V-CALTELFIN-BDLDIR(W-I + 1)                      AAM0017                     BDLDIR      1401
  5947*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017                     BDLDIR      1402
  5948               IF V-FECTELFIN-BDLDIR(W-POSRC) <                   AAM0017                     BDLDIR      1403
  5949                  V-FECTELFIN-BDLDIR(W-I + 1)                     AAM0017                     BDLDIR      1404
  5950                MOVE V-FECTELFIN-BDLDIR(W-I + 1)                  AAM0017                     BDLDIR      1405
  5951                  TO V-FECTELFIN-BDLDIR(W-POSRC)                  AAM0017                     BDLDIR      1406
  5952               END-IF                                             AAM0017                     BDLDIR      1407
  5953*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1408
  5954               IF V-FECTELFIN-BDLDIR(W-POSRC) >                   AAM0017                     BDLDIR      1409
  5955                  V-FECTELFIN-BDLDIR(W-I + 1)                     AAM0017                     BDLDIR      1410
  5956                MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)             AAM0017                     BDLDIR      1411
  5957                MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)             AAM0017                     BDLDIR      1412
  5958               ELSE                                               AAM0017                     BDLDIR      1413
  5959                IF V-FECTELFIN-BDLDIR(W-POSRC) =                  AAM0017                     BDLDIR      1414
  5960                   V-FECTELFIN-BDLDIR(W-I + 1)                    AAM0017                     BDLDIR      1415
  5961                 MOVE 0 TO V-FECTELFIN-BDLDIR(W-I + 1)            AAM0017                     BDLDIR      1416
  5962                 MOVE 0 TO V-CALTELFIN-BDLDIR(W-I + 1)            AAM0017                     BDLDIR      1417
  5963                ELSE                                              AAM0017                     BDLDIR      1418
  5964                 MOVE 1 TO SW-2                                   AAM0017                     BDLDIR      1419
  5965                END-IF                                            AAM0017                     BDLDIR      1420
  5966               END-IF                                             AAM0017                     BDLDIR      1421
  5967              ELSE                                                AAM0017                     BDLDIR      1422
  5968               MOVE 1 TO SW-2                                     AAM0017                     BDLDIR      1423
  5969              END-IF                                              AAM0017                     BDLDIR      1424
  5970             END-IF                                               AAM0017                     BDLDIR      1425
  5971            ELSE                                                  AAM0017                     BDLDIR      1426
  5972             MOVE 1 TO SW-2                                       AAM0017                     BDLDIR      1427
  5973            END-IF                                                AAM0017                     BDLDIR      1428
  5974           END-IF                                                 AAM0017                     BDLDIR      1429
  5975          ELSE                                                    AAM0017                     BDLDIR      1430
  5976           IF V-FECTELFIN-BDLDIR(W-POSRC) >                       AAM0017                     BDLDIR      1431
  5977              V-FECTELFIN-BDLDIR(W-I + 1)                         AAM0017                     BDLDIR      1432
  5978            MOVE V-FECTELFIN-BDLDIR(W-POSRC)                      AAM0017                     BDLDIR      1433
  5979              TO V-FECTELFIN-BDLDIR(W-I + 1)                      AAM0017                     BDLDIR      1434
  5980           END-IF                                                 AAM0017                     BDLDIR      1435
  5981           IF V-CALTELFIN-BDLDIR(W-POSRC) >                       AAM0017                     BDLDIR      1436
  5982              V-CALTELFIN-BDLDIR(W-I + 1)                         AAM0017                     BDLDIR      1437
  5983            MOVE V-CALTELFIN-BDLDIR(W-POSRC)                      AAM0017                     BDLDIR      1438
  5984              TO V-CALTELFIN-BDLDIR(W-I + 1)                      AAM0017                     BDLDIR      1439
  5985           END-IF                                                 AAM0017                     BDLDIR      1440
  5986*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1441
  5987           MOVE 0        TO V-FECTELFIN-BDLDIR(W-POSRC)           AAM0017                     BDLDIR      1442
  5988           MOVE 0        TO V-CALTELFIN-BDLDIR(W-POSRC)           AAM0017                     BDLDIR      1443
  5989           MOVE W-TELDES TO W-TELANT                              AAM0017                     BDLDIR      1444
  5990           COMPUTE W-POSRC = W-I + 1                              AAM0017                     BDLDIR      1445
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 105
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  5991*          MOVE 1 TO SW-2                                         AAM0017                     BDLDIR      1446
  5992          END-IF                                                  AAM0017                     BDLDIR      1447
  5993         END-IF                                                   AAM0017                     BDLDIR      1448
  5994         IF SW-2 = 1                                              AAM0017                     BDLDIR      1449
  5995*----------* VALIDA FECHA Y CALIFICACION INI *-------*            AAM0017                     BDLDIR      1450
  5996          IF V-FECTELFIN-BDLDIR(W-POSRC) <                        AAM0017                     BDLDIR      1451
  5997             V-FECTELFIN-BDLDIR(W-I + 1)                          AAM0017                     BDLDIR      1452
  5998           MOVE V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1453
  5999             TO V-FECTELFIN-BDLDIR(W-POSRC)                       AAM0017                     BDLDIR      1454
  6000          ELSE                                                    AAM0017                     BDLDIR      1455
  6001           MOVE V-FECTELFIN-BDLDIR(W-POSRC)                       AAM0017                     BDLDIR      1456
  6002             TO V-FECTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1457
  6003          END-IF                                                  AAM0017                     BDLDIR      1458
  6004          IF V-CALTELFIN-BDLDIR(W-POSRC) <                        AAM0017                     BDLDIR      1459
  6005             V-CALTELFIN-BDLDIR(W-I + 1)                          AAM0017                     BDLDIR      1460
  6006           MOVE V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1461
  6007             TO V-CALTELFIN-BDLDIR(W-POSRC)                       AAM0017                     BDLDIR      1462
  6008          ELSE                                                    AAM0017                     BDLDIR      1463
  6009           MOVE V-CALTELFIN-BDLDIR(W-POSRC)                       AAM0017                     BDLDIR      1464
  6010             TO V-CALTELFIN-BDLDIR(W-I + 1)                       AAM0017                     BDLDIR      1465
  6011          END-IF                                                  AAM0017                     BDLDIR      1466
  6012*----------* VALIDA FECHA Y CALIFICACION FIN *-------*            AAM0017                     BDLDIR      1467
  6013          MOVE 0        TO V-FECTELFIN-BDLDIR(W-POSRC)            AAM0017                     BDLDIR      1468
  6014          MOVE 0        TO V-CALTELFIN-BDLDIR(W-POSRC)            AAM0017                     BDLDIR      1469
  6015          MOVE W-TELDES TO W-TELANT                               AAM0017                     BDLDIR      1470
  6016          COMPUTE W-POSRC = W-I + 1                               AAM0017                     BDLDIR      1471
  6017         END-IF                                                   AAM0017                     BDLDIR      1472
  6018        ELSE                                                      AAM0017                     BDLDIR      1473
  6019         MOVE W-OCURR  TO V-NUMTELFIN-BDLDIR(W-POSRC)             AAM0017                     BDLDIR      1474
  6020         MOVE W-TELDES TO W-TELANT                                AAM0017                     BDLDIR      1475
  6021         COMPUTE W-POSRC = W-I + 1                                AAM0017                     BDLDIR      1476
  6022         MOVE V-NUMTELFIN-BDLDIR(W-POSRC) TO W-OCURR              AAM0017                     BDLDIR      1477
  6023        END-IF                                                    AAM0017                     BDLDIR      1478
  6024       END-IF                                                     AAM0017                     BDLDIR      1479
  6025       IF SW-1 = 1 AND V-CALTELFIN-BDLDIR(W-I + 1) < 1            AAM0017                     BDLDIR      1480
  6026         MOVE W-OCURR  TO V-NUMTELFIN-BDLDIR(W-POSRC)             AAM0017                     BDLDIR      1481
  6027       END-IF                                                     AAM0017                     BDLDIR      1482
  6028       ADD 1 TO W-I                                               AAM0017                     BDLDIR      1483
  6029     END-PERFORM.                                                 AAM0017                     BDLDIR      1484
  6030*-----------------------------------------------------------------                            BDLDIR      1485
  6031*         RUTINAS PARA LA ESTANDARIZACION DE DIRECCIONES                                      BDLDIR      1486
  6032*-----------------------------------------------------------------                            BDLDIR      1487
  6033 06000-U-CARGAR-TABLA-DIRESTAN.                                                               BDLDIR      1488
  6034******************************************************************                            BDLDIR      1489
  6035*06000-CARGAR-TABLA-DIRESTAN.                                    *                            BDLDIR      1490
  6036*    SE CARGA EN MEMORIA LA TABLA PARA ESTANDARIZACION DE        *                            BDLDIR      1491
  6037*    DIRECCIONES                                                 *                            BDLDIR      1492
  6038*    PARAMETROS                                                                               BDLDIR      1493
  6039*       INPUT      DECLARAR ARCHIVO DIREST                                                    BDLDIR      1494
  6040*       OUTPUT     TABLA-DIR-ESTANDAR.                                                        BDLDIR      1495
  6041******************************************************************                            BDLDIR      1496
  6042     INITIALIZE TABLA-DIR-COMPUESTAS-BDLDIR                       RMB0010                     BDLDIR      1497
  6043     OPEN INPUT DIREST                                            RMB0010                     BDLDIR      1498
  6044     MOVE 0 TO FDA-DIREST-BDLDIR                                  RMB0010                     BDLDIR      1499
  6045     READ DIREST                                                                              BDLDIR      1500
  6046        AT END                                                                                BDLDIR      1501
  6047           MOVE 1 TO FDA-DIREST-BDLDIR                            RMB0010                     BDLDIR      1502
  6048     END-READ                                                                                 BDLDIR      1503
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 106
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6049     MOVE 1 TO I-STA-BDLDIR                                       RMB0010                     BDLDIR      1504
  6050     MOVE 1 TO J-STA-BDLDIR                                       RMB0010                     BDLDIR      1505
  6051*    PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 500   RMB0010                     BDLDIR      1506
  6052     PERFORM UNTIL FDA-DIREST-BDLDIR = 1 OR I-STA-BDLDIR >= 2000  PJV0024                     BDLDIR      1507
  6053        IF DIR-ORIG-DIREST (1:4) <> "****"                        RMB0010                     BDLDIR      1508
  6054           MOVE DIR-ORIG-DIREST                                   RMB0010                     BDLDIR      1509
  6055                TO DIR-ORIGINAL-BDLDIR (I-STA-BDLDIR)             RMB0010                     BDLDIR      1510
  6056           MOVE DIR-ESTAN-DIREST                                  RMB0010                     BDLDIR      1511
  6057                TO DIR-ESTANDAR-BDLDIR (I-STA-BDLDIR)             RMB0010                     BDLDIR      1512
  6058           INITIALIZE M-BDLDIR                                    RMB0010                     BDLDIR      1513
  6059           INSPECT DIR-ORIG-DIREST TALLYING M-BDLDIR FOR ALL "*"  RMB0010                     BDLDIR      1514
  6060           IF M-BDLDIR > 0                                        RMB0010                     BDLDIR      1515
  6061              INITIALIZE M-BDLDIR                                 RMB0010                     BDLDIR      1516
  6062              INSPECT DIR-ORIG-DIREST                             RMB0010                     BDLDIR      1517
  6063                      TALLYING M-BDLDIR                           RMB0010                     BDLDIR      1518
  6064                      FOR CHARACTERS BEFORE INITIAL " "           RMB0010                     BDLDIR      1519
  6065              MOVE 0 TO DIR-COMPUESTAS-TIP-BDLDIR (J-STA-BDLDIR)  RMB0010                     BDLDIR      1520
  6066              MOVE M-BDLDIR                                       RMB0010                     BDLDIR      1521
  6067                   TO DIR-COMPUESTAS-LON-BDLDIR (J-STA-BDLDIR)    RMB0010                     BDLDIR      1522
  6068              MOVE DIR-ORIG-DIREST                                RMB0010                     BDLDIR      1523
  6069                   TO DIR-COMPUESTAS-AST-BDLDIR (J-STA-BDLDIR)    RMB0010                     BDLDIR      1524
  6070              INSPECT DIR-ORIG-DIREST REPLACING ALL "*" BY " "    RMB0010                     BDLDIR      1525
  6071              MOVE DIR-ORIG-DIREST                                RMB0010                     BDLDIR      1526
  6072                   TO DIR-COMPUESTAS-BLN-BDLDIR (J-STA-BDLDIR)    RMB0010                     BDLDIR      1527
  6073              ADD 1 TO J-STA-BDLDIR                               RMB0010                     BDLDIR      1528
  6074           END-IF                                                 RMB0010                     BDLDIR      1529
  6075           IF DIR-ORIG-DIREST (1:1) = "/" OR "(" OR ")" OR        RMB0010                     BDLDIR      1530
  6076                                      "=" OR "?"                  RMB0010                     BDLDIR      1531
  6077              INITIALIZE M-BDLDIR                                 RMB0010                     BDLDIR      1532
  6078              INSPECT DIR-ORIG-DIREST                             RMB0010                     BDLDIR      1533
  6079                      TALLYING M-BDLDIR FOR CHARACTERS BEFORE     RMB0010                     BDLDIR      1534
  6080                               INITIAL " "                        RMB0010                     BDLDIR      1535
  6081              MOVE 1 TO DIR-COMPUESTAS-TIP-BDLDIR (J-STA-BDLDIR)  RMB0010                     BDLDIR      1536
  6082              MOVE M-BDLDIR                                       RMB0010                     BDLDIR      1537
  6083                   TO DIR-COMPUESTAS-LON-BDLDIR (J-STA-BDLDIR)    RMB0010                     BDLDIR      1538
  6084              MOVE DIR-ORIG-DIREST                                RMB0010                     BDLDIR      1539
  6085                   TO DIR-COMPUESTAS-AST-BDLDIR (J-STA-BDLDIR)    RMB0010                     BDLDIR      1540
  6086              EVALUATE  DIR-ORIG-DIREST (1:1)                     RMB0010                     BDLDIR      1541
  6087                WHEN "/"                                          RMB0010                     BDLDIR      1542
  6088                  INSPECT DIR-ORIG-DIREST REPLACING ALL "/" BY "0"RMB0010                     BDLDIR      1543
  6089                WHEN "("                                          RMB0010                     BDLDIR      1544
  6090                  INSPECT DIR-ORIG-DIREST REPLACING ALL "(" BY "1"RMB0010                     BDLDIR      1545
  6091                WHEN ")"                                          RMB0010                     BDLDIR      1546
  6092                  INSPECT DIR-ORIG-DIREST REPLACING ALL ")" BY "2"RMB0010                     BDLDIR      1547
  6093                WHEN "="                                          RMB0010                     BDLDIR      1548
  6094                  INSPECT DIR-ORIG-DIREST REPLACING ALL "=" BY "5"RMB0010                     BDLDIR      1549
  6095                WHEN "?"                                          RMB0010                     BDLDIR      1550
  6096                  INSPECT DIR-ORIG-DIREST REPLACING ALL "?" BY "7"RMB0010                     BDLDIR      1551
  6097              END-EVALUATE                                        RMB0010                     BDLDIR      1552
  6098              MOVE DIR-ORIG-DIREST                                RMB0010                     BDLDIR      1553
  6099                   TO DIR-COMPUESTAS-BLN-BDLDIR (J-STA-BDLDIR)    RMB0010                     BDLDIR      1554
  6100              ADD 1 TO J-STA-BDLDIR                               RMB0010                     BDLDIR      1555
  6101           END-IF                                                 RMB0010                     BDLDIR      1556
  6102           ADD 1 TO I-STA-BDLDIR                                  RMB0010                     BDLDIR      1557
  6103        END-IF                                                    RMB0010                     BDLDIR      1558
  6104        READ DIREST                                               RMB0010                     BDLDIR      1559
  6105           AT END                                                 RMB0010                     BDLDIR      1560
  6106              MOVE 1 TO FDA-DIREST-BDLDIR                         RMB0010                     BDLDIR      1561
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 107
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6107        END-READ                                                  RMB0010                     BDLDIR      1562
  6108     END-PERFORM                                                                              BDLDIR      1563
  6109*    PERFORM UNTIL I-STA-BDLDIR >= 500                            RMB0010                     BDLDIR      1564
  6110     PERFORM UNTIL I-STA-BDLDIR >= 2000                           PJV0024                     BDLDIR      1565
  6111        MOVE "ZZZZZZZZZZZZZZZZZZZZ"                               RMB0010                     BDLDIR      1566
  6112             TO DIR-ORIGINAL-BDLDIR (I-STA-BDLDIR)                RMB0010                     BDLDIR      1567
  6113        MOVE SPACES                                               RMB0010                     BDLDIR      1568
  6114             TO DIR-ESTANDAR-BDLDIR (I-STA-BDLDIR)                RMB0010                     BDLDIR      1569
  6115        ADD 1 TO I-STA-BDLDIR                                     RMB0010                     BDLDIR      1570
  6116     END-PERFORM                                                                              BDLDIR      1571
  6117     SORT TABLA-DIR-ESTANDAR-BDLDIR ASCENDING DIR-ORIGINAL-BDLDIR.RMB0010                     BDLDIR      1572
  6118 6100-U-ESTANDARIZAR-DIRECC.                                                                  BDLDIR      1573
  6119******************************************************************                            BDLDIR      1574
  6120*6100-ESTANDARIZAR-DIRECC.                                       *                            BDLDIR      1575
  6121*    ESTA RUTINA TOMA LA DIRECCION DE ENTRADA Y LA ESTANDARIZA DE*                            BDLDIR      1576
  6122*    ACUERDO A LA TABLA DE ESTADARIZACION DE DIRECCIONES         *                            BDLDIR      1577
  6123*    APLICANDO ADEMAS REEMPLAZOS DE CARACTERES ESPECIALES        *                            BDLDIR      1578
  6124*    PARAMETROS                                                                               BDLDIR      1579
  6125*       INPUT        DIRECCION-A-ESTANDARIZAR.                                                BDLDIR      1580
  6126*       OUTPUT       DIRECCION-ESTANDARIZADA.                                                 BDLDIR      1581
  6127******************************************************************                            BDLDIR      1582
  6128***  SE DESCARTAN LAS DIRECCIONES QUE CONTIENEN EL NOMBRE DE LA   RMB0010                     BDLDIR      1583
  6129***  CIUDAD                                                       RMB0010                     BDLDIR      1584
  6130     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (1:20) <> CIUDAD-BDLDIR   RMB0010                     BDLDIR      1585
  6131        INSPECT DIRECCION-A-ESTANDARIZAR-BDLDIR                   RMB0010                     BDLDIR      1586
  6132                REPLACING ALL "." BY " "                          RMB0010                     BDLDIR      1587
  6133                              "-" BY " "                          RMB0010                     BDLDIR      1588
  6134                              "'" BY " "                          RMB0010                     BDLDIR      1589
  6135                              "#" BY " "                          RMB0010                     BDLDIR      1590
  6136                              ":" BY " "                          RMB0010                     BDLDIR      1591
  6137                              "/" BY " "                          RMB0010                     BDLDIR      1592
  6138                              "," BY " "                          RMB0010                     BDLDIR      1593
  6139                              "*" BY " "                          RMB0010                     BDLDIR      1594
  6140                              "?" BY " "                          RMB0010                     BDLDIR      1595
  6141                              "\" BY " "                          RMB0010                     BDLDIR      1596
  6142                              "_" BY " "                          RMB0010                     BDLDIR      1597
  6143                              ";" BY " "                          RMB0010                     BDLDIR      1598
  6144                              "´" BY " "                          RMB0010                     BDLDIR      1599
  6145                              "+" BY " "                          RMB0010                     BDLDIR      1600
  6146                              "¿" BY " "                          RMB0010                     BDLDIR      1601
  6147                              "!" BY " "                          RMB0010                     BDLDIR      1602
  6148                              "¡" BY " "                          RMB0010                     BDLDIR      1603
  6149                              "^" BY " "                          RMB0010                     BDLDIR      1604
  6150                              "`" BY " "                          RMB0010                     BDLDIR      1605
  6151                              "¬" BY " "                          RMB0010                     BDLDIR      1606
  6152                              "|"  BY " "                          RMB0010                    BDLDIR      1607
  6153                              "&" BY " "                          RMB0010                     BDLDIR      1608
  6154                              "%" BY " "                          RMB0010                     BDLDIR      1609
  6155                              "¨" BY " "                          RMB0010                     BDLDIR      1610
  6156                              "[" BY " "                          RMB0010                     BDLDIR      1611
  6157                              "]" BY " "                          RMB0010                     BDLDIR      1612
  6158                              "{" BY " "                          RMB0010                     BDLDIR      1613
  6159                              "}" BY " "                          RMB0010                     BDLDIR      1614
  6160                              "~" BY " "                          RMB0010                     BDLDIR      1615
  6161                              '"' BY " "                          RMB0010                     BDLDIR      1616
  6162                              "(" BY " "                          RMB0010                     BDLDIR      1617
  6163                              ")" BY " "                          RMB0010                     BDLDIR      1618
  6164                              "°" BY " "                          RMB0010                     BDLDIR      1619
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 108
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6165                              "$" BY " "                          RMB0010                     BDLDIR      1620
  6166                              "@" BY " "                          RMB0010                     BDLDIR      1621
  6167                              "<" BY " "                          RMB0010                     BDLDIR      1622
  6168                              ">" BY " "                          RMB0010                     BDLDIR      1623
  6169                              "=" BY " "                          RMB0010                     BDLDIR      1624
  6170        MOVE FUNCTION UPPER-CASE (DIRECCION-A-ESTANDARIZAR-BDLDIR)RMB0010                     BDLDIR      1625
  6171             TO DIRECCION-A-ESTANDARIZAR-BDLDIR                   RMB0010                     BDLDIR      1626
  6172        PERFORM 6130-FILTRO-INICIAL                               RMB0010                     BDLDIR      1627
  6173        MOVE 1 TO KK-STA-BDLDIR                                   RMB0010                     BDLDIR      1628
  6174        INITIALIZE NUEVA-DIRECCION-BDLDIR                         RMB0010                     BDLDIR      1629
  6175                   SUM-DIGITOS-BDLDIR                             RMB0010                     BDLDIR      1630
  6176                   TIP-NUEVA-DIRECCION-BDLDIR                     RMB0010                     BDLDIR      1631
  6177                   CON-PART-ESTANDARIZADA-BDLDIR                  HGO0021                     BDLDIR      1632
  6178        MOVE 1 TO II-STA-BDLDIR                                   RMB0010                     BDLDIR      1633
  6179        PERFORM UNTIL II-STA-BDLDIR > 60                          RMB0010                     BDLDIR      1634
  6180           IF DIR-A-EST-BDLDIR (II-STA-BDLDIR) NUMERIC            RMB0010                     BDLDIR      1635
  6181              MOVE "N" TO IND-TIPCAR-BDLDIR                       RMB0010                     BDLDIR      1636
  6182              ADD   1  TO SUM-DIGITOS-BDLDIR                      RMB0010                     BDLDIR      1637
  6183           ELSE                                                   RMB0010                     BDLDIR      1638
  6184              MOVE "A" TO IND-TIPCAR-BDLDIR                       RMB0010                     BDLDIR      1639
  6185           END-IF                                                 RMB0010                     BDLDIR      1640
  6186           INITIALIZE PART-A-ESTANDARIZAR-BDLDIR                  RMB0010                     BDLDIR      1641
  6187           MOVE 1 TO JJ-STA-BDLDIR                                RMB0010                     BDLDIR      1642
  6188           MOVE IND-TIPCAR-BDLDIR TO TIPCAR-WS-BDLDIR             RMB0010                     BDLDIR      1643
  6189           PERFORM UNTIL II-STA-BDLDIR > 60 OR                    RMB0010                     BDLDIR      1644
  6190                         JJ-STA-BDLDIR > 60 OR                    RMB0010                     BDLDIR      1645
  6191                         IND-TIPCAR-BDLDIR <> TIPCAR-WS-BDLDIR OR RMB0010                     BDLDIR      1646
  6192                         DIR-A-EST-BDLDIR (II-STA-BDLDIR) = SPACESRMB0010                     BDLDIR      1647
  6193              MOVE DIR-A-EST-BDLDIR (II-STA-BDLDIR)               RMB0010                     BDLDIR      1648
  6194                   TO PART-A-ESTAN-BDLDIR (JJ-STA-BDLDIR)         RMB0010                     BDLDIR      1649
  6195              ADD 1 TO II-STA-BDLDIR                              RMB0010                     BDLDIR      1650
  6196              ADD 1 TO JJ-STA-BDLDIR                              RMB0010                     BDLDIR      1651
  6197              IF II-STA-BDLDIR <= 60                              RMB0010                     BDLDIR      1652
  6198                 IF DIR-A-EST-BDLDIR (II-STA-BDLDIR) NUMERIC      RMB0010                     BDLDIR      1653
  6199                    MOVE "N" TO IND-TIPCAR-BDLDIR                 RMB0010                     BDLDIR      1654
  6200                    ADD   1  TO SUM-DIGITOS-BDLDIR                RMB0010                     BDLDIR      1655
  6201                 ELSE                                             RMB0010                     BDLDIR      1656
  6202                    MOVE "A" TO IND-TIPCAR-BDLDIR                 RMB0010                     BDLDIR      1657
  6203                 END-IF                                           RMB0010                     BDLDIR      1658
  6204              END-IF                                              RMB0010                     BDLDIR      1659
  6205           END-PERFORM                                            RMB0010                     BDLDIR      1660
  6206           ADD 1 TO CON-PART-ESTANDARIZADA-BDLDIR                 HGO0021                     BDLDIR      1661
  6207           IF TIPCAR-WS-BDLDIR = "A"                              RMB0010                     BDLDIR      1662
  6208              PERFORM 6110-ESTANDARIZAR-PART                      RMB0010                     BDLDIR      1663
  6209              IF PART-ESTANDARIZADA-BDLDIR <> SPACES              RMB0010                     BDLDIR      1664
  6210                 IF CON-PART-ESTANDARIZADA-BDLDIR = 1             HGO0021                     BDLDIR      1665
  6211                  MOVE PART-ESTANDARIZADA-BDLDIR TO               HGO0021                     BDLDIR      1666
  6212                     PRIPART-ESTANDARIZADA-BDLDIR                 HGO0021                     BDLDIR      1667
  6213                 ELSE                                             HGO0021                     BDLDIR      1668
  6214                  IF CON-PART-ESTANDARIZADA-BDLDIR = 2            HGO0021                     BDLDIR      1669
  6215                     MOVE PART-ESTANDARIZADA-BDLDIR TO            HGO0021                     BDLDIR      1670
  6216                        SEGPART-ESTANDARIZADA-BDLDIR              HGO0021                     BDLDIR      1671
  6217                  END-IF                                          HGO0021                     BDLDIR      1672
  6218                 END-IF                                           HGO0021                     BDLDIR      1673
  6219                 MOVE PART-ESTANDARIZADA-BDLDIR                   RMB0010                     BDLDIR      1674
  6220                      TO NVA-DIR-BDLDIR (KK-STA-BDLDIR)           RMB0010                     BDLDIR      1675
  6221                 IF ENC-DIREST-BDLDIR = 0                         RMB0010                     BDLDIR      1676
  6222                    MOVE "S" TO TIP-NVA-DIR-BDLDIR(KK-STA-BDLDIR) RMB0010                     BDLDIR      1677
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 109
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6223                 ELSE                                             RMB0010                     BDLDIR      1678
  6224                    MOVE "A" TO TIP-NVA-DIR-BDLDIR(KK-STA-BDLDIR) RMB0010                     BDLDIR      1679
  6225                 END-IF                                           RMB0010                     BDLDIR      1680
  6226                 ADD 1 TO KK-STA-BDLDIR                           RMB0010                     BDLDIR      1681
  6227              ELSE                                                HGO0021                     BDLDIR      1682
  6228                 IF PART-ESTANDARIZADA-BDLDIR = SPACES AND        HGO0021                     BDLDIR      1683
  6229                 PART-A-ESTANDARIZAR-BDLDIR = SPACES              HGO0021                     BDLDIR      1684
  6230                  COMPUTE CON-PART-ESTANDARIZADA-BDLDIR =         HGO0021                     BDLDIR      1685
  6231                  CON-PART-ESTANDARIZADA-BDLDIR - 1               HGO0021                     BDLDIR      1686
  6232                 END-IF                                           HGO0021                     BDLDIR      1687
  6233              END-IF                                              RMB0010                     BDLDIR      1688
  6234           ELSE                                                   RMB0010                     BDLDIR      1689
  6235              IF PART-A-ESTANDARIZAR-BDLDIR <> SPACES             RMB0010                     BDLDIR      1690
  6236                 IF CON-PART-ESTANDARIZADA-BDLDIR = 1             HGO0021                     BDLDIR      1691
  6237                  MOVE PART-A-ESTANDARIZAR-BDLDIR TO              HGO0021                     BDLDIR      1692
  6238                     PRIPART-ESTANDARIZADA-BDLDIR                 HGO0021                     BDLDIR      1693
  6239                 ELSE                                             HGO0021                     BDLDIR      1694
  6240                  IF CON-PART-ESTANDARIZADA-BDLDIR = 2            HGO0021                     BDLDIR      1695
  6241                     MOVE PART-A-ESTANDARIZAR-BDLDIR TO           HGO0021                     BDLDIR      1696
  6242                        SEGPART-ESTANDARIZADA-BDLDIR              HGO0021                     BDLDIR      1697
  6243                  END-IF                                          HGO0021                     BDLDIR      1698
  6244                 END-IF                                           HGO0021                     BDLDIR      1699
  6245                 MOVE PART-A-ESTANDARIZAR-BDLDIR                  RMB0010                     BDLDIR      1700
  6246                      TO NVA-DIR-BDLDIR (KK-STA-BDLDIR)           RMB0010                     BDLDIR      1701
  6247                 MOVE "N" TO TIP-NVA-DIR-BDLDIR(KK-STA-BDLDIR)    RMB0010                     BDLDIR      1702
  6248                 ADD 1 TO KK-STA-BDLDIR                           RMB0010                     BDLDIR      1703
  6249              END-IF                                              RMB0010                     BDLDIR      1704
  6250           END-IF                                                 RMB0010                     BDLDIR      1705
  6251           PERFORM UNTIL II-STA-BDLDIR > 60 OR                    RMB0010                     BDLDIR      1706
  6252                   DIR-A-EST-BDLDIR (II-STA-BDLDIR) <> SPACES     RMB0010                     BDLDIR      1707
  6253              ADD 1 TO II-STA-BDLDIR                              RMB0010                     BDLDIR      1708
  6254           END-PERFORM                                            RMB0010                     BDLDIR      1709
  6255        END-PERFORM                                               RMB0010                     BDLDIR      1710
  6256        INITIALIZE DIRECCION-ESTANDARIZADA-BDLDIR                 RMB0010                     BDLDIR      1711
  6257        MOVE 2 TO JJ-STA-BDLDIR                                   RMB0010                     BDLDIR      1712
  6258        MOVE NVA-DIR-BDLDIR (1) TO DIRECCION-ESTANDARIZADA-BDLDIR RMB0010                     BDLDIR      1713
  6259        MOVE 0 TO CALIFICA-DIR-BDLDIR                             RMB0010                     BDLDIR      1714
  6260        IF TIP-NVA-DIR-BDLDIR(1) = "S"                            RMB0010                     BDLDIR      1715
  6261           MOVE 10 TO CALIFICA-DIRPART1-BDLDIR                    HGO0021                     BDLDIR      1716
  6262           ADD 10 TO CALIFICA-DIR-BDLDIR                          HGO0021                     BDLDIR      1717
  6263           ADD 10 TO CALIFICA-DIR-BDLDIR                          RMB0010                     BDLDIR      1718
  6264        ELSE                                                      RMB0010                     BDLDIR      1719
  6265           IF TIP-NVA-DIR-BDLDIR(1) = "N"                         RMB0010                     BDLDIR      1720
  6266              MOVE 6 TO CALIFICA-DIRPART1-BDLDIR                  HGO0021                     BDLDIR      1721
  6267              ADD 6 TO CALIFICA-DIR-BDLDIR                        HGO0021                     BDLDIR      1722
  6268              ADD 0 TO CALIFICA-DIR-BDLDIR                        RMB0010                     BDLDIR      1723
  6269           ELSE                                                   RMB0010                     BDLDIR      1724
  6270              MOVE 8 TO CALIFICA-DIRPART1-BDLDIR                  HGO0021                     BDLDIR      1725
  6271*RCNCER              ADD 5 TO CALIFICA-DIR-BDLDIR                 HGO0021                     BDLDIR      1726
  6272           END-IF                                                 RMB0010                     BDLDIR      1727
  6273        END-IF                                                    RMB0010                     BDLDIR      1728
  6274        MOVE 0 TO CAMPOS-N-DIR-BDLDIR                             RMB0010                     BDLDIR      1729
  6275        PERFORM UNTIL JJ-STA-BDLDIR >= KK-STA-BDLDIR              RMB0010                     BDLDIR      1730
  6276           IF JJ-STA-BDLDIR = 2                                   RMB0010                     BDLDIR      1731
  6277*RCNCER              IF NVA-DIR-BDLDIR(2) NOT = SPACES            HGO0021                     BDLDIR      1732
  6278*RCNCER                 ADD 10 TO CALIFICA-DIR-BDLDIR             HGO0021                     BDLDIR      1733
  6279*RCNCER              END-IF                                       HGO0021                     BDLDIR      1734
  6280              IF TIP-NVA-DIR-BDLDIR(2) = "S"                      HGO0021                     BDLDIR      1735
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 110
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6281               MOVE 10 TO CALIFICA-DIRPART2-BDLDIR                HGO0021                     BDLDIR      1736
  6282               ADD 10 TO CALIFICA-DIR-BDLDIR                      HGO0021                     BDLDIR      1737
  6283              ELSE                                                HGO0021                     BDLDIR      1738
  6284               IF TIP-NVA-DIR-BDLDIR(2) = "N"                     HGO0021                     BDLDIR      1739
  6285                  MOVE 10 TO CALIFICA-DIRPART2-BDLDIR             HGO0021                     BDLDIR      1740
  6286                  ADD 10 TO CALIFICA-DIR-BDLDIR                   HGO0021                     BDLDIR      1741
  6287               ELSE                                               HGO0021                     BDLDIR      1742
  6288                  MOVE 8 TO CALIFICA-DIRPART2-BDLDIR              HGO0021                     BDLDIR      1743
  6289               END-IF                                             HGO0021                     BDLDIR      1744
  6290              END-IF                                              HGO0021                     BDLDIR      1745
  6291           ELSE                                                   RMB0010                     BDLDIR      1746
  6292              IF TIP-NVA-DIR-BDLDIR(JJ-STA-BDLDIR) = "N"          RMB0010                     BDLDIR      1747
  6293                 ADD 1 TO CAMPOS-N-DIR-BDLDIR                     RMB0010                     BDLDIR      1748
  6294              END-IF                                              RMB0010                     BDLDIR      1749
  6295           END-IF                                                 RMB0010                     BDLDIR      1750
  6296*                                                                                             BDLDIR      1751
  6297           STRING DIRECCION-ESTANDARIZADA-BDLDIR DELIMITED BY "  "RMB0010                     BDLDIR      1752
  6298                  " "                     DELIMITED BY SIZE       RMB0010                     BDLDIR      1753
  6299                 NVA-DIR-BDLDIR (JJ-STA-BDLDIR) DELIMITED BY "  " FARF026                     BDLDIR      1754
  6300*                  NVA-DIR-BDLDIR (JJ-STA-BDLDIR) DELIMITED BY " " RMB0010                    BDLDIR      1755
  6301               INTO DIRECCION-ESTANDARIZADA-BDLDIR                RMB0010                     BDLDIR      1756
  6302           END-STRING                                             RMB0010                     BDLDIR      1757
  6303           ADD 1 TO JJ-STA-BDLDIR                                 RMB0010                     BDLDIR      1758
  6304        END-PERFORM                                               RMB0010                     BDLDIR      1759
  6305        IF CAMPOS-N-DIR-BDLDIR > 1                                RMB0010                     BDLDIR      1760
  6306           ADD 10 TO CALIFICA-DIR-BDLDIR                          RMB0010                     BDLDIR      1761
  6307        END-IF                                                    RMB0010                     BDLDIR      1762
  6308        IF DIRECCION-ESTANDARIZADA-BDLDIR <> SPACES               RMB0010                     BDLDIR      1763
  6309           IF POLITICA-EXC-MAL-DIR-BDLDIR = 1                     RMB0010                     BDLDIR      1764
  6310              PERFORM 6140-ELIMINAR-DIR-MALAS                     RMB0010                     BDLDIR      1765
  6311           END-IF                                                 RMB0010                     BDLDIR      1766
  6312           IF CALIFICA-DIR-BDLDIR > POLITICA-EXC-CAL-DIR-BDLDIR   RMB0010                     BDLDIR      1767
  6313              PERFORM 6120-EVALUAR-ADICION-PUNTOS                 RMB0010                     BDLDIR      1768
  6314           END-IF                                                 RMB0010                     BDLDIR      1769
  6315        ELSE                                                      RMB0010                     BDLDIR      1770
  6316           MOVE 0 TO CALIFICA-DIR-BDLDIR                          RMB0010                     BDLDIR      1771
  6317        END-IF                                                    RMB0010                     BDLDIR      1772
  6318     ELSE                                                         RMB0010                     BDLDIR      1773
  6319        MOVE 0 TO CALIFICA-DIR-BDLDIR                             RMB0010                     BDLDIR      1774
  6320     END-IF.                                                      RMB0010                     BDLDIR      1775
  6321                                                                                              BDLDIR      1776
  6322 6110-ESTANDARIZAR-PART.                                                                      BDLDIR      1777
  6323******************************************************************                            BDLDIR      1778
  6324*6110-ESTANDARIZAR-PART.                                         *                            BDLDIR      1779
  6325*    LA PARTICULA A ESTANDARIZAR SE BUSCA EN LA TABLA DE         *                            BDLDIR      1780
  6326*    ESTANDARIZACION DE DIRECCIONES Y ES REEMPLAZADA, SI ES QUE  *                            BDLDIR      1781
  6327*    SE ENCUENTRA                                                *                            BDLDIR      1782
  6328******************************************************************                            BDLDIR      1783
  6329     MOVE 0 TO ENC-DIREST-BDLDIR                                  RMB0010                     BDLDIR      1784
  6330     SEARCH ALL TABLA-DIR-ESTANDAR-BDLDIR                         RMB0010                     BDLDIR      1785
  6331        AT END                                                                                BDLDIR      1786
  6332           MOVE 1 TO ENC-DIREST-BDLDIR                            RMB0010                     BDLDIR      1787
  6333        WHEN DIR-ORIGINAL-BDLDIR (I-DIR-ESTANDAR-BDLDIR) =        RMB0010                     BDLDIR      1788
  6334             PART-A-ESTANDARIZAR-BDLDIR                           RMB0010                     BDLDIR      1789
  6335           SET JJ-STA-BDLDIR TO I-DIR-ESTANDAR-BDLDIR             RMB0010                     BDLDIR      1790
  6336           MOVE DIR-ESTANDAR-BDLDIR (JJ-STA-BDLDIR)               RMB0010                     BDLDIR      1791
  6337                TO PART-ESTANDARIZADA-BDLDIR                      RMB0010                     BDLDIR      1792
  6338     END-SEARCH                                                                               BDLDIR      1793
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 111
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6339     IF ENC-DIREST-BDLDIR = 1                                     RMB0010                     BDLDIR      1794
  6340        MOVE PART-A-ESTANDARIZAR-BDLDIR                           RMB0010                     BDLDIR      1795
  6341             TO PART-ESTANDARIZADA-BDLDIR                         RMB0010                     BDLDIR      1796
  6342     END-IF.                                                                                  BDLDIR      1797
  6343                                                                                              BDLDIR      1798
  6344 6130-FILTRO-INICIAL.                                             RMB0010                     BDLDIR      1799
  6345     MOVE 0 TO CASO-NUMEROLETRA-BDLDIR                            RMB0010                     BDLDIR      1800
  6346     MOVE 1 TO M-BDLDIR                                           RMB0010                     BDLDIR      1801
  6347     PERFORM UNTIL M-BDLDIR > 58 OR                               RMB0010                     BDLDIR      1802
  6348       (DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR:1) <> SPACES AND RMB0010                     BDLDIR      1803
  6349        DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR:1) NOT NUMERIC)  RMB0010                     BDLDIR      1804
  6350       ADD 1 TO M-BDLDIR                                          RMB0010                     BDLDIR      1805
  6351     END-PERFORM.                                                 RMB0010                     BDLDIR      1806
  6352     IF M-BDLDIR > 1 AND < 58                                     RMB0010                     BDLDIR      1807
  6353        IF DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR - 1:1) NUMERICRMB0010                     BDLDIR      1808
  6354           MOVE 1 TO CASO-NUMEROLETRA-BDLDIR                      RMB0010                     BDLDIR      1809
  6355        END-IF                                                    RMB0010                     BDLDIR      1810
  6356     END-IF                                                       RMB0010                     BDLDIR      1811
  6357     MOVE 1 TO M-BDLDIR                                           RMB0010                     BDLDIR      1812
  6358     MOVE DIRECCION-A-ESTANDARIZAR-BDLDIR TO DIRECCION-60-BDLDIR  RMB0010                     BDLDIR      1813
  6359*    PERFORM UNTIL M-BDLDIR > 89 OR                               RMB0010                     BDLDIR      1814
  6360     PERFORM UNTIL M-BDLDIR > 499 OR                              PJV0024                     BDLDIR      1815
  6361                   DIR-COMPUESTAS-AST-BDLDIR (M-BDLDIR) = SPACES  RMB0010                     BDLDIR      1816
  6362        IF DIR-COMPUESTAS-TIP-BDLDIR (M-BDLDIR) = 0 OR            RMB0010                     BDLDIR      1817
  6363          (DIR-COMPUESTAS-TIP-BDLDIR (M-BDLDIR) = 1 AND           RMB0010                     BDLDIR      1818
  6364           CASO-NUMEROLETRA-BDLDIR = 1)                           RMB0010                     BDLDIR      1819
  6365           MOVE DIR-COMPUESTAS-LON-BDLDIR(M-BDLDIR) TO N-BDLDIR   RMB0010                     BDLDIR      1820
  6366           INITIALIZE DIR-COMPUESTAS-BLN-AUX-BDLDIR               RMB0010                     BDLDIR      1821
  6367                      DIR-COMPUESTAS-AST-AUX-BDLDIR               RMB0010                     BDLDIR      1822
  6368           MOVE DIR-COMPUESTAS-BLN-BDLDIR(M-BDLDIR)(1:N-BDLDIR) TORMB0010                     BDLDIR      1823
  6369                DIR-COMPUESTAS-BLN-AUX-BDLDIR(2:N-BDLDIR)         RMB0010                     BDLDIR      1824
  6370           MOVE DIR-COMPUESTAS-AST-BDLDIR(M-BDLDIR)(1:N-BDLDIR) TORMB0010                     BDLDIR      1825
  6371                DIR-COMPUESTAS-AST-AUX-BDLDIR(2:N-BDLDIR)         RMB0010                     BDLDIR      1826
  6372           ADD 2 TO N-BDLDIR                                      RMB0010                     BDLDIR      1827
  6373           INSPECT DIRECCION-62-BDLDIR  REPLACING ALL             RMB0010                     BDLDIR      1828
  6374                   DIR-COMPUESTAS-BLN-AUX-BDLDIR(1:N-BDLDIR) BY   RMB0010                     BDLDIR      1829
  6375                   DIR-COMPUESTAS-AST-AUX-BDLDIR(1:N-BDLDIR)      RMB0010                     BDLDIR      1830
  6376        END-IF                                                    RMB0010                     BDLDIR      1831
  6377        ADD 1 TO M-BDLDIR                                         RMB0010                     BDLDIR      1832
  6378     END-PERFORM.                                                 RMB0010                     BDLDIR      1833
  6379     MOVE DIRECCION-60-BDLDIR TO DIRECCION-A-ESTANDARIZAR-BDLDIR  RMB0010                     BDLDIR      1834
  6380     MOVE 1 TO M-BDLDIR                                           RMB0010                     BDLDIR      1835
  6381     PERFORM UNTIL M-BDLDIR > 58 OR    *>MEJORA                   RMB0010                     BDLDIR      1836
  6382             DIRECCION-A-ESTANDARIZAR-BDLDIR(M-BDLDIR:1) <> SPACESRMB0010                     BDLDIR      1837
  6383       ADD 1 TO M-BDLDIR                                          RMB0010                     BDLDIR      1838
  6384     END-PERFORM.                                                 RMB0010                     BDLDIR      1839
  6385     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "C "       RMB0010                     BDLDIR      1840
  6386***     CALLE                                                     RMB0010                     BDLDIR      1841
  6387        MOVE "! " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010                     BDLDIR      1842
  6388     END-IF                                                       RMB0010                     BDLDIR      1843
  6389     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "K "       RMB0010                     BDLDIR      1844
  6390***     CARRERA                                                   RMB0010                     BDLDIR      1845
  6391        MOVE "# " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010                     BDLDIR      1846
  6392     END-IF.                                                      RMB0010                     BDLDIR      1847
  6393     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "B "       RMB0010                     BDLDIR      1848
  6394***     BARRIO                                                    RMB0010                     BDLDIR      1849
  6395        MOVE "$ " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010                     BDLDIR      1850
  6396     END-IF.                                                      RMB0010                     BDLDIR      1851
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 112
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6397     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "D "       RMB0010                     BDLDIR      1852
  6398***     DIAGONAL                                                  RMB0010                     BDLDIR      1853
  6399        MOVE "% " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010                     BDLDIR      1854
  6400     END-IF.                                                      RMB0010                     BDLDIR      1855
  6401     IF DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) = "T "       RMB0010                     BDLDIR      1856
  6402***     TRANSVERSAL                                               RMB0010                     BDLDIR      1857
  6403        MOVE "& " TO DIRECCION-A-ESTANDARIZAR-BDLDIR (M-BDLDIR:2) RMB0010                     BDLDIR      1858
  6404     END-IF.                                                      RMB0010                     BDLDIR      1859
  6405                                                                                              BDLDIR      1860
  6406 6120-EVALUAR-ADICION-PUNTOS.                                     RMB0010                     BDLDIR      1861
  6407******************************************************************RMB0010                     BDLDIR      1862
  6408*6120-EVALUAR-ADICION-PUNTOS.                                    *RMB0010                     BDLDIR      1863
  6409*    ESTA PARTE DE LA RUTINA DETERMINA POR UN LADO SI LA         *RMB0010                     BDLDIR      1864
  6410*    DIRECCION ES CERTIFICADA (CASO EN EL CUAL ADICIONA 50 A LA  *RMB0010                     BDLDIR      1865
  6411*    CALIFICACION DEFINITIVA) O SI TIENE PUNTOS ADICIONALES POR  *RMB0010                     BDLDIR      1866
  6412*    GEOREFERENCIACION (10 PUNTOS ADICIONALES)                   *RMB0010                     BDLDIR      1867
  6413******************************************************************RMB0010                     BDLDIR      1868
  6414     IF DIRCER-BDLDIR = 1                                         RMB0010                     BDLDIR      1869
  6415***     DIRECCION CERTIFICADA EXITOSAMENTE                        RMB0010                     BDLDIR      1870
  6416        ADD 50 TO CALIFICA-DIR-BDLDIR                             RMB0010                     BDLDIR      1871
  6417     END-IF                                                       RMB0010                     BDLDIR      1872
  6418     IF PTSADI-BDLDIR = 1                                         RMB0010                     BDLDIR      1873
  6419***     DIRECCION GEOREFERENCIADA EXITOSAMENTE                    RMB0010                     BDLDIR      1874
  6420        ADD 10 TO CALIFICA-DIR-BDLDIR                             RMB0010                     BDLDIR      1875
  6421     END-IF.                                                      RMB0010                     BDLDIR      1876
  6422                                                                                              BDLDIR      1877
  6423 6140-ELIMINAR-DIR-MALAS.                                         RMB0010                     BDLDIR      1878
  6424******************************************************************RMB0010                     BDLDIR      1879
  6425*6140-ELIMINAR-DIR-MALAS.                                        *RMB0010                     BDLDIR      1880
  6426*    SE CALIFICAN CON 0 DIRECCIONES MALAS                        *RMB0010                     BDLDIR      1881
  6427******************************************************************RMB0010                     BDLDIR      1882
  6428     MOVE CALIFICA-DIR-BDLDIR TO CALIFICA-REAL-BDLDIR             RMB0010                     BDLDIR      1883
  6429     MOVE DIRECCION-ESTANDARIZADA-BDLDIR TO DIRECCION-AUX-BDLDIR  RMB0010                     BDLDIR      1884
  6430*RCNCER     INSPECT DIRECCION-AUX-BDLDIR REPLACING ALL " " BY "0" HGO0021                     BDLDIR      1885
  6431*RCNCER     IF DIRECCION-AUX-BDLDIR NUMERIC                       HGO0021                     BDLDIR      1886
  6432*RCNCER        MOVE 0 TO CALIFICA-DIR-BDLDIR                      HGO0021                     BDLDIR      1887
  6433*RCNCER     END-IF.                                               HGO0021                     BDLDIR      1888
  6434****                                                              RMB0010                     BDLDIR      1889
  6435     IF CALIFICA-DIR-BDLDIR > 0                                   RMB0010                     BDLDIR      1890
  6436        MOVE 1 TO M-BDLDIR                                        RMB0010                     BDLDIR      1891
  6437        MOVE 0 TO N-BDLDIR                                        RMB0010                     BDLDIR      1892
  6438        PERFORM UNTIL M-BDLDIR > 60                               RMB0010                     BDLDIR      1893
  6439          IF DIRECCION-ESTANDARIZADA-BDLDIR(M-BDLDIR:1) <> SPACES RMB0010                     BDLDIR      1894
  6440             ADD 1 TO N-BDLDIR                                    RMB0010                     BDLDIR      1895
  6441          END-IF                                                  RMB0010                     BDLDIR      1896
  6442          ADD 1 TO M-BDLDIR                                       RMB0010                     BDLDIR      1897
  6443        END-PERFORM                                               RMB0010                     BDLDIR      1898
  6444        IF N-BDLDIR < 6                                           RMB0010                     BDLDIR      1899
  6445           IF CALIFICA-DIR-BDLDIR < 25                            RMB0010                     BDLDIR      1900
  6446              MOVE 0 TO CALIFICA-DIR-BDLDIR                       RMB0010                     BDLDIR      1901
  6447           END-IF                                                 RMB0010                     BDLDIR      1902
  6448        END-IF                                                    RMB0010                     BDLDIR      1903
  6449     END-IF.                                                      RMB0010                     BDLDIR      1904
  6450*****                                                             RMB0010                     BDLDIR      1905
  6451*RCNCER     IF CALIFICA-DIR-BDLDIR > 0                            HGO0021                     BDLDIR      1906
  6452*RCNCER        MOVE 0 TO M-BDLDIR                                 HGO0021                     BDLDIR      1907
  6453*RCNCER        INSPECT TIP-NUEVA-DIRECCION-BDLDIR  TALLYING M-BDLDHGO0021                     BDLDIR      1908
  6454*RCNCER                FOR ALL "S"                                HGO0021                     BDLDIR      1909
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 113
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6455*RCNCER        IF M-BDLDIR = 0 AND CALIFICA-DIR-BDLDIR < 25   *> MHGO0021                     BDLDIR      1910
  6456*RCNCER           MOVE 0 TO CALIFICA-DIR-BDLDIR                   HGO0021                     BDLDIR      1911
  6457*RCNCER        END-IF                                             HGO0021                     BDLDIR      1912
  6458*RCNCER     END-IF.                                               HGO0021                     BDLDIR      1913
  6459                                                                                              BDLDIR      1914
  6460 2000-U-VALIDAR-ACCDIR.                                           RMB0003                     BDLDIR      1915
  6461******************************************************************                            BDLDIR      1916
  6462* RUTINA CREADA PARA MANEJAR LOS ALGORITMOS DE NOMBRES. HAY VARIAS                            BDLDIR      1917
  6463* RUTINAS QUE MANEJAN LO NECESARIO PARA ESTANDARIZAR Y ORDENAR.                               BDLDIR      1918
  6464* ENTRADAS                                                                                    BDLDIR      1919
  6465*         ABIERTO EL ICBSUS                                                                   BDLDIR      1920
  6466*         ABIERTO EL BDLCI                                                                    BDLDIR      1921
  6467*         ABIERTO EL ICMCRE                                                                   BDLDIR      1922
  6468*         ABIERTO EL ICMCHK                                                                   BDLDIR      1923
  6469*         LLAVE-DIRECC     LLAVE NORMAL DEL ARCHIVO DE DIRECCIONES                            BDLDIR      1924
  6470*         PRIVILEGIO-INPUT VALOR DE PRIVILEGIO-BDLCI DEL CONSULTANTE                          BDLDIR      1925
  6471*         NIT-CONSULTANTE-INPUT                                                               BDLDIR      1926
  6472* SALIDAS                                                                                     BDLDIR      1927
  6473*         VALIDACION-DIR-OUT 0: NO TOMAR EL REGISTRO,1 SI TOMARLO                             BDLDIR      1928
  6474*******************************************************************                           BDLDIR      1929
  6475     MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR.                         RMB0010                     BDLDIR      1930
  6476     MOVE COD-SUS-DIRECC TO COD-SUSCRIP-ABD02.                    RMB0003                     BDLDIR      1931
  6477     READ SUSCRIPTOR IGNORE LOCK                                  RMB0003                     BDLDIR      1932
  6478        INVALID KEY                                               RMB0003                     BDLDIR      1933
  6479           MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR                    RMB0010                     BDLDIR      1934
  6480        NOT INVALID KEY                                           RMB0003                     BDLDIR      1935
  6481           MOVE NIT-SUSCRIP-S-ABD02 TO NIT-ID-BDLCLI              RMB0007                     BDLDIR      1936
  6482           READ BDLCLI IGNORE LOCK                                RMB0007                     BDLDIR      1937
  6483                INVALID KEY MOVE 0 TO INDICADOR-BDLCLI            RMB0007                     BDLDIR      1938
  6484                            MOVE " " TO VALIDAR-DB-BDLCLI         RMB0007                     BDLDIR      1939
  6485                            MOVE " " TO IND-BLOQUEO-INF-BDLCLI    RMB0026                     BDLDIR      1940
  6486           END-READ                                               RMB0007                     BDLDIR      1941
  6487           IF PRIVILEGIO-INPUT-BDLDIR = 2                         RMB0010                     BDLDIR      1942
  6488              MOVE 1 TO INDICADOR-BDLCLI                          RMB0007                     BDLDIR      1943
  6489           END-IF                                                 RMB0007                     BDLDIR      1944
  6490           IF INDICADOR-BDLCLI = 1                                RMB0007                     BDLDIR      1945
  6491              AND IND-BLOQUEO-INF-BDLCLI <> "B"                   RMB0026                     BDLDIR      1946
  6492              IF VALIDAR-DB-BDLCLI = "N"                          RMB0007                     BDLDIR      1947
  6493                 MOVE 1 TO VALIDACION-DIR-OUT-BDLDIR              RMB0010                     BDLDIR      1948
  6494              ELSE                                                RMB0007                     BDLDIR      1949
  6495                 MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR              RMB0010                     BDLDIR      1950
  6496                 PERFORM 2100-U-VALIDAR-MAESTROS                  RMB0007                     BDLDIR      1951
  6497              END-IF                                              RMB0007                     BDLDIR      1952
  6498           END-IF                                                 RMB0007                     BDLDIR      1953
  6499     END-READ.                                                    RMB0003                     BDLDIR      1954
  6500 2100-U-VALIDAR-MAESTROS.                                         RMB0003                     BDLDIR      1955
  6501******************************************************************                            BDLDIR      1956
  6502*4110-VALIDAR-MAESTROS.                                                                       BDLDIR      1957
  6503*    SE VALIDA CONTRA LOS MAESTROS DE CARTERA Y CUENTAS CORRIENTE*                            BDLDIR      1958
  6504*    SI LA CUENTA EXISTE EN ELLOS                                *                            BDLDIR      1959
  6505******************************************************************                            BDLDIR      1960
  6506*    MOVE LLAVE-DIRECC TO LLAVE-MAES-CREDIT LLAVE-MAES-CHECK.     FAC0009                     BDLDIR      1961
  6507     MOVE TIPO-ID-DIRECC TO TIPO-ID-ABD07 TIPO-ID-ABD06           FAC0009                     BDLDIR      1962
  6508     MOVE NUM-ID-DIRECC  TO NUM-ID-ABD07  NUM-ID-ABD06            FAC0009                     BDLDIR      1963
  6509     MOVE COD-SUS-DIRECC TO COD-SUS-ABD07 COD-SUS-ABD06           FAC0009                     BDLDIR      1964
  6510     MOVE COD-CTA-DIRECC TO COD-CTA-ABD07 COD-CTA-ABD06           FAC0009                     BDLDIR      1965
  6511     MOVE NUM-CTA-DIRECC TO NUM-CTA-ABD07 NUM-CTA-ABD06           FAC0009                     BDLDIR      1966
  6512     IF ESTADO-ABD02 = 1                                          RMB0003                     BDLDIR      1967
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 114
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6513        IF COD-CTA-DIRECC = 1                                     RMB0003                     BDLDIR      1968
  6514           READ MAESTRO-CHECK WITH IGNORE LOCK   INVALID KEY      DLM0013                     BDLDIR      1969
  6515                MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR               RMB0010                     BDLDIR      1970
  6516                NOT INVALID KEY                                   RMB0003                     BDLDIR      1971
  6517                    $IF HACERMATCH = "SI"                         RMB0013                     BDLDIR      1972
  6518X                   PERFORM 8000-U-VER-CTAABD06-BDAMATCH          RMB0013                     BDLDIR      1973
  6519                    $END                                          RMB0013                     BDLDIR      1974
  6520                    PERFORM 2590-VER-ESTADO-CTA                   RMB0028                     BDLDIR      1975
  6521                    IF IND-BLOQUEO-ABD06 = 0                      RMB0003                     BDLDIR      1976
  6522                       MOVE 1 TO VALIDACION-DIR-OUT-BDLDIR        RMB0010                     BDLDIR      1977
  6523                    END-IF                                        RMB0003                     BDLDIR      1978
  6524           END-READ                                               RMB0003                     BDLDIR      1979
  6525        ELSE                                                      RMB0003                     BDLDIR      1980
  6526           READ MAESTRO-CREDIT  WITH IGNORE LOCK  INVALID KEY     DLM0013                     BDLDIR      1981
  6527                MOVE 0 TO VALIDACION-DIR-OUT-BDLDIR               RMB0010                     BDLDIR      1982
  6528                NOT INVALID KEY                                   RMB0003                     BDLDIR      1983
  6529                    $IF HACERMATCH = "SI"                         RMB0013                     BDLDIR      1984
  6530X                   PERFORM 8000-U-VER-CTAABD07-BDAMATCH          RMB0013                     BDLDIR      1985
  6531                    $END                                          RMB0013                     BDLDIR      1986
  6532                    PERFORM 2590-VER-ESTADO-CTA                   RMB0028                     BDLDIR      1987
  6533                    IF IND-BLOQUEO-ABD07 = 0                      RMB0003                     BDLDIR      1988
  6534                       MOVE 1 TO VALIDACION-DIR-OUT-BDLDIR        RMB0010                     BDLDIR      1989
  6535                    END-IF                                        RMB0003                     BDLDIR      1990
  6536           END-READ                                               RMB0003                     BDLDIR      1991
  6537        END-IF                                                    RMB0003                     BDLDIR      1992
  6538     END-IF.                                                      RMB0003                     BDLDIR      1993
  6539*                                                                                             BDLDIR      1994
  6540******************************************************************                            BDLDIR      1995
  6541* 2590-VER-ESTADO-CTA                                            *                            BDLDIR      1996
  6542*    SI LA CUENTA PADRE ESTA CERRADA SE CAMBIAN LAS FECHAS A LA  *                            BDLDIR      1997
  6543*    FECHA DE CIERRE SI ESTA ES MENOR A LA REPORTADA EN LA       *                            BDLDIR      1998
  6544*    DIRECCION.                                                  *                            BDLDIR      1999
  6545******************************************************************                            BDLDIR      2000
  6546*                                                                                             BDLDIR      2001
  6547 2590-VER-ESTADO-CTA.                                             RMB0028                     BDLDIR      2002
  6548     MOVE 0 TO CTA-ACTIVA.                                        RMB0028                     BDLDIR      2003
  6549     IF COD-CTA-DIRECC = 1                                        RMB0028                     BDLDIR      2004
  6550        IF NOV-REPORT-ABD06 = 01 OR 06 OR 07                      RMB0028                     BDLDIR      2005
  6551           MOVE 1 TO CTA-ACTIVA                                   RMB0028                     BDLDIR      2006
  6552        ELSE                                                      RMB0028                     BDLDIR      2007
  6553           MOVE FEC-NOVEDAD-ABD06 TO FEC-MMAA-BDLDI2              RMB0028                     BDLDIR      2008
  6554        END-IF                                                    RMB0028                     BDLDIR      2009
  6555     ELSE                                                         RMB0028                     BDLDIR      2010
  6556        IF NOV-REPORT-ABD07 = 01 OR 45 OR 47 OR                   RMB0028                     BDLDIR      2011
  6557           (NOV-REPORT-ABD07 >= 13 AND NOV-REPORT-ABD07 <= 41)    RMB0028                     BDLDIR      2012
  6558           MOVE 1 TO CTA-ACTIVA                                   RMB0028                     BDLDIR      2013
  6559        ELSE                                                      RMB0028                     BDLDIR      2014
  6560           MOVE FEC-NOVEDAD-ABD07 TO FEC-MMAA-BDLDI2              RMB0028                     BDLDIR      2015
  6561        END-IF                                                    RMB0028                     BDLDIR      2016
  6562     END-IF.                                                      RMB0028                     BDLDIR      2017
  6563*                                                                                             BDLDIR      2018
  6564     IF CTA-ACTIVA = 0                                            RMB0028                     BDLDIR      2019
  6565*       SE CONVIERTE AL MILENIO PARA LA COMPARACION                                           BDLDIR      2020
  6566        MOVE FEC-MMAA-BDLDI2(1:2) TO FEC-AAAAMM-BDLDI2(5:2)       RMB0028                     BDLDIR      2021
  6567        MOVE FEC-MMAA-BDLDI2(3:2) TO FEC-AAAAMM-BDLDI2(3:2)       RMB0028                     BDLDIR      2022
  6568        IF FEC-MMAA-BDLDI2(3:2) < "50"                            RMB0028                     BDLDIR      2023
  6569           MOVE "20"   TO FEC-AAAAMM-BDLDI2(1:2)                  RMB0028                     BDLDIR      2024
  6570        ELSE                                                      RMB0028                     BDLDIR      2025
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 115
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6571           MOVE "19"   TO FEC-AAAAMM-BDLDI2(1:2)                  RMB0028                     BDLDIR      2026
  6572        END-IF                                                    RMB0028                     BDLDIR      2027
  6573*                                                                                             BDLDIR      2028
  6574        IF FEC-AAAAMM-BDLDI2 < FECRES-DIRECC                      RMB0028                     BDLDIR      2029
  6575           MOVE FEC-AAAAMM-BDLDI2 TO FECRES-DIRECC                RMB0028                     BDLDIR      2030
  6576        END-IF                                                    RMB0028                     BDLDIR      2031
  6577*                                                                                             BDLDIR      2032
  6578        IF FEC-AAAAMM-BDLDI2 < FECLAB-DIRECC                      RMB0028                     BDLDIR      2033
  6579           MOVE FEC-AAAAMM-BDLDI2 TO FECLAB-DIRECC                RMB0028                     BDLDIR      2034
  6580        END-IF                                                    RMB0028                     BDLDIR      2035
  6581*                                                                                             BDLDIR      2036
  6582        IF FEC-AAAAMM-BDLDI2 < FECCOR-DIRECC                      RMB0028                     BDLDIR      2037
  6583           MOVE FEC-AAAAMM-BDLDI2 TO FECCOR-DIRECC                RMB0028                     BDLDIR      2038
  6584        END-IF                                                    RMB0028                     BDLDIR      2039
  6585*                                                                                             BDLDIR      2040
  6586        IF FEC-AAAAMM-BDLDI2 < FECCEL-DIRECC                      RMB0028                     BDLDIR      2041
  6587           MOVE FEC-AAAAMM-BDLDI2 TO FECCEL-DIRECC                RMB0028                     BDLDIR      2042
  6588        END-IF                                                    RMB0028                     BDLDIR      2043
  6589*                                                                                             BDLDIR      2044
  6590        IF FEC-AAAAMM-BDLDI2 < FECTRES-DIRECC                     RMB0028                     BDLDIR      2045
  6591           MOVE FEC-AAAAMM-BDLDI2 TO FECTRES-DIRECC               RMB0028                     BDLDIR      2046
  6592        END-IF                                                    RMB0028                     BDLDIR      2047
  6593*                                                                                             BDLDIR      2048
  6594        IF FEC-AAAAMM-BDLDI2 < FECTLAB-DIRECC                     RMB0028                     BDLDIR      2049
  6595           MOVE FEC-AAAAMM-BDLDI2 TO FECTLAB-DIRECC               RMB0028                     BDLDIR      2050
  6596        END-IF                                                    RMB0028                     BDLDIR      2051
  6597*                                                                                             BDLDIR      2052
  6598        IF FEC-AAAAMM-BDLDI2 < FECMAIL-DIRECC                     RMB0028                     BDLDIR      2053
  6599           MOVE FEC-AAAAMM-BDLDI2 TO FECMAIL-DIRECC               RMB0028                     BDLDIR      2054
  6600        END-IF                                                    RMB0028                     BDLDIR      2055
  6601     END-IF.                                                      RMB0028                     BDLDIR      2056
  6602*                                                                                             BDLDIR      2057
  6603 2590-NVA-DIRECC-BOGOTA.                                          GJC0011                     BDLDIR      2058
  6604******************************************************************                            BDLDIR      2059
  6605*2590-NVA-DIRECC-BOGOTA                                                                       BDLDIR      2060
  6606*    SI LA DIRECCION ES DE BOGOTA, BUSCA SI ESTA TIENE NUEVA NO- *                            BDLDIR      2061
  6607*    MENCLATURA                                                  *                            BDLDIR      2062
  6608******************************************************************                            BDLDIR      2063
  6609        IF CIUDAD-BTA-BDLDIR(1:5)  = "BOGOT"                      GJC0011                     BDLDIR      2064
  6610           MOVE DIRECCION-BTA-BDLDIR TO T-CARMEJ-BDLDIR           GJC0011                     BDLDIR      2065
  6611           PERFORM 1200-CALCULAR-LLAVE                            GJC0011                     BDLDIR      2066
  6612*          MOVE V-HASDIRFIN-BDLDIR (I-BDLDIR) TO                  RMB0012                     BDLDIR      2067
  6613*               LLAVE-BDLNEWDIRBOG                                RMB0012                     BDLDIR      2068
  6614           PERFORM 8400-EXAMINE-BDLNEWDIRBOG                      GJC0011                     BDLDIR      2069
  6615        ELSE                                                      GJC0011                     BDLDIR      2070
  6616           MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIR                      GJC0011                     BDLDIR      2071
  6617        END-IF.                                                   GJC0011                     BDLDIR      2072
  6618                                                                                              BDLDIR      2073
  6619 1200-CALCULAR-LLAVE.                                             GJC0011                     BDLDIR      2074
  6620*********************************************************************                         BDLDIR      2075
  6621* 1200-CALCULAR-LLAVE.                                                                        BDLDIR      2076
  6622* SE PROCEDE A CLACULAR LA LLAVE DEL ARCHIVO DE NUEVA NOMENCLATURA                            BDLDIR      2077
  6623* DE BOGOTA, LA CUAL SE COMPONE:                                                              BDLDIR      2078
  6624*      1: SIGLA DE LA "AVENIDA" (2 CARACTERES)                                                BDLDIR      2079
  6625*      2: NUMEROS ORDENADOS     (5 CARACTERES 7 NUMEROS)                                      BDLDIR      2080
  6626*      3: NUMEROS ORIGINALES    (5 CARACTERES 3 NUMEROS) ADICIONANDO                          BDLDIR      2081
  6627*         LOS VALORES ASCII POR POSICION A ESTOS                                              BDLDIR      2082
  6628*********************************************************************                         BDLDIR      2083
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 116
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6629     MOVE 1 TO I-MEJ-BDLDIR.                                      GJC0011                     BDLDIR      2084
  6630     MOVE 1 TO K-MEJ-BDLDIR.                                      GJC0011                     BDLDIR      2085
  6631     MOVE 0 TO J-MEJ-BDLDIR.                                      GJC0011                     BDLDIR      2086
  6632     MOVE " " TO CAR-ANT-BDLDIR.                                  GJC0011                     BDLDIR      2087
  6633     INITIALIZE T-NUMMEJ-BDLDIR.                                  GJC0011                     BDLDIR      2088
  6634     PERFORM UNTIL I-MEJ-BDLDIR > 60 OR J-MEJ-BDLDIR >= 10        CAV0014                     BDLDIR      2089
  6635       IF V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) NUMERIC                   GJC0011                     BDLDIR      2090
  6636          MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO CAR-ACT-BDLDIR    GJC0011                     BDLDIR      2091
  6637          IF CAR-ANT-BDLDIR NUMERIC                               GJC0011                     BDLDIR      2092
  6638             COMPUTE V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR) =              GJC0011                     BDLDIR      2093
  6639                     V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR) * 10 +         GJC0011                     BDLDIR      2094
  6640                                       CAR-ACT-BDLDIR             GJC0011                     BDLDIR      2095
  6641          ELSE                                                    GJC0011                     BDLDIR      2096
  6642             ADD 1 TO J-MEJ-BDLDIR                                GJC0011                     BDLDIR      2097
  6643             MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO                GJC0011                     BDLDIR      2098
  6644                  V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR)                   GJC0011                     BDLDIR      2099
  6645          END-IF                                                  GJC0011                     BDLDIR      2100
  6646          MOVE "N"             TO V-LETRAS-BDLDIR(K-MEJ-BDLDIR)   GJC0011                     BDLDIR      2101
  6647          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011                     BDLDIR      2102
  6648          MOVE "U"             TO V-LETRAS-BDLDIR(K-MEJ-BDLDIR)   GJC0011                     BDLDIR      2103
  6649          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011                     BDLDIR      2104
  6650          MOVE " "             TO V-LETRAS-BDLDIR(K-MEJ-BDLDIR)   GJC0011                     BDLDIR      2105
  6651          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011                     BDLDIR      2106
  6652       ELSE                                                       GJC0011                     BDLDIR      2107
  6653          MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO                   GJC0011                     BDLDIR      2108
  6654               V-LETRAS-BDLDIR(K-MEJ-BDLDIR)                      GJC0011                     BDLDIR      2109
  6655          ADD 1 TO K-MEJ-BDLDIR                                   GJC0011                     BDLDIR      2110
  6656       END-IF                                                     GJC0011                     BDLDIR      2111
  6657       MOVE V-CARMEJ-BDLDIR(I-MEJ-BDLDIR) TO CAR-ANT-BDLDIR       GJC0011                     BDLDIR      2112
  6658       ADD 1 TO I-MEJ-BDLDIR                                      GJC0011                     BDLDIR      2113
  6659     END-PERFORM.                                                 GJC0011                     BDLDIR      2114
  6660     MOVE V-NUMMEJ-BDLDIR(01) TO NN8-BDLDIR                       GJC0011                     BDLDIR      2115
  6661     MOVE V-NUMMEJ-BDLDIR(02) TO NN9-BDLDIR                       GJC0011                     BDLDIR      2116
  6662     MOVE V-NUMMEJ-BDLDIR(03) TO NN10-BDLDIR                      GJC0011                     BDLDIR      2117
  6663     SORT V-NUMMEJ-BDLDIR DESCENDING.                             GJC0011                     BDLDIR      2118
  6664     MOVE NN8-BDLDIR  TO  V-NUMMEJ-BDLDIR(08).                    GJC0011                     BDLDIR      2119
  6665     MOVE NN9-BDLDIR  TO  V-NUMMEJ-BDLDIR(09).                    GJC0011                     BDLDIR      2120
  6666     MOVE NN10-BDLDIR TO  V-NUMMEJ-BDLDIR(10).                    GJC0011                     BDLDIR      2121
  6667     INITIALIZE T-L-BDLDIR.                                       GJC0011                     BDLDIR      2122
  6668     UNSTRING T-LETRAS-BDLDIR DELIMITED BY ALL " " INTO           GJC0011                     BDLDIR      2123
  6669       L-BDLDIR(1)  L-BDLDIR(2)  L-BDLDIR(3)  L-BDLDIR(4)         GJC0011                     BDLDIR      2124
  6670       L-BDLDIR(5)  L-BDLDIR(6)  L-BDLDIR(7)  L-BDLDIR(8)         GJC0011                     BDLDIR      2125
  6671       L-BDLDIR(9)  L-BDLDIR(10) L-BDLDIR(11) L-BDLDIR(12)        GJC0011                     BDLDIR      2126
  6672       L-BDLDIR(13) L-BDLDIR(14) L-BDLDIR(15) L-BDLDIR(16)        GJC0011                     BDLDIR      2127
  6673       L-BDLDIR(17) L-BDLDIR(18) L-BDLDIR(19) L-BDLDIR(20)        GJC0011                     BDLDIR      2128
  6674       L-BDLDIR(21) L-BDLDIR(22) L-BDLDIR(23) L-BDLDIR(24)        GJC0011                     BDLDIR      2129
  6675       L-BDLDIR(25) L-BDLDIR(26) L-BDLDIR(27) L-BDLDIR(28)        GJC0011                     BDLDIR      2130
  6676       L-BDLDIR(29) L-BDLDIR(30)                                  GJC0011                     BDLDIR      2131
  6677     MOVE 2 TO I-MEJ-BDLDIR                                       GJC0011                     BDLDIR      2132
  6678     MOVE 8 TO J-MEJ-BDLDIR                                       GJC0011                     BDLDIR      2133
  6679     PERFORM UNTIL I-MEJ-BDLDIR > 30                              GJC0011                     BDLDIR      2134
  6680       IF J-MEJ-BDLDIR > 10                                       GJC0011                     BDLDIR      2135
  6681          MOVE 8 TO J-MEJ-BDLDIR                                  GJC0011                     BDLDIR      2136
  6682       END-IF                                                     GJC0011                     BDLDIR      2137
  6683       IF L-BDLDIR(I-MEJ-BDLDIR) <> SPACES                        GJC0011                     BDLDIR      2138
  6684          IF L-BDLDIR(I-MEJ-BDLDIR)(2:1) = " "                    GJC0011                     BDLDIR      2139
  6685             MOVE L-BDLDIR(I-MEJ-BDLDIR)(1:1) TO LETRA-BDLDIR     GJC0011                     BDLDIR      2140
  6686             MOVE FUNCTION ORD(LETRA-BDLDIR) TO ORDEN-ASCII-BDLDIRGJC0011                     BDLDIR      2141
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 117
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6687             COMPUTE ORDEN-ASCII-BDLDIR = ORDEN-ASCII-BDLDIR  *   GJC0011                     BDLDIR      2142
  6688                     I-MEJ-BDLDIR                                 GJC0011                     BDLDIR      2143
  6689             ADD ORDEN-ASCII-BDLDIR TO                            GJC0011                     BDLDIR      2144
  6690                 V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR)                    GJC0011                     BDLDIR      2145
  6691             ADD 1 TO J-MEJ-BDLDIR                                GJC0011                     BDLDIR      2146
  6692          ELSE                                                    GJC0011                     BDLDIR      2147
  6693             IF L-BDLDIR(I-MEJ-BDLDIR) = "BIS" OR "MJ"            GJC0011                     BDLDIR      2148
  6694                MOVE "W" TO LETRA-BDLDIR                          GJC0011                     BDLDIR      2149
  6695                MOVE FUNCTION ORD(LETRA-BDLDIR) TO                GJC0011                     BDLDIR      2150
  6696                     ORDEN-ASCII-BDLDIR                           GJC0011                     BDLDIR      2151
  6697                ADD ORDEN-ASCII-BDLDIR TO                         GJC0011                     BDLDIR      2152
  6698                    V-NUMMEJ-BDLDIR(J-MEJ-BDLDIR)                 GJC0011                     BDLDIR      2153
  6699                ADD 1 TO J-MEJ-BDLDIR                             GJC0011                     BDLDIR      2154
  6700             END-IF                                               GJC0011                     BDLDIR      2155
  6701          END-IF                                                  GJC0011                     BDLDIR      2156
  6702       END-IF                                                     GJC0011                     BDLDIR      2157
  6703       ADD 1 TO I-MEJ-BDLDIR                                      GJC0011                     BDLDIR      2158
  6704    END-PERFORM.                                                  GJC0011                     BDLDIR      2159
  6705 8400-EXAMINE-BDLNEWDIRBOG.                                       GJC0011                     BDLDIR      2160
  6706**************************************************************                                BDLDIR      2161
  6707*8400-EXAMINE-BDLNEWDIRBOG.                                                                   BDLDIR      2162
  6708* CON ESTA RUTINA SE DETERMINA SI UNA DIRECCION DE BOGOTA TIENE                               BDLDIR      2163
  6709* NUEVA NOMENCLATURA O NO.                                                                    BDLDIR      2164
  6710*************************************************************                                 BDLDIR      2165
  6711     IF OPEN-BDLNEWDIRBOG-BDLDIR = 0                              GJC0011                     BDLDIR      2166
  6712        MOVE 1 TO OPEN-BDLNEWDIRBOG-BDLDIR                        GJC0011                     BDLDIR      2167
  6713        OPEN INPUT BDLNEWDIRBOG                                   GJC0011                     BDLDIR      2168
  6714     END-IF.                                                      GJC0011                     BDLDIR      2169
  6715     MOVE T-NUMMEJ-BDLDIR TO NUMEROS-BDLNEWDIRBOG                 GJC0011                     BDLDIR      2170
  6716     IF L-BDLDIR(1) NOT = SPACES                                  GJC0011                     BDLDIR      2171
  6717        MOVE L-BDLDIR(1) TO AVENIDA-BDLNEWDIRBOG                  GJC0011                     BDLDIR      2172
  6718     ELSE                                                         GJC0011                     BDLDIR      2173
  6719        MOVE L-BDLDIR(2) TO AVENIDA-BDLNEWDIRBOG                  GJC0011                     BDLDIR      2174
  6720     END-IF.                                                      GJC0011                     BDLDIR      2175
  6721     READ BDLNEWDIRBOG                                            GJC0011                     BDLDIR      2176
  6722       INVALID KEY                                                GJC0011                     BDLDIR      2177
  6723           MOVE 0 TO HAY-BDLNEWDIRBOG-BDLDIR                      GJC0011                     BDLDIR      2178
  6724       NOT INVALID KEY                                            GJC0011                     BDLDIR      2179
  6725           MOVE 1 TO HAY-BDLNEWDIRBOG-BDLDIR                      GJC0011                     BDLDIR      2180
  6726     END-READ.                                                    GJC0011                     BDLDIR      2181
  6727*                                                                 CAV0027                     BDLDIR      2182
  6728 8500-VALIDAR-EMAIL-BDLDIR.                                       CAV0027                     BDLDIR      2183
  6729******************************************************************                            BDLDIR      2184
  6730*8500-VALIDAR-EMAIL-BDLDIR.                                                                   BDLDIR      2185
  6731*Se eleiman los espacios al inicio, debe existir un solo @, debe                              BDLDIR      2186
  6732*aparecer por lo menos un . despues de @ pero no enseguida,                                   BDLDIR      2187
  6733*Ni el primer ni ultimo caracter pueden ser . o @, no debe tener                              BDLDIR      2188
  6734*espacios intermedios                                                                         BDLDIR      2189
  6735******************************************************************                            BDLDIR      2190
  6736     INITIALIZE TMP-EMAIL-BDLDIR ERR-EMAIL-BDLDIR                 CAV0027                     BDLDIR      2191
  6737                CONT-ERR-BDLDIR CONT-ESP-INIC-BDLDIR              CAV0027                     BDLDIR      2192
  6738                CONT-ARO-BDLDIR CONT-PUN-BDLDIR LONG-EMIAL-BDLDIR CAV0027                     BDLDIR      2193
  6739     IF EMAIL-BDLDIR NOT = SPACE                                  CAV0027                     BDLDIR      2194
  6740        MOVE FUNCTION UPPER-CASE(EMAIL-BDLDIR) TO EMAIL-BDLDIR    CAV0027                     BDLDIR      2195
  6741     ELSE                                                         CAV0027                     BDLDIR      2196
  6742        MOVE 1 TO ERR-EMAIL-BDLDIR                                CAV0027                     BDLDIR      2197
  6743     END-IF                                                       CAV0027                     BDLDIR      2198
  6744     IF ERR-EMAIL-BDLDIR = 0                                      CAV0027                     BDLDIR      2199
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 118
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDLDIR.PRO
  6745        INSPECT EMAIL-BDLDIR TALLYING                             CAV0027                     BDLDIR      2200
  6746                CONT-ESP-INIC-BDLDIR FOR LEADING " "              CAV0027                     BDLDIR      2201
  6747        IF CONT-ESP-INIC-BDLDIR > 0 AND < 60                      CAV0027                     BDLDIR      2202
  6748           ADD 1 TO CONT-ESP-INIC-BDLDIR                          CAV0027                     BDLDIR      2203
  6749           MOVE EMAIL-BDLDIR(CONT-ESP-INIC-BDLDIR:) TO            CAV0027                     BDLDIR      2204
  6750                TMP-EMAIL-BDLDIR                                  CAV0027                     BDLDIR      2205
  6751        ELSE                                                      CAV0027                     BDLDIR      2206
  6752           MOVE EMAIL-BDLDIR TO TMP-EMAIL-BDLDIR                  CAV0027                     BDLDIR      2207
  6753        END-IF                                                    CAV0027                     BDLDIR      2208
  6754        IF TMP-EMAIL-BDLDIR(1:1) = "." OR "@"                     CAV0027                     BDLDIR      2209
  6755           MOVE 1 TO ERR-EMAIL-BDLDIR                             CAV0027                     BDLDIR      2210
  6756        END-IF                                                    CAV0027                     BDLDIR      2211
  6757     END-IF                                                       CAV0027                     BDLDIR      2212
  6758     IF ERR-EMAIL-BDLDIR = 0                                      CAV0027                     BDLDIR      2213
  6759        INSPECT TMP-EMAIL-BDLDIR TALLYING                         CAV0027                     BDLDIR      2214
  6760        CONT-ARO-BDLDIR FOR ALL "@"                               CAV0027                     BDLDIR      2215
  6761        CONT-ERR-BDLDIR FOR ALL ".@"                              CAV0027                     BDLDIR      2216
  6762        CONT-ERR-BDLDIR FOR ALL "@."                              CAV0027                     BDLDIR      2217
  6763        CONT-PUN-BDLDIR FOR ALL "." AFTER "@"                     CAV0027                     BDLDIR      2218
  6764        IF CONT-ERR-BDLDIR = 0 AND CONT-ARO-BDLDIR = 1 AND        CAV0027                     BDLDIR      2219
  6765           (CONT-PUN-BDLDIR >= 1)                                 CAV0027                     BDLDIR      2220
  6766           PERFORM VARYING I-BDLDIR FROM 60 BY -1 UNTIL           CAV0027                     BDLDIR      2221
  6767                   I-BDLDIR = 0 OR ERR-EMAIL-BDLDIR = 1           CAV0027                     BDLDIR      2222
  6768             IF TMP-EMAIL-BDLDIR(I-BDLDIR:1) <> SPACES AND        CAV0027                     BDLDIR      2223
  6769                LONG-EMIAL-BDLDIR = 0                             CAV0027                     BDLDIR      2224
  6770                MOVE I-BDLDIR TO LONG-EMIAL-BDLDIR                CAV0027                     BDLDIR      2225
  6771                IF TMP-EMAIL-BDLDIR(I-BDLDIR:1) = "." OR "@"      CAV0027                     BDLDIR      2226
  6772                   MOVE 1 TO ERR-EMAIL-BDLDIR                     CAV0027                     BDLDIR      2227
  6773                END-IF                                            CAV0027                     BDLDIR      2228
  6774             END-IF                                               CAV0027                     BDLDIR      2229
  6775             IF TMP-EMAIL-BDLDIR(I-BDLDIR:1) = SPACES AND         CAV0027                     BDLDIR      2230
  6776                LONG-EMIAL-BDLDIR > 0                             CAV0027                     BDLDIR      2231
  6777                MOVE 1 TO ERR-EMAIL-BDLDIR                        CAV0027                     BDLDIR      2232
  6778             END-IF                                               CAV0027                     BDLDIR      2233
  6779           END-PERFORM                                            CAV0027                     BDLDIR      2234
  6780        ELSE                                                      CAV0027                     BDLDIR      2235
  6781           MOVE 1 TO ERR-EMAIL-BDLDIR                             CAV0027                     BDLDIR      2236
  6782        END-IF                                                    CAV0027                     BDLDIR      2237
  6783     END-IF.                                                      CAV0027                     BDLDIR      2238
  6784*                                                                 CAV0027                     BDLDIR      2239
  6785 8600-VALIDAR-CELULAR-BDLDIR.                                     CAV0027                     BDLDIR      2240
  6786******************************************************************                            BDLDIR      2241
  6787*8600-VALIDAR-CELULAR-BDLDIR.                                                                 BDLDIR      2242
  6788******************************************************************                            BDLDIR      2243
  6789     INITIALIZE ERR-CELULAR-BDLDIR TEL-AUX-CELULAR-BDLDIR         CAV0027                     BDLDIR      2244
  6790     IF TEL-CELULAR-BDLDIR <> ZEROS AND <> SPACES                 CAV0027                     BDLDIR      2245
  6791        MOVE TEL-CELULAR-BDLDIR TO TEL-AUX-CELULAR-BDLDIR         CAV0027                     BDLDIR      2246
  6792        IF ES-CELULAR-CEL-BDLDIR AND P1-TEL-AUX-CEL-BDLDIR = 0    CAV0027                     BDLDIR      2247
  6793           MOVE 0 TO ERR-CELULAR-BDLDIR                           CAV0027                     BDLDIR      2248
  6794        ELSE                                                      CAV0027                     BDLDIR      2249
  6795           MOVE 1 TO ERR-CELULAR-BDLDIR                           CAV0027                     BDLDIR      2250
  6796        END-IF                                                    CAV0027                     BDLDIR      2251
  6797     ELSE                                                         CAV0027                     BDLDIR      2252
  6798        MOVE 1 TO ERR-CELULAR-BDLDIR                              CAV0027                     BDLDIR      2253
  6799     END-IF.                                                      CAV0027                     BDLDIR      2254
* 6800     COPY LEEMAESTROS.PROC.                                                                               1561
  6801* LEEMAESTROS.PROC.v.0004                                                                     LEEMAEST       1
  6802* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE                            LEEMAEST       2
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 119
* )d/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  6803* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA                               LEEMAEST       3
  6804* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.                                                LEEMAEST       4
  6805******************************************************************                            LEEMAEST       5
  6806* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*                            LEEMAEST       6
  6807* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *                            LEEMAEST       7
  6808* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*                            LEEMAEST       8
  6809*           * GISTRO                                             *                            LEEMAEST       9
  6810*           * NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*                            LEEMAEST      10
  6811*           *        CITA EL PROGRAMA, EL DEFAULT ES 48                                       LEEMAEST      11
  6812******************************************************************                            LEEMAEST      12
  6813* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *                            LEEMAEST      13
  6814* G. JIMENEZ*        BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *                            LEEMAEST      14
  6815* AGOST/2009*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *                            LEEMAEST      15
  6816*           *        CARTERA                                     *                            LEEMAEST      16
  6817******************************************************************                            LEEMAEST      17
  6818* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *                            LEEMAEST      18
  6819* G. JIMENEZ*        DE BLOQUEO 7 Y 8                            *                            LEEMAEST      19
  6820* OCTUB/2011*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *                            LEEMAEST      20
  6821*           *        EL MAESTRO DE CARTERA                       *                            LEEMAEST      21
  6822******************************************************************                            LEEMAEST      22
  6823$SET CONSTANT HACERMATCH"NO"                                                                  LEEMAEST      23
  6824$SET CONSTANT AMNISTIA21"NO"                                                                  LEEMAEST      24
  6825                                                                                              LEEMAEST      25
  6826$IF HACERMATCH = "SI"                                                                         LEEMAEST      26
  6827$DISPLAY "........COMPILANDO LEEMAESTROS CON MATCH **********                                 LEEMAEST      27
  6828$ELSE                                                                                         LEEMAEST      28
  6829$DISPLAY "........COMPILANDO LEEMAESTROS SIN MATCH **********                                 LEEMAEST      29
  6830$END                                                                                          LEEMAEST      30
  6831                                                                                              LEEMAEST      31
  6832$IF AMNISTIA21 = "SI"                                                                         LEEMAEST      32
  6833$DISPLAY "........COMPILANDO LEEMAESTROS CON AMNISTIA *******                                 LEEMAEST      33
  6834$ELSE                                                                                         LEEMAEST      34
  6835$DISPLAY "...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******                                 LEEMAEST      35
  6836$END                                                                                          LEEMAEST      36
  6837                                                                                              LEEMAEST      37
* 6838 COPY BDAMATCH.PROC.                                                                          LEEMAEST      38
  6840* BDAMATCH.PROC.v.0005                                                                        BDAMATCH       2
  6841******************************************************************                            BDAMATCH       3
  6842* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH                              BDAMATCH       4
  6843* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO                                 BDAMATCH       5
  6844* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR                            BDAMATCH       6
  6845* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS                             BDAMATCH       7
  6846* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.                         BDAMATCH       8
  6847********************************************************************                          BDAMATCH       9
  6848* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *                            BDAMATCH      10
  6849* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*                            BDAMATCH      11
  6850* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *                            BDAMATCH      12
  6851******************************************************************                            BDAMATCH      13
  6852* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE                               BDAMATCH      14
  6853* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL                               BDAMATCH      15
  6854*             *        MEJOR PORTAFOLIO                                                       BDAMATCH      16
  6855* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH                                  BDAMATCH      17
  6856*             *                  NUM-CTAS-OUTPUT-BDAMATCH                                     BDAMATCH      18
  6857*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN                             BDAMATCH      19
  6858*             *        BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE                                 BDAMATCH      20
  6859*             *        DE FRENADAS                                                            BDAMATCH      21
  6860*****************************************************************                             BDAMATCH      22
  6861* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *                             BDAMATCH      23
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 120
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  6862* R-MARTINEZ. *          DEL PORTAFOLIO .                       *                             BDAMATCH      24
  6863* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *                             BDAMATCH      25
  6864*             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       *                             BDAMATCH      26
  6865*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               *                             BDAMATCH      27
  6866*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH       *                             BDAMATCH      28
  6867*             * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7      *                             BDAMATCH      29
  6868*             * NOMB01 - MAQUILLAR EL NOMBRE                    *                             BDAMATCH      30
  6869*             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *                             BDAMATCH      31
  6870*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*                             BDAMATCH      32
  6871*****************************************************************                             BDAMATCH      33
  6872* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *                             BDAMATCH      34
  6873* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*                             BDAMATCH      35
  6874* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *                             BDAMATCH      36
  6875*             *          DECUENTA DE LA MISMA CUENTA            *                             BDAMATCH      37
  6876*****************************************************************                             BDAMATCH      38
  6877                                                                                              BDAMATCH      39
  6878 1000-U-RECORRER-CSV-BDAMATCH.                                                                BDAMATCH      40
  6879******************************************************************                            BDAMATCH      41
  6880*1000-U-RECORRER-CSV-BDAMATCH.                                                                BDAMATCH      42
  6881* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION                                 BDAMATCH      43
  6882* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL                               BDAMATCH      44
  6883* MATCH                                                                                       BDAMATCH      45
  6884******************************************************************                            BDAMATCH      46
  6885     MOVE 0 TO IDE-TIPO-BDAMATCH                                                              BDAMATCH      47
  6886     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003                     BDAMATCH      48
  6887     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                         RMB0003                     BDAMATCH      49
  6888     MOVE 0 TO MAX-CUENTAS-BDAMATCH.                                                          BDAMATCH      50
  6889     IF ABIERTO-BDAMATCH  = 0                                                                 BDAMATCH      51
  6890        OPEN INPUT  BDACSV                                                                    BDAMATCH      52
  6891        MOVE 1 TO ABIERTO-BDAMATCH                                                            BDAMATCH      53
  6892     END-IF.                                                                                  BDAMATCH      54
  6893     INITIALIZE LLAVE-BDACSV.                                                                 BDAMATCH      55
  6894     MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .                                         BDAMATCH      56
  6895     MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .                                          BDAMATCH      57
  6896     MOVE 0 TO FIN-BDAMATCH .                                                                 BDAMATCH      58
  6897     MOVE 0 TO PROCESAR-BDAMATCH .                                                            BDAMATCH      59
  6898     START BDACSV  KEY > LLAVE-BDACSV                                                         BDAMATCH      60
  6899           INVALID KEY                                                                        BDAMATCH      61
  6900              MOVE 1 TO FIN-BDAMATCH                                                          BDAMATCH      62
  6901           NOT INVALID KEY                                                                    BDAMATCH      63
  6902              READ BDACSV IGNORE LOCK NEXT RECORD                                             BDAMATCH      64
  6903                 AT END                                                                       BDAMATCH      65
  6904                    MOVE 1 TO FIN-BDAMATCH                                                    BDAMATCH      66
  6905              END-READ                                                                        BDAMATCH      67
  6906     END-START.                                                                               BDAMATCH      68
  6907     PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =                                  BDAMATCH      69
  6908                                      NUM-IDE-INPUT-BDAMATCH  OR                              BDAMATCH      70
  6909                                      TIPO-ID-BDACSV  NOT =                                   BDAMATCH      71
  6910                                      TIP-IDE-INPUT-BDAMATCH                                  BDAMATCH      72
  6911        MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02                                              BDAMATCH      73
  6912        READ SUSCRIPTOR IGNORE LOCK                                                           BDAMATCH      74
  6913           INVALID KEY                                                                        BDAMATCH      75
  6914              MOVE 0 TO PROCESAR-BDAMATCH                                                     BDAMATCH      76
  6915           NOT INVALID KEY                                                                    BDAMATCH      77
  6916              MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004                     BDAMATCH      78
  6917        END-READ                                                                              BDAMATCH      79
  6918        IF PROCESAR-BDAMATCH = 1                                  RMB0004                     BDAMATCH      80
  6919           IF ESTADO-ABD02 = 1                                    RMB0004                     BDAMATCH      81
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 121
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  6920              IF IND-BLOQUEO-BDACSV <> "B"                        RMB0004                     BDAMATCH      82
  6921                 MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004                     BDAMATCH      83
  6922                 IF FUENTE-REG-BDACSV <= 01                       RMB0004                     BDAMATCH      84
  6923                    PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH       RMB0004                     BDAMATCH      85
  6924                 ELSE                                             RMB0004                     BDAMATCH      86
  6925                    PERFORM 1100-LLENAR-AUX-BDAMATCH              RMB0004                     BDAMATCH      87
  6926                 END-IF                                           RMB0004                     BDAMATCH      88
  6927              ELSE                                                RMB0004                     BDAMATCH      89
  6928                 MOVE 0 TO PROCESAR-BDAMATCH                      RMB0004                     BDAMATCH      90
  6929              END-IF                                              RMB0004                     BDAMATCH      91
  6930           ELSE                                                   RMB0004                     BDAMATCH      92
  6931              MOVE 0 TO PROCESAR-BDAMATCH                         RMB0004                     BDAMATCH      93
  6932           END-IF                                                 RMB0004                     BDAMATCH      94
  6933        END-IF                                                    RMB0004                     BDAMATCH      95
  6934        IF PROCESAR-BDAMATCH = 1                                                              BDAMATCH      96
  6935           PERFORM 1200-PROC-REG-CSV-BDAMATCH                                                 BDAMATCH      97
  6936        END-IF                                                                                BDAMATCH      98
  6937        READ BDACSV IGNORE LOCK   NEXT RECORD                                                 BDAMATCH      99
  6938        AT END                                                                                BDAMATCH     100
  6939           MOVE 1 TO FIN-BDAMATCH                                                             BDAMATCH     101
  6940        END-READ                                                                              BDAMATCH     102
  6941        IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004                     BDAMATCH     103
  6942           MOVE 1 TO FIN-BDAMATCH               *> SE ABLIGA A TIPRMB0004                     BDAMATCH     104
  6943           MOVE 0 TO MAX-CUENTAS-BDAMATCH       *> EFICIENCIA Y   RMB0004                     BDAMATCH     105
  6944           MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004                     BDAMATCH     106
  6945        END-IF                                                    RMB0004                     BDAMATCH     107
  6946     END-PERFORM.                                                                             BDAMATCH     108
  6947     IF MAX-CUENTAS-BDAMATCH > 0                                                              BDAMATCH     109
  6948        IF APELLIDO-INPUT-BDAMATCH <> SPACES AND                  RMB0004                     BDAMATCH     110
  6949           MAX-CUENTAS-BDAMATCH > 1                               RMB0004                     BDAMATCH     111
  6950           PERFORM 1100-LLENAR-CSV-APE-BDAMATCH                   RMB0004                     BDAMATCH     112
  6951           PERFORM 1100-LLENAR-AUX-BDAMATCH                       RMB0004                     BDAMATCH     113
  6952           PERFORM 1200-PROC-REG-CSV-BDAMATCH                     RMB0004                     BDAMATCH     114
  6953        END-IF                                                    RMB0004                     BDAMATCH     115
  6954        PERFORM 9000-U-REALIZAR-BDAMATCH                                                      BDAMATCH     116
  6955        IF NOM-OUTPUT-BDAMATCH <> SPACES AND                      RMB0004                     BDAMATCH     117
  6956           (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)                      RMB0004                     BDAMATCH     118
  6957           MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQ              RMB0004                     BDAMATCH     119
  6958           PERFORM 1100-MAQUILLAR-NOMBRE-MAQ                      RMB0004                     BDAMATCH     120
  6959           MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCH           RMB0004                     BDAMATCH     121
  6960        END-IF                                                    RMB0004                     BDAMATCH     122
  6961        IF NOM-OUTPUT-BDAMATCH <> SPACES                                                      BDAMATCH     123
  6962           MOVE 1 TO IDE-TIPO-BDAMATCH                                                        BDAMATCH     124
  6963        END-IF                                                                                BDAMATCH     125
  6964     END-IF.                                                                                  BDAMATCH     126
  6965 1100-MAQUILLAR-NOMBRE-MAQ.                                       RMB0004                     BDAMATCH     127
  6966     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004                     BDAMATCH     128
  6967     MOVE 0 TO I-MAQ                                              RMB0004                     BDAMATCH     129
  6968     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004                     BDAMATCH     130
  6969             INITIAL "Y/O"                                        RMB0004                     BDAMATCH     131
  6970             OR      "Y\O"                                        RMB0004                     BDAMATCH     132
  6971             OR      " Y/OTRO "                                   RMB0004                     BDAMATCH     133
  6972             OR      " Y/OTRA "                                   RMB0004                     BDAMATCH     134
  6973             OR      " Y\OTRO "                                   RMB0004                     BDAMATCH     135
  6974             OR      " Y\OTRA "                                   RMB0004                     BDAMATCH     136
  6975             OR      " Y OTRO "                                   RMB0004                     BDAMATCH     137
  6976             OR      " Y OTRA "                                   RMB0004                     BDAMATCH     138
  6977     IF I-MAQ < 45 AND I-MAQ > 2                                  RMB0004                     BDAMATCH     139
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 122
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  6978        ADD 1 TO I-MAQ                                            RMB0004                     BDAMATCH     140
  6979        MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)                      RMB0004                     BDAMATCH     141
  6980     ELSE                                                         RMB0004                     BDAMATCH     142
  6981        IF I-MAQ < 45                                             RMB0004                     BDAMATCH     143
  6982           ADD 1 TO I-MAQ                                         RMB0004                     BDAMATCH     144
  6983           MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)                  RMB0004                     BDAMATCH     145
  6984        END-IF                                                    RMB0004                     BDAMATCH     146
  6985     END-IF                                                       RMB0004                     BDAMATCH     147
  6986     MOVE 0 TO SW-BORRAR-MAQ                                      RMB0004                     BDAMATCH     148
  6987     MOVE 1 TO I-MAQ.                                             RMB0004                     BDAMATCH     149
  6988     PERFORM UNTIL I-MAQ > 45                                     RMB0004                     BDAMATCH     150
  6989       MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ                  RMB0004                     BDAMATCH     151
  6990       IF TILDE-MAQ                                               RMB0004                     BDAMATCH     152
  6991          PERFORM 1000-CAMBIAR-TILDE-MAQ                          RMB0004                     BDAMATCH     153
  6992          MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)               RMB0004                     BDAMATCH     154
  6993       END-IF                                                     RMB0004                     BDAMATCH     155
  6994       IF FUNCTION ORD(ACTUAL-MAQ) < 31                           RMB0004                     BDAMATCH     156
  6995          MOVE "." TO ACTUAL-MAQ                                  RMB0004                     BDAMATCH     157
  6996       END-IF                                                     RMB0004                     BDAMATCH     158
  6997       MOVE " " TO ANT-MAQ                                        RMB0004                     BDAMATCH     159
  6998       IF I-MAQ > 1                                               RMB0004                     BDAMATCH     160
  6999          COMPUTE J-MAQ = I-MAQ - 1                               RMB0004                     BDAMATCH     161
  7000          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQ                  RMB0004                     BDAMATCH     162
  7001       END-IF                                                     RMB0004                     BDAMATCH     163
  7002       MOVE " " TO SIG-MAQ                                        RMB0004                     BDAMATCH     164
  7003       IF I-MAQ < 45                                              RMB0004                     BDAMATCH     165
  7004          COMPUTE J-MAQ = I-MAQ + 1                               RMB0004                     BDAMATCH     166
  7005          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQ                  RMB0004                     BDAMATCH     167
  7006       END-IF                                                     RMB0004                     BDAMATCH     168
  7007       IF ACTUAL-MAQ = ")"                                        RMB0004                     BDAMATCH     169
  7008          MOVE 0 TO SW-BORRAR-MAQ                                 RMB0004                     BDAMATCH     170
  7009       END-IF                                                     RMB0004                     BDAMATCH     171
  7010       IF SW-BORRAR-MAQ = 0                                       RMB0004                     BDAMATCH     172
  7011          IF ELIMINAR-MAQ                                         RMB0004                     BDAMATCH     173
  7012             MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                  RMB0004                     BDAMATCH     174
  7013             IF I-MAQ > 1                                         RMB0004                     BDAMATCH     175
  7014                MOVE 1 TO SW-BORRAR-MAQ                           RMB0004                     BDAMATCH     176
  7015             END-IF                                               RMB0004                     BDAMATCH     177
  7016          ELSE                                                    RMB0004                     BDAMATCH     178
  7017             IF BORRAR-MAQ                                        RMB0004                     BDAMATCH     179
  7018                MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)               RMB0004                     BDAMATCH     180
  7019             ELSE                                                 RMB0004                     BDAMATCH     181
  7020                IF QUITAR-MAQ                                     RMB0004                     BDAMATCH     182
  7021                   COMPUTE J-MAQ = I-MAQ + 1                      RMB0004                     BDAMATCH     183
  7022                   MOVE NOMBRE-INPMAQ(J-MAQ:) TO                  RMB0004                     BDAMATCH     184
  7023                        NOMBRE-INPMAQ(I-MAQ:)                     RMB0004                     BDAMATCH     185
  7024                   COMPUTE I-MAQ = I-MAQ - 1                      RMB0004                     BDAMATCH     186
  7025                ELSE                                              RMB0004                     BDAMATCH     187
  7026                   IF VALIDO-MAQ                                  RMB0004                     BDAMATCH     188
  7027                      CONTINUE                                    RMB0004                     BDAMATCH     189
  7028                   ELSE                                           RMB0004                     BDAMATCH     190
  7029                      IF ANT-MAQ = "N" AND SIG-VOCAL-MAQ          RMB0004                     BDAMATCH     191
  7030                         COMPUTE J-MAQ = I-MAQ + 1                RMB0004                     BDAMATCH     192
  7031                         MOVE NOMBRE-INPMAQ(J-MAQ:) TO            RMB0004                     BDAMATCH     193
  7032                              NOMBRE-INPMAQ(I-MAQ:)               RMB0004                     BDAMATCH     194
  7033                         COMPUTE I-MAQ = I-MAQ - 1                RMB0004                     BDAMATCH     195
  7034                      ELSE                                        RMB0004                     BDAMATCH     196
  7035                         IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004                     BDAMATCH     197
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 123
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7036                            (ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004                     BDAMATCH     198
  7037                            IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004                     BDAMATCH     199
  7038                               COMPUTE J-MAQ = I-MAQ + 1          RMB0004                     BDAMATCH     200
  7039                               MOVE NOMBRE-INPMAQ(J-MAQ:) TO      RMB0004                     BDAMATCH     201
  7040                                    NOMBRE-INPMAQ(I-MAQ:)         RMB0004                     BDAMATCH     202
  7041                            ELSE                                  RMB0004                     BDAMATCH     203
  7042                               MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004                     BDAMATCH     204
  7043                            END-IF                                RMB0004                     BDAMATCH     205
  7044                         ELSE                                     RMB0004                     BDAMATCH     206
  7045                            IF NOT ANT-VOCAL-MAQ AND              RMB0004                     BDAMATCH     207
  7046                                   SIG-VOCAL-MAQ                  RMB0004                     BDAMATCH     208
  7047                               MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004                     BDAMATCH     209
  7048                            ELSE                                  RMB0004                     BDAMATCH     210
  7049                               MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004                     BDAMATCH     211
  7050                            END-IF                                RMB0004                     BDAMATCH     212
  7051                         END-IF                                   RMB0004                     BDAMATCH     213
  7052                      END-IF                                      RMB0004                     BDAMATCH     214
  7053                   END-IF                                         RMB0004                     BDAMATCH     215
  7054                END-IF                                            RMB0004                     BDAMATCH     216
  7055             END-IF                                               RMB0004                     BDAMATCH     217
  7056          END-IF                                                  RMB0004                     BDAMATCH     218
  7057       ELSE                                                       RMB0004                     BDAMATCH     219
  7058          MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                     RMB0004                     BDAMATCH     220
  7059       END-IF                                                     RMB0004                     BDAMATCH     221
  7060       ADD 1 TO I-MAQ                                             RMB0004                     BDAMATCH     222
  7061     END-PERFORM.                                                 RMB0004                     BDAMATCH     223
  7062     INITIALIZE PARTICULAS-INPMAQ                                 RMB0004                     BDAMATCH     224
  7063     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "                RMB0004                     BDAMATCH     225
  7064       INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004                     BDAMATCH     226
  7065            P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004                     BDAMATCH     227
  7066            P10-INPMAQ                                            RMB0004                     BDAMATCH     228
  7067     MOVE SPACES TO NOMBRE-OUTMAQ-OK                              RMB0004                     BDAMATCH     229
  7068     STRING P1-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     230
  7069            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     231
  7070            P2-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     232
  7071            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     233
  7072            P3-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     234
  7073            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     235
  7074            P4-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     236
  7075            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     237
  7076            P5-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     238
  7077            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     239
  7078            P6-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     240
  7079            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     241
  7080            P7-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     242
  7081            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     243
  7082            P8-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     244
  7083            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     245
  7084            P9-INPMAQ DELIMITED BY " "                            RMB0004                     BDAMATCH     246
  7085            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     247
  7086            P10-INPMAQ DELIMITED BY " "                           RMB0004                     BDAMATCH     248
  7087            " " DELIMITED BY SIZE                                 RMB0004                     BDAMATCH     249
  7088       INTO NOMBRE-OUTMAQ-OK.                                     RMB0004                     BDAMATCH     250
  7089       INSPECT NOMBRE-OUTMAQ-OK                                   RMB0004                     BDAMATCH     251
  7090         REPLACING ALL  " PE A " BY " PENA ".                     RMB0004                     BDAMATCH     252
  7091  1000-CAMBIAR-TILDE-MAQ.                                         RMB0004                     BDAMATCH     253
  7092       EVALUATE ACTUAL-MAQ                                        RMB0004                     BDAMATCH     254
  7093          WHEN "Á"                                                RMB0004                     BDAMATCH     255
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 124
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7094            MOVE "A" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     256
  7095          WHEN "É"                                                RMB0004                     BDAMATCH     257
  7096            MOVE "E" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     258
  7097          WHEN "Í"                                                RMB0004                     BDAMATCH     259
  7098            MOVE "I" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     260
  7099          WHEN "Ó"                                                RMB0004                     BDAMATCH     261
  7100            MOVE "O" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     262
  7101          WHEN "Ú"                                                RMB0004                     BDAMATCH     263
  7102            MOVE "U" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     264
  7103          WHEN "á"                                                RMB0004                     BDAMATCH     265
  7104            MOVE "A" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     266
  7105          WHEN "é"                                                RMB0004                     BDAMATCH     267
  7106            MOVE "E" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     268
  7107          WHEN "í"                                                RMB0004                     BDAMATCH     269
  7108            MOVE "I" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     270
  7109          WHEN "ó"                                                RMB0004                     BDAMATCH     271
  7110            MOVE "O" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     272
  7111          WHEN "Ú"                                                RMB0004                     BDAMATCH     273
  7112            MOVE "U" TO ACTUAL-MAQ                                RMB0004                     BDAMATCH     274
  7113        END-EVALUATE.                                             RMB0004                     BDAMATCH     275
  7114 1100-LLENAR-CSV-APE-BDAMATCH.                                    RMB0004                     BDAMATCH     276
  7115     INITIALIZE REG-BDACSV                                        RMB0004                     BDAMATCH     277
  7116     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSV               RMB0004                     BDAMATCH     278
  7117     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSV                RMB0004                     BDAMATCH     279
  7118     MOVE 980001         TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004                     BDAMATCH     280
  7119     MOVE 02             TO  COD-CTA-BDACSV                       RMB0004                     BDAMATCH     281
  7120     MOVE "APELLID-01"   TO  NUM-CTA-BDACSV                       RMB0004                     BDAMATCH     282
  7121     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSV               RMB0004                     BDAMATCH     283
  7122     MOVE ".-,"                   TO  NOMBRE-BDACSV(43:3)         RMB0004                     BDAMATCH     284
  7123     MOVE 20110801       TO  FECHA-CREA-BDACSV                    RMB0004                     BDAMATCH     285
  7124     MOVE 0              TO  NUM-PORTAF-BDACSV                    RMB0004                     BDAMATCH     286
  7125     MOVE 0              TO  IND-NOMBRE-BDACSV                    RMB0004                     BDAMATCH     287
  7126     MOVE 0              TO  MEJOR-PORTAF-BDACSV                  RMB0004                     BDAMATCH     288
  7127     MOVE 0              TO  IND-ACTUALIZ-BDACSV                  RMB0004                     BDAMATCH     289
  7128     MOVE 01             TO  FUENTE-REG-BDACSV.                   RMB0004                     BDAMATCH     290
  7129 1100-LLENAR-AUX-BDAMATCH.                                        RMB0004                     BDAMATCH     291
  7130***********************************************************************                       BDAMATCH     292
  7131*1100-LLENAR-AUX-BDAMATCH.                                                                    BDAMATCH     293
  7132* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE                           BDAMATCH     294
  7133* TAMAÑO                                                                                      BDAMATCH     295
  7134***********************************************************************                       BDAMATCH     296
  7135     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .          RMB0004                     BDAMATCH     297
  7136     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .          RMB0004                     BDAMATCH     298
  7137     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .          RMB0004                     BDAMATCH     299
  7138     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .          RMB0004                     BDAMATCH     300
  7139     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .          RMB0004                     BDAMATCH     301
  7140     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .          RMB0004                     BDAMATCH     302
  7141     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .          RMB0004                     BDAMATCH     303
  7142     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .          RMB0004                     BDAMATCH     304
  7143     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .          RMB0004                     BDAMATCH     305
  7144     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .          RMB0004                     BDAMATCH     306
  7145     MOVE 0 TO FALLECIDO-BDAMATCH.                                RMB0004                     BDAMATCH     307
  7146 1100-UBICAR-CHKCRE-CSV-BDAMATCH.                                                             BDAMATCH     308
  7147***********************************************************************                       BDAMATCH     309
  7148*1100-UBICAR-CHKCRE-CSV-BDAMATCH.                                                             BDAMATCH     310
  7149* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN                         BDAMATCH     311
  7150* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH                         BDAMATCH     312
  7151***********************************************************************                       BDAMATCH     313
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 125
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7152     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .                                      BDAMATCH     314
  7153     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .                                      BDAMATCH     315
  7154     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .                                      BDAMATCH     316
  7155     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .                                      BDAMATCH     317
  7156     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .                                      BDAMATCH     318
  7157     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .                                      BDAMATCH     319
  7158     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .                                      BDAMATCH     320
  7159     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .                                      BDAMATCH     321
  7160     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .                                      BDAMATCH     322
  7161     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .                                      BDAMATCH     323
  7162     MOVE 0 TO FALLECIDO-BDAMATCH                                 RMB0003                     BDAMATCH     324
  7163     IF COD-CTA-BDACSV = 01 OR 51                                                             BDAMATCH     325
  7164        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECK                                        BDAMATCH     326
  7165        READ MAESTRO-CHECK IGNORE LOCK INVALID KEY                                            BDAMATCH     327
  7166             MOVE 0 TO PROCESAR-BDAMATCH                                                      BDAMATCH     328
  7167        NOT INVALID KEY                                           RMB0003                     BDAMATCH     329
  7168            IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)                  RMB0004                     BDAMATCH     330
  7169                AND CONSECUTIVO-ABD06 = 1                                                     BDAMATCH     331
  7170               IF ADJETIVO-ABD06 = 1                              RMB0003                     BDAMATCH     332
  7171                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003                     BDAMATCH     333
  7172               END-IF                                             RMB0003                     BDAMATCH     334
  7173            ELSE                                                  RMB0003                     BDAMATCH     335
  7174               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003                     BDAMATCH     336
  7175            END-IF                                                RMB0003                     BDAMATCH     337
  7176        END-READ                                                                              BDAMATCH     338
  7177     ELSE                                                                                     BDAMATCH     339
  7178        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDIT                                       BDAMATCH     340
  7179        READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY                                           BDAMATCH     341
  7180             MOVE 0 TO PROCESAR-BDAMATCH                                                      BDAMATCH     342
  7181        NOT INVALID KEY                                           RMB0003                     BDAMATCH     343
  7182            IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)                  RMB0004                     BDAMATCH     344
  7183               AND CONSECUTIVO-ABD07 = 1                                                      BDAMATCH     345
  7184               IF ADJETIVO1-ABD07 = 1 OR                          RMB0003                     BDAMATCH     346
  7185                  ADJETIVO2-ABD07 = 1 OR                          RMB0003                     BDAMATCH     347
  7186                  ADJETIVO3-ABD07 = 1                             RMB0003                     BDAMATCH     348
  7187                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003                     BDAMATCH     349
  7188               END-IF                                             RMB0003                     BDAMATCH     350
  7189            ELSE                                                  RMB0003                     BDAMATCH     351
  7190               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003                     BDAMATCH     352
  7191            END-IF                                                RMB0003                     BDAMATCH     353
  7192        END-READ                                                                              BDAMATCH     354
  7193     END-IF.                                                                                  BDAMATCH     355
  7194                                                                                              BDAMATCH     356
  7195 1200-PROC-REG-CSV-BDAMATCH.                                                                  BDAMATCH     357
  7196***********************************************************************                       BDAMATCH     358
  7197*1200-PROC-REG-CSV-BDAMATCH.                                                                  BDAMATCH     359
  7198* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES                        BDAMATCH     360
  7199* SI LO HAY                                                                                   BDAMATCH     361
  7200***********************************************************************                       BDAMATCH     362
  7201     IF MAX-CUENTAS-BDAMATCH = 0                                                              BDAMATCH     363
  7202        PERFORM 1000-U-INICIALIZAR-BDAMATCH                                                   BDAMATCH     364
  7203     END-IF.                                                                                  BDAMATCH     365
  7204     MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.                                       BDAMATCH     366
  7205     MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLM                          BDAMATCH     367
  7206     PERFORM 2000-U-INSERTAR-CTA-BDAMATCH.                                                    BDAMATCH     368
  7207     MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.                                               BDAMATCH     369
  7208     PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.                                                    BDAMATCH     370
  7209     MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.                                               BDAMATCH     371
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 126
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7210     READ MAESTRO-DIRECC IGNORE LOCK                                                          BDAMATCH     372
  7211*         NOT INVALID KEY                                         RMB0004                     BDAMATCH     373
  7212*             PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                 RMB0004                     BDAMATCH     374
  7213          INVALID KEY                                             RMB0004                     BDAMATCH     375
  7214              MOVE SPACES TO LLAVE-DIRECC                         RMB0004                     BDAMATCH     376
  7215     END-READ.                                                                                BDAMATCH     377
  7216     IF LLAVE-DIRECC <> SPACES                                    RMB0004                     BDAMATCH     378
  7217        PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                       RMB0004                     BDAMATCH     379
  7218     END-IF.                                                      RMB0004                     BDAMATCH     380
  7219                                                                                              BDAMATCH     381
  7220 1210-DIRTEL-BDACSV-BDAMATCH.                                                                 BDAMATCH     382
  7221***********************************************************************                       BDAMATCH     383
  7222*1210-DIRTEL-BDACSV-BDAMATCH.                                                                 BDAMATCH     384
  7223* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE                        BDAMATCH     385
  7224* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.                                         BDAMATCH     386
  7225***********************************************************************                       BDAMATCH     387
  7226     IF CIURES-DIRECC NOT = SPACES                                                            BDAMATCH     388
  7227        IF DIRRES-DIRECC NOT = SPACES                                                         BDAMATCH     389
  7228           MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCH                                           BDAMATCH     390
  7229           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH                                               BDAMATCH     391
  7230        END-IF                                                                                BDAMATCH     392
  7231        IF TELRES-DIRECC > 0 AND                                                              BDAMATCH     393
  7232           TELRES-DIRECC < 9999999999                                                         BDAMATCH     394
  7233           MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCH                                           BDAMATCH     395
  7234           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH                                               BDAMATCH     396
  7235        END-IF                                                                                BDAMATCH     397
  7236     END-IF.                                                                                  BDAMATCH     398
  7237     IF CIULAB-DIRECC NOT = SPACES                                                            BDAMATCH     399
  7238        IF DIRLAB-DIRECC NOT = SPACES                                                         BDAMATCH     400
  7239           MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCH                                           BDAMATCH     401
  7240           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH                                               BDAMATCH     402
  7241        END-IF                                                                                BDAMATCH     403
  7242        IF TELLAB-DIRECC > 0 AND                                                              BDAMATCH     404
  7243           TELLAB-DIRECC < 9999999999                                                         BDAMATCH     405
  7244           MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCH                                           BDAMATCH     406
  7245           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH                                               BDAMATCH     407
  7246        END-IF                                                                                BDAMATCH     408
  7247     END-IF.                                                                                  BDAMATCH     409
  7248     IF CIUCOR-DIRECC NOT = SPACES AND                                                        BDAMATCH     410
  7249        DIRCOR-DIRECC NOT = SPACES                                                            BDAMATCH     411
  7250        MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCH                                              BDAMATCH     412
  7251        PERFORM 2000-U-INSERTAR-DIR-BDAMATCH                                                  BDAMATCH     413
  7252     END-IF.                                                                                  BDAMATCH     414
  7253                                                                                              BDAMATCH     415
  7254 8000-U-VER-CTAABD07-BDAMATCH.                                                                BDAMATCH     416
  7255***********************************************************************                       BDAMATCH     417
  7256*8000-U-VER-CTAABD07-BDAMATCH.                                                                BDAMATCH     418
  7257*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE                        BDAMATCH     419
  7258*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR                        BDAMATCH     420
  7259*  DE BLOQUEO A 0                                                                             BDAMATCH     421
  7260***********************************************************************                       BDAMATCH     422
  7261     IF IDE-TIPO-BDAMATCH = 1                                                                 BDAMATCH     423
  7262        MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCH                                          BDAMATCH     424
  7263        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH                                                BDAMATCH     425
  7264        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9                               BDAMATCH     426
  7265           MOVE 0 TO IND-BLOQUEO-ABD07                                                        BDAMATCH     427
  7266        END-IF                                                                                BDAMATCH     428
  7267     END-IF.                                                                                  BDAMATCH     429
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 127
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7268                                                                                              BDAMATCH     430
  7269 8000-U-VER-CTAABD06-BDAMATCH.                                                                BDAMATCH     431
  7270***********************************************************************                       BDAMATCH     432
  7271*8000-U-VER-CTAABD06-BDAMATCH.                                                                BDAMATCH     433
  7272*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE                        BDAMATCH     434
  7273*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR                        BDAMATCH     435
  7274*  DE BLOQUEO A 0                                                                             BDAMATCH     436
  7275***********************************************************************                       BDAMATCH     437
  7276     IF IDE-TIPO-BDAMATCH = 1                                                                 BDAMATCH     438
  7277        MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCH                                          BDAMATCH     439
  7278        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH                                                BDAMATCH     440
  7279        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9                               BDAMATCH     441
  7280           MOVE 0 TO IND-BLOQUEO-ABD06                                                        BDAMATCH     442
  7281        END-IF                                                                                BDAMATCH     443
  7282     END-IF.                                                                                  BDAMATCH     444
  7283                                                                                              BDAMATCH     445
  7284*======================================================================                       BDAMATCH     446
  7285 1000-U-INICIALIZAR-BDAMATCH.                                                                 BDAMATCH     447
  7286********************************************************************                          BDAMATCH     448
  7287*1000-U-INICIALIZAR-BDAMATCH.                                                                 BDAMATCH     449
  7288* INPUT = VACIO                                                                               BDAMATCH     450
  7289* OUTPUT= VACIO                                                                               BDAMATCH     451
  7290* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION                           BDAMATCH     452
  7291* DEl MATCH.                                                                                  BDAMATCH     453
  7292********************************************************************                          BDAMATCH     454
  7293     MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.                                  BDAMATCH     455
  7294     MOVE 0 TO I-CTA-BDAMATCH.                                                                BDAMATCH     456
  7295     INITIALIZE TABLA-CUENTAS-BDAMATCH.                           RMB0004                     BDAMATCH     457
  7296     INITIALIZE TABLA-DIR-BDAMATCH.                                                           BDAMATCH     458
  7297     INITIALIZE TABLA-TEL-BDAMATCH.                                                           BDAMATCH     459
  7298     INITIALIZE TABLA-NOM-BDAMATCH.                                                           BDAMATCH     460
  7299     INITIALIZE TABLA-GRUNOM-BDAMATCH.                                                        BDAMATCH     461
  7300     INITIALIZE V-INTERRELAC-BDAMATCH.                                                        BDAMATCH     462
  7301     MOVE ZEROS   TO POSIC-SUSC-BDAMATCH                                                      BDAMATCH     463
  7302                      POSIC-SUS-GRU-BDAMATCH                                                  BDAMATCH     464
  7303     MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH                                                  BDAMATCH     465
  7304     MOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.                                              BDAMATCH     466
  7305                                                                                              BDAMATCH     467
  7306 2000-U-INSERTAR-DIR-BDAMATCH.                                                                BDAMATCH     468
  7307********************************************************************                          BDAMATCH     469
  7308*2000-U-INSERTAR-DIR-BDAMATCH.                                                                BDAMATCH     470
  7309* INPUT = DIR-INPUT-BDAMATCH                                                                  BDAMATCH     471
  7310* OUTPUT= VACIO                                                                               BDAMATCH     472
  7311* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION                           BDAMATCH     473
  7312* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE                             BDAMATCH     474
  7313* LA DIRECCION CONTENGA ALGUN NUMERO                                                          BDAMATCH     475
  7314********************************************************************                          BDAMATCH     476
  7315     MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.                                           BDAMATCH     477
  7316     MOVE 1 TO I-BDAMATCH                                                                     BDAMATCH     478
  7317     MOVE 0 TO J-BDAMATCH                                                                     BDAMATCH     479
  7318     MOVE " " TO CAR-ANT-BDAMATCH                                                             BDAMATCH     480
  7319     INITIALIZE T-CARTOT-BDAMATCH                                                             BDAMATCH     481
  7320     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10            CAV0002                     BDAMATCH     482
  7321       IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERIC                                             BDAMATCH     483
  7322          MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCH                             BDAMATCH     484
  7323          IF CAR-ANT-BDAMATCH   NUMERIC                                                       BDAMATCH     485
  7324             COMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)                                           BDAMATCH     486
  7325                     = V-CARTOT-BDAMATCH  (J-BDAMATCH)                                        BDAMATCH     487
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 128
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7326                     * 10 + CAR-ACT-BDAMATCH                                                  BDAMATCH     488
  7327          ELSE                                                                                BDAMATCH     489
  7328             ADD 1 TO J-BDAMATCH                                                              BDAMATCH     490
  7329             MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)                                             BDAMATCH     491
  7330                  TO V-CARTOT-BDAMATCH  (J-BDAMATCH)                                          BDAMATCH     492
  7331          END-IF                                                                              BDAMATCH     493
  7332       END-IF                                                                                 BDAMATCH     494
  7333       MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCH                                BDAMATCH     495
  7334       ADD 1 TO I-BDAMATCH                                                                    BDAMATCH     496
  7335     END-PERFORM.                                                                             BDAMATCH     497
  7336     SORT V-CARTOT-BDAMATCH   DESCENDING.                                                     BDAMATCH     498
  7337     IF T-CARTOT-BDAMATCH   NOT = ZEROS AND                                                   BDAMATCH     499
  7338        I-DIR-BDAMATCH < LIM-BDAMATCH                                                         BDAMATCH     500
  7339        MOVE T-CARTOT-BDAMATCH TO                                                             BDAMATCH     501
  7340             NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)                                                 BDAMATCH     502
  7341        MOVE SUSC-CTAS-BDAMATCH TO                                                            BDAMATCH     503
  7342             SUS-DIR-BDAMATCH(I-DIR-BDAMATCH)                                                 BDAMATCH     504
  7343        MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)                               BDAMATCH     505
  7344        PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1                                      BDAMATCH     506
  7345                 UNTIL  POSIC-SUMA-BDAMATCH  >  10 OR                                         BDAMATCH     507
  7346                 V-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZERO                              BDAMATCH     508
  7347           ADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)                                    BDAMATCH     509
  7348        END-PERFORM                                                                           BDAMATCH     510
  7349        ADD 1 TO I-DIR-BDAMATCH                                                               BDAMATCH     511
  7350     END-IF.                                                                                  BDAMATCH     512
  7351                                                                                              BDAMATCH     513
  7352 2000-U-INSERTAR-TEL-BDAMATCH.                                                                BDAMATCH     514
  7353********************************************************************                          BDAMATCH     515
  7354*2000-U-INSERTAR-TEL-BDAMATCH.                                                                BDAMATCH     516
  7355* INPUT = TEL-INPUT-BDAMATCH                                                                  BDAMATCH     517
  7356* OUTPUT= VACIO                                                                               BDAMATCH     518
  7357* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO                                  BDAMATCH     519
  7358* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO                                        BDAMATCH     520
  7359********************************************************************                          BDAMATCH     521
  7360     IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0                              BDAMATCH     522
  7361        MOVE TEL-INPUT-BDAMATCH TO                                                            BDAMATCH     523
  7362                                NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)                              BDAMATCH     524
  7363        MOVE SUSC-CTAS-BDAMATCH TO                                                            BDAMATCH     525
  7364                                SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)                              BDAMATCH     526
  7365        MOVE I-CTA-BDAMATCH     TO                                                            BDAMATCH     527
  7366                                CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)                              BDAMATCH     528
  7367        ADD 1 TO I-TEL-BDAMATCH                                                               BDAMATCH     529
  7368     END-IF.                                                                                  BDAMATCH     530
  7369                                                                                              BDAMATCH     531
  7370 2000-U-INSERTAR-NOM-BDAMATCH.                                                                BDAMATCH     532
  7371********************************************************************                          BDAMATCH     533
  7372*2000-U-INSERTAR-NOM-BDAMATCH.                                                                BDAMATCH     534
  7373* INPUT = NOM-INPUT-BDAMATCH                                                                  BDAMATCH     535
  7374* OUTPUT= VACIO                                                                               BDAMATCH     536
  7375* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE                                               BDAMATCH     537
  7376* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS                               BDAMATCH     538
  7377********************************************************************                          BDAMATCH     539
  7378     IF I-NOM-BDAMATCH < LIM-BDAMATCH AND                                                     BDAMATCH     540
  7379        NOM-INPUT-BDAMATCH <> SPACES                                                          BDAMATCH     541
  7380        MOVE NOM-INPUT-BDAMATCH  TO                                                           BDAMATCH     542
  7381             NOM-NOM-BDAMATCH(I-NOM-BDAMATCH)                                                 BDAMATCH     543
  7382                                   NOM-LIMPI-BDAMATCH                                         BDAMATCH     544
  7383        MOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)                               BDAMATCH     545
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 129
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7384        MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCH                            BDAMATCH     546
  7385                            NRO-VECES-2-BDAMATCH                                              BDAMATCH     547
  7386        PERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1                                      BDAMATCH     548
  7387          UNTIL  NRO-VECES-1-BDAMATCH  >  60                                                  BDAMATCH     549
  7388          IF NRO-VECES-1-BDAMATCH  >  1 AND                                                   BDAMATCH     550
  7389           NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "                               BDAMATCH     551
  7390             SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCH                                           BDAMATCH     552
  7391          END-IF                                                                              BDAMATCH     553
  7392          IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "                                 BDAMATCH     554
  7393            COMPUTE  NRO-VECES-2-BDAMATCH =                                                   BDAMATCH     555
  7394                     60 - NRO-VECES-1-BDAMATCH                                                BDAMATCH     556
  7395            MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +                                   BDAMATCH     557
  7396                  1:NRO-VECES-2-BDAMATCH)                                                     BDAMATCH     558
  7397                TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)                                BDAMATCH     559
  7398            IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +                                      BDAMATCH     560
  7399               1:NRO-VECES-2-BDAMATCH) = SPACES                                               BDAMATCH     561
  7400               MOVE  85           TO  NRO-VECES-1-BDAMATCH                                    BDAMATCH     562
  7401            END-IF                                                                            BDAMATCH     563
  7402          END-IF                                                                              BDAMATCH     564
  7403        END-PERFORM                                                                           BDAMATCH     565
  7404        INSPECT NOM-LIMPI-BDAMATCH                                                            BDAMATCH     566
  7405                TALLYING       PESO-CTAS-TOT-BDAMATCH                                         BDAMATCH     567
  7406                FOR CHARACTERS BEFORE INITIAL " "                                             BDAMATCH     568
  7407        MOVE  PESO-CTAS-TOT-BDAMATCH TO                                                       BDAMATCH     569
  7408              LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)                                                BDAMATCH     570
  7409        IF FUENTE-REG-BDACSV >= 02                                RMB0004                     BDAMATCH     571
  7410           MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)            RMB0004                     BDAMATCH     572
  7411        END-IF                                                    RMB0004                     BDAMATCH     573
  7412        MOVE  SUSC-CTAS-BDAMATCH TO                                                           BDAMATCH     574
  7413              SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)                                                BDAMATCH     575
  7414        ADD 1 TO I-NOM-BDAMATCH                                                               BDAMATCH     576
  7415     END-IF.                                                                                  BDAMATCH     577
  7416                                                                                              BDAMATCH     578
  7417 2000-U-INSERTAR-CTA-BDAMATCH.                                                                BDAMATCH     579
  7418********************************************************************                          BDAMATCH     580
  7419*2000-U-INSERTAR-CTA-BDAMATCH.                                                                BDAMATCH     581
  7420* INPUT = CTA-INPUT-BDAMATCH                                                                  BDAMATCH     582
  7421* OUTPUT= VACIO                                                                               BDAMATCH     583
  7422* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA                                     BDAMATCH     584
  7423* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS                               BDAMATCH     585
  7424********************************************************************                          BDAMATCH     586
  7425     IF I-CTA-BDAMATCH < LIM-BDAMATCH AND                                                     BDAMATCH     587
  7426        CTA-INPUT-BDAMATCH <> SPACES                                                          BDAMATCH     588
  7427        ADD 1 TO I-CTA-BDAMATCH                                                               BDAMATCH     589
  7428        MOVE CTA-INPUT-BDAMATCH TO                                                            BDAMATCH     590
  7429             CTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)                                             BDAMATCH     591
  7430        MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH                                       BDAMATCH     592
  7431        MOVE FALLECIDO-BDAMATCH TO                                RMB0003                     BDAMATCH     593
  7432             CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)               RMB0003                     BDAMATCH     594
  7433        IF FUENTE-REG-BDACSV >= 2                                 RMB0004                     BDAMATCH     595
  7434           MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)      RMB0004                     BDAMATCH     596
  7435        END-IF                                                    RMB0004                     BDAMATCH     597
  7436     END-IF.                                                                                  BDAMATCH     598
  7437 3000-U-ORDENAR-DIR-BDAMATCH.                                                                 BDAMATCH     599
  7438********************************************************************                          BDAMATCH     600
  7439*3000-U-ORDENAR-DIR-BDAMATCH.                                                                 BDAMATCH     601
  7440* INPUT = TABLA DE DIRECCIONES LLENA                                                          BDAMATCH     602
  7441* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES                                         BDAMATCH     603
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 130
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7442* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON                                 BDAMATCH     604
  7443* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                                                   BDAMATCH     605
  7444********************************************************************                          BDAMATCH     606
  7445     SORT T-DIR-BDAMATCH                                                                      BDAMATCH     607
  7446          DESCENDING NUM-DIR-BDAMATCH                                                         BDAMATCH     608
  7447          ASCENDING  CTA-DIR-BDAMATCH.                                                        BDAMATCH     609
  7448     MOVE 1 TO I-CTA-BDAMATCH.                                                                BDAMATCH     610
  7449     MOVE 0 TO FIL-FUE-BDAMATCH                                                               BDAMATCH     611
  7450     MOVE 1 TO COL-FUE-BDAMATCH                                                               BDAMATCH     612
  7451     MOVE 999                TO CTA-DIR-ANT-BDAMATCH                                          BDAMATCH     613
  7452     MOVE ALL "9"            TO NUM-DIR-ANT-BDAMATCH                                          BDAMATCH     614
  7453     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR                                           BDAMATCH     615
  7454                         CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0                                 BDAMATCH     616
  7455       IF NUM-DIR-ANT-BDAMATCH <>                                                             BDAMATCH     617
  7456                                 NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)                             BDAMATCH     618
  7457          ADD  1 TO FIL-FUE-BDAMATCH                                                          BDAMATCH     619
  7458          MOVE 1 TO COL-FUE-BDAMATCH                                                          BDAMATCH     620
  7459          MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO                                            BDAMATCH     621
  7460               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)                               BDAMATCH     622
  7461          MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)                                  BDAMATCH     623
  7462          ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)                                      BDAMATCH     624
  7463          MOVE  I-CTA-BDAMATCH       TO  POSIC-SUMA-BDAMATCH                                  BDAMATCH     625
  7464          ADD 1 TO COL-FUE-BDAMATCH                                                           BDAMATCH     626
  7465       ELSE                                                                                   BDAMATCH     627
  7466          IF CTA-DIR-ANT-BDAMATCH <>                                                          BDAMATCH     628
  7467             CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)                                                 BDAMATCH     629
  7468             MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO                                         BDAMATCH     630
  7469               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)                               BDAMATCH     631
  7470             MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)                               BDAMATCH     632
  7471             ADD 1 TO COL-FUE-BDAMATCH                                                        BDAMATCH     633
  7472          END-IF                                                                              BDAMATCH     634
  7473            ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)                               BDAMATCH     635
  7474       END-IF                                                                                 BDAMATCH     636
  7475       MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO                                               BDAMATCH     637
  7476                                          CTA-DIR-ANT-BDAMATCH                                BDAMATCH     638
  7477       MOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO                                               BDAMATCH     639
  7478                                           NUM-DIR-ANT-BDAMATCH                               BDAMATCH     640
  7479       ADD 1 TO I-CTA-BDAMATCH                                                                BDAMATCH     641
  7480     END-PERFORM.                                                                             BDAMATCH     642
  7481     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.                                               BDAMATCH     643
  7482                                                                                              BDAMATCH     644
  7483 3000-U-ORDENAR-TEL-BDAMATCH.                                                                 BDAMATCH     645
  7484********************************************************************                          BDAMATCH     646
  7485*3000-U-ORDENAR-TEL-BDAMATCH.                                                                 BDAMATCH     647
  7486* INPUT = TABLA DE TELEFONOS   LLENA                                                          BDAMATCH     648
  7487* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS                                           BDAMATCH     649
  7488* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON                                   BDAMATCH     650
  7489* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                                                   BDAMATCH     651
  7490********************************************************************                          BDAMATCH     652
  7491     SORT T-TEL-BDAMATCH                                                                      BDAMATCH     653
  7492          DESCENDING NUM-TEL-BDAMATCH                                                         BDAMATCH     654
  7493          ASCENDING  CTA-TEL-BDAMATCH .                                                       BDAMATCH     655
  7494     MOVE 1 TO I-CTA-BDAMATCH.                                                                BDAMATCH     656
  7495     MOVE 1 TO COL-FUE-BDAMATCH                                                               BDAMATCH     657
  7496     MOVE 999      TO CTA-TEL-ANT-BDAMATCH                                                    BDAMATCH     658
  7497     MOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCH                                                    BDAMATCH     659
  7498     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH                                              BDAMATCH     660
  7499             OR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0                                         BDAMATCH     661
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 131
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7500             OR  FIL-FUE-BDAMATCH > LIM-BDAMATCH                                              BDAMATCH     662
  7501             OR  COL-FUE-BDAMATCH > LIM-BDAMATCH                                              BDAMATCH     663
  7502       IF NUM-TEL-ANT-BDAMATCH <>                                                             BDAMATCH     664
  7503          NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)                                                    BDAMATCH     665
  7504          ADD  1 TO FIL-FUE-BDAMATCH                                                          BDAMATCH     666
  7505          MOVE 1 TO COL-FUE-BDAMATCH                                                          BDAMATCH     667
  7506          MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO                                            BDAMATCH     668
  7507               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)                               BDAMATCH     669
  7508          MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)                                  BDAMATCH     670
  7509          ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)                                    BDAMATCH     671
  7510          MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCH                                          BDAMATCH     672
  7511          ADD 1 TO COL-FUE-BDAMATCH                                                           BDAMATCH     673
  7512       ELSE                                                                                   BDAMATCH     674
  7513          IF CTA-TEL-ANT-BDAMATCH <>                                                          BDAMATCH     675
  7514             CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)                                                 BDAMATCH     676
  7515             MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO                                         BDAMATCH     677
  7516                 CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)                             BDAMATCH     678
  7517             MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)                               BDAMATCH     679
  7518             ADD 1 TO COL-FUE-BDAMATCH                                                        BDAMATCH     680
  7519          END-IF                                                                              BDAMATCH     681
  7520            ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)                             BDAMATCH     682
  7521       END-IF                                                                                 BDAMATCH     683
  7522       MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO                                               BDAMATCH     684
  7523                                           CTA-TEL-ANT-BDAMATCH                               BDAMATCH     685
  7524       MOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO                                               BDAMATCH     686
  7525                                           NUM-TEL-ANT-BDAMATCH                               BDAMATCH     687
  7526       ADD 1 TO I-CTA-BDAMATCH                                                                BDAMATCH     688
  7527     END-PERFORM.                                                                             BDAMATCH     689
  7528     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.                                               BDAMATCH     690
  7529                                                                                              BDAMATCH     691
  7530 3000-U-ORDENAR-NOM-BDAMATCH.                                                                 BDAMATCH     692
  7531********************************************************************                          BDAMATCH     693
  7532*3000-U-ORDENAR-NOM-BDAMATCH.                                                                 BDAMATCH     694
  7533* INPUT = TABLA DE NOMBRES     LLENA                                                          BDAMATCH     695
  7534* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES                                             BDAMATCH     696
  7535* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON                                   BDAMATCH     697
  7536* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                                                   BDAMATCH     698
  7537********************************************************************                          BDAMATCH     699
  7538     SORT T-NOM-BDAMATCH                                                                      BDAMATCH     700
  7539          DESCENDING NOM-NOM-BDAMATCH                                                         BDAMATCH     701
  7540          DESCENDING LNG-NOM-BDAMATCH                                                         BDAMATCH     702
  7541          ASCENDING  CTA-NOM-BDAMATCH .                                                       BDAMATCH     703
  7542     MOVE 1 TO I-NOM-BDAMATCH.                                                                BDAMATCH     704
  7543     MOVE 1 TO GRU-NOM-BDAMATCH.                                                              BDAMATCH     705
  7544     MOVE GRU-NOM-BDAMATCH TO                                                                 BDAMATCH     706
  7545          GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).                                                  BDAMATCH     707
  7546     MOVE GRU-NOM-BDAMATCH TO                                                                 BDAMATCH     708
  7547          GRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).                                              BDAMATCH     709
  7548     MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                                 BDAMATCH     710
  7549          NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).                                              BDAMATCH     711
  7550     MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                                 BDAMATCH     712
  7551          SUSC-GRUP-SUS-BDAMATCH                                                              BDAMATCH     713
  7552     MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TO                                          BDAMATCH     714
  7553          SUSC-GRUP-GRU-BDAMATCH                                                              BDAMATCH     715
  7554     PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH                                                  BDAMATCH     716
  7555     IF  INV-BDAMATCH  =  1                                                                   BDAMATCH     717
  7556       ADD   1        TO                                                                      BDAMATCH     718
  7557       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))                            BDAMATCH     719
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 132
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7558     END-IF                                                                                   BDAMATCH     720
  7559     MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                                 BDAMATCH     721
  7560          LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                               BDAMATCH     722
  7561     ADD 1 TO I-NOM-BDAMATCH.                                                                 BDAMATCH     723
  7562     PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCH                                              BDAMATCH     724
  7563             OR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0                                          BDAMATCH     725
  7564       MOVE 1 TO I-GRU-BDAMATCH                                                               BDAMATCH     726
  7565       MOVE 0 TO MATCH-OK-OUT-VALNOM                                                          BDAMATCH     727
  7566       PERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =                                    BDAMATCH     728
  7567               SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCH                                        BDAMATCH     729
  7568               OR MATCH-OK-OUT-VALNOM = 1                                                     BDAMATCH     730
  7569         MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                             BDAMATCH     731
  7570              NOMBRE-INPUT-VALNOM                                                             BDAMATCH     732
  7571         MOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TO                                          BDAMATCH     733
  7572              NOMBOK-INPUT-VALNOM                                                             BDAMATCH     734
  7573         IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3                      RMB0004                     BDAMATCH     735
  7574            IF NUM-IDE-INPUT-BDAMATCH >= 600000000 AND            RMB0004                     BDAMATCH     736
  7575               NUM-IDE-INPUT-BDAMATCH <= 999999999                RMB0004                     BDAMATCH     737
  7576               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     738
  7577               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     739
  7578            ELSE                                                  RMB0004                     BDAMATCH     740
  7579               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004                     BDAMATCH     741
  7580               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004                     BDAMATCH     742
  7581            END-IF                                                RMB0004                     BDAMATCH     743
  7582         ELSE                                                     RMB0004                     BDAMATCH     744
  7583            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004                     BDAMATCH     745
  7584            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     746
  7585         END-IF                                                   RMB0004                     BDAMATCH     747
  7586         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004                     BDAMATCH     748
  7587            NOMBOK-INPUT-VALNOM(43:3) = ".-,"                     RMB0004                     BDAMATCH     749
  7588            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004                     BDAMATCH     750
  7589         END-IF                                                   RMB0004                     BDAMATCH     751
  7590         PERFORM 10000-MATCH-NOMBRES-VALNOM                                                   BDAMATCH     752
  7591         IF MATCH-OK-OUT-VALNOM = 1                                                           BDAMATCH     753
  7592            MOVE I-GRU-BDAMATCH TO                                                            BDAMATCH     754
  7593                 GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)                                            BDAMATCH     755
  7594            MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)                                             BDAMATCH     756
  7595                                 TO  SUSC-GRUP-SUS-BDAMATCH                                   BDAMATCH     757
  7596            MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                      BDAMATCH     758
  7597                                 TO  SUSC-GRUP-GRU-BDAMATCH                                   BDAMATCH     759
  7598            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004                     BDAMATCH     760
  7599               MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004                     BDAMATCH     761
  7600            END-IF                                                RMB0004                     BDAMATCH     762
  7601            PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH                                           BDAMATCH     763
  7602            IF  INV-BDAMATCH  =  1                                                            BDAMATCH     764
  7603              ADD   1  TO                                                                     BDAMATCH     765
  7604       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))                            BDAMATCH     766
  7605            END-IF                                                                            BDAMATCH     767
  7606            IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >                                           BDAMATCH     768
  7607                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                         BDAMATCH     769
  7608              MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                        BDAMATCH     770
  7609                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                         BDAMATCH     771
  7610              MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO            RMB0004                     BDAMATCH     772
  7611                NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)             RMB0004                     BDAMATCH     773
  7612            END-IF                                                                            BDAMATCH     774
  7613         END-IF                                                                               BDAMATCH     775
  7614         ADD 1 TO I-GRU-BDAMATCH                                                              BDAMATCH     776
  7615       END-PERFORM                                                                            BDAMATCH     777
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 133
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7616       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO                                             BDAMATCH     778
  7617          ADD 1 TO GRU-NOM-BDAMATCH                                                           BDAMATCH     779
  7618          MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                            BDAMATCH     780
  7619               NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                          BDAMATCH     781
  7620          MOVE GRU-NOM-BDAMATCH  TO                                                           BDAMATCH     782
  7621               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)                                              BDAMATCH     783
  7622          MOVE GRU-NOM-BDAMATCH  TO                                                           BDAMATCH     784
  7623               GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLM                                  BDAMATCH     785
  7624          MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)                                               BDAMATCH     786
  7625                             TO  SUSC-GRUP-SUS-BDAMATCH                                       BDAMATCH     787
  7626          MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                        BDAMATCH     788
  7627                             TO  SUSC-GRUP-GRU-BDAMATCH                                       BDAMATCH     789
  7628          PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH                                             BDAMATCH     790
  7629          IF  INV-BDAMATCH  =  1                                                              BDAMATCH     791
  7630            ADD   1   TO                                                                      BDAMATCH     792
  7631       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))                            BDAMATCH     793
  7632          END-IF                                                                              BDAMATCH     794
  7633          MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO                                            BDAMATCH     795
  7634               LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)                                          BDAMATCH     796
  7635       ELSE                                                    *>                             BDAMATCH     797
  7636          MOVE GRU-NOM-BDAMATCH TO                                                            BDAMATCH     798
  7637               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLM                                     BDAMATCH     799
  7638       END-IF                                                                                 BDAMATCH     800
  7639       ADD 1 TO I-NOM-BDAMATCH                                                                BDAMATCH     801
  7640     END-PERFORM.                                                                             BDAMATCH     802
  7641     SORT T-NOM-BDAMATCH                                                                      BDAMATCH     803
  7642          DESCENDING NOM-NOM-BDAMATCH                                                         BDAMATCH     804
  7643          DESCENDING GRU-NOMS-BDAMATCH                                                        BDAMATCH     805
  7644          DESCENDING LNG-NOM-BDAMATCH                                                         BDAMATCH     806
  7645          ASCENDING  CTA-NOM-BDAMATCH .                                                       BDAMATCH     807
  7646     MOVE 1 TO I-CTA-BDAMATCH.                                                                BDAMATCH     808
  7647     MOVE 1 TO COL-FUE-BDAMATCH                                                               BDAMATCH     809
  7648     MOVE 999                TO CTA-NOM-ANT-BDAMATCH                                          BDAMATCH     810
  7649     MOVE ALL "9"            TO GRU-NOM-ANT-BDAMATCH                                          BDAMATCH     811
  7650     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH                                              BDAMATCH     812
  7651             OR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0                                         BDAMATCH     813
  7652             OR FIL-FUE-BDAMATCH > LIM-BDAMATCH                                               BDAMATCH     814
  7653             OR COL-FUE-BDAMATCH > LIM-BDAMATCH                                               BDAMATCH     815
  7654       IF GRU-NOM-ANT-BDAMATCH <>                                                             BDAMATCH     816
  7655          GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)                                                   BDAMATCH     817
  7656          ADD  1 TO FIL-FUE-BDAMATCH                                                          BDAMATCH     818
  7657          MOVE 1 TO COL-FUE-BDAMATCH                                                          BDAMATCH     819
  7658          MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO                                            BDAMATCH     820
  7659               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)                               BDAMATCH     821
  7660          MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)                                  BDAMATCH     822
  7661          ADD 1 TO COL-FUE-BDAMATCH                                                           BDAMATCH     823
  7662       ELSE                                                                                   BDAMATCH     824
  7663          IF CTA-NOM-ANT-BDAMATCH <>                                                          BDAMATCH     825
  7664             CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)                                                 BDAMATCH     826
  7665             MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO                                         BDAMATCH     827
  7666                  CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)                            BDAMATCH     828
  7667             MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)                               BDAMATCH     829
  7668             ADD 1 TO COL-FUE-BDAMATCH                                                        BDAMATCH     830
  7669          END-IF                                                                              BDAMATCH     831
  7670       END-IF                                                                                 BDAMATCH     832
  7671       MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO                                               BDAMATCH     833
  7672            CTA-NOM-ANT-BDAMATCH                                                              BDAMATCH     834
  7673       MOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TO                                              BDAMATCH     835
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 134
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7674            GRU-NOM-ANT-BDAMATCH                                                              BDAMATCH     836
  7675       ADD 1 TO I-CTA-BDAMATCH                                                                BDAMATCH     837
  7676     END-PERFORM.                                                                             BDAMATCH     838
  7677     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.                                               BDAMATCH     839
  7678                                                                                              BDAMATCH     840
  7679 4000-U-INTERELACIONAR-BDAMATCH.                                                              BDAMATCH     841
  7680********************************************************************                          BDAMATCH     842
  7681*4000-U-INTERELACIONAR-BDAMATCH.                                                              BDAMATCH     843
  7682* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS                         BDAMATCH     844
  7683* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS                                BDAMATCH     845
  7684* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON                                   BDAMATCH     846
  7685* INSERTADOS EN LA TABLA DE RELACIONAMIENTO                                                   BDAMATCH     847
  7686********************************************************************                          BDAMATCH     848
  7687*    PERFORM 1110-MOSTRAR-MATRIZ1                                 RMB0004                     BDAMATCH     849
  7688     MOVE 1 TO MOVIDO-BDAMATCH    .                                                           BDAMATCH     850
  7689     PERFORM UNTIL MOVIDO-BDAMATCH = 0                                                        BDAMATCH     851
  7690        MOVE 0 TO MOVIDO-BDAMATCH                                                             BDAMATCH     852
  7691        MOVE 1 TO FIL-BUS-BDAMATCH                                                            BDAMATCH     853
  7692        PERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCH                                     BDAMATCH     854
  7693          MOVE 1 TO COL-BUS-BDAMATCH                                                          BDAMATCH     855
  7694          PERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCH                               BDAMATCH     856
  7695            IF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)                               BDAMATCH     857
  7696               > 0                                                                            BDAMATCH     858
  7697            MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)                             BDAMATCH     859
  7698                 TO BUSCADO-BDAMATCH                                                          BDAMATCH     860
  7699               PERFORM 4100-BUSCAR-RELACION-BDAMATCH                                          BDAMATCH     861
  7700            ELSE                                                                              BDAMATCH     862
  7701               MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCH                                  BDAMATCH     863
  7702            END-IF                                                                            BDAMATCH     864
  7703            ADD 1 TO COL-BUS-BDAMATCH                                                         BDAMATCH     865
  7704          END-PERFORM                                                                         BDAMATCH     866
  7705          ADD 1 TO FIL-BUS-BDAMATCH                                                           BDAMATCH     867
  7706        END-PERFORM                                                                           BDAMATCH     868
  7707     END-PERFORM.                                                                             BDAMATCH     869
  7708                                                                                              BDAMATCH     870
  7709 4100-BUSCAR-RELACION-BDAMATCH.                                                               BDAMATCH     871
  7710********************************************************************                          BDAMATCH     872
  7711*4100-BUSCAR-RELACION-BDAMATCH.                                                               BDAMATCH     873
  7712* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA                              BDAMATCH     874
  7713********************************************************************                          BDAMATCH     875
  7714     MOVE 1 TO FIL-FUE-BDAMATCH.                                                              BDAMATCH     876
  7715     PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH                                        BDAMATCH     877
  7716        IF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCH                                               BDAMATCH     878
  7717           MOVE 0 TO EXISTE-BDAMATCH                                                          BDAMATCH     879
  7718           INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)                                        BDAMATCH     880
  7719              TALLYING EXISTE-BDAMATCH                                                        BDAMATCH     881
  7720              FOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCH                                BDAMATCH     882
  7721            ADD 1 TO EXISTE-BDAMATCH                                                          BDAMATCH     883
  7722            IF EXISTE-BDAMATCH <= 2000                                                        BDAMATCH     884
  7723                PERFORM 4110-MOVER-RELACIONES-BDAMATCH                                        BDAMATCH     885
  7724           END-IF                                                                             BDAMATCH     886
  7725        END-IF                                                                                BDAMATCH     887
  7726        ADD 1 TO FIL-FUE-BDAMATCH                                                             BDAMATCH     888
  7727     END-PERFORM.                                                                             BDAMATCH     889
  7728                                                                                              BDAMATCH     890
  7729 4110-MOVER-RELACIONES-BDAMATCH.                                                              BDAMATCH     891
  7730********************************************************************                          BDAMATCH     892
  7731*4110-MOVER-RELACIONES-BDAMATCH.                                                              BDAMATCH     893
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 135
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7732* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES                              BDAMATCH     894
  7733* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA                                              BDAMATCH     895
  7734********************************************************************                          BDAMATCH     896
  7735       MOVE 0 TO FIN-FUENTE-BDAMATCH.                                                         BDAMATCH     897
  7736       INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)                                            BDAMATCH     898
  7737               TALLYING FIN-FUENTE-BDAMATCH                                                   BDAMATCH     899
  7738               FOR CHARACTERS BEFORE INITIAL "000 "                                           BDAMATCH     900
  7739       COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4                                  BDAMATCH     901
  7740       MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.                                                      BDAMATCH     902
  7741       INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)                                            BDAMATCH     903
  7742               TALLYING LIBRE-BUSCADO-BDAMATCH                                                BDAMATCH     904
  7743               FOR CHARACTERS BEFORE INITIAL "000 "                                           BDAMATCH     905
  7744       COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4                            BDAMATCH     906
  7745       ADD 1 TO LIBRE-BUSCADO-BDAMATCH.                                                       BDAMATCH     907
  7746       MOVE 1 TO COL-FUE-BDAMATCH.                                                            BDAMATCH     908
  7747       PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCH                                   BDAMATCH     909
  7748          MOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TO                            BDAMATCH     910
  7749                         PORINSERTAR-BDAMATCH                                                 BDAMATCH     911
  7750          MOVE 0 TO EXISTE-BDAMATCH                                                           BDAMATCH     912
  7751          INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)                                         BDAMATCH     913
  7752               TALLYING EXISTE-BDAMATCH                                                       BDAMATCH     914
  7753              FOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCH                            BDAMATCH     915
  7754          ADD 1 TO EXISTE-BDAMATCH                                                            BDAMATCH     916
  7755          IF EXISTE-BDAMATCH > 2000                                                           BDAMATCH     917
  7756            MOVE PORINSERTAR-BDAMATCH TO                                                      BDAMATCH     918
  7757            CAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)                            BDAMATCH     919
  7758            ADD 1 TO LIBRE-BUSCADO-BDAMATCH                                                   BDAMATCH     920
  7759            MOVE 1 TO MOVIDO-BDAMATCH                                                         BDAMATCH     921
  7760          END-IF                                                                              BDAMATCH     922
  7761          ADD 1 TO COL-FUE-BDAMATCH                                                           BDAMATCH     923
  7762       END-PERFORM.                                                                           BDAMATCH     924
  7763       INITIALIZE                                                                             BDAMATCH     925
  7764            FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR                            BDAMATCH     926
  7765                                                                                              BDAMATCH     927
  7766 5000-U-MEJOR-PORTAFOL-BDAMATCH.                                                              BDAMATCH     928
  7767********************************************************************                          BDAMATCH     929
  7768*5000-U-MEJOR-PORTAFOL-BDAMATCH.                                                              BDAMATCH     930
  7769* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL                             BDAMATCH     931
  7770* PORTAFOLIO QUE TIENE MAS CUENTAS                                                            BDAMATCH     932
  7771********************************************************************                          BDAMATCH     933
  7772      MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.                                                    BDAMATCH     934
  7773      MOVE 0 TO MAXREL-PER-BDAMATCH                                                           BDAMATCH     935
  7774      MOVE 0 TO FIN-FUENTE-BDAMATCH.                                                          BDAMATCH     936
  7775      MOVE 1 TO FIL-FUE-BDAMATCH.                                                             BDAMATCH     937
  7776      MOVE 0 TO  PESOS-CTRL-BDAMATCH                                                          BDAMATCH     938
  7777      PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH                                       BDAMATCH     939
  7778        INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)                                           BDAMATCH     940
  7779               TALLYING FIN-FUENTE-BDAMATCH                                                   BDAMATCH     941
  7780               FOR CHARACTERS BEFORE INITIAL "000 "                                           BDAMATCH     942
  7781        COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4                              BDAMATCH     943
  7782        MOVE 0 TO PESO-CTAS-TOT-BDAMATCH                                                      BDAMATCH     944
  7783        MOVE 1 TO POSIC-SUMA-BDAMATCH                                                         BDAMATCH     945
  7784        MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH                   RMB0004                     BDAMATCH     946
  7785        MOVE 0 TO  POSIC-SUSC-BDAMATCH                            RMB0004                     BDAMATCH     947
  7786        MOVE 0 TO ENT-FIN-PORT-BDAMATCH                           RMB0004                     BDAMATCH     948
  7787        MOVE 0 TO ENT-UNICAS-PORT-BDAMATCH                        RMB0004                     BDAMATCH     949
  7788        PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1                                BDAMATCH     950
  7789           UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCH                                BDAMATCH     951
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 136
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7790           MOVE                                                                               BDAMATCH     952
  7791        FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)                            BDAMATCH     953
  7792                TO  CTA-A-BUSCAR-BDAMATCH                                                     BDAMATCH     954
  7793           IF CTA-A-BUSCAR-BDAMATCH > 0                           RMB0004                     BDAMATCH     955
  7794            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004                     BDAMATCH     956
  7795                 TO SUSC-CTAS-BDAMATCH                            RMB0004                     BDAMATCH     957
  7796            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005                     BDAMATCH     958
  7797                 TO I2-BDAMATCH                                   RMB0005                     BDAMATCH     959
  7798            PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCH               RMB0004                     BDAMATCH     960
  7799            PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCH               RMB0004                     BDAMATCH     961
  7800            PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCH               RMB0004                     BDAMATCH     962
  7801           END-IF                                                 RMB0004                     BDAMATCH     963
  7802           ADD 4 TO  POSIC-SUMA-BDAMATCH                                                      BDAMATCH     964
  7803        END-PERFORM                                                                           BDAMATCH     965
  7804        PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCH                    RMB0004                     BDAMATCH     966
  7805        ADD 1 TO FIL-FUE-BDAMATCH                                                             BDAMATCH     967
  7806      END-PERFORM.                                                                            BDAMATCH     968
  7807 5100-CALCULAR-PESO-DIR-BDAMATCH.                                 RMB0004                     BDAMATCH     969
  7808     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1       RMB0004                     BDAMATCH     970
  7809        UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH OR           RMB0004                     BDAMATCH     971
  7810        CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROS           RMB0004                     BDAMATCH     972
  7811        IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)                 RMB0004                     BDAMATCH     973
  7812                                     =  CTA-A-BUSCAR-BDAMATCH     RMB0004                     BDAMATCH     974
  7813          COMPUTE PESO-CTAS-TOT-BDAMATCH  =                       RMB0004                     BDAMATCH     975
  7814                   PESO-CTAS-TOT-BDAMATCH +                       RMB0004                     BDAMATCH     976
  7815          (NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *          RMB0004                     BDAMATCH     977
  7816                  PESO-DIR-BDAMATCH )                             RMB0004                     BDAMATCH     978
  7817        END-IF                                                    RMB0004                     BDAMATCH     979
  7818     END-PERFORM.                                                 RMB0004                     BDAMATCH     980
  7819 5200-CALCULAR-PESO-TEL-BDAMATCH.                                 RMB0004                     BDAMATCH     981
  7820     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1             RMB0004                     BDAMATCH     982
  7821        UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH OR              RMB0004                     BDAMATCH     983
  7822        CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROS            RMB0004                     BDAMATCH     984
  7823        IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)                RMB0004                     BDAMATCH     985
  7824                                      =  CTA-A-BUSCAR-BDAMATCH    RMB0004                     BDAMATCH     986
  7825          COMPUTE  PESO-CTAS-TOT-BDAMATCH  =                      RMB0004                     BDAMATCH     987
  7826             PESO-CTAS-TOT-BDAMATCH +                             RMB0004                     BDAMATCH     988
  7827           (NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *         RMB0004                     BDAMATCH     989
  7828             PESO-TEL-BDAMATCH )                                  RMB0004                     BDAMATCH     990
  7829        END-IF                                                    RMB0004                     BDAMATCH     991
  7830     END-PERFORM.                                                 RMB0004                     BDAMATCH     992
  7831 5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004                     BDAMATCH     993
  7832******************************************************************                            BDAMATCH     994
  7833*5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004                     BDAMATCH     995
  7834* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO                              BDAMATCH     996
  7835* LAS ENTIDADES UNICAS Y LAS FINANCIERAS                                                      BDAMATCH     997
  7836******************************************************************                            BDAMATCH     998
  7837     SET IND-DIR-BDAMATCH TO 1.                                   RMB0004                     BDAMATCH     999
  7838     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT END                      RMB0004                     BDAMATCH    1000
  7839         MOVE 1 TO  INV-BDAMATCH                                  RMB0004                     BDAMATCH    1001
  7840       WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =             RMB0004                     BDAMATCH    1002
  7841            SUSC-CTAS-BDAMATCH                                    RMB0004                     BDAMATCH    1003
  7842         MOVE 0 TO  INV-BDAMATCH                                  RMB0004                     BDAMATCH    1004
  7843     END-SEARCH.                                                  RMB0004                     BDAMATCH    1005
  7844     IF INV-BDAMATCH  =  1                                        RMB0004                     BDAMATCH    1006
  7845        AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCH                  RMB0004                     BDAMATCH    1007
  7846        COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004                     BDAMATCH    1008
  7847                                       + PESO-NOM-BDAMATCH        RMB0004                     BDAMATCH    1009
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 137
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7848        ADD   1                TO  POSIC-SUSC-BDAMATCH            RMB0004                     BDAMATCH    1010
  7849        MOVE SUSC-CTAS-BDAMATCH  TO                               RMB0004                     BDAMATCH    1011
  7850             COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)           RMB0004                     BDAMATCH    1012
  7851*       MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCH             RMB0005                     BDAMATCH    1013
  7852        IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100                 RMB0005                     BDAMATCH    1014
  7853           IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2             RMB0005                     BDAMATCH    1015
  7854              ADD 1 TO ENT-FIN-PORT-BDAMATCH                      RMB0005                     BDAMATCH    1016
  7855           END-IF                                                 RMB0005                     BDAMATCH    1017
  7856        END-IF                                                    RMB0005                     BDAMATCH    1018
  7857        ADD 1 TO ENT-UNICAS-PORT-BDAMATCH                         RMB0004                     BDAMATCH    1019
  7858     END-IF.                                                      RMB0004                     BDAMATCH    1020
  7859     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1        RMB0004                     BDAMATCH    1021
  7860        ADD 1000 TO PESO-CTAS-TOT-BDAMATCH                        RMB0004                     BDAMATCH    1022
  7861     END-IF.                                                      RMB0004                     BDAMATCH    1023
  7862 5400-DEDUCIR-MEJ-PORT-BDAMATCH.                                  RMB0004                     BDAMATCH    1024
  7863     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCH                 RMB0004                     BDAMATCH    1025
  7864        MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCH        RMB0004                     BDAMATCH    1026
  7865     END-IF                                                       RMB0004                     BDAMATCH    1027
  7866     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCH            RMB0004                     BDAMATCH    1028
  7867        MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004                     BDAMATCH    1029
  7868        MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004                     BDAMATCH    1030
  7869        MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004                     BDAMATCH    1031
  7870     ELSE                                                         RMB0004                     BDAMATCH    1032
  7871        IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCH         RMB0004                     BDAMATCH    1033
  7872           PERFORM 5410-DESEMPATAR-BDAMATCH                       RMB0004                     BDAMATCH    1034
  7873        END-IF                                                    RMB0004                     BDAMATCH    1035
  7874     END-IF.                                                      RMB0004                     BDAMATCH    1036
  7875 5410-DESEMPATAR-BDAMATCH.                                        RMB0004                     BDAMATCH    1037
  7876      IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCH        RMB0004                     BDAMATCH    1038
  7877         MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004                     BDAMATCH    1039
  7878         MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004                     BDAMATCH    1040
  7879         MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004                     BDAMATCH    1041
  7880      ELSE                                                        RMB0004                     BDAMATCH    1042
  7881         IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004                     BDAMATCH    1043
  7882            IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 AND      RMB0004                     BDAMATCH    1044
  7883               NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004                     BDAMATCH    1045
  7884                                                             ".-,"RMB0004                     BDAMATCH    1046
  7885               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004                     BDAMATCH    1047
  7886               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004                     BDAMATCH    1048
  7887               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004                     BDAMATCH    1049
  7888                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004                     BDAMATCH    1050
  7889            ELSE                                                  RMB0004                     BDAMATCH    1051
  7890              IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >          RMB0004                     BDAMATCH    1052
  7891                 LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004                     BDAMATCH    1053
  7892               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004                     BDAMATCH    1054
  7893               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004                     BDAMATCH    1055
  7894               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004                     BDAMATCH    1056
  7895                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004                     BDAMATCH    1057
  7896            END-IF                                                RMB0004                     BDAMATCH    1058
  7897         END-IF                                                   RMB0004                     BDAMATCH    1059
  7898      END-IF.                                                     RMB0004                     BDAMATCH    1060
  7899 5000-U-VALIDAR-CUENTA-BDAMATCH.                                                              BDAMATCH    1061
  7900*********************************************************************                         BDAMATCH    1062
  7901*5000-U-VALIDAR-CUENTA-BDAMATCH.                                                              BDAMATCH    1063
  7902* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO                         BDAMATCH    1064
  7903* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH                                 BDAMATCH    1065
  7904*********************************************************************                         BDAMATCH    1066
  7905     MOVE 0 TO VALCTA-OUTPUT-BDAMATCH                                                         BDAMATCH    1067
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 138
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7906     MOVE 1 TO I-BDAMATCH.                                                                    BDAMATCH    1068
  7907     IF MEJOR-PORTAFOLIO-BDAMATCH > 0                                                         BDAMATCH    1069
  7908        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR                                            BDAMATCH    1070
  7909          VALCTA-OUTPUT-BDAMATCH = 1 OR                                                       BDAMATCH    1071
  7910          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0                             BDAMATCH    1072
  7911          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)                            BDAMATCH    1073
  7912               TO J-BDAMATCH                                                                  BDAMATCH    1074
  7913          IF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCH                            BDAMATCH    1075
  7914             MOVE 1 TO VALCTA-OUTPUT-BDAMATCH                                                 BDAMATCH    1076
  7915          END-IF                                                                              BDAMATCH    1077
  7916          ADD 1 TO I-BDAMATCH                                                                 BDAMATCH    1078
  7917        END-PERFORM                                                                           BDAMATCH    1079
  7918     END-IF.                                                                                  BDAMATCH    1080
  7919*                                                                                             BDAMATCH    1081
  7920 6000-U-MEJOR-DIR-BDAMATCH.                                                                   BDAMATCH    1082
  7921*********************************************************************                         BDAMATCH    1083
  7922*6000-U-MEJOR-DIR-BDAMATCH.                                                                   BDAMATCH    1084
  7923*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION                               BDAMATCH    1085
  7924*********************************************************************                         BDAMATCH    1086
  7925     SORT T-DIR-BDAMATCH                                                                      BDAMATCH    1087
  7926          DESCENDING  NUM-CTAS-DIR-BDAMATCH                                                   BDAMATCH    1088
  7927          DESCENDING       LNG-DIR-BDAMATCH                                                   BDAMATCH    1089
  7928          DESCENDING       NUM-DIR-BDAMATCH                                                   BDAMATCH    1090
  7929          DESCENDING       CTA-DIR-BDAMATCH.                                                  BDAMATCH    1091
  7930    MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.                                       BDAMATCH    1092
  7931                                                                                              BDAMATCH    1093
  7932 6000-U-MEJOR-TEL-BDAMATCH.                                                                   BDAMATCH    1094
  7933*********************************************************************                         BDAMATCH    1095
  7934*6000-U-MEJOR-TEL-BDAMATCH.                                                                   BDAMATCH    1096
  7935*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO                                 BDAMATCH    1097
  7936*********************************************************************                         BDAMATCH    1098
  7937     SORT T-TEL-BDAMATCH                                                                      BDAMATCH    1099
  7938          DESCENDING  NUM-CTAS-TEL-BDAMATCH                                                   BDAMATCH    1100
  7939          DESCENDING       NUM-TEL-BDAMATCH                                                   BDAMATCH    1101
  7940          DESCENDING       CTA-TEL-BDAMATCH.                                                  BDAMATCH    1102
  7941    MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.                                       BDAMATCH    1103
  7942*                                                                                             BDAMATCH    1104
  7943 6000-U-MEJOR-NOM-BDAMATCH.                                                                   BDAMATCH    1105
  7944*********************************************************************                         BDAMATCH    1106
  7945*6000-U-MEJOR-NOM-BDAMATCH.                                                                   BDAMATCH    1107
  7946*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE                                     BDAMATCH    1108
  7947*********************************************************************                         BDAMATCH    1109
  7948     SORT T-GRUNOM-BDAMATCH                                                                   BDAMATCH    1110
  7949          DESCENDING  NUM-CTAS-GRUNOM-BDAMATCH                                                BDAMATCH    1111
  7950          DESCENDING  LNG-GRUNOM-BDAMATCH                                                     BDAMATCH    1112
  7951          DESCENDING  NOM-GRUNOM-BDAMATCH.                                                    BDAMATCH    1113
  7952     MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.                                                       BDAMATCH    1114
  7953     PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1                                      BDAMATCH    1115
  7954       UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCH                                            BDAMATCH    1116
  7955          OR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROS                            BDAMATCH    1117
  7956          OR ESTA-CTA-BDAMATCH  =  1                                                          BDAMATCH    1118
  7957      PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1                                     BDAMATCH    1119
  7958       UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH                                            BDAMATCH    1120
  7959          OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROS                                 BDAMATCH    1121
  7960          OR ESTA-CTA-BDAMATCH  =  1                                                          BDAMATCH    1122
  7961        IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =                                    BDAMATCH    1123
  7962            GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)                                          BDAMATCH    1124
  7963         PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1                                  BDAMATCH    1125
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 139
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  7964          UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCH                                         BDAMATCH    1126
  7965           OR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,                                        BDAMATCH    1127
  7966              NRO-VECES-1-BDAMATCH) = 0                                                       BDAMATCH    1128
  7967           OR ESTA-CTA-BDAMATCH  =  1                                                         BDAMATCH    1129
  7968           IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =                                      BDAMATCH    1130
  7969               CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,                                       BDAMATCH    1131
  7970                             NRO-VECES-1-BDAMATCH)                                            BDAMATCH    1132
  7971             MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TO                                  BDAMATCH    1133
  7972                  POSIC-SUS-GRU-BDAMATCH                                                      BDAMATCH    1134
  7973             MOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TO                                BDAMATCH    1135
  7974                  NOM-OUTPUT-BDAMATCH                                                         BDAMATCH    1136
  7975             MOVE 1 TO  ESTA-CTA-BDAMATCH                                                     BDAMATCH    1137
  7976           END-IF                                                                             BDAMATCH    1138
  7977         END-PERFORM                                                                          BDAMATCH    1139
  7978        END-IF                                                                                BDAMATCH    1140
  7979      END-PERFORM                                                                             BDAMATCH    1141
  7980     END-PERFORM.                                                                             BDAMATCH    1142
  7981*                                                                                             BDAMATCH    1143
  7982 9000-U-REALIZAR-BDAMATCH.                                                                    BDAMATCH    1144
  7983******************************************************************                            BDAMATCH    1145
  7984*9000-U-REALIZAR-BDAMATCH.                                                                    BDAMATCH    1146
  7985* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL                                 BDAMATCH    1147
  7986* MEJOR NOMBRE                                                                                BDAMATCH    1148
  7987******************************************************************                            BDAMATCH    1149
  7988     MOVE  ZEROS                 TO  POSIC-SUSC-BDAMATCH                                      BDAMATCH    1150
  7989     MOVE  ALL "9"               TO  TABLA-SUSC-DIR-BDAMATCH                                  BDAMATCH    1151
  7990     PERFORM 3000-U-ORDENAR-DIR-BDAMATCH                                                      BDAMATCH    1152
  7991     PERFORM 3000-U-ORDENAR-TEL-BDAMATCH                                                      BDAMATCH    1153
  7992     PERFORM 3000-U-ORDENAR-NOM-BDAMATCH                                                      BDAMATCH    1154
  7993     PERFORM 4000-U-INTERELACIONAR-BDAMATCH                                                   BDAMATCH    1155
  7994     PERFORM 6000-U-MEJOR-DIR-BDAMATCH.                                                       BDAMATCH    1156
  7995     PERFORM 6000-U-MEJOR-TEL-BDAMATCH.                                                       BDAMATCH    1157
  7996     PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.                                                  BDAMATCH    1158
  7997     PERFORM 6000-U-MEJOR-NOM-BDAMATCH.                                                       BDAMATCH    1159
  7998*                                                                                             BDAMATCH    1160
  7999 9010-U-VER-FALLECIDO-BDAMATCH.                                                               BDAMATCH    1161
  8000*********************************************************************                         BDAMATCH    1162
  8001*9010-U-VER-FALLECIDO-BDAMATCH.                                                               BDAMATCH    1163
  8002* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL                           BDAMATCH    1164
  8003* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.                                         BDAMATCH    1165
  8004*********************************************************************                         BDAMATCH    1166
  8005     MOVE 1 TO I-BDAMATCH.                                        RMB0003                     BDAMATCH    1167
  8006     IF MEJOR-PORTAFOLIO-BDAMATCH > 0                             RMB0003                     BDAMATCH    1168
  8007        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR                RMB0003                     BDAMATCH    1169
  8008          VALCTA-OUTPUT-BDAMATCH = 1 OR                           RMB0003                     BDAMATCH    1170
  8009          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003                     BDAMATCH    1171
  8010          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003                     BDAMATCH    1172
  8011               TO J-BDAMATCH                                      RMB0003                     BDAMATCH    1173
  8012          ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCH                       RMB0003                     BDAMATCH    1174
  8013          IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1               RMB0003                     BDAMATCH    1175
  8014             ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCH                 RMB0003                     BDAMATCH    1176
  8015          END-IF                                                  RMB0003                     BDAMATCH    1177
  8016          ADD 1 TO I-BDAMATCH                                     RMB0003                     BDAMATCH    1178
  8017        END-PERFORM                                               RMB0003                     BDAMATCH    1179
  8018     END-IF.                                                      RMB0003                     BDAMATCH    1180
  8019*                                                                 RMB0003                     BDAMATCH    1181
  8020 400-BUSCAR-SUSC-GRUPO-BDAMATCH.                                                              BDAMATCH    1182
  8021******************************************************************                            BDAMATCH    1183
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 140
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/BDAMATCH.P
  8022*400-BUSCAR-SUSC-GRUPO-BDAMATCH.                                                              BDAMATCH    1184
  8023* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.                                         BDAMATCH    1185
  8024******************************************************************                            BDAMATCH    1186
  8025     SET IND-NOM-BDAMATCH TO 1.                                                               BDAMATCH    1187
  8026     SEARCH ALL REG-SUSC-NOM-BDAMATCH AT END                                                  BDAMATCH    1188
  8027         MOVE 1 TO  INV-BDAMATCH                                                              BDAMATCH    1189
  8028         WHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =                                       BDAMATCH    1190
  8029              SUSC-GRUPO-BDAMATCH                                                             BDAMATCH    1191
  8030         MOVE 0 TO  INV-BDAMATCH                                                              BDAMATCH    1192
  8031     END-SEARCH.                                                                              BDAMATCH    1193
  8032     IF  INV-BDAMATCH = 1                                                                     BDAMATCH    1194
  8033     AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCH                                               BDAMATCH    1195
  8034       ADD 1 TO  POSIC-SUS-GRU-BDAMATCH                                                       BDAMATCH    1196
  8035       MOVE SUSC-GRUP-SUS-BDAMATCH TO                                                         BDAMATCH    1197
  8036            COD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)                                     BDAMATCH    1198
  8037       MOVE SUSC-GRUP-GRU-BDAMATCH TO                                                         BDAMATCH    1199
  8038            GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)                                    BDAMATCH    1200
  8039     END-IF.                                                                                  BDAMATCH    1201
* 8040 COPY AMNISTIA21.PROC.                                                                        LEEMAEST      39
  8041*AMNISTIA21.PROC.v.0013                                                                       AMNISTIA       1
  8042* OJO CAMBIO PARA QUE APLIQUE CON 2n y no 2n+1 y solo hasta que                               AMNISTIA       2
  8043* FISICAMENTE SE HAYA RECIBIDO LA INFORMACIÓN                                                 AMNISTIA       3
  8044****************************************************************                              AMNISTIA       4
  8045                                                                                              AMNISTIA       5
  8046* 21/01/2009                                                                                  AMNISTIA       6
  8047******************************************************************                            AMNISTIA       7
  8048*  Interpretación técnica de la Aplicación la ley de habeas data                              AMNISTIA       8
  8049*  para Datacredito según la discusión del documento                                          AMNISTIA       9
  8050*  "Amnistía - temas por definir" y la aplicación de las                                      AMNISTIA      10
  8051*  definiciones dadas.                                                                        AMNISTIA      11
  8052*                                                                                             AMNISTIA      12
  8053*  La aplicación de la amnistía a cuentas para un individuo                                   AMNISTIA      13
  8054*  se otorgará solo bajo las siguiente condiciones:                                           AMNISTIA      14
  8055*                                                                                             AMNISTIA      15
  8056*  Para cualquier fecha de consulta al individuo después de                                   AMNISTIA      16
  8057*  la aprobación o vigencia de la ley                                                         AMNISTIA      17
  8058*                                                                                             AMNISTIA      18
  8059* -> Sí el individuo está al día en todas sus obligaciones                                    AMNISTIA      19
  8060*   (sin importar fecha de actualización)                                                     AMNISTIA      20
  8061*                                                                                             AMNISTIA      21
  8062* ->      Sí el individuo tiene cuentas canceladas que hayan                                  AMNISTIA      22
  8063*    tenido mora y llevan un año o más de cancelación                                         AMNISTIA      23
  8064*                                                                                             AMNISTIA      24
  8065* -> Sí la fecha de la consulta está dentro del                                               AMNISTIA      25
  8066*    periodo de gracia                                                                        AMNISTIA      26
  8067*                                                                                             AMNISTIA      27
  8068*    = Se deben amnistiar dichas cuentas canceladas                                           AMNISTIA      28
  8069*                                                                                             AMNISTIA      29
  8070* -> Sí la fecha de la consulta es posterior al                                               AMNISTIA      30
  8071*    periodo de gracia                                                                        AMNISTIA      31
  8072*                                                                                             AMNISTIA      32
  8073*    -> Sí no existe ninguna mora después del                                                 AMNISTIA      33
  8074*       periodo de gracia                                                                     AMNISTIA      34
  8075*                                                                                             AMNISTIA      35
  8076*       = Se deben amnistiar dichas cuentas canceladas                                        AMNISTIA      36
  8077******************************************************************                            AMNISTIA      37
  8078*  Colorarios:                                                                                AMNISTIA      38
  8079*                                                                                             AMNISTIA      39
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 141
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8080* - Solo se amnistían las cuentas canceladas que tuvieron mora                                AMNISTIA      40
  8081*                                                                                             AMNISTIA      41
  8082* - El derecho a la amnistía de obligaciones se pierde si incurre                             AMNISTIA      42
  8083*   en mora el individuo después del periodo de gracia                                        AMNISTIA      43
  8084*                                                                                             AMNISTIA      44
  8085* - Solo se tiene el derecho a la amnistía de cuentas si el                                   AMNISTIA      45
  8086*   individuo está con todas sus obligaciones al día                                          AMNISTIA      46
  8087*                                                                                             AMNISTIA      47
  8088******************************************************************                            AMNISTIA      48
  8089* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*                            AMNISTIA      49
  8090* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *                            AMNISTIA      50
  8091* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *                            AMNISTIA      51
  8092*            | AJUST1 - AJUSTES A LAS RUTINA DE CALCULO DE AMNIS-*                            AMNISTIA      52
  8093*            |          TIA CON 48 POSICIONES                    *                            AMNISTIA      53
  8094******************************************************************                            AMNISTIA      54
  8095* CAV0003    | MORVEC - NO ASUMIR EL ESTADO DEL VECTOR PARA EL   *                            AMNISTIA      55
  8096* 19-DIC-2008|    MES EN QUE SE HACE LA CONSULTA. SE CAMBIA LA   *                            AMNISTIA      56
  8097* C. VELASCO |    CONDICION DE PRIMERA MORA DEL VECTOR DE MENOR  *                            AMNISTIA      57
  8098*            |    A 12 MESES PARA NO AMNISTIAR A MENOR IGUAL A 12*                            AMNISTIA      58
  8099******************************************************************                            AMNISTIA      59
  8100* GJC0004    | LEY002 - POR SOLICITUD DE JURIDICO SE DEBE APLICAR*                            AMNISTIA      60
  8101* 21-ENE-2009|    AMNISTIA A CARTERAS RECUPERADAS Y CANCELADAS   *                            AMNISTIA      61
  8102* G. JIMENEZ |    POR MAL MANEJO AUNQUE NO TENGAN MORA MAXIMA >  *                            AMNISTIA      62
  8103*            |    QUE 0. O VECTOR SIN HISTORIA                   *                            AMNISTIA      63
  8104******************************************************************                            AMNISTIA      64
  8105* GJC0005    | LEY003 - SE DEJA EL PERDON DE LAS CARTERAS RECUPE-*                            AMNISTIA      65
  8106* 19-MAR-2009|    RADAS Y CANCELADAS POR MAL MANEJO CON IGUAL    *                            AMNISTIA      66
  8107* G. JIMENEZ |    MANEJO QUE CUALQUIER OTRA CUENTA QUE HAYA TENI-*                            AMNISTIA      67
  8108*            |    DO MORA.                                       *                            AMNISTIA      68
  8109******************************************************************                            AMNISTIA      69
  8110* GJC0006    | LEY004 - APLICACION DE ARTICULO 13 DE LA LEY 1266 *                            AMNISTIA      70
  8111* 28-ENE-2009|    CORRESPONDIENTE A LA APLICACION DE CADUCIDADES *                            AMNISTIA      71
  8112* G. JIMENEZ |    EN UN TIEMPO CORRESPONDIENTE AL DOBLE DE LA    *                            AMNISTIA      72
  8113*            |    MORA                                           *                            AMNISTIA      73
  8114******************************************************************                            AMNISTIA      74
  8115* GJC0007    | LEY005 - AJUSTE A RECALCULO DE NOVEDAD PARA QUE SI*                            AMNISTIA      75
  8116* 05-JUN-2009|    HAY CARTERA RECUPERADA O CANCELADA POR MAL MANE*                            AMNISTIA      76
  8117* G. JIMENEZ |    JO SIN MORAS SOLO SE PERDONE EL ESTADO SI LA   *                            AMNISTIA      77
  8118*            |    CUENTA TUVO PERDON DE OTRA FORMA NO            *                            AMNISTIA      78
  8119******************************************************************                            AMNISTIA      79
  8120* GJC0008    | LEY006 - AJUSTE PARA QUE CUANDO EN EL MES QUE SE  *                            AMNISTIA      80
  8121* 09-JUN-2009|   CUMPLE EL TIEMPO DEL PERDON HAY MORA PARA LA    *                            AMNISTIA      81
  8122* G. JIMENEZ |   IDENTIFICACION Y HAY QUE HACER DESPLAZAMIENTO SE*                            AMNISTIA      82
  8123*            |   APLIQUE EL PERDON ADECUADAMENTE                 *                            AMNISTIA      83
  8124*            |   SE TOMA LA FECHA DEL CURRENT DATE POR CADA TRAN-*                            AMNISTIA      84
  8125*            |   SACCION QUE ENTRA A LA RUTINA                                                AMNISTIA      85
  8126******************************************************************                            AMNISTIA      86
  8127* GJC0009    | LEY007 - SE CAMBIA LA APLICACION DE ARTICULO 13 DE*                            AMNISTIA      87
  8128* 26-JUN-2009|   POR PERSONA A POR CUENTA                        *                            AMNISTIA      88
  8129* G. JIMENEZ |                                                   *                            AMNISTIA      89
  8130******************************************************************                            AMNISTIA      90
  8131* GJC0010    | BBVA01 - SE CREA LOGICA PARA QUE EN LA REVISION DE*                            AMNISTIA      91
  8132* AGOSTO-2009|   LA AMNISTIA CUANDO SE MIRA AL CLIENTE SE ELIMINE*                            AMNISTIA      92
  8133* G. JIMENEZ |   LA REVISION DE CUENTAS DEL BBVA                 *                            AMNISTIA      93
  8134******************************************************************                            AMNISTIA      94
  8135* GJC0011    | DBLMOR - SE CONTEMPLA EL CASO EN QUE EL TIEMPO EN *                            AMNISTIA      95
  8136* AGOSTO-2011|   MORA HAYA SIDO MAYOR DE 24 MESES Y EL DOBLE DE  *                            AMNISTIA      96
  8137* G. JIMENEZ |   ESTAS MORAS SIEMPRE DEBE SER 48                 *                            AMNISTIA      97
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 142
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8138*            | PRSCRP - CUANDO UNA CUENTA TIENE PRESCIPCION NO SE*                            AMNISTIA      98
  8139*            |   PUEDE APLICAR ARTÍCULO 21 PORQUE FINALMENTE NO  *                            AMNISTIA      99
  8140*            |   PAGO Y SIEMPRE SE APLICA ARTICULO 13 A MENOS QUE*                            AMNISTIA     100
  8141*            |   EL VECTOR SOLO TENGA MORAS DE 120 Y CEROS       *                            AMNISTIA     101
  8142******************************************************************                            AMNISTIA     102
  8143* GJC0012    | CADUC1 - SE HACEN LOS CAMBIOS NECESARIOS PARA     *                            AMNISTIA     103
  8144* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE *                            AMNISTIA     104
  8145* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13        *                            AMNISTIA     105
  8146*            | ESTA48 - SI SE APLICÓ ARTICULO 13 O CADUCIDAD                                  AMNISTIA     106
  8147******************************************************************                            AMNISTIA     107
  8148* GJC0013    | LEY008 - SE HACE EL CAMBIO PARA NO EXAMINAR SI LA *                            AMNISTIA     108
  8149* G. JIMENEZ |          PERSONA TIENE DERECHO A LA AMNISTIA, YA  *                            AMNISTIA     109
  8150* 23-ENE-2014|          NO APLICA, SOLO ARTICULO 13. (C.VELASCO) *                            AMNISTIA     110
  8151******************************************************************                            AMNISTIA     111
  8152                                                                                              AMNISTIA     112
  8153                                                                                              AMNISTIA     113
  8154*200700-AMNISTIA-CLIENTES.                                       *                            AMNISTIA     114
  8155* RUTINA QUE LEE EL ARCHIVO DE CARTERA PARA                      *                            AMNISTIA     115
  8156* DETERMINAR SI EL CLIENTE ES OBJETO DE BENEFICIO DE AMNISTIA    *                            AMNISTIA     116
  8157******************************************************************                            AMNISTIA     117
  8158 200700-AMNISTIA-CLIENTES.                                                                    AMNISTIA     118
  8159*    PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009                     AMNISTIA     119
  8160     IF SW-FCHGRACIA-LEEMSTRS = ZEROS                                                         AMNISTIA     120
  8161        IF FECHA-INI-AMNIST21 = ZEROS                                                         AMNISTIA     121
  8162           PERFORM 200710-VALIDAR-FECHA-INI-AMNI                                              AMNISTIA     122
  8163        END-IF                                                                                AMNISTIA     123
  8164        COMPUTE MES-GRACIA-AMNIST21 = MES-INI-AMNIST21 +                                      AMNISTIA     124
  8165                                 MESES-GRACIA-AMNIST21                                        AMNISTIA     125
  8166        MOVE  ANO-INI-AMNIST21  TO  ANO-GRACIA-AMNIST21                                       AMNISTIA     126
  8167        IF MES-GRACIA-AMNIST21 > 12                                                           AMNISTIA     127
  8168           COMPUTE MES-GRACIA-AMNIST21 = MES-GRACIA-AMNIST21 - 12                             AMNISTIA     128
  8169           ADD   1         TO  ANO-GRACIA-AMNIST21                                            AMNISTIA     129
  8170        END-IF                                                                                AMNISTIA     130
  8171        MOVE 1 TO SW-FCHGRACIA-LEEMSTRS                                                       AMNISTIA     131
  8172     END-IF                                                                                   AMNISTIA     132
  8173     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009                     AMNISTIA     133
  8174     IF FECHA-SYS-AMNIST21 >= FECHA-INI-AMNIST21                                              AMNISTIA     134
  8175        AND ANO-HOY-AMNIST21 < 2014                               GJC0013                     AMNISTIA     135
  8176        IF TIPO-ID-ABD07 <> TIPO-ID-INI-AMNIST21  OR                                          AMNISTIA     136
  8177           NUM-ID-ABD07  <> NUME-ID-INI-AMNIST21                                              AMNISTIA     137
  8178           MOVE TIPO-ID-ABD07 TO TIPO-ID-INI-AMNIST21                                         AMNISTIA     138
  8179           MOVE NUM-ID-ABD07  TO NUME-ID-INI-AMNIST21                                         AMNISTIA     139
  8180           PERFORM 5000-EXAMINAR-AMINISTIA-PERSONA                                            AMNISTIA     140
  8181        END-IF                                                                                AMNISTIA     141
  8182     END-IF.                                                                                  AMNISTIA     142
  8183                                                                                              AMNISTIA     143
  8184******************************************************************                            AMNISTIA     144
  8185 200710-VALIDAR-FECHA-INI-AMNI.                                                               AMNISTIA     145
  8186******************************************************************                            AMNISTIA     146
  8187     DISPLAY VAR-AMBIENTE-AMNIST21 UPON ENVIRONMENT-NAME                                      AMNISTIA     147
  8188     ACCEPT VAR-AMBIENTE-AMNIST21 FROM ENVIRONMENT-VALUE                                      AMNISTIA     148
  8189     IF VAR-AMBIENTE-AMNIST21 = "FECHA_AMNI"                                                  AMNISTIA     149
  8190        DISPLAY                                                                               AMNISTIA     150
  8191         "NO SE HA FIJADO LA VARIABLE DE AMBIENTE DE AMNISTIA"                                AMNISTIA     151
  8192        STOP RUN                                                                              AMNISTIA     152
  8193     ELSE                                                                                     AMNISTIA     153
  8194        IF VAR-AMBIENTE-AMNIST21 = SPACES                                                     AMNISTIA     154
  8195           MOVE 208001 TO FECHA-INI-AMNIST21                                                  AMNISTIA     155
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 143
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8196           MOVE 1 TO VERSION-AMNIST21                                                         AMNISTIA     156
  8197           DISPLAY "EJECUCION SIN TOMAR AMNISTIA "                                            AMNISTIA     157
  8198                    FECHA-INI-AMNIST21                                                        AMNISTIA     158
  8199        ELSE                                                                                  AMNISTIA     159
  8200           MOVE VAR-AMBIENTE-AMNIST21(1:6) TO FECHA-INI-AMNIST21                              AMNISTIA     160
  8201           IF ANO-INI-AMNIST21 > 2007 AND < 2030 AND                                          AMNISTIA     161
  8202              MES-INI-AMNIST21 > 0 AND < 13                                                   AMNISTIA     162
  8203              DISPLAY                                                                         AMNISTIA     163
  8204              "EJECUCION DE PROG CON AMNISTIA INICIADO EN "                                   AMNISTIA     164
  8205               FECHA-INI-AMNIST21                                                             AMNISTIA     165
  8206              MOVE VAR-AMBIENTE-AMNIST21(7:1) TO VERSION-AMNIST21                             AMNISTIA     166
  8207              IF VERSION-AMNIST21 > 0 AND < 3                                                 AMNISTIA     167
  8208                 DISPLAY                                                                      AMNISTIA     168
  8209                "EJECUCION DE PROG CON AMNISTIA CON RUTINA  "                                 AMNISTIA     169
  8210                 VERSION-AMNIST21                                                             AMNISTIA     170
  8211              ELSE                                                                            AMNISTIA     171
  8212                 DISPLAY                                                                      AMNISTIA     172
  8213                "LA VERSION DE RUTINA DE AMNISTIA ES INVALIDA "                               AMNISTIA     173
  8214                 VERSION-AMNIST21                                                             AMNISTIA     174
  8215                 STOP RUN                                                                     AMNISTIA     175
  8216              END-IF                                                                          AMNISTIA     176
  8217           ELSE                                                                               AMNISTIA     177
  8218              DISPLAY                                                                         AMNISTIA     178
  8219              "FECHA DE EJECUCION DE AMNISTIA INVALIDA "                                      AMNISTIA     179
  8220               FECHA-INI-AMNIST21                                                             AMNISTIA     180
  8221              STOP RUN                                                                        AMNISTIA     181
  8222           END-IF                                                                             AMNISTIA     182
  8223        END-IF                                                                                AMNISTIA     183
  8224     END-IF.                                                                                  AMNISTIA     184
  8225     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0008                     AMNISTIA     185
  8226 200711-CALCULE-FECHA-HOY.                                        GJC0009                     AMNISTIA     186
  8227******************************************************************                            AMNISTIA     187
  8228* 200711-CALCULE-FECHA-HOY.                                                                   AMNISTIA     188
  8229* SE ASIGNA LA FECHA DEL DÍA PARA PODER REALIZAR EL MANEJO DE PROCESOS                        AMNISTIA     189
  8230* HISTORICOS                                                                                  AMNISTIA     190
  8231******************************************************************                            AMNISTIA     191
  8232        MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21        GJC0009                     AMNISTIA     192
  8233        DISPLAY VAR-AMB-HOY-AMNIST21 UPON ENVIRONMENT-NAME        GJC0009                     AMNISTIA     193
  8234        ACCEPT VAR-AMB-HOY-AMNIST21 FROM ENVIRONMENT-VALUE        GJC0009                     AMNISTIA     194
  8235        IF VAR-AMB-HOY-AMNIST21(1:9) = "FECHA_HOY"                GJC0009                     AMNISTIA     195
  8236           MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21     GJC0009                     AMNISTIA     196
  8237        ELSE                                                      GJC0009                     AMNISTIA     197
  8238           IF VAR-AMB-HOY-AMNIST21 = SPACES                       GJC0009                     AMNISTIA     198
  8239              MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21  GJC0009                     AMNISTIA     199
  8240           ELSE                                                   GJC0009                     AMNISTIA     200
  8241              MOVE VAR-AMB-HOY-AMNIST21 TO VAR-FEC-AMB-AMNIST21   GJC0009                     AMNISTIA     201
  8242              IF (ANO-VAR-FEC-AMB-AMNIST21 < 2000 OR > 2030) OR   GJC0009                     AMNISTIA     202
  8243                 (MES-VAR-FEC-AMB-AMNIST21 < 1 AND > 12) OR       GJC0009                     AMNISTIA     203
  8244                 (DIA-VAR-FEC-AMB-AMNIST21 < 1 AND > 31)          GJC0009                     AMNISTIA     204
  8245                 DISPLAY "FECHA DE VARIABLE DE AMBIENTE FECHA-HOY"GJC0009                     AMNISTIA     205
  8246                 DISPLAY "ES INVALIDA, SE TOMA FECHA DEL DIA DE"  GJC0009                     AMNISTIA     206
  8247                 DISPLAY "HOY"                                    GJC0009                     AMNISTIA     207
  8248              ELSE                                                GJC0009                     AMNISTIA     208
  8249                 MOVE VAR-FEC-AMB-AMNIST21 TO FECHA-HOY-AMNIST21  GJC0009                     AMNISTIA     209
  8250              END-IF                                              GJC0009                     AMNISTIA     210
  8251           END-IF                                                 GJC0009                     AMNISTIA     211
  8252        END-IF                                                    GJC0009                     AMNISTIA     212
  8253     IF SW-FCHGRACIA-LEEMSTRS = 0                                 GJC0009                     AMNISTIA     213
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 144
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8254     DISPLAY                                                      GJC0009                     AMNISTIA     214
  8255     "PARA APLICACION DE ARTICULO 13 SE TOMA COMO FECHA DEL DIA " GJC0009                     AMNISTIA     215
  8256     FECHA-HOY-AMNIST21                                           GJC0009                     AMNISTIA     216
  8257     END-IF.                                                      GJC0009                     AMNISTIA     217
  8258                                                                                              AMNISTIA     218
  8259******************************************************************                            AMNISTIA     219
  8260 5000-EXAMINAR-AMINISTIA-PERSONA.                                                             AMNISTIA     220
  8261******************************************************************                            AMNISTIA     221
  8262     MOVE  0     TO SW-AMNIST21                                                               AMNISTIA     222
  8263     INITIALIZE   WORK-CLIENTE-AMNIST21                           CAV0002                     AMNISTIA     223
  8264     MOVE  LLAVE-MAES-CREDIT TO  LLAVE-INI-AMNIST21               GJC0006                     AMNISTIA     224
  8265     MOVE  TIPO-ID-ABD07     TO  TIPO-ID-MAES-AMNIST21            GJC0006                     AMNISTIA     225
  8266     MOVE  NUM-ID-ABD07      TO  NUM-ID-MAES-AMNIST21             GJC0006                     AMNISTIA     226
  8267     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006                     AMNISTIA     227
  8268     INITIALIZE VECTOR-MORAS-IDE-13-AMNIST21 REPLACING            GJC0006                     AMNISTIA     228
  8269             ALPHANUMERIC DATA BY CINCOS-AMNIST21                 GJC0006                     AMNISTIA     229
  8270     MOVE   0   TO  SW-AMNIST21                                   GJC0006                     AMNISTIA     230
  8271     MOVE 999 TO MESES-FALTAN-AMNIST21                            GJC0006                     AMNISTIA     231
  8272     PERFORM 200710-READ-ICMCRE-AMNISTIA                          GJC0006                     AMNISTIA     232
  8273     IF MORAS-ACTUAL-AMNIST21 = ZEROS                             GJC0006                     AMNISTIA     233
  8274        IF VERSION-AMNIST21 = 1                                   GJC0006                     AMNISTIA     234
  8275           IF CTAS-MAY12-AMNIST21 = 1                             GJC0006                     AMNISTIA     235
  8276              MOVE 1 TO SW-AMNIST21                               GJC0006                     AMNISTIA     236
  8277           END-IF                                                 GJC0006                     AMNISTIA     237
  8278        ELSE                                                      GJC0006                     AMNISTIA     238
  8279           IF CTAS-MAY12-AMNIST21 = 1 AND                         GJC0006                     AMNISTIA     239
  8280              CTAS-MEN12-AMNIST21 = 0                             GJC0006                     AMNISTIA     240
  8281              MOVE 1 TO SW-AMNIST21                               GJC0006                     AMNISTIA     241
  8282           END-IF                                                 GJC0006                     AMNISTIA     242
  8283        END-IF                                                    GJC0006                     AMNISTIA     243
  8284     END-IF                                                       GJC0006                     AMNISTIA     244
  8285     PERFORM 200800-RESTAURAR-REGISTROS.                          GJC0006                     AMNISTIA     245
  8286*    END-IF.                                                      GJC0006                     AMNISTIA     246
  8287                                                                                              AMNISTIA     247
  8288******************************************************************                            AMNISTIA     248
  8289*200710-READ-ICMCRE-AMNISTIA.                                    *                            AMNISTIA     249
  8290* RUTINA ENCARGADA DE LEER EL MAESTRO DE CARTERA  ICMCRE         *                            AMNISTIA     250
  8291******************************************************************                            AMNISTIA     251
  8292 200710-READ-ICMCRE-AMNISTIA.                                                                 AMNISTIA     252
  8293     INITIALIZE        LLAVE-MAES-CREDIT                                                      AMNISTIA     253
  8294     MOVE  TIPO-ID-MAES-AMNIST21  TO  TIPO-ID-ABD07                                           AMNISTIA     254
  8295     MOVE  NUM-ID-MAES-AMNIST21   TO  NUM-ID-ABD07                                            AMNISTIA     255
  8296     START MAESTRO-CREDIT  KEY NOT < LLAVE-MAES-CREDIT                                        AMNISTIA     256
  8297           INVALID KEY                                                                        AMNISTIA     257
  8298                   MOVE 9 TO TIPO-ID-ABD07                                                    AMNISTIA     258
  8299           NOT INVALID KEY                                                                    AMNISTIA     259
  8300                   READ MAESTRO-CREDIT NEXT                                                   AMNISTIA     260
  8301                            AT  END                                                           AMNISTIA     261
  8302                                MOVE 9 TO TIPO-ID-ABD07                                       AMNISTIA     262
  8303                   END-READ                                                                   AMNISTIA     263
  8304     END-START                                                                                AMNISTIA     264
  8305     PERFORM UNTIL TIPO-ID-ABD07 NOT = TIPO-ID-MAES-AMNIST21 OR                               AMNISTIA     265
  8306                   NUM-ID-ABD07  NOT = NUM-ID-MAES-AMNIST21       GJC0006                     AMNISTIA     266
  8307*                         MORAS-ACTUAL-AMNIST21 > ZEROS           GJC0006                     AMNISTIA     267
  8308           IF COD-SUS-ABD07 = 020050 OR 030050 OR 050050 OR       GJC0010                     AMNISTIA     268
  8309                              130050                              GJC0010                     AMNISTIA     269
  8310              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0010                     AMNISTIA     270
  8311           END-IF                                                 GJC0010                     AMNISTIA     271
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 145
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8312           IF NOV-REPORT-ABD07 > 0 AND NOV-REPORT-ABD07 < 51                                  AMNISTIA     272
  8313              PERFORM 8000-U-VER-CTAABD07-BDAMATCH                                            AMNISTIA     273
  8314              IF IND-BLOQUEO-ABD07 = 0                                                        AMNISTIA     274
  8315                 MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                                      AMNISTIA     275
  8316                 READ SUSCRIPTOR  IGNORE LOCK                                                 AMNISTIA     276
  8317                   INVALID KEY MOVE 0 TO ESTADO-ABD02                                         AMNISTIA     277
  8318                 END-READ                                                                     AMNISTIA     278
  8319                 IF ESTADO-ABD02 = 1                                                          AMNISTIA     279
  8320                    IF MORAS-ACTUAL-AMNIST21 = 0                  GJC0006                     AMNISTIA     280
  8321                       PERFORM 200720-AMNIST-OBLIGACIONES         GJC0006                     AMNISTIA     281
  8322                    END-IF                                        GJC0006                     AMNISTIA     282
  8323* SE DEBE HABILITAR ESTE LLAMADO SI SE QUIERE PERDON POR PERSONA  GJC0009                     AMNISTIA     283
  8324* Y NO POR CUENTA                                                 GJC0009                     AMNISTIA     284
  8325*PER                PERFORM 200760-LLENAR-VEC-MORAS-PERS          GJC0009                     AMNISTIA     285
  8326                 END-IF                                                                       AMNISTIA     286
  8327              END-IF                                                                          AMNISTIA     287
  8328           END-IF                                                                             AMNISTIA     288
  8329           READ MAESTRO-CREDIT NEXT                                                           AMNISTIA     289
  8330                AT  END                                                                       AMNISTIA     290
  8331                    MOVE 9 TO TIPO-ID-ABD07                                                   AMNISTIA     291
  8332           END-READ                                                                           AMNISTIA     292
  8333     END-PERFORM.                                                                             AMNISTIA     293
  8334                                                                                              AMNISTIA     294
  8335******************************************************************                            AMNISTIA     295
  8336*200720-AMNIST-OBLIGACIONES.                                     *                            AMNISTIA     296
  8337* DETERMINA SI EXISTEN MORAS ACTUALES Y LOS REGISTROS CON MORA   *                            AMNISTIA     297
  8338* CANCELADOS QUE CULPLIERON EL TIEMPO ESTIPULA EN LA LEY (1 AÑO) *                            AMNISTIA     298
  8339******************************************************************                            AMNISTIA     299
  8340 200720-AMNIST-OBLIGACIONES.                                                                  AMNISTIA     300
  8341     IF NOV-CART-CODINT-AMNIST21(NOV-REPORT-ABD07) = 12 OR 13                                 AMNISTIA     301
  8342                                                     OR 14 OR 15                              AMNISTIA     302
  8343                                                     OR 09 OR 11                              AMNISTIA     303
  8344        ADD 1 TO MORAS-ACTUAL-AMNIST21                                                        AMNISTIA     304
  8345     END-IF                                                                                   AMNISTIA     305
  8346     IF ESTADO-OBLIG-ABD07 = 10                                   GJC0011                     AMNISTIA     306
  8347        ADD 1 TO MORAS-ACTUAL-AMNIST21                            GJC0011                     AMNISTIA     307
  8348     END-IF                                                       GJC0011                     AMNISTIA     308
  8349     IF MORAS-ACTUAL-AMNIST21 = ZEROS AND                                                     AMNISTIA     309
  8350       ((MORA-MAXIMA-ABD07 > ZEROS OR MORA-MAXIMA-R-ABD07 > ZEROS)GJC0004                     AMNISTIA     310
  8351        OR (NOV-REPORT-ABD07 = 03 OR 46))                         GJC0004                     AMNISTIA     311
  8352        PERFORM 200740-VER-ANTIGUEDAD-MORAS                                                   AMNISTIA     312
  8353     END-IF.                                                                                  AMNISTIA     313
  8354                                                                                              AMNISTIA     314
  8355******************************************************************                            AMNISTIA     315
  8356*200740-VER-ANTIGUEDAD-MORAS.                                    *                            AMNISTIA     316
  8357* DETERMINA SI HAY MORAS MAYORES O MENORES A UN AÑO              *                            AMNISTIA     317
  8358******************************************************************                            AMNISTIA     318
  8359 200740-VER-ANTIGUEDAD-MORAS.                                                                 AMNISTIA     319
  8360     MOVE ZEROS TO MESES-VEC-AMNIST21 VECT1-AMNIST21                                          AMNISTIA     320
  8361                   VECTOR-TOT-AMNIST21 MESES-GRC-AMNIST21                                     AMNISTIA     321
  8362                   VECT2-AMNIST21 VECT3-AMNIST21 VECT4-AMNIST21                               AMNISTIA     322
  8363     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006                     AMNISTIA     323
  8364     IF MESES-NOV-AMNIST21 >= 12                                                              AMNISTIA     324
  8365        MOVE ZEROS TO MESES-VEC-AMNIST21                                                      AMNISTIA     325
  8366     ELSE                                                                                     AMNISTIA     326
  8367        COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -                                AMNISTIA     327
  8368                MESES-NOV-AMNIST21                                                            AMNISTIA     328
  8369     END-IF                                                                                   AMNISTIA     329
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 146
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8370     IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21                                          AMNISTIA     330
  8371        COMPUTE MESES-GRC-AMNIST21 =                                                          AMNISTIA     331
  8372             (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -                                     AMNISTIA     332
  8373             (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)                                 AMNISTIA     333
  8374     ELSE                                                                                     AMNISTIA     334
  8375        MOVE ZEROS TO MESES-GRC-AMNIST21                                                      AMNISTIA     335
  8376     END-IF                                                                                   AMNISTIA     336
  8377        MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21                                            AMNISTIA     337
  8378        MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21                                            AMNISTIA     338
  8379        MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21                                            AMNISTIA     339
  8380        MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21                                            AMNISTIA     340
  8381        MOVE  1 TO K-AMNIST21                                                                 AMNISTIA     341
  8382        MOVE 12 TO L-AMNIST21                                                                 AMNISTIA     342
  8383        PERFORM UNTIL L-AMNIST21 = 0                                                          AMNISTIA     343
  8384          MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO                                               AMNISTIA     344
  8385               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                             AMNISTIA     345
  8386          ADD 1 TO K-AMNIST21                                                                 AMNISTIA     346
  8387          SUBTRACT 1 FROM L-AMNIST21                                                          AMNISTIA     347
  8388        END-PERFORM                                                                           AMNISTIA     348
  8389        MOVE 12 TO L-AMNIST21                                                                 AMNISTIA     349
  8390        PERFORM UNTIL L-AMNIST21 = 0                                                          AMNISTIA     350
  8391          MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO                                               AMNISTIA     351
  8392               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                             AMNISTIA     352
  8393          ADD 1 TO K-AMNIST21                                                                 AMNISTIA     353
  8394          SUBTRACT 1 FROM L-AMNIST21                                                          AMNISTIA     354
  8395        END-PERFORM                                                                           AMNISTIA     355
  8396        MOVE 12 TO L-AMNIST21                                                                 AMNISTIA     356
  8397        PERFORM UNTIL L-AMNIST21 = 0                                                          AMNISTIA     357
  8398          MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO                                               AMNISTIA     358
  8399               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                             AMNISTIA     359
  8400          ADD 1 TO K-AMNIST21                                                                 AMNISTIA     360
  8401          SUBTRACT 1 FROM L-AMNIST21                                                          AMNISTIA     361
  8402        END-PERFORM                                                                           AMNISTIA     362
  8403        MOVE 12 TO L-AMNIST21                                                                 AMNISTIA     363
  8404        PERFORM UNTIL L-AMNIST21 = 0                                                          AMNISTIA     364
  8405          MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO                                               AMNISTIA     365
  8406               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                             AMNISTIA     366
  8407          ADD 1 TO K-AMNIST21                                                                 AMNISTIA     367
  8408          SUBTRACT 1 FROM L-AMNIST21                                                          AMNISTIA     368
  8409        END-PERFORM                                                                           AMNISTIA     369
  8410        MOVE ZEROS TO SW-SALIR-VECT                                                           AMNISTIA     370
  8411        PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL                                          AMNISTIA     371
  8412                X-AMNIST21 >  48 OR                                                           AMNISTIA     372
  8413                MORAS-ACTUAL-AMNIST21 > ZEROS OR                                              AMNISTIA     373
  8414                SW-SALIR-VECT > ZEROS                                                         AMNISTIA     374
  8415         IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR "3" OR "4"                             AMNISTIA     375
  8416             IF FECHA-SYS-AMNIST21 > FECHA-GRACIA-AMNIST21                                    AMNISTIA     376
  8417                IF X-AMNIST21 < MESES-GRC-AMNIST21                                            AMNISTIA     377
  8418                   ADD  1  TO  MORAS-ACTUAL-AMNIST21                                          AMNISTIA     378
  8419                END-IF                                                                        AMNISTIA     379
  8420             END-IF                                                                           AMNISTIA     380
  8421             IF MORAS-ACTUAL-AMNIST21 = ZEROS                                                 AMNISTIA     381
  8422                IF  X-AMNIST21 <= MESES-VEC-AMNIST21              CAV0003                     AMNISTIA     382
  8423                    MOVE 1 TO CTAS-MEN12-AMNIST21                                             AMNISTIA     383
  8424                    MOVE 1 TO SW-SALIR-VECT                                                   AMNISTIA     384
  8425                ELSE                                                                          AMNISTIA     385
  8426                    MOVE 1 TO CTAS-MAY12-AMNIST21                                             AMNISTIA     386
  8427                    MOVE 1 TO SW-SALIR-VECT                                                   AMNISTIA     387
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 147
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8428                END-IF                                                                        AMNISTIA     388
  8429             END-IF                                                                           AMNISTIA     389
  8430         END-IF                                                                               AMNISTIA     390
  8431        END-PERFORM                                                                           AMNISTIA     391
  8432        IF X-AMNIST21 > 48 *> CASOS DE NO HAY MORA EN EL VECTOR                               AMNISTIA     392
  8433           MOVE 1 TO CTAS-MAY12-AMNIST21                                                      AMNISTIA     393
  8434        END-IF.                                                   GJC0005                     AMNISTIA     394
  8435*****************************************************************                             AMNISTIA     395
  8436*200745-CALCULAR-MESES-A-HOY.                             *                                   AMNISTIA     396
  8437*SE REALIZA EL CALCULO PARA DETERMINAR CUANTOS MESES DE DESACTUA-*                            AMNISTIA     397
  8438*LIZACION O CIERRE TIENE LA CUENTA RESPECTO AL DIA DE HOY        *                            AMNISTIA     398
  8439******************************************************************                            AMNISTIA     399
  8440 200745-CALCULAR-MESES-A-HOY.                                     GJC0006                     AMNISTIA     400
  8441     MOVE ZEROS              TO  FECHA-AUX-AMNIST21               GJC0006                     AMNISTIA     401
  8442     MOVE FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21               GJC0006                     AMNISTIA     402
  8443     PERFORM 200950-CONVIERTE-FECHA                               GJC0006                     AMNISTIA     403
  8444     MOVE    ZEROS           TO  MESES-NOV-AMNIST21               GJC0006                     AMNISTIA     404
  8445     COMPUTE MESES-NOV-AMNIST21 =                                 GJC0006                     AMNISTIA     405
  8446          (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -            GJC0006                     AMNISTIA     406
  8447          (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21).             GJC0006                     AMNISTIA     407
  8448*****************************************************************                             AMNISTIA     408
  8449*200760-LLENAR-VEC-MORAS-PERS.                             *                                  AMNISTIA     409
  8450*DE CADA CUENTA QUE SE VA LEYENDO SE TOMAN LAS MORAS Y SE VA LLE-*                            AMNISTIA     410
  8451* NANDO EL VECTOR DE MORAS DE TODA LA PERSONA                    *                            AMNISTIA     411
  8452******************************************************************                            AMNISTIA     412
  8453 200760-LLENAR-VEC-MORAS-PERS.                                    GJC0006                     AMNISTIA     413
  8454     MOVE 0 TO K-AMNIST21                                         GJC0006                     AMNISTIA     414
  8455     IF MORA-MAXIMA-ABD07 > 0 OR MORA-MAXIMA-R-ABD07 > 0          GJC0006                     AMNISTIA     415
  8456        MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21          GJC0006                     AMNISTIA     416
  8457        MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21          GJC0006                     AMNISTIA     417
  8458        MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21          GJC0006                     AMNISTIA     418
  8459        MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21          GJC0006                     AMNISTIA     419
  8460        MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO          GJC0006                     AMNISTIA     420
  8461             MOR-EST-CTA-AMNIST21                                 GJC0006                     AMNISTIA     421
  8462        PERFORM 200745-CALCULAR-MESES-A-HOY                       GJC0006                     AMNISTIA     422
  8463        IF MESES-NOV-AMNIST21 < 100                               GJC0006                     AMNISTIA     423
  8464           COMPUTE K-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006                     AMNISTIA     424
  8465        ELSE                                                      GJC0006                     AMNISTIA     425
  8466           MOVE 0 TO K-AMNIST21                                   GJC0006                     AMNISTIA     426
  8467        END-IF                                                    GJC0006                     AMNISTIA     427
  8468        MOVE 49 TO L-AMNIST21                                     GJC0006                     AMNISTIA     428
  8469        PERFORM UNTIL K-AMNIST21 = 0 OR L-AMNIST21 = 0            GJC0006                     AMNISTIA     429
  8470          IF VEC-MOR-IDE-13-AMNIST21(K-AMNIST21) = 5              GJC0006                     AMNISTIA     430
  8471             IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5      GJC0006                     AMNISTIA     431
  8472                MOVE  1 TO VEC-MOR-IDE-13-AMNIST21(K-AMNIST21)    GJC0006                     AMNISTIA     432
  8473             END-IF                                               GJC0006                     AMNISTIA     433
  8474          END-IF                                                  GJC0006                     AMNISTIA     434
  8475          COMPUTE K-AMNIST21 = K-AMNIST21 - 1                     GJC0006                     AMNISTIA     435
  8476          COMPUTE L-AMNIST21 = L-AMNIST21 - 1                     GJC0006                     AMNISTIA     436
  8477        END-PERFORM                                               GJC0006                     AMNISTIA     437
  8478        IF MOR-EST-CTA-AMNIST21 <> 5                              GJC0006                     AMNISTIA     438
  8479           MOVE 100 TO L-AMNIST21                                 GJC0006                     AMNISTIA     439
  8480           PERFORM VARYING K-AMNIST21 FROM 1 BY 1 UNTIL           GJC0006                     AMNISTIA     440
  8481               K-AMNIST21 > MESES-NOV-AMNIST21 OR L-AMNIST21 = 0  GJC0006                     AMNISTIA     441
  8482              MOVE 1 TO VEC-MOR-IDE-13-AMNIST21(L-AMNIST21)       GJC0006                     AMNISTIA     442
  8483              COMPUTE L-AMNIST21 = L-AMNIST21 - 1                 GJC0006                     AMNISTIA     443
  8484           END-PERFORM                                            GJC0006                     AMNISTIA     444
  8485        END-IF                                                    GJC0006                     AMNISTIA     445
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 148
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8486     END-IF.                                                      GJC0006                     AMNISTIA     446
  8487******************************************************************                            AMNISTIA     447
  8488*200800-RESTAURAR-REGISTROS.                                      *                           AMNISTIA     448
  8489* RUTINA ENCARGADA DE LEER EL REGISTRO ORIGINAL PARA AMNISTIAR   *                            AMNISTIA     449
  8490******************************************************************                            AMNISTIA     450
  8491 200800-RESTAURAR-REGISTROS.                                                                  AMNISTIA     451
  8492     MOVE LLAVE-INI-AMNIST21 TO LLAVE-MAES-CREDIT                                             AMNISTIA     452
  8493     READ MAESTRO-CREDIT INVALID KEY                                                          AMNISTIA     453
  8494           DISPLAY " ERROR READ ICMCRE "                                                      AMNISTIA     454
  8495     END-READ                                                                                 AMNISTIA     455
  8496     IF REG-SUSCRIPTOR-AMNISTIA21 <> REG-SUSCRIPTOR                                           AMNISTIA     456
  8497        MOVE REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR                                      AMNISTIA     457
  8498     END-IF.                                                                                  AMNISTIA     458
  8499                                                                                              AMNISTIA     459
  8500 200850-AMNISTIA-REGISTROS.                                                                   AMNISTIA     460
  8501******************************************************************                            AMNISTIA     461
  8502*200850-AMNISTIA-REGISTROS.                                      *                            AMNISTIA     462
  8503* RUTINA ENCARGADA DE VALIDAR SI APLICA O NO AMNISTIA AL RESGISTR*                            AMNISTIA     463
  8504******************************************************************                            AMNISTIA     464
  8505       MOVE ZEROS TO MESES-VEC-AMNIST21 MESES-GRC-AMNIST21                                    AMNISTIA     465
  8506                     VECT1-AMNIST21 VECT2-AMNIST21 VECT3-AMNIST21                             AMNISTIA     466
  8507                     VECT4-AMNIST21 VECTOR-TOT-AMNIST21                                       AMNISTIA     467
  8508       MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21                                  AMNISTIA     468
  8509       MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                                                AMNISTIA     469
  8510       READ SUSCRIPTOR  IGNORE LOCK                                                           AMNISTIA     470
  8511            INVALID KEY MOVE 0 TO ESTADO-ABD02                                                AMNISTIA     471
  8512       END-READ                                                                               AMNISTIA     472
  8513       IF ESTADO-ABD02 = 1                                                                    AMNISTIA     473
  8514        IF TAB-VIG-CART-AMNIST21(NOV-REPORT-ABD07) = 0 OR                                     AMNISTIA     474
  8515           ((NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16) OR          CAV0002                     AMNISTIA     475
  8516            (NOV-REPORT-R-ABD07 = 13 OR 14 OR 15 OR 16))          CAV0002                     AMNISTIA     476
  8517          IF ((MORA-MAXIMA-ABD07 > ZEROS OR                       GJC0004                     AMNISTIA     477
  8518              MORA-MAXIMA-R-ABD07 > ZEROS) OR                     GJC0004                     AMNISTIA     478
  8519               (NOV-REPORT-ABD07 = 03 OR 46)) AND                 GJC0004                     AMNISTIA     479
  8520              IND-BLOQUEO-ABD07 = 0                               CAV0002                     AMNISTIA     480
  8521           MOVE  ZEROS              TO  FECHA-AUX-AMNIST21                                    AMNISTIA     481
  8522           MOVE  FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21                                    AMNISTIA     482
  8523           PERFORM 200950-CONVIERTE-FECHA                                                     AMNISTIA     483
  8524           MOVE    ZEROS            TO  MESES-NOV-AMNIST21                                    AMNISTIA     484
  8525           COMPUTE MESES-NOV-AMNIST21 =                                                       AMNISTIA     485
  8526                   (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -                               AMNISTIA     486
  8527                   (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21)                                 AMNISTIA     487
  8528           IF MESES-NOV-AMNIST21 >= 12                                                        AMNISTIA     488
  8529              MOVE ZEROS TO MESES-VEC-AMNIST21                                                AMNISTIA     489
  8530           ELSE                                                                               AMNISTIA     490
  8531           COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -                             AMNISTIA     491
  8532                   MESES-NOV-AMNIST21                                                         AMNISTIA     492
  8533           END-IF                                                                             AMNISTIA     493
  8534           IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21                                    AMNISTIA     494
  8535              COMPUTE MESES-GRC-AMNIST21 =                                                    AMNISTIA     495
  8536                 (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -                                 AMNISTIA     496
  8537                 (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)                             AMNISTIA     497
  8538           ELSE                                                                               AMNISTIA     498
  8539              MOVE ZEROS TO MESES-GRC-AMNIST21                                                AMNISTIA     499
  8540           END-IF                                                                             AMNISTIA     500
  8541           MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21                                         AMNISTIA     501
  8542           MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21                                         AMNISTIA     502
  8543           MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21                                         AMNISTIA     503
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 149
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8544           MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21                                         AMNISTIA     504
  8545           MOVE  1 TO K-AMNIST21                                                              AMNISTIA     505
  8546           MOVE 12 TO L-AMNIST21                                                              AMNISTIA     506
  8547           PERFORM UNTIL L-AMNIST21 = 0                                                       AMNISTIA     507
  8548             MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO                                            AMNISTIA     508
  8549                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                          AMNISTIA     509
  8550             ADD 1 TO K-AMNIST21                                                              AMNISTIA     510
  8551             SUBTRACT 1 FROM L-AMNIST21                                                       AMNISTIA     511
  8552           END-PERFORM                                                                        AMNISTIA     512
  8553           MOVE 12 TO L-AMNIST21                                                              AMNISTIA     513
  8554           PERFORM UNTIL L-AMNIST21 = 0                                                       AMNISTIA     514
  8555             MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO                                            AMNISTIA     515
  8556                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                          AMNISTIA     516
  8557             ADD 1 TO K-AMNIST21                                                              AMNISTIA     517
  8558             SUBTRACT 1 FROM L-AMNIST21                                                       AMNISTIA     518
  8559           END-PERFORM                                                                        AMNISTIA     519
  8560           MOVE 12 TO L-AMNIST21                                                              AMNISTIA     520
  8561           PERFORM UNTIL L-AMNIST21 = 0                                                       AMNISTIA     521
  8562             MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO                                            AMNISTIA     522
  8563                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                          AMNISTIA     523
  8564             ADD 1 TO K-AMNIST21                                                              AMNISTIA     524
  8565             SUBTRACT 1 FROM L-AMNIST21                                                       AMNISTIA     525
  8566           END-PERFORM                                                                        AMNISTIA     526
  8567           MOVE 12 TO L-AMNIST21                                                              AMNISTIA     527
  8568           PERFORM UNTIL L-AMNIST21 = 0                                                       AMNISTIA     528
  8569             MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO                                            AMNISTIA     529
  8570                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)                                          AMNISTIA     530
  8571             ADD 1 TO K-AMNIST21                                                              AMNISTIA     531
  8572             SUBTRACT 1 FROM L-AMNIST21                                                       AMNISTIA     532
  8573           END-PERFORM                                                                        AMNISTIA     533
  8574           MOVE ZEROS TO SW-SALIR-VECT                                                        AMNISTIA     534
  8575           PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL                                       AMNISTIA     535
  8576                   X-AMNIST21 >  48 OR                                                        AMNISTIA     536
  8577                   SW-SALIR-VECT > ZEROS                                                      AMNISTIA     537
  8578             IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR                                    AMNISTIA     538
  8579                                             "3" OR "4"                                       AMNISTIA     539
  8580                   IF X-AMNIST21 <= MESES-VEC-AMNIST21            CAV0003                     AMNISTIA     540
  8581                      MOVE 1 TO SW-SALIR-VECT                                                 AMNISTIA     541
  8582                   ELSE                                                                       AMNISTIA     542
  8583                        PERFORM 200870-APLICA-AMNISTIA            GJC0006                     AMNISTIA     543
  8584                        MOVE 1 TO SW-SALIR-VECT                   GJC0004                     AMNISTIA     544
  8585                   END-IF                                                                     AMNISTIA     545
  8586             END-IF                                                                           AMNISTIA     546
  8587           END-PERFORM                                                                        AMNISTIA     547
  8588           IF X-AMNIST21 > 48    *> CASOS EN QUE NO HAY MORA EN                               AMNISTIA     548
  8589              PERFORM 200870-APLICA-AMNISTIA *>  EL VECTOR        GJC0006                     AMNISTIA     549
  8590           END-IF                                                                             AMNISTIA     550
  8591          END-IF                                                                              AMNISTIA     551
  8592        END-IF                                                                                AMNISTIA     552
  8593       END-IF                                                                                 AMNISTIA     553
  8594       MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.                                     AMNISTIA     554
  8595                                                                                              AMNISTIA     555
  8596******************************************************************                            AMNISTIA     556
  8597*200870-APLICA-AMNISTIA.                                         *                            AMNISTIA     557
  8598* RUTINA ENCARGADA DE APLICAR LA AMNISTIA AL REGISTRO            *                            AMNISTIA     558
  8599******************************************************************                            AMNISTIA     559
  8600 200870-APLICA-AMNISTIA.                                          GJC0006                     AMNISTIA     560
  8601     INITIALIZE VECTOR1-AMNIST21 VECTOR2-AMNIST21                                             AMNISTIA     561
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 150
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8602     MOVE 0 TO NUM-MORAS30-ABD07                                                              AMNISTIA     562
  8603     MOVE 0 TO MORA-MAXIMA-ABD07                                                              AMNISTIA     563
  8604     MOVE 0 TO FECHA-MORA-MAXIMA-ABD07                                                        AMNISTIA     564
  8605     IF ADJETIVO1-ABD07 > 1                                                                   AMNISTIA     565
  8606        MOVE 0        TO ADJETIVO1-ABD07                                                      AMNISTIA     566
  8607     END-IF                                                                                   AMNISTIA     567
  8608     IF ADJETIVO2-ABD07 > 1                                                                   AMNISTIA     568
  8609            MOVE 0        TO ADJETIVO2-ABD07                                                  AMNISTIA     569
  8610     END-IF                                                                                   AMNISTIA     570
  8611     IF ADJETIVO3-ABD07 > 1                                                                   AMNISTIA     571
  8612            MOVE 0        TO ADJETIVO3-ABD07                                                  AMNISTIA     572
  8613     END-IF                                                                                   AMNISTIA     573
  8614     IF NOV-REPORT-ABD07 = 46                                                                 AMNISTIA     574
  8615        IF COD-CTA-ABD07 = 02                                                                 AMNISTIA     575
  8616           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07                                     AMNISTIA     576
  8617        ELSE                                                                                  AMNISTIA     577
  8618           MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07                                     AMNISTIA     578
  8619        END-IF                                                                                AMNISTIA     579
  8620     ELSE                                                                                     AMNISTIA     580
  8621        IF NOV-REPORT-ABD07 = 03                                                              AMNISTIA     581
  8622           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07                                     AMNISTIA     582
  8623        ELSE                                                                                  AMNISTIA     583
  8624           IF NOV-REPORT-ABD07 = 09 OR 10 OR 11 OR 12                                         AMNISTIA     584
  8625              MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07                                  AMNISTIA     585
  8626           ELSE                                                                               AMNISTIA     586
  8627              IF NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16                                      AMNISTIA     587
  8628                 MOVE 01 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07                               AMNISTIA     588
  8629              END-IF                                                                          AMNISTIA     589
  8630           END-IF                                                                             AMNISTIA     590
  8631        END-IF                                                                                AMNISTIA     591
  8632     END-IF                                                                                   AMNISTIA     592
  8633     MOVE ESTADO-MES-ABD07   TO VECTOR1-AMNIST21                                              AMNISTIA     593
  8634     MOVE VECTOR-2-ABD07     TO VECTOR2-AMNIST21                                              AMNISTIA     594
  8635     MOVE VECTOR-HIS-3-ABD07 TO VECTOR3-AMNIST21                                              AMNISTIA     595
  8636     MOVE VECTOR-HIS-4-ABD07 TO VECTOR4-AMNIST21                                              AMNISTIA     596
  8637     INSPECT VECTOR1-AMNIST21 REPLACING ALL "1" BY "8"                                        AMNISTIA     597
  8638     INSPECT VECTOR1-AMNIST21 REPLACING ALL "2" BY "8"                                        AMNISTIA     598
  8639     INSPECT VECTOR1-AMNIST21 REPLACING ALL "3" BY "8"                                        AMNISTIA     599
  8640     INSPECT VECTOR1-AMNIST21 REPLACING ALL "4" BY "8"                                        AMNISTIA     600
  8641     INSPECT VECTOR2-AMNIST21 REPLACING ALL "1" BY "8"                                        AMNISTIA     601
  8642     INSPECT VECTOR2-AMNIST21 REPLACING ALL "2" BY "8"                                        AMNISTIA     602
  8643     INSPECT VECTOR2-AMNIST21 REPLACING ALL "3" BY "8"                                        AMNISTIA     603
  8644     INSPECT VECTOR2-AMNIST21 REPLACING ALL "4" BY "8"                                        AMNISTIA     604
  8645     INSPECT VECTOR3-AMNIST21 REPLACING ALL "1" BY "8"                                        AMNISTIA     605
  8646     INSPECT VECTOR3-AMNIST21 REPLACING ALL "2" BY "8"                                        AMNISTIA     606
  8647     INSPECT VECTOR3-AMNIST21 REPLACING ALL "3" BY "8"                                        AMNISTIA     607
  8648     INSPECT VECTOR3-AMNIST21 REPLACING ALL "4" BY "8"                                        AMNISTIA     608
  8649     INSPECT VECTOR4-AMNIST21 REPLACING ALL "1" BY "8"                                        AMNISTIA     609
  8650     INSPECT VECTOR4-AMNIST21 REPLACING ALL "2" BY "8"                                        AMNISTIA     610
  8651     INSPECT VECTOR4-AMNIST21 REPLACING ALL "3" BY "8"                                        AMNISTIA     611
  8652     INSPECT VECTOR4-AMNIST21 REPLACING ALL "4" BY "8"                                        AMNISTIA     612
  8653     MOVE VECTOR1-AMNIST21 TO ESTADO-MES-ABD07                                                AMNISTIA     613
  8654     MOVE VECTOR2-AMNIST21 TO VECTOR-2-ABD07.                                                 AMNISTIA     614
  8655     MOVE VECTOR3-AMNIST21 TO VECTOR-HIS-3-ABD07                                              AMNISTIA     615
  8656     MOVE VECTOR4-AMNIST21 TO VECTOR-HIS-4-ABD07.                                             AMNISTIA     616
  8657*****************************************************************                             AMNISTIA     617
  8658*200900-APLICAR-ART13-REGISTRO.                                         *                     AMNISTIA     618
  8659* RUTINA ENCARGADA DE APLICAR PERDON CON 8 AL DOBLE DEL TIEMPO DE*                            AMNISTIA     619
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 151
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8660* LA MORA (ARTICULO 13 DE LA LEY). PARA PERDONAR SE APOYA EN EL                               AMNISTIA     620
  8661* VECTOR DE MORAS DE TODA LA PERSONA                                                          AMNISTIA     621
  8662******************************************************************                            AMNISTIA     622
  8663 200900-APLICAR-ART13-REGISTRO.                                   GJC0006                     AMNISTIA     623
  8664     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006                     AMNISTIA     624
  8665     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006                     AMNISTIA     625
  8666     MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                      GJC0006                     AMNISTIA     626
  8667     IF IND-BLOQUEO-ABD07 = 0                                     GJC0006                     AMNISTIA     627
  8668        READ SUSCRIPTOR  IGNORE LOCK                              GJC0006                     AMNISTIA     628
  8669           INVALID KEY MOVE 0 TO ESTADO-ABD02                     GJC0006                     AMNISTIA     629
  8670       END-READ                                                   GJC0006                     AMNISTIA     630
  8671       IF ESTADO-ABD02 = 1                                        GJC0006                     AMNISTIA     631
  8672* PRIMERO SE REVISA SI ES DUDOSO RECAUDO O CAN MM CON MORA EN 0   GJC0006                     AMNISTIA     632
  8673* SE CAMBIA EL ESTADO SIN MÁS ANALISIS                            GJC0006                     AMNISTIA     633
  8674          IF (NOV-REPORT-ABD07 = 46 OR NOV-REPORT-ABD07 = 03) AND GJC0006                     AMNISTIA     634
  8675             (MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0)  GJC0006                     AMNISTIA     635
  8676            IF NOV-REPORT-ABD07 = 03                              GJC0006                     AMNISTIA     636
  8677               MOVE 06 TO NOV-REPORT-ABD07                        GJC0006                     AMNISTIA     637
  8678                         NOV-REPORT-R-ABD07                       GJC0006                     AMNISTIA     638
  8679            ELSE                                                  GJC0006                     AMNISTIA     639
  8680              IF COD-CTA-ABD07 = 02                               GJC0006                     AMNISTIA     640
  8681                 MOVE 06 TO NOV-REPORT-ABD07                      GJC0006                     AMNISTIA     641
  8682                            NOV-REPORT-R-ABD07                    GJC0006                     AMNISTIA     642
  8683              ELSE                                                GJC0006                     AMNISTIA     643
  8684                 MOVE 08 TO NOV-REPORT-ABD07                      GJC0006                     AMNISTIA     644
  8685                            NOV-REPORT-R-ABD07                    GJC0006                     AMNISTIA     645
  8686              END-IF                                              GJC0006                     AMNISTIA     646
  8687          ELSE                                                    GJC0006                     AMNISTIA     647
  8688             IF MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0 GJC0006                     AMNISTIA     648
  8689                MOVE 1 TO X-AMNIST21                              GJC0006                     AMNISTIA     649
  8690             ELSE                                                 GJC0006                     AMNISTIA     650
  8691                IF ESTADO-OBLIG-ABD07 <> 10                       GJC0011                     AMNISTIA     651
  8692                   PERFORM 200930-ART13-CTA-CON-MORA              GJC0011                     AMNISTIA     652
  8693                ELSE                                              GJC0011                     AMNISTIA     653
  8694                   MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21     GJC0011                     AMNISTIA     654
  8695                   MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21     GJC0011                     AMNISTIA     655
  8696                   MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21     GJC0011                     AMNISTIA     656
  8697                   MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21     GJC0011                     AMNISTIA     657
  8698                   PERFORM VARYING L-AMNIST21 FROM 1 BY 1         GJC0011                     AMNISTIA     658
  8699                        UNTIL L-AMNIST21 >12                      GJC0011                     AMNISTIA     659
  8700                     IF (VECT1-AMNIST21(L-AMNIST21:1) <>          GJC0011                     AMNISTIA     660
  8701                                               4 AND <> 0) OR     GJC0011                     AMNISTIA     661
  8702                        (VECT2-AMNIST21(L-AMNIST21:1) <>          GJC0011                     AMNISTIA     662
  8703                                               4 AND <> 0) OR     GJC0011                     AMNISTIA     663
  8704                        (VECT3-AMNIST21(L-AMNIST21:1) <>          GJC0011                     AMNISTIA     664
  8705                                               4 AND <> 0) OR     GJC0011                     AMNISTIA     665
  8706                        (VECT4-AMNIST21(L-AMNIST21:1) <>          GJC0011                     AMNISTIA     666
  8707                                               4 AND <> 0)        GJC0011                     AMNISTIA     667
  8708                        MOVE 100 TO L-AMNIST21                    GJC0011                     AMNISTIA     668
  8709                    END-IF                                        GJC0011                     AMNISTIA     669
  8710                   END-PERFORM                                    GJC0011                     AMNISTIA     670
  8711                   IF L-AMNIST21 >= 100                           GJC0011                     AMNISTIA     671
  8712                      PERFORM 200930-ART13-CTA-CON-MORA           GJC0011                     AMNISTIA     672
  8713                   END-IF                                         GJC0011                     AMNISTIA     673
  8714                END-IF                                            GJC0011                     AMNISTIA     674
  8715             END-IF                                               GJC0006                     AMNISTIA     675
  8716          END-IF                                                  GJC0006                     AMNISTIA     676
  8717     END-IF                                                       GJC0006                     AMNISTIA     677
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 152
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8718* SE RECUPERA EL REGISTRO DE SUSCRIPTOR QUE ESTABA LEIDO          GJC0006                     AMNISTIA     678
  8719     MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.           GJC0006                     AMNISTIA     679
  8720*****************************************************************                             AMNISTIA     680
  8721*200930-APLICAR-ART13-CTA-CON-MORA.                               *                           AMNISTIA     681
  8722* A ESTA RUTINA SOLO LLEGAN CUENTAS QUE HAYAN TENIDO MORA.SU OBJE-*                           AMNISTIA     682
  8723* TIVO ES VERIFICAR QUE LAPSOS DE MORA SE PUEDEN PERDONAR Y QUE   *                           AMNISTIA     683
  8724* LAPSOS NO                                                                                   AMNISTIA     684
  8725******************************************************************                            AMNISTIA     685
  8726 200930-ART13-CTA-CON-MORA.                                       GJC0006                     AMNISTIA     686
  8727     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006                     AMNISTIA     687
  8728     INITIALIZE K-AMNIST21 L-AMNIST21 Z-AMNIST21 X-AMNIST21       GJC0006                     AMNISTIA     688
  8729                 M-AMNIST21                                       GJC0006                     AMNISTIA     689
  8730                 IND-APLICO-CAD-AMNIST21                          GJC0012                     AMNISTIA     690
  8732     INITIALIZE VECTOR-100-CTA-AMNIST21 REPLACING                 GJC0006                     AMNISTIA     692
  8733             ALPHANUMERIC DATA BY CINCOS-AMNIST21(1:100)          GJC0006                     AMNISTIA     693
  8734     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006                     AMNISTIA     694
  8735     MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21             GJC0006                     AMNISTIA     695
  8736     MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21             GJC0006                     AMNISTIA     696
  8737     MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21             GJC0006                     AMNISTIA     697
  8738     MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21             GJC0006                     AMNISTIA     698
  8739     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0006                     AMNISTIA     699
  8740          MOR-EST-CTA-AMNIST21                                    GJC0006                     AMNISTIA     700
  8741*    PRIMERO SE LLENA EL VECTOR DE LA CUENTA EN 100 POSICIONES    GJC0006                     AMNISTIA     701
  8742     IF MESES-NOV-AMNIST21 < 52                                   GJC0006                     AMNISTIA     702
  8743        COMPUTE POSICION-INI-AMNIST21 = 52 - MESES-NOV-AMNIST21   GJC0006                     AMNISTIA     703
  8744        MOVE POSICION-INI-AMNIST21 TO K-AMNIST21                  GJC0006                     AMNISTIA     704
  8745        MOVE VECTOR-TOT-CTA-AMNIST21 TO                           GJC0006                     AMNISTIA     705
  8746             VECTOR-100-CTA-AMNIST21(K-AMNIST21:49)               GJC0006                     AMNISTIA     706
  8747             COMPUTE Z-AMNIST21 = K-AMNIST21 + 49                 GJC0006                     AMNISTIA     707
  8748     ELSE                                                         GJC0006                     AMNISTIA     708
  8749        PERFORM 200933-CADUCAR-MORAS                              GJC0012                     AMNISTIA     709
  8750        MOVE  1 TO POSICION-INI-AMNIST21                          GJC0006                     AMNISTIA     710
  8751        IF MESES-NOV-AMNIST21 <  100    *> <=                     GJC0006                     AMNISTIA     711
  8752           COMPUTE L-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006                     AMNISTIA     712
  8753              COMPUTE K-AMNIST21 = 50 - L-AMNIST21    *>49        GJC0006                     AMNISTIA     713
  8754            MOVE VECTOR-TOT-CTA-AMNIST21(K-AMNIST21:L-AMNIST21) TOGJC0006                     AMNISTIA     714
  8755                VECTOR-100-CTA-AMNIST21(1:L-AMNIST21)             GJC0006                     AMNISTIA     715
  8756              COMPUTE Z-AMNIST21 = L-AMNIST21 + 1                 GJC0006                     AMNISTIA     716
  8757        ELSE                                                      GJC0006                     AMNISTIA     717
  8758           MOVE 1 TO Z-AMNIST21 K-AMNIST21                        GJC0006                     AMNISTIA     718
  8759        END-IF                                                    GJC0006                     AMNISTIA     719
  8760     END-IF                                                       GJC0006                     AMNISTIA     720
  8761* SI EL ESTADO ACTUAL DE LA CUENTA ES MOROSO SE RELLENA DE MORAS  GJC0009                     AMNISTIA     721
  8762* HASTA LA POSICION 100                                           GJC0009                     AMNISTIA     722
  8763     IF (NOV-REPORT-ABD07 > 12 AND < 46) OR                       GJC0009                     AMNISTIA     723
  8764        NOV-REPORT-ABD07 = 47                                     GJC0009                     AMNISTIA     724
  8765        PERFORM UNTIL Z-AMNIST21 > 100                            GJC0006                     AMNISTIA     725
  8766           IF NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) <> 5       GJC0008                     AMNISTIA     726
  8767              MOVE 1 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)          GJC0009                     AMNISTIA     727
  8768           ELSE                                                   GJC0008                     AMNISTIA     728
  8769             MOVE 2 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)           GJC0008                     AMNISTIA     729
  8770           END-IF                                                 GJC0008                     AMNISTIA     730
  8771          ADD 1 TO Z-AMNIST21                                     GJC0006                     AMNISTIA     731
  8772        END-PERFORM                                               GJC0006                     AMNISTIA     732
  8773     ELSE                                                                                     AMNISTIA     733
  8774        MOVE 1 TO  VEC-100-CTA-AMNIST21(100)                                                  AMNISTIA     734
  8775     END-IF                                                       GJC0006                     AMNISTIA     735
  8776* SE REEEMPLAZAN EN EL VECTOR LAS POSICONES QUE NO SON MORA POR   GJC0009                     AMNISTIA     736
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 153
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8777* AL DIA                                                          GJC0009                     AMNISTIA     737
  8778     MOVE 1 TO VEC-100-CTA-AMNIST21(101)                          GJC0006                     AMNISTIA     738
  8779     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "0" BY "5"    GJC0006                     AMNISTIA     739
  8780     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "6" BY "5"    GJC0006                     AMNISTIA     740
  8781     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "7" BY "5"    GJC0006                     AMNISTIA     741
  8782     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "8" BY "5"    GJC0006                     AMNISTIA     742
  8783     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "9" BY "5"    GJC0006                     AMNISTIA     743
  8784* SE INICIA EL RECORRIDO PARA HALLAR LOS LAPOS DE MORA Y LA MORA  GJC0006                     AMNISTIA     744
  8785* CORRIDA                                                         GJC0006                     AMNISTIA     745
  8786     MOVE 0 TO LAPSO-AMNIST21                                     GJC0006                     AMNISTIA     746
  8787     MOVE 0 TO MAYOR-LAPSO-AMNIST21 SALIR-AMNIST21                GJC0006                     AMNISTIA     747
  8788               ESTOY-MOROSO-AMNIST21 MESES-MORAS-AMNIST21         GJC0006                     AMNISTIA     748
  8789     PERFORM VARYING Z-AMNIST21 FROM 1 BY 1 UNTIL Z-AMNIST21 > 30 GJC0006                     AMNISTIA     749
  8790             MOVE ZEROS TO VECTOR-LAPSOS(Z-AMNIST21)              GJC0006                     AMNISTIA     750
  8791     END-PERFORM                                                  GJC0006                     AMNISTIA     751
  8792     PERFORM UNTIL K-AMNIST21 > 101 OR SALIR-AMNIST21 = 1         GJC0006                     AMNISTIA     752
  8793        IF ESTOY-MOROSO-AMNIST21 = 1                              GJC0006                     AMNISTIA     753
  8794           IF VEC-100-CTA-AMNIST21(K-AMNIST21) <> 5               GJC0006                     AMNISTIA     754
  8795              ADD 1 TO MESES-MORAS-AMNIST21                       GJC0006                     AMNISTIA     755
  8796           ELSE                                                   GJC0006                     AMNISTIA     756
  8797              MOVE 0 TO ESTOY-MOROSO-AMNIST21                     GJC0006                     AMNISTIA     757
  8798             MOVE K-AMNIST21 TO L-AMNIST21                        GJC0006                     AMNISTIA     758
  8799           END-IF                                                 GJC0006                     AMNISTIA     759
  8800        ELSE                                                      GJC0006                     AMNISTIA     760
  8801           IF VEC-100-CTA-AMNIST21(K-AMNIST21) > 0 AND < 5        GJC0006                     AMNISTIA     761
  8802              IF MESES-MORAS-AMNIST21 > 0                         GJC0006                     AMNISTIA     762
  8803                 MOVE MESES-MORAS-AMNIST21 TO                     GJC0006                     AMNISTIA     763
  8804                 LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)              GJC0006                     AMNISTIA     764
  8805                 PERFORM 200935-VER-SI-DOBLE-MORA                 GJC0006                     AMNISTIA     765
  8806              END-IF                                              GJC0006                     AMNISTIA     766
  8807              ADD 1 TO LAPSO-AMNIST21                             GJC0006                     AMNISTIA     767
  8808              MOVE 1 TO MESES-MORAS-AMNIST21                      GJC0006                     AMNISTIA     768
  8809              MOVE 1 TO ESTOY-MOROSO-AMNIST21                     GJC0006                     AMNISTIA     769
  8810              MOVE K-AMNIST21 TO                                  GJC0006                     AMNISTIA     770
  8811                   INI-GRUPO-AMNIST21(LAPSO-AMNIST21)             GJC0006                     AMNISTIA     771
  8812              MOVE 0 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006                     AMNISTIA     772
  8813           END-IF                                                 GJC0006                     AMNISTIA     773
  8814        END-IF                                                    GJC0006                     AMNISTIA     774
  8815        ADD 1 TO K-AMNIST21                                       GJC0006                     AMNISTIA     775
  8816     END-PERFORM                                                  GJC0006                     AMNISTIA     776
  8817     COMPUTE L-AMNIST21 = LAPSO-AMNIST21 + 1                      GJC0006                     AMNISTIA     777
  8818     IF CTA-PERDONADA-AMNIST21 = 1 OR IND-APLICO-CAD-AMNIST21 = 1 GJC0012                     AMNISTIA     778
  8819        PERFORM 200940-PERDONAR-VECTOR-CTA                        GJC0006                     AMNISTIA     779
  8820        MOVE VECTOR-4-CTA-AMNIST21 TO VECTOR-HIS-4-ABD07          GJC0006                     AMNISTIA     780
  8821        MOVE VECTOR-3-CTA-AMNIST21 TO VECTOR-HIS-3-ABD07          GJC0006                     AMNISTIA     781
  8822        MOVE VECTOR-2-CTA-AMNIST21 TO VECTOR-HIS-2-ABD07          GJC0006                     AMNISTIA     782
  8823        MOVE VECTOR-1-CTA-AMNIST21 TO VECTOR-HIS-1-ABD07          GJC0006                     AMNISTIA     783
  8824        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0006                     AMNISTIA     784
  8825        PERFORM 555000-MANEJO-RECUP-Y-MM                          GJC0007                     AMNISTIA     785
  8826     END-IF.                                                      GJC0006                     AMNISTIA     786
  8827                                                                                              AMNISTIA     787
  8828******************************************************************                            AMNISTIA     788
  8829*200933-CADUCAR-MORAS                                            *                            AMNISTIA     789
  8830* A LAS CUENTAS CUYO VECTOR DE COMPORTAMIENTO NO CABE EN LAS 100                              AMNISTIA     790
  8831* POSICIONES DEL VECTOR EN QUE SE CALCULA LA APLICACION DEL AR-  *                            AMNISTIA     791
  8832* TICULO 13 SE APLICA LA CADUCIDAD SOBRE LO QUE LLEVA MAS DE                                  AMNISTIA     792
  8833* 48 MESES                                                                                    AMNISTIA     793
  8834******************************************************************                            AMNISTIA     794
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 154
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8835 200933-CADUCAR-MORAS.                                            GJC0012                     AMNISTIA     795
  8836     IF NOV-REPORT-ABD07 < 13 OR  = 46                            GJC0012                     AMNISTIA     796
  8837      PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 48GJC0012                     AMNISTIA     797
  8838       IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5            GJC0012                     AMNISTIA     798
  8839          MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)              GJC0012                     AMNISTIA     799
  8840          IF IND-APLICO-CAD-AMNIST21 = 0                          GJC0012                     AMNISTIA     800
  8841             MOVE 1 TO IND-APLICO-CAD-AMNIST21                    GJC0012                     AMNISTIA     801
  8842          END-IF                                                  GJC0012                     AMNISTIA     802
  8843       END-IF                                                     GJC0012                     AMNISTIA     803
  8844      END-PERFORM                                                 GJC0012                     AMNISTIA     804
  8845     END-IF.                                                      GJC0012                     AMNISTIA     805
  8846                                                                                              AMNISTIA     806
  8847******************************************************************                            AMNISTIA     807
  8848*200935-VER-SI-DOBLE-MORA                                          *                          AMNISTIA     808
  8849* VALIDA SI SE PUEDE PERDONAR O NO EL PERIODO DE GRACIA QUE SE                                AMNISTIA     809
  8850*ESTÁ ANALIZANDO*                                                                             AMNISTIA     810
  8851******************************************************************                            AMNISTIA     811
  8852 200935-VER-SI-DOBLE-MORA.                                        GJC0006                     AMNISTIA     812
  8853     IF MESES-MORAS-AMNIST21 >  MAYOR-LAPSO-AMNIST21              GJC0006                     AMNISTIA     813
  8854        COMPUTE X-AMNIST21 = (MESES-MORAS-AMNIST21 * 2) *> OJO + 1GJC0006                     AMNISTIA     814
  8855     ELSE                                                         GJC0006                     AMNISTIA     815
  8856        COMPUTE X-AMNIST21 = (MAYOR-LAPSO-AMNIST21 * 2) *> OJO + 1GJC0006                     AMNISTIA     816
  8857     END-IF                                                       GJC0006                     AMNISTIA     817
  8858     IF X-AMNIST21 > 48                                           GJC0011                     AMNISTIA     818
  8859       MOVE 48 TO X-AMNIST21                                      GJC0011                     AMNISTIA     819
  8860     END-IF                                                       GJC0011                     AMNISTIA     820
  8861     IF X-AMNIST21 <= 101 - L-AMNIST21                            GJC0006                     AMNISTIA     821
  8862        MOVE 0 TO M-AMNIST21                                      GJC0006                     AMNISTIA     822
  8863        INSPECT VECTOR-100-CTA-AMNIST21(L-AMNIST21:X-AMNIST21)    GJC0006                     AMNISTIA     823
  8864             TALLYING M-AMNIST21 FOR ALL                          GJC0006                     AMNISTIA     824
  8865                      CINCOS-AMNIST21(1:X-AMNIST21)               GJC0006                     AMNISTIA     825
  8866        IF M-AMNIST21 > 0                                         GJC0006                     AMNISTIA     826
  8867* LAS 2 SIGUIENTES INSTRUCCIONES Y EL ELSE DEL IF SE DEBEN DESCO- GJC0009                     AMNISTIA     827
  8868* MENTAREAR SI SE DECIDE APLICAR ARTICULO 13 POR PERSONA CUENTA   GJC0009                     AMNISTIA     828
  8869*PER       COMPUTE MESES-AMNIST21 = L-AMNIST21 + X-AMNIST21 - 1   GJC0009                     AMNISTIA     829
  8870*PER       IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21) = 5         GJC0009                     AMNISTIA     830
  8871              MOVE 1 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006                     AMNISTIA     831
  8872              MOVE 1 TO CTA-PERDONADA-AMNIST21                    GJC0006                     AMNISTIA     832
  8873              IF LAPSO-AMNIST21 > 1                               GJC0006                     AMNISTIA     833
  8874                 COMPUTE Z-AMNIST21 = LAPSO-AMNIST21 - 1          GJC0006                     AMNISTIA     834
  8875                 PERFORM UNTIL Z-AMNIST21 = 0                     GJC0006                     AMNISTIA     835
  8876                    IF PERDON-GRUPO-AMNIST21(Z-AMNIST21) = 0      GJC0006                     AMNISTIA     836
  8877                       MOVE 1 TO                                  GJC0006                     AMNISTIA     837
  8878                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)        GJC0006                     AMNISTIA     838
  8879                       COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1        GJC0006                     AMNISTIA     839
  8880                    ELSE                                          GJC0006                     AMNISTIA     840
  8881                       MOVE 0 TO Z-AMNIST21                       GJC0006                     AMNISTIA     841
  8882                    END-IF                                        GJC0006                     AMNISTIA     842
  8883                 END-PERFORM                                      GJC0006                     AMNISTIA     843
  8884                 MOVE 0 TO MAYOR-LAPSO-AMNIST21                   GJC0006                     AMNISTIA     844
  8885              END-IF                                              GJC0006                     AMNISTIA     845
  8886*PER       ELSE                                                   GJC0009                     AMNISTIA     846
  8887*PER          COMPUTE X-AMNIST21 =  X-AMNIST21 + L-AMNIST21       GJC0009                     AMNISTIA     847
  8888*PER          ADD 1 TO  MESES-AMNIST21                            GJC0009                     AMNISTIA     848
  8889*PER          PERFORM UNTIL X-AMNIST21 > 100 OR                   GJC0009                     AMNISTIA     849
  8890*PER               PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)= 1       GJC0009                     AMNISTIA     850
  8891*PER             IF VEC-100-CTA-AMNIST21(X-AMNIST21) = "5" OR "2" GJC0009                     AMNISTIA     851
  8892*PER                IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21)    GJC0009                     AMNISTIA     852
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 155
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8893*PER                      = "5"                                   GJC0009                     AMNISTIA     853
  8894*PER                   MOVE 1 TO                                  GJC0009                     AMNISTIA     854
  8895*PER                         PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)GJC0009                     AMNISTIA     855
  8896*PER                   MOVE 1 TO CTA-PERDONADA-AMNIST21           GJC0009                     AMNISTIA     856
  8897*PER                   IF LAPSO-AMNIST21 > 1                      GJC0009                     AMNISTIA     857
  8898*PER                      MOVE LAPSO-AMNIST21 TO Z-AMNIST21       GJC0009                     AMNISTIA     858
  8899*PER                      PERFORM UNTIL Z-AMNIST21 = 0            GJC0009                     AMNISTIA     859
  8900*PER                         MOVE 1 TO                            GJC0009                     AMNISTIA     860
  8901*PER                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)    GJC0009                     AMNISTIA     861
  8902*PER                         COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1  GJC0009                     AMNISTIA     862
  8903*PER                      END-PERFORM                             GJC0009                     AMNISTIA     863
  8904*PER                      MOVE 0 TO MAYOR-LAPSO-AMNIST21          GJC0009                     AMNISTIA     864
  8905*PER                   END-IF                                     GJC0009                     AMNISTIA     865
  8906*PER                END-IF                                        GJC0009                     AMNISTIA     866
  8907*PER             ELSE                                             GJC0009                     AMNISTIA     867
  8908*PER               MOVE 105 TO X-AMNIST21                         GJC0009                     AMNISTIA     868
  8909*PER             END-IF                                           GJC0009                     AMNISTIA     869
  8910*PER             ADD 1 TO X-AMNIST21                              GJC0009                     AMNISTIA     870
  8911*PER             ADD 1 TO MESES-AMNIST21                          GJC0009                     AMNISTIA     871
  8912*PER          END-PERFORM                                         GJC0009                     AMNISTIA     872
  8913*PER       END-IF                                                 GJC0009                     AMNISTIA     873
  8914        ELSE                                                      GJC0006                     AMNISTIA     874
  8915          IF MAYOR-LAPSO-AMNIST21 <                               GJC0006                     AMNISTIA     875
  8916             LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)                  GJC0006                     AMNISTIA     876
  8917              MOVE LONG-GRUPO-AMNIST21(LAPSO-AMNIST21) TO         GJC0006                     AMNISTIA     877
  8918                                    MAYOR-LAPSO-AMNIST21          GJC0006                     AMNISTIA     878
  8919          END-IF                                                  GJC0006                     AMNISTIA     879
  8920        END-IF                                                    GJC0006                     AMNISTIA     880
  8921     ELSE                                                                                     AMNISTIA     881
  8922        MOVE 1 TO SALIR-AMNIST21                                  GJC0006                     AMNISTIA     882
  8923     END-IF.                                                      GJC0006                     AMNISTIA     883
  8924                                                                                              AMNISTIA     884
  8925******************************************************************                            AMNISTIA     885
  8926*200940-PERDONAR-VECTOR-CTA.                                     *                            AMNISTIA     886
  8927* SE HACE EL PERDOS SOBRE CADA UNO DE LOS LAPSOS DE MORA SOBRE   *                            AMNISTIA     887
  8928* LOS QUE LA CUENTA TIENE DERECHO A PERDON                                                    AMNISTIA     888
  8929******************************************************************                            AMNISTIA     889
  8930 200940-PERDONAR-VECTOR-CTA.                                      GJC0006                     AMNISTIA     890
  8931     PERFORM VARYING LAPSO-AMNIST21 FROM 1 BY 1 UNTIL             GJC0006                     AMNISTIA     891
  8932        LAPSO-AMNIST21 > 30                                       GJC0006                     AMNISTIA     892
  8933       IF PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21) = 1               GJC0006                     AMNISTIA     893
  8934          COMPUTE Z-AMNIST21 = INI-GRUPO-AMNIST21(LAPSO-AMNIST21) GJC0006                     AMNISTIA     894
  8935                             - POSICION-INI-AMNIST21 + 1          GJC0006                     AMNISTIA     895
  8936          MOVE 0 TO K-AMNIST21                                    GJC0006                     AMNISTIA     896
  8937          PERFORM VARYING L-AMNIST21 FROM                         GJC0006                     AMNISTIA     897
  8938            Z-AMNIST21 BY 1 UNTIL                                 GJC0006                     AMNISTIA     898
  8939                K-AMNIST21 = LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)  GJC0006                     AMNISTIA     899
  8940            IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5       GJC0006                     AMNISTIA     900
  8941               MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)         GJC0006                     AMNISTIA     901
  8942            END-IF                                                GJC0006                     AMNISTIA     902
  8943            ADD 1 TO K-AMNIST21                                   GJC0006                     AMNISTIA     903
  8944          END-PERFORM                                             GJC0006                     AMNISTIA     904
  8945       ELSE                                                       GJC0006                     AMNISTIA     905
  8946          MOVE 51 TO LAPSO-AMNIST21                               GJC0006                     AMNISTIA     906
  8947       END-IF                                                     GJC0006                     AMNISTIA     907
  8948     END-PERFORM.                                                 GJC0006                     AMNISTIA     908
  8949                                                                                              AMNISTIA     909
  8950******************************************************************                            AMNISTIA     910
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 156
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  8951*50000-RECONSTRUCCION-HISTORIA.                                                               AMNISTIA     911
  8952*VOLTEA LOS VECTORES Y LLAMA A LAS RUTINAS QUE RECALCULAN EL ESTADO                           AMNISTIA     912
  8953*DEJANDO FINALMENTE LOS VECTORES COMO DEBEN QUEDAR                                            AMNISTIA     913
  8954******************************************************************                            AMNISTIA     914
  8955 500000-RECONSTRUCCION-HISTORIA.                                  GJC0006                     AMNISTIA     915
  8956     MOVE 0 TO MES-MORA-MAX-AMNIST21  MES-MORA-MAX-48-AMNIST21.   GJC0006                     AMNISTIA     916
  8957     INITIALIZE FEC-MORMAX-AMNIST21 FEC-MORMAX-48-AMNIST21.       GJC0006                     AMNISTIA     917
  8958     MOVE NOV-REPORT-ABD07 TO ESTADO-AMNIST21 ESTADO-FIN-AMNIST21 GJC0006                     AMNISTIA     918
  8959     MOVE FEC-NOVEDAD-ABD07 TO  FEC-MM-AA-AMNIST21                GJC0006                     AMNISTIA     919
  8960     IF FEC-MM-AA-AMNIST21 (3:2) > 60                             GJC0006                     AMNISTIA     920
  8961        MOVE 19 TO SIGLO-AMNIST21                                 GJC0006                     AMNISTIA     921
  8962     ELSE                                                         GJC0006                     AMNISTIA     922
  8963        MOVE 20 TO SIGLO-AMNIST21                                 GJC0006                     AMNISTIA     923
  8964     END-IF                                                       GJC0006                     AMNISTIA     924
  8965     MOVE FEC-MM-AA-AMNIST21 (1:2)  TO MES-AMNIST21               GJC0006                     AMNISTIA     925
  8966     MOVE FEC-MM-AA-AMNIST21 (3:2)  TO ANO-AMNIST21               GJC0006                     AMNISTIA     926
  8967     MOVE FECHA-AMNIST21  TO FEC-INI-MOR-AMNIST21.                GJC0006                     AMNISTIA     927
  8968     PERFORM 500500-NUEVA-NOVEDAD                                 GJC0006                     AMNISTIA     928
  8969     PERFORM 500600-CALCULO-FECHAMX                               GJC0006                     AMNISTIA     929
  8970*    IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007                     AMNISTIA     930
  8971*       (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007                     AMNISTIA     931
  8972*       IF ESTADO-FIN-AMNIST21 = 03                               GJC0007                     AMNISTIA     932
  8973*          MOVE 06 TO NOV-REPORT-ABD07                            GJC0007                     AMNISTIA     933
  8974*                     NOV-REPORT-R-ABD07                          GJC0007                     AMNISTIA     934
  8975*       ELSE                                                      GJC0007                     AMNISTIA     935
  8976*          IF COD-CTA-ABD07 = 02                                  GJC0007                     AMNISTIA     936
  8977*             MOVE 06 TO NOV-REPORT-ABD07                         GJC0007                     AMNISTIA     937
  8978*                     NOV-REPORT-R-ABD07                          GJC0007                     AMNISTIA     938
  8979*          ELSE                                                   GJC0007                     AMNISTIA     939
  8980*             MOVE 08 TO NOV-REPORT-ABD07                         GJC0007                     AMNISTIA     940
  8981*                        NOV-REPORT-R-ABD07                       GJC0007                     AMNISTIA     941
  8982*          END-IF                                                 GJC0007                     AMNISTIA     942
  8983*     ELSE *> LINEAS CONVERTIDAS EN RUT 555000-MANEJO-RECUP-Y-MM  GJC0007                     AMNISTIA     943
  8984*       MOVE ESTADO-FIN-AMNIST21 TO NOV-REPORT-ABD07              GJC0012                     AMNISTIA     944
  8985        MOVE ESTADO-FIN48-AMNIST21 TO NOV-REPORT-R-ABD07          GJC0006                     AMNISTIA     945
  8986                                      NOV-REPORT-ABD07            GJC0012                     AMNISTIA     946
  8987*     END-IF                                                      GJC0007                     AMNISTIA     947
  8988*    MOVE FEC-MORMAX-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07          GJC0006                     AMNISTIA     948
  8989*    MOVE NUM-MOR30-AMNIST21 TO NUM-MORAS30-ABD07                 GJC0006                     AMNISTIA     949
  8990     MOVE FEC-MORMAX-48-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07       GJC0006                     AMNISTIA     950
  8991*    MOVE MORMAX-AMNIST21 TO MORA-MAXIMA-ABD07.                   GJC0006                     AMNISTIA     951
  8992     MOVE MORMAX48-AMNIST21 TO MORA-MAXIMA-R-ABD07                GJC0006                     AMNISTIA     952
  8993                               MORA-MAXIMA-ABD07.                 GJC0006                     AMNISTIA     953
  8994     MOVE NUM-MOR30-48-AMNIST21 TO NUM-MORAS30-ABD07.             GJC0006                     AMNISTIA     954
  8995  500500-NUEVA-NOVEDAD.                                                                       AMNISTIA     955
  8996******************************************************************                            AMNISTIA     956
  8997* 50500-NUEVA-NOVEDAD.                                                                        AMNISTIA     957
  8998* CON EL VECTOR DE COMPORTAMIENTO PERDONADO Y SEGÚN LA NOVEDAD                                AMNISTIA     958
  8999* ACTUAL, CALCULA CON LA MATRIZ DE RECONSTRUCCIÓN HISTÓRICA                                   AMNISTIA     959
  9000* LA NUEVA NOVEDAD DE LA OBLIGACIÓN                                                           AMNISTIA     960
  9001******************************************************************                            AMNISTIA     961
  9002     MOVE 0 TO NUM-MOR30-AMNIST21  NUM-MOR30-48-AMNIST21          GJC0006                     AMNISTIA     962
  9003     MOVE 0 TO MORMAX-AMNIST21 MORMAX48-AMNIST21                  GJC0006                     AMNISTIA     963
  9004     MOVE 0 TO FEC-MORMAX-AMNIST21   FEC-MORMAX-48-AMNIST21       GJC0006                     AMNISTIA     964
  9005     MOVE 01 TO ESTADO-INI-AMNIST21 ESTADO-INI48-AMNIST21         GJC0006                     AMNISTIA     965
  9006     PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 49 GJC0006                     AMNISTIA     966
  9007      MOVE VEC-TOT-CTA-AMNIST21(L-AMNIST21) TO K-AMNIST21         GJC0006                     AMNISTIA     967
  9008      IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX48-AMNIST21        GJC0006                     AMNISTIA     968
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 157
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  9009      COMPUTE MES-MORA-MAX-48-AMNIST21 = (49 - L-AMNIST21) + 1    GJC0006                     AMNISTIA     969
  9010         MOVE K-AMNIST21 TO MORMAX48-AMNIST21                     GJC0006                     AMNISTIA     970
  9011      END-IF                                                      GJC0006                     AMNISTIA     971
  9012      IF K-AMNIST21 = 1                                           GJC0006                     AMNISTIA     972
  9013         ADD 1 TO NUM-MOR30-48-AMNIST21                           GJC0006                     AMNISTIA     973
  9014      END-IF                                                      GJC0006                     AMNISTIA     974
  9015      IF L-AMNIST21 > 24                                          GJC0006                     AMNISTIA     975
  9016       IF K-AMNIST21 = 1                                          GJC0006                     AMNISTIA     976
  9017          ADD 1 TO NUM-MOR30-AMNIST21                             GJC0006                     AMNISTIA     977
  9018       END-IF                                                     GJC0006                     AMNISTIA     978
  9019       IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX-AMNIST21         GJC0006                     AMNISTIA     979
  9020          COMPUTE  MES-MORA-MAX-AMNIST21 = (49 - L-AMNIST21) + 1  GJC0006                     AMNISTIA     980
  9021          MOVE K-AMNIST21 TO MORMAX-AMNIST21                      GJC0006                     AMNISTIA     981
  9022       END-IF                                                     GJC0006                     AMNISTIA     982
  9023      END-IF                                                      GJC0006                     AMNISTIA     983
  9024       IF L-AMNIST21 = 49                                         GJC0006                     AMNISTIA     984
  9025          IF (ESTADO-AMNIST21 > 12 AND < 42) OR                   GJC0006                     AMNISTIA     985
  9026             ESTADO-AMNIST21 = 01                                 GJC0006                     AMNISTIA     986
  9027             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006                     AMNISTIA     987
  9028             ESTADO-FIN-AMNIST21                                  GJC0006                     AMNISTIA     988
  9029             MOVE                                                 GJC0006                     AMNISTIA     989
  9030             NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,             GJC0006                     AMNISTIA     990
  9031                             ESTADO-FIN-AMNIST21)                 GJC0006                     AMNISTIA     991
  9032                           TO ESTADO-FIN-AMNIST21                 GJC0006                     AMNISTIA     992
  9033             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006                     AMNISTIA     993
  9034                  ESTADO-FIN48-AMNIST21                           GJC0006                     AMNISTIA     994
  9035             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,      GJC0006                     AMNISTIA     995
  9036                  ESTADO-FIN48-AMNIST21) TO ESTADO-FIN48-AMNIST21 GJC0006                     AMNISTIA     996
  9037          ELSE                                                    GJC0006                     AMNISTIA     997
  9038             IF ESTADO-AMNIST21 > 07 AND < 13                     GJC0006                     AMNISTIA     998
  9039                COMPUTE ESTADO-FIN-AMNIST21 =                     GJC0006                     AMNISTIA     999
  9040                        08 + MORMAX-AMNIST21                      GJC0006                     AMNISTIA    1000
  9041                COMPUTE ESTADO-FIN48-AMNIST21 =                   GJC0006                     AMNISTIA    1001
  9042                        08 + MORMAX48-AMNIST21                    GJC0006                     AMNISTIA    1002
  9043             ELSE                                                 GJC0006                     AMNISTIA    1003
  9044                MOVE ESTADO-AMNIST21 TO ESTADO-FIN-AMNIST21       GJC0006                     AMNISTIA    1004
  9045                MOVE ESTADO-AMNIST21 TO ESTADO-FIN48-AMNIST21     GJC0006                     AMNISTIA    1005
  9046             END-IF                                               GJC0006                     AMNISTIA    1006
  9047          END-IF                                                  GJC0006                     AMNISTIA    1007
  9048       ELSE                                                       GJC0006                     AMNISTIA    1008
  9049         IF K-AMNIST21 = 7 OR 8                                   GJC0006                     AMNISTIA    1009
  9050            MOVE 5 TO K-AMNIST21                                  GJC0006                     AMNISTIA    1010
  9051         END-IF                                                   GJC0006                     AMNISTIA    1011
  9052         IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                     GJC0006                     AMNISTIA    1012
  9053            MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,       GJC0006                     AMNISTIA    1013
  9054                                       K-AMNIST21) TO             GJC0006                     AMNISTIA    1014
  9055                 ESTADO-INI48-AMNIST21                            GJC0006                     AMNISTIA    1015
  9056         END-IF                                                   GJC0006                     AMNISTIA    1016
  9057         IF L-AMNIST21 > 24                                       GJC0006                     AMNISTIA    1017
  9058          IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                    GJC0006                     AMNISTIA    1018
  9059             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,        GJC0006                     AMNISTIA    1019
  9060                 K-AMNIST21) TO ESTADO-INI-AMNIST21               GJC0006                     AMNISTIA    1020
  9061          END-IF                                                  GJC0006                     AMNISTIA    1021
  9062         END-IF                                                   GJC0006                     AMNISTIA    1022
  9063       END-IF                                                     GJC0006                     AMNISTIA    1023
  9064     END-PERFORM.                                                 GJC0006                     AMNISTIA    1024
  9065                                                                                              AMNISTIA    1025
  9066******************************************************************                            AMNISTIA    1026
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 158
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  9067*500600-CALCULO-FECHAMX.                                                                      AMNISTIA    1027
  9068* CON EL VECTOR YA PERDONADO, CALCULA LA NUEVA FECHA DE MORA                                  AMNISTIA    1028
  9069* MÁXIMA                                                                                      AMNISTIA    1029
  9070******************************************************************                            AMNISTIA    1030
  9071 500600-CALCULO-FECHAMX.                                          GJC0006                     AMNISTIA    1031
  9072     IF MES-MORA-MAX-AMNIST21 > 0                                 GJC0006                     AMNISTIA    1032
  9073        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0006                     AMNISTIA    1033
  9074        MOVE 1 TO L-AMNIST21                                      GJC0006                     AMNISTIA    1034
  9075        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21=                GJC0006                     AMNISTIA    1035
  9076                MES-MORA-MAX-AMNIST21                             GJC0006                     AMNISTIA    1036
  9077**SE DEBE CONTROLAR SI L-AMNIST21SE PASA de 25  ******************GJC0006                     AMNISTIA    1037
  9078        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006                     AMNISTIA    1038
  9079        MOVE MES-AMNIST21   TO FEC-MM-AAAA-AMNIST21 (1:2)         GJC0006                     AMNISTIA    1039
  9080        MOVE FEC-MM-AAAA-AMNIST21  TO FEC-MORMAX-AMNIST21         GJC0006                     AMNISTIA    1040
  9081     END-IF.                                                      GJC0006                     AMNISTIA    1041
  9082     IF MES-MORA-MAX-48-AMNIST21 > 0                              GJC0006                     AMNISTIA    1042
  9083        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0010                     AMNISTIA    1043
  9084        MOVE 1 TO L-AMNIST21                                      GJC0006                     AMNISTIA    1044
  9085        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21 =               GJC0006                     AMNISTIA    1045
  9086                                          MES-MORA-MAX-48-AMNIST21GJC0006                     AMNISTIA    1046
  9087        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006                     AMNISTIA    1047
  9088        MOVE MES-AMNIST21  TO FEC-MM-AAAA-AMNIST21 (1:2)          GJC0006                     AMNISTIA    1048
  9089        MOVE FEC-MM-AAAA-AMNIST21 TO FEC-MORMAX-48-AMNIST21       GJC0006                     AMNISTIA    1049
  9090     END-IF.                                                      GJC0006                     AMNISTIA    1050
  9091 555000-MANEJO-RECUP-Y-MM.                                        GJC0007                     AMNISTIA    1051
  9092******************************************************************                            AMNISTIA    1052
  9093*555000-MANEJO-RECUP-Y-MM                                                                     AMNISTIA    1053
  9094* SOLO SE DEBE INVOCAR CUANDO UNA CUANTA ES PERDONADA Y SIRVE PARA                            AMNISTIA    1054
  9095* DEJAR UNA CUENTA QUE FUE RECUPERADA O CANCELADA POR MAL MANEJO                              AMNISTIA    1055
  9096* EN PAGO VOLUNTARIO O CANCELADA VOL SI NO QUEDARON MORAS                                     AMNISTIA    1056
  9097******************************************************************                            AMNISTIA    1057
  9098     IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007                     AMNISTIA    1058
  9099        (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007                     AMNISTIA    1059
  9100        IF ESTADO-FIN-AMNIST21 = 03                               GJC0007                     AMNISTIA    1060
  9101           MOVE 06 TO NOV-REPORT-ABD07                            GJC0007                     AMNISTIA    1061
  9102                      NOV-REPORT-R-ABD07                          GJC0007                     AMNISTIA    1062
  9103        ELSE                                                      GJC0007                     AMNISTIA    1063
  9104           IF COD-CTA-ABD07 = 02                                  GJC0007                     AMNISTIA    1064
  9105              MOVE 06 TO NOV-REPORT-ABD07                         GJC0007                     AMNISTIA    1065
  9106                      NOV-REPORT-R-ABD07                          GJC0007                     AMNISTIA    1066
  9107           ELSE                                                   GJC0007                     AMNISTIA    1067
  9108              MOVE 08 TO NOV-REPORT-ABD07                         GJC0007                     AMNISTIA    1068
  9109                         NOV-REPORT-R-ABD07                       GJC0007                     AMNISTIA    1069
  9110           END-IF                                                 GJC0007                     AMNISTIA    1070
  9111        END-IF                                                    GJC0007                     AMNISTIA    1071
  9112     END-IF.                                                      GJC0007                     AMNISTIA    1072
  9113********************************************************************                          AMNISTIA    1073
  9114*510000-ADDUNOTOI.                                                                            AMNISTIA    1074
  9115* RETROCEDE UN MES EN EL TIEMPO TENIENDO EN CUENTA EL CAMBIO DE AÑO                           AMNISTIA    1075
  9116* Y SI LA INFORMACIÓN VALIDA DEL VECTOR HA TERMINADO, FINALIZA LA                             AMNISTIA    1076
  9117* REVISIÓN DE CADUCIDAD SOBRE EL VECTOR                                                       AMNISTIA    1077
  9118********************************************************************                          AMNISTIA    1078
  9119 510000-ADDUNOTOI.                                                GJC0006                     AMNISTIA    1079
  9120     ADD 1 TO L-AMNIST21                                          GJC0006                     AMNISTIA    1080
  9121     SUBTRACT 1 FROM MES-AMNIST21                                 GJC0006                     AMNISTIA    1081
  9122     IF MES-AMNIST21 = 0                                          GJC0006                     AMNISTIA    1082
  9123        MOVE 12 TO MES-AMNIST21                                   GJC0006                     AMNISTIA    1083
  9124        SUBTRACT 1 FROM ANO-T-AMNIST21                            GJC0006                     AMNISTIA    1084
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 159
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/AMNISTIA21
  9125     END-IF.                                                      GJC0006                     AMNISTIA    1085
  9126                                                                                              AMNISTIA    1086
  9127******************************************************************                            AMNISTIA    1087
  9128*200950-CONVIERTE-FECHA                                          *                            AMNISTIA    1088
  9129* CONVIERTE FECHA DE FORMATO MMYY A YYYYMM                       *                            AMNISTIA    1089
  9130******************************************************************                            AMNISTIA    1090
  9131 200950-CONVIERTE-FECHA.                                                                      AMNISTIA    1091
  9132     MOVE  MES-AUX-AMNIST21   TO  FMILENIO-MES-AMNIST21                                       AMNISTIA    1092
  9133     MOVE  ANO-AUX-AMNIST21   TO  FMILENIO-ANIO-AMNIST21                                      AMNISTIA    1093
  9134     IF ANO-AUX-AMNIST21   > 60                                                               AMNISTIA    1094
  9135        MOVE 19               TO  FMILENIO-SIGLO-AMNIST21                                     AMNISTIA    1095
  9136     ELSE                                                                                     AMNISTIA    1096
  9137        MOVE 20               TO  FMILENIO-SIGLO-AMNIST21                                     AMNISTIA    1097
  9138     END-IF                                                                                   AMNISTIA    1098
  9139     MOVE  FECHA-MILENIO-AMNIST21  TO  FEC-NOVEDAD-AMNIST21.                                  AMNISTIA    1099
* 9140 COPY VALNOM.PROC.                                                                            LEEMAEST      40
  9141*VALNOM-PROC.v.0005                                                                           VALNOM         1
  9142******************************************************************                            VALNOM         2
  9143* RUTINA CREADA PARA HACER LA VALIDACION DE NOMBRES CONTRA LOS                                VALNOM         3
  9144* ARCHIVOS DE LA REGISTRADURIA, DIAN Y DAS, DEPENDIENDO DEL TIPO                              VALNOM         4
  9145* DE IDENTIFICACION RECIBIDA.                                                                 VALNOM         5
  9146*    PARAMETROS                                                                               VALNOM         6
  9147*        BLOQUES-INPUT-VALNOM - NUMERO DE BLOQUES A VALIDAR                                   VALNOM         7
  9148*        NOMBRE-INPUT-VALNOM  - NOMBRE A VALIDAR                                              VALNOM         8
  9149*        NOMBOK-INPUT-VALNOM  - NOMBRE CORRECTO CON EL QUE SE                                 VALNOM         9
  9150*                               DEBE COMPARAR NOMBRE-INPUT-VALNOM                             VALNOM        10
  9151*        TIP-ID-INPUT-VALNOM  - TIPO DE IDENTIFICACION A VALIDAR                              VALNOM        11
  9152*    SALIDAS:                                                                                 VALNOM        12
  9153*        MATCH-OK-OUT-VALNOM  - 0-NO HUBO       1-HUBO                                        VALNOM        13
  9154*******************************************************************                           VALNOM        14
  9155* RMB0002   * VAL001: SE MEJORA LA VALIDACION DE NOMBRES EN PERSONAS                          VALNOM        15
  9156* R.MARTINEZ* JURIDICAS                                                                       VALNOM        16
  9157* DIC.2002  *                                                                                 VALNOM        17
  9158*******************************************************************                           VALNOM        18
  9159* GJC0003    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION                     VALNOM        19
  9160* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES                      VALNOM        20
  9161* MARZO/2003 * PARA CEDULAS, EL COMODIN QUE USUALMENTE CORRESPONDE A LA N                     VALNOM        21
  9162*            * SOLO SE COMPARA CONTRA N O CONTRA BLANCOS                                      VALNOM        22
  9163*************************************************************************                     VALNOM        23
  9164* GJC0004    * VALME1 :CON EL FIN DE AFINAR AUN MAS EL PROCESO DE VALIDA-                     VALNOM        24
  9165* R.MARTINEZ * CION DE NOMBRES, EN EL MATCH A PROXIMADO DE PERSONAS NATU-                     VALNOM        25
  9166* G.JIMENEZ  * RALES SE CAMBIA EL CALCULO FINAL PARA DETERMINAR SI UN BLO-                    VALNOM        26
  9167* MARZO/2003 * QUE ES O NO VALIDO. PARA QUE UN NOMBRE QUE VENGA NUMERICO                      VALNOM        27
  9168*            * NO SE CONVIERTA EN COMODIN, EN LAS SUSTITUCIONES POR *                         VALNOM        28
  9169*            * SE VALIDA QUE EL CONTENIDO NO SEA NUMERICO.                                    VALNOM        29
  9170*************************************************************************                     VALNOM        30
  9171* GJC0005    * VLNM01: LOS PROGRAMAS ABORTAN CUANDO ALGUNO DE LOS                             VALNOM        31
  9172* G.JIMENEZ  *         PARAMETROS DE UN SUBSTRING QUEDA EN 0 O EN                             VALNOM        32
  9173* NOV/2005   *         UN NUMERO MENOR QUE 0. EJ: NOMBRE(I:J) DONDE I O                       VALNOM        33
  9174*            *         J ES 0.                                                                VALNOM        34
  9175*************************************************************************                     VALNOM        35
  9176 10000-MATCH-NOMBRES-VALNOM.                                                                  VALNOM        36
  9177******************************************************************                            VALNOM        37
  9178*10000-MATCH-NOMBRE-VALNOM.                                                                   VALNOM        38
  9179* SE BUSCA DETERMINAR SI EL NOMBRE DE LA PERSONA CONSULTADA HACE                              VALNOM        39
  9180*       CON EL NOMBRE ENVIADO EN LA CONSULTA.                                                 VALNOM        40
  9181******************************************************************                            VALNOM        41
  9182     MOVE 0 TO MATCH-OK-OUT-VALNOM.                                                           VALNOM        42
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 160
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9183     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM        43
  9184     IF TIP-ID-INPUT-VALNOM  = 2                                                              VALNOM        44
  9185         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                              VALNOM        45
  9186           " S.A. " BY "      ",                                  RMB0002                     VALNOM        46
  9187           "." BY " ", " LTDA " BY "      ",                      RMB0002                     VALNOM        47
  9188           " LIMITADA " BY "          ",                          RMB0002                     VALNOM        48
  9189           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002                     VALNOM        49
  9190           " INVERSIONES " BY "             ",                    RMB0002                     VALNOM        50
  9191           " EMPRESA " BY "         ",                            RMB0002                     VALNOM        51
  9192           " CORPORACION " BY "             ",                    RMB0002                     VALNOM        52
  9193           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002                     VALNOM        53
  9194           " S " BY "   ", " A " BY "   "                         RMB0002                     VALNOM        54
  9195           " Y " BY "   "                                         GJC0003                     VALNOM        55
  9196         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM        56
  9197           " S.A. " BY "      ",                                  RMB0002                     VALNOM        57
  9198           "." BY " ", " LTDA " BY "      ",                      RMB0002                     VALNOM        58
  9199           " LIMITADA " BY "          ",                          RMB0002                     VALNOM        59
  9200           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002                     VALNOM        60
  9201           " INVERSIONES " BY "             ",                    RMB0002                     VALNOM        61
  9202           " EMPRESA " BY "         ",                            RMB0002                     VALNOM        62
  9203           " CORPORACION " BY "             ",                    RMB0002                     VALNOM        63
  9204           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002                     VALNOM        64
  9205           " S " BY "   ", " A " BY "   "                         RMB0002                     VALNOM        65
  9206           " Y " BY "   "                                         GJC0003                     VALNOM        66
  9207         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        67
  9208                "." BY " ","-" BY " ",                            GJC0003                     VALNOM        68
  9209                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003                     VALNOM        69
  9210                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003                     VALNOM        70
  9211         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003                     VALNOM        71
  9212                "." BY " ","-" BY " ",                            GJC0003                     VALNOM        72
  9213                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003                     VALNOM        73
  9214                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003                     VALNOM        74
  9215         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM                                        VALNOM        75
  9216     ELSE                                                                                     VALNOM        76
  9217        INSPECT CADENA-VALNOM    REPLACING ALL                                                VALNOM        77
  9218                 "." BY " ","-" BY " ", "," BY " ",                                           VALNOM        78
  9219                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",                                  VALNOM        79
  9220                "Y" BY "G","H" BY "G","I" BY "G",                                             VALNOM        80
  9221                " DE " BY "    "," LA " BY "    ",                                            VALNOM        81
  9222                " DEL " BY "     "                                                            VALNOM        82
  9223        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002                     VALNOM        83
  9224                 "." BY " ","-" BY " ", "," BY " ",                                           VALNOM        84
  9225                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      RMB0002                     VALNOM        85
  9226                "Y" BY "G","H" BY "G","I" BY "G",                 RMB0002                     VALNOM        86
  9227                " DE " BY "    "," LA " BY "    ",                RMB0002                     VALNOM        87
  9228                " DEL " BY "     "                                RMB0002                     VALNOM        88
  9229                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM        89
  9230                        UNTIL I-VALNOM >= 66                                                  VALNOM        90
  9231                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM        91
  9232                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC                               VALNOM        92
  9233                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM        93
  9234                  END-IF                                                                      VALNOM        94
  9235                END-PERFORM                                                                   VALNOM        95
  9236     END-IF.                                                                                  VALNOM        96
  9237     MOVE SPACES TO VECTOR-INPUT-VALNOM.                                                      VALNOM        97
  9238     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM        98
  9239                  BASURA-VALNOM                                                               VALNOM        99
  9240      VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)                                VALNOM       100
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 161
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9241      VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)                                                   VALNOM       101
  9242      VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)                                VALNOM       102
  9243      VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)                                                  VALNOM       103
  9244      VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)                             VALNOM       104
  9245      VM-INPUT-VALNOM(14)                                                                     VALNOM       105
  9246      VM-INPUT-VALNOM(15)                                                                     VALNOM       106
  9247      VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)                             VALNOM       107
  9248      VM-INPUT-VALNOM(19)                                                                     VALNOM       108
  9249      VM-INPUT-VALNOM(20)                                                                     VALNOM       109
  9250******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********                            VALNOM       110
  9251     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.                                           VALNOM       111
  9252     IF TIP-ID-INPUT-VALNOM  NOT = 2                                                          VALNOM       112
  9253        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                                               VALNOM       113
  9254                 "." BY " ","-" BY " ","," BY " ",                                            VALNOM       114
  9255                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",                                  VALNOM       115
  9256                "Y" BY "G","H" BY "G","I" BY "G"                                              VALNOM       116
  9257                PERFORM VARYING I-VALNOM FROM 1 BY 1                                          VALNOM       117
  9258                        UNTIL I-VALNOM >= 66                                                  VALNOM       118
  9259                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC                                 VALNOM       119
  9260                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC                               VALNOM       120
  9261                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)                                    VALNOM       121
  9262                  END-IF                                                                      VALNOM       122
  9263                END-PERFORM                                                                   VALNOM       123
  9264     ELSE                                                                                     VALNOM       124
  9265         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       125
  9266           " S.A. " BY "      ",                                  RMB0002                     VALNOM       126
  9267           "." BY " ", " LTDA " BY "      ",                      RMB0002                     VALNOM       127
  9268           " LIMITADA " BY "          ",                          RMB0002                     VALNOM       128
  9269           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002                     VALNOM       129
  9270           " INVERSIONES " BY "             ",                    RMB0002                     VALNOM       130
  9271           " EMPRESA " BY "         ",                            RMB0002                     VALNOM       131
  9272           " CORPORACION " BY "             ",                    RMB0002                     VALNOM       132
  9273           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002                     VALNOM       133
  9274           " S " BY "   ", " A " BY "   "                         RMB0002                     VALNOM       134
  9275           " Y " BY "   "                                         GJC0003                     VALNOM       135
  9276         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002                     VALNOM       136
  9277           " S.A. " BY "      ",                                  RMB0002                     VALNOM       137
  9278           "." BY " ", " LTDA " BY "      ",                      RMB0002                     VALNOM       138
  9279           " LIMITADA " BY "          ",                          RMB0002                     VALNOM       139
  9280           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002                     VALNOM       140
  9281           " INVERSIONES " BY "             ",                    RMB0002                     VALNOM       141
  9282           " EMPRESA " BY "         ",                            RMB0002                     VALNOM       142
  9283           " CORPORACION " BY "             ",                    RMB0002                     VALNOM       143
  9284           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002                     VALNOM       144
  9285           " S " BY "   ", " A " BY "   "                         RMB0002                     VALNOM       145
  9286           " Y " BY "   "                                         GJC0003                     VALNOM       146
  9287        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003                     VALNOM       147
  9288                "." BY " ","-" BY " ",                            GJC0003                     VALNOM       148
  9289                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003                     VALNOM       149
  9290                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003                     VALNOM       150
  9291         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM                                        VALNOM       151
  9292     END-IF.                                                                                  VALNOM       152
  9293     MOVE SPACES TO VECTOR-OK-VALNOM.                                                         VALNOM       153
  9294     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO                                    VALNOM       154
  9295                  BASURA-VALNOM                                                               VALNOM       155
  9296      VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)                                         VALNOM       156
  9297      VM-OK-VALNOM(4) VM-OK-VALNOM(5)                                                         VALNOM       157
  9298      VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)                                         VALNOM       158
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 162
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9299      VM-OK-VALNOM(9) VM-OK-VALNOM(10)                                                        VALNOM       159
  9300      VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)                                      VALNOM       160
  9301      VM-OK-VALNOM(14) VM-OK-VALNOM(15)                                                       VALNOM       161
  9302      VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)                                      VALNOM       162
  9303      VM-OK-VALNOM(19) VM-OK-VALNOM(20).                                                      VALNOM       163
  9304***********HACE LA VALIDACION BLOQUE A BLOQUE********************                             VALNOM       164
  9305     MOVE 1 TO I-VALNOM.                                                                      VALNOM       165
  9306     MOVE 0 TO BLOQOK-AUX-VALNOM.                                                             VALNOM       166
  9307     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES                                         VALNOM       167
  9308       MOVE 1 TO J-VALNOM                                                                     VALNOM       168
  9309       PERFORM UNTIL J-VALNOM > 20                                                            VALNOM       169
  9310         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)                                VALNOM       170
  9311            ADD 1 TO BLOQOK-AUX-VALNOM                                                        VALNOM       171
  9312            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                             VALNOM       172
  9313                           VM-INPUT-VALNOM(I-VALNOM)                                          VALNOM       173
  9314            MOVE 21 TO J-VALNOM                                                               VALNOM       174
  9315         ELSE                                                                                 VALNOM       175
  9316            MOVE 0 TO M-VALNOM                                                                VALNOM       176
  9317            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                                  VALNOM       177
  9318                    FOR CHARACTERS BEFORE INITIAL "*"                                         VALNOM       178
  9319            IF M-VALNOM >= 15                                                                 VALNOM       179
  9320               MOVE 0 TO M-VALNOM                                                             VALNOM       180
  9321               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM                               VALNOM       181
  9322                    FOR CHARACTERS BEFORE INITIAL "N"                                         VALNOM       182
  9323            END-IF                                                                            VALNOM       183
  9324            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20                                        VALNOM       184
  9325               AND (14 - M-VALNOM > 0)                            GJC0005                     VALNOM       185
  9326               COMPUTE INI-VALNOM = M-VALNOM + 2                                              VALNOM       186
  9327               COMPUTE LON-VALNOM = 14 - M-VALNOM                                             VALNOM       187
  9328               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM                                   VALNOM       188
  9329               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =                                      VALNOM       189
  9330                  VM-INPUT-VALNOM(I-VALNOM + 1 ) AND                                          VALNOM       190
  9331                  PEDAZO-VALNOM(1:M-VALNOM) =                                                 VALNOM       191
  9332                  VM-INPUT-VALNOM(I-VALNOM)                                                   VALNOM       192
  9333                  ADD 1 TO BLOQOK-AUX-VALNOM                                                  VALNOM       193
  9334                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                       VALNOM       194
  9335                           VM-INPUT-VALNOM(I-VALNOM)                                          VALNOM       195
  9336                  MOVE 21 TO J-VALNOM                                                         VALNOM       196
  9337                  ADD 1 TO I-VALNOM                                                           VALNOM       197
  9338                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)                                    VALNOM       198
  9339               END-IF                                                                         VALNOM       199
  9340            END-IF                                                                            VALNOM       200
  9341         END-IF                                                                               VALNOM       201
  9342         ADD 1 TO J-VALNOM                                                                    VALNOM       202
  9343       END-PERFORM                                                                            VALNOM       203
  9344       ADD 1 TO I-VALNOM                                                                      VALNOM       204
  9345       IF I-VALNOM = 21                                                                       VALNOM       205
  9346          NEXT SENTENCE                                                                       VALNOM       206
  9347       END-IF                                                                                 VALNOM       207
  9348     END-PERFORM.                                                                             VALNOM       208
  9349     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                             VALNOM       209
  9350        MOVE 1 TO MATCH-OK-OUT-VALNOM                                                         VALNOM       210
  9351     ELSE                                                                                     VALNOM       211
  9352        IF TIP-ID-INPUT-VALNOM <> 2                                                           VALNOM       212
  9353           PERFORM 10100-MATCH-APROXIMADO                                                     VALNOM       213
  9354        ELSE                                                                                  VALNOM       214
  9355           PERFORM 10100-MATCH-APROX-EMPRESAS                                                 VALNOM       215
  9356        END-IF                                                                                VALNOM       216
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 163
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9357        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM                                          VALNOM       217
  9358           MOVE 1 TO MATCH-OK-OUT-VALNOM                                                      VALNOM       218
  9359        END-IF                                                                                VALNOM       219
  9360     END-IF.                                                                                  VALNOM       220
  9361**********************************************************************                        VALNOM       221
  9362*10100-MATCH-APROXIMADO.                                                                      VALNOM       222
  9363*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS                          VALNOM       223
  9364*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON                            VALNOM       224
  9365*     LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.                                                   VALNOM       225
  9366**********************************************************************                        VALNOM       226
  9367 10100-MATCH-APROXIMADO.                                                                      VALNOM       227
  9368     IF BLOQOK-AUX-VALNOM > 0                                                                 VALNOM       228
  9369        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       229
  9370     ELSE                                                                                     VALNOM       230
  9371        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM                                          VALNOM       231
  9372     END-IF                                                                                   VALNOM       232
  9373     MOVE 1 TO I-VALNOM.                                                                      VALNOM       233
  9374     PERFORM UNTIL I-VALNOM > 10                                                              VALNOM       234
  9375       MOVE 1 TO J-VALNOM                                                                     VALNOM       235
  9376       PERFORM UNTIL J-VALNOM > 10                                                            VALNOM       236
  9377         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM                                         VALNOM       237
  9378         MOVE 1 TO K-VALNOM                                                                   VALNOM       238
  9379         MOVE 1 TO L-VALNOM                                                                   VALNOM       239
  9380         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND                                        VALNOM       240
  9381            VM-OK-VALNOM   (J-VALNOM) NOT = SPACES                                            VALNOM       241
  9382            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       242
  9383              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       243
  9384                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)                                           VALNOM       244
  9385                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003                     VALNOM       245
  9386                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003                     VALNOM       246
  9387                      OR = "N"))                                  GJC0003                     VALNOM       247
  9388                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES                             VALNOM       248
  9389                    ADD 1 TO LETRAS-OK-VALNOM                                                 VALNOM       249
  9390                    ADD 1 TO K-VALNOM                                                         VALNOM       250
  9391                    ADD 1 TO L-VALNOM                                                         VALNOM       251
  9392                 ELSE                                                                         VALNOM       252
  9393                    MOVE 19 TO K-VALNOM                                                       VALNOM       253
  9394                 END-IF                                                                       VALNOM       254
  9395              ELSE                                                                            VALNOM       255
  9396                 ADD 1   TO K-VALNOM                                                          VALNOM       256
  9397                 IF K-VALNOM <= 15 AND L-VALNOM < 15                                          VALNOM       257
  9398                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =                              VALNOM       258
  9399                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM )                                      VALNOM       259
  9400                       ADD 1 TO L-VALNOM                                                      VALNOM       260
  9401                    END-IF                                                                    VALNOM       261
  9402                 END-IF                                                                       VALNOM       262
  9403              END-IF                                                                          VALNOM       263
  9404            END-PERFORM                                                                       VALNOM       264
  9405            MOVE 1 TO K-VALNOM                                                                VALNOM       265
  9406            MOVE 1 TO L-VALNOM                                                                VALNOM       266
  9407            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15                                      VALNOM       267
  9408              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                        VALNOM       268
  9409                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)                                           VALNOM       269
  9410                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003                     VALNOM       270
  9411                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003                     VALNOM       271
  9412                      OR = "N"))                                  GJC0003                     VALNOM       272
  9413                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES                            VALNOM       273
  9414                    ADD 1 TO LETRAS-OK2-VALNOM                                                VALNOM       274
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 164
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9415                    ADD 1 TO K-VALNOM                                                         VALNOM       275
  9416                    ADD 1 TO L-VALNOM                                                         VALNOM       276
  9417                 ELSE                                                                         VALNOM       277
  9418                    MOVE 19 TO K-VALNOM                                                       VALNOM       278
  9419                 END-IF                                                                       VALNOM       279
  9420              ELSE                                                                            VALNOM       280
  9421                 ADD 1   TO L-VALNOM                                                          VALNOM       281
  9422                 IF L-VALNOM <= 15 AND K-VALNOM < 15                                          VALNOM       282
  9423                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =                                  VALNOM       283
  9424                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM + 1)                                   VALNOM       284
  9425                       ADD 1 TO K-VALNOM                                                      VALNOM       285
  9426                    END-IF                                                                    VALNOM       286
  9427                 END-IF                                                                       VALNOM       287
  9428              END-IF                                                                          VALNOM       288
  9429            END-PERFORM                                                                       VALNOM       289
  9430         END-IF                                                                               VALNOM       290
  9431         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM                                              VALNOM       291
  9432            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM                                        VALNOM       292
  9433         END-IF                                                                               VALNOM       293
  9434         IF LETRAS-OK-VALNOM > 0                                                              VALNOM       294
  9435            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM                                      VALNOM       295
  9436            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING                                        VALNOM       296
  9437                    TOTLET-INP-VALNOM                                                         VALNOM       297
  9438                    FOR CHARACTERS BEFORE INITIAL " "                                         VALNOM       298
  9439            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING                                        VALNOM       299
  9440                    TOTLET-OK-VALNOM                                                          VALNOM       300
  9441                    FOR CHARACTERS BEFORE INITIAL " "                                         VALNOM       301
  9442            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM                                          VALNOM       302
  9443            IF TOTLET-OK-VALNOM >= 3                                                          VALNOM       303
  9444               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       304
  9445                                       TOTLET-OK-VALNOM                                       VALNOM       305
  9446            END-IF                                                                            VALNOM       306
  9447            IF TOTLET-INP-VALNOM >= 3                                                         VALNOM       307
  9448               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /                              VALNOM       308
  9449                                       TOTLET-INP-VALNOM                                      VALNOM       309
  9450            END-IF                                                                            VALNOM       310
  9451            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM                                           VALNOM       311
  9452               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /                                   VALNOM       312
  9453                                 TOTLET-OK-VALNOM                                             VALNOM       313
  9454            ELSE                                                                              VALNOM       314
  9455               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /                                   VALNOM       315
  9456                                 TOTLET-INP-VALNOM                                            VALNOM       316
  9457            END-IF                                                                            VALNOM       317
  9458            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=                                        VALNOM       318
  9459                                  APROX-TOT-VALNOM) AND                                       VALNOM       319
  9460                 A-VALNOM >= 63                                                               VALNOM       320
  9461****   display "%TOT=",POR-TOT-VALNOM, " %INP=", POR-INP-VALNOM,                              VALNOM       321
  9462****           "A-VALNOM=", A-VALNOM                                                          VALNOM       322
  9463*****       IF (POR-TOT-VALNOM >= APROX-TOT-VALNOM AND                                        VALNOM       323
  9464*****           POR-INP-VALNOM >= APROX-INP-VALNOM ) OR                                       VALNOM       324
  9465*****          ((POR-TOT-VALNOM >= APROX-TOT-VALNOM OR                                        VALNOM       325
  9466*****            POR-INP-VALNOM >= APROX-INP-VALNOM ) AND                                     VALNOM       326
  9467*****            A-VALNOM >= 70)                                                              VALNOM       327
  9468               ADD 1 TO BLOQOK-AUX-VALNOM                                                     VALNOM       328
  9469               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)                                          VALNOM       329
  9470                           VM-INPUT-VALNOM(I-VALNOM)                                          VALNOM       330
  9471            END-IF                                                                            VALNOM       331
  9472         END-IF                                                                               VALNOM       332
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 165
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9473         ADD 1 TO J-VALNOM                                                                    VALNOM       333
  9474       END-PERFORM                                                                            VALNOM       334
  9475       ADD 1 TO I-VALNOM                                                                      VALNOM       335
  9476     END-PERFORM.                                                                             VALNOM       336
  9477**********************************************************************                        VALNOM       337
  9478*10100-MATCH-APROX-EMPRESAS                                                                   VALNOM       338
  9479*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS                          VALNOM       339
  9480*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON                            VALNOM       340
  9481*     LOS TIPOS DE IDENTIFICACION 2.                                                          VALNOM       341
  9482**********************************************************************                        VALNOM       342
  9483 10100-MATCH-APROX-EMPRESAS.                                                                  VALNOM       343
  9484   MOVE ZEROS TO TOTLET-INP-VALNOM                                                            VALNOM       344
  9485   MOVE ZEROS TO LETRAS-OK2-VALNOM                                                            VALNOM       345
  9486    MOVE ZEROS TO A-VALNOM                                        GJC0003                     VALNOM       346
  9487   MOVE 1 TO K-VALNOM                                                                         VALNOM       347
  9488   PERFORM UNTIL K-VALNOM > 65                                                                VALNOM       348
  9489     MOVE K-VALNOM  TO I-VALNOM                                                               VALNOM       349
  9490     MOVE 1       TO J-VALNOM                                                                 VALNOM       350
  9491     MOVE ZEROS TO LETRAS-OK-VALNOM                                                           VALNOM       351
  9492     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65                                             VALNOM       352
  9493        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                            VALNOM       353
  9494           V-NOMBRE-VALNOM(I-VALNOM) <> "."                                                   VALNOM       354
  9495           IF V-NOMBRE-VALNOM(I-VALNOM) =                                                     VALNOM       355
  9496              V-NOMBOK-VALNOM(J-VALNOM)                                                       VALNOM       356
  9497              ADD 1 TO LETRAS-OK-VALNOM                                                       VALNOM       357
  9498              ADD 1 TO I-VALNOM                                                               VALNOM       358
  9499              ADD 1 TO J-VALNOM                                                               VALNOM       359
  9500           ELSE                                                                               VALNOM       360
  9501              ADD 1 TO J-VALNOM                                                               VALNOM       361
  9502           END-IF                                                                             VALNOM       362
  9503        ELSE                                                                                  VALNOM       363
  9504           ADD 1 TO I-VALNOM                                                                  VALNOM       364
  9505        END-IF                                                                                VALNOM       365
  9506     END-PERFORM                                                                              VALNOM       366
  9507     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM                                                  VALNOM       367
  9508        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM                                            VALNOM       368
  9509     END-IF                                                                                   VALNOM       369
  9510     ADD 1 TO K-VALNOM                                                                        VALNOM       370
  9511   END-PERFORM.                                                                               VALNOM       371
  9512   MOVE 1 TO I-VALNOM                                                                         VALNOM       372
  9513   PERFORM UNTIL I-VALNOM > 65                                                                VALNOM       373
  9514     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND                                               VALNOM       374
  9515        V-NOMBRE-VALNOM(I-VALNOM) <> "."                                                      VALNOM       375
  9516        ADD 1 TO TOTLET-INP-VALNOM                                                            VALNOM       376
  9517     END-IF                                                                                   VALNOM       377
  9518     ADD 1 TO I-VALNOM                                                                        VALNOM       378
  9519   END-PERFORM.                                                                               VALNOM       379
  9520   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /                                               VALNOM       380
  9521                     TOTLET-INP-VALNOM.                                                       VALNOM       381
  9522   IF A-VALNOM >= 75                                                                          VALNOM       382
  9523       ADD 1 TO BLOQOK-AUX-VALNOM                                                             VALNOM       383
  9524   END-IF.                                                                                    VALNOM       384
  9525    MOVE 0 TO K-VALNOM                                            GJC0003                     VALNOM       385
  9526   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003                     VALNOM       386
  9527      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003                     VALNOM       387
  9528      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003                     VALNOM       388
  9529               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       389
  9530                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003                     VALNOM       390
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 166
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/VALNOM.PRO
  9531                   TO I-VALNOM                                    GJC0003                     VALNOM       391
  9532                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003                     VALNOM       392
  9533              END-IF                                              GJC0003                     VALNOM       393
  9534               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003                     VALNOM       394
  9535                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003                     VALNOM       395
  9536                    TO I-VALNOM                                   GJC0003                     VALNOM       396
  9537                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003                     VALNOM       397
  9538              END-IF                                              GJC0003                     VALNOM       398
  9539      END-PERFORM                                                 GJC0003                     VALNOM       399
  9540      MOVE 0 TO I-VALNOM                                          GJC0003                     VALNOM       400
  9541       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003                     VALNOM       401
  9542         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003                     VALNOM       402
  9543            ADD 1 TO I-VALNOM                                     GJC0003                     VALNOM       403
  9544            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003                     VALNOM       404
  9545               CONT-LET-INPUT-VALNOM(J-VALNOM)                    GJC0003                     VALNOM       405
  9546               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003                     VALNOM       406
  9547            ELSE                                                  GJC0003                     VALNOM       407
  9548               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003                     VALNOM       408
  9549                                  (CONT-LET-INPUT-VALNOM(J-VALNOM)GJC0003                     VALNOM       409
  9550                           *  100 /CONT-LET-OK-VALNOM(J-VALNOM))  GJC0003                     VALNOM       410
  9551            END-IF                                                GJC0003                     VALNOM       411
  9552         END-IF                                                   GJC0003                     VALNOM       412
  9553      END-PERFORM                                                 GJC0003                     VALNOM       413
  9554      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003                     VALNOM       414
  9555       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003                     VALNOM       415
  9556         ((A-VALNOM >= 35 AND A-VALNOM < 40) AND K-VALNOM > 85) ORGJC0003                     VALNOM       416
  9557         ((A-VALNOM >= 25 AND A-VALNOM < 35) AND K-VALNOM = 100)  GJC0003                     VALNOM       417
  9558         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003                     VALNOM       418
  9559       END-IF                                                     GJC0003                     VALNOM       419
  9560   END-IF.                                                        GJC0003                     VALNOM       420
  9561                                                                                              LEEMAEST      41
  9562 0500-ASIGNA-ID-ICMCRE-START.                                                                 LEEMAEST      42
  9563******************************************************************                            LEEMAEST      43
  9564*0500-ASIGNA-ID-ICMCRE-START.                                                                 LEEMAEST      44
  9565******************************************************************                            LEEMAEST      45
  9566        MOVE TIPO-ID-ABD07 TO TIPO-ID-LEEMSTRS                                                LEEMAEST      46
  9567        MOVE NUM-ID-ABD07  TO NRO-ID-LEEMSTRS.                                                LEEMAEST      47
  9568                                                                                              LEEMAEST      48
  9569 0600-ASIGNA-ID-ICMCHK-START.                                                                 LEEMAEST      49
  9570******************************************************************                            LEEMAEST      50
  9571*0600-ASIGNA-ID-ICMCHK-START.                                                                 LEEMAEST      51
  9572******************************************************************                            LEEMAEST      52
  9573        MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRS                                                LEEMAEST      53
  9574        MOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.                                                LEEMAEST      54
  9575                                                                                              LEEMAEST      55
  9576 1000-LEE-ICMCRE-SECUENCIAL.                                                                  LEEMAEST      56
  9577******************************************************************                            LEEMAEST      57
  9578*1000-LEE-ICMCRE-SECUENCIAL.                                                                  LEEMAEST      58
  9579*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE                               LEEMAEST      59
  9580*    ARCHIVO:                                                                                 LEEMAEST      60
  9581*    SW-LECTURA-MAESTROS  0: LECTURA OK                                                       LEEMAEST      61
  9582*                         1: LECTURA CON ERROR O FIN ARCHIVO                                  LEEMAEST      62
  9583* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA                                LEEMAEST      63
  9584* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END                              LEEMAEST      64
  9585******************************************************************                            LEEMAEST      65
  9586     MOVE 0 TO SW-LECTURA-MAESTROS                                                            LEEMAEST      66
  9587     READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT END                                       LEEMAEST      67
  9588          MOVE 1 TO SW-LECTURA-MAESTROS                                                       LEEMAEST      68
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 167
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  9589     END-READ                                                                                 LEEMAEST      69
  9590     IF SW-LECTURA-MAESTROS = 0                                                               LEEMAEST      70
  9591      IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS AND                                                LEEMAEST      71
  9592          NUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR                                                 LEEMAEST      72
  9593          (TIPO-ID-LEEMSTRS = ZEROS AND                                                       LEEMAEST      73
  9594           NRO-ID-LEEMSTRS  = ZEROS)                                                          LEEMAEST      74
  9595$       IF HACERMATCH = "SI"                                                                  LEEMAEST      75
  9596X         IF HACERMATCH-LEEMSTRS = 1                                                          LEEMAEST      76
  9597X          IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR                                        LEEMAEST      77
  9598X             NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS                                           LEEMAEST      78
  9599X             MOVE 0 TO IDE-TIPO-BDAMATCH                                                     LEEMAEST      79
  9600X             MOVE 0 TO TIP-IDE-ANT-LEEMSTRS                                                  LEEMAEST      80
  9601X             MOVE 0 TO NUM-IDE-ANT-LEEMSTRS                                                  LEEMAEST      81
  9602X             IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004                     LEEMAEST      82
  9603X                                CONSECUTIVO-ABD07 = 01           GJC0004                     LEEMAEST      83
  9604X                PERFORM 7000-GUARDAR-REG-INICIALES                                           LEEMAEST      84
  9605X                MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH                                 LEEMAEST      85
  9606X                MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH                                 LEEMAEST      86
  9607X                PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                         LEEMAEST      87
  9608X                PERFORM 8000-RECUPERAR-REG-INICIALES                                         LEEMAEST      88
  9609X                MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS                                   LEEMAEST      89
  9610X                MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS                                   LEEMAEST      90
  9611X             END-IF                                                                          LEEMAEST      91
  9612X          END-IF                                                                             LEEMAEST      92
  9613X         END-IF                                                                              LEEMAEST      93
  9614$       END                                                                                   LEEMAEST      94
  9615        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003                     LEEMAEST      95
  9616           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003                     LEEMAEST      96
  9617                              050050 OR 130050                    GJC0003                     LEEMAEST      97
  9618              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003                     LEEMAEST      98
  9619           END-IF                                                 GJC0003                     LEEMAEST      99
  9620        END-IF                                                    GJC0003                     LEEMAEST     100
  9621$       IF AMNISTIA21 = "SI"                                                                  LEEMAEST     101
  9622X          IF AMNISTIA21-LEEMSTRS = 1                                                         LEEMAEST     102
  9623X             PERFORM 200700-AMNISTIA-CLIENTES                                                LEEMAEST     103
  9624* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES                            LEEMAEST     104
  9625* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA                       LEEMAEST     105
  9626X             IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003                     LEEMAEST     106
  9627X                IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003                     LEEMAEST     107
  9628X                                   050050 OR 130050              GJC0003                     LEEMAEST     108
  9629X                   MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003                     LEEMAEST     109
  9630X                END-IF                                           GJC0003                     LEEMAEST     110
  9631X             END-IF                                              GJC0003                     LEEMAEST     111
  9632X          END-IF                                                                             LEEMAEST     112
  9633X          IF SW-ART13-AMNIST21 = 1                               GJC0002                     LEEMAEST     113
  9634X             IF IDE-TIPO-BDAMATCH = 1                            GJC0002                     LEEMAEST     114
  9635X                IF HACERMATCH-LEEMSTRS = 1                       GJC0002                     LEEMAEST     115
  9636X                   PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002                     LEEMAEST     116
  9637X                END-IF                                           GJC0002                     LEEMAEST     117
  9638X             END-IF                                              GJC0002                     LEEMAEST     118
  9639X             PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002                     LEEMAEST     119
  9640X          END-IF                                                 GJC0002                     LEEMAEST     120
  9641$       END                                                                                   LEEMAEST     121
  9642        IF SW-AMNIST21 = 1                                                                    LEEMAEST     122
  9643           IF IDE-TIPO-BDAMATCH = 1                               GJC0002                     LEEMAEST     123
  9644              IF HACERMATCH-LEEMSTRS = 1                          GJC0002                     LEEMAEST     124
  9645                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002                     LEEMAEST     125
  9646              END-IF                                              GJC0002                     LEEMAEST     126
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 168
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  9647           END-IF                                                 GJC0002                     LEEMAEST     127
  9648           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002                     LEEMAEST     128
  9649              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002                     LEEMAEST     129
  9650*             ELSE                                                GJC0002                     LEEMAEST     130
  9651*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002                     LEEMAEST     131
  9652*             END-IF                                              GJC0002                     LEEMAEST     132
  9653           END-IF                                                                             LEEMAEST     133
  9654        ELSE                                                                                  LEEMAEST     134
  9655           IF IDE-TIPO-BDAMATCH = 1                                                           LEEMAEST     135
  9656              IF HACERMATCH-LEEMSTRS = 1                                                      LEEMAEST     136
  9657                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH                                         LEEMAEST     137
  9658              END-IF                                                                          LEEMAEST     138
  9659           END-IF                                                                             LEEMAEST     139
  9660        END-IF                                                                                LEEMAEST     140
  9661                                                                                              LEEMAEST     141
  9662      END-IF                                                                                  LEEMAEST     142
  9663      IF SW-NOV-48-LEEMSTRS = 0  *>                               GJC0002                     LEEMAEST     143
  9664         MOVE ZEROS TO VECTOR-HIS-3-ABD07                         GJC0002                     LEEMAEST     144
  9665                       VECTOR-HIS-4-ABD07                         GJC0002                     LEEMAEST     145
  9666           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002                     LEEMAEST     146
  9667           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002                     LEEMAEST     147
  9668           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002                     LEEMAEST     148
  9669           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002                     LEEMAEST     149
  9670     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002                     LEEMAEST     150
  9671          MOR-EST-CTA-AMNIST21                                    GJC0002                     LEEMAEST     151
  9672        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0002                     LEEMAEST     152
  9673      END-IF                                                      GJC0002                     LEEMAEST     153
  9674     END-IF.                                                                                  LEEMAEST     154
  9675     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003                     LEEMAEST     155
  9676                                                                                              LEEMAEST     156
  9677 2000-LEE-ICMCRE-DINAMICO.                                                                    LEEMAEST     157
  9678******************************************************************                            LEEMAEST     158
  9679*2000-LEE-ICMCRE-DINAMICO.                                                                    LEEMAEST     159
  9680*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY                            LEEMAEST     160
  9681*    DEL ARCHIVO:                                                                             LEEMAEST     161
  9682*    SW-LECTURA-MAESTROS  0: LECTURA OK                                                       LEEMAEST     162
  9683*                         1: LECTURA CON ERROR                                                LEEMAEST     163
  9684******************************************************************                            LEEMAEST     164
  9685     MOVE 0 TO SW-LECTURA-MAESTROS                                                            LEEMAEST     165
  9686     READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY                                              LEEMAEST     166
  9687          MOVE 1 TO SW-LECTURA-MAESTROS                                                       LEEMAEST     167
  9688     END-READ                                                                                 LEEMAEST     168
  9689     IF SW-LECTURA-MAESTROS = 0                                                               LEEMAEST     169
  9690$       IF HACERMATCH = "SI"                                                                  LEEMAEST     170
  9691X         IF HACERMATCH-LEEMSTRS = 1                                                          LEEMAEST     171
  9692X          IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR                                        LEEMAEST     172
  9693X             NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS                                           LEEMAEST     173
  9694X             MOVE 0 TO IDE-TIPO-BDAMATCH                                                     LEEMAEST     174
  9695X             MOVE 0 TO TIP-IDE-ANT-LEEMSTRS                                                  LEEMAEST     175
  9696X             MOVE 0 TO NUM-IDE-ANT-LEEMSTRS                                                  LEEMAEST     176
  9697X             IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004                     LEEMAEST     177
  9698X                                CONSECUTIVO-ABD07 = 01           GJC0004                     LEEMAEST     178
  9699X                PERFORM 7000-GUARDAR-REG-INICIALES                                           LEEMAEST     179
  9700X                MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH                                 LEEMAEST     180
  9701X                MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH                                 LEEMAEST     181
  9702X                PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                         LEEMAEST     182
  9703X                PERFORM 8000-RECUPERAR-REG-INICIALES                                         LEEMAEST     183
  9704X                MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS                                   LEEMAEST     184
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 169
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  9705X                MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS                                   LEEMAEST     185
  9706X             END-IF                                                                          LEEMAEST     186
  9707X          END-IF                                                                             LEEMAEST     187
  9708X        END-IF                                                                               LEEMAEST     188
  9709$       END                                                                                   LEEMAEST     189
  9710        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003                     LEEMAEST     190
  9711           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003                     LEEMAEST     191
  9712                              050050 OR 130050                    GJC0003                     LEEMAEST     192
  9713              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003                     LEEMAEST     193
  9714           END-IF                                                 GJC0003                     LEEMAEST     194
  9715        END-IF                                                    GJC0003                     LEEMAEST     195
  9716$       IF AMNISTIA21 = "SI"                                                                  LEEMAEST     196
  9717X          IF AMNISTIA21-LEEMSTRS = 1                                                         LEEMAEST     197
  9718X             PERFORM 200700-AMNISTIA-CLIENTES                                                LEEMAEST     198
  9719* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES                            LEEMAEST     199
  9720* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA                       LEEMAEST     200
  9721X             IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003                     LEEMAEST     201
  9722X                IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003                     LEEMAEST     202
  9723X                                   050050 OR 130050              GJC0003                     LEEMAEST     203
  9724X                   MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003                     LEEMAEST     204
  9725X                END-IF                                           GJC0003                     LEEMAEST     205
  9726X             END-IF                                              GJC0003                     LEEMAEST     206
  9727X          END-IF                                                                             LEEMAEST     207
  9728X          IF SW-ART13-AMNIST21 = 1                               GJC0002                     LEEMAEST     208
  9729X             IF IDE-TIPO-BDAMATCH = 1                            GJC0002                     LEEMAEST     209
  9730X                IF HACERMATCH-LEEMSTRS = 1                       GJC0002                     LEEMAEST     210
  9731X                   PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002                     LEEMAEST     211
  9732X                END-IF                                           GJC0002                     LEEMAEST     212
  9733X             END-IF                                              GJC0002                     LEEMAEST     213
  9734X             PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002                     LEEMAEST     214
  9735X          END-IF                                                 GJC0002                     LEEMAEST     215
  9736$       END                                                                                   LEEMAEST     216
  9737        IF SW-AMNIST21 = 1                                                                    LEEMAEST     217
  9738           IF IDE-TIPO-BDAMATCH = 1                               GJC0002                     LEEMAEST     218
  9739              IF HACERMATCH-LEEMSTRS = 1                          GJC0002                     LEEMAEST     219
  9740                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002                     LEEMAEST     220
  9741              END-IF                                              GJC0002                     LEEMAEST     221
  9742           END-IF                                                 GJC0002                     LEEMAEST     222
  9743           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002                     LEEMAEST     223
  9744              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002                     LEEMAEST     224
  9745*             ELSE                                                GJC0002                     LEEMAEST     225
  9746*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002                     LEEMAEST     226
  9747*             END-IF                                              GJC0002                     LEEMAEST     227
  9748           END-IF                                                                             LEEMAEST     228
  9749        ELSE                                                                                  LEEMAEST     229
  9750           IF IDE-TIPO-BDAMATCH = 1                                                           LEEMAEST     230
  9751              IF HACERMATCH-LEEMSTRS = 1                                                      LEEMAEST     231
  9752                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH                                         LEEMAEST     232
  9753              END-IF                                                                          LEEMAEST     233
  9754           END-IF                                                                             LEEMAEST     234
  9755        END-IF                                                                                LEEMAEST     235
  9756        IF SW-NOV-48-LEEMSTRS = 0                                 GJC0002                     LEEMAEST     236
  9757           MOVE ZEROS TO VECTOR-HIS-3-ABD07                       GJC0002                     LEEMAEST     237
  9758                       VECTOR-HIS-4-ABD07                         GJC0002                     LEEMAEST     238
  9759           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002                     LEEMAEST     239
  9760           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002                     LEEMAEST     240
  9761           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002                     LEEMAEST     241
  9762           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002                     LEEMAEST     242
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 170
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  9763     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002                     LEEMAEST     243
  9764          MOR-EST-CTA-AMNIST21                                    GJC0002                     LEEMAEST     244
  9765          PERFORM 500000-RECONSTRUCCION-HISTORIA                  GJC0002                     LEEMAEST     245
  9766        END-IF                                                    GJC0002                     LEEMAEST     246
  9767     END-IF.                                                                                  LEEMAEST     247
  9768     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003                     LEEMAEST     248
  9769                                                                                              LEEMAEST     249
  9770 3000-LEE-ICMCHK-SECUENCIAL.                                                                  LEEMAEST     250
  9771******************************************************************                            LEEMAEST     251
  9772*3000-LEE-ICMCHK-SECUENCIAL.                                                                  LEEMAEST     252
  9773*    LEEE MAESTRO ICMCHK EN FORMA SECUENCIAL Y VALIDA EL FIN DE                               LEEMAEST     253
  9774*    ARCHIVO:                                                                                 LEEMAEST     254
  9775*    SW-LECTURA-MAESTROS  0: LECTURA OK                                                       LEEMAEST     255
  9776*                         1: LECTURA CON ERROR O FIN ARCHIVO                                  LEEMAEST     256
  9777******************************************************************                            LEEMAEST     257
  9778     MOVE 0 TO SW-LECTURA-MAESTROS                                                            LEEMAEST     258
  9779     READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK AT END                                        LEEMAEST     259
  9780          MOVE 1 TO SW-LECTURA-MAESTROS                                                       LEEMAEST     260
  9781     END-READ                                                                                 LEEMAEST     261
  9782     IF SW-LECTURA-MAESTROS = 0                                                               LEEMAEST     262
  9783      IF (TIPO-ID-ABD06 = TIPO-ID-LEEMSTRS AND                                                LEEMAEST     263
  9784          NUM-ID-ABD06  = NRO-ID-LEEMSTRS) OR                                                 LEEMAEST     264
  9785          (TIPO-ID-LEEMSTRS = ZEROS AND                                                       LEEMAEST     265
  9786           NRO-ID-LEEMSTRS  = ZEROS)                                                          LEEMAEST     266
  9787$       IF HACERMATCH = "SI"                                                                  LEEMAEST     267
  9788X         IF HACERMATCH-LEEMSTRS = 1                                                          LEEMAEST     268
  9789X          IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR                                        LEEMAEST     269
  9790X             NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS                                           LEEMAEST     270
  9791X             MOVE 0 TO IDE-TIPO-BDAMATCH                                                     LEEMAEST     271
  9792X             MOVE 0 TO TIP-IDE-ANT-LEEMSTRS                                                  LEEMAEST     272
  9793X             MOVE 0 TO NUM-IDE-ANT-LEEMSTRS                                                  LEEMAEST     273
  9794X             IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004                     LEEMAEST     274
  9795X                                CONSECUTIVO-ABD06 = 01           GJC0004                     LEEMAEST     275
  9796X                PERFORM 7000-GUARDAR-REG-INICIALES                                           LEEMAEST     276
  9797X                MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH                                 LEEMAEST     277
  9798X                MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH                                 LEEMAEST     278
  9799X                PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                         LEEMAEST     279
  9800X                PERFORM 8000-RECUPERAR-REG-INICIALES                                         LEEMAEST     280
  9801X                MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS                                   LEEMAEST     281
  9802X                MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS                                   LEEMAEST     282
  9803X             END-IF                                                                          LEEMAEST     283
  9804X          END-IF                                                                             LEEMAEST     284
  9805X          IF IDE-TIPO-BDAMATCH = 1                                                           LEEMAEST     285
  9806X             IF HACERMATCH-LEEMSTRS = 1                                                      LEEMAEST     286
  9807X                PERFORM 8000-U-VER-CTAABD06-BDAMATCH                                         LEEMAEST     287
  9808X             END-IF                                                                          LEEMAEST     288
  9809X          END-IF                                                                             LEEMAEST     289
  9810X         END-IF                                                                              LEEMAEST     290
  9811$       END                                                                                   LEEMAEST     291
  9812        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003                     LEEMAEST     292
  9813           IF COD-SUS-ABD06 = 010050                              GJC0003                     LEEMAEST     293
  9814              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003                     LEEMAEST     294
  9815           END-IF                                                 GJC0003                     LEEMAEST     295
  9816        END-IF                                                    GJC0003                     LEEMAEST     296
  9817        ADD 0 TO SW-LECTURA-MAESTROS                                                          LEEMAEST     297
  9818      END-IF                                                                                  LEEMAEST     298
  9819     END-IF.                                                                                  LEEMAEST     299
  9820     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003                     LEEMAEST     300
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 171
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  9821                                                                                              LEEMAEST     301
  9822 4000-LEE-ICMCHK-DINAMICO.                                                                    LEEMAEST     302
  9823******************************************************************                            LEEMAEST     303
  9824*4000-LEE-ICMCHK-DINAMICO.                                                                    LEEMAEST     304
  9825*    LEEE MAESTRO ICMCHK EN FORMA DIMANICA Y VALIDA EL INVALID KEY                            LEEMAEST     305
  9826*    DEL ARCHIVO:                                                                             LEEMAEST     306
  9827*    SW-LECTURA-MAESTROS  0: LECTURA OK                                                       LEEMAEST     307
  9828*                         1: LECTURA CON ERROR                                                LEEMAEST     308
  9829******************************************************************                            LEEMAEST     309
  9830     MOVE 0 TO SW-LECTURA-MAESTROS                                                            LEEMAEST     310
  9831     READ MAESTRO-CHECK IGNORE LOCK INVALID KEY                                               LEEMAEST     311
  9832          MOVE 1 TO SW-LECTURA-MAESTROS                                                       LEEMAEST     312
  9833     END-READ                                                                                 LEEMAEST     313
  9834     IF SW-LECTURA-MAESTROS = 0                                                               LEEMAEST     314
  9835$       IF HACERMATCH = "SI"                                                                  LEEMAEST     315
  9836X         IF HACERMATCH-LEEMSTRS = 1                                                          LEEMAEST     316
  9837X          IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR                                        LEEMAEST     317
  9838X             NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS                                           LEEMAEST     318
  9839X             MOVE 0 TO TIP-IDE-ANT-LEEMSTRS                                                  LEEMAEST     319
  9840X             MOVE 0 TO NUM-IDE-ANT-LEEMSTRS                                                  LEEMAEST     320
  9841X             MOVE 0 TO IDE-TIPO-BDAMATCH                                                     LEEMAEST     321
  9842X             IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004                     LEEMAEST     322
  9843X                                CONSECUTIVO-ABD06 = 01           GJC0004                     LEEMAEST     323
  9844X                PERFORM 7000-GUARDAR-REG-INICIALES                                           LEEMAEST     324
  9845X                MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH                                 LEEMAEST     325
  9846X                MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH                                 LEEMAEST     326
  9847X                PERFORM 1000-U-RECORRER-CSV-BDAMATCH                                         LEEMAEST     327
  9848X                PERFORM 8000-RECUPERAR-REG-INICIALES                                         LEEMAEST     328
  9849X                MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS                                   LEEMAEST     329
  9850X                MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS                                   LEEMAEST     330
  9851X             END-IF                                                                          LEEMAEST     331
  9852X          END-IF                                                                             LEEMAEST     332
  9853X          IF IDE-TIPO-BDAMATCH = 1                                                           LEEMAEST     333
  9854X             IF HACERMATCH-LEEMSTRS = 1                                                      LEEMAEST     334
  9855X                PERFORM 8000-U-VER-CTAABD06-BDAMATCH                                         LEEMAEST     335
  9856X             END-IF                                                                          LEEMAEST     336
  9857X          END-IF                                                                             LEEMAEST     337
  9858X         END-IF                                                                              LEEMAEST     338
  9859$       END                                                                                   LEEMAEST     339
  9860        ADD 0 TO SW-LECTURA-MAESTROS                                                          LEEMAEST     340
  9861        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003                     LEEMAEST     341
  9862           IF COD-SUS-ABD06 = 010050                              GJC0003                     LEEMAEST     342
  9863              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003                     LEEMAEST     343
  9864           END-IF                                                 GJC0003                     LEEMAEST     344
  9865        END-IF                                                    GJC0003                     LEEMAEST     345
  9866     END-IF.                                                                                  LEEMAEST     346
  9867     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003                     LEEMAEST     347
  9868                                                                                              LEEMAEST     348
  9869 7000-GUARDAR-REG-INICIALES.                                                                  LEEMAEST     349
  9870******************************************************************                            LEEMAEST     350
  9871*7000-GUARDAR-REGISTROS-INICIALES.                                                            LEEMAEST     351
  9872*    GUARDA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES DE                             LEEMAEST     352
  9873*    EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR                                                LEEMAEST     353
  9874******************************************************************                            LEEMAEST     354
  9875      MOVE SPACES TO REG-ICMCRE-LEEMSTRS REG-ICMCHK-LEEMSTRS                                  LEEMAEST     355
  9876                     REG-ICBSUS-LEEMSTRS REG-ICBDIR-LEEMSTRS                                  LEEMAEST     356
  9877      MOVE COMPLETO-ABD07  TO REG-ICMCRE-LEEMSTRS                                             LEEMAEST     357
  9878      MOVE COMPLETO-ABD06  TO REG-ICMCHK-LEEMSTRS                                             LEEMAEST     358
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 172
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL (/d/iccol/desarrollo/copys/LEEMAESTRO
  9879      MOVE REG-SUSCRIPTOR  TO REG-ICBSUS-LEEMSTRS                                             LEEMAEST     359
  9880      MOVE REG-DIRECC      TO REG-ICBDIR-LEEMSTRS.                                            LEEMAEST     360
  9881                                                                                              LEEMAEST     361
  9882 8000-RECUPERAR-REG-INICIALES.                                                                LEEMAEST     362
  9883******************************************************************                            LEEMAEST     363
  9884*8000-RECUPERA-REGISTROS-INICIALES.                                                           LEEMAEST     364
  9885*    RECUPERA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES                              LEEMAEST     365
  9886*    DE EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR                                             LEEMAEST     366
  9887******************************************************************                            LEEMAEST     367
  9888      IF COMPLETO-ABD07  <> REG-ICMCRE-LEEMSTRS AND                                           LEEMAEST     368
  9889         REG-ICMCRE-LEEMSTRS <> SPACES                                                        LEEMAEST     369
  9890         MOVE REG-ICMCRE-LEEMSTRS TO COMPLETO-ABD07                                           LEEMAEST     370
  9891         START MAESTRO-CREDIT KEY = LLAVE-MAES-CREDIT                                         LEEMAEST     371
  9892               NOT INVALID KEY                                                                LEEMAEST     372
  9893               READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK                                    LEEMAEST     373
  9894               END-READ                                                                       LEEMAEST     374
  9895         END-START                                                                            LEEMAEST     375
  9896      END-IF                                                                                  LEEMAEST     376
  9897      IF COMPLETO-ABD06  <> REG-ICMCHK-LEEMSTRS AND                                           LEEMAEST     377
  9898         REG-ICMCHK-LEEMSTRS <> SPACES                                                        LEEMAEST     378
  9899         MOVE REG-ICMCHK-LEEMSTRS TO COMPLETO-ABD06                                           LEEMAEST     379
  9900         START MAESTRO-CHECK  KEY = LLAVE-MAES-CHECK                                          LEEMAEST     380
  9901               NOT INVALID KEY                                                                LEEMAEST     381
  9902               READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK                                     LEEMAEST     382
  9903               END-READ                                                                       LEEMAEST     383
  9904         END-START                                                                            LEEMAEST     384
  9905      END-IF                                                                                  LEEMAEST     385
  9906      IF REG-SUSCRIPTOR  <> REG-ICBSUS-LEEMSTRS AND                                           LEEMAEST     386
  9907         REG-ICBSUS-LEEMSTRS <> SPACES                                                        LEEMAEST     387
  9908         MOVE REG-ICBSUS-LEEMSTRS TO REG-SUSCRIPTOR                                           LEEMAEST     388
  9909         START SUSCRIPTOR KEY = LLAVE-SUSCRIP                                                 LEEMAEST     389
  9910               NOT INVALID KEY                                                                LEEMAEST     390
  9911               READ SUSCRIPTOR NEXT RECORD IGNORE LOCK                                        LEEMAEST     391
  9912               END-READ                                                                       LEEMAEST     392
  9913         END-START                                                                            LEEMAEST     393
  9914      END-IF                                                                                  LEEMAEST     394
  9915      IF REG-DIRECC      <> REG-ICBDIR-LEEMSTRS AND                                           LEEMAEST     395
  9916         REG-ICBDIR-LEEMSTRS <> SPACES                                                        LEEMAEST     396
  9917         MOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECC                                               LEEMAEST     397
  9918         START MAESTRO-DIRECC KEY = LLAVE-DIRECC                                              LEEMAEST     398
  9919               NOT INVALID KEY                                                                LEEMAEST     399
  9920               READ MAESTRO-DIRECC NEXT RECORD IGNORE LOCK                                    LEEMAEST     400
  9921               END-READ                                                                       LEEMAEST     401
  9922         END-START                                                                            LEEMAEST     402
  9923      END-IF.                                                                                 LEEMAEST     403
  9924                                                                                                          1562
  9925                                                                                                          1563
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 173
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/LEEMAESTRO
  9926/                                                                                                         1564
  9927 IDENTIFICATION DIVISION.                                                                                 1565
  9928 PROGRAM-ID. PONERR.                                                                                      1566
  9929******************************************************************                                        1567
  9930* Rutina de conveniencia para procesar un error detectado en un                                           1568
  9931* registro de input                                                                                       1569
  9932* Contabiliza el error en la tabla de errores, activa el indicador                                        1570
  9933* de registro con error, muestra el mensaje en la pantalla, cuenta                                        1571
  9934* el registro erroneo                                                                                     1572
  9935******************************************************************                                        1573
  9936 ENVIRONMENT DIVISION.                                                                                    1574
  9937 DATA DIVISION.                                                                                           1575
  9938 WORKING-STORAGE SECTION.                                                                                 1576
  9939******************************************************************                                        1577
  9940* Registro de input (primeros 86 caracteres)                                                              1578
  9941 01  reg-input-anterior           pic x(86) value low-values.                                             1579
  9942* Posicion del proximo error en la lista de errores del reg                                               1580
  9943 01  errIndex                     pic 999 comp.                                                           1581
  9944******************************************************************                                        1582
  9945                                                                                                          1583
  9946 LINKAGE SECTION.                                                                                         1584
  9947******************************************************************                                        1585
  9948* Codigo del error detectado                                                                              1586
  9949 01  cod-error                    pic xx.                                                                 1587
  9950******************************************************************                                        1588
  9951* Registro de input (primeros 86 caracteres)                                                              1589
  9952 01  reg-input                    pic x(86).                                                              1590
  9953******************************************************************                                        1591
  9954* Tabla de errores de consistencia del input                                                              1592
  9955 01 E-errores.                                                                                            1593
  9956*    indica si el registro actual tiene error                                                             1594
  9957     03 E-hay-error               pic xx.                                                                 1595
  9958*    errores del registro actual                                                                          1596
  9959     03 E-errores-reg             pic x(300).                                                             1597
  9960*    contador de registros con error                                                                      1598
  9961     03 E-cont-regs-con-error     pic 9(8).                                                               1599
  9962*    tabla de errores                                                                                     1600
  9963     03 E-error                   occurs 50 indexed Ex.                                                   1601
  9964         05 E-codigo              pic xx.                                                                 1602
  9965         05                       pic x.                                                                  1603
  9966         05 E-contador            pic 9(7).                                                               1604
  9967         05                       pic x.                                                                  1605
  9968         05 E-descripcion         pic x(59).                                                              1606
  9969                                                                                                          1607
  9970******************************************************************                                        1608
  9971                                                                                                          1609
  9972 PROCEDURE DIVISION using cod-error reg-input E-errores.                                                  1610
  9973 00.                                                                                                      1611
  9974*    marca al reg actual como erroneo                                                                     1612
  9975     move "SI" to E-hay-error                                                                             1613
  9976                                                                                                          1614
  9977*    cuenta y muestra el registro de input                                                                1615
  9978     if reg-input not = reg-input-anterior                                                                1616
  9979         add 1 to E-cont-regs-con-error                                                                   1617
  9980         display " "                                                                                      1618
  9981         display reg-input                                                                                1619
  9982         move reg-input to reg-input-anterior                                                             1620
  9983         move spaces to E-errores-reg                                                                     1621
* Micro Focus Server Express         V5.1 revision 000 10-Jun-14 15:01 Page 174
* C)/iccol/desarrollo/fuentes/CARGAJUR.CBL                         ys/LEEMAESTRO
  9984         move 2 to errIndex                                                                               1622
  9985     end-if                                                                                               1623
  9986                                                                                                          1624
  9987*    contabiliza el error en la tabla de errores                                                          1625
  9988     set Ex to 1                                                                                          1626
  9989     search E-error varying Ex                                                                            1627
  9990     at end                                                                                               1628
  9991         display "--- falla en la tabla de errores ---" cod-error                                         1629
  9992     when E-codigo(Ex) = "00"                                                                             1630
  9993         add 1 to E-contador(Ex)                                                                          1631
  9994         display "--- error tipo exotico: " cod-error                                                     1632
  9995         add 1 to E-contador(Ex)                                                                          1633
  9996     when E-codigo(Ex) = cod-error                                                                        1634
  9997         add 1 to E-contador(Ex)                                                                          1635
  9998         display "Error " cod-error " " E-descripcion(Ex)                                                 1636
  9999     end-search                                                                                           1637
 10000                                                                                                          1638
 10001*    agrega a la lista de errores del registro                                                            1639
 10002     if errIndex < (300 - 59 - 3)                                                                         1640
 10003         move cod-error to E-errores-reg(errIndex:2)                                                      1641
 10004         add 3 to errIndex                                                                                1642
 10005         move E-descripcion(Ex) to E-errores-reg(errIndex:59)                                             1643
 10006         add 59 to errIndex                                                                               1644
 10007     end-if                                                                                               1645
 10008                                                                                                          1646
 10009     exit program.                                                                                        1647
 10010                                                                                                          1648
 10011                                                                                                          1649
 10012 end program PONERR.                                                                                      1650
 10013                                                                                                          1651
 10014 end program CARGAJUR.                                                                                    1652
 10015                                                                                                          1653
 10016******************************************************************                                        1654
 10017******************************************************************                                        1655
 10018                                                                                                          1656
 10019                                                                                                          1657
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-015065005AF
* Total Messages:     0
* Data:     1430184     Code:       90667
/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1657 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           COPY ICBDIR0001.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      * 0000-PROGRAMA-PRINCIPAL

APPEND MODE      * 4000-PROCESAR-REGISTRO

APPEND MODE      * 4000-PROCESAR-REGISTRO-2

APPEND MODE      * 4100-VALIDACION-FORMAL

APPEND MODE      * 4200-VALIDACION-SEMANTICA

APPEND MODE      * 4300-MODIFICAR-BDIIALE

APPEND MODE      * 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      * 4300-MODIFICAR-BDIIALE-I

APPEND MODE      * 4300-MODIFICAR-BDIIALE-M

APPEND MODE      * 4300-MODIFICAR-BDIIALE-E

APPEND MODE      * 4333-LEER-BDIIALE-RANDOM

APPEND MODE      * 4333-GRABAR-BDIIALE

APPEND MODE      * 4333-REGRABAR-BDIIALE

APPEND MODE      * 4333-ELIMINAR-BDIIALE

APPEND MODE      * 4800-PROCESO-REG-T

APPEND MODE      * 4900-GRABAR-ERROR

APPEND MODE      * 4320-ARMAR-TEXTO-ALERTA

APPEND MODE      * 1000-RUTINA-INICIAL

APPEND MODE      * 1022-CARGAR-INCONSISTENTES

APPEND MODE      * 1000-NOT-USED

APPEND MODE      * 1001-ELIMINAR-TODO

APPEND MODE      * 7000-RUTINA-FINAL

APPEND MODE      * 9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE               add 1 to REG-LEIDOS

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificación contra las bases de

APPEND MODE      *    datos de validación de información BDIIDIAN, BDIIDAS,

APPEND MODE      *    BDIIREGI y verifica la coincidencia del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a "

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cédula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4240-CONTAR-TIPO-CUENTA.

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    tipo 5: sin error

APPEND MODE      *    tipo 6: 01 02 06 07

APPEND MODE      *    tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos

APPEND MODE      *    alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE      * $$$$ se agregaron varios archivos más

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      * Totales tipo PESVNO

APPEND MODE           DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS

APPEND MODE           DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS

APPEND MODE           DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R

APPEND MODE           DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS

APPEND MODE           DISPLAY "  REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS

APPEND MODE           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN

APPEND MODE           DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS

APPEND MODE           DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN

APPEND MODE           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE  TIPOID-E  TO  TIP-IDE-BDIIVIDE

APPEND MODE           MOVE  NUMID-E   TO  NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE           IF HACER-MATCH = ZEROS

APPEND MODE              IF OPEN-DIR = ZEROS

APPEND MODE                 OPEN INPUT MAESTRO-DIRECC

APPEND MODE                 OPEN INPUT BDLCLI

APPEND MODE                 OPEN INPUT SUSCRIPTOR

APPEND MODE                 OPEN INPUT MAESTRO-CREDIT

APPEND MODE                 OPEN INPUT MAESTRO-CHECK

APPEND MODE                 PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                 MOVE 1 TO OPEN-DIR

APPEND MODE               END-IF

APPEND MODE               MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE               MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE               PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE               MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  IF TIPOID-E = 1 OR 4

APPEND MODE                     INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                        "," BY " ", ";" BY " "

APPEND MODE                  END-IF

APPEND MODE                  MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                  MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                  MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                  PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                  IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                     MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                  ELSE

APPEND MODE                    IF W-BLOQUES > 0

APPEND MODE                       MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                    END-IF

APPEND MODE                  END-IF

APPEND MODE               END-IF

APPEND MODE

APPEND MODE               IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                  MOVE TIPOID-E TO TIP-VAL

APPEND MODE                  MOVE NUMID-E  TO CED-VAL

APPEND MODE                  MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                  PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                  MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                  MOVE ZEROS    TO FEC-EXP-VAL

APPEND MODE                  MOVE SPACES   TO MUN-EXP-VAL

APPEND MODE                  MOVE SPACES   TO DEP-EXP-VAL

APPEND MODE                  MOVE SPACES   TO VIG-VAL

APPEND MODE                  MOVE SPACES   TO GENERO-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-VAL

APPEND MODE                  MOVE SPACES   TO EDAD-RANGO

APPEND MODE                  ADD 1 TO SI-EXISTE-CSV

APPEND MODE                END-IF

APPEND MODE             END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1670 lines, 70567 characters 

[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgcat CARGAJUR.lstclear           ls -l  CARGAJUR*des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430184     Code:       91077
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429424  Code:    106932  Literals:      2952  Dynamic:   2490368

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>te
/d/iccol/desarrollo/temporales>ls 9999*
9999991000905140101.txt
/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 0
Parametros: 9999991000905140101.txt 0                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
El indicador de proceso real es invalido
debe ser 1 o 2
 
CARGAJUR   - proceso cancelado

real    0m0.02s
user    0m0.00s
sys     0m0.01s

Inicio de Programa:  2014/06/10 15:20:56
Fin de Programa:     2014/06/10 15:20:56

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 0/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 1
Parametros: 9999991000905140101.txt 1                                                       
CARGAJUR   Carga de archivo JURAD - proceso REAL
01 Envio Original - Carga TOTAL 1a vez
Fecha de proceso: 20140101
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140101
 
Totales de registros:
 
REGISTROS LEIDOS                :0000028
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    37.0 % de registros correctos
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
         Alertas insertadas
      20 Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       8 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.14s
user    0m0.01s
sys     0m0.02s

Inicio de Programa:  2014/06/10 15:21:17
Fin de Programa:     2014/06/10 15:21:17

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 1/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 1           /d/iccol/desarrollo/temporales>c9999991000905140101.txt 1p9999991000905140101.txt 1 9999991000905140101.txt 1                          p 9999991000905140101.txt 1 9999991000905140101.txt 999991000905140101.txt 11                     <  4cp 9999991000905140101.txt  999999100090514010>/d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>/lsls 9999*
9999991000905140101.errs  9999991000905140101.txt   9999991000905140104.txt
/d/iccol/desarrollo/temporales>vi 9999*ers
"9999*ers" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999*ers" [New file]:q/d/iccol/desarrollo/temporales>vi 9999*errs
"9999991000905140101.errs" 17 lines, 2434 characters I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411 14 El numero de id no se encuen
tra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406 14 El numero de id no se encuen
tra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406 14 El numero de id no se encuen
tra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069 13 Fecha ultimo embargo vigente
 YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO0050672013040602206720100435 13 Fecha ultimo embargo vigente
 YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406 13 Fecha ultimo embargo vigente
 YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406 07 Numero de demandas terminada
s: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806 13 Fecha ultimo embargo vigente
 YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA0440761998406903400219990101 09 Fecha ultima demanda vigente
 YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206 09 Fecha ultima demanda vigente
 YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA0330332011140604500120110402 09 Fecha ultima demanda vigente
 YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411 09 Fecha ultima demanda vigente
 YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010 09 Fecha ultima demanda vigente
 YYYYMMDD: fuera de rango
I300600003115xxxxxx0150542014010600400320120406 15 El nombre en el input no coi
ncide con el registrado
I400000266423SIMONE MARTINEZ033002201312060070rt20110106 11 Numero de embargos terminado
s: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111 14 El numero de id no se encuen
tra en el archivo maestro
I400000163598xxxxxx0330432013101002204520120406 15 El nombre en el input no coi
ncide con el registrado
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999991000905140101.errs" 17 lines, 2434 characters:q/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>vi 9999*errsvi 9999*ers ls 9999*   cp 9999991000905140101.txt  999999100090514010>/d/iccol/desarrollo/temporales> 9999991000905140101.txt  9999991000905140104./d/iccol/desarrollo/temporales>v 9999991000905140101.txt  9999991000905140104/d/iccol/desarrollo/temporales>vi 9999991000905140101.txt  999999100090514010/d/iccol/desarrollo/temporales>vii 9999991000905140104.txt                     /d/iccol/desarrollo/temporales>vi 
"9999991000905140104.txt" 28 lines, 2436 characters I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
I100002859753ERNESTO RICO0050672013040602206720100435
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
I100003295380HENRY REY BARBOSA0080452013011123200220110506
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
I200811046741SALUD AXIAL LTDA0440761998406903400219990101
I200830067928C I GLOMA S A0110432044040601203220100406
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206
I200860024151COMPUTEC SA0330332011140604500120110402
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
I300600003115xxxxxx0150542014010600400320120406
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
I400000266423SIMONE MARTINEZ033002201312060070rt20110106
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
I400000163598xxxxxx0330432013101002204520120406
T 00000000027772774787861
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999991000905140104.txt" 28 lines, 2436 characters
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
IREPLACE 1 CHAR
Iz
Iz:w"9999991000905140104.txt" 29 lines, 2523 characters 
I/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>vi 9999991000905140104.txtvi 9999*errs              vi 9999*ers ls 9999*   cp 9999991000905140101.txt  999999100090514010>/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 1           /d/iccol/desarrollo/temporales>x CARGAJUR 99999910009051401044.txt 2
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
No coincide la cantidad de registros:00000000027 con los leidos:00000028
Error en registro T de totales de control
Nombre del archivo: $TEMPORALES/9999991000905140104.errs                                            
 
CARGAJUR   - proceso cancelado

real    0m0.06s
user    0m0.01s
sys     0m0.02s

Inicio de Programa:  2014/06/10 15:25:41
Fin de Programa:     2014/06/10 15:25:41

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/temporales>vi 9999991000905140104.txt          /d/iccol/desarrollo/temporales>
"9999991000905140104.txt" 29 lines, 2523 characters I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
I100002859753ERNESTO RICO0050672013040602206720100435
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
I100003295380HENRY REY BARBOSA0080452013011123200220110506
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
I200811046741SALUD AXIAL LTDA0440761998406903400219990101
I200830067928C I GLOMA S A0110432044040601203220100406
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206
I200860024151COMPUTEC SA0330332011140604500120110402
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
I300600003115xxxxxx0150542014010600400320120406
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
I400000266423SIMONE MARTINEZ033002201312060070rt20110106
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
I400000163598xxxxxx0330432013101002204520120406
T 00000000027772774787861
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"9999991000905140104.txt" 29 lines, 2523 charactersREPLACE 1 CHAR8"9999991000905140104.txt" 29 lines, 2523 characters /d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>vi 9999991000905140104.txtx CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/temporales>
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
    64.3 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      18 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       8 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

real    0m0.04s
user    0m0.01s
sys     0m0.02s

Inicio de Programa:  2014/06/10 15:26:11
Fin de Programa:     2014/06/10 15:26:11

/d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2 > qq

real    0m0.06s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>cat qq
Parametros: 9999991000905140104.txt 2                                                       
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
Iz00000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4          
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000040000320201204
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002    
Registro de input: 
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
Datos en la alerta: 000110004320204404
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 000080004520201301
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002    
Registro de input: 
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
Datos en la alerta: 002320000220201105
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000220004520201204
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002    
Registro de input: 
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000330002020200004
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002    
Registro de input: 
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
Datos en la alerta: 000150005420201401
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000110004320204404
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002    
Registro de input: 
I200830067928C I GLOMA S A                                0110432044040601203220100406
Datos en la alerta: 000120003220201004
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000450000020201008
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002    
Registro de input: 
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
Datos en la alerta: 000020004420201305
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000340004520201204
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002    
Registro de input: 
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
Datos en la alerta: 000030000620201301
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000340000220199901
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002    
Registro de input: 
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
Datos en la alerta: 000050006720201304
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000120003220201004
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002    
Registro de input: 
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
Datos en la alerta: 000060004520201104
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
Error 14 El numero de id no se encuentra en el archivo maestro      
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000110002320201104
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002    
Registro de input: 
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
Datos en la alerta: 000090005720201304
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Fecha de proceso: 20140104
 
Totales de registros:
 
REGISTROS LEIDOS                :0000029
REGISTROS CORRECTOS             :0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS         :0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :0000000
 
    35.7 % de registros correctos
    64.3 % de registros inconsistentes
      28 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      18 Registros con error
         Alertas borradas previo al refresque total
         Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
      20 Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 02-Tipo de identificacion invalido, debe ser 1 2 3 4          
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       8 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/06/10 15:42:47
Fin de Programa:     2014/06/10 15:42:47

/d/iccol/desarrollo/temporales>L 
shell will timeout in 60 seconds due to inactivity

/d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>
/d/iccol/desarrollo/temporales>fg
vi CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************
$SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1670 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. MICROFOCUS with debugging mode.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           COPY ICBDIR0001.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE      *    4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE      *    4240-CONTAR-TIPO-CUENTA

APPEND MODE      *    4210-VALIDACION-ID-NO-FIGURA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4800-PROCESO-REG-T

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1000-NOT-USED

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    9800-FILTRAR-ALFABETICO

APPEND MODE     

APPEND MODE     

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      D    display "0000-PROGRAMA-PRINCIPAL"

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      D    display "4000-PROCESAR-REGISTRO"

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE               add 1 to REG-LEIDOS

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      D    display "4000-PROCESAR-REGISTRO-2"

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE*******        perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      D    display "4100-VALIDACION-FORMAL"

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      D    display "4200-VALIDACION-SEMANTICA"

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificación contra las bases de

APPEND MODE      *    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia

APPEND MODE      *    del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cédula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      D    display "4222-VALIDA-NOMBRE-COINCIDE"

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4240-CONTAR-TIPO-CUENTA.

APPEND MODE      D    display "4240-CONTAR-TIPO-CUENTA"

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    00=OK

APPEND MODE      *    01=NIT OK, nombre no coincide

APPEND MODE      *    02=cédula OK, nombre no coincide

APPEND MODE      *    03=NIT no figura

APPEND MODE      *    04=cédula no figura pero está en base alterna

APPEND MODE      *    05=tipo id no es 1|2|3|4

APPEND MODE      *    06=cédula ... ESTADO-VIG-BDIIREGI = 21

APPEND MODE      *    07=cédula ... ESTADO-VIG-BDIIREGI = 12

APPEND MODE      *

APPEND MODE      *    cuenta tipo 5: sin error

APPEND MODE      *    cuenta tipo 6: 01 02 06 07

APPEND MODE      *    cuenta tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      D    display "4210-VALIDACION-ID-NO-FIGURA"

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-DATOS"

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-I"

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-M"

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-E"

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      D    display "4333-LEER-BDIIALE-RANDOM"

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      D    display "4333-GRABAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      D    display "4333-REGRABAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      D    display "4333-ELIMINAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      D    display "4800-PROCESO-REG-T"

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      D    display "4900-GRABAR-ERROR"

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      D    display "4320-ARMAR-TEXTO-ALERTA"

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      D    display "1000-RUTINA-INICIAL"

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      D    display "1000-NOT-USED"

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      D    display "1001-ELIMINAR-TODO"

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      D    display "7000-RUTINA-FINAL"

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE      * $$$$ se agregaron varios archivos más

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      * Totales tipo PESVNO

APPEND MODE           DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS

APPEND MODE           DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS

APPEND MODE           DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R

APPEND MODE           DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS

APPEND MODE           DISPLAY "  REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS

APPEND MODE           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN

APPEND MODE           DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS

APPEND MODE           DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN

APPEND MODE           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      D    display "9000-CANCELAR-PROGRAMA"

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE TIPOID-E TO TIP-IDE-BDIIVIDE

APPEND MODE           MOVE NUMID-E TO NUM-IDE-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE      *        el tipo de id es OK

APPEND MODE               IF HACER-MATCH = ZEROS

APPEND MODE      *            abre archivos y carga la tabla de direcciones 

APPEND MODE      *            estandar, solo la primera vez

APPEND MODE                   IF OPEN-DIR = ZEROS

APPEND MODE                       OPEN INPUT MAESTRO-DIRECC

APPEND MODE                       OPEN INPUT BDLCLI

APPEND MODE                       OPEN INPUT SUSCRIPTOR

APPEND MODE                       OPEN INPUT MAESTRO-CREDIT

APPEND MODE                       OPEN INPUT MAESTRO-CHECK

APPEND MODE                       PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                       MOVE 1 TO OPEN-DIR

APPEND MODE                   END-IF

APPEND MODE      *            abre archivos y carga la tabla de direcciones 

APPEND MODE                   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE                   MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE      *            Se recorre toda la estructura bdacsv para la identificacion

APPEND MODE      *            buscada. En caso de hallar registros se procede a realizar el

APPEND MODE      *            match

APPEND MODE                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE                   MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE                   IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                       IF TIPOID-E = 1 OR 4

APPEND MODE                           INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                           "," BY " ", ";" BY " "

APPEND MODE                       END-IF

APPEND MODE                       MOVE NOMBRE-E            TO NOMBRE-INPUT-VALNOM

APPEND MODE                       MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                       MOVE TIPOID-E            TO  TIP-ID-INPUT-VALNOM

APPEND MODE                       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                       PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE                       IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                           MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                       ELSE

APPEND MODE                          IF W-BLOQUES > 0

APPEND MODE                              MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                          END-IF

APPEND MODE                       END-IF

APPEND MODE                   END-IF

APPEND MODE     

APPEND MODE                   IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                       MOVE TIPOID-E TO TIP-VAL

APPEND MODE                       MOVE NUMID-E  TO CED-VAL

APPEND MODE                       MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                       PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                       MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                       MOVE ZEROS  TO FEC-EXP-VAL

APPEND MODE                       MOVE SPACES TO MUN-EXP-VAL

APPEND MODE                       MOVE SPACES TO DEP-EXP-VAL

APPEND MODE                       MOVE SPACES TO VIG-VAL

APPEND MODE                       MOVE SPACES TO GENERO-VAL

APPEND MODE                       MOVE SPACES TO EDAD-VAL

APPEND MODE                       MOVE SPACES TO EDAD-RANGO

APPEND MODE                       ADD 1 TO SI-EXISTE-CSV

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      D    display "9800-FILTRAR-ALFABETICO"

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

"CARGAJUR.CBL" [Modified] line 1710 of 1710 --100%-- 
:w"CARGAJUR.CBL" 1710 lines, 72593 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>fgcat qqx CARGAJUR 9999991000905140104.txt 2 > qq/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2     /d/iccol/desarrollo/temporales>vi 9999991000905140104.txt          /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2/d/iccol/desarrollo/temporales>vi 9999991000905140104.txt          /d/iccol/desarrollo/temporales>vi 9999*errs              vi 9999*ers ls 9999*   cp 9999991000905140101.txt  999999100090514010>/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 1           /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140101.txt 0/d/iccol/desarrollo/temporales>ls 9999*                            /d/iccol/desarrollo/temporales>te      des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       91624
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107044  Literals:      3448  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>des-c-v CARGAJURfg              cat qqx CARGAJUR 9999991000905140104.txt 2 > qq/d/iccol/desarrollo/temporales>
ksh: qq: file already exists
/d/iccol/desarrollo/temporales>^[k  /d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2 > qq/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2 >| qq

real    0m0.11s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 446 lines, 15646 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO
4000-PROCESAR-REGISTRO-2"qq" 446 lines, 15646 characters:q/d/iccol/desarrollo/temporales>fg
vi CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************


0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.4000-PROCESAR-REGISTRO-2.
OPEN MODE      D        display " "
OPEN MODE      D        display " "
OPEN MODE      D        display JURAD-reg
OPEN MODEend-evaluate." $CHANGE MODE................................................:w"CARGAJUR.CBL" 1713 lines, 72724 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>fgvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>x CARGAJUR 9999991000905140104.txt 2 > qq /d/iccol/desarrollo/temporales>des-c-v CARGAJUR                         /d/iccol/desarrollo/temporales>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       91690
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107092  Literals:      3496  Dynamic:   2523136

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>des-c-v CARGAJURfg              vi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>

real    0m0.05s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/temporales>vi qq
"qq" 533 lines, 19561 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO

.............................................
I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO

.............................................
Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO

.............................................
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro"qq" 533 lines, 19561 charactersI100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO

.............................................
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001
Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002
Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I100002859753ERNESTO RICO0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100002859753ERNESTO RICO0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rangoError 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I100003295380HENRY REY BARBOSA0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001
Registro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002
Registro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO.............................................
I100003295380HENRY REY BARBOSA0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001
Registro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002
Registro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001
Registro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406Registro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002
Registro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001
Registro de input:
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
Datos en la alerta: 000330002020200004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002
Registro de input:
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I200811046741SALUD AXIAL LTDA0440761998406903400219990101
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200811046741SALUD AXIAL LTDA0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR"qq" line 176 of 533 --33%-- 4000-PROCESAR-REGISTRO.............................................
.............................................
I200830067928C I GLOMA S A0110432044040601203220100406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001
Registro de input:
I200830067928C I GLOMA S A0110432044040601203220100406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002
Registro de input:
I200830067928C I GLOMA S A0110432044040601203220100406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I200860024151COMPUTEC SA0330332011140604500120110402
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200860024151COMPUTEC SA0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
4000-PROCESAR-REGISTRO-2I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001
Registro de input:
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002
Registro de input:
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
Datos en la alerta: 000020004420201305
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001
Registro de input:
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002
Registro de input:
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I300600003115xxxxxx0150542014010600400320120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I300600003115xxxxxx0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado
novedad:  xxxxxx
registro: FERNANDEZ PENA JULIO ANTONIO
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO

.............................................
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001/4240-


//I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001
Registro de input:
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002
Registro de input:
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001
Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002
Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA.............................................//


.............................................
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001
Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002
Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I400000266423SIMONE MARTINEZ033002201312060070rt20110106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I400000266423SIMONE MARTINEZ033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO

.............................................
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO

............................................."qq" line 397 of 533 --74%-- 
.............................................
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001
Registro de input:
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
Datos en la alerta: 000110002320201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002
Registro de input:
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
Datos en la alerta: 000090005720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO

.............................................
I400000163598xxxxxx0330432013101002204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I400000163598xxxxxx0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado
novedad:  xxxxxx
registro: KARAN  ABBOUD NAJAH
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO

.............................................
T 00000000028772774787861
4000-PROCESAR-REGISTRO-2
4800-PROCESO-REG-T
7000-RUTINA-FINAL
Fecha de proceso: 20140104

Totales de registros:
Totales de registros:

REGISTROS LEIDOS:0000029
REGISTROS CORRECTOS:0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS:0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :000000035.7 % de registros correctos
    64.3 % de registros inconsistentes
28 Registros IME en el archivo de entrada
10 Registros procesados sin error
18 Registros con error
Alertas borradas previo al refresque total
Alertas insertadas
Alertas modificadas
Alertas eliminadas
20 Insercion de alerta existente
Modif o elim de alerta inexistente

Totales por tipo de error detectado:
1 02-Tipo de identificacion invalido, debe ser 1 2 3 4
1 07-Numero de demandas terminadas: debe ser numerico
5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango
1 11-Numero de embargos terminados: debe ser numerico
4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4 14-El numero de id no se encuentra en el archivo maestro
2 15-El nombre en el input no coincide con el registrado

Inicio de Programa:  2014/06/10 17:05:50
Fin de Programa:     2014/06/10 17:05:50

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/temporales>fg
vi CARGAJUR.CBL

0000-PROGRAMA-PRINCIPAL.
D    display "0000-PROGRAMA-PRINCIPAL"
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
D    display "4000-PROCESAR-REGISTRO"
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
Ddisplay " "
Ddisplay "............................................."
Ddisplay JURAD-reg
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anterioradd 1 to REG-LEIDOSwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes
*de que se terminara el archivodisplay "Falta el reg de totales del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAwhen other
*error de lectura: cancelacion del procesodisplay "Error en lectura del archivo JURAD "display "Nombre del archivo: " P-file-namedisplay "File status: " JURAD-fsdisplay "Ultimo registro leido: " N-reg-leidosdisplay JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.display " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-editdisplay E-edit E-codigo(Ex) "-" E-descripcion(Ex)end-if
end-perform.9000-CANCELAR-PROGRAMA.
D    display "9000-CANCELAR-PROGRAMA"
******************************************************************
* Procedimiento standard de cancelacion de programa batch
******************************************************************
* TODO: hay un standard para comunicar una cancelacion de proceso?display " "
display pgm " - proceso cancelado"goback returning 99.513-VALIDA-EN-CSV.
**************************************************************
* Valida si la identificación está en la base de datos alterna
**************************************************************
*    hace validacion de tipo de identificacionMOVE TIPOID-E TO TIP-IDE-BDIIVIDEMOVE NUMID-E TO NUM-IDE-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
*abre archivos y carga la tabla de direcciones
*estandar, solo la primera vezIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOR
OPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECK
PERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar elOPEN MODE      D    display "513-VALIDA-EN-CSV":w"CARGAJUR.CBL" 1714 lines, 72763 characters *buscada. En caso de hallar registros se procede a realizar el*matchPERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1IF TIPOID-E = 1 OR 4




     
MOVE NUMID-E TO NUM-IDE-BDIIVIDEPERFORM 80400-VALIDAR-TIPO-IDIF SW-TID-BDIIVIDE = 0
*el tipo de id es OKIF HACER-MATCH = ZEROS
*abre archivos y carga la tabla de direcciones
*estandar, solo la primera vezIF OPEN-DIR = ZEROS
OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOR
OPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECK
PERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el
*match
PERFORM 1000-U-RECORRER-CSV-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-ETO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-ETO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOMIF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHELSE
IF W-BLOQUES > 0
MOVE 0 TO IDE-TIPO-BDAMATCHEND-IF
END-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
MOVE TIPOID-E TO TIP-VAL
MOVE NUMID-E  TO CED-VAL
MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRAPERFORM 9800-FILTRAR-ALFABETICOMOVE CADENA-SALE TO  NOM-VALMOVE TIPOID-E TO TIP-IDE-BDIIVIDE*    hace validacion de tipo de identificacion*************************************************************** Valida si la identificación está en la base de datos alterna**************************************************************D    display "513-VALIDA-EN-CSV"




     





*el tipo de id es OKREPLACE 1 CHARDD        INSERT MODEdisplay ""el $CHANGE MODEn° de ID está dentro de su rango"



Ddisplay "el n° de ID está dentro de su rango"D        dINSERT MODE     i  INSERT MODE         display "$CHANGE MODEcarga tabla DIRESTAN"










 






"CARGAJUR.CBL" [Modified] line 1560 of 1716 --90%-- $SET LIST SETTING LISTWIDTH"120"IDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. MICROFOCUS with debugging mode.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1716 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING LISTWIDTH"120"

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. MICROFOCUS with debugging mode.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FS.

APPEND MODE           copy ICBDIR.FS.

APPEND MODE           copy BDLCLI.FS.                         

APPEND MODE           COPY ICBSUS.FS.

APPEND MODE           COPY ICBCHK.FS.

APPEND MODE           COPY ICBCRE.FS.

APPEND MODE           COPY BDLSTDCIU.FS.

APPEND MODE           COPY DIREST.FS.

APPEND MODE           COPY BDLNEWDIRBOG.FS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      * $$$$ El formato a continuación no está confirmedo, no se usa

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(61).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivos de base alterna

APPEND MODE      ******************************************************************

APPEND MODE           copy BDACSV.FD.

APPEND MODE           COPY ICBDIR0001.FD.

APPEND MODE           copy BDLCLI.FD.                         

APPEND MODE           COPY ICBSUS.FD.

APPEND MODE           COPY ICBCHK.FD.

APPEND MODE           COPY ICBCRE.FD.

APPEND MODE           COPY BDLSTDCIU.FD.

APPEND MODE           COPY DIREST.FD.

APPEND MODE           COPY BDLNEWDIRBOG.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para la búsqueda en base alterna

APPEND MODE       01  W-DERECHOS                   PIC 9 value 0.

APPEND MODE       01  CODIGO-ERROR                 pic 99 value 00.

APPEND MODE

APPEND MODE       01  SW-BDIIALE                   pic 9 value 0.

APPEND MODE       01  HACER-MATCH                  PIC 9 value 0.

APPEND MODE       01  CADENA-ENTRA                 PIC X(60).

APPEND MODE       01  CADENA-SALE                  PIC X(60).

APPEND MODE       01  IND-ALFABETICO              PIC  X(01).                      

APPEND MODE           88 SI-ALFABETICO           VALUE " " "A" "B" "C" "D" "E" "F"

APPEND MODE                                            "G" "H" "I" "J" "K" "L" "M"

APPEND MODE                                            "N" "/" "O" "P" "Q" "R" "S"

APPEND MODE                                            "T" "U" "V" "W" "X" "Y" "Z"

APPEND MODE                                            "Ñ".

APPEND MODE       01  OPEN-DIR                     PIC 9 value 0.

APPEND MODE       01  W-BLOQUES                    PIC 9 value 2.

APPEND MODE

APPEND MODE       01  DATOS-E.

APPEND MODE           03 TIPOID-E                  pic 9.

APPEND MODE           03 NUMID-E                   pic 9(11).

APPEND MODE           03 NOMBRE-E                  pic x(45).

APPEND MODE

APPEND MODE       01  REG-VALIDAS.                           

APPEND MODE           03 TIP-VAL                   PIC 9.   

APPEND MODE           03 CED-VAL                   PIC 9(11).

APPEND MODE           03 NOM-VAL                   PIC X(45).

APPEND MODE           03 FEC-EXP-VAL               PIC 9(08).

APPEND MODE           03 MUN-EXP-VAL               PIC X(15).

APPEND MODE           03 DEP-EXP-VAL               PIC X(15).

APPEND MODE           03 VIG-VAL                   PIC X(02).

APPEND MODE           03 GENERO-VAL                PIC X(01).

APPEND MODE           03 EDAD-VAL                  PIC X(03).

APPEND MODE           03 EDAD-RANGO                PIC X(05).

APPEND MODE           03 FILLER-2-VAL              PIC X(51).

APPEND MODE

APPEND MODE       01  W-CONTADORES.

APPEND MODE           03  W-CONT-TIPO-5            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-6            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-7            PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-PJ         PIC 9(6) VALUE ZEROS.

APPEND MODE           03  W-CONT-TIPO-5-REP        PIC 9(6) VALUE ZEROS.

APPEND MODE

APPEND MODE       01  SUSCRIPTOR-AUX               PIC 9(06).            

APPEND MODE       01  REG-LEIDOS                   PIC 9(07) VALUE ZEROS.

APPEND MODE       01  CONT-FALLECIDOS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  REG-CORRECTOS-R              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-DIAN             PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-COINCIDE-REGIS            PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-DIAN               PIC 9(07) VALUE ZEROS.

APPEND MODE       01  NO-EXISTE-REGIS              PIC 9(07) VALUE ZEROS.

APPEND MODE       01  SI-EXISTE-CSV                PIC 9(07) VALUE ZEROS.

APPEND MODE       01  TIPO-ID-INVALIDO             PIC 9(07) VALUE ZEROS.

APPEND MODE       

APPEND MODE       01 MAS-DATOS.

APPEND MODE           03 I                         PIC 9(02) VALUE ZERO.

APPEND MODE           03 J                         PIC 9(02) VALUE ZERO.

APPEND MODE

APPEND MODE           COPY  BDLDIR.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con la la base BDIIALE de alertas online

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validación de nombres

APPEND MODE      ******************************************************************

APPEND MODE       copy LEEMAESTROS.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic x value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-editp100                    redefines N-edit

APPEND MODE                                        pic z(5)9.9B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(7).

APPEND MODE           03 N-demandas-terminadas     pic 9(7).

APPEND MODE           03 N-embargos-vigentes       pic 9(7).

APPEND MODE           03 N-embargos-terminados     pic 9(7).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo:

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos.

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50)

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE           03 pic x(11) value "17 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Modificación de alerta inexistente".

APPEND MODE           03 pic x(11) value "18 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Eliminación de alerta inexistente".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(300).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE      *    4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE      *    4240-CONTAR-TIPO-CUENTA

APPEND MODE      *    4210-VALIDACION-ID-NO-FIGURA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4800-PROCESO-REG-T

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1000-NOT-USED

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE      *    9800-FILTRAR-ALFABETICO

APPEND MODE     

APPEND MODE     

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      D    display "0000-PROGRAMA-PRINCIPAL"

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      D    display "4000-PROCESAR-REGISTRO"

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      D        display " "

APPEND MODE      D        display " "

APPEND MODE      D        display JURAD-reg

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE               add 1 to REG-LEIDOS

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      D    display "4000-PROCESAR-REGISTRO-2"

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T"

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que señalar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T"

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           move 0 to codigo-error

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE*******        perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           perform 4240-CONTAR-TIPO-CUENTA

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      D    display "4100-VALIDACION-FORMAL"

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE               move 05 to codigo-error

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      D    display "4200-VALIDACION-SEMANTICA"

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE

APPEND MODE           move JURAD-id-tipo to TIPOID-E

APPEND MODE           move JURAD-id-numero to NUMID-E

APPEND MODE           move JURAD-nombre to NOMBRE-E

APPEND MODE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           IF TIP-IDE-BDIIVIDE = 2 OR 3

APPEND MODE               MOVE 1 TO SW-DIGCHEQUEO-BDIIVIDE

APPEND MODE           END-IF

APPEND MODE           MOVE 2 TO NUM-BLOQUES-BDIIVIDE

APPEND MODE      *    Valida el numero de identificación contra las bases de

APPEND MODE      *    datos BDIIDIAN, BDIIDAS, BDIIREGI y verifica la coincidencia

APPEND MODE      *    del nombre reportado

APPEND MODE      *    Retorna SW-ID-BDIIVIDE=1 si hay error

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE      *        es un id inválido

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE      *        valida contra la base alterna

APPEND MODE               perform 4210-VALIDACION-ID-NO-FIGURA

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE      *            validación en base alterna

APPEND MODE                   perform 4220-VALIDA-NOMBRE-NO-COINCIDE

APPEND MODE               else

APPEND MODE                   perform 4222-VALIDA-NOMBRE-COINCIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4220-VALIDA-NOMBRE-NO-COINCIDE.

APPEND MODE      D    display "4220-VALIDA-NOMBRE-NO-COINCIDE"

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre no coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre no coincide

APPEND MODE           IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *        es una cédula

APPEND MODE               MOVE 02 TO CODIGO-ERROR

APPEND MODE           ELSE

APPEND MODE      *        no es una cédula

APPEND MODE               MOVE 01 TO CODIGO-ERROR

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4222-VALIDA-NOMBRE-COINCIDE.

APPEND MODE      D    display "4222-VALIDA-NOMBRE-COINCIDE"

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que figuran OK pero el nombre coincide

APPEND MODE      ******************************************************************

APPEND MODE      *    nombre coincide: busca ID en BDIIALE

APPEND MODE           initialize LLAVE-BDIIALE

APPEND MODE           move TIP-IDE-BDIIVIDE to TIP-IDE-BDIIALE

APPEND MODE           move NUM-IDE-BDIIVIDE-R to NUM-IDE-BDIIALE

APPEND MODE           move 990003 to FUENTE-BDIIALE

APPEND MODE           start BDIIALE key not < LLAVE-BDIIALE INVALID KEY

APPEND MODE               move 1 TO SW-BDIIALE

APPEND MODE           not invalid key

APPEND MODE               move 0 to SW-BDIIALE

APPEND MODE               read BDIIALE next record

APPEND MODE               at end

APPEND MODE                   move 1 to SW-BDIIALE

APPEND MODE               end-read

APPEND MODE           end-start

APPEND MODE

APPEND MODE           perform until SW-BDIIALE = 1

APPEND MODE           or TIP-IDE-BDIIVIDE <> TIP-IDE-BDIIALE

APPEND MODE           or NUM-IDE-BDIIVIDE <> NUM-IDE-BDIIALE

APPEND MODE               if FUENTE-BDIIALE = 990003

APPEND MODE               and FEC-NOV-BDIIALE <= P-fecha-proceso-YYYYMMDD

APPEND MODE               and FEC-VEN-BDIIALE >= P-fecha-proceso-YYYYMMDD

APPEND MODE               and BLOQUEO-BDIIALE = 0

APPEND MODE      *             encontrado

APPEND MODE                    move 1 to SW-BDIIALE

APPEND MODE               end-if

APPEND MODE               if SW-BDIIALE = 0

APPEND MODE                   read BDIIALE next record at end

APPEND MODE                       move 1 to SW-BDIIALE

APPEND MODE                   end-read

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE           if TIP-IDE-BDIIVIDE = 1

APPEND MODE               if ESTADO-VIG-BDIIREGI = 12 and W-DERECHOS = 1

APPEND MODE                   move 07 to CODIGO-ERROR

APPEND MODE               else

APPEND MODE                   if ESTADO-VIG-BDIIREGI = 21

APPEND MODE                       move 06 to CODIGO-ERROR

APPEND MODE                       add 1 to NO-COINCIDE-REGIS

APPEND MODE                       add 1 to CONT-FALLECIDOS

APPEND MODE                   end-if

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4240-CONTAR-TIPO-CUENTA.

APPEND MODE      D    display "4240-CONTAR-TIPO-CUENTA"

APPEND MODE      ******************************************************************

APPEND MODE      *    Conteo de los registros por "tipo", dependiendo del código

APPEND MODE      *    de error:

APPEND MODE      *    00=OK

APPEND MODE      *    01=NIT OK, nombre no coincide

APPEND MODE      *    02=cédula OK, nombre no coincide

APPEND MODE      *    03=NIT no figura

APPEND MODE      *    04=cédula no figura pero está en base alterna

APPEND MODE      *    05=tipo id no es 1|2|3|4

APPEND MODE      *    06=cédula ... ESTADO-VIG-BDIIREGI = 21

APPEND MODE      *    07=cédula ... ESTADO-VIG-BDIIREGI = 12

APPEND MODE      *

APPEND MODE      *    cuenta tipo 5: sin error

APPEND MODE      *    cuenta tipo 6: 01 02 06 07

APPEND MODE      *    cuenta tipo 7: 03 04 05

APPEND MODE      ******************************************************************

APPEND MODE           IF CODIGO-ERROR = 01 OR 02 OR 06 OR 07

APPEND MODE               ADD 1 TO W-CONT-TIPO-6

APPEND MODE           ELSE

APPEND MODE               IF CODIGO-ERROR = 03 OR 04 OR 05

APPEND MODE                   ADD 1 TO W-CONT-TIPO-7

APPEND MODE               ELSE

APPEND MODE      *            registros correctos, repetidos o no

APPEND MODE                   ADD 1 TO W-CONT-TIPO-5

APPEND MODE      *            si es una empresa

APPEND MODE                   IF TIPOID-E = 2 OR 3

APPEND MODE                       ADD 1 TO W-CONT-TIPO-5-PJ

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4210-VALIDACION-ID-NO-FIGURA.

APPEND MODE      D    display "4210-VALIDACION-ID-NO-FIGURA"

APPEND MODE      ******************************************************************

APPEND MODE      * Validación de IDs que no figuran en las bases normales

APPEND MODE      ******************************************************************

APPEND MODE           MOVE 0 TO HACER-MATCH

APPEND MODE           MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE      *    valida si la identificación está en la base de datos alterna

APPEND MODE           PERFORM 513-VALIDA-EN-CSV

APPEND MODE           IF IDE-TIPO-BDAMATCH = 0

APPEND MODE               IF TIP-IDE-BDIIVIDE = 1

APPEND MODE      *            es una cédula

APPEND MODE                   MOVE 04 TO CODIGO-ERROR

APPEND MODE               else

APPEND MODE      *            no es una cédula

APPEND MODE                   MOVE 03 TO CODIGO-ERROR

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones,

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-DATOS"

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-I"

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-M"

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "17" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      D    display "4300-MODIFICAR-BDIIALE-E"

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE               call "PONERR" using "18" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      D    display "4333-LEER-BDIIALE-RANDOM"

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE      *    " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      D    display "4333-GRABAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      D    display "4333-REGRABAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      D    display "4333-ELIMINAR-BDIIALE"

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      D    display "4800-PROCESO-REG-T"

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      D    display "4900-GRABAR-ERROR"

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      D    display "4320-ARMAR-TEXTO-ALERTA"

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      D    display "1000-RUTINA-INICIAL"

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      *   - carga en memoria de los IDs de inconsistentes

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser 1 o 2

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      D    display "1000-NOT-USED"

APPEND MODE      ******************************************************************

APPEND MODE      * Aunque tengo instrucciones de dejar los textos de alertas en

APPEND MODE      * blanco, me parece que se deberían cargar, aunque sea de manera

APPEND MODE      * precaria, por si justo cae una consulta para uno de los IDs

APPEND MODE      * involucrados. La persona que consulta va a ver <spaces>, hasta

APPEND MODE      * que se ejecute el programa que genera los textos.

APPEND MODE      ******************************************************************

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      D    display "1001-ELIMINAR-TODO"

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE      *    display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      D    display "7000-RUTINA-FINAL"

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE      * $$$$ se agregaron varios archivos más

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           display " "

APPEND MODE      * Totales tipo PESVNO

APPEND MODE           DISPLAY "REGISTROS LEIDOS                :" REG-LEIDOS

APPEND MODE           DISPLAY "REGISTROS CORRECTOS             :" REG-CORRECTOS

APPEND MODE           DISPLAY "REGISTROS CORRECTOS REPETIDOS   :" REG-CORRECTOS-R

APPEND MODE           DISPLAY "REGISTROS NO COINCIDEN BDIIREGI :" NO-COINCIDE-REGIS

APPEND MODE           DISPLAY "  REGISTROS DE FALLECIDOS         :" CONT-FALLECIDOS

APPEND MODE           DISPLAY "REGISTROS NO COINCIDEN BDIIDIAN :" NO-COINCIDE-DIAN

APPEND MODE           DISPLAY "REGISTROS NO EXISTEN   BDIIREGI :" NO-EXISTE-REGIS

APPEND MODE           DISPLAY "REGISTROS NO EXISTEN   BDIIDIAN :" NO-EXISTE-DIAN

APPEND MODE           DISPLAY "TIPO IDENTIFICACION INVALIDO    :" TIPO-ID-INVALIDO

APPEND MODE           display " "

APPEND MODE      *    porcentaje registros procesados OK

APPEND MODE           compute N-editp100 rounded = 100.0 * N-reg-OK / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros correctos"

APPEND MODE      *    porcentaje registros inconsistentes

APPEND MODE           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error

APPEND MODE           / N-reg-leidos

APPEND MODE           display N-editp100 "% de registros inconsistentes"

APPEND MODE      *    cantidad de registros leídos (excluído el registro "T")

APPEND MODE           move N-reg-leidos to N-edit

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE      *    cantidad de registros procesados sin error

APPEND MODE           move N-reg-OK to N-edit

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE      *    cantidad de registros con error

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit

APPEND MODE           display N-edit "Registros con error"

APPEND MODE      *    cantidades de alertas afectadas

APPEND MODE           if P-tipo-proceso = "04"

APPEND MODE               move N-ale-borradas to N-edit

APPEND MODE               display N-edit

APPEND MODE               "Alertas borradas previo al refresque total"

APPEND MODE           end-if

APPEND MODE           move N-ale-insertadas to N-edit

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      D    display "9000-CANCELAR-PROGRAMA"

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE       513-VALIDA-EN-CSV.

APPEND MODE      D    display "513-VALIDA-EN-CSV"

APPEND MODE      D    display "TIPOID-E:" TIPOID-E " NUMID-E:" NUMID-E 

APPEND MODE      **************************************************************

APPEND MODE      * Valida si la identificación está en la base de datos alterna

APPEND MODE      **************************************************************

APPEND MODE      *    hace validacion de tipo de identificacion

APPEND MODE           MOVE TIPOID-E TO TIP-IDE-BDIIVIDE

APPEND MODE           MOVE NUMID-E TO NUM-IDE-BDIIVIDE

APPEND MODE      *    retorna SW-TID-BDIIVIDE=0 si el num id no está dentro

APPEND MODE      *    del rango que corresponde al tipo de id

APPEND MODE           display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE

APPEND MODE           " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE

APPEND MODE           " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE

APPEND MODE           PERFORM 80400-VALIDAR-TIPO-ID

APPEND MODE           display "SALIDA-BDIIVIDE " " SW-ID:" SW-ID-BDIIVIDE

APPEND MODE           " SW-NOMBRES:" SW-NOMBRES-BDIIVIDE

APPEND MODE           " SW-TID:" SW-TID-BDIIVIDE " NOM-VAL:" NOM-VAL-BDIIVIDE

APPEND MODE           IF SW-TID-BDIIVIDE = 0

APPEND MODE      *        el tipo de id es OK

APPEND MODE      D        display "el n° de ID está dentro de su rango"

APPEND MODE               IF HACER-MATCH = ZEROS

APPEND MODE      *            abre archivos y carga la tabla de direcciones 

APPEND MODE      *            estandar, solo la primera vez

APPEND MODE                   IF OPEN-DIR = ZEROS

APPEND MODE      D                display "carga tabla DIRESTAN"

APPEND MODE                       OPEN INPUT MAESTRO-DIRECC

APPEND MODE                       OPEN INPUT BDLCLI

APPEND MODE                       OPEN INPUT SUSCRIPTOR

APPEND MODE                       OPEN INPUT MAESTRO-CREDIT

APPEND MODE                       OPEN INPUT MAESTRO-CHECK

APPEND MODE                       PERFORM 06000-U-CARGAR-TABLA-DIRESTAN

APPEND MODE                       MOVE 1 TO OPEN-DIR

APPEND MODE                   END-IF

APPEND MODE      *            abre archivos y carga la tabla de direcciones 

APPEND MODE                   MOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCH

APPEND MODE                   MOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH

APPEND MODE      *            Se recorre toda la estructura bdacsv para la identificacion

APPEND MODE      *            buscada. En caso de hallar registros se procede a realizar el

APPEND MODE      *            match

APPEND MODE      D            display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH

APPEND MODE      D            " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH

APPEND MODE      D            " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH

APPEND MODE      D            " MAX-CUENTAS-BDAMATCH:" MAX-CUENTAS

APPEND MODE                   PERFORM 1000-U-RECORRER-CSV-BDAMATCH

APPEND MODE      D            display "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH

APPEND MODE      D            " NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH

APPEND MODE      D            " NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH

APPEND MODE      D            " MAX-CUENTAS-BDAMATCH:" MAX-CUENTAS

APPEND MODE                   MOVE 1 TO HACERMATCH-LEEMSTRS

APPEND MODE                   IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                       IF TIPOID-E = 1 OR 4

APPEND MODE                           INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL

APPEND MODE                           "," BY " ", ";" BY " "

APPEND MODE                       END-IF

APPEND MODE                       MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOM

APPEND MODE                       MOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOM

APPEND MODE                       MOVE TIPOID-E TO  TIP-ID-INPUT-VALNOM

APPEND MODE                       MOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOM

APPEND MODE                       PERFORM 10000-MATCH-NOMBRES-VALNOM

APPEND MODE      D                display "10000-MATCH-NOMBRES-VALNOM"

APPEND MODE      D                display "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM

APPEND MODE      D                " " NOM-OUTPUT-BDAMATCH

APPEND MODE                       IF MATCH-OK-OUT-VALNOM = 1

APPEND MODE                           MOVE 1 TO IDE-TIPO-BDAMATCH

APPEND MODE                       ELSE

APPEND MODE                          IF W-BLOQUES > 0

APPEND MODE                              MOVE 0 TO IDE-TIPO-BDAMATCH

APPEND MODE                          END-IF

APPEND MODE                       END-IF

APPEND MODE                   END-IF

APPEND MODE     

APPEND MODE                   IF IDE-TIPO-BDAMATCH = 1

APPEND MODE                       MOVE TIPOID-E TO TIP-VAL

APPEND MODE                       MOVE NUMID-E TO CED-VAL

APPEND MODE                       MOVE NOM-OUTPUT-BDAMATCH TO CADENA-ENTRA

APPEND MODE                       PERFORM 9800-FILTRAR-ALFABETICO

APPEND MODE                       MOVE CADENA-SALE TO  NOM-VAL

APPEND MODE                       MOVE ZEROS TO FEC-EXP-VAL

APPEND MODE                       MOVE SPACES TO MUN-EXP-VAL

APPEND MODE                       MOVE SPACES TO DEP-EXP-VAL

APPEND MODE                       MOVE SPACES TO VIG-VAL

APPEND MODE                       MOVE SPACES TO GENERO-VAL

APPEND MODE                       MOVE SPACES TO EDAD-VAL

APPEND MODE                       MOVE SPACES TO EDAD-RANGO

APPEND MODE                       ADD 1 TO SI-EXISTE-CSV

APPEND MODE                   END-IF

APPEND MODE               END-IF

APPEND MODE           END-IF.

APPEND MODE

APPEND MODE       9800-FILTRAR-ALFABETICO.

APPEND MODE      D    display "9800-FILTRAR-ALFABETICO"

APPEND MODE      ******************************************************************

APPEND MODE      * SE ELIMINAN CARACTERES NO ALFABETICOS A LA CADENA DE ENTRADA

APPEND MODE      ******************************************************************

APPEND MODE           MOVE FUNCTION UPPER-CASE (CADENA-ENTRA) TO CADENA-ENTRA

APPEND MODE           INITIALIZE CADENA-SALE

APPEND MODE           MOVE 1 TO J

APPEND MODE           PERFORM VARYING I FROM 1 BY 1 UNTIL I > 60

APPEND MODE              MOVE CADENA-ENTRA (I:1) TO IND-ALFABETICO

APPEND MODE              IF SI-ALFABETICO

APPEND MODE                 MOVE CADENA-ENTRA (I:1) TO CADENA-SALE (J:1)

APPEND MODE                 ADD 1 TO J

APPEND MODE              END-IF

APPEND MODE           END-PERFORM.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE           copy BDLDIR.PROC.

APPEND MODE           COPY LEEMAESTROS.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR.CBL" 1736 lines, 74034 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>fgvi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/temporales>des-c-v CARGAJUR                          /d/iccol/desarrollo/temporales>
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     3
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1429468     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/temporales>vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" [New file] 
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"CARGAJUR.CBL.err" [New file]:q/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fuvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     3
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     1429468     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR.CBL.err


/d/iccol/desarrollo/fuentes>vi ^[  /d/iccol/desarrollo/fuentes>vi des-c-v CARGAJURfu              vi CARGAJUR.CBL.err
"CARGAJUR.CBL.err" 11 lines, 1143 characters * Rejected - OPT
  4270D" MAX-CUENTAS-BDAMATCH:" MAX-CUENTAS1572
*  12-S************************************************(   0)**1573
**    Operand MAX-CUENTAS is not declared1573
  4275D" MAX-CUENTAS-BDAMATCH:" MAX-CUENTAS1577
*  12-S************************************************(  75)**1578
**    Operand MAX-CUENTAS is not declared1578
  4288Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM1590
*  12-S****************************************************************(  75)**1591
**    Operand MATCH-OK-OUT-VALNO is not declared1591
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"CARGAJUR.CBL.err" 11 lines, 1143 characters:q/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR.******************************************************************
******************************************************************

Ddisplay "carga tabla DIRESTAN"OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOR
OPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECK
PERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el
*match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS-BDAMATCH:" MAX-CUENTASPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS-BDAMATCH:" MAX-CUENTASMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM
Ddisplay "10000-MATCH-NOMBRES-VALNOM"
Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM
D" " NOM-OUTPUT-BDAMATCH
IF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHELSE
IF W-BLOQUES > 0
MOVE 0 TO IDE-TIPO-BDAMATCHEND-IF
END-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
MOVE TIPOID-E TO TIP-VALS-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCH
MOVE TIPOID-E TO TIP-VAL






    
    








D:w"CARGAJUR.CBL" 1736 lines, 74033 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgvi CARGAJUR.CBL.errdes-c-v CARGAJUR   
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
".............COMPILANDO ICBDIR SIN STATUS.........."
".............COMPILANDO ICBSUS SIN STATUS.........."
".............COMPILANDO BDLDIR SIN MATCH **********
"........COMPILANDO LEEMAESTROS SIN MATCH **********
"...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
* Total Messages:     0
* Data:     1430192     Code:       92305
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:   1429432  Code:    107812  Literals:      3712  Dynamic:   2490368

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg              vi CARGAJUR.CBL.errdes-c-v CARGAJUR   fu              vi CARGAJUR.CBL.errdes-c-v CARGAJUR   fg              vi qqx CARGAJUR 9999991000905140104.txt 2 >| qq/d/iccol/desarrollo/fuentes>

real    0m0.04s
user    0m0.01s
sys     0m0.02s
/d/iccol/desarrollo/fuentes>vi qq
"qq" 562 lines, 20270 characters 0000-PROGRAMA-PRINCIPAL
1000-RUTINA-INICIAL
Parametros: 9999991000905140104.txt 2
CARGAJUR   Carga de archivo JURAD - proceso en falso
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
4000-PROCESAR-REGISTRO


I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000149123
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
carga tabla DIRESTAN
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:    NUM-CTAS-OUTPUT:    MAX-CUENTAS:00005
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

Iz00000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411
Error 02 Tipo de identificacion invalido, debe ser 1 2 3 4
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135"qq" 562 lines, 20270 characters513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000958212
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001
Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002
Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I100002859753ERNESTO RICO0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100002859753ERNESTO RICO0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000262135
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:1 NUMID-E:00000958212
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J001
Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
Datos en la alerta: 000040000320201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100002249789999999000J002
Registro de input:
I100002249789JOAQUIN VARGAS CABALLERO0040032012040601104320440406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I100002859753ERNESTO RICO0050672013040602206720100435
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100002859753ERNESTO RICO0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I100003295380HENRY REY BARBOSA0080452013011123200220110506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J001
Registro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220110506
Datos en la alerta: 000080004520201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 100003295380999999000J002
Registro de input:
I100003295380HENRY REY BARBOSA0080452013011123200220110506
Datos en la alerta: 002320000220201105
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J001
Registro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
Datos en la alerta: 000220004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800002194999999000J002
Registro de input:
I200800002194SERVICULTIVOS LTDA0220452012040603404520120406
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J001
Registro de input:
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
Datos en la alerta: 000330002020200004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200800178009999999000J002
Registro de input:
I200800178009CALZADO ORION DEL LITORAL0330202000040601505420140106
Datos en la alerta: 000150005420201401
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I200811046741SALUD AXIAL LTDA0440761998406903400219990101
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL4100-VALIDACION-FORMAL

I200811046741SALUD AXIAL LTDA0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I200830067928C I GLOMA S A0110432044040601203220100406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J001
Registro de input:
I200830067928C I GLOMA S A0110432044040601203220100406
Datos en la alerta: 000110004320204404
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200830067928999999000J002
Registro de input:
I200830067928C I GLOMA S A0110432044040601203220100406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I200860024151COMPUTEC SA0330332011140604500120110402
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200860024151COMPUTEC SA0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rangoI200860024151COMPUTEC SA0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J001
Registro de input:
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
Datos en la alerta: 000450000020201008
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890934264999999000J002
Registro de input:
I200890934264SUBSUELO Y GEOTECNIA LTDA0450002010080600204420130506
Datos en la alerta: 000020004420201305
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J001
Registro de input:
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
Datos en la alerta: 000340004520201204
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 200890107487999999000J002
Registro de input:
I200890107487SUPERTIENDAS Y DROGUERIAS OL0340452012040600300620130106
Datos en la alerta: 000030000620201301
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I300600003115xxxxxx0150542014010600400320120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I300600003115xxxxxx0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado
novedad:  xxxxxx
registro: FERNANDEZ PENA JULIO ANTONIO
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J001
Registro de input:
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
Datos en la alerta: 000340000220199901
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 300611000446999999000J002
Registro de input:
I300611000446ANTONIO CONDOLUCI DOMINGO0340021999010100506720130406
Datos en la alerta: 000050006720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J001
Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
Datos en la alerta: 000120003220201004
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000163597999999000J002
Registro de input:
I400000163597MARWA MIKHAEL SKAFF DE KARAA0120322010040600604520110406
Datos en la alerta: 000060004520201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO4000-PROCESAR-REGISTRO


I400000266423SIMONE MARTINEZ033002201312060070rt20110106
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL

I400000266423SIMONE MARTINEZ033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico
4900-GRABAR-ERROR
4000-PROCESAR-REGISTRO


I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro
4210-VALIDACION-ID-NO-FIGURA
513-VALIDA-EN-CSV
TIPOID-E:4 NUMID-E:00000244359
SALIDA-BDIIVIDE  SW-ID:1 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

SALIDA-BDIIVIDE  SW-ID:0 SW-NOMBRES:0 SW-TID:0 NOM-VAL:

el n° de ID está dentro de su rango
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
BDAMATCH: IDE-TIPO:0 NUM-MUERTOS-OUTPUT:000 NUM-CTAS-OUTPUT:000 MAX-CUENTAS:00000
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


I400000136711ARIAS NILO RIESCO0110232011041100905720130411
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA
4222-VALIDA-NOMBRE-COINCIDE
4240-CONTAR-TIPO-CUENTA
4300-MODIFICAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J001
Registro de input:
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
Datos en la alerta: 000110002320201104
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS4333-REGRABAR-BDIIALE
4300-MODIFICAR-BDIIALE-DATOS
4333-LEER-BDIIALE-RANDOM
4300-MODIFICAR-BDIIALE-I
Insercion de alerta nueva que ya existe  key: 400000136711999999000J002
Registro de input:
I400000136711ARIAS NILO RIESCO0110232011041100905720130411
Datos en la alerta: 000090005720201304
4320-ARMAR-TEXTO-ALERTA
4333-REGRABAR-BDIIALE
4000-PROCESAR-REGISTRO


I400000163598xxxxxx0330432013101002204520120406
4000-PROCESAR-REGISTRO-2
4100-VALIDACION-FORMAL
4200-VALIDACION-SEMANTICA

I400000163598xxxxxx0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado
novedad:  xxxxxx
registro: KARAN  ABBOUD NAJAH
4220-VALIDA-NOMBRE-NO-COINCIDE
4900-GRABAR-ERROR
4240-CONTAR-TIPO-CUENTA
4000-PROCESAR-REGISTRO


T 00000000028772774787861
4000-PROCESAR-REGISTRO-2
4800-PROCESO-REG-T
7000-RUTINA-FINAL
Fecha de proceso: 20140104

Totales de registros:

REGISTROS LEIDOS:0000029
REGISTROS CORRECTOS:0000000
REGISTROS CORRECTOS REPETIDOS   :0000000
REGISTROS NO COINCIDEN BDIIREGI :0000001
  REGISTROS DE FALLECIDOS:0000001
REGISTROS NO COINCIDEN BDIIDIAN :0000000
REGISTROS NO EXISTEN   BDIIREGI :0000000
REGISTROS NO EXISTEN   BDIIDIAN :0000000
TIPO IDENTIFICACION INVALIDO    :000000035.7 % de registros correctos
    64.3 % de registros inconsistentes
28 Registros IME en el archivo de entrada
10 Registros procesados sin error
18 Registros con error
Alertas borradas previo al refresque total:q/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR.CBL
Ddisplay "carga tabla DIRESTAN"OPEN INPUT MAESTRO-DIRECCOPEN INPUT BDLCLI
OPEN INPUT SUSCRIPTOR
OPEN INPUT MAESTRO-CREDITOPEN INPUT MAESTRO-CHECK
PERFORM 06000-U-CARGAR-TABLA-DIRESTANMOVE 1 TO OPEN-DIREND-IF
*abre archivos y carga la tabla de direccionesMOVE TIPOID-E TO TIP-IDE-INPUT-BDAMATCHMOVE NUMID-E  TO NUM-IDE-INPUT-BDAMATCH
*Se recorre toda la estructura bdacsv para la identificacion
*buscada. En caso de hallar registros se procede a realizar el
*match
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCHPERFORM 1000-U-RECORRER-CSV-BDAMATCH
Ddisplay "BDAMATCH: IDE-TIPO:" IDE-TIPO-BDAMATCH
D" NUM-MUERTOS-OUTPUT:" NUM-MUERTOS-OUTPUT-BDAMATCH
D" NUM-CTAS-OUTPUT:" NUM-CTAS-OUTPUT-BDAMATCH
D" MAX-CUENTAS:" MAX-CUENTAS-BDAMATCHMOVE 1 TO HACERMATCH-LEEMSTRSIF IDE-TIPO-BDAMATCH = 1
IF TIPOID-E = 1 OR 4
INSPECT NOM-OUTPUT-BDAMATCH REPLACING ALL"," BY " ", ";" BY " "END-IF
MOVE NOMBRE-E TO NOMBRE-INPUT-VALNOMMOVE NOM-OUTPUT-BDAMATCH TO NOMBOK-INPUT-VALNOMMOVE TIPOID-E TO  TIP-ID-INPUT-VALNOMMOVE NUM-BLOQUES-BDIIVIDE TO BLOQUES-INPUT-VALNOMPERFORM 10000-MATCH-NOMBRES-VALNOM
Ddisplay "10000-MATCH-NOMBRES-VALNOM"
Ddisplay "MATCH-OK-OUT-VALNOM:" MATCH-OK-OUT-VALNOM
D" " NOM-OUTPUT-BDAMATCH
IF MATCH-OK-OUT-VALNOM = 1
MOVE 1 TO IDE-TIPO-BDAMATCHELSE
IF W-BLOQUES > 0
MOVE 0 TO IDE-TIPO-BDAMATCHEND-IF
END-IF
END-IF

IF IDE-TIPO-BDAMATCH = 1
MOVE TIPOID-E TO TIP-VAL"CARGAJUR.CBL" line 1590 of 1736 --91%-- /d/iccol/desarrollo/fuentes>^D
