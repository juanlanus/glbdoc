=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.22 08:49:21 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Wed May 21 13:16:59 2014 from 172.16.10.103
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>. visetfg     sh-CARGAJUR2echo $f     o $fg  fg   sh-CARGAJUR2fg          sh-CARGAJUR2fg          tail $TEMPORALES"/"$f/d/iccol/desarrollo>f=9999991000905140104.txt/d/iccol/desarrollo>tail $TEMPORALES"/"$f    /d/iccol/desarrollo>f=9999991000905140104.txt/d/iccol/desarrollo>echo $f                  /d/iccol/desarrollo>ech $f tail /d/iccol/desarrollo/temporales/9999991000905140104.t>/d/iccol/desarrollo>cat /d/iccol/desarrollo/temporales/9999991000905140104.tx/d/iccol/desarrollo>l $TEMPORALES/99999*                                      /d/iccol/desarrollo>l $TEMPORALES/99999 cat $TEMPORALES"/"$fecho $f             f=9999991990905140104.txt/d/iccol/desarrollo>echo $fff                /d/iccol/desarrollo>sh-CARGAJUR2sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2clear       fg   sh-CARGAJUR2fg          sh-CARGAJUR2sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          1 sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo>fg                                        /d/iccol/desarrollo>vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo>fg                                        /d/iccol/desarrollo>fgecho $qq=`echo $fff | grep XX.txt`/d/iccol/desarrollo>echo $q                    /d/iccol/desarrollo>q=`echo $fff | grep XX.txz`/d/iccol/desarrollo>echo $fff | grep XX.txz    /d/iccol/desarrollo>echo $fff | grep XX.txt/d/iccol/desarrollo>echo $fff              /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>
ksh: $fff:  not found
/d/iccol/desarrollo>fff="9999990010104.txt^[[D  /d/iccol/desarrollo>fff="9999990010104.txt        
> "
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fff="999999001^J"q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>
ksh: $fff:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>fff="999999001^J"                         /d/iccol/desarrollo>
/d/iccol/desarrollo>fff="9999990011205140104.txt"
/d/iccol/desarrollo>echo $fff
9999990011205140104.txt
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>echo $ffffff="9999990011205140104.txt"/d/iccol/desarrollo>fff="999999001^J"            /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>
ksh: $fff:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'` /d/iccol/desarrollo>q=`$fff | sed 's/.*\\(..\\)\\.txt/\\1/'` /d/iccol/desarrollo>q=`$fff
ksh: 9999990011205140104.txt:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>q=`$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`""$fff"
ksh: 9999990011205140104.txt:  not found
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>q=`"$fff" | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`  /d/iccol/desarrollo>q=`e$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`ec$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`ech$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`echo$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`echo $fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`echo 
/d/iccol/desarrollo>echo $q
04
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>echo $qq=`echo $fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`"$fff" | sed 's/.*\\(..\\)\\.txt/\\1/'`   /d/iccol/desarrollo>q=`$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`  /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>echo $fff                                 /d/iccol/desarrollo>fff="9999990011205140104.txt"/d/iccol/desarrollo>fff="999999001^J"            /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>fff="999999001^J"                         /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>. viset                                   /d/iccol/desarrollo>fg     sh-CARGAJUR2echo $f     o $fg  fg   sh-CARGAJUR2fg          sh-CARGAJUR2fg          tail $TEMPORALES"/"$f/d/iccol/desarrollo>f=9999991000905140104.txt/d/iccol/desarrollo>echo $f                  /d/iccol/desarrollo>ech $f tail /d/iccol/desarrollo/temporales/9999991000905140104.t>/d/iccol/desarrollo>cat /d/iccol/desarrollo/temporales/9999991000905140104.tx/d/iccol/desarrollo>l $TEMPORALES/99999*                                      /d/iccol/desarrollo>l $TEMPORALES/99999 cat $TEMPORALES"/"$fecho $f             f=9999991990905140104.txt/d/iccol/desarrollo>echo $fff                /d/iccol/desarrollo>sh-CARGAJUR2sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2clear       fg   sh-CARGAJUR2fg          sh-CARGAJUR2sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          1 sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2fg          sh-CARGAJUR2vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo>fg                                        /d/iccol/desarrollo>vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo>
"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 222 lines, 7371 characters #sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 222 lines, 7371 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
222 lines deletedNo lines in bufferAPPEND MODE#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22

#**********************************************************


#ENTIDAD:      DATACREDITO                                *



#SHELL-ID:     sh-CARGAJUR                                *
#DATE-WRITTEN: MAY/2014                                   *
#AUTHOR:       GLOBANT                                    *
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO                  *
# Globant.   |                                                    *
#******************************************************************
#
#*========================================================*
#*          DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "                D A T A C R E D I T O"
    echo " "
    echo "              Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*

    echo

APPEND MODE    echo $raya

APPEND MODE    echo "              PROCESO REAL O EN FALSO"

APPEND MODE    echo $raya

APPEND MODE    P_REAL_FALSO="#";

APPEND MODE    endLoop=0

APPEND MODE    while [ $endLoop == 0 ]

APPEND MODE    do

APPEND MODE#             ---------------------------------------------------

APPEND MODE        echo " "

APPEND MODE        echo "        1) Proceso en falso"

APPEND MODE        echo " "

APPEND MODE        echo "        2) Proceso real"

APPEND MODE        echo " "

APPEND MODE        echo "        3) Salir"

APPEND MODE        echo " "

APPEND MODE        echo "             opción (123)   ---> \c"

APPEND MODE        read P_REAL_FALSO 

APPEND MODE        if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO != "3" ] 

APPEND MODE        then

APPEND MODE            echo "\n\tlas opciones válidas son 1, 2 o 3"

APPEND MODE        else

APPEND MODE            endLoop=1

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEGetTipoDeProceso()

APPEND MODE{

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE    echo

APPEND MODE    echo $raya

APPEND MODE    echo "                  TIPO DE PROCESO"

APPEND MODE    echo $raya

APPEND MODE    endLoop=0

APPEND MODE    P_PROCESO="##"

APPEND MODE    while [ $endLoop == 0 ]

APPEND MODE    do

APPEND MODE#             ---------------------------------------------------

APPEND MODE        echo " "

APPEND MODE        echo "      01 Envio Original  - Carga TOTAL 1a vez"

APPEND MODE        echo " "

APPEND MODE        echo "      02 Archivo Semanal - Carga PARCIAL"

APPEND MODE        echo " "

APPEND MODE        echo "      03 Archivo Mensual - Carga PARCIAL"

APPEND MODE        echo " "

APPEND MODE        echo "      04 Refresque Total - Carga TOTAL"

APPEND MODE        echo " "

APPEND MODE        echo "      00 Salir"

APPEND MODE        echo " "

APPEND MODE        echo "           opción (01 02 03 04 00)   ---> \c"

APPEND MODE        read P_PROCESO

APPEND MODE        if [ -z "$P_PROCESO" ] 

APPEND MODE        then

APPEND MODE            echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"

APPEND MODE        else

APPEND MODE            if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO != "03" ] && [ $P_PROCESO 
!= "04" ] && [ $P_PROCESO != "00" ] 

APPEND MODE            then

APPEND MODE                echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"

APPEND MODE            else

APPEND MODE                endLoop=1

APPEND MODE            fi

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEGetNombreDelArchivo()

APPEND MODE{

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE# Averigua el nombre del archivo

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE    echo "                NOMBRE DEL ARCHIVO"

APPEND MODE    echo $raya

APPEND MODE    endLoop=0

APPEND MODE    while [ $endLoop == 0 ]

APPEND MODE    do

APPEND MODE#             ---------------------------------------------------

APPEND MODE        echo " "

APPEND MODE        echo " Ingrese el nombre del archivo o enter para salir:"

APPEND MODE        echo "      999999100ddmmaa01"$P_PROCESO".txt"

APPEND MODE#                   JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE        echo " ---> \c"

APPEND MODE        read P_NombreArchivo

APPEND MODE        if [ -z "$P_NombreArchivo" ]

APPEND MODE        then

APPEND MODE            endLoop=0

APPEND MODE        else

APPEND MODE            if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]

APPEND MODE            then

APPEND MODE                echo "no se encuentra el archivo " $P_NombreArchivo

APPEND MODE            else

APPEND MODE#               el tipo de proceso 01/02/03/04 está en el nombre del arch

APPEND MODE                auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`

APPEND MODE                echo auxTxt " debería ser 04.txt"

APPEND MODE                if [ $P_PROCESO".txt" != auxTxt ]

APPEND MODE                then

APPEND MODE                    echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESO

APPEND MODE                fi

APPEND MODE            fi

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODE

APPEND MODE#*========================================================*

APPEND MODE#*                    PROCESO                             *

APPEND MODE#*========================================================*

APPEND MODE#*              FASE 1: PIDE PARAMETROS                   *

APPEND MODE#*========================================================*

APPEND MODEecho "........................................."

APPEND MODEclear

APPEND MODEGetFechaSistema

APPEND MODEGetRealOFalso

APPEND MODEif [ $P_REAL_FALSO -eq 3 ]

APPEND MODEthen

APPEND MODE    exit

APPEND MODEfi

APPEND MODEGetTipoDeProceso

APPEND MODEif [ $P_PROCESO -eq 00 ]

APPEND MODEthen

APPEND MODE    exit

APPEND MODEfi

APPEND MODEGetNombreDelArchivo

APPEND MODEif [ -z "$P_NombreArchivo" ]

APPEND MODEthen

APPEND MODE    exit

APPEND MODEfi

APPEND MODE

APPEND MODE# echo (esto no está refactoreado)

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "

APPEND MODE# fechab=$P_FCORTE

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# numeroreg=`wc -l < $P_NombreArchivo archivo`

APPEND MODE# echo

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# echo "| Registros iniciales archivo de entrada : " $numeroreg

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# cadena00=$archivo.orig

APPEND MODE# cp $P_NombreArchivo $cadena00

APPEND MODE#echo "+-------------------------------------------------------------+"

APPEND MODE#echo "|                 SEGUNDA FASE: PROCESO                       |"

APPEND MODE#echo "+-------------------------------------------------------------+"

APPEND MODE    echo " "

APPEND MODE    echo $raya

APPEND MODE    echo " "

APPEND MODE    banner CARGAJUR

APPEND MODE    echo " "

APPEND MODE    echo $raya

APPEND MODE    echo " Procesando $TEMPORALES/'$P_NombreArchivo 

APPEND MODE    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO

APPEND MODE#   nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log

APPEND MODE#   activar programa CARGAJUR2!!!

APPEND MODE#   CARGAJUR2 dele user 1|2 para real o falso

APPEND MODE    echo $raya

APPEND MODE    echo "             RESULTADOS DEL PROCESO"

APPEND MODE    echo " "

APPEND MODE    cat $P_NombreArchivo.log 

APPEND MODE    echo " "

APPEND MODE    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log

APPEND MODE    ls -lrt $P_NombreArchivo*

APPEND MODE    echo $raya

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE

:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 222 lines, 7405 characters 
[1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo>echo $q                                   /d/iccol/desarrollo>q=`echo $fff | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>q=`"$fff" | sed 's/.*\\(..\\)\\.txt/\\1/'`   /d/iccol/desarrollo>q=`$fff | sed 's/.*\\(..\\)\\.txt/\\1/'`  /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>echo $fff                                 /d/iccol/desarrollo>fff="9999990011205140104.txt"/d/iccol/desarrollo>fff="999999001^J"            /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>fff="999999001^J"                         /d/iccol/desarrollo>q=`'$fff' | sed 's/.*\\(..\\)\\.txt/\\1/'`/d/iccol/desarrollo>. viset                                   /d/iccol/desarrollo>fg     sh-CARGAJUR2echo $f     sh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 06:59  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
auxTxt  debería ser 04.txt
El nombre del archivo no condice con el tipo de proceso 04
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> ^C
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
if [ -z "$P_NombreArchivo" ]
then
exit
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $TEMPORALES/'$P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO
#   nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" ]
then
endLoop=0
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del archauxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo auxTxt " debería ser 04.txt"if [ $P_PROCESO".txt" != auxTxt ]then
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]echo INSERT MODE$:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 222 lines, 7406 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:00  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
04  debería ser 04.txt
El nombre del archivo no condice con el tipo de proceso 04
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> ^C
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" ]
then
endLoop=0
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del archauxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo $auxTxt " debería ser 04.txt"if [ $P_PROCESO".txt" != auxTxt ]then
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]
:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 222 lines, 7400 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:02  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
04  debería ser 04.txt
El nombre del archivo no condice con el tipo de proceso 04
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> ^C
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" ]
then
endLoop=0
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del archauxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo $auxTxt " debería ser 04.txt"if [ $P_PROCESO != auxTxt ]then
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ] != INSERT MODE$ría ser$CHANGE MODE" $P_PROCESO:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 222 lines, 7405 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:04  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 99999910009050^H14^H       140104.txt
04  debería ser 04
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> ^C
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" ]
then
endLoop=0
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del archauxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo $auxTxt " debería ser" $P_PROCESOif [ $P_PROCESO != $auxTxt ]then
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]OPEN MODE       echo "-"$P_NombreArchivo"-"INSERT MODE :w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 223 lines, 7441 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:10  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
04  debería ser 04
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 
--
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> ^C
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
echo "-"$P_NombreArchivo"-"
if [ -z "$P_NombreArchivo" ]
then
endLoop=0
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del archauxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo $auxTxt " debería ser" $P_PROCESOif [ $P_PROCESO != $auxTxt ]then
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
 INSERT MODE-o "$P_NombreArchivo" == "" :w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 223 lines, 7469 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:12  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 0000000010905140104.txt
-0000000010905140104.txt-
no se encuentra el archivo  0000000010905140104.txt
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 
--
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> ^[[B  
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
echo "-"$P_NombreArchivo"-"
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=0
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del archauxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo $auxTxt " debería ser" $P_PROCESOif [ $P_PROCESO != $auxTxt ]then
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso

    REPLACE 1 CHAR1/endloopAddress search hit BOTTOM without matching pattern??/[ -" $CHANGE MODE]

    REPLACE 1 CHAR=

if [ $P_PROCESO != $auxTxt ]    if [ $P_PROCESO != $auxTxt ]
OPEN MODE                else $CHANGE MODEendLoop=0
 


OPEN MODE#               separa los dos caractares justo antes de la extensión ".txt"exit:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 225 lines, 7506 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:17  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
04  debería ser 04
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#*-----------------------------------------------------------------------------*echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`echo $auxTxt " debería ser" $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
endLoop=0
else
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exitREPLACE 1 CHAR1#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
225 lines deletedNo lines in bufferAPPEND MODE#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22

#**********************************************************


#ENTIDAD:      DATACREDITO                                *



#SHELL-ID:     sh-CARGAJUR                                *
#DATE-WRITTEN: MAY/2014                                   *
#AUTHOR:       GLOBANT                                    *
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO                  *
# Globant.   |                                                    *
#******************************************************************
#
#*========================================================*
#*          DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "                D A T A C R E D I T O"
    echo " "
    echo "              Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*

    echo

APPEND MODE    echo $raya

APPEND MODE    echo "              PROCESO REAL O EN FALSO"

APPEND MODE    echo $raya

APPEND MODE    P_REAL_FALSO="#";

APPEND MODE    endLoop=0

APPEND MODE    while [ $endLoop == 0 ]

APPEND MODE    do

APPEND MODE#             ---------------------------------------------------

APPEND MODE        echo " "

APPEND MODE        echo "        1) Proceso en falso"

APPEND MODE        echo " "

APPEND MODE        echo "        2) Proceso real"

APPEND MODE        echo " "

APPEND MODE        echo "        3) Salir"

APPEND MODE        echo " "

APPEND MODE        echo "             opción (123)   ---> \c"

APPEND MODE        read P_REAL_FALSO 

APPEND MODE        if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO != "3" ] 

APPEND MODE        then

APPEND MODE            echo "\n\tlas opciones válidas son 1, 2 o 3"

APPEND MODE        else

APPEND MODE            endLoop=1

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEGetTipoDeProceso()

APPEND MODE{

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE    echo

APPEND MODE    echo $raya

APPEND MODE    echo "                  TIPO DE PROCESO"

APPEND MODE    echo $raya

APPEND MODE    endLoop=0

APPEND MODE    P_PROCESO="##"

APPEND MODE    while [ $endLoop == 0 ]

APPEND MODE    do

APPEND MODE#             ---------------------------------------------------

APPEND MODE        echo " "

APPEND MODE        echo "      01 Envio Original  - Carga TOTAL 1a vez"

APPEND MODE        echo " "

APPEND MODE        echo "      02 Archivo Semanal - Carga PARCIAL"

APPEND MODE        echo " "

APPEND MODE        echo "      03 Archivo Mensual - Carga PARCIAL"

APPEND MODE        echo " "

APPEND MODE        echo "      04 Refresque Total - Carga TOTAL"

APPEND MODE        echo " "

APPEND MODE        echo "      00 Salir"

APPEND MODE        echo " "

APPEND MODE        echo "           opción (01 02 03 04 00)   ---> \c"

APPEND MODE        read P_PROCESO

APPEND MODE        if [ -z "$P_PROCESO" ] 

APPEND MODE        then

APPEND MODE            echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"

APPEND MODE        else

APPEND MODE            if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO != "03" ] && [ $P_PROCESO 
!= "04" ] && [ $P_PROCESO != "00" ] 

APPEND MODE            then

APPEND MODE                echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"

APPEND MODE            else

APPEND MODE                endLoop=1

APPEND MODE            fi

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODEGetNombreDelArchivo()

APPEND MODE{

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE# Averigua el nombre del archivo

APPEND MODE#*-----------------------------------------------------------------------------*

APPEND MODE    echo "                NOMBRE DEL ARCHIVO"

APPEND MODE    echo $raya

APPEND MODE    endLoop=0

APPEND MODE    while [ $endLoop == 0 ]

APPEND MODE    do

APPEND MODE#             ---------------------------------------------------

APPEND MODE        echo " "

APPEND MODE        echo " Ingrese el nombre del archivo o enter para salir:"

APPEND MODE        echo "      999999100ddmmaa01"$P_PROCESO".txt"

APPEND MODE#                   JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE        echo " ---> \c"

APPEND MODE        read P_NombreArchivo

APPEND MODE        echo "-"$P_NombreArchivo"-"

APPEND MODE        if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]

APPEND MODE        then

APPEND MODE            endLoop=1

APPEND MODE        else

APPEND MODE            if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]

APPEND MODE            then

APPEND MODE                echo "no se encuentra el archivo " $P_NombreArchivo

APPEND MODE            else

APPEND MODE#               el tipo de proceso 01/02/03/04 debe coincidir con el que

APPEND MODE#               está en el nombre del arch

APPEND MODE#               separa los dos caractares justo antes de la extensión ".txt"

APPEND MODE                auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`

APPEND MODE#               echo $auxTxt " debería ser " $P_PROCESO

APPEND MODE                if [ $P_PROCESO == $auxTxt ]

APPEND MODE                then

APPEND MODE#                   el código de suscriptor al principio del nombre del 

APPEND MODE#                   archivo debe ser el de JURAD

APPEND MODE                    auxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`

APPEND MODE                    echo $auxTxt " debería ser " $codsus

APPEND MODE                    if [ $codsus == $auxTxt ]

APPEND MODE                    then

APPEND MODE                        endLoop=1

APPEND MODE                    else

APPEND MODE                        echo "El código de suscriptor en el nombre del archivo no coincide"

APPEND MODE                    fi

APPEND MODE                else

APPEND MODE                    echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESO

APPEND MODE                fi

APPEND MODE            fi

APPEND MODE        fi

APPEND MODE    done

APPEND MODE}

APPEND MODE

APPEND MODE

APPEND MODE#*========================================================*

APPEND MODE#*                    PROCESO                             *

APPEND MODE#*========================================================*

APPEND MODE#*              FASE 1: PIDE PARAMETROS                   *

APPEND MODE#*========================================================*

APPEND MODEecho "........................................."

APPEND MODEclear

APPEND MODEGetFechaSistema

APPEND MODEGetRealOFalso

APPEND MODEif [ $P_REAL_FALSO -eq 3 ]

APPEND MODEthen

APPEND MODE    exit

APPEND MODEfi

APPEND MODEGetTipoDeProceso

APPEND MODEif [ $P_PROCESO -eq 00 ]

APPEND MODEthen

APPEND MODE    exit

APPEND MODEfi

APPEND MODEGetNombreDelArchivo

APPEND MODEif [ -z "$P_NombreArchivo" ]

APPEND MODEthen

APPEND MODE    exit

APPEND MODEfi

APPEND MODE

APPEND MODE# echo (esto no está refactoreado)

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "

APPEND MODE# fechab=$P_FCORTE

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# numeroreg=`wc -l < $P_NombreArchivo archivo`

APPEND MODE# echo

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# echo "| Registros iniciales archivo de entrada : " $numeroreg

APPEND MODE# echo "+-------------------------------------------------------------+"

APPEND MODE# cadena00=$archivo.orig

APPEND MODE# cp $P_NombreArchivo $cadena00

APPEND MODE#echo "+-------------------------------------------------------------+"

APPEND MODE#echo "|                 SEGUNDA FASE: PROCESO                       |"

APPEND MODE#echo "+-------------------------------------------------------------+"

APPEND MODE    echo " "

APPEND MODE    echo $raya

APPEND MODE    echo " "

APPEND MODE    banner CARGAJUR

APPEND MODE    echo " "

APPEND MODE    echo $raya

APPEND MODE    echo " Procesando $TEMPORALES/'$P_NombreArchivo 

APPEND MODE    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO

APPEND MODE#   nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log

APPEND MODE#   activar programa CARGAJUR2!!!

APPEND MODE#   CARGAJUR2 dele user 1|2 para real o falso

APPEND MODE    echo $raya

APPEND MODE    echo "             RESULTADOS DEL PROCESO"

APPEND MODE    echo " "

APPEND MODE    cat $P_NombreArchivo.log 

APPEND MODE    echo " "

APPEND MODE    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log

APPEND MODE    ls -lrt $P_NombreArchivo*

APPEND MODE    echo $raya

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE    echo " "

APPEND MODE

:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8115 characters 
[1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:24  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
999999  debería ser  999999
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando /d/iccol/desarrollo/temporales/'9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 
cat: cannot open 9999991000905140104.txt.log
 
9999991000905140104.txt*: No such file or directory
-rw-rw-r--   1 icjlud   icdatacr       0 May 22 07:25 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
if [ -z "$P_NombreArchivo" ]
then
exit
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $TEMPORALES/'$P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO
#   nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

/procesandoAddress search hit BOTTOM without matching pattern
?INSERT MODE':w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8116 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:26  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
999999  debería ser  999999
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando '/d/iccol/desarrollo/temporales/'9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 
 
-rw-rw-r--   1 icjlud   icdatacr      82 May 22 07:26 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
if [ -z "$P_NombreArchivo" ]
then
exit
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando '$TEMPORALES/'$P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO
#   nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " ""/d/iccol/desarrollo/macros/sh-CARGAJUR2" line 215 of 236 --91%-- echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
echo "-"$P_NombreArchivo"-"
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else
echo "El código de suscriptor en el nombre del archivo no coincide"fi
else
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]REPLACE 1 CHAR#fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando '$TEMPORALES/'$P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO
#   nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
echo " Procesando '
    
REPLACE 1 CHAR 
:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8102 characters :w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8102 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 07:38  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso en falso
El indicador de proceso real es invalido
debe ser S o N
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 07:39:13
Fin de Programa:     2014/05/22 07:39:13

 
-rw-rw-r--   1 icjlud   icdatacr     401 May 22 07:39 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_PROCESO
    nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~:q/d/iccol/desarrollo>fu
/d/iccol/desarrollo/fuentes>vi CARGAJUR2.CBL
"CARGAJUR2.CBL" 1312 lines, 55473 characters $SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************"CARGAJUR2.CBL" 1312 lines, 55473 characters
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1312 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING 

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR2.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(100).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con las alertas del sistema

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacion de nombres de VALNOM.PROC

APPEND MODE      ******************************************************************

APPEND MODE       copy VALNOM.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic xx value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX_ERRORES.txt

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(5).

APPEND MODE           03 N-demandas-terminadas     pic 9(5).

APPEND MODE           03 N-embargos-vigentes       pic 9(5).

APPEND MODE           03 N-embargos-terminados     pic 9(5).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un 

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5 

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo: 

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos. 

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50) 

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(100) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(100).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que senialar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T" 

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a " 

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones, 

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y 

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero 

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima 

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero 

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE 

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE           display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE           display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE           display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE           display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE 

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0 

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser SI|si|NO|no

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD 

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size 

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) "_ERRORES.txt"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1 

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE           display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               display "Va a comenzar la eliminación"

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE                           display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE      

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           move N-reg-leidos to N-edit 

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE           move N-reg-OK to N-edit 

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit 

APPEND MODE           display N-edit "Registros con error"

APPEND MODE           move N-ale-borradas to N-edit 

APPEND MODE           display N-edit "Alertas borradas previo al refresque total"

APPEND MODE           move N-ale-insertadas to N-edit 

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit 

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit 

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit 

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit 

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0 

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(100).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input(1:86) not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input(1:86)

APPEND MODE               move reg-input(1:86) to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < 99

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR2.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

APPEND MODE
~~~$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/procedure03pic xx.03pic x(100).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************
PROCEDURE DIVISION.
*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosPROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriorwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antesPROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriorwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antesPROCEDURE DIVISION.*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2
*    4100-VALIDACION-FORMAL
*    4200-VALIDACION-SEMANTICA
*    4300-MODIFICAR-BDIIALE
*    4300-MODIFICAR-BDIIALE-DATOS
*    4300-MODIFICAR-BDIIALE-I
*    4300-MODIFICAR-BDIIALE-M
*    4300-MODIFICAR-BDIIALE-E
*    4333-LEER-BDIIALE-RANDOM
*    4333-GRABAR-BDIIALE
*    4333-REGRABAR-BDIIALE
*    4333-ELIMINAR-BDIIALE
*    4900-GRABAR-ERROR
*    4320-ARMAR-TEXTO-ALERTA
*    1000-RUTINA-INICIAL
*    1001-ELIMINAR-TODO
*    7000-RUTINA-FINAL
*    9000-CANCELAR-PROGRAMA0000-PROGRAMA-PRINCIPAL.
******************************************************************
*    inicializa el ambiente y abre los archivosperform 1000-RUTINA-INICIAL
*    procesa cada uno de los registros del archivo JURAD hasta
*    encontrar el registro "T" de totalesperform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
*    cierra archivos y produce el reporte finalperform 7000-RUTINA-FINALgoback.4000-PROCESAR-REGISTRO.
****************************************************************
* Proceso de un registro del archivo de entrada JURAD
* Lectura y control del file status del archivo
****************************************************************
*    lectura del proximo registroread JURAD
evaluate JURAD-fswhen "00"
*controla el reg y lo aplica si es OKperform 4000-PROCESAR-REGISTRO-2move JURAD-reg to JURAD-reg-anteriorwhen "10"
*fin del archivo de input:
*esto es un error, no se encontro el registro "T" antes





/4300-/if JURAD-tipo-novedad = "T"move "SI" to IND-fin-procesoperform 4800-PROCESO-REG-Texit paragraphend-if

add 1 to N-reg-leidos*    validacion formal de los datosperform 4100-VALIDACION-FORMALif E-hay-error = "SI"perform 4900-GRABAR-ERRORexit paragraphend-if*    si la validacion formal dio OK se hace validacion semanticaperform 4200-VALIDACION-SEMANTICAif E-hay-error = "SI"perform 4900-GRABAR-ERRORexit paragraphend-if*    intento de actualizacion de BDIIALEperform 4300-MODIFICAR-BDIIALEadd 1 to N-reg-OK.4100-VALIDACION-FORMAL.
******************************************************************
* Validacion formal de los datos del input
******************************************************************
*    Tipo de identificacion Numero {1, 2, 3, 4}if JURAD-id-tipo not = "1" and "2" and "3" and "4"call "PONERR" using "02" JURAD-reg E-erroresend-if
*    Numero de identificacionif JURAD-id-numeroX is not numericcall "PONERR" using "03" JURAD-reg E-erroresend-if
if JURAD-id-numero not > 0call "PONERR" using "04" JURAD-reg E-erroresend-if
*    si el movimiento es una eliminacion los datos subsiguientes
*    no se controlanif JURAD-tipo-novedad = "E"exit paragraphend-if
*    Nombres y Apellidos/move JURAD-nombre to NOMBRE-BDIIVIDEmove 1 to SW-VERIFNOM-BDIIVIDEmove 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDEperform 80100-VALIDAR-IDENTIFICACION
*    a ver si la validacion cambio el tipo de ideif JURAD-id-tipo not = TIP-IDE-BDIIVIDEcall "PONERR" using "16" JURAD-reg E-erroresdisplay "Tipo ide cambiado de " JURAD-id-tipo " a "TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numeroend-if
*    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existeif SW-ID-BDIIVIDE = 1call "PONERR" using "14" JURAD-reg E-erroreselse
*existe id, a ver si el nombre coincideif SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincidecall "PONERR" using "15" JURAD-reg E-erroresdisplay "novedad:  " JURAD-nombredisplay "registro: " NOM-LEIDO-BDIIVIDEend-if
end-if.4300-MODIFICAR-BDIIALE.
******************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y
* embargos
******************************************************************initialize REG-BDIIALE*    si hay demandasif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALE
*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.*    si hay embargosif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALE
*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentes4300-MODIFICAR-BDIIALE.******************************************************************
* Se impacta el archivo BDIIALE con una o dos inserciones,
* modificaciones o eliminaciones segun haya o no demandas y
* embargos
******************************************************************initialize REG-BDIIALE*    si hay demandasif JURAD-demandas-vigentes > zeroor JURAD-demandas-terminadas > zeromove "J001" to LLASEC-BDIIALE
*arma datos de demandasmove JURAD-demandas-vigentes to D-vigentesmove JURAD-demandas-terminadas to D-terminadosstring "20" JURAD-demandas-fecha-ultimadelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.*    si hay embargosif JURAD-embargos-vigentes > zeroor JURAD-embargos-terminados > zeromove "J002" to LLASEC-BDIIALE
*arma datos de embargosmove JURAD-embargos-vigentes to D-vigentesmove JURAD-embargos-terminados to D-terminadosstring "20" JURAD-embargos-fecha-ultimodelimited size into D-fecha-ultimaperform 4300-MODIFICAR-BDIIALE-DATOSend-if.4300-MODIFICAR-BDIIALE-DATOS.
******************************************************************
* Parte de la carga de datos en el registro BDIIALE y grabacion
* del mismo que es comun a demandas y embargos
* El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
******************************************************************
*    completa la clave e intenta leer la alerta, si se leyo OK
*    el file status de BDIIALE queda con "00"perform 4333-LEER-BDIIALE-RANDOM*    procesa segun el tipo de novedad I M Eevaluate JURAD-tipo-novedadwhen "I"
add 1 to N-reg-tipo-I-OKperform 4300-MODIFICAR-BDIIALE-I$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
1313 lines deletedNo lines in bufferAPPEND MODE      $SET LIST SETTING 

       IDENTIFICATION DIVISION.


       PROGRAM-ID.    CARGAJUR2.



      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.


      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       DATA DIVISION.

APPEND MODE       FILE section.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de entrada con los datos de demandas y embargos de JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD JURAD.

APPEND MODE       01  JURAD-reg.

APPEND MODE      * Registros de movimientos I, M, E

APPEND MODE      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim

APPEND MODE           03 JURAD-tipo-novedad        pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 JURAD-id-tipo             pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 JURAD-id-numeroX          pic x(11).

APPEND MODE           03 JURAD-id-numero           redefines JURAD-id-numeroX

APPEND MODE                                        pic 9(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 JURAD-nombre              pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 JURAD-demandas-vigentes   pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 JURAD-demandas-terminadas pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYYYMMDD

APPEND MODE           03 JURAD-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 JURAD-embargos-vigentes   pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 JURAD-embargos-terminados pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYYYMMDD

APPEND MODE           03 JURAD-embargos-fecha-ultimo pic x(8).

APPEND MODE

APPEND MODE       01  JURADT-reg.

APPEND MODE      * Registro de totales de control T

APPEND MODE      *    Tipo de Novedad = "T"

APPEND MODE           03 JURADT-tipo-novedad       pic x.

APPEND MODE           03                           pic x.

APPEND MODE      *    Cantidad de registros

APPEND MODE           03 JURADT-registros          pic 9(11).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas vigentes

APPEND MODE           03 JURADT-demandas-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de demandas terminadas

APPEND MODE           03 JURADT-demandas-terminadas pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos vigentes

APPEND MODE           03 JURADT-embargos-vigentes  pic 9(7).

APPEND MODE           03                           pic x.

APPEND MODE      *    Total numero de embargos terminados

APPEND MODE           03 JURADT-embargos-terminados pic 9(7).

APPEND MODE           03                           pic x(41).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo de salida con los registros defectuosos del arch JURAD

APPEND MODE      ******************************************************************

APPEND MODE       FD ERRS.

APPEND MODE       01  ERRS-reg.

APPEND MODE      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales

APPEND MODE           03 ERRS-tipo-novedad         pic x.

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           03 ERRS-id-tipo              pic x.

APPEND MODE      *    Numero de identificacion

APPEND MODE           03 ERRS-id-numero            pic x(11).

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           03 ERRS-nombre               pic x(45).

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           03 ERRS-demandas-vigentes    pic 999.

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           03 ERRS-demandas-terminadas  pic 999.

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           03 ERRS-demandas-fecha-ultima pic x(8).

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           03 ERRS-embargos-vigentes    pic 999.

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           03 ERRS-embargos-terminados  pic 999.

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           03 ERRS-embargos-fecha-ultimo pic x(8).

APPEND MODE      *    Causa del rechazo

APPEND MODE           03 ERRS-causa-rechazo        pic x(300).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Contiene los ids y nombres de personas

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIREGI.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de personas juridicas nacionales y extranjeras reportada

APPEND MODE      * por la DIAN

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDIAN.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Archivo maestro de cedulas de extranjeria suministrado por DAS

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIDAS.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Maestro de alertas reportadas por suscriptores

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.FD.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE       WORKING-STORAGE section.

APPEND MODE      ******************************************************************

APPEND MODE      * Nombre del programa

APPEND MODE       01  pgm                          pic x(10) value "CARGAJUR".

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables para rutina de validacion de identificaciones

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIVIDE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Variables relacionadas con las alertas del sistema

APPEND MODE      ******************************************************************

APPEND MODE       copy BDIIALE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para las rutinas de validacion de nombres de VALNOM.PROC

APPEND MODE      ******************************************************************

APPEND MODE       copy VALNOM.WS.

APPEND MODE

APPEND MODE      *****************************************************************

APPEND MODE      * Direcciones de los archivos en el file system

APPEND MODE      *****************************************************************

APPEND MODE       copy ICFILE.WS.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Indica que se termino el proceso, por agotamiento del archivo

APPEND MODE      * de entrada (normal) o alguna otra condicion (error)

APPEND MODE       01  IND-fin-proceso              pic xx value "NO".

APPEND MODE

APPEND MODE      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)

APPEND MODE       01  JURAD-reg-anterior           pic x(100) value "(vacio)".

APPEND MODE       01  JURAD-fs                     pic xx value spaces.

APPEND MODE

APPEND MODE       01  ERRS-fs                      pic xx value spaces.

APPEND MODE

APPEND MODE      * Datos de demandas o embargos que van en el registro BDIIALE

APPEND MODE       01 D-datahost.

APPEND MODE           05 D-vigentes                pic 9(5).

APPEND MODE           05 D-terminados              pic 9(5).

APPEND MODE           05 D-fecha-ultima            pic x(8).

APPEND MODE      ******************************************************************

APPEND MODE      * Parametros iniciales, de la linea de comando

APPEND MODE      * La linea de comando que contiene los parametros

APPEND MODE       01 P-command-line                pic x(80) value spaces.

APPEND MODE       01 P-parametros.

APPEND MODE      *    Proceso real: contiene "1" para activar, "2" por defecto

APPEND MODE           03 P-proceso-real            pic xx value "2".

APPEND MODE           88 PROCESO-REAL              value "1".

APPEND MODE

APPEND MODE      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt

APPEND MODE           03 P-file-name               pic x(80) value spaces.

APPEND MODE           03 P-file-name-R             redefines P-file-name.

APPEND MODE      *        JJJJJJ = Codigo de suscriptor JURAD en Experian

APPEND MODE               05 P-cod-suscriptor      pic 9(6).

APPEND MODE      *        aaa = Codificacion del producto ("100")

APPEND MODE               05 P-producto            pic xxx.

APPEND MODE      *        DDMMAA = Fecha de proceso

APPEND MODE               05 P-fecha-proceso       pic x(6).

APPEND MODE      *        bb =  01 a CI

APPEND MODE               05 P-ci-bi               pic xx.

APPEND MODE      *        XX = Tipo de proceso

APPEND MODE      *        01 Envio Original - Carga TOTAL - primera vez

APPEND MODE      *        02 Archivo Semanal - Carga PARCIAL

APPEND MODE      *        03 Archivo Mensual - Carga PARCIAL

APPEND MODE      *        04 Refresque Total - Carga TOTAL

APPEND MODE               05 P-tipo-proceso        pic xx.

APPEND MODE      *        extension del archivo ".txt"

APPEND MODE               05 P-extension           pic x(4).

APPEND MODE               05                       pic x(57).

APPEND MODE           03 P-file-path               pic x(80) value spaces.

APPEND MODE      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs

APPEND MODE          03 ERRS-file-name             pic x(80) value spaces.

APPEND MODE

APPEND MODE      * Fecha de proceso editada YYYYMMDD

APPEND MODE       01 P-fecha-proceso-YYYYMMDD      pic x(8).

APPEND MODE      * Fecha de proceso + 50 años

APPEND MODE       01 P-fecha-proceso-50.

APPEND MODE           03  P-fecha-proceso-50YYYY   pic 9999.

APPEND MODE           03                           pic x(4).

APPEND MODE      ******************************************************************

APPEND MODE      * Datos para el reporte final

APPEND MODE       01 W-tiempo.

APPEND MODE           03 W-hora-inicio             pic 9(8).

APPEND MODE           03 W-hora-fin                pic 9(8).

APPEND MODE       01 N-edit                        pic z(8)B.

APPEND MODE       01 N-contadores.

APPEND MODE      *    Registros en el archivo de entrada

APPEND MODE           03 N-reg-leidos              pic 9(8) value zero.

APPEND MODE      *    Registros procesados sin error

APPEND MODE           03 N-reg-OK                  pic 9(8) value zero.

APPEND MODE      *    Registros con error

APPEND MODE           03 N-reg-con-error           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Cantidades de registros por tipo de novedad

APPEND MODE           03 N-reg-tipo-I-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-OK           pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-I-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-M-err          pic 9(8) value zero.

APPEND MODE           03 N-reg-tipo-E-err          pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Alertas borradas previo al refresque total

APPEND MODE           03 N-ale-leidas              pic 9(8) value zero.

APPEND MODE           03 N-ale-borradas            pic 9(8) value zero.

APPEND MODE      *    Alertas insertadas

APPEND MODE           03 N-ale-insertadas          pic 9(8) value zero.

APPEND MODE      *    Alertas modificadas

APPEND MODE           03 N-ale-modificadas         pic 9(8) value zero.

APPEND MODE      *    Alertas eliminadas

APPEND MODE           03 N-ale-eliminadas          pic 9(8) value zero.

APPEND MODE      *    Insercion de alerta existente

APPEND MODE           03 N-ale-ya-existe           pic 9(8) value zero.

APPEND MODE      *    Modificacion o eliminacion de alerta inexistente

APPEND MODE           03 N-ale-no-existe           pic 9(8) value zero.

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           03 N-demandas-vigentes       pic 9(5).

APPEND MODE           03 N-demandas-terminadas     pic 9(5).

APPEND MODE           03 N-embargos-vigentes       pic 9(5).

APPEND MODE           03 N-embargos-terminados     pic 9(5).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Armado de las lineas de alerta

APPEND MODE       01 LA-lineas-alerta.

APPEND MODE      *    Los modelos a continuacion deberan obtenerse de un 

APPEND MODE      *    archivo, como BDIIALE-ALERTAS

APPEND MODE           03 LAend                     pic 999 comp value 0.

APPEND MODE           03 LA-modelos.

APPEND MODE      *         12345678901234567890123456789012345678901234567890

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".

APPEND MODE               05 pic x(50) value

APPEND MODE               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".

APPEND MODE               05 pic x(50) value

APPEND MODE               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".

APPEND MODE               05 pic x(50) value high-values. *> end marker

APPEND MODE           03 LA-modelos2               redefines LA-modelos.

APPEND MODE               05 LA-modelo             pic x(50) occurs 5 

APPEND MODE                                        indexed LAm.

APPEND MODE      *    Funcionamiento de los templates.

APPEND MODE      *    Hay dos templates por de alerta, uno por linea.

APPEND MODE      *    Cada template consiste en hasta 10 frases fijas con

APPEND MODE      *    ampersands (&) donde se van a reemplazar los valores.

APPEND MODE      *    Por ejemplo: 

APPEND MODE      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS

APPEND MODE      *    tiene 3 frases fijas y 2 reemplazos. 

APPEND MODE      *    La cantidad de ampersands es irrelevante, pero parece

APPEND MODE      *    conveniente que informe sobre el tamanio del contenido.

APPEND MODE           03 LA-templates.

APPEND MODE               05 LA-template           occurs 4 indexed LAx.

APPEND MODE                   07 LA-parte          pic x(50)

APPEND MODE                                        occurs 10 indexed LAy.

APPEND MODE      *    Las dos lineas armadas

APPEND MODE           03 LA-lineas.

APPEND MODE               05 LA-linea1             pic x(50).

APPEND MODE               05 LA-linea2             pic x(50).

APPEND MODE      *    Los valores a insertar en una linea

APPEND MODE           03 LA-valores.

APPEND MODE               05 LA-valor              pic x(50) 

APPEND MODE                                        occurs 10 indexed LAv.

APPEND MODE      *    Datos para editar valores a insertar

APPEND MODE           03 LA-num                    pic -(11)0.

APPEND MODE           03 LA-numX                   redefines LA-num

APPEND MODE                                        pic x(12).

APPEND MODE           03 LA-descarte               pic x(50).

APPEND MODE

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Errores de consistencia del input

APPEND MODE      * Cada error tiene un codigo de 2 digitos, un espacio, contador

APPEND MODE      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx value "NO".

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300) value spaces.

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8) value zero.

APPEND MODE      *    tabla de errores

APPEND MODE           03 pic x(11) value "01 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de movimiento invalido, debe ser I M E T".

APPEND MODE           03 pic x(11) value "02 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion invalido, debe ser 1 2 3 4".

APPEND MODE           03 pic x(11) value "03 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de identificacion invalido, debe ser numerico".

APPEND MODE           03 pic x(11) value "04 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Tipo de identificacion debe ser mayor que cero".

APPEND MODE           03 pic x(11) value "05 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Falta el nombre o denominacion".

APPEND MODE           03 pic x(11) value "06 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "07 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de demandas terminadas: debe ser numerico".

APPEND MODE           03 pic x(11) value "08 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "09 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "10 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos vigentes: debe ser numerico".

APPEND MODE           03 pic x(11) value "11 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de embargos terminados: debe ser numerico".

APPEND MODE           03 pic x(11) value "12 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".

APPEND MODE           03 pic x(11) value "13 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".

APPEND MODE           03 pic x(11) value "14 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El numero de id no se encuentra en el archivo maestro".

APPEND MODE           03 pic x(11) value "15 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "El nombre en el input no coincide con el registrado".

APPEND MODE           03 pic x(11) value "16 0000000 ".

APPEND MODE           03 pic x(59) value

APPEND MODE           "Numero de id fuera del rango del tipo de id informado".

APPEND MODE      *----------------- insertar nuevos items aqui -------------------

APPEND MODE           03 pic x(11) value "00 0000000 ".

APPEND MODE           03 pic x(59) value "--- fin de la lista (cod 00) ---".

APPEND MODE           03                           pic x(3500). *> los 50 items

APPEND MODE       01 E-errores-2                   redefines E-errores.

APPEND MODE           03                           pic xx.

APPEND MODE           03                           pic x(100).

APPEND MODE           03                           pic 9(8).

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE       01 E-edit                        pic z(8)B.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      * Control de rangos de valores de las fechas del input

APPEND MODE       01 VALIDACIONES-FECHAS.

APPEND MODE           02 ANO-VAL-X                 pic 9(04).

APPEND MODE              88 ANO-VAL                value 1900 thru 2050.

APPEND MODE           02 MES-VAL-X                 pic 9(02).

APPEND MODE              88 MES-VAL                value 01   thru 12.

APPEND MODE           02 DIA-VAL-X                 pic 9(02).

APPEND MODE              88 DIA-VAL                value 01   thru 31.

APPEND MODE

APPEND MODE      /*****************************************************************

APPEND MODE      ******************************************************************

APPEND MODE       PROCEDURE DIVISION.

APPEND MODE      *    0000-PROGRAMA-PRINCIPAL

APPEND MODE      *    4000-PROCESAR-REGISTRO

APPEND MODE      *    4000-PROCESAR-REGISTRO-2

APPEND MODE      *    4100-VALIDACION-FORMAL

APPEND MODE      *    4200-VALIDACION-SEMANTICA

APPEND MODE      *    4300-MODIFICAR-BDIIALE

APPEND MODE      *    4300-MODIFICAR-BDIIALE-DATOS

APPEND MODE      *    4300-MODIFICAR-BDIIALE-I

APPEND MODE      *    4300-MODIFICAR-BDIIALE-M

APPEND MODE      *    4300-MODIFICAR-BDIIALE-E

APPEND MODE      *    4333-LEER-BDIIALE-RANDOM

APPEND MODE      *    4333-GRABAR-BDIIALE

APPEND MODE      *    4333-REGRABAR-BDIIALE

APPEND MODE      *    4333-ELIMINAR-BDIIALE

APPEND MODE      *    4900-GRABAR-ERROR

APPEND MODE      *    4320-ARMAR-TEXTO-ALERTA

APPEND MODE      *    1000-RUTINA-INICIAL

APPEND MODE      *    1001-ELIMINAR-TODO

APPEND MODE      *    7000-RUTINA-FINAL

APPEND MODE      *    9000-CANCELAR-PROGRAMA

APPEND MODE

APPEND MODE

APPEND MODE       0000-PROGRAMA-PRINCIPAL.

APPEND MODE      ******************************************************************

APPEND MODE      *    inicializa el ambiente y abre los archivos

APPEND MODE           perform 1000-RUTINA-INICIAL

APPEND MODE      *    procesa cada uno de los registros del archivo JURAD hasta

APPEND MODE      *    encontrar el registro "T" de totales

APPEND MODE           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"

APPEND MODE      *    cierra archivos y produce el reporte final

APPEND MODE           perform 7000-RUTINA-FINAL

APPEND MODE           goback.

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO.

APPEND MODE      ****************************************************************

APPEND MODE      * Proceso de un registro del archivo de entrada JURAD

APPEND MODE      * Lectura y control del file status del archivo

APPEND MODE      ****************************************************************

APPEND MODE      *    lectura del proximo registro

APPEND MODE           read JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE           when "00"

APPEND MODE      *        controla el reg y lo aplica si es OK

APPEND MODE               perform 4000-PROCESAR-REGISTRO-2

APPEND MODE               move JURAD-reg to JURAD-reg-anterior

APPEND MODE           when "10"

APPEND MODE      *        fin del archivo de input:

APPEND MODE      *        esto es un error, no se encontro el registro "T" antes

APPEND MODE      *        de que se terminara el archivo

APPEND MODE               display "Falta el reg de totales del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           when other

APPEND MODE      *        error de lectura: cancelacion del proceso

APPEND MODE               display "Error en lectura del archivo JURAD "

APPEND MODE               display "Nombre del archivo: " P-file-name

APPEND MODE               display "File status: " JURAD-fs

APPEND MODE               display "Ultimo registro leido: " N-reg-leidos

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4000-PROCESAR-REGISTRO-2.

APPEND MODE      ****************************************************************

APPEND MODE      * Controla los datos de un registro de JURAD y si es OK lo usa

APPEND MODE      * para actualizar el archivo de alertas en linea

APPEND MODE      * La informacion esta leida en JURAD-reg

APPEND MODE      ****************************************************************

APPEND MODE           move "NO" to E-hay-error

APPEND MODE

APPEND MODE      *    validacion del tipo de movimiento

APPEND MODE           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 

APPEND MODE               call "PONERR" using "01" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si es el registro "T" hay que senialar el fin de proceso

APPEND MODE           if JURAD-tipo-novedad = "T" 

APPEND MODE               move "SI" to IND-fin-proceso

APPEND MODE               perform 4800-PROCESO-REG-T

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE           add 1 to N-reg-leidos

APPEND MODE

APPEND MODE      *    validacion formal de los datos

APPEND MODE           perform 4100-VALIDACION-FORMAL

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    si la validacion formal dio OK se hace validacion semantica

APPEND MODE           perform 4200-VALIDACION-SEMANTICA

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               perform 4900-GRABAR-ERROR

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    intento de actualizacion de BDIIALE

APPEND MODE           perform 4300-MODIFICAR-BDIIALE

APPEND MODE           add 1 to N-reg-OK.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4100-VALIDACION-FORMAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Validacion formal de los datos del input

APPEND MODE      ******************************************************************

APPEND MODE      *    Tipo de identificacion Numero {1, 2, 3, 4}

APPEND MODE           if JURAD-id-tipo not = "1" and "2" and "3" and "4"

APPEND MODE               call "PONERR" using "02" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de identificacion

APPEND MODE           if JURAD-id-numeroX is not numeric

APPEND MODE               call "PONERR" using "03" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           if JURAD-id-numero not > 0

APPEND MODE               call "PONERR" using "04" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    si el movimiento es una eliminacion los datos subsiguientes

APPEND MODE      *    no se controlan

APPEND MODE           if JURAD-tipo-novedad = "E"

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE      *    Nombres y Apellidos

APPEND MODE           if JURAD-nombre = spaces

APPEND MODE               call "PONERR" using "05" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas vigentes

APPEND MODE           if JURAD-demandas-vigentes is not numeric

APPEND MODE               call "PONERR" using "06" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de demandas terminadas

APPEND MODE           if JURAD-demandas-terminadas is not numeric

APPEND MODE               call "PONERR" using "07" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultima demanda vigente YYMMDD

APPEND MODE           if JURAD-demandas-fecha-ultima is not numeric

APPEND MODE               call "PONERR" using "08" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "09" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos vigentes

APPEND MODE           if JURAD-embargos-vigentes not numeric

APPEND MODE               call "PONERR" using "10" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Numero de embargos terminados

APPEND MODE           if JURAD-embargos-terminados not numeric

APPEND MODE               call "PONERR" using "11" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE      *    Fecha ultimo embargo vigente YYMMDD

APPEND MODE           if JURAD-embargos-fecha-ultimo is not numeric

APPEND MODE               call "PONERR" using "12" JURAD-reg E-errores

APPEND MODE           end-if

APPEND MODE           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS

APPEND MODE           if not ANO-VAL or not MES-VAL or not DIA-VAL

APPEND MODE               call "PONERR" using "13" JURAD-reg E-errores

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4200-VALIDACION-SEMANTICA.

APPEND MODE      ****************************************************************

APPEND MODE      * Validacion del numero de identificacion y de su relacion con

APPEND MODE      * el nombre

APPEND MODE      ****************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIVIDE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R

APPEND MODE           move JURAD-nombre to NOMBRE-BDIIVIDE

APPEND MODE           move 1 to SW-VERIFNOM-BDIIVIDE

APPEND MODE           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE

APPEND MODE           perform 80100-VALIDAR-IDENTIFICACION

APPEND MODE      *    a ver si la validacion cambio el tipo de ide

APPEND MODE           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE

APPEND MODE               call "PONERR" using "16" JURAD-reg E-errores

APPEND MODE               display "Tipo ide cambiado de " JURAD-id-tipo " a " 

APPEND MODE               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero

APPEND MODE           end-if

APPEND MODE      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe

APPEND MODE           if SW-ID-BDIIVIDE = 1

APPEND MODE               call "PONERR" using "14" JURAD-reg E-errores

APPEND MODE           else

APPEND MODE      *        existe id, a ver si el nombre coincide

APPEND MODE               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide

APPEND MODE                   call "PONERR" using "15" JURAD-reg E-errores

APPEND MODE                   display "novedad:  " JURAD-nombre

APPEND MODE                   display "registro: " NOM-LEIDO-BDIIVIDE

APPEND MODE               end-if

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Se impacta el archivo BDIIALE con una o dos inserciones, 

APPEND MODE      * modificaciones o eliminaciones segun haya o no demandas y 

APPEND MODE      * embargos

APPEND MODE      ******************************************************************

APPEND MODE           initialize REG-BDIIALE

APPEND MODE

APPEND MODE      *    si hay demandas

APPEND MODE           if JURAD-demandas-vigentes > zero

APPEND MODE           or JURAD-demandas-terminadas > zero 

APPEND MODE               move "J001" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de demandas

APPEND MODE               move JURAD-demandas-vigentes to D-vigentes

APPEND MODE               move JURAD-demandas-terminadas to D-terminados

APPEND MODE               string "20" JURAD-demandas-fecha-ultima 

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hay embargos

APPEND MODE           if JURAD-embargos-vigentes > zero

APPEND MODE           or JURAD-embargos-terminados > zero 

APPEND MODE               move "J002" to LLASEC-BDIIALE

APPEND MODE      *        arma datos de embargos

APPEND MODE               move JURAD-embargos-vigentes to D-vigentes

APPEND MODE               move JURAD-embargos-terminados to D-terminados

APPEND MODE               string "20" JURAD-embargos-fecha-ultimo

APPEND MODE               delimited size into D-fecha-ultima

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-DATOS 

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-DATOS.

APPEND MODE      ******************************************************************

APPEND MODE      * Parte de la carga de datos en el registro BDIIALE y grabacion

APPEND MODE      * del mismo que es comun a demandas y embargos

APPEND MODE      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"

APPEND MODE      ******************************************************************

APPEND MODE      *    completa la clave e intenta leer la alerta, si se leyo OK

APPEND MODE      *    el file status de BDIIALE queda con "00"

APPEND MODE           perform 4333-LEER-BDIIALE-RANDOM

APPEND MODE

APPEND MODE      *    procesa segun el tipo de novedad I M E

APPEND MODE           evaluate JURAD-tipo-novedad

APPEND MODE           when "I"

APPEND MODE               add 1 to N-reg-tipo-I-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-I

APPEND MODE           when "M"

APPEND MODE               add 1 to N-reg-tipo-M-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-M

APPEND MODE           when "E"

APPEND MODE               add 1 to N-reg-tipo-E-OK

APPEND MODE               perform 4300-MODIFICAR-BDIIALE-E

APPEND MODE           when other

APPEND MODE      *        esto es "imposible" por control de consistencia anterior

APPEND MODE               display "error de logica: tipo-novedad="

APPEND MODE               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos

APPEND MODE               display "Registro de JURAD: " display JURAD-reg

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-I.

APPEND MODE      ******************************************************************

APPEND MODE      * Insercion de una alerta nueva

APPEND MODE      * Si ya existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro existia es un error

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               display "Insercion de alerta nueva que ya existe "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-ya-existe

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    completa los datos del registro

APPEND MODE           initialize ENCABEZADO-BDIIALE

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE

APPEND MODE           FEC-REP-BDIIALE 

APPEND MODE           move P-fecha-proceso-50 to FEC-VEN-BDIIALE

APPEND MODE           move 0 to BLOQUEO-BDIIALE

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE           display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-M.

APPEND MODE      ******************************************************************

APPEND MODE      * Modificacion de una alerta existente

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    si el registro no existia es un error

APPEND MODE           if EST-BDIIALE not = "00"

APPEND MODE               display "Modificacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               display "Datos en la alerta: " INF-DATAHOST-BDIIALE

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if

APPEND MODE      *    reemplaza la fecha de reporte y los valores

APPEND MODE           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 

APPEND MODE           move D-datahost to INF-DATAHOST-BDIIALE

APPEND MODE           perform 4320-ARMAR-TEXTO-ALERTA

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-REGRABAR-BDIIALE

APPEND MODE           else

APPEND MODE               perform 4333-GRABAR-BDIIALE

APPEND MODE           end-if.

APPEND MODE           display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4300-MODIFICAR-BDIIALE-E.

APPEND MODE      ******************************************************************

APPEND MODE      * Eliminacion de una alerta

APPEND MODE      * Si no existia muestra un mensaje y continua

APPEND MODE      ******************************************************************

APPEND MODE      *    elimina el registro

APPEND MODE           if EST-BDIIALE = "00"

APPEND MODE               perform 4333-ELIMINAR-BDIIALE

APPEND MODE           else

APPEND MODE               display "Eliminacion de alerta inexistente "

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro de input: "

APPEND MODE               display JURAD-reg

APPEND MODE               add 1 to N-ale-no-existe

APPEND MODE           end-if.

APPEND MODE           display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-LEER-BDIIALE-RANDOM.

APPEND MODE      ******************************************************************

APPEND MODE      * Arma clave exacta y lee un registro de BDIIALE

APPEND MODE      * Usa los datos del reg input, excepto LLASEC que esta precargado

APPEND MODE      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-id-tipo to TIP-IDE-BDIIALE

APPEND MODE           move JURAD-id-numero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move 000 to COD-ALERTA-BDIIALE

APPEND MODE      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

APPEND MODE

APPEND MODE           read BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               continue

APPEND MODE           when "23"

APPEND MODE               continue

APPEND MODE           when other

APPEND MODE               display "Error al leer BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Ultimo registro procesado: "

APPEND MODE               display JURAD-reg-anterior

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE           display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE

APPEND MODE           " fs:" EST-BDIIALE.

APPEND MODE

APPEND MODE

APPEND MODE       4333-GRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Inserta un registro nuevo en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           write REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-insertadas

APPEND MODE           when other

APPEND MODE               display "Error al grabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-REGRABAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Regraba un registro modificado en BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           rewrite REG-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-modificadas

APPEND MODE           when other

APPEND MODE               display "Error al regrabar BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE

APPEND MODE       4333-ELIMINAR-BDIIALE.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina un registro de BDIIALE

APPEND MODE      ******************************************************************

APPEND MODE           if not PROCESO-REAL

APPEND MODE               exit paragraph

APPEND MODE           end-if

APPEND MODE           delete BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE               add 1 to N-ale-eliminadas

APPEND MODE           when other

APPEND MODE               display "Error al deletear BDIIALE fs: " EST-BDIIALE

APPEND MODE               " key: " LLAVE-BDIIALE

APPEND MODE               display "Registro BDIIALE: "

APPEND MODE               display REG-BDIIALE

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE       4800-PROCESO-REG-T.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro leido en el archivo JURAD es tipo "T" con totales

APPEND MODE      * de control, y debería ser el ultimo del archivo

APPEND MODE      ******************************************************************

APPEND MODE      * Control de los totales calculados contra los esperados

APPEND MODE           move "NO" to E-hay-error

APPEND MODE      *    cantidad de registros I M E

APPEND MODE           if function numval(JURADT-registros) = N-reg-leidos

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide la cantidad de registros:"

APPEND MODE               JURADT-registros " con los leidos:" N-reg-leidos

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    Sumas de cantidades de demandas y embargos

APPEND MODE           if function numval(JURADT-demandas-terminadas)

APPEND MODE           = N-demandas-terminadas

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de demandas terminadas:"

APPEND MODE               JURADT-demandas-terminadas " con el calculado:"

APPEND MODE               N-demandas-terminadas

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-vigentes)

APPEND MODE           = N-embargos-vigentes

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos vigentes:"

APPEND MODE               JURADT-embargos-vigentes " con el calculado:"

APPEND MODE               N-embargos-vigentes

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if

APPEND MODE

APPEND MODE           if function numval(JURADT-embargos-terminados)

APPEND MODE           = N-embargos-terminados

APPEND MODE               continue

APPEND MODE           else

APPEND MODE               display " "

APPEND MODE               display "No coincide total de embargos terminados:"

APPEND MODE               JURADT-embargos-terminados " con el calculado:"

APPEND MODE               N-embargos-terminados

APPEND MODE               move "SI" to E-hay-error

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      *    si hubo cualquier cosa se invalida el proceso

APPEND MODE           if E-hay-error = "SI"

APPEND MODE               display "Error en registro T de totales de control"

APPEND MODE               display "Nombre del archivo: " ERRS-file-name

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       4900-GRABAR-ERROR.

APPEND MODE      ******************************************************************

APPEND MODE      * El registro de JURAD tiene error: se graba en el archivo ERRS

APPEND MODE      * con indicacion del error detectado

APPEND MODE      ******************************************************************

APPEND MODE           move JURAD-reg to ERRS-reg

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE      *    lista de los codigos de los errores del registro

APPEND MODE           move E-errores-reg to ERRS-causa-rechazo

APPEND MODE           write ERRS-reg

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                   continue

APPEND MODE               when other

APPEND MODE                   display "Error al grabar el archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE 

APPEND MODE

APPEND MODE       4320-ARMAR-TEXTO-ALERTA.

APPEND MODE      ****************************************************************

APPEND MODE      * Hace el reemplazo de los valores adecuados en los templates

APPEND MODE      * de las linea de alerta que corresponde

APPEND MODE      ****************************************************************

APPEND MODE      *    segun se trate de demandas o embargos

APPEND MODE           if JURAD-demandas-vigentes not = 0 

APPEND MODE           or JURAD-demandas-terminadas not = 0

APPEND MODE               set LAx to 1

APPEND MODE               move high-values to LA-valores

APPEND MODE               move JURAD-demandas-vigentes to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(1)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(1)

APPEND MODE               move JURAD-demandas-terminadas to LA-num

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      *        unstring LA-numX into LA-descarte LA-valor(2)

APPEND MODE      *        delimited by all space

APPEND MODE               move LA-numx(9:12) to LA-valor(2)

APPEND MODE

APPEND MODE      * >>>> esto esta anulado x que no se como hacer para que lo compile

APPEND MODE      * >>>> da error en el end-if

APPEND MODE      *        string LA-parte(LAx, 1) LA-valor(1)

APPEND MODE      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)

APPEND MODE      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)

APPEND MODE      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)

APPEND MODE      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)

APPEND MODE      *        LA-parte(LAx, 10) LA-valor(10)

APPEND MODE      *        delimited by high-value

APPEND MODE           end-if.

APPEND MODE

APPEND MODE

APPEND MODE       1000-RUTINA-INICIAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Todas las operaciones que se realizan una sola vez, al comienzo

APPEND MODE      * del programa:

APPEND MODE      *   - obtencion de los parametros

APPEND MODE      *   - apertura del archivo de entrada

APPEND MODE      *   - apertura de todos los demas archivos

APPEND MODE      *   - eliminacion de datos existentes si es refresque completo

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de inicio

APPEND MODE           accept W-hora-inicio from time

APPEND MODE

APPEND MODE      * Obtiene informacion sobre la corrida de la linea de comando: el

APPEND MODE      * nombre del archivo de entrada (que contiene el tipo de proceso),

APPEND MODE      * el indicador de proceso real o en falso (default)

APPEND MODE           accept P-command-line from COMMAND-LINE

APPEND MODE           display "Parametros: " P-command-line

APPEND MODE           unstring P-command-line delimited by all " " into

APPEND MODE           P-file-name P-proceso-real

APPEND MODE

APPEND MODE      * El programa se anuncia en la consola

APPEND MODE      * TODO: se usa un anuncio mas vistoso?

APPEND MODE           if PROCESO-REAL

APPEND MODE               display pgm " Carga de archivo JURAD - proceso REAL"

APPEND MODE           else

APPEND MODE               display pgm " Carga de archivo JURAD - proceso en falso"

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * El indicador de proceso real debe ser SI|si|NO|no

APPEND MODE           if P-proceso-real not = "1" and "2"

APPEND MODE               display "El indicador de proceso real es invalido"

APPEND MODE               display "debe ser 1 o 2"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-if

APPEND MODE

APPEND MODE      * TODO: controlar los componentes del filename

APPEND MODE           evaluate P-tipo-proceso

APPEND MODE           when "01"

APPEND MODE               display "01 Envio Original - Carga TOTAL 1a vez"

APPEND MODE           when "02"

APPEND MODE               display "02 Archivo Semanal - Carga PARCIAL"

APPEND MODE           when "03"

APPEND MODE               display "03 Archivo Mensual - Carga PARCIAL"

APPEND MODE           when "04"

APPEND MODE               display "04 Refresque Total - Carga TOTAL"

APPEND MODE           when other

APPEND MODE      *        valor invalido

APPEND MODE               display "El tipo de proceso " P-tipo-proceso

APPEND MODE               " es invalido (debe ser 01 02 03 o 04)"

APPEND MODE               perform 9000-CANCELAR-PROGRAMA

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Edita la fecha de proceso DDMMAA del parametro en formato

APPEND MODE      * YYYYMMDD 

APPEND MODE           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)

APPEND MODE           P-fecha-proceso(1:2) delimited size 

APPEND MODE           into P-fecha-proceso-YYYYMMDD

APPEND MODE           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

APPEND MODE

APPEND MODE      * Calcula una fecha 50 anios posterior a la de proceso

APPEND MODE           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50

APPEND MODE           add 50 to P-fecha-proceso-50YYYY

APPEND MODE

APPEND MODE      * Apertura del archivo de entrada

APPEND MODE           string "$TEMPORALES/" P-file-name into P-file-path

APPEND MODE           open input JURAD

APPEND MODE           evaluate JURAD-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo JURAD "

APPEND MODE                   display "Path del archivo: " P-file-path

APPEND MODE                   display "File status: " JURAD-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura del archivo de errores

APPEND MODE           string "$TEMPORALES/" P-file-name(1:19) ".errs"

APPEND MODE           into ERRS-file-name

APPEND MODE           open output ERRS

APPEND MODE           evaluate ERRS-fs

APPEND MODE               when "00"

APPEND MODE                    continue

APPEND MODE               when other

APPEND MODE                   display "Error en open del archivo de errores "

APPEND MODE                   display "Nombre del archivo: " ERRS-file-name

APPEND MODE                   display "File status: " ERRS-fs

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE                   goback

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      * Apertura de los archivos maestros

APPEND MODE      * TODO: falta capturar el status de estas operaciones?

APPEND MODE           open input BDIIREGI

APPEND MODE           open input BDIIDIAN

APPEND MODE           open input BDIIDAS.

APPEND MODE

APPEND MODE      * Apertura del archivo de alertas en linea

APPEND MODE           if PROCESO-REAL

APPEND MODE               open i-o BDIIALE

APPEND MODE           else

APPEND MODE               open input BDIIALE

APPEND MODE           end-if.

APPEND MODE

APPEND MODE      * Si es un refresque total (codigo 04) se eliminan los registros

APPEND MODE      * de Jurad existentes

APPEND MODE           if P-tipo-proceso = "04" and PROCESO-REAL

APPEND MODE               perform 1001-ELIMINAR-TODO

APPEND MODE           end-if.

APPEND MODE

APPEND MODE       1000-NOT-USED.

APPEND MODE      * >>>> esto da un error de compilacion que no puedo resolver

APPEND MODE      * >>>> por ahora esta anulado

APPEND MODE      ******************************************************************

APPEND MODE      * Carga de los templates para armar el texto de alertas

APPEND MODE      * TODO: por ahora los templates son literales

APPEND MODE           set LAx to 0

APPEND MODE           move high-values to LA-templates

APPEND MODE           perform varying LAm from 1 by 1 

APPEND MODE           until LA-modelo(LAm) = high-values

APPEND MODE               set LAx up by 1

APPEND MODE      *        separa las partes de la linea

APPEND MODE      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)

APPEND MODE      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)

APPEND MODE      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)

APPEND MODE      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)

APPEND MODE      *        delimited by all "&"

APPEND MODE      *        prepara para omitir los espacios al final de c/parte

APPEND MODE               perform varying LAy from 1 by 1 until LAy > 10

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing trailing

APPEND MODE                   spaces by high-values

APPEND MODE                   inspect LA-parte(LAx, LAy) replacing first

APPEND MODE                   high-value by space

APPEND MODE               end-perform

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       1001-ELIMINAR-TODO.

APPEND MODE      ******************************************************************

APPEND MODE      * Elimina los registros de alertas existentes en el archivo de

APPEND MODE      * alertas en linea, previo a un refresque total

APPEND MODE      ******************************************************************

APPEND MODE           display "Eliminando toda la informacion con fuente JURAD"

APPEND MODE      *    posiciona en el primer reg de JURAD

APPEND MODE           move zero to TIP-IDE-BDIIALE

APPEND MODE           move zero to NUM-IDE-BDIIALE

APPEND MODE           move P-cod-suscriptor to FUENTE-BDIIALE

APPEND MODE           move zeros to COD-ALERTA-BDIIALE

APPEND MODE           move low-values to LLASEC-BDIIALE

APPEND MODE           start BDIIALE key > LLAVE-BDIIALE

APPEND MODE           display "Start BDIIALE k:" LLAVE-BDIIALE

APPEND MODE           evaluate EST-BDIIALE

APPEND MODE           when "00"

APPEND MODE      *        posicionado

APPEND MODE               display "Va a comenzar la eliminación"

APPEND MODE           when other

APPEND MODE      *        no hay registros

APPEND MODE               display "No hay registros a eliminar fs:" EST-BDIIALE

APPEND MODE               exit paragraph

APPEND MODE           end-evaluate.

APPEND MODE

APPEND MODE      *    lee secuencialmente y elimina los registros de JURAD

APPEND MODE      *    hasta el fin del archivo

APPEND MODE           perform until EST-BDIIALE not = "00"

APPEND MODE               read BDIIALE next record

APPEND MODE               evaluate EST-BDIIALE

APPEND MODE               when "00"

APPEND MODE      *            display "BDIIALE leido fs:" EST-BDIIALE

APPEND MODE      *            " k:" LLAVE-BDIIALE

APPEND MODE                   if FUENTE-BDIIALE = P-cod-suscriptor

APPEND MODE      *                es un alerta de JURAD

APPEND MODE                       delete BDIIALE

APPEND MODE                       if EST-BDIIALE = "00"

APPEND MODE                           display "BDIIALE eliminado k:" LLAVE-BDIIALE

APPEND MODE                           add 1 to N-ale-borradas

APPEND MODE                       else

APPEND MODE      *                    error en la eliminacion

APPEND MODE                           display "Error al eliminar un registro de "

APPEND MODE                           "BDIIALE vaciando los datos"

APPEND MODE                           display "Clave: " LLAVE-BDIIALE

APPEND MODE                           display "Reg borrados: " N-ale-borradas

APPEND MODE                           perform 9000-CANCELAR-PROGRAMA

APPEND MODE                       end-if

APPEND MODE                   end-if

APPEND MODE               when "10"

APPEND MODE      *            fin de archivo: sale normalmente

APPEND MODE                   display "Fin de los registros a eliminar - leídos:"

APPEND MODE                   N-ale-leidas

APPEND MODE               when other

APPEND MODE      *            lectura anormal: cancelacion del programa

APPEND MODE                   display "Error en lectura del archivo de alertas "

APPEND MODE                   "online"

APPEND MODE                   display "File status: " EST-BDIIALE

APPEND MODE                   perform 9000-CANCELAR-PROGRAMA *> no retorna

APPEND MODE               end-evaluate

APPEND MODE           end-perform.

APPEND MODE           display "Termino la eliminacion total de JURAD"

APPEND MODE           display "Reg borrados: " N-ale-borradas.

APPEND MODE

APPEND MODE

APPEND MODE       7000-RUTINA-FINAL.

APPEND MODE      ******************************************************************

APPEND MODE      * Registra hora de finalizacion

APPEND MODE           accept W-hora-fin from time

APPEND MODE

APPEND MODE      * Leer JURAD a ver si hay registros despues del "T"

APPEND MODE

APPEND MODE      * Close todos los archivos

APPEND MODE           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.

APPEND MODE      

APPEND MODE      * Emision de contadores de registros

APPEND MODE           display " "

APPEND MODE           display "Totales de registros:"

APPEND MODE           move N-reg-leidos to N-edit 

APPEND MODE           display N-edit "Registros IME en el archivo de entrada"

APPEND MODE           move N-reg-OK to N-edit 

APPEND MODE           display N-edit "Registros procesados sin error"

APPEND MODE

APPEND MODE      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la

APPEND MODE      * definicion de estos contadores

APPEND MODE      *    move N-reg-tipo-I-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo I aceptados"

APPEND MODE      *    move N-reg-tipo-M-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo M aceptados"

APPEND MODE      *    move N-reg-tipo-E-OK to N-edit

APPEND MODE      *    display N-edit "Registros tipo E aceptados"

APPEND MODE

APPEND MODE           move E-cont-regs-con-error to N-reg-con-error

APPEND MODE           move N-reg-con-error to N-edit 

APPEND MODE           display N-edit "Registros con error"

APPEND MODE           move N-ale-borradas to N-edit 

APPEND MODE           display N-edit "Alertas borradas previo al refresque total"

APPEND MODE           move N-ale-insertadas to N-edit 

APPEND MODE           display N-edit "Alertas insertadas"

APPEND MODE           move N-ale-modificadas to N-edit 

APPEND MODE           display N-edit "Alertas modificadas"

APPEND MODE           move N-ale-eliminadas to N-edit 

APPEND MODE           display N-edit "Alertas eliminadas"

APPEND MODE           move N-ale-ya-existe to N-edit 

APPEND MODE           display N-edit "Insercion de alerta existente"

APPEND MODE           move N-ale-no-existe to N-edit 

APPEND MODE           display N-edit "Modif o elim de alerta inexistente".

APPEND MODE

APPEND MODE      * Emision del reporte de errores

APPEND MODE           display " "

APPEND MODE           display "Totales por tipo de error detectado:"

APPEND MODE           perform varying Ex from 1 by 1 until Ex > 50

APPEND MODE           or E-codigo(Ex) = "00"

APPEND MODE               if E-contador(Ex) not = 0 

APPEND MODE                   move E-contador(ex) to E-edit

APPEND MODE                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)

APPEND MODE               end-if

APPEND MODE           end-perform.

APPEND MODE

APPEND MODE

APPEND MODE       9000-CANCELAR-PROGRAMA.

APPEND MODE      ******************************************************************

APPEND MODE      * Procedimiento standard de cancelacion de programa batch

APPEND MODE      ******************************************************************

APPEND MODE      * TODO: hay un standard para comunicar una cancelacion de proceso?

APPEND MODE           display " "

APPEND MODE           display pgm " - proceso cancelado"

APPEND MODE           goback returning 99.

APPEND MODE

APPEND MODE

APPEND MODE           copy BDIIVIDE.PROC.

APPEND MODE

APPEND MODE

APPEND MODE           copy VALNOM.PROC.

APPEND MODE

APPEND MODE

APPEND MODE      /

APPEND MODE       IDENTIFICATION DIVISION.

APPEND MODE       PROGRAM-ID. PONERR.

APPEND MODE      ******************************************************************

APPEND MODE      * Rutina de conveniencia para procesar un error detectado en un

APPEND MODE      * registro de input

APPEND MODE      * Contabiliza el error en la tabla de errores, activa el indicador

APPEND MODE      * de registro con error, muestra el mensaje en la pantalla, cuenta

APPEND MODE      * el registro erroneo

APPEND MODE      ******************************************************************

APPEND MODE       ENVIRONMENT DIVISION.

APPEND MODE       DATA DIVISION.

APPEND MODE       WORKING-STORAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input-anterior           pic x(86) value low-values.

APPEND MODE      * Posicion del proximo error en la lista de errores del reg

APPEND MODE       01  errIndex                     pic 999 comp.

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       LINKAGE SECTION.

APPEND MODE      ******************************************************************

APPEND MODE      * Codigo del error detectado

APPEND MODE       01  cod-error                    pic xx.

APPEND MODE      ******************************************************************

APPEND MODE      * Registro de input (primeros 86 caracteres)

APPEND MODE       01  reg-input                    pic x(86).

APPEND MODE      ******************************************************************

APPEND MODE      * Tabla de errores de consistencia del input

APPEND MODE       01 E-errores.

APPEND MODE      *    indica si el registro actual tiene error

APPEND MODE           03 E-hay-error               pic xx.

APPEND MODE      *    errores del registro actual

APPEND MODE           03 E-errores-reg             pic x(300).

APPEND MODE      *    contador de registros con error

APPEND MODE           03 E-cont-regs-con-error     pic 9(8).

APPEND MODE      *    tabla de errores

APPEND MODE           03 E-error                   occurs 50 indexed Ex.

APPEND MODE               05 E-codigo              pic xx.

APPEND MODE               05                       pic x.

APPEND MODE               05 E-contador            pic 9(7).

APPEND MODE               05                       pic x.

APPEND MODE               05 E-descripcion         pic x(59).

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE       PROCEDURE DIVISION using cod-error reg-input E-errores.

APPEND MODE       00.

APPEND MODE      *    marca al reg actual como erroneo

APPEND MODE           move "SI" to E-hay-error

APPEND MODE

APPEND MODE      *    cuenta y muestra el registro de input

APPEND MODE           if reg-input not = reg-input-anterior

APPEND MODE               add 1 to E-cont-regs-con-error

APPEND MODE               display " "

APPEND MODE               display reg-input

APPEND MODE               move reg-input to reg-input-anterior

APPEND MODE               move spaces to E-errores-reg

APPEND MODE               move 2 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE      *    contabiliza el error en la tabla de errores

APPEND MODE           set Ex to 1

APPEND MODE           search E-error varying Ex

APPEND MODE           at end

APPEND MODE               display "--- falla en la tabla de errores ---" cod-error

APPEND MODE           when E-codigo(Ex) = "00"

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "--- error tipo exotico: " cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE           when E-codigo(Ex) = cod-error

APPEND MODE               add 1 to E-contador(Ex)

APPEND MODE               display "Error " cod-error " " E-descripcion(Ex)

APPEND MODE           end-search

APPEND MODE

APPEND MODE      *    agrega a la lista de errores del registro

APPEND MODE           if errIndex < (300 - 59 - 3)

APPEND MODE               move cod-error to E-errores-reg(errIndex:2)

APPEND MODE               add 3 to errIndex

APPEND MODE               move E-descripcion(Ex) to E-errores-reg(errIndex:59)

APPEND MODE               add 59 to errIndex

APPEND MODE           end-if

APPEND MODE

APPEND MODE           exit program.

APPEND MODE

APPEND MODE

APPEND MODE       end program PONERR.

APPEND MODE

APPEND MODE       end program CARGAJUR2.

APPEND MODE

APPEND MODE      ******************************************************************

APPEND MODE      ******************************************************************

APPEND MODE

APPEND MODE

:w"CARGAJUR2.CBL" 1318 lines, 55768 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24783
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR2
* Data:     24048  Code:     46692  Literals:      2576  Dynamic:   1474560

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR2.CBL

/d/iccol/desarrollo/fuentes>sh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 08:19  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso en falso
El indicador de proceso real es invalido
debe ser S o N
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 08:20:09
Fin de Programa:     2014/05/22 08:20:09

 
-rw-rw-r--   1 icjlud   icdatacr     401 May 22 08:20 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>fg
vi CARGAJUR2.CBL

PROCEDURE DIVISION using cod-error reg-input E-errores.
00.
*    marca al reg actual como erroneomove "SI" to E-hay-error*    cuenta y muestra el registro de inputif reg-input not = reg-input-anterioradd 1 to E-cont-regs-con-errordisplay " "
display reg-inputmove reg-input to reg-input-anteriormove spaces to E-errores-regmove 2 to errIndexend-if*    contabiliza el error en la tabla de erroresset Ex to 1
search E-error varying Exat end
display "--- falla en la tabla de errores ---" cod-errorwhen E-codigo(Ex) = "00"add 1 to E-contador(Ex)display "--- error tipo exotico: " cod-erroradd 1 to E-contador(Ex)when E-codigo(Ex) = cod-erroradd 1 to E-contador(Ex)display "Error " cod-error " " E-descripcion(Ex)end-search*    agrega a la lista de errores del registroif errIndex < (300 - 59 - 3)move cod-error to E-errores-reg(errIndex:2)add 3 to errIndexmove E-descripcion(Ex) to E-errores-reg(errIndex:59)add 59 to errIndexend-if

exit program.end program PONERR.end program CARGAJUR2.******************************************************************
******************************************************************

$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/indicador de pro*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?if PROCESO-REAL
display pgm " Carga de archivo JURAD - proceso REAL"else
display pgm " Carga de archivo JURAD - proceso en falso"end-if* El indicador de proceso real debe ser SI|si|NO|noif P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAend-if* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01"
display "01 Envio Original - Carga TOTAL 1a vez"when "02"/$CHANGE MODE1 o 2//Address search hit BOTTOM without matching pattern:w"CARGAJUR2.CBL" 1318 lines, 55762 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgsh-CARGAJUR2des-c-v CARGAJUR2sh-CARGAJUR2     fg            rm /d/iccol/desarrollo/macros/sh-CARGAJUR22
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/macros/sh-CARGAJUR22/d/iccol/desarrollo/fuentes>vm /d/iccol/desarrollo/macros/sh-CARGAJUR22/d/iccol/desarrollo/fuentes>vii /d/iccol/desarrollo/macros/sh-CARGAJUR2 
"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8102 characters #sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8102 characters    echo " Procesando $P_NombreArchivoecho "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
nohup x CARGAJUR $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_Nom
breArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~

    

nohup RAPPEND MODE2
m:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 236 lines, 8103 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/macros/sh-CARGAJUR22/d/iccol/desarrollo/fuentes>fg                                         /d/iccol/desarrollo/fuentes>sh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 08:24  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso en falso
El indicador de proceso real es invalido
debe ser 1 o 2
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 08:25:01
Fin de Programa:     2014/05/22 08:25:01

 
-rw-rw-r--   1 icjlud   icdatacr     401 May 22 08:25 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo " Procesando $P_NombreArchivoecho "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
nohup x CARGAJUR2 $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_No
mbreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~2    echo $raya    echo " "    banner CARGAJUR    echo " "    echo $raya    echo " "#echo "+-------------------------------------------------------------+"#echo "|SEGUNDA FASE: PROCESO|"    nohup x CARGAJUR2 $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_No
mbreArchivo.logINSERT MODEe
oc
Nh
_o
P 
$"
 "nohup x CARGAJUR2e
|c
>h
2o
  
g"
oog 2>|
 $P_NombreArchivo.logINSERT MODE"
|" $P_NombreArchivo $O
~#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo/p_proceso/echo " "
echo "opción (123)   ---> \c"
read P_REAL_FALSO
if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO
!= "3" ]
then
echo "\n\tlas opciones válidas son 1, 2 o 3"
else
endLoop=1
fi
    done
}

GetTipoDeProceso()
{
#*-----------------------------------------------------------------------------*
# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...
#*-----------------------------------------------------------------------------*
    echo
echo $raya
    echo "TIPO DE PROCESO"
    echo $raya
    endLoop=0
    P_PROCESO="##"
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo "01 Envio Original  - Carga TOTAL 1a vez"
echo " "
echo "02 Archivo Semanal - Carga PARCIAL"
echo " "
echo "03 Archivo Mensual - Carga PARCIAL"
echo " "
echo "04 Refresque Total - Carga TOTAL"
echo " "
echo "00 Salir"
echo " "
echo "opción (01 02 03 04 00)   ---> \c"
read P_PROCESO
if [ -z "$P_PROCESO" ]
then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
else
if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO !=
"03" ] && [ $P_PROCESO != "04" ] && [ $P_PROCESO != "00" ]then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else//???#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo="1"P_REAL_FALSO    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
echo "nohup x CARGAJUR2" $P_NombreArchivo $P_PROCESO
    nohup x CARGAJUR2 $P_NombreArchivo $P_PROCESO >| $P_NombreArchivo.log 2>| $P_No
mbreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~?P
o_
NR
_E
PA
$L
 _
|F
>A
2L
 S
gO
oOog 2>| $P
_NombreArchivo.log_NombreArchi
vo.logP
i_
hR
cE
rA
AL
e_
rF
bA
mL
oS
NO
_$P_REAL_FALSOO:w"/d/iccol/desarrollo/macros/sh-CARGAJUR2" 237 lines, 8166 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fgsh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 08:28  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR2 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.3
user        0.5
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Start BDIIALE k:000000000000999999000
Va a comenzar la eliminación
BDIIALE eliminado k:100002249789999999000J001    
BDIIALE eliminado k:100002249789999999000J002    
BDIIALE eliminado k:100003295380999999000J001    
BDIIALE eliminado k:100003295380999999000J002    
BDIIALE eliminado k:200800002194999999000J001    
BDIIALE eliminado k:200800002194999999000J002    
BDIIALE eliminado k:200800178009999999000J001    
BDIIALE eliminado k:200800178009999999000J002    
BDIIALE eliminado k:200830067928999999000J001    
BDIIALE eliminado k:200830067928999999000J002    
BDIIALE eliminado k:200890107487999999000J001    
BDIIALE eliminado k:200890107487999999000J002    
BDIIALE eliminado k:200890934264999999000J001    
BDIIALE eliminado k:200890934264999999000J002    
BDIIALE eliminado k:300611000446999999000J001    
BDIIALE eliminado k:300611000446999999000J002    
BDIIALE eliminado k:400000136711999999000J001    
BDIIALE eliminado k:400000136711999999000J002    
BDIIALE eliminado k:400000163597999999000J001    
BDIIALE eliminado k:400000163597999999000J002    
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:100002249789999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:100002249789999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:100002249789999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:100002249789999999000J002     fs:00
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4333-LEER-BDIIALE-RANDOM k:100003295380999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:100003295380999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:100003295380999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:100003295380999999000J002     fs:00
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200800002194999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200800002194999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200800002194999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200800002194999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:200800178009999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200800178009999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200800178009999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200800178009999999000J002     fs:00
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200830067928999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200830067928999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200830067928999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200830067928999999000J002     fs:00
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200890934264999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200890934264999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200890934264999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200890934264999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:200890107487999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200890107487999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200890107487999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200890107487999999000J002     fs:00
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4333-LEER-BDIIALE-RANDOM k:300611000446999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:300611000446999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:300611000446999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:300611000446999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:400000163597999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:400000163597999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:400000163597999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:400000163597999999000J002     fs:00
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4333-LEER-BDIIALE-RANDOM k:400000136711999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:400000136711999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:400000136711999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:400000136711999999000J002     fs:00
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
           -                                                           
           -                                                           
           -                                         0000001701 0000000
  ?0450=  T-vimiento invalido, debe ser I M E T              02 0000000
  ?04509  T-entificacion invalido, debe ser 1 2 3 4          03 0000000
 =52?045  N-identificacion invalido, debe ser numerico       04 0000000
  ?04509  T-entificacion debe ser mayor que cero             05 0000000
 <4105<0  F-ombre o denominacion                             06 0000000
 =52?045  N-demandas vigentes: debe ser numerico             07 0000001
 =52?045  N-demandas terminadas: debe ser numerico           08 0000000
 38105<4  F-ma demanda vigente YYYYMMDD: debe ser numerica   09 0000005
 38105<4  F-ma demanda vigente YYYYMMDD: fuera de rango      10 0000000
 =52?045  N-embargos vigentes: debe ser numerico             11 0000001
 =52?045  N-embargos terminados: debe ser numerico           12 0000000
 38105<4  F-mo embargo vigente YYYYMMDD: debe ser numerica   13 0000004
 38105<4  F-mo embargo vigente YYYYMMDD: fuera de rango      14 0000004
  >5=52?  E-de id no se encuentra en el archivo maestro      15 0000002
  >?=225  E-en el input no coincide con el registrado        16 0000000
 =52?045  N-id fuera del rango del tipo de id informado      00 0000000
 =069>04  -- la lista (cod 00) ---                                     
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           
           -                                                           

Inicio de Programa:  2014/05/22 08:28:21
Fin de Programa:     2014/05/22 08:28:22

 
-rw-rw-r--   1 icjlud   icdatacr   11072 May 22 08:28 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>jobs
[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
[1] - Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>fg 1
ksh: fg: no such job
/d/iccol/desarrollo/fuentes>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
echo "nohup x CARGAJUR2" $P_NombreArchivo $P_REAL_FALSO
    nohup x CARGAJUR2 $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P
_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>jobs
[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
[1] - Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg 2
ksh: fg: no such job
/d/iccol/desarrollo/fuentes>fg [2]
ksh: [2]: Arguments must be %job or process ids
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
echo "nohup x CARGAJUR2" $P_NombreArchivo $P_REAL_FALSO
    nohup x CARGAJUR2 $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P
_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>jobs
[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
[1] - Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
*LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)*LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
*LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
*LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
*LA-parte(LAx, 10) LA-valor(10)
*delimited by high-valueend-if.1000-RUTINA-INICIAL.
******************************************************************
* Todas las operaciones que se realizan una sola vez, al comienzo
* del programa:
*   - obtencion de los parametros
*   - apertura del archivo de entrada
*   - apertura de todos los demas archivos
*   - eliminacion de datos existentes si es refresque completo
******************************************************************
* Registra hora de inicioaccept W-hora-inicio from time* Obtiene informacion sobre la corrida de la linea de comando: el
* nombre del archivo de entrada (que contiene el tipo de proceso),
* el indicador de proceso real o en falso (default)accept P-command-line from COMMAND-LINEdisplay "Parametros: " P-command-lineunstring P-command-line delimited by all " " intoP-file-name P-proceso-real* El programa se anuncia en la consola
* TODO: se usa un anuncio mas vistoso?if PROCESO-REAL
display pgm " Carga de archivo JURAD - proceso REAL"else
display pgm " Carga de archivo JURAD - proceso en falso"end-if* El indicador de proceso real debe ser 1 o 2if P-proceso-real not = "1" and "2"display "El indicador de proceso real es invalido"display "debe ser 1 o 2"perform 9000-CANCELAR-PROGRAMAend-if* TODO: controlar los componentes del filenameevaluate P-tipo-procesowhen "01"
display "01 Envio Original - Carga TOTAL 1a vez"when "02"03 pic x(59) value"Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(59) value"El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(59) value"El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(59) value"Numero de id fuera del rango del tipo de id informado".
*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.03pic xx.03pic x(100).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************
PROCEDURE DIVISION.
*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2REPLACE 1 CHAR3:w"CARGAJUR2.CBL" 1318 lines, 55762 characters ([1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1jobs fg %2fg [2]fg 2  jobsfg  fg 1jobssh-CARGAJUR2fg          sh-CARGAJUR2vi /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/macros/sh-CARGAJUR22/d/iccol/desarrollo/fuentes>fg                                         /d/iccol/desarrollo/fuentes>sh-CARGAJUR2des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24783
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR2
* Data:     24048  Code:     46692  Literals:      2576  Dynamic:   1474560

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR2.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJUR2fg %1            jobs fg %2fg [2]fg 2  jobsfg  fg 1jobssh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 08:36  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR2 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.0
user        0.5
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Start BDIIALE k:000000000000999999000
Va a comenzar la eliminación
BDIIALE eliminado k:100002249789999999000J001    
BDIIALE eliminado k:100002249789999999000J002    
BDIIALE eliminado k:100003295380999999000J001    
BDIIALE eliminado k:100003295380999999000J002    
BDIIALE eliminado k:200800002194999999000J001    
BDIIALE eliminado k:200800002194999999000J002    
BDIIALE eliminado k:200800178009999999000J001    
BDIIALE eliminado k:200800178009999999000J002    
BDIIALE eliminado k:200830067928999999000J001    
BDIIALE eliminado k:200830067928999999000J002    
BDIIALE eliminado k:200890107487999999000J001    
BDIIALE eliminado k:200890107487999999000J002    
BDIIALE eliminado k:200890934264999999000J001    
BDIIALE eliminado k:200890934264999999000J002    
BDIIALE eliminado k:300611000446999999000J001    
BDIIALE eliminado k:300611000446999999000J002    
BDIIALE eliminado k:400000136711999999000J001    
BDIIALE eliminado k:400000136711999999000J002    
BDIIALE eliminado k:400000163597999999000J001    
BDIIALE eliminado k:400000163597999999000J002    
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:100002249789999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:100002249789999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:100002249789999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:100002249789999999000J002     fs:00
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4333-LEER-BDIIALE-RANDOM k:100003295380999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:100003295380999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:100003295380999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:100003295380999999000J002     fs:00
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200800002194999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200800002194999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200800002194999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200800002194999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:200800178009999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200800178009999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200800178009999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200800178009999999000J002     fs:00
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200830067928999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200830067928999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200830067928999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200830067928999999000J002     fs:00
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200890934264999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200890934264999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200890934264999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200890934264999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:200890107487999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200890107487999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200890107487999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200890107487999999000J002     fs:00
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4333-LEER-BDIIALE-RANDOM k:300611000446999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:300611000446999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:300611000446999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:300611000446999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:400000163597999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:400000163597999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:400000163597999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:400000163597999999000J002     fs:00
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4333-LEER-BDIIALE-RANDOM k:400000136711999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:400000136711999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:400000136711999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:400000136711999999000J002     fs:00
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 08:36:27
Fin de Programa:     2014/05/22 08:36:28

 
-rw-rw-r--   1 icjlud   icdatacr    7904 May 22 08:36 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>l $TEMPORALES/999999*
-rw-rw-r--   1 icdgd    icdatacr    1530 May 19 17:27 /d/iccol/desarrollo/temporales/9999991000905140101_ERRORES.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 /d/iccol/desarrollo/temporales/9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 /d/iccol/desarrollo/temporales/9999991000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 /d/iccol/desarrollo/temporales/9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 /d/iccol/desarrollo/temporales/9999991000905140101.txt.orig
-rw-rw-r--   1 icdgd    icdatacr    1530 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104_ERRORES.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 08:36 /d/iccol/desarrollo/temporales/9999991000905140104.errs
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 /d/iccol/desarrollo/temporales/9999991000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr   11275 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104.txt.orig
/d/iccol/desarrollo/fuentes>view /d/iccol/desarrollo/temporales/9999991000905140104.errs
"/d/iccol/desarrollo/temporales/9999991000905140104.errs" [Read only] 17 lines, 2434 characters[Hit return to continue] I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120
406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000
406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984
069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO0050672013040602206720100
435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111
406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130
406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100
806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA0440761998406903400219990
101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131
206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA0330332011140604500120110
402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110
411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131
010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx0150542014010600400320120
406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ033002201312060070rt20110
106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130
111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx0330432013101002204520120
406 15 El nombre en el input no coincide con el registrado
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO0050672013040602206720100435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA0440761998406903400219990101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA0330332011140604500120110402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx0150542014010600400320120406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ033002201312060070rt20110106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx0330432013101002204520120406 15 El nombre en el input no coincide con el registrado
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120
406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000
406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984
069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO0050672013040602206720100
435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111
406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130
406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100
806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA0440761998406903400219990
101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131
206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA0330332011140604500120110
402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110
411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131
010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx0150542014010600400320120
406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ033002201312060070rt20110
106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130
111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx0330432013101002204520120
406 15 El nombre en el input no coincide con el registrado
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:set nowrapwrap: No such option - 'set all' gives all option values:set allnoautoindentnomodelinesshowmodeautoprintnonumbernoslowopennoautowritenonovicetabstop=4nobeautifynooptimizetaglength=0directory=/var/tmpparagraphs=IPLPPPQPP LIpplpipnppplpipbptags=tags /usr/lib/tagsnoedcompatibleprompttagstacknoerrorbellsreadonlyterm=vt220noexrcredrawnoterseflashremaptimeouthardtabs=8report=5ttytype=vt220ignorecasescroll=24warnnolispsections=NHSHH HUuhsh+cwindow=49nolistshell=/bin/kshnowrapscanmagicshiftwidth=4wrapmargin=0mesgshowmatchnowriteany[Hit return to continue] I100000149123JOSE MISAEL AREVALO SANCHEZ0010012013040500905720130
411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE0150202013020602204520120
406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR0020442013050603302020000
406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO0030062013010604407619984
069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO0050672013040602206720100
435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO0060452011040603303320111
406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON0070rt2011010605300120130
406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA0090572013041104550030100
806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA0440761998406903400219990
101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE0220672010043503300220131
206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA0330332011140604500120110
402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA0533000013040601102320110
411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA2322000011050603304320131
010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx0150542014010600400320120
406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ033002201312060070rt20110
106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C0450012011040200804520130
111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx0330432013101002204520120
406 15 El nombre en el input no coincide con el registrado
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
[2] - Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
03 pic x(59) value"Numero de embargos terminados: debe ser numerico".03 pic x(11) value "12 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".03 pic x(11) value "13 0000000 ".03 pic x(59) value"Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".03 pic x(11) value "14 0000000 ".03 pic x(59) value"El numero de id no se encuentra en el archivo maestro".03 pic x(11) value "15 0000000 ".03 pic x(59) value"El nombre en el input no coincide con el registrado".03 pic x(11) value "16 0000000 ".03 pic x(59) value"Numero de id fuera del rango del tipo de id informado".
*----------------- insertar nuevos items aqui -------------------03 pic x(11) value "00 0000000 ".03 pic x(59) value "--- fin de la lista (cod 00) ---".03pic x(3500). *> los 50 items
01 E-errores-2redefines E-errores.03pic xx.03pic x(300).03pic 9(8).03 E-erroroccurs 50 indexed Ex.05 E-codigopic xx.05pic x.05 E-contadorpic 9(7).05pic x.05 E-descripcionpic x(59).
01 E-editpic z(8)B.******************************************************************
* Control de rangos de valores de las fechas del input
01 VALIDACIONES-FECHAS.02 ANO-VAL-Xpic 9(04).88 ANO-VALvalue 1900 thru 2050.02 MES-VAL-Xpic 9(02).88 MES-VALvalue 01   thru 12.02 DIA-VAL-Xpic 9(02).88 DIA-VALvalue 01   thru 31./*****************************************************************
******************************************************************
PROCEDURE DIVISION.
*    0000-PROGRAMA-PRINCIPAL
*    4000-PROCESAR-REGISTRO
*    4000-PROCESAR-REGISTRO-2end-perform.display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-editdisplay N-edit "Modif o elim de alerta inexistente".* Emision del reporte de errores
     display " "
display "Totales por tipo de error detectado:"perform varying Ex from 1 by 1 until Ex > 50or E-codigo(Ex) = "00"if E-contador(Ex) not = 0move E-contador(ex) to E-edit
6 lines deletedOPEN MODE           display "Totales de registros:"
OPEN MODE           display " "
OPEN MODE           compute N-editp100 = 100.0 * E-cont-regs-con-error
OPEN MODE           / N-reg-leidos
OPEN MODE           display N-editp100 "% de registros inconsistentes" 
OPEN MODE           display " "
OPEN MODE           move N-reg-leidos to N-edit 
OPEN MODE           display N-edit "Registros IME en el archivo de entrada"
OPEN MODE           move N-reg-OK to N-edit 
OPEN MODE           display N-edit "Registros procesados sin error"
OPEN MODEdisplay N-edit "Insercion de alerta existente"sAPPEND MODE roundedtp100APPEND MODE rounded

move N-ale-no-existe to N-edit:w"CARGAJUR2.CBL" 1321 lines, 55921 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1jobs view /d/iccol/desarrollo/temporales/9999991000905>/d/iccol/desarrollo/fuentes>l $TEMPORALES/999999*                             /d/iccol/desarrollo/fuentes>sh-CARGAJUR2         des-c-v CARGAJUR2fg %1            des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     2
* Unrecoverable :     0                    Severe  :     2
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       24092     Code:           0

>>> DATACREDITO: ** COMPILANDO CARGAJUR2.CBL HUBO ERRORES...
** ESTAN EN EL ARCHIVO CARGAJUR2.CBL.err


/d/iccol/desarrollo/fuentes>cat CARGAJUR2.CBL.err
* Rejected - OPT
  1921     compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
*  12-S**********************                                          (   0)**
**    Operand N-EDITP100 is not declared
  1923     display N-editp100 "% de registros inconsistentes"
*  12-S**********************                                          (  35)**
**    Operand N-EDITP100 is not declared
cob64: error(s) in compilation: /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
[2] - Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
end-perform.display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"move N-ale-modificadas to N-editdisplay N-edit "Alertas modificadas"move N-ale-eliminadas to N-editdisplay N-edit "Alertas eliminadas"move N-ale-ya-existe to N-editdisplay N-edit "Insercion de alerta existente"move N-ale-no-existe to N-edit*02 Archivo Semanal - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas03 N-ale-eliminadaspic 9(8) value zero.
*    Insercion de alerta existenteOPEN MODE       01 N-editp100                    redefines N-edit
OPEN MODE                                        pic z(5)9.9B.
OPEN MODE*    Alertas eliminadas:w"CARGAJUR2.CBL" 1323 lines, 56032 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1jobs cat CARGAJUR2.CBL.errdes-c-v CARGAJUR2    
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24859
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR2
* Data:     24048  Code:     46836  Literals:      2608  Dynamic:   1474560

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR2.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJUR2fg %1            jobs cat CARGAJUR2.CBL.errdes-c-v CARGAJUR2    fg %1            jobs view /d/iccol/desarrollo/temporales/9999991000905>/d/iccol/desarrollo/fuentes>l $TEMPORALES/999999*                             /d/iccol/desarrollo/fuentes>sh-CARGAJUR2         
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:01  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 999999090514      1990905140104.txt
-9999991990905140104.txt-
no se encuentra el archivo  9999991990905140104.txt
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR2 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.0
user        0.5
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Start BDIIALE k:000000000000999999000
Va a comenzar la eliminación
BDIIALE eliminado k:100002249789999999000J001    
BDIIALE eliminado k:100002249789999999000J002    
BDIIALE eliminado k:100003295380999999000J001    
BDIIALE eliminado k:100003295380999999000J002    
BDIIALE eliminado k:200800002194999999000J001    
BDIIALE eliminado k:200800002194999999000J002    
BDIIALE eliminado k:200800178009999999000J001    
BDIIALE eliminado k:200800178009999999000J002    
BDIIALE eliminado k:200830067928999999000J001    
BDIIALE eliminado k:200830067928999999000J002    
BDIIALE eliminado k:200890107487999999000J001    
BDIIALE eliminado k:200890107487999999000J002    
BDIIALE eliminado k:200890934264999999000J001    
BDIIALE eliminado k:200890934264999999000J002    
BDIIALE eliminado k:300611000446999999000J001    
BDIIALE eliminado k:300611000446999999000J002    
BDIIALE eliminado k:400000136711999999000J001    
BDIIALE eliminado k:400000136711999999000J002    
BDIIALE eliminado k:400000163597999999000J001    
BDIIALE eliminado k:400000163597999999000J002    
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:100002249789999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:100002249789999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:100002249789999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:100002249789999999000J002     fs:00
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
4333-LEER-BDIIALE-RANDOM k:100003295380999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:100003295380999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:100003295380999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:100003295380999999000J002     fs:00
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200800002194999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200800002194999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200800002194999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200800002194999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:200800178009999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200800178009999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200800178009999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200800178009999999000J002     fs:00
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200830067928999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200830067928999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200830067928999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200830067928999999000J002     fs:00
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
4333-LEER-BDIIALE-RANDOM k:200890934264999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200890934264999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200890934264999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200890934264999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:200890107487999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:200890107487999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:200890107487999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:200890107487999999000J002     fs:00
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
4333-LEER-BDIIALE-RANDOM k:300611000446999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:300611000446999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:300611000446999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:300611000446999999000J002     fs:00
4333-LEER-BDIIALE-RANDOM k:400000163597999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:400000163597999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:400000163597999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:400000163597999999000J002     fs:00
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
4333-LEER-BDIIALE-RANDOM k:400000136711999999000J001     fs:23
4300-MODIFICAR-BDIIALE-I k:400000136711999999000J001     fs:00
4333-LEER-BDIIALE-RANDOM k:400000136711999999000J002     fs:23
4300-MODIFICAR-BDIIALE-I k:400000136711999999000J002     fs:00
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 09:01:58
Fin de Programa:     2014/05/22 09:01:59

 
-rw-rw-r--   1 icjlud   icdatacr    7943 May 22 09:01 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>  jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
[2] - Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
*02 Archivo Semanal - Carga PARCIAL*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.03 N-reg-tipo-M-OKpic 9(8) value zero.03 N-reg-tipo-E-OKpic 9(8) value zero.03 N-reg-tipo-I-errpic 9(8) value zero.03 N-reg-tipo-M-errpic 9(8) value zero.03 N-reg-tipo-E-errpic 9(8) value zero.*    Alertas borradas previo al refresque total03 N-ale-leidaspic 9(8) value zero.03 N-ale-borradaspic 9(8) value zero.
*    Alertas insertadas03 N-ale-insertadaspic 9(8) value zero.
*    Alertas modificadas03 N-ale-modificadaspic 9(8) value zero.
*    Alertas eliminadas/display .*4\d\d\d-Address search hit BOTTOM without matching pattern/display.*4300-*    si el registro existia es un errorif EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.
display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE" fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua
******************************************************************
*    si el registro no existia es un errorif EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeend-if
*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALE/     display.*4300-end-if.
display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/*    si el registro existia es un errorif EST-BDIIALE = "00"display "Insercion de alerta nueva que ya existe "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-ya-existeend-if*    completa los datos del registroinitialize ENCABEZADO-BDIIALEmove P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALEFEC-REP-BDIIALEmove P-fecha-proceso-50 to FEC-VEN-BDIIALEmove 0 to BLOQUEO-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.
display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE" fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-M.
******************************************************************
* Modificacion de una alerta existente
* Si no existia muestra un mensaje y continua
******************************************************************
*    si el registro no existia es un errorif EST-BDIIALE not = "00"display "Modificacion de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regdisplay "Datos en la alerta: " INF-DATAHOST-BDIIALEadd 1 to N-ale-no-existeend-if
*    reemplaza la fecha de reporte y los valoresmove P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALEmove D-datahost to INF-DATAHOST-BDIIALEperform 4320-ARMAR-TEXTO-ALERTAif EST-BDIIALE = "00"perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEREPLACE 1 CHAR*
*/end-if.
display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE*
" fs:" EST-BDIIALE.*
/perform 4333-REGRABAR-BDIIALEelse
perform 4333-GRABAR-BDIIALEend-if.
*    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4300-MODIFICAR-BDIIALE-E.
******************************************************************
* Eliminacion de una alerta
* Si no existia muestra un mensaje y continua
******************************************************************
*    elimina el registroif EST-BDIIALE = "00"perform 4333-ELIMINAR-BDIIALEelse
display "Eliminacion de alerta inexistente "" key: " LLAVE-BDIIALEdisplay "Registro de input: "display JURAD-regadd 1 to N-ale-no-existeend-if.
display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE" fs:" EST-BDIIALE.4333-LEER-BDIIALE-RANDOM.
******************************************************************
* Arma clave exacta y lee un registro de BDIIALE
* Usa los datos del reg input, excepto LLASEC que esta precargado
* Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
******************************************************************move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "*
*/Address search hit BOTTOM without matching patterndisplay JURAD-reg-anterior
perform 9000-CANCELAR-PROGRAMA
end-evaluate.
display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
" fs:" EST-BDIIALE.


4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************
if not PROCESO-REAL
exit paragraph
end-if
write REG-BDIIALE
evaluate EST-BDIIALE
when "00"
add 1 to N-ale-insertadas
when other
display "Error al grabar BDIIALE fs: " EST-BDIIALE
" key: " LLAVE-BDIIALE
display "Registro BDIIALE: "
display REG-BDIIALE
perform 9000-CANCELAR-PROGRAMA
end-evaluate.


4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************
if not PROCESO-REAL
exit paragraph


















*
*:w"CARGAJUR2.CBL" 1323 lines, 56032 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1jobs sh-CARGAJUR2des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24635
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR2
* Data:     24048  Code:     46628  Literals:      2504  Dynamic:   1458176

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR2.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJUR2fg %1            jobs sh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:08  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR2 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.0
user        0.5
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Start BDIIALE k:000000000000999999000
Va a comenzar la eliminación
BDIIALE eliminado k:100002249789999999000J001    
BDIIALE eliminado k:100002249789999999000J002    
BDIIALE eliminado k:100003295380999999000J001    
BDIIALE eliminado k:100003295380999999000J002    
BDIIALE eliminado k:200800002194999999000J001    
BDIIALE eliminado k:200800002194999999000J002    
BDIIALE eliminado k:200800178009999999000J001    
BDIIALE eliminado k:200800178009999999000J002    
BDIIALE eliminado k:200830067928999999000J001    
BDIIALE eliminado k:200830067928999999000J002    
BDIIALE eliminado k:200890107487999999000J001    
BDIIALE eliminado k:200890107487999999000J002    
BDIIALE eliminado k:200890934264999999000J001    
BDIIALE eliminado k:200890934264999999000J002    
BDIIALE eliminado k:300611000446999999000J001    
BDIIALE eliminado k:300611000446999999000J002    
BDIIALE eliminado k:400000136711999999000J001    
BDIIALE eliminado k:400000136711999999000J002    
BDIIALE eliminado k:400000163597999999000J001    
BDIIALE eliminado k:400000163597999999000J002    
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 09:08:50
Fin de Programa:     2014/05/22 09:08:51

 
-rw-rw-r--   1 icjlud   icdatacr    5423 May 22 09:08 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
move JURAD-id-tipo to TIP-IDE-BDIIALEmove JURAD-id-numero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove 000 to COD-ALERTA-BDIIALE
*    LLASEC-BDIIALE fué previamente cargado con J001 o J002read BDIIALE
evaluate EST-BDIIALEwhen "00"
continue
when "23"
continue
when other
display "Error al leer BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Ultimo registro procesado: "display JURAD-reg-anteriorperform 9000-CANCELAR-PROGRAMAend-evaluate.
*    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
*    " fs:" EST-BDIIALE.4333-GRABAR-BDIIALE.
******************************************************************
* Inserta un registro nuevo en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphend-if
write REG-BDIIALEevaluate EST-BDIIALEwhen "00"
add 1 to N-ale-insertadaswhen other
display "Error al grabar BDIIALE fs: " EST-BDIIALE" key: " LLAVE-BDIIALEdisplay "Registro BDIIALE: "display REG-BDIIALEperform 9000-CANCELAR-PROGRAMAend-evaluate.4333-REGRABAR-BDIIALE.
******************************************************************
* Regraba un registro modificado en BDIIALE
******************************************************************if not PROCESO-REAL
exit paragraphinspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALEdisplay "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEwhen "00"
*posicionado
display "Va a comenzar la eliminación"when other
*no hay registros
display "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphend-evaluate.*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivoperform until EST-BDIIALE not = "00"read BDIIALE next recordevaluate EST-BDIIALEwhen "00"
*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE
if FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD
delete BDIIALE
if EST-BDIIALE = "00"
display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradaselse
*error en la eliminacion
display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALE$CHANGE MODEcontimueREPLACE 1 CHARn
REPLACE 1 CHAR*REPLACE 1 CHAR*:w"CARGAJUR2.CBL" 1323 lines, 56002 characters :w"CARGAJUR2.CBL" 1323 lines, 56002 characters 
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1sh-CARGAJUR2des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24540
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR2
* Data:     24048  Code:     46548  Literals:      2440  Dynamic:   1458176

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR2.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJUR2fg %1            sh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:14  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR2 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.0
user        0.4
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 09:14:56
Fin de Programa:     2014/05/22 09:14:57

 
-rw-rw-r--   1 icjlud   icdatacr    4348 May 22 09:14 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
inspect LA-parte(LAx, LAy) replacing firsthigh-value by spaceend-performend-perform.1001-ELIMINAR-TODO.
******************************************************************
* Elimina los registros de alertas existentes en el archivo de
* alertas en linea, previo a un refresque total
******************************************************************display "Eliminando toda la informacion con fuente JURAD"
*    posiciona en el primer reg de JURADmove zero to TIP-IDE-BDIIALEmove zero to NUM-IDE-BDIIALEmove P-cod-suscriptor to FUENTE-BDIIALEmove zeros to COD-ALERTA-BDIIALEmove low-values to LLASEC-BDIIALEstart BDIIALE key > LLAVE-BDIIALE
*    display "Start BDIIALE k:" LLAVE-BDIIALEevaluate EST-BDIIALEwhen "00"
*posicionado
continue
when other
*no hay registros
display "No hay registros a eliminar fs:" EST-BDIIALEexit paragraphend-evaluate.*    lee secuencialmente y elimina los registros de JURAD
*    hasta el fin del archivoperform until EST-BDIIALE not = "00"read BDIIALE next recordevaluate EST-BDIIALEwhen "00"
*display "BDIIALE leido fs:" EST-BDIIALE
*" k:" LLAVE-BDIIALE
if FUENTE-BDIIALE = P-cod-suscriptor
*es un alerta de JURAD
delete BDIIALE
if EST-BDIIALE = "00"
*display "BDIIALE eliminado k:" LLAVE-BDIIALEadd 1 to N-ale-borradaselse
*error en la eliminacion
display "Error al eliminar un registro de ""BDIIALE vaciando los datos"
display "Clave: " LLAVE-BDIIALEwhen other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-editdisplay N-edit "Alertas insertadas"
display " ":w"CARGAJUR2.CBL" 1324 lines, 56025 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1sh-CARGAJUR2des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR2.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR2.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR2.CBL
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24547
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR2
* Data:     24048  Code:     46564  Literals:      2440  Dynamic:   1458176

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR2.CBL

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJUR2fg %1            sh-CARGAJUR2
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:16  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR2 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.0
user        0.5
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 09:16:36
Fin de Programa:     2014/05/22 09:16:37

 
-rw-rw-r--   1 icjlud   icdatacr    4350 May 22 09:16 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>l CARGAJUR*
-rw-rw-r--   1 icdgd    icdatacr   52027 May 16 12:17 CARGAJUR-GB.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   53302 May 15 18:19 CARGAJUR.gnt
-rw-rw-r--   1 icdgd    icdatacr  136960 May 15 18:19 CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr   30464 May 15 18:19 CARGAJUR.int
-rw-rw-r--   1 icdgd    icdatacr  153269 May 15 18:19 CARGAJUR.lst
-rw-rw-r--   1 icdgd    icdatacr  382842 May 15 18:19 CARGAJUR.s
-rw-rw-r--   1 icdgd    icdatacr   56025 May 22 09:16 CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>rm CARGAJUR-GB.cbl   CBL
/d/iccol/desarrollo/fuentes>mv CARGAJUR.CBL CARGAJUR.CBL.old
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>mv CARGAJUR.CBL CARGAJUR.CBL.old/d/iccol/desarrollo/fuentes>rm CARGAJUR-GB.CBL              /d/iccol/desarrollo/fuentes>l CARGAJUR*       
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
-rw-rw-r--   1 icdgd    icdatacr   53302 May 15 18:19 CARGAJUR.gnt
-rw-rw-r--   1 icdgd    icdatacr  136960 May 15 18:19 CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr   30464 May 15 18:19 CARGAJUR.int
-rw-rw-r--   1 icdgd    icdatacr  153269 May 15 18:19 CARGAJUR.lst
-rw-rw-r--   1 icdgd    icdatacr  382842 May 15 18:19 CARGAJUR.s
-rw-rw-r--   1 icdgd    icdatacr   56025 May 22 09:16 CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>mv CARGAJUR2.CBL CARGAJUR.CBL
/d/iccol/desarrollo/fuentes>view CARGAJUR.s
"CARGAJUR.s" [Read only] 15203 lines, 382842 characters     .file  "CARGAJUR.cbl".type   ACTALEJUR,2
    .global ACTALEJUR
ACTALEJUR:
    .global $DEFAULT$
$DEFAULT$:
    save%sp,-976,%sp
    callCARGAJUR_init
    stx%i7,[%i6+2023]
    stx%sp,[%i6+1447]
    st%g0,[%i6+1535]
    callL_000972
    ldx[%o7+12],%i1
    nop
.xword L_000585
L_000972:
callCARGAJUR_0x0
    stx%i1,[%i6+1495]
L_000585:
ldx[%i2+32],%i1
    jmpl%i1,%o7
    add%i6,1567,%o0
    ldx[%i6+1983],%i1
    ldx[%i6+2023],%i7
    jmp%i7+8
    restore     %g0,%i1,%o0
CARGAJUR_cancel:
    save%sp,-976,%sp
    callCARGAJUR_init
    stx%i7,[%i6+2023]
    stx%sp,[%i6+1447]
    callCARGAJUR_0x566a
    st%g0,[%i6+1535]
    ldx[%i2+32],%i1
    jmpl%i1,%o7
    add%i6,1567,%o0
    ldx[%i6+2023],%i7
    jmp%i7+8
    restore     %g0,%i7,%o0
CARGAJUR_init:
    sub%sp,32,%sp
    stx%o7,[%sp+2255]
    callL_000973
    ldx[%o7+12],%i2
    nop
.xword toc_base
L_000973:
ldx[%i2+0],%i3
    ldx[%i2+8],%i5"CARGAJUR.s" [Read only] 15203 lines, 382842 characters line 1 of 15203 --0%--     .file  "CARGAJUR.cbl".type   ACTALEJUR,2
    .global ACTALEJUR
ACTALEJUR:
    .global $DEFAULT$
$DEFAULT$:
    save%sp,-976,%sp
    callCARGAJUR_init
    stx%i7,[%i6+2023]
    stx%sp,[%i6+1447]
    st%g0,[%i6+1535]
    callL_000972
    ldx[%o7+12],%i1
    nop
.xword L_000585
L_000972:
callCARGAJUR_0x0
    stx%i1,[%i6+1495]
L_000585:
ldx[%i2+32],%i1
    jmpl%i1,%o7
    add%i6,1567,%o0
    ldx[%i6+1983],%i1
    ldx[%i6+2023],%i7
    jmp%i7+8
    restore     %g0,%i1,%o0
CARGAJUR_cancel:
    save%sp,-976,%sp
    callCARGAJUR_init
    stx%i7,[%i6+2023]
    stx%sp,[%i6+1447]
    callCARGAJUR_0x566a
    st%g0,[%i6+1535]
    ldx[%i2+32],%i1
    jmpl%i1,%o7
    add%i6,1567,%o0
    ldx[%i6+2023],%i7
    jmp%i7+8
    restore     %g0,%i7,%o0
CARGAJUR_init:
    sub%sp,32,%sp
    stx%o7,[%sp+2255]
    callL_000973
    ldx[%o7+12],%i2
    nop
.xword toc_base
L_000973:
ldx[%i2+0],%i3
    ldx[%i2+8],%i5    ldx[%i2+8],%i5ldx[%i2+16],%i4
    ldx[%i6+2023],%i0
    stx%i0,[%i6+1503]
    mov2255,%i1
    st%i1,[%i6+1487]
    stx%g0,[%i6+1607]
    ldsw[%i0+8],%i0
    sethi2094623,%i1
    xor%i1,-993,%i1
    cmp%i0,%i1
    be,pn%xcc,L_000586
    nop
lduh[%i6+1665],%i0
    sethi32,%i1
    or%i0,%i1,%i1
    sth%i1,[%i6+1665]
    stx%g0,[%i6+1567]
    baL_000587
    stx%g0,[%i6+1511]
    nop
L_000586:
ldx[%i6+2159],%i1
    add%i1,2031,%i1
    ldx[%i1+0],%i0
    stx%i0,[%i6+1567]
    ldx[%i1+8],%i1
    stx%i1,[%i6+1511]
    subcc%i0,0,%g0
    be,pn%xcc,L_000587
    nop
ldx[%i0+40],%i1
    stx%i1,[%i6+1607]
L_000587:
add%i5,-4080,%o0
    stx%o0,[%i6+1583]
    ld[%i5-3992],%i1
    and%i1,8,%i1
    subcc%i1,0,%g0
    be,pn%xcc,L_000589
    nop
add%i4,-4096,%o1
    sethi22,%o2
    add%o2,1008,%o2
    mov104,%o3
    ldx[%i2+24],%o4
    ldx[%i2+40],%i1
    jmpl%i1,%o7
    mov32,%o5    mov32,%o5
L_000589:
mov128,%i1
    st%i1,[%i6+1663]
    stx%g0,[%i6+1575]
    ldx[%i5-4072],%i1
    stx%i1,[%i6+1591]
    add%i6,1439,%i1
    stx%i1,[%i6+1615]
    add%i6,1311,%i1
    stx%i1,[%i6+1623]
    add%i6,1671,%l0
    stx%l0,[%i6+1471]
    add%i6,1719,%i1
    stx%i1,[%i6+1479]
    stx%g0,[%i6+1647]
    add%i6,1567,%i0
    ldx[%i2+48],%i1
    jmpl%i1,%o7
    mov%i0,%o0
    mov48,%o2
    ldx[%i2+56],%i1
    mov%l0,%o0
    jmpl%i1,%o7
    mov%g0,%o1
    stx%i0,[%i6+2031]
    ldx[%sp+2255],%i1
    jmp%i1+8
    add%sp,32,%sp
    nop
nop
nop
CARGAJUR_0x0:
    sub%sp,32,%sp
    stx%o7,[%sp+2255]
    callCARGAJUR_0xf
    nop

!   1202     perform 1000-RUTINA-INICIAL
!   1203*    procesa cada uno de los registros del archivo JURAD hasta
!   1204*    encontrar el registro "T" de totalescallCARGAJUR_1000-RUTINA-INICIAL
    nop

!   1205     perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
!   1206*    cierra archivos y produce el reporte finalnop:q/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>view CARGAJUR.smv CARGAJUR2.CBL CARGAJUR.CBL/d/iccol/desarrollo/fuentes>l CARGAJUR*                  /d/iccol/desarrollo/fuentes>
-rw-rw-r--   1 icdgd    icdatacr   56025 May 22 09:16 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
-rw-rw-r--   1 icdgd    icdatacr   53302 May 15 18:19 CARGAJUR.gnt
-rw-rw-r--   1 icdgd    icdatacr  136960 May 15 18:19 CARGAJUR.idy
-rw-rw-r--   1 icdgd    icdatacr   30464 May 15 18:19 CARGAJUR.int
-rw-rw-r--   1 icdgd    icdatacr  153269 May 15 18:19 CARGAJUR.lst
-rw-rw-r--   1 icdgd    icdatacr  382842 May 15 18:19 CARGAJUR.s
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>l CARGAJUR*l CARGAJUR2*
CARGAJUR2*: No such file or directory
/d/iccol/desarrollo/fuentes>rm CARGAJUR.gnt CARGAJUR.idy CARGAJUR.int CARGAJUR.lst CARGAJUR.s
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm CARGAJUR.gnt CARGAJUR.idy CARGAJUR.int CARGAJU>/d/iccol/desarrollo/fuentes>l CARGAJUR2*                                      /d/iccol/desarrollo/fuentes>
CARGAJUR2*: No such file or directory
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>l CARGAJUR2*rm CARGAJUR.gnt CARGAJUR.idy CARGAJUR.int CARGAJU>/d/iccol/desarrollo/fuentes>l CARGAJUR2*                                      /d/iccol/desarrollo/fuentes>l CARGAJUR* 
-rw-rw-r--   1 icdgd    icdatacr   56025 May 22 09:16 CARGAJUR.CBL
-rw-rw-r--   1 icdgd    icdatacr   52072 May 16 17:26 CARGAJUR.CBL.old
/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
[2] - Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
when other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-edit:file CAR"CARGAJUR2.CBL" line 1167 of 1324 --88%-- :file CARGAJUR.cbl"CARGAJUR.cbl" [Not edited] line 1167 of 1324 --88%-- :w"CARGAJUR.cbl" [New file] 1324 lines, 56025 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
echo "nohup x CARGAJUR2" $P_NombreArchivo $P_REAL_FALSO
    nohup x CARGAJUR2 $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P
_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR22
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo/jur2JUR/# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
echo "nohup x CARGAJUR2" $P_NombreArchivo $P_REAL_FALSO
    nohup x CARGAJUR2 $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P
_NombreArchivo.log
#   activar programa CARGAJUR2!!!
#   CARGAJUR2 dele user 1|2 para real o falso
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~JUR/JUR_
NombreArchivo.logJUR/~~/Address search hit BOTTOM without matching pattern#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echocomo :file[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR
-rwxrwxr-x   1 icdgd    icdatacr    8380 May 19 11:15 /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>mv /d/iccol/desarrollo/macros/sh-CARGAJUR /d/iccol/desarrollo/macros/sh-CARGAJUR.old
/d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR*
-rwxrwxr-x   1 icdgd    icdatacr    8380 May 19 11:15 /d/iccol/desarrollo/macros/sh-CARGAJUR.old
-rwxrwxr-x   1 icdgd    icdatacr    8166 May 22 08:27 /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo:file /d/iccol/desarrollo/macros/sh-CARGAJUR"/d/iccol/desarrollo/macros/sh-CARGAJUR" [Not edited] [Modified] line 1 of 235 --0%--[Hit return to continue] 
:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" [New file] 235 lines, 8082 characters[Hit return to continue] #sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>chmod +x /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>chmod +x /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>fg %2                                          /d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR*/d/iccol/desarrollo/fuentes>mv /d/iccol/desarrollo/macros/sh-CARGAJUR /d/icco>/d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR*         /d/iccol/desarrollo/fuentes>
-rwxrwxr-x   1 icjlud   icdatacr    8082 May 22 09:29 /d/iccol/desarrollo/macros/sh-CARGAJUR
-rwxrwxr-x   1 icdgd    icdatacr    8380 May 19 11:15 /d/iccol/desarrollo/macros/sh-CARGAJUR.old
-rwxrwxr-x   1 icdgd    icdatacr    8166 May 22 08:27 /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR* /d/iccol/desarrollo/fuentes>
-rwxrwxr-x   1 icjlud   icdatacr    8082 May 22 09:29 /d/iccol/desarrollo/macros/sh-CARGAJUR
-rwxrwxr-x   1 icdgd    icdatacr    8380 May 19 11:15 /d/iccol/desarrollo/macros/sh-CARGAJUR.old
/d/iccol/desarrollo/fuentes>sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:32  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
    echo real:  P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso:  P_PROCESO
nohup x CARGAJUR 9999991000905140104.txt 1
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso en falso
El indicador de proceso real es invalido
debe ser S o N
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 09:32:57
Fin de Programa:     2014/05/22 09:32:57

 
-rw-rw-r--   1 icjlud   icdatacr     401 May 22 09:32 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
when other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-edit[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo    echo $rayaecho " Procesando $P_NombreArchivo
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
echo "nohup x CARGAJUR" $P_NombreArchivo $P_REAL_FALSO
    nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P_
NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~

 APPEND MODE"
    


OPEN MODE~REPLACE 1 CHAR#:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 235 lines, 8083 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %2fg %1sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:34  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
sh-CARGAJUR[216]: syntax error at line 234 : `"' unmatched
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
when other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-edit[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo $rayaecho " Procesando $P_NombreArchivo "
    echo "real: " P_REAL_FALSO "archivo:  $P_NombreArchivo " tipo de proceso: " P_P
ROCESO
#   echo "nohup x CARGAJUR" $P_NombreArchivo $P_REAL_FALSO
    nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P_
NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~    echo " "    banner CARGAJUR    echo " "    echo $raya    echo " "#echo "+-------------------------------------------------------------+"#echo "|SEGUNDA FASE: PROCESO|"#echo "+-------------------------------------------------------------+"# cp $P_NombreArchivo $cadena00# cadena00=$archivo.orig# echo "+-------------------------------------------------------------+"# echo "| Registros iniciales archivo de entrada : " $numeroreg# echo "+-------------------------------------------------------------+"# echo# numeroreg=`wc -l < $P_NombreArchivo archivo`# echo "+-------------------------------------------------------------+"# fechab=$P_FCORTE# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "# echo "+-------------------------------------------------------------+"# echo "+-------------------------------------------------------------+"




:REPLACE 1 CHAR"al:R
OCESO:O
CESO

~:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 234 lines, 8022 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %2fg %1sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:40  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso en falso
El indicador de proceso real es invalido
debe ser S o N
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 09:40:45
Fin de Programa:     2014/05/22 09:40:45

 
-rw-rw-r--   1 icjlud   icdatacr     401 May 22 09:40 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>sh-CARGAJURfg %2      fg %1sh-CARGAJURfg %2      fg %1sh-CARGAJURl /d/iccol/desarrollo/macros/sh-CARGAJUR*/d/iccol/desarrollo/fuentes>rm /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR* /d/iccol/desarrollo/fuentes>chmod +x /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo/fuentes>fg %2                                          /d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR*/d/iccol/desarrollo/fuentes>mv /d/iccol/desarrollo/macros/sh-CARGAJUR /d/icco>/d/iccol/desarrollo/fuentes>l /d/iccol/desarrollo/macros/sh-CARGAJUR          /d/iccol/desarrollo/fuentes>fg %2                                   /d/iccol/desarrollo/fuentes>fg %1jobs l CARGAJUR*l CARGAJUR2*rm CARGAJUR.gnt CARGAJUR.idy CARGAJUR.int CARGAJU>/d/iccol/desarrollo/fuentes>l CARGAJUR2*                                      /d/iccol/desarrollo/fuentes>l CARGAJUR* view CARGAJUR.smv CARGAJUR2.CBL CARGAJUR.CBL/d/iccol/desarrollo/fuentes>l CARGAJUR*                  /d/iccol/desarrollo/fuentes>mv CARGAJUR.CBL CARGAJUR.CBL.old/d/iccol/desarrollo/fuentes>rm CARGAJUR-GB.CBL              /d/iccol/desarrollo/fuentes>l CARGAJUR*       sh-CARGAJUR2des-c-v CARGAJUR2fg %1            des-c-v CARGAJUR2
Ejecucion de la macro de compilacion cobol para desarrollo
**** ATENCION: EL ARCHIVO NO EXISTE 

/d/iccol/desarrollo/fuentes>



/d/iccol/desarrollo/fuentes>/d/iccol/desarrollo/fuentes>/d/iccol/desarrollo/fuentes>/d/iccol/desarrollo/fuentes>fu
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fudes-c-v CARGAJUR2des-c-v CARGAJUR 
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24547
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:     24048  Code:     46564  Literals:      2440  Dynamic:   1458176

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfu              des-c-v CARGAJUR2sh-CARGAJUR      
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:42  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
-9999991000905140104.txt-
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.3
user        0.5
sys         0.7
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 09:42:26
Fin de Programa:     2014/05/22 09:42:27

 
-rw-rw-r--   1 icjlud   icdatacr    4350 May 22 09:42 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
when other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-edit[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P_
NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else
echo "El código de suscriptor en el nombre del archivo no c
oincide"
fi
else
echo "El nombre del archivo no condice con el tipo de proceso"
$P_PROCESO
fi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]
then
exit
fi
GetNombreDelArchivo
if [ -z "$P_NombreArchivo" ]
then
exit
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"if [ -z "$P_PROCESO" ]then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
else
if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO !=
"03" ] && [ $P_PROCESO != "04" ] && [ $P_PROCESO != "00" ]then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
echo "-"$P_NombreArchivo"-"
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo/"-"endLoop=1fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
echo "-"$P_NombreArchivo"-"
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else
echo "El código de suscriptor en el nombre del archivo no c
oincide"fi:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 233 lines, 7986 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %2fg %1sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:43  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.1
user        0.4
sys         0.6
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 09:43:37
Fin de Programa:     2014/05/22 09:43:38

 
-rw-rw-r--   1 icjlud   icdatacr    4350 May 22 09:43 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>cat 9999991000905140104.errs
cat: cannot open 9999991000905140104.errs
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cat 9999991000905140104.errscat $9999991000905140104.errsT9999991000905140104.errsE9999991000905140104.errsM9999991000905140104.errsP9999991000905140104.errsO9999991000905140104.errsR9999991000905140104.errsA9999991000905140104.errsL9999991000905140104.errsE9999991000905140104.errsS9999991000905140104.errs/9999991000905140104.errs
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO                                 0050672013040602206720100435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA                                  0330332011140604500120110402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx                                       0150542014010600400320120406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx                                       0330432013101002204520120406 15 El nombre en el input no coincide con el registrado
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
when other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-edit[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
endLoop=1fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else
echo "El código de suscriptor en el nombre del archivo no c
oincide"
fi    echo " "echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P_
NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
when other*lectura anormal: cancelacion del programadisplay "Error en lectura del archivo de alertas ""online"
display "File status: " EST-BDIIALEperform 9000-CANCELAR-PROGRAMA *> no retornaend-evaluateend-perform.
display "Termino la eliminacion total de JURAD"display "Reg borrados: " N-ale-borradas.7000-RUTINA-FINAL.
******************************************************************
* Registra hora de finalizacionaccept W-hora-fin from time* Leer JURAD a ver si hay registros despues del "T"* Close todos los archivosclose JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.* Emision de contadores de registrosdisplay " "
display "Totales de registros:"display " "
compute N-editp100 rounded = 100.0 * E-cont-regs-con-error/ N-reg-leidosdisplay N-editp100 "% de registros inconsistentes"move N-reg-leidos to N-editdisplay N-edit "Registros IME en el archivo de entrada"move N-reg-OK to N-editdisplay N-edit "Registros procesados sin error"* >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
* definicion de estos contadores
*    move N-reg-tipo-I-OK to N-edit
*    display N-edit "Registros tipo I aceptados"
*    move N-reg-tipo-M-OK to N-edit
*    display N-edit "Registros tipo M aceptados"
*    move N-reg-tipo-E-OK to N-edit
*    display N-edit "Registros tipo E aceptados"move E-cont-regs-con-error to N-reg-con-errormove N-reg-con-error to N-editdisplay N-edit "Registros con error"move N-ale-borradas to N-editdisplay N-edit "Alertas borradas previo al refresque total"move N-ale-insertadas to N-edit$SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************/errs////* Registro de totales de control T*    Tipo de Novedad = "T"03 JURADT-tipo-novedadpic x.03pic x.
*    Cantidad de registros03 JURADT-registrospic 9(11).03pic x.
*    Total numero de demandas vigentes03 JURADT-demandas-vigentes  pic 9(7).03pic x.
*    Total numero de demandas terminadas03 JURADT-demandas-terminadas pic 9(7).03pic x.
*    Total numero de embargos vigentes03 JURADT-embargos-vigentes  pic 9(7).03pic x.
*    Total numero de embargos terminados03 JURADT-embargos-terminados pic 9(7).03pic x(41).******************************************************************
* Archivo de salida con los registros defectuosos del arch JURAD
******************************************************************
FD ERRS.
01  ERRS-reg.
*    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales03 ERRS-tipo-novedadpic x.
*    Tipo de identificacion Numero {1, 2, 3, 4}03 ERRS-id-tipopic x.
*    Numero de identificacion03 ERRS-id-numeropic x(11).
*    Nombres y Apellidos03 ERRS-nombrepic x(45).
*    Numero de demandas vigentes03 ERRS-demandas-vigentes    pic 999.
*    Numero de demandas terminadas03 ERRS-demandas-terminadas  pic 999.
*    Fecha ultima demanda vigente YYMMDD03 ERRS-demandas-fecha-ultima pic x(8).
*    Numero de embargos vigentes03 ERRS-embargos-vigentes    pic 999.
*    Numero de embargos terminados03 ERRS-embargos-terminados  pic 999.
*    Fecha ultimo embargo vigente YYMMDD03 ERRS-embargos-fecha-ultimo pic x(8).
*    Causa del rechazo03 ERRS-causa-rechazopic x(300).******************************************************************/******************************************************************* Contiene los ids y nombres de personas
******************************************************************
copy BDIIREGI.FD.******************************************************************
* Maestro de personas juridicas nacionales y extranjeras reportada
* por la DIAN
******************************************************************
copy BDIIDIAN.FD.******************************************************************
* Archivo maestro de cedulas de extranjeria suministrado por DAS
******************************************************************
copy BDIIDAS.FD.******************************************************************
* Maestro de alertas reportadas por suscriptores
******************************************************************
copy BDIIALE.FD.******************************************************************
WORKING-STORAGE section.
******************************************************************
* Nombre del programa
01  pgmpic x(10) value "CARGAJUR".******************************************************************
* Variables para rutina de validacion de identificaciones
******************************************************************
copy BDIIVIDE.WS.******************************************************************
* Variables relacionadas con las alertas del sistema
******************************************************************
copy BDIIALE.WS.******************************************************************
* Datos para las rutinas de validacion de nombres de VALNOM.PROC
******************************************************************
copy VALNOM.WS.*****************************************************************
* Direcciones de los archivos en el file system
*****************************************************************
copy ICFILE.WS.******************************************************************
* Indica que se termino el proceso, por agotamiento del archivo/* de entrada (normal) o alguna otra condicion (error)
01  IND-fin-procesopic xx value "NO".

* Copia del ultimo reg de input, para mensajes (Ult reg: ...)
01  JURAD-reg-anteriorpic x(100) value "(vacio)".
01  JURAD-fspic xx value spaces.

01  ERRS-fspic xx value spaces.01  ERRS-fspic xx value spaces.* Datos de demandas o embargos que van en el registro BDIIALE
01 D-datahost.
05 D-vigentespic 9(5).05 D-terminadospic 9(5).05 D-fecha-ultimapic x(8).
******************************************************************
* Parametros iniciales, de la linea de comando
* La linea de comando que contiene los parametros
01 P-command-linepic x(80) value spaces.
01 P-parametros.
*    Proceso real: contiene "1" para activar, "2" por defecto03 P-proceso-realpic xx value "2".88 PROCESO-REALvalue "1".*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo./open.*errsdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADevaluate JURAD-fs
when "00"
continue
when other
display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name(1:19) ".errs"into ERRS-file-nameopen output ERRSevaluate ERRS-fs
when "00"
continue
when other
display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.* Si es un refresque total (codigo 04) se eliminan los registros:w"CARGAJUR.cbl" 1324 lines, 56019 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %1fg %2fg %1cat $TEMPORALES/9999991000905140104.errs/d/iccol/desarrollo/fuentes>cat 9999991000905140104.errs            /d/iccol/desarrollo/fuentes>sh-CARGAJUR                 fg %2      fg %1sh-CARGAJURdes-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24530
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:     24048  Code:     46548  Literals:      2432  Dynamic:   1458176

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg %1           fg %2fg %1cat $TEMPORALES/9999991000905140104.errs/d/iccol/desarrollo/fuentes>cat 9999991000905140104.errs            /d/iccol/desarrollo/fuentes>sh-CARGAJUR                 
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:48  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Error en open del archivo de errores 
Nombre del archivo: $TEMPORALES/9999991000905140104.txt                                             
File status: 9A
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 09:48:30
Fin de Programa:     2014/05/22 09:48:30

 
-rw-rw-r--   1 icjlud   icdatacr     556 May 22 09:48 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
[2] - Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo " "echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $P_NombreArchivo.log 2>| $P_
NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $P_NombreArchivo.log
    echo " "
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~>| INSERT MODE$
_T
PE
$M
 P
|O
>R
2A
 L
gE
oS
l/
.2>| $TEMPORALES/
    




ls -lrt $TEMPORALES/>> $TEMPORALES/
    ::ls -lrt $TEMPORALES/    cat $TEMPORALES/:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 233 lines, 8058 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %2jobs sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 09:55  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        0.0
user        0.0
sys         0.0
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Error en open del archivo de errores 
Nombre del archivo: $TEMPORALES/9999991000905140104.txt                                             
File status: 9A
 
CARGAJUR   - proceso cancelado

Inicio de Programa:  2014/05/22 09:56:08
Fin de Programa:     2014/05/22 09:56:08

 
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 /d/iccol/desarrollo/temporales/9999991000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104.txt.orig
-rw-rw-r--   1 icdgd    icdatacr     810 May 22 09:56 /d/iccol/desarrollo/temporales/9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>jobs
[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
[1] - Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADevaluate JURAD-fs
when "00"
continue
when other
display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name ".errs"into ERRS-file-nameopen output ERRSevaluate ERRS-fs
when "00"
continue
when other
display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.* Si es un refresque total (codigo 04) se eliminan los registros"CARGAJUR.cbl" line 1033 of 1324 --78%-- /errs-file-name?*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAend-if.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************move JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazowrite ERRS-regevaluate ERRS-fs
when "00"
continue
when other
display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAgobackend-evaluate.4320-ARMAR-TEXTO-ALERTA.
****************************************************************
* Hace el reemplazo de los valores adecuados en los templates
* de las linea de alerta que corresponde
****************************************************************
*    segun se trate de demandas o embargosif JURAD-demandas-vigentes not = 0or JURAD-demandas-terminadas not = 0set LAx to 1
move high-values to LA-valoresmove JURAD-demandas-vigentes to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(1)
*delimited by all spacemove LA-numx(9:12) to LA-valor(1)move JURAD-demandas-terminadas to LA-num
* >>>> esto esta anulado x que no se como hacer para que lo compile
*unstring LA-numX into LA-descarte LA-valor(2)
*delimited by all space??
*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.?* Actualizacion del archivo de alertas con los datos provistos* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
******************************************************************
DATA DIVISION.
FILE section./
*    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt03 P-file-namepic x(80) value spaces.03 P-file-name-Rredefines P-file-name.
*JJJJJJ = Codigo de suscriptor JURAD en Experian05 P-cod-suscriptorpic 9(6).
*aaa = Codificacion del producto ("100")05 P-productopic xxx.
*DDMMAA = Fecha de proceso05 P-fecha-procesopic x(6).
*bb =  01 a CI
05 P-ci-bipic xx.
*XX = Tipo de proceso
*01 Envio Original - Carga TOTAL - primera vez
*02 Archivo Semanal - Carga PARCIAL
*03 Archivo Mensual - Carga PARCIAL
*04 Refresque Total - Carga TOTAL05 P-tipo-procesopic xx.
*extension del archivo ".txt"05 P-extensionpic x(4).05pic x(57).03 P-file-pathpic x(80) value spaces.
* Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs03 ERRS-file-namepic x(80) value spaces.* Fecha de proceso editada YYYYMMDD
01 P-fecha-proceso-YYYYMMDDpic x(8).
* Fecha de proceso + 50 años
01 P-fecha-proceso-50.03  P-fecha-proceso-50YYYY   pic 9999.03pic x(4).
******************************************************************
* Datos para el reporte final
01 W-tiempo.
03 W-hora-iniciopic 9(8).03 W-hora-finpic 9(8).
01 N-editpic z(8)B.
01 N-editp100redefines N-edit
pic z(5)9.9B.
01 N-contadores.
*    Registros en el archivo de entrada03 N-reg-leidospic 9(8) value zero.
*    Registros procesados sin error03 N-reg-OKpic 9(8) value zero.
*    Registros con error03 N-reg-con-errorpic 9(8) value zero.*    Cantidades de registros por tipo de novedad03 N-reg-tipo-I-OKpic 9(8) value zero.INSERT MODE /continueelse
display " "
display "No coincide total de embargos vigentes:"JURADT-embargos-vigentes " con el calculado:"N-embargos-vigentesmove "SI" to E-hay-errorend-if

if function numval(JURADT-embargos-terminados)= N-embargos-terminadoscontinue
else
display " "
display "No coincide total de embargos terminados:"JURADT-embargos-terminados " con el calculado:"N-embargos-terminadosmove "SI" to E-hay-errorend-if.*    si hubo cualquier cosa se invalida el procesoif E-hay-error = "SI"display "Error en registro T de totales de control"display "Nombre del archivo: " ERRS-file-nameperform 9000-CANCELAR-PROGRAMAend-if.4900-GRABAR-ERROR.
******************************************************************
* El registro de JURAD tiene error: se graba en el archivo ERRS
* con indicacion del error detectado
******************************************************************move JURAD-reg to ERRS-regmove E-errores-reg to ERRS-causa-rechazo
*    lista de los codigos de los errores del registromove E-errores-reg to ERRS-causa-rechazowrite ERRS-regevaluate ERRS-fs
when "00"
continue
when other
display "Error al grabar el archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMAgobackend-evaluate.//into P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADevaluate JURAD-fs
when "00"
continue
when other
display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name ".errs"into ERRS-file-nameopen output ERRSevaluate ERRS-fs
when "00"
continue
when other
display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>^[[C  /d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo " "echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo
.log 2>| $TEMPORALES/$P_NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    ls -lrt $TEMPORALES/$P_NombreArchivo* >> $TEMPORALES/$P_NombreArchivo.log
    ls -lrt $TEMPORALES/$P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %1
vi CARGAJUR2.CBL
into P-fecha-proceso-YYYYMMDDdisplay "Fecha de proceso: " P-fecha-proceso-YYYYMMDD* Calcula una fecha 50 anios posterior a la de procesomove P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50add 50 to P-fecha-proceso-50YYYY* Apertura del archivo de entradastring "$TEMPORALES/" P-file-name into P-file-pathopen input JURADevaluate JURAD-fs
when "00"
continue
when other
display "Error en open del archivo JURAD "display "Path del archivo: " P-file-pathdisplay "File status: " JURAD-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura del archivo de erroresstring "$TEMPORALES/" P-file-name ".errs"into ERRS-file-nameopen output ERRSevaluate ERRS-fs
when "00"
continue
when other
display "Error en open del archivo de errores "display "Nombre del archivo: " ERRS-file-namedisplay "File status: " ERRS-fsperform 9000-CANCELAR-PROGRAMA *> no retornagobackend-evaluate.* Apertura de los archivos maestros
* TODO: falta capturar el status de estas operaciones?open input BDIIREGIopen input BDIIDIANopen input BDIIDAS.* Apertura del archivo de alertas en lineaif PROCESO-REAL
open i-o BDIIALEelse
open input BDIIALEend-if.eAPPEND MODE delimited " "" $CHANGE MODEspace:w"CARGAJUR.cbl" 1324 lines, 56035 characters [1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>1vkk    ^[  /d/iccol/desarrollo/fuentes>fg %1fg %2fg %1jobs sh-CARGAJURfg %2      jobs sh-CARGAJURdes-c-v CARGAJURfg %1           des-c-v CARGAJUR
Ejecucion de la macro de compilacion cobol para desarrollo
cob64 -C nolist -CC -KPIC -A -KPIC -N PIC -uv -g -P -C sourceasm /d/iccol/desarrollo/fuentes/CARGAJUR.cbl 
* Micro Focus Server Express         V5.1 revision 000           Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - VERBOSE
* Accepted - NOANIM
* Accepted - NOBOUND
* Accepted - NOALTER
* Accepted - COMP
* Accepted - TRUNC
* Accepted - int("CARGAJUR.int")
* Accepted - anim
* Accepted - csi
* Accepted - verbose
* Accepted - nolist
* Accepted - sourceasm
* Accepted - list("CARGAJUR.lst")
* Compiling /d/iccol/desarrollo/fuentes/CARGAJUR.cbl
".............COMPILANDO BDIIREGI SIN STATUS.........."
".............COMPILANDO BDIIDIAN SIN STATUS.........."
".............COMPILANDO BDIIDAS SIN STATUS.........."
".............COMPILANDO BDIIALE SIN STATUS.........."
* Total Messages:     0
* Data:       24312     Code:       24688
* Micro Focus Server Express V5.1.00 Code Generator
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Accepted - verbose
* Accepted - anim
* Accepted - PIC
* Generating CARGAJUR
* Data:     24048  Code:     46820  Literals:      2432  Dynamic:   1474560

>>> DATACREDITO: TERMINO OK COMPILACION DE CARGAJUR.cbl

/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>des-c-v CARGAJURfg %1           fg %2fg %1jobs sh-CARGAJURfg %2      sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 10:02  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.1
user        0.5
sys         0.6
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 10:02:48
Fin de Programa:     2014/05/22 10:02:49

 
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 /d/iccol/desarrollo/temporales/9999991000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:02 /d/iccol/desarrollo/temporales/9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4718 May 22 10:02 /d/iccol/desarrollo/temporales/9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>pwd
/d/iccol/desarrollo/fuentes
/d/iccol/desarrollo/fuentes>cd -
/d/iccol/desarrollo/fuentes
/d/iccol/desarrollo/fuentes>cd -
/d/iccol/desarrollo/fuentes
/d/iccol/desarrollo/fuentes>cd $TEMPORALES
/d/iccol/desarrollo/temporales>cd -
/d/iccol/desarrollo/fuentes
/d/iccol/desarrollo/fuentes>jobs
[1] + Stopped (SIGTSTP)        vi CARGAJUR2.CBL
[2] - Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
    echo " "echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo
.log 2>| $TEMPORALES/$P_NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    ls -lrt $TEMPORALES/$P_NombreArchivo* >> $TEMPORALES/$P_NombreArchivo.log
    ls -lrt $TEMPORALES/$P_NombreArchivo*
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~    banner CARGAJUR    echo " "    echo $raya    echo " "#echo "+-------------------------------------------------------------+"#echo "|SEGUNDA FASE: PROCESO|"#echo "+-------------------------------------------------------------+"# cp $P_NombreArchivo $cadena00# cadena00=$archivo.orig# echo "+-------------------------------------------------------------+"# echo "| Registros iniciales archivo de entrada : " $numeroreg# echo "+-------------------------------------------------------------+"# echo# numeroreg=`wc -l < $P_NombreArchivo archivo`# echo "+-------------------------------------------------------------+"# fechab=$P_FCORTE# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "# echo "+-------------------------------------------------------------+"






    cat $TEMPORALES/$P_NombreArchivo.logca$CHANGE MODEcd/DAddress search hit BOTTOM without matching pattern
    ls -lrt >> 
    ls -lrt 
OPEN MODEcd -    cd -:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 235 lines, 8047 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>man l
No manual entry for l.
/d/iccol/desarrollo/fuentes>man ls
Reformatting page.  Please Wait... done

User Commands                                               ls(1)

NAME
     ls - list contents of directory

SYNOPSIS
     /usr/bin/ls  [-aAbcCdeEfFghHilLmnopqrRstuvVx1@] [file]...

     /usr/xpg4/bin/ls  [-aAbcCdeEfFghHilLmnopqrRstuvVx1@]
      [file]...

     /usr/xpg6/bin/ls  [-aAbcCdeEfFghHilLmnopqrRstuvVx1@]
      [file]...

DESCRIPTION
     For each file that is a directory, ls lists the contents  of
     the  directory.  For  each file that is an ordinary file, ls
     repeats its name and any other  information  requested.  The
     output is sorted alphabetically by default. When no argument
     is given, the current directory (.) is listed. When  several
     arguments   are   given,  the  arguments  are  first  sorted
     appropriately, but file arguments appear before  directories
     and their contents.

     There are three major listing formats.  The  default  format
     for  output  directed  to  a  terminal  is multi-column with
     entries sorted down the columns. The -1 option allows single
     column  output and -m enables stream output format. In order
     to determine output formats for the -C, -x, and -m  options,
     ls  uses  an environment variable, COLUMNS, to determine the
     number of character positions available on one output  line.
     If  this  variable  is  not set, the terminfo(4) database is
     used to determine  the  number  of  columns,  based  on  the
     environment  variable,  TERM.  If this information cannot be
     obtained, 80 columns are assumed.

     The mode printed when the -e, -E, -g, -l, -n, -o, -v, -V, or
     -@  option  is  in effect consists of eleven characters. The
     first character can be one of the following:

     d            The entry is a directory.

     D            The entry is a door.

     l            The entry is a symbolic link.

SunOS 5.10          Last change: 10 Feb 2009                    1
--More--(5%)
User Commands                                               ls(1)

     b            The entry is a block special file.

     c            The entry is a character special file.

     p            The entry is a FIFO (or "named  pipe")  special
                  file.

     P            The entry is an event port.

     s            The entry is an AF_UNIX address family socket.

     -            The entry is an ordinary file.

     The next 9 characters are interpreted as three sets of three
     bits  each. The first set refers to the owner's permissions;
     the next to permissions of others in the user-group  of  the
     file; and the last to all others. Within each set, the three
     characters indicate permission to read,  to  write,  and  to
     execute  the  file  as a program, respectively. For a direc-
     tory, execute permission is interpreted to  mean  permission
     to  search the directory for a specified file. The character
     after permissions is an ACL or extended  attributes  indica-
     tor. This character is an @ if extended attributes are asso-
     ciated with the file and the -@ option is in effect.  Other-
     wise,  this character is a plus sign (+) character if a non-
     trivial ACL is associated with the file or a space character
     if not.

     ls -l (the long list) prints its output as follows  for  the
     POSIX locale:

       -rwxrwxrwx+ 1 smith dev   10876  May 16 9:42 part2

     Reading from right to left, you see that the current  direc-
     tory  holds  one file, named part2. Next, the last time that
     file's contents were modified was 9:42 A.M. on May  16.  The
     file  contains 10,876 characters, or bytes. The owner of the
     file, or the user, belongs to the group dev  (perhaps  indi-
     cating ``development''), and his or her login name is smith.
     The number, in this case 1, indicates the number of links to
     file  part2  (see cp(1)). The plus sign indicates that there

SunOS 5.10          Last change: 10 Feb 2009                    2

User Commands                                               ls(1)
--More--(10%)
     is an ACL associated with the file. If  the  -@  option  has
     been  specified,  the presence of extended attributes super-
     sede the presence of an ACL and the plus  sign  is  replaced
     with  an  'at'  sign (@). Finally, the dash and letters tell
     you that user, group, and others have permissions  to  read,
     write, and execute part2.

     The execute (x) symbol here occupies the third  position  of
     the  three-character  sequence.  A  -  in the third position
     would have indicated a denial of execution permissions.

     The permissions are indicated as follows:

     r            The file is readable.

     w            The file is writable.

     x            The file is executable.

     -            The indicated permission is not granted.

     s            The set-user-ID or set-group-ID bit is on,  and
                  the  corresponding  user or group execution bit
                  is also on.

     S            Undefined bit-state (the  set-user-ID  or  set-
                  group-id bit is on and the user or group execu-
                  tion bit is off). For group  permissions,  this
                  applies only to non-regular files.

     t            The 1000 (octal) bit, or sticky bit, is on (see
                  chmod(1)), and execution is on.

     T            The 1000 bit is turned on, and execution is off
                  (undefined bit-state).

  /usr/bin/ls
     l            Mandatory locking occurs during  access  (on  a
                  regular  file,  the  set-group-ID bit is on and
                  the group execution bit is off).

SunOS 5.10          Last change: 10 Feb 2009                    3

User Commands                                               ls(1)

  /usr/xpg4/bin/ls and /usr/xpg6/bin/ls
     L            Mandatory locking occurs during  access  (on  a
--More--(15%)                  regular  file,  the  set-group-ID bit is on and
                  the group execution bit is off).

     For user and group permissions, the third position is  some-
     times occupied by a character other than x or -. s or S also
     can occupy this position, referring  to  the  state  of  the
     set-ID  bit,  whether  it  be the user's or the group's. The
     ability to assume the same ID as the user  during  execution
     is,  for  example,  used during login when you begin as root
     but need to assume the identity of the user you login as.

     In the case of the sequence  of  group  permissions,  l  can
     occupy  the  third  position. l refers to mandatory file and
     record locking. This permission describes a  file's  ability
     to  allow other files to lock its reading or writing permis-
     sions during access.

     For others permissions, the third position can  be  occupied
     by  t  or  T. These refer to the state of the sticky bit and
     execution permissions.

OPTIONS
     The following options are supported:

  /usr/bin/ls, /usr/xpg4/bin/ls, and /usr/xpg6/bin/ls
     The following options are supported for all three versions:

     -a           Lists all entries, including those  that  begin
                  with a dot (.), which are normally not listed.

     -A           Lists all entries, including those  that  begin
                  with a dot (.), with the exception of the work-
                  ing directory  (.)  and  the  parent  directory
                  (..).

     -b           Forces printing of non-printable characters  to
                  be in the octal \ddd notation.

     -c           Uses time of last modification  of  the  i-node
                  (file  created, mode changed, and so forth) for
                  sorting (-t) or printing (-l or -n).

SunOS 5.10          Last change: 10 Feb 2009                    4

User Commands                                               ls(1)

     -C           Multi-column output with  entries  sorted  down
                  the columns. This is the default output format.
--More--(21%)
--More--(21%)     -d           If an argument is a directory, lists  only  its
--More--(21%)                  name  (not its contents). Often used with -l to
--More--(22%)                  get the status of a directory.
--More--(22%)
--More--(22%)     -e           The same as -l, except  displays  time  to  the
--More--(22%)                  second,  and  with  one  format  for  all files
--More--(22%)                  regardless of age: mmm dd hh:mm:ss yyyy.
--More--(22%)
--More--(22%)     -E           The same as -l, except  displays  time  to  the
--More--(22%)                  nanosecond  and  with  one format for all files
--More--(23%)                  regardless       of       age:       yyyy-mm-dd
--More--(23%)                  hh:mm:ss.nnnnnnnnn (ISO 8601:2000 format).
--More--(23%)
--More--(23%)                  In addition, this option  displays  the  offset
--More--(23%)                  from  UTC  in  ISO  8601:2000  standard  format
--More--(23%)                  (+hhmm or -hhmm) or no characters if the offset
--More--(24%)                  is  indeterminable.  The  offset  reflects  the
--More--(24%)                  appropriate standard  or  alternate  offset  in
--More--(24%)                  force  at  the  file's displayed date and time,
--More--(24%)                  under the current timezone.
--More--(24%)
     -f           Forces each argument to  be  interpreted  as  a
                  directory and list the name found in each slot.
                  This option turns off -l, -t, -s, and  -r,  and
                  turns  on  -a.  The order is the order in which
                  entries appear in the directory.

     -g           The same as -l, except that the  owner  is  not
                  printed.

     -h           All sizes are scaled to a human  readable  for-
                  mat,  for  example,  14K,  234M, 2.7G, or 3.0T.
                  Scaling is done  by  repetitively  dividing  by
                  1024.

     -H           If an argument is a symbolic link  that  refer-
                  ences  a  directory,  this option evaluates the
                  file information and file type of the directory
                  that  the link references, rather than those of
                  the link itself. However, the name of the  link
                  is displayed, rather than the referenced direc-
                  tory.

SunOS 5.10          Last change: 10 Feb 2009                    5

User Commands                                               ls(1)

     -i           For each file, prints the i-node number in  the
                  first column of the report.

     -l           Lists in long format, giving mode, ACL  indica-
                  tion,  number  of  links, owner, group, size in
                  bytes, and time of last modification  for  each
                  file  (see  above).  If  the  file is a special
                  file, the size field instead contains the major
                  and  minor  device numbers. If the time of last
                  modification is greater than six months ago, it
                  is  shown  in  the format `month date year' for
                  the  POSIX  locale.  When  the  LC_TIME  locale
                  category is not set to the POSIX locale, a dif-
                  ferent format of the time field  can  be  used.
                  Files  modified  within  six months show `month
                  date time'. If the file is a symbolic link, the
                  filename  is  printed  followed by "->" and the
                  path name of the referenced file.

     -L           If an argument is a symbolic link, this  option
                  evaluates the file information and file type of
--More--(31%)                  the file or directory that the link references,
                  rather  than those of the link itself. However,
                  the name of the link is displayed, rather  than
                  the referenced file or directory.

     -m           Streams output format. Files are listed  across
                  the page, separated by commas.

     -n           The same as -l, except that the owner's UID and
                  group's  GID  numbers  are printed, rather than
                  the associated character strings.

     -o           The same as -l, except that the  group  is  not
                  printed.

     -p           Puts a slash (/) after  each  filename  if  the
                  file is a directory.

     -q           Forces printing of non-printable characters  in
                  file names as the character question mark (?).

     -r           Reverses the  order  of  sort  to  get  reverse
                  alphabetic or oldest first as appropriate.

SunOS 5.10          Last change: 10 Feb 2009                    6

User Commands                                               ls(1)

     -R           Recursively lists subdirectories encountered.

     -s           Indicate the total number of file system blocks
                  consumed by each file displayed.

     -t           Sorts by time stamp (latest first)  instead  of
                  by  name.  The default is the last modification
                  time. (See -u and -c.)

     -u           Uses time of last access instead of last modif-
                  ication  for  sorting  (with  the -t option) or
                  printing (with the -l option).

     -v           The same as -l, except that verbose ACL  infor-
                  mation  is  displayed as well as the -l output.
                  ACL information is displayed even if  the  file
                  or directory doesn't have an ACL.

     -V           The same as -l, except that compact ACL  infor-
                  mation is displayed after the -l output.
--More--(36%)
                  The -V option is only applicable to  file  sys-
                  tems  that  support  NFSv4  ACLs,  such  as the
                  Solaris ZFS file system.

                  The format of the displayed ACL is as follows:

                    entry_type : permissions : inheritance_flags : access_type

                  entry_type is displayed as one of  the  follow-
                  ing:

                  user:username

                      Additional user access for username.

                  group:groupname

                      Additional group access  for  group  group-
                      name.

                  owner@

                      File owner.

SunOS 5.10          Last change: 10 Feb 2009                    7

User Commands                                               ls(1)

                  group@

                      File group owner.

                  everyone@

                      Everyone access, including file  owner  and
                      file group owner. This is not equivalent to
                      the POSIX other class.

                  The following  permissions,  supported  by  the
                  NFSv4 ACL model, are  displayed by using the -v
                  or -V options:

                  read_data (r)               Permission to  read
                                              the data of a file.

                  list_directory (r)          Permission to  list
                                              the  contents  of a
--More--(41%)/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>man lsman l fg %2jobs cd -cd $TEMPORALEScd -          cd -pwd sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 10:11  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.0
user        0.4
sys         0.5
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 10:11:27
Fin de Programa:     2014/05/22 10:11:28

 
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 9999991000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:11 9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:11 9999991000905140104.txt.log
/d/iccol/desarrollo/fuentes
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>jobs
[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
[1] - Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo
.log 2>| $TEMPORALES/$P_NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    cd $TEMPORALES
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    cd -
echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
OPEN MODEecho "Archivos en \$TEMPORALES:"    echo "Archivos en \$TEMPORALES:"    :w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 236 lines, 8081 characters [2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>fg %2jobs sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 10:12  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 99999910009051401014.txt
no se encuentra el archivo  99999910009051401014.txt
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.1
user        0.5
sys         0.6
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 10:13:30
Fin de Programa:     2014/05/22 10:13:31

 
Archivos en $TEMPORALES:
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 9999991000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:13 9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:13 9999991000905140104.txt.log
/d/iccol/desarrollo/fuentes
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>jobs
[2] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
[1] - Stopped (SIGTSTP)        vi CARGAJUR2.CBL
/d/iccol/desarrollo/fuentes>fg %2
vi /d/iccol/desarrollo/macros/sh-CARGAJUR2
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PRO
CESO
nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo
.log 2>| $TEMPORALES/$P_NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    cd $TEMPORALES
    echo "Archivos en \$TEMPORALES:"
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    cd -
echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~


cd -APPEND MODE > /dev/null:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 236 lines, 8093 characters :q/d/iccol/desarrollo/fuentes>f ^[  /d/iccol/desarrollo/fuentes>fg %2jobs sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 10:15  en 172.16.10.5)
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      999999100ddmmaa0104.txt
 ---> 9999991000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 9999991000905140104.txt 
real: P_REAL_FALSO archivo: 9999991000905140104.txt  tipo de proceso: P_PROCESO
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        1.1
user        0.5
sys         0.6
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000020
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      20 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 10:15:32
Fin de Programa:     2014/05/22 10:15:33

 
Archivos en $TEMPORALES:
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 9999991000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:15 9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:15 9999991000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/fuentes>cat  $TEMPORALES/9999991000905140104.txt.errs
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO                                 0050672013040602206720100435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA                                  0330332011140604500120110402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx                                       0150542014010600400320120406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx                                       0330432013101002204520120406 15 El nombre en el input no coincide con el registrado
/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cat  $TEMPORALES/9999991000905140104.txt.errs/d/iccol/desarrollo/fuentes>
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO                                 0050672013040602206720100435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA                                  0330332011140604500120110402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx                                       0150542014010600400320120406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx                                       0330432013101002204520120406 15 El nombre en el input no coincide con el registrado
/d/iccol/desarrollo/fuentes>
shell will timeout in 60 seconds due to inactivity
ksh: timed out waiting for input
You have running jobs
