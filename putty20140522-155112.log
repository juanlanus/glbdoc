=~=~=~=~=~=~=~=~=~=~=~= PuTTY log 2014.05.22 15:51:12 =~=~=~=~=~=~=~=~=~=~=~=
login as: icjlud
Using keyboard-interactive authentication.
Password: 
Last login: Thu May 22 06:49:19 2014 from 172.16.10.5
Sun Microsystems Inc.   SunOS 5.10      Generic January 2005
COBJVM=sun_142
JAVA_HOME=/usr/j2se
LD_LIBRARY_PATH=/usr/j2se/jre/lib/sparc:/usr/j2se/jre/lib/sparc/client:/usr/j2se/jre/lib/sparc/native_threads:/usr/j2se/jre/lib/sparc:/opt/mfocus/des/cobol/lib:/opt/IBM/db2/V9.7/lib:/export/home/db2inst1/sqllib/lib64:/export/home/db2inst1/sqllib/lib32
PATH=/usr/j2se/jre/sh:/usr/j2se/sh:/usr/j2se/bin:/usr/j2se/jre/bin:/opt/mfocus/des/cobol/lib:/opt/mfocus/des/cobol/bin:/usr/bin:/bin:/usr/bin:/d/iccol/desarrollo/macros:/d/iccol/desarrollo/utiles:/opt/bin:/usr/sbin:/usr/lib:/usr/ccs/bin:/opt/SUNWspro/bin:/usr/jdk/latest/bin:/usr/local/bin:/usr/j2se/bin:/usr/openwin/bin:.:/export/home/db2inst1/sqllib/bin:/export/home/db2inst1/sqllib/adm:/export/home/db2inst1/sqllib/misc
CLASSPATH=/opt/mfocus/des/cobol/lib/mfcobol.jar:.:/usr/j2se/jre/lib/rt.jar:/opt/mfocus/des/cobol/lib/mfimtk.jar:/opt/mfocus/des/cobol/lib/xerces.jar:/opt/mfocus/des/cobol/lib/castor-0_9_4_1-xml.jar:/opt/mfocus/des/cobol/lib/mfcobol.jar:/usr/j2se/jre/lib/dt.jar:/usr/j2se/jre/lib/rt.jar:/d/iccol/desarrollo/java/server:/export/home/db2inst1/sqllib/java/db2java.zip:/export/home/db2inst1/sqllib/java/db2jcc.jar:/export/home/db2inst1/sqllib/java/sqlj.zip:/export/home/db2inst1/sqllib/function:/export/home/db2inst1/sqllib/java/db2jcc_license_cu.jar:.
COBCPY=/opt/mfocus/des/cobol/cpylib:/opt/mfocus/des/cobol/cpylib:/d/iccol/desarrollo/copys/pais:/d/iccol/desarrollo/copys
Java version = 1.4.2_19
Java vendor = Sun Microsystems Inc.
Java OS name = SunOS
Java OS arch = sparc
Java OS version = 5.10

  ####    ####   #####   ######   ####
 #    #  #    #  #    #  #       #
 #       #    #  #    #  #####    ####
 #       #    #  #    #  #            #
 #    #  #    #  #    #  #       #    #
  ####    ####   #####   ######   ####

 #####
#     #   ####   #        ####   #    #  #####      #      ##
#        #    #  #       #    #  ##  ##  #    #     #     #  #
#        #    #  #       #    #  # ## #  #####      #    #    #
#        #    #  #       #    #  #    #  #    #     #    ######
#     #  #    #  #       #    #  #    #  #    #     #    #    #
 #####    ####   ######   ####   #    #  #####      #    #    #

 #####
#     #   ####   #    #  #####      #    #         ##     ####      #     ####
#        #    #  ##  ##  #    #     #    #        #  #   #    #     #    #    #
#        #    #  # ## #  #    #     #    #       #    #  #          #    #    #
#        #    #  #    #  #####      #    #       ######  #          #    #    #
#     #  #    #  #    #  #          #    #       #    #  #    #     #    #    #
 #####    ####   #    #  #          #    ######  #    #   ####      #     ####

 #####                                           #####  #         ###
#     #  #    #  #    #          #    #         #     # #    #   #   #
#        #    #  ##   #          #    #               # #    #  #     #
 #####   #    #  # #  #          #    #          #####  #    #  #     #
      #  #    #  #  # #          #    #   ###   #       ####### #     #
#     #  #    #  #   ##           #  #    ###   #            #   #   #
 #####    ####   #    # #######    ##     ###   #######      #    ###

icjlud@codes /d/iccol/desarrollo
$ . viset
viset running
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>. visetcat  $TEMPORALES/9999991000905140104.txt.errs/d/iccol/desarrollo>cat  $TEMPORALES/9999991000905140104.txt.errs/d/iccol/desarrollo>sh-CARGAJUR                                  /d/iccol/desarrollo>
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 13:54  en 172.16.10.27
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 3
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>sh-CARGAJUR. viset    cat  $TEMPORALES/9999991000905140104.txt.errs/d/iccol/desarrollo>cat  $TEMPORALES/9999991000905140104.txt.errs/d/iccol/desarrollo>sh-CARGAJUR                                  /d/iccol/desarrollo>fg %2      jobs sh-CARGAJURfg %2      jobs sh-CARGAJURman ls     man l fg %2jobs cd -cd $TEMPORALEScd -          cd -pwd sh-CARGAJURdes-c-v CARGAJURfg %1           fg %2fg %1jobs sh-CARGAJURfg %2      jobs sh-CARGAJURdes-c-v CARGAJURfg %1           fg %2fg %1cat $TEMPORALES/9999991000905140104.errs/d/iccol/desarrollo>cat 9999991000905140104.errs            /d/iccol/desarrollo>sh-CARGAJUR                 /d/iccol/desarrollo>cat 9999991000905140104.errs/d/iccol/desarrollo>sh-CARGAJUR                 /d/iccol/desarrollo>fg %2      fg %1sh-CARGAJURdes-c-v CARGAJURfu              des-c-v CARGAJUR2sh-CARGAJUR      fg %2      fg %1sh-CARGAJURfg %2      fg %1sh-CARGAJURl /d/iccol/desarrollo/macros/sh-CARGAJUR*/d/iccol/desarrollo>rm /d/iccol/desarrollo/macros/sh-CARGAJUR2/d/iccol/desarrollo>l /d/iccol/desarrollo/macros/sh-CARGAJUR* /d/iccol/desarrollo> /d/iccol/desarrollo/macros/sh-CARGAJUR* /d/iccol/desarrollo>v /d/iccol/desarrollo/macros/sh-CARGAJUR*/d/iccol/desarrollo>vi /d/iccol/desarrollo/macros/sh-CARGAJUR*/d/iccol/desarrollo>vii /d/iccol/desarrollo/macros/sh-CARGAJUR 
"/d/iccol/desarrollo/macros/sh-CARGAJUR" 236 lines, 8093 characters #sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="999999"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo"/d/iccol/desarrollo/macros/sh-CARGAJUR" 236 lines, 8093 characters/99999999999$CHANGE MODE000001/then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "999999100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
elseREPLACE MODE000001#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="000001"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echocodsusthen
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo "000001100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
elseecho "      INSERT MODE$$codsuss00000$CHANGE MODE"INSERT MODE"/Address search hit BOTTOM without matching pattern/999999Address search hit BOTTOM without matching pattern?Address search hit TOP without matching pattern/Address search hit BOTTOM without matching pattern:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 236 lines, 8096 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>vi /d/iccol/desarrollo/macros/sh-CARGAJUR/d/iccol/desarrollo>sh-CARGAJUR                              /d/iccol/desarrollo>
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 13:56  en 172.16.10.27
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01 Envio Original  - Carga TOTAL 1a vez
 
      02 Archivo Semanal - Carga PARCIAL
 
      03 Archivo Mensual - Carga PARCIAL
 
      04 Refresque Total - Carga TOTAL
 
      00 Salir
 
           opción (01 02 03 04 00)   ---> 04
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      000001100ddmmaa0104.txt
 ---> 9999991000905140104.txt
El código de suscriptor en el nombre del archivo no coincide
 
 Ingrese el nombre del archivo o enter para salir:
      000001100ddmmaa0104.txt
 ---> 0000011000905140104.txt
no se encuentra el archivo  0000011000905140104.txt
 
 Ingrese el nombre del archivo o enter para salir:
      000001100ddmmaa0104.txt
 ---> 
/d/iccol/desarrollo>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR
then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo ""$codsus"100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else    echo $rayaP_REAL_FALSO="#";
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo "1) Proceso en falso"
echo " "
echo "2) Proceso real"
echo " "
echo "3) Salir"
echo " "
echo "opción (123)   ---> \c"
read P_REAL_FALSO
if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO != "3" ]
then
echo "\n\tlas opciones válidas son 1, 2 o 3"
else
endLoop=1
fi
    done
}

GetTipoDeProceso()
{
#*-----------------------------------------------------------------------------*
# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...
#*-----------------------------------------------------------------------------*
    echo
echo $raya
    echo "TIPO DE PROCESO"
    echo $raya
    endLoop=0
    P_PROCESO="##"
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo "01 Envio Original  - Carga TOTAL 1a vez"
echo " "
echo "02 Archivo Semanal - Carga PARCIAL"
echo " "
echo "03 Archivo Mensual - Carga PARCIAL"
echo " "
echo "04 Refresque Total - Carga TOTAL"
echo " "
echo "00 Salir"
echo " "1APPEND MODE)

INSERT MODE)

)

)

)
echo " "
echo "opción (01 02 03 04 00)   ---> \c"
read P_PROCESO
if [ -z "$P_PROCESO" ]
then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
else
if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO != "03" ] && [ $P_PROCESO
!= "04" ] && [ $P_PROCESO != "00" ]then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo ""$codsus"100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]    P_REAL_FALSO="#";endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo "1) Proceso en falso"
echo " "
echo "2) Proceso real"
echo " "
echo "3) Salir"
echo " "
echo "opción (123)   ---> \c"
read P_REAL_FALSO
if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO != "3" ]
then
echo "\n\tlas opciones válidas son 1, 2 o 3"
else
endLoop=1
fi
    done
}

GetTipoDeProceso()
{
#*-----------------------------------------------------------------------------*
# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...
#*-----------------------------------------------------------------------------*
    echo
echo $raya
    echo "TIPO DE PROCESO"
    echo $raya
    endLoop=0
    P_PROCESO="##"
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo "01) Envio Original  - Carga TOTAL 1a vez"
echo " "
echo "02) Archivo Semanal - Carga PARCIAL"
echo " "
echo "03) Archivo Mensual - Carga PARCIAL"
echo " "
echo "04) Refresque Total - Carga TOTAL"
echo " "
echo "00) Salir"
echo " "
echo "opción (01 02 03 04 00)   ---> \c"
echo " "
echo "opción (01 02 03 04 00)   ---> \c"
read P_PROCESO
if [ -z "$P_PROCESO" ]
then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
else
if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO != "03" ] && [ $P_PROCESO
!= "04" ] && [ $P_PROCESO != "00" ]then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"else
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo ""$codsus"100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]    echo
    echo $raya#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else
echo "El código de suscriptor en el nombre del archivo no coincide"fi
else
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fi
    done
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]
then
exit
fi
GetNombreDelArchivo
if [ -z "$P_NombreArchivo" ]
then
exit
fi

# echo (esto no está refactoreado)
# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" P_REAL_FALSO "archivo:" $P_NombreArchivo " tipo de proceso:" P_PROCESO
    nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo.log 2>| $TEMPORALES/$P
_NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    cd $TEMPORALES
    echo "Archivos en \$TEMPORALES:"
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    cd - > /dev/null
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~

echo INSERT MODE$fP^?$$:w"/d/iccol/desarrollo/macros/sh-CARGAJUR" 238 lines, 8099 characters [1] + Stopped (SIGTSTP)        vi /d/iccol/desarrollo/macros/sh-CARGAJUR
/d/iccol/desarrollo>l 999999*
-rw-rw-r--   1 icjlud   icdatacr     401 May 22 07:39 9999991000905140104.txt.log
/d/iccol/desarrollo>rm 9999991000905140104.txt.log
/d/iccol/desarrollo>l $TEMPORALES/999999*
-rw-rw-r--   1 icdgd    icdatacr    1530 May 19 17:27 /d/iccol/desarrollo/temporales/9999991000905140101_ERRORES.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 /d/iccol/desarrollo/temporales/9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 /d/iccol/desarrollo/temporales/9999991000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 /d/iccol/desarrollo/temporales/9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 /d/iccol/desarrollo/temporales/9999991000905140101.txt.orig
-rw-rw-r--   1 icdgd    icdatacr    1530 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104_ERRORES.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 09:43 /d/iccol/desarrollo/temporales/9999991000905140104.errs
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 /d/iccol/desarrollo/temporales/9999991000905140104.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:15 /d/iccol/desarrollo/temporales/9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:15 /d/iccol/desarrollo/temporales/9999991000905140104.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104.txt.orig
/d/iccol/desarrollo>clear
/d/iccol/desarrollo>^[  /d/iccol/desarrollo>clearl $TEMPORALES/999999*/d/iccol/desarrollo>
-rw-rw-r--   1 icdgd    icdatacr    1530 May 19 17:27 /d/iccol/desarrollo/temporales/9999991000905140101_ERRORES.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 /d/iccol/desarrollo/temporales/9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 /d/iccol/desarrollo/temporales/9999991000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 /d/iccol/desarrollo/temporales/9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 /d/iccol/desarrollo/temporales/9999991000905140101.txt.orig
-rw-rw-r--   1 icdgd    icdatacr    1530 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104_ERRORES.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 09:43 /d/iccol/desarrollo/temporales/9999991000905140104.errs
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 /d/iccol/desarrollo/temporales/9999991000905140104.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:15 /d/iccol/desarrollo/temporales/9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:15 /d/iccol/desarrollo/temporales/9999991000905140104.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 /d/iccol/desarrollo/temporales/9999991000905140104.txt.orig
/d/iccol/desarrollo>rm /d/iccol/desarrollo/temporales/9999991000905140101_ERRORES.txt
/d/iccol/desarrollo>rm /d/iccol/desarrollo/temporales/9999991000905140104_ERRORES.txt
/d/iccol/desarrollo>te
/d/iccol/desarrollo/temporales>l 999999*
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 9999991000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 9999991000905140101.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 09:43 9999991000905140104.errs
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 9999991000905140104.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:15 9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:15 9999991000905140104.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 9999991000905140101.txt^[  /d/iccol/desarrollo/temporales> 9999991000905140101.txt                      <
"/tmp/sh9091.2" 1 line, 51 characters mv 9999991000905140101.txt 9999991000905140101.txt
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"/tmp/sh9091.2" 1 line, 51 charactersmv REPLACE MODE000001
1000905140101.txt
1000905140101.txt
~"/tmp/sh9091.2" 1 line, 51 characters mv 9999991000905140101.txt 0000011000905140101.txt
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 0000011000905140101>/d/iccol/desarrollo/temporales>mv 9999991000905140101                                               
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 0000011000905140101>/d/iccol/desarrollo/temporales>mv 999999100090514010144txt 0000011000905140101.txt                   <4
/d/iccol/desarrollo/temporales>l 999999* 000001*
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 0000011000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 0000011000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    5151 May 19 11:17 9999991000905140101.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 9999991000905140101.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 09:43 9999991000905140104.errs
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:15 9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:15 9999991000905140104.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
/d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log 9999991000905140104.errs 9999991000905140104.txt.errs9999991000905140104.txt.log 
9999991000905140104.txt.errs9999991000905140104.txt.log: No such file or directory
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 0000011000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 0000011000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 9999991000905140101.txt.orig
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 10:15 9999991000905140104.txt.errs
-rw-rw-r--   1 icdgd    icdatacr    4594 May 22 10:15 9999991000905140104.txt.log
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>l 999999* 000001*rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>mv 9999991000905140104.txt 0000011000905140104>/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 0000011000905140101/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 9999991000905140101/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 0000011000905140101/d/iccol/desarrollo/temporales>mv 9999991000905140104.txt 0000011000905140104/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>                 l 999999* 000001*rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>mv 9999991000905140104.txt 0000011000905140104>/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 0000011000905140101/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 9999991000905140101/d/iccol/desarrollo/temporales>l 999999*                                      /d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 9999991000905140101>/d/iccol/desarrollo/temporales>mv 9999991000905140101.txt 0000011000905140101/d/iccol/desarrollo/temporales>mv 9999991000905140104.txt 0000011000905140104/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>                 l 999999* 000001*rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log999991000905140104.errs 9999991000905140104.tx*91000905140101.txt.log 9999991000905140104.err9999991000905140104./d/iccol/desarrollo/temporales>99991000905140104.errs 9999991000905140104.txt9999991000905140104./d/iccol/desarrollo/temporales>9999991000905140104.txt.errs999999100090514010.errs 99999910009051401
9999991000905140101.txt.log: No such file or directory
9999991000905140104.errs: No such file or directory
/d/iccol/desarrollo/temporales>^[  /d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>rm 9999991000905140101.txt.log 999999100090514>/d/iccol/desarrollo/temporales>l 999999* 000001*                              /d/iccol/desarrollo/temporales>
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:06 0000011000905140101.txt
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 0000011000905140104.txt
-rw-rw-r--   1 icdgd    icdatacr    2427 May 19 10:31 9999991000905140101_ori.txt
-rw-rw-r--   1 icdgd    icdatacr    2464 May 19 12:12 9999991000905140101.txt.orig
-rw-rw-r--   1 icdgd    icdatacr    2436 May 20 14:55 9999991000905140104.txt.orig
/d/iccol/desarrollo/temporales>rm 9999991000905140101_ori.txt
/d/iccol/desarrollo/temporales>sh-CARGAJUR
.........................................
---------------------------------------------------
 
                D A T A C R E D I T O
 
              Cargue de archivo de JURAD
 
Fecha: 20140522 14:13  en 172.16.10.27
 

---------------------------------------------------
              PROCESO REAL O EN FALSO
---------------------------------------------------
 
        1) Proceso en falso
 
        2) Proceso real
 
        3) Salir
 
             opción (123)   ---> 1

---------------------------------------------------
                  TIPO DE PROCESO
---------------------------------------------------
 
      01) Envio Original  - Carga TOTAL 1a vez
 
      02) Archivo Semanal - Carga PARCIAL
 
      03) Archivo Mensual - Carga PARCIAL
 
      04) Refresque Total - Carga TOTAL
 
      00) Salir
 
           opción (01 02 03 04 00)   ---> 04

---------------------------------------------------
                NOMBRE DEL ARCHIVO
---------------------------------------------------
 
 Ingrese el nombre del archivo o enter para salir:
      000001100ddmmaa0104.txt
 ---> 0000011000905140104.txt
 
---------------------------------------------------
 
 #####     #    ######   #####     #          # #     # ######
#     #   # #   #     # #     #   # #         # #     # #     #
#        #   #  #     # #        #   #        # #     # #     #
#       #     # ######  #  #### #     #       # #     # ######
#       ####### #   #   #     # ####### #     # #     # #   #
#     # #     # #    #  #     # #     # #     # #     # #    #
 #####  #     # #     #  #####  #     #  #####   #####  #     #

 
---------------------------------------------------
 Procesando 0000011000905140104.txt 
real: 1  tipo de proceso: 04
---------------------------------------------------
             RESULTADOS DEL PROCESO
 

real        2.2
user        0.5
sys         0.7
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000010
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      10 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 14:14:14
Fin de Programa:     2014/05/22 14:14:16

 
Archivos en $TEMPORALES:
-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 0000011000905140104.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 14:14 0000011000905140104.txt.errs
-rw-rw-r--   1 icjlud   icdatacr    4511 May 22 14:14 0000011000905140104.txt.log
---------------------------------------------------
 
 
 
 
 
 
 
 
/d/iccol/desarrollo/temporales>cat 0000011000905140104.txt
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
I100002249789JOAQUIN VARGAS CABALLERO                     0040032012040601104320440406
I100002859753ERNESTO RICO                                 0050672013040602206720100435
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
I100003295380HENRY REY BARBOSA                            0080452013011123200220110506
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
I200800002194SERVICULTIVOS LTDA                           0220452012040603404520120406
I200800178009CALZADO ORION DEL LITORAL                    0330202000040601505420140106
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
I200830067928C I GLOMA S A                                0110432044040601203220100406
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
I200860024151COMPUTEC SA                                  0330332011140604500120110402
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
I200890934264SUBSUELO Y GEOTECNIA LTDA                    0450002010080600204420130506
I200890107487SUPERTIENDAS Y DROGUERIAS OL                 0340452012040600300620130106
I300600003115xxxxxx                                       0150542014010600400320120406
I300611000446ANTONIO CONDOLUCI DOMINGO                    0340021999010100506720130406
I400000163597MARWA MIKHAEL SKAFF DE KARAA                 0120322010040600604520110406
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
I400000136711ARIAS NILO RIESCO                            0110232011041100905720130411
I400000163598xxxxxx                                       0330432013101002204520120406
T 00000000027                                             772774        787861        
/d/iccol/desarrollo/temporales>cat 0000011000905140104.txt.errs
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411 14 El numero de id no se encuentra en el archivo maestro
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406 14 El numero de id no se encuentra en el archivo maestro
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406 14 El numero de id no se encuentra en el archivo maestro
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002859753ERNESTO RICO                                 0050672013040602206720100435 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406 07 Numero de demandas terminadas: debe ser numerico
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860024151COMPUTEC SA                                  0330332011140604500120110402 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango
I300600003115xxxxxx                                       0150542014010600400320120406 15 El nombre en el input no coincide con el registrado
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106 11 Numero de embargos terminados: debe ser numerico
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111 14 El numero de id no se encuentra en el archivo maestro
I400000163598xxxxxx                                       0330432013101002204520120406 15 El nombre en el input no coincide con el registrado
/d/iccol/desarrollo/temporales>cat 0000011000905140104.txt.log

real        2.2
user        0.5
sys         0.7
                                           
CARGAJUR   Carga de archivo JURAD - proceso REAL
04 Refresque Total - Carga TOTAL
Fecha de proceso: 20140104
Eliminando toda la informacion con fuente JURAD
Fin de los registros a eliminar - leídos:00000000
Termino la eliminacion total de JURAD
Reg borrados: 00000010
 
I100000149123JOSE MISAEL AREVALO SANCHEZ                  0010012013040500905720130411
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000262135LIBARDO ANTONIO GARZON TORRE                 0150202013020602204520120406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100000958212LUIS GUILLERMO AVENDAÑO RODR                 0020442013050603302020000406
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I100001327130GONZALO PATIÑO MORENO                        0030062013010604407619984069
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002859753ERNESTO RICO                                 0050672013040602206720100435
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100002865767MIGUEL ANTONIO LAVERDE NIETO                 0060452011040603303320111406
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I100003044362MANUEL CASTRO MUÑETON                        0070rt2011010605300120130406
Error 07 Numero de demandas terminadas: debe ser numerico           
 
I100003448867JAIRO DE JESUS HENAO VILLEGA                 0090572013041104550030100806
Error 13 Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
 
I200811046741SALUD AXIAL LTDA                             0440761998406903400219990101
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860013816INSTITUTO DE SEGUROS SOCIALE                 0220672010043503300220131206
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860024151COMPUTEC SA                                  0330332011140604500120110402
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200860034313BANCO DAVIVIENDA SA                          0533000013040601102320110411
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I200890300546COLGATE PALMOLIVE COMPAIA                    2322000011050603304320131010
Error 09 Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
 
I300600003115xxxxxx                                       0150542014010600400320120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: FERNANDEZ PENA JULIO ANTONIO                                     
 
I400000266423SIMONE MARTINEZ                              033002201312060070rt20110106
Error 11 Numero de embargos terminados: debe ser numerico           
 
I400000244359PATRICIO ALEJANDRO HERRERA C                 0450012011040200804520130111
Error 14 El numero de id no se encuentra en el archivo maestro      
 
I400000163598xxxxxx                                       0330432013101002204520120406
Error 15 El nombre en el input no coincide con el registrado        
novedad:  xxxxxx                                       
registro: KARAN  ABBOUD NAJAH                                              
 
Totales de registros:
 
    63.0 % de registros inconsistentes
      27 Registros IME en el archivo de entrada
      10 Registros procesados sin error
      17 Registros con error
      10 Alertas borradas previo al refresque total
      20 Alertas insertadas
         Alertas modificadas
         Alertas eliminadas
         Insercion de alerta existente
         Modif o elim de alerta inexistente
 
Totales por tipo de error detectado:
       1 07-Numero de demandas terminadas: debe ser numerico           
       5 09-Fecha ultima demanda vigente YYYYMMDD: fuera de rango      
       1 11-Numero de embargos terminados: debe ser numerico           
       4 13-Fecha ultimo embargo vigente YYYYMMDD: fuera de rango      
       4 14-El numero de id no se encuentra en el archivo maestro      
       2 15-El nombre en el input no coincide con el registrado        

Inicio de Programa:  2014/05/22 14:14:14
Fin de Programa:     2014/05/22 14:14:16

-rw-rw-r--   1 icdgd    icdatacr    2436 May 19 15:46 0000011000905140104.txt
-rw-rw-r--   1 icjlud   icdatacr    2434 May 22 14:14 0000011000905140104.txt.errs
-rw-rw-r--   1 icjlud   icdatacr    4268 May 22 14:14 0000011000905140104.txt.log
/d/iccol/desarrollo/temporales>fu
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>fg
vi /d/iccol/desarrollo/macros/sh-CARGAJUR

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" $P_REAL_FALSO " tipo de proceso:" $P_PROCESO
    nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo.log 2>| $TEMPORALES/$P
_NombreArchivo.log
    echo $raya
    echo "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    cd $TEMPORALES
    echo "Archivos en \$TEMPORALES:"
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    cd - > /dev/null
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="000001"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo#sh-CARGAJUR.v.01.0001 grabado como /d/iccol/desarrollo/macros/sh-CARGAJUR
#**********************************************************
#ENTIDAD:DATACREDITO*
#SHELL-ID:     sh-CARGAJUR*
#DATE-WRITTEN: MAY/2014*
#AUTHOR:GLOBANT*
#******************************************************************
# 16-may-2014| CQnnnn - CARGA DE ARCHIVO EXTERNO*
# Globant.   |*
#******************************************************************
#
#*========================================================*
#*DEFINICION DE VARIABLES Y FUNCIONES
#*========================================================*
raya="---------------------------------------------------"
codsus="000001"
P_REAL_FALSO="1"
P_PROCESO="#";
P_NombreArchivo=""


GetFechaSistema()
{
#*-----------------------------------------------------------------------------*
# Arma y muestra la fecha del sistema y la máquina
#*-----------------------------------------------------------------------------*
    P_SERVER_DEV="172.24.6.154"
    HoraHoy=`date '+%H:%M'`
    FECHOY_A4MMDD=`date '+%Y%m%d'`
    FECHOY_ANOMES=`date '+%Y%m%d' | cut -c 1-6`
    P_FCORTE=$FECHOY_ANOMES
    P_MAQUINA=`who am i | cut -c 39-50`
    P_FCORTE=$FECHOY_ANOMES
    echo $raya
    echo " "
    echo "D A T A C R E D I T O"
    echo " "
    echo "Cargue de archivo de JURAD"
    echo " "
    echo "Fecha:" $FECHOY_A4MMDD $HoraHoy " en" $P_MAQUINA
    echo " "
}

GetRealOFalso()
{
#*-----------------------------------------------------------------------------*
# Averigua si el tipo de proceso es REAL o EN FALSO
#*-----------------------------------------------------------------------------*
    echo
echo $raya
    echo "PROCESO REAL O EN FALSO"
    echo $raya
    P_REAL_FALSO="#";
    endLoop=0
    while [ $endLoop == 0 ]
do    do
#---------------------------------------------------
echo " "
echo "1) Proceso en falso"
echo " "
echo "2) Proceso real"
echo " "
echo "3) Salir"
echo " "
echo "opción (123)   ---> \c"
read P_REAL_FALSO
if [ $P_REAL_FALSO != "1" ] && [ $P_REAL_FALSO != "2" ] && [ $P_REAL_FALSO != "3" ]
then
echo "\n\tlas opciones válidas son 1, 2 o 3"
else
endLoop=1
fi
    done
}

GetTipoDeProceso()
{
#*-----------------------------------------------------------------------------*
# Averigua el tipo de proceso: carga inicial, actualización, refresque total ...
#*-----------------------------------------------------------------------------*
    echo
echo $raya
    echo "TIPO DE PROCESO"
    echo $raya
    endLoop=0
    P_PROCESO="##"
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo "01) Envio Original  - Carga TOTAL 1a vez"
echo " "
echo "02) Archivo Semanal - Carga PARCIAL"
echo " "
echo "03) Archivo Mensual - Carga PARCIAL"
echo " "
echo "04) Refresque Total - Carga TOTAL"
echo " "
echo "00) Salir"
echo " "
echo "opción (01 02 03 04 00)   ---> \c"
read P_PROCESO
if [ -z "$P_PROCESO" ]
then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
else
if [ $P_PROCESO != "01" ] && [ $P_PROCESO != "02" ] && [ $P_PROCESO != "03" ] && [
 $P_PROCESO != "04" ] && [ $P_PROCESO != "00" ]then
echo "\n\t ingrese una de las opciones 01 02 03 04 00\c"
elseelse
endLoop=1
fi
fi
    done
}

GetNombreDelArchivo()
{
#*-----------------------------------------------------------------------------*
# Averigua el nombre del archivo
#*-----------------------------------------------------------------------------*
    echo
echo $raya
    echo "NOMBRE DEL ARCHIVO"
    echo $raya
    endLoop=0
    while [ $endLoop == 0 ]
    do
#---------------------------------------------------
echo " "
echo " Ingrese el nombre del archivo o enter para salir:"
echo ""$codsus"100ddmmaa01"$P_PROCESO".txt"
#JJJJJJaaaDDMMAAbbXX.txt
echo " ---> \c"
read P_NombreArchivo
if [ -z "$P_NombreArchivo" -o "$P_NombreArchivo" == "" ]
then
endLoop=1
else
if [ ! -s $TEMPORALES"/"$P_NombreArchivo ]then
echo "no se encuentra el archivo " $P_NombreArchivoelse
#el tipo de proceso 01/02/03/04 debe coincidir con el que
#está en el nombre del arch
#separa los dos caractares justo antes de la extensión ".txt"auxTxt=`echo $P_NombreArchivo | sed 's/.*\\(..\\)\\.txt/\\1/'`
#echo $auxTxt " debería ser " $P_PROCESOif [ $P_PROCESO == $auxTxt ]then
#el código de suscriptor al principio del nombre del
#archivo debe ser el de JURADauxTxt=`echo $P_NombreArchivo | sed 's/\\(......\\).*/\\1/'`
#echo $auxTxt " debería ser " $codsusif [ $codsus == $auxTxt ]then
endLoop=1
else
echo "El código de suscriptor en el nombre del archivo no coincide"fi
else
echo "El nombre del archivo no condice con el tipo de proceso" $P_PROCESOfi
fi
fifidone
}


#*========================================================*
#*PROCESO*
#*========================================================*
#*FASE 1: PIDE PARAMETROS*
#*========================================================*
echo "........................................."
clear
GetFechaSistema
GetRealOFalso
if [ $P_REAL_FALSO -eq 3 ]
then
exit
fi
GetTipoDeProceso
if [ $P_PROCESO -eq 00 ]
then
exit
fi
GetNombreDelArchivo
if [ -z "$P_NombreArchivo" ]
then
exit
fi

# echo (esto no está refactoreado)
# echo "+-------------------------------------------------------------+"
# echo "+-------------------------------------------------------------+"
# echo "     Fecha base (AAAAMM)     -----> ($P_FCORTE) "
# fechab=$P_FCORTE
# echo "+-------------------------------------------------------------+"
# numeroreg=`wc -l < $P_NombreArchivo archivo`
# echo
# echo "+-------------------------------------------------------------+"
# echo "| Registros iniciales archivo de entrada : " $numeroreg
# echo "+-------------------------------------------------------------+"
# cadena00=$archivo.orig
# cp $P_NombreArchivo $cadena00
#echo "+-------------------------------------------------------------+"
#echo "|SEGUNDA FASE: PROCESO|"
#echo "+-------------------------------------------------------------+"
    echo " "
    echo $raya
    echo " "
    banner CARGAJUR
    echo " "
    echo $raya
    echo " Procesando $P_NombreArchivo "
    echo "real:" $P_REAL_FALSO " tipo de proceso:" $P_PROCESO
    nohup x CARGAJUR $P_NombreArchivo $P_REAL_FALSO >| $TEMPORALES/$P_NombreArchivo.log 2>| $T
EMPORALES/$P_NombreArchivo.log

echo $raya        echo $rayaecho "RESULTADOS DEL PROCESO"
    echo " "
    cat $TEMPORALES/$P_NombreArchivo.log
    echo " "
    cd $TEMPORALES
    echo "Archivos en \$TEMPORALES:"
    ls -lrt $P_NombreArchivo* >> $P_NombreArchivo.log
    ls -lrt $P_NombreArchivo*
    cd - > /dev/null
    echo $raya
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "
    echo " "

~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:q/d/iccol/desarrollo/fuentes>clear
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>
/d/iccol/desarrollo/fuentes>clear
/d/iccol/desarrollo/fuentes>cat CARGAJUR.CBL
      $SET LIST SETTING 
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    CARGAJUR2.
      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.

      ******************************************************************
      ******************************************************************
       DATA DIVISION.
       FILE section.

      ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************
       FD JURAD.
       01  JURAD-reg.
      * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-tipo-novedad        pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-id-tipo             pic x.
      *    Numero de identificacion
           03 JURAD-id-numeroX          pic x(11).
           03 JURAD-id-numero           redefines JURAD-id-numeroX
                                        pic 9(11).
      *    Nombres y Apellidos
           03 JURAD-nombre              pic x(45).
      *    Numero de demandas vigentes
           03 JURAD-demandas-vigentes   pic 999.
      *    Numero de demandas terminadas
           03 JURAD-demandas-terminadas pic 999.
      *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 JURAD-embargos-vigentes   pic 999.
      *    Numero de embargos terminados
           03 JURAD-embargos-terminados pic 999.
      *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-embargos-fecha-ultimo pic x(8).

       01  JURADT-reg.
      * Registro de totales de control T
      *    Tipo de Novedad = "T"
           03 JURADT-tipo-novedad       pic x.
           03                           pic x.
      *    Cantidad de registros
           03 JURADT-registros          pic 9(11).
           03                           pic x.
      *    Total numero de demandas vigentes
           03 JURADT-demandas-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de demandas terminadas
           03 JURADT-demandas-terminadas pic 9(7).
           03                           pic x.
      *    Total numero de embargos vigentes
           03 JURADT-embargos-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de embargos terminados
           03 JURADT-embargos-terminados pic 9(7).
           03                           pic x(41).

      ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************
       FD ERRS.
       01  ERRS-reg.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-tipo-novedad         pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-id-tipo              pic x.
      *    Numero de identificacion
           03 ERRS-id-numero            pic x(11).
      *    Nombres y Apellidos
           03 ERRS-nombre               pic x(45).
      *    Numero de demandas vigentes
           03 ERRS-demandas-vigentes    pic 999.
      *    Numero de demandas terminadas
           03 ERRS-demandas-terminadas  pic 999.
      *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 ERRS-embargos-vigentes    pic 999.
      *    Numero de embargos terminados
           03 ERRS-embargos-terminados  pic 999.
      *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-embargos-fecha-ultimo pic x(8).
      *    Causa del rechazo
           03 ERRS-causa-rechazo        pic x(300).

      ******************************************************************
      * Contiene los ids y nombres de personas
      ******************************************************************
       copy BDIIREGI.FD.

      ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN
      ******************************************************************
       copy BDIIDIAN.FD.

      ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************
       copy BDIIDAS.FD.

      ******************************************************************
      * Maestro de alertas reportadas por suscriptores
      ******************************************************************
       copy BDIIALE.FD.

      ******************************************************************
       WORKING-STORAGE section.
      ******************************************************************
      * Nombre del programa
       01  pgm                          pic x(10) value "CARGAJUR".

      ******************************************************************
      * Variables para rutina de validacion de identificaciones
      ******************************************************************
       copy BDIIVIDE.WS.

      ******************************************************************
      * Variables relacionadas con las alertas del sistema
      ******************************************************************
       copy BDIIALE.WS.

      ******************************************************************
      * Datos para las rutinas de validacion de nombres de VALNOM.PROC
      ******************************************************************
       copy VALNOM.WS.

      *****************************************************************
      * Direcciones de los archivos en el file system
      *****************************************************************
       copy ICFILE.WS.

      ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)
       01  IND-fin-proceso              pic xx value "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-reg-anterior           pic x(100) value "(vacio)".
       01  JURAD-fs                     pic xx value spaces.

       01  ERRS-fs                      pic xx value spaces.

      * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-datahost.
           05 D-vigentes                pic 9(5).
           05 D-terminados              pic 9(5).
           05 D-fecha-ultima            pic x(8).
      ******************************************************************
      * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros
       01 P-command-line                pic x(80) value spaces.
       01 P-parametros.
      *    Proceso real: contiene "1" para activar, "2" por defecto
           03 P-proceso-real            pic xx value "2".
           88 PROCESO-REAL              value "1".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-file-name               pic x(80) value spaces.
           03 P-file-name-R             redefines P-file-name.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-cod-suscriptor      pic 9(6).
      *        aaa = Codificacion del producto ("100")
               05 P-producto            pic xxx.
      *        DDMMAA = Fecha de proceso
               05 P-fecha-proceso       pic x(6).
      *        bb =  01 a CI
               05 P-ci-bi               pic xx.
      *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL
               05 P-tipo-proceso        pic xx.
      *        extension del archivo ".txt"
               05 P-extension           pic x(4).
               05                       pic x(57).
           03 P-file-path               pic x(80) value spaces.
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
          03 ERRS-file-name             pic x(80) value spaces.

      * Fecha de proceso editada YYYYMMDD
       01 P-fecha-proceso-YYYYMMDD      pic x(8).
      * Fecha de proceso + 50 años
       01 P-fecha-proceso-50.
           03  P-fecha-proceso-50YYYY   pic 9999.
           03                           pic x(4).
      ******************************************************************
      * Datos para el reporte final
       01 W-tiempo.
           03 W-hora-inicio             pic 9(8).
           03 W-hora-fin                pic 9(8).
       01 N-edit                        pic z(8)B.
       01 N-editp100                    redefines N-edit
                                        pic z(5)9.9B.
       01 N-contadores.
      *    Registros en el archivo de entrada
           03 N-reg-leidos              pic 9(8) value zero.
      *    Registros procesados sin error
           03 N-reg-OK                  pic 9(8) value zero.
      *    Registros con error
           03 N-reg-con-error           pic 9(8) value zero.

      *    Cantidades de registros por tipo de novedad
           03 N-reg-tipo-I-OK           pic 9(8) value zero.
           03 N-reg-tipo-M-OK           pic 9(8) value zero.
           03 N-reg-tipo-E-OK           pic 9(8) value zero.
           03 N-reg-tipo-I-err          pic 9(8) value zero.
           03 N-reg-tipo-M-err          pic 9(8) value zero.
           03 N-reg-tipo-E-err          pic 9(8) value zero.

      *    Alertas borradas previo al refresque total
           03 N-ale-leidas              pic 9(8) value zero.
           03 N-ale-borradas            pic 9(8) value zero.
      *    Alertas insertadas
           03 N-ale-insertadas          pic 9(8) value zero.
      *    Alertas modificadas
           03 N-ale-modificadas         pic 9(8) value zero.
      *    Alertas eliminadas
           03 N-ale-eliminadas          pic 9(8) value zero.
      *    Insercion de alerta existente
           03 N-ale-ya-existe           pic 9(8) value zero.
      *    Modificacion o eliminacion de alerta inexistente
           03 N-ale-no-existe           pic 9(8) value zero.

      *    Sumas de cantidades de demandas y embargos
           03 N-demandas-vigentes       pic 9(5).
           03 N-demandas-terminadas     pic 9(5).
           03 N-embargos-vigentes       pic 9(5).
           03 N-embargos-terminados     pic 9(5).

      ******************************************************************
      * Armado de las lineas de alerta
       01 LA-lineas-alerta.
      *    Los modelos a continuacion deberan obtenerse de un 
      *    archivo, como BDIIALE-ALERTAS
           03 LAend                     pic 999 comp value 0.
           03 LA-modelos.
      *         12345678901234567890123456789012345678901234567890
               05 pic x(50) value
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
               05 pic x(50) value
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
               05 pic x(50) value
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
               05 pic x(50) value
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
               05 pic x(50) value high-values. *> end marker
           03 LA-modelos2               redefines LA-modelos.
               05 LA-modelo             pic x(50) occurs 5 
                                        indexed LAm.
      *    Funcionamiento de los templates.
      *    Hay dos templates por de alerta, uno por linea.
      *    Cada template consiste en hasta 10 frases fijas con
      *    ampersands (&) donde se van a reemplazar los valores.
      *    Por ejemplo: 
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
      *    tiene 3 frases fijas y 2 reemplazos. 
      *    La cantidad de ampersands es irrelevante, pero parece
      *    conveniente que informe sobre el tamanio del contenido.
           03 LA-templates.
               05 LA-template           occurs 4 indexed LAx.
                   07 LA-parte          pic x(50)
                                        occurs 10 indexed LAy.
      *    Las dos lineas armadas
           03 LA-lineas.
               05 LA-linea1             pic x(50).
               05 LA-linea2             pic x(50).
      *    Los valores a insertar en una linea
           03 LA-valores.
               05 LA-valor              pic x(50) 
                                        occurs 10 indexed LAv.
      *    Datos para editar valores a insertar
           03 LA-num                    pic -(11)0.
           03 LA-numX                   redefines LA-num
                                        pic x(12).
           03 LA-descarte               pic x(50).


      ******************************************************************
      * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx value "NO".
      *    errores del registro actual
           03 E-errores-reg             pic x(300) value spaces.
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8) value zero.
      *    tabla de errores
           03 pic x(11) value "01 0000000 ".
           03 pic x(59) value
           "Tipo de movimiento invalido, debe ser I M E T".
           03 pic x(11) value "02 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion invalido, debe ser 1 2 3 4".
           03 pic x(11) value "03 0000000 ".
           03 pic x(59) value
           "Numero de identificacion invalido, debe ser numerico".
           03 pic x(11) value "04 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion debe ser mayor que cero".
           03 pic x(11) value "05 0000000 ".
           03 pic x(59) value
           "Falta el nombre o denominacion".
           03 pic x(11) value "06 0000000 ".
           03 pic x(59) value
           "Numero de demandas vigentes: debe ser numerico".
           03 pic x(11) value "07 0000000 ".
           03 pic x(59) value
           "Numero de demandas terminadas: debe ser numerico".
           03 pic x(11) value "08 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "09 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "10 0000000 ".
           03 pic x(59) value
           "Numero de embargos vigentes: debe ser numerico".
           03 pic x(11) value "11 0000000 ".
           03 pic x(59) value
           "Numero de embargos terminados: debe ser numerico".
           03 pic x(11) value "12 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "13 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "14 0000000 ".
           03 pic x(59) value
           "El numero de id no se encuentra en el archivo maestro".
           03 pic x(11) value "15 0000000 ".
           03 pic x(59) value
           "El nombre en el input no coincide con el registrado".
           03 pic x(11) value "16 0000000 ".
           03 pic x(59) value
           "Numero de id fuera del rango del tipo de id informado".
      *----------------- insertar nuevos items aqui -------------------
           03 pic x(11) value "00 0000000 ".
           03 pic x(59) value "--- fin de la lista (cod 00) ---".
           03                           pic x(3500). *> los 50 items
       01 E-errores-2                   redefines E-errores.
           03                           pic xx.
           03                           pic x(300).
           03                           pic 9(8).
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).
       01 E-edit                        pic z(8)B.

      ******************************************************************
      * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 pic 9(04).
              88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 pic 9(02).
              88 MES-VAL                value 01   thru 12.
           02 DIA-VAL-X                 pic 9(02).
              88 DIA-VAL                value 01   thru 31.

      /*****************************************************************
      ******************************************************************
       PROCEDURE DIVISION.
      *    0000-PROGRAMA-PRINCIPAL
      *    4000-PROCESAR-REGISTRO
      *    4000-PROCESAR-REGISTRO-2
      *    4100-VALIDACION-FORMAL
      *    4200-VALIDACION-SEMANTICA
      *    4300-MODIFICAR-BDIIALE
      *    4300-MODIFICAR-BDIIALE-DATOS
      *    4300-MODIFICAR-BDIIALE-I
      *    4300-MODIFICAR-BDIIALE-M
      *    4300-MODIFICAR-BDIIALE-E
      *    4333-LEER-BDIIALE-RANDOM
      *    4333-GRABAR-BDIIALE
      *    4333-REGRABAR-BDIIALE
      *    4333-ELIMINAR-BDIIALE
      *    4900-GRABAR-ERROR
      *    4320-ARMAR-TEXTO-ALERTA
      *    1000-RUTINA-INICIAL
      *    1001-ELIMINAR-TODO
      *    7000-RUTINA-FINAL
      *    9000-CANCELAR-PROGRAMA


       0000-PROGRAMA-PRINCIPAL.
      ******************************************************************
      *    inicializa el ambiente y abre los archivos
           perform 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta
      *    encontrar el registro "T" de totales
           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
      *    cierra archivos y produce el reporte final
           perform 7000-RUTINA-FINAL
           goback.

       4000-PROCESAR-REGISTRO.
      ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo
      ****************************************************************
      *    lectura del proximo registro
           read JURAD
           evaluate JURAD-fs
           when "00"
      *        controla el reg y lo aplica si es OK
               perform 4000-PROCESAR-REGISTRO-2
               move JURAD-reg to JURAD-reg-anterior
           when "10"
      *        fin del archivo de input:
      *        esto es un error, no se encontro el registro "T" antes
      *        de que se terminara el archivo
               display "Falta el reg de totales del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           when other
      *        error de lectura: cancelacion del proceso
               display "Error en lectura del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4000-PROCESAR-REGISTRO-2.
      ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg
      ****************************************************************
           move "NO" to E-hay-error

      *    validacion del tipo de movimiento
           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 
               call "PONERR" using "01" JURAD-reg E-errores
           end-if

      *    si es el registro "T" hay que senialar el fin de proceso
           if JURAD-tipo-novedad = "T" 
               move "SI" to IND-fin-proceso
               perform 4800-PROCESO-REG-T
               exit paragraph
           end-if

           add 1 to N-reg-leidos

      *    validacion formal de los datos
           perform 4100-VALIDACION-FORMAL
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               exit paragraph
           end-if

      *    si la validacion formal dio OK se hace validacion semantica
           perform 4200-VALIDACION-SEMANTICA
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               exit paragraph
           end-if

      *    intento de actualizacion de BDIIALE
           perform 4300-MODIFICAR-BDIIALE
           add 1 to N-reg-OK.



       4100-VALIDACION-FORMAL.
      ******************************************************************
      * Validacion formal de los datos del input
      ******************************************************************
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           if JURAD-id-tipo not = "1" and "2" and "3" and "4"
               call "PONERR" using "02" JURAD-reg E-errores
           end-if
      *    Numero de identificacion
           if JURAD-id-numeroX is not numeric
               call "PONERR" using "03" JURAD-reg E-errores
           end-if
           if JURAD-id-numero not > 0
               call "PONERR" using "04" JURAD-reg E-errores
           end-if
      *    si el movimiento es una eliminacion los datos subsiguientes
      *    no se controlan
           if JURAD-tipo-novedad = "E"
               exit paragraph
           end-if
      *    Nombres y Apellidos
           if JURAD-nombre = spaces
               call "PONERR" using "05" JURAD-reg E-errores
           end-if
      *    Numero de demandas vigentes
           if JURAD-demandas-vigentes is not numeric
               call "PONERR" using "06" JURAD-reg E-errores
           end-if
      *    Numero de demandas terminadas
           if JURAD-demandas-terminadas is not numeric
               call "PONERR" using "07" JURAD-reg E-errores
           end-if
      *    Fecha ultima demanda vigente YYMMDD
           if JURAD-demandas-fecha-ultima is not numeric
               call "PONERR" using "08" JURAD-reg E-errores
           end-if
           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "09" JURAD-reg E-errores
           end-if
      *    Numero de embargos vigentes
           if JURAD-embargos-vigentes not numeric
               call "PONERR" using "10" JURAD-reg E-errores
           end-if
      *    Numero de embargos terminados
           if JURAD-embargos-terminados not numeric
               call "PONERR" using "11" JURAD-reg E-errores
           end-if
      *    Fecha ultimo embargo vigente YYMMDD
           if JURAD-embargos-fecha-ultimo is not numeric
               call "PONERR" using "12" JURAD-reg E-errores
           end-if
           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "13" JURAD-reg E-errores
           end-if.


       4200-VALIDACION-SEMANTICA.
      ****************************************************************
      * Validacion del numero de identificacion y de su relacion con
      * el nombre
      ****************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIVIDE
           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
           move JURAD-nombre to NOMBRE-BDIIVIDE
           move 1 to SW-VERIFNOM-BDIIVIDE
           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
           perform 80100-VALIDAR-IDENTIFICACION
      *    a ver si la validacion cambio el tipo de ide
           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE
               call "PONERR" using "16" JURAD-reg E-errores
               display "Tipo ide cambiado de " JURAD-id-tipo " a " 
               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero
           end-if
      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
           if SW-ID-BDIIVIDE = 1
               call "PONERR" using "14" JURAD-reg E-errores
           else
      *        existe id, a ver si el nombre coincide
               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
                   call "PONERR" using "15" JURAD-reg E-errores
                   display "novedad:  " JURAD-nombre
                   display "registro: " NOM-LEIDO-BDIIVIDE
               end-if
           end-if.


       4300-MODIFICAR-BDIIALE.
      ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones, 
      * modificaciones o eliminaciones segun haya o no demandas y 
      * embargos
      ******************************************************************
           initialize REG-BDIIALE

      *    si hay demandas
           if JURAD-demandas-vigentes > zero
           or JURAD-demandas-terminadas > zero 
               move "J001" to LLASEC-BDIIALE
      *        arma datos de demandas
               move JURAD-demandas-vigentes to D-vigentes
               move JURAD-demandas-terminadas to D-terminados
               string "20" JURAD-demandas-fecha-ultima 
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS 
           end-if.

      *    si hay embargos
           if JURAD-embargos-vigentes > zero
           or JURAD-embargos-terminados > zero 
               move "J002" to LLASEC-BDIIALE
      *        arma datos de embargos
               move JURAD-embargos-vigentes to D-vigentes
               move JURAD-embargos-terminados to D-terminados
               string "20" JURAD-embargos-fecha-ultimo
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS 
           end-if.



       4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************
      * Parte de la carga de datos en el registro BDIIALE y grabacion
      * del mismo que es comun a demandas y embargos
      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
      ******************************************************************
      *    completa la clave e intenta leer la alerta, si se leyo OK
      *    el file status de BDIIALE queda con "00"
           perform 4333-LEER-BDIIALE-RANDOM

      *    procesa segun el tipo de novedad I M E
           evaluate JURAD-tipo-novedad
           when "I"
               add 1 to N-reg-tipo-I-OK
               perform 4300-MODIFICAR-BDIIALE-I
           when "M"
               add 1 to N-reg-tipo-M-OK
               perform 4300-MODIFICAR-BDIIALE-M
           when "E"
               add 1 to N-reg-tipo-E-OK
               perform 4300-MODIFICAR-BDIIALE-E
           when other
      *        esto es "imposible" por control de consistencia anterior
               display "error de logica: tipo-novedad="
               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos
               display "Registro de JURAD: " display JURAD-reg
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4300-MODIFICAR-BDIIALE-I.
      ******************************************************************
      * Insercion de una alerta nueva
      * Si ya existia muestra un mensaje y continua
      ******************************************************************
      *    si el registro existia es un error
           if EST-BDIIALE = "00"
               display "Insercion de alerta nueva que ya existe "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               add 1 to N-ale-ya-existe
           end-if

      *    completa los datos del registro
           initialize ENCABEZADO-BDIIALE
           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
           FEC-REP-BDIIALE 
           move P-fecha-proceso-50 to FEC-VEN-BDIIALE
           move 0 to BLOQUEO-BDIIALE
           move D-datahost to INF-DATAHOST-BDIIALE
           perform 4320-ARMAR-TEXTO-ALERTA
           if EST-BDIIALE = "00"
               perform 4333-REGRABAR-BDIIALE
           else
               perform 4333-GRABAR-BDIIALE
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4300-MODIFICAR-BDIIALE-M.
      ******************************************************************
      * Modificacion de una alerta existente
      * Si no existia muestra un mensaje y continua
      ******************************************************************
      *    si el registro no existia es un error
           if EST-BDIIALE not = "00"
               display "Modificacion de alerta inexistente "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               add 1 to N-ale-no-existe
           end-if
      *    reemplaza la fecha de reporte y los valores
           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 
           move D-datahost to INF-DATAHOST-BDIIALE
           perform 4320-ARMAR-TEXTO-ALERTA
           if EST-BDIIALE = "00"
               perform 4333-REGRABAR-BDIIALE
           else
               perform 4333-GRABAR-BDIIALE
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4300-MODIFICAR-BDIIALE-E.
      ******************************************************************
      * Eliminacion de una alerta
      * Si no existia muestra un mensaje y continua
      ******************************************************************
      *    elimina el registro
           if EST-BDIIALE = "00"
               perform 4333-ELIMINAR-BDIIALE
           else
               display "Eliminacion de alerta inexistente "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               add 1 to N-ale-no-existe
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-LEER-BDIIALE-RANDOM.
      ******************************************************************
      * Arma clave exacta y lee un registro de BDIIALE
      * Usa los datos del reg input, excepto LLASEC que esta precargado
      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
      ******************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIALE
           move JURAD-id-numero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move 000 to COD-ALERTA-BDIIALE
      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

           read BDIIALE
           evaluate EST-BDIIALE
           when "00"
               continue
           when "23"
               continue
           when other
               display "Error al leer BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Ultimo registro procesado: "
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.
      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-GRABAR-BDIIALE.
      ******************************************************************
      * Inserta un registro nuevo en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           write REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-insertadas
           when other
               display "Error al grabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-REGRABAR-BDIIALE.
      ******************************************************************
      * Regraba un registro modificado en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           rewrite REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-modificadas
           when other
               display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-ELIMINAR-BDIIALE.
      ******************************************************************
      * Elimina un registro de BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           delete BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-eliminadas
           when other
               display "Error al deletear BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

       4800-PROCESO-REG-T.
      ******************************************************************
      * El registro leido en el archivo JURAD es tipo "T" con totales
      * de control, y debería ser el ultimo del archivo
      ******************************************************************
      * Control de los totales calculados contra los esperados
           move "NO" to E-hay-error
      *    cantidad de registros I M E
           if function numval(JURADT-registros) = N-reg-leidos
               continue
           else
               display " "
               display "No coincide la cantidad de registros:"
               JURADT-registros " con los leidos:" N-reg-leidos
               move "SI" to E-hay-error
           end-if

      *    Sumas de cantidades de demandas y embargos
           if function numval(JURADT-demandas-terminadas)
           = N-demandas-terminadas
               continue
           else
               display " "
               display "No coincide total de demandas terminadas:"
               JURADT-demandas-terminadas " con el calculado:"
               N-demandas-terminadas
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-vigentes)
           = N-embargos-vigentes
               continue
           else
               display " "
               display "No coincide total de embargos vigentes:"
               JURADT-embargos-vigentes " con el calculado:"
               N-embargos-vigentes
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-terminados)
           = N-embargos-terminados
               continue
           else
               display " "
               display "No coincide total de embargos terminados:"
               JURADT-embargos-terminados " con el calculado:"
               N-embargos-terminados
               move "SI" to E-hay-error
           end-if.

      *    si hubo cualquier cosa se invalida el proceso
           if E-hay-error = "SI"
               display "Error en registro T de totales de control"
               display "Nombre del archivo: " ERRS-file-name
               perform 9000-CANCELAR-PROGRAMA
           end-if.


       4900-GRABAR-ERROR.
      ******************************************************************
      * El registro de JURAD tiene error: se graba en el archivo ERRS
      * con indicacion del error detectado
      ******************************************************************
           move JURAD-reg to ERRS-reg
           move E-errores-reg to ERRS-causa-rechazo
      *    lista de los codigos de los errores del registro
           move E-errores-reg to ERRS-causa-rechazo
           write ERRS-reg
           evaluate ERRS-fs
               when "00"
                   continue
               when other
                   display "Error al grabar el archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA
                   goback
           end-evaluate.
 

       4320-ARMAR-TEXTO-ALERTA.
      ****************************************************************
      * Hace el reemplazo de los valores adecuados en los templates
      * de las linea de alerta que corresponde
      ****************************************************************
      *    segun se trate de demandas o embargos
           if JURAD-demandas-vigentes not = 0 
           or JURAD-demandas-terminadas not = 0
               set LAx to 1
               move high-values to LA-valores
               move JURAD-demandas-vigentes to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(1)
      *        delimited by all space
               move LA-numx(9:12) to LA-valor(1)
               move JURAD-demandas-terminadas to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(2)
      *        delimited by all space
               move LA-numx(9:12) to LA-valor(2)

      * >>>> esto esta anulado x que no se como hacer para que lo compile
      * >>>> da error en el end-if
      *        string LA-parte(LAx, 1) LA-valor(1)
      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
      *        LA-parte(LAx, 10) LA-valor(10)
      *        delimited by high-value
           end-if.


       1000-RUTINA-INICIAL.
      ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:
      *   - obtencion de los parametros
      *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo
      ******************************************************************
      * Registra hora de inicio
           accept W-hora-inicio from time

      * Obtiene informacion sobre la corrida de la linea de comando: el
      * nombre del archivo de entrada (que contiene el tipo de proceso),
      * el indicador de proceso real o en falso (default)
           accept P-command-line from COMMAND-LINE
           display "Parametros: " P-command-line
           unstring P-command-line delimited by all " " into
           P-file-name P-proceso-real

      * El programa se anuncia en la consola
      * TODO: se usa un anuncio mas vistoso?
           if PROCESO-REAL
               display pgm " Carga de archivo JURAD - proceso REAL"
           else
               display pgm " Carga de archivo JURAD - proceso en falso"
           end-if

      * El indicador de proceso real debe ser 1 o 2
           if P-proceso-real not = "1" and "2"
               display "El indicador de proceso real es invalido"
               display "debe ser 1 o 2"
               perform 9000-CANCELAR-PROGRAMA
           end-if

      * TODO: controlar los componentes del filename
           evaluate P-tipo-proceso
           when "01"
               display "01 Envio Original - Carga TOTAL 1a vez"
           when "02"
               display "02 Archivo Semanal - Carga PARCIAL"
           when "03"
               display "03 Archivo Mensual - Carga PARCIAL"
           when "04"
               display "04 Refresque Total - Carga TOTAL"
           when other
      *        valor invalido
               display "El tipo de proceso " P-tipo-proceso
               " es invalido (debe ser 01 02 03 o 04)"
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

      * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD 
           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
           P-fecha-proceso(1:2) delimited size 
           into P-fecha-proceso-YYYYMMDD
           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

      * Calcula una fecha 50 anios posterior a la de proceso
           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
           add 50 to P-fecha-proceso-50YYYY

      * Apertura del archivo de entrada
           string "$TEMPORALES/" P-file-name into P-file-path
           open input JURAD
           evaluate JURAD-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo JURAD "
                   display "Path del archivo: " P-file-path
                   display "File status: " JURAD-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura del archivo de errores
           string "$TEMPORALES/" P-file-name(1:19) ".errs"
           into ERRS-file-name
           open output ERRS
           evaluate ERRS-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura de los archivos maestros
      * TODO: falta capturar el status de estas operaciones?
           open input BDIIREGI
           open input BDIIDIAN
           open input BDIIDAS.

      * Apertura del archivo de alertas en linea
           if PROCESO-REAL
               open i-o BDIIALE
           else
               open input BDIIALE
           end-if.

      * Si es un refresque total (codigo 04) se eliminan los registros
      * de Jurad existentes
           if P-tipo-proceso = "04" and PROCESO-REAL
               perform 1001-ELIMINAR-TODO
           end-if.

       1000-NOT-USED.
      * >>>> esto da un error de compilacion que no puedo resolver
      * >>>> por ahora esta anulado
      ******************************************************************
      * Carga de los templates para armar el texto de alertas
      * TODO: por ahora los templates son literales
           set LAx to 0
           move high-values to LA-templates
           perform varying LAm from 1 by 1 
           until LA-modelo(LAm) = high-values
               set LAx up by 1
      *        separa las partes de la linea
      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)
      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
      *        delimited by all "&"
      *        prepara para omitir los espacios al final de c/parte
               perform varying LAy from 1 by 1 until LAy > 10
                   inspect LA-parte(LAx, LAy) replacing trailing
                   spaces by high-values
                   inspect LA-parte(LAx, LAy) replacing first
                   high-value by space
               end-perform
           end-perform.


       1001-ELIMINAR-TODO.
      ******************************************************************
      * Elimina los registros de alertas existentes en el archivo de
      * alertas en linea, previo a un refresque total
      ******************************************************************
           display "Eliminando toda la informacion con fuente JURAD"
      *    posiciona en el primer reg de JURAD
           move zero to TIP-IDE-BDIIALE
           move zero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move zeros to COD-ALERTA-BDIIALE
           move low-values to LLASEC-BDIIALE
           start BDIIALE key > LLAVE-BDIIALE
      *    display "Start BDIIALE k:" LLAVE-BDIIALE
           evaluate EST-BDIIALE
           when "00"
      *        posicionado
               continue
           when other
      *        no hay registros
               display "No hay registros a eliminar fs:" EST-BDIIALE
               exit paragraph
           end-evaluate.

      *    lee secuencialmente y elimina los registros de JURAD
      *    hasta el fin del archivo
           perform until EST-BDIIALE not = "00"
               read BDIIALE next record
               evaluate EST-BDIIALE
               when "00"
      *            display "BDIIALE leido fs:" EST-BDIIALE
      *            " k:" LLAVE-BDIIALE
                   if FUENTE-BDIIALE = P-cod-suscriptor
      *                es un alerta de JURAD
                       delete BDIIALE
                       if EST-BDIIALE = "00"
      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE
                           add 1 to N-ale-borradas
                       else
      *                    error en la eliminacion
                           display "Error al eliminar un registro de "
                           "BDIIALE vaciando los datos"
                           display "Clave: " LLAVE-BDIIALE
                           display "Reg borrados: " N-ale-borradas
                           perform 9000-CANCELAR-PROGRAMA
                       end-if
                   end-if
               when "10"
      *            fin de archivo: sale normalmente
                   display "Fin de los registros a eliminar - leídos:"
                   N-ale-leidas
               when other
      *            lectura anormal: cancelacion del programa
                   display "Error en lectura del archivo de alertas "
                   "online"
                   display "File status: " EST-BDIIALE
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
               end-evaluate
           end-perform.
           display "Termino la eliminacion total de JURAD"
           display "Reg borrados: " N-ale-borradas.


       7000-RUTINA-FINAL.
      ******************************************************************
      * Registra hora de finalizacion
           accept W-hora-fin from time

      * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos
           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
      
      * Emision de contadores de registros
           display " "
           display "Totales de registros:"
           display " "
           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
           / N-reg-leidos
           display N-editp100 "% de registros inconsistentes" 
           move N-reg-leidos to N-edit 
           display N-edit "Registros IME en el archivo de entrada"
           move N-reg-OK to N-edit 
           display N-edit "Registros procesados sin error"

      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
      * definicion de estos contadores
      *    move N-reg-tipo-I-OK to N-edit
      *    display N-edit "Registros tipo I aceptados"
      *    move N-reg-tipo-M-OK to N-edit
      *    display N-edit "Registros tipo M aceptados"
      *    move N-reg-tipo-E-OK to N-edit
      *    display N-edit "Registros tipo E aceptados"

           move E-cont-regs-con-error to N-reg-con-error
           move N-reg-con-error to N-edit 
           display N-edit "Registros con error"
           move N-ale-borradas to N-edit 
           display N-edit "Alertas borradas previo al refresque total"
           move N-ale-insertadas to N-edit 
           display N-edit "Alertas insertadas"
           move N-ale-modificadas to N-edit 
           display N-edit "Alertas modificadas"
           move N-ale-eliminadas to N-edit 
           display N-edit "Alertas eliminadas"
           move N-ale-ya-existe to N-edit 
           display N-edit "Insercion de alerta existente"
           move N-ale-no-existe to N-edit 
           display N-edit "Modif o elim de alerta inexistente".

      * Emision del reporte de errores
           display " "
           display "Totales por tipo de error detectado:"
           perform varying Ex from 1 by 1 until Ex > 50
           or E-codigo(Ex) = "00"
               if E-contador(Ex) not = 0 
                   move E-contador(ex) to E-edit
                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
               end-if
           end-perform.


       9000-CANCELAR-PROGRAMA.
      ******************************************************************
      * Procedimiento standard de cancelacion de programa batch
      ******************************************************************
      * TODO: hay un standard para comunicar una cancelacion de proceso?
           display " "
           display pgm " - proceso cancelado"
           goback returning 99.


           copy BDIIVIDE.PROC.


           copy VALNOM.PROC.


      /
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.
      ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un
      * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo
      ******************************************************************
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input-anterior           pic x(86) value low-values.
      * Posicion del proximo error en la lista de errores del reg
       01  errIndex                     pic 999 comp.
      ******************************************************************

       LINKAGE SECTION.
      ******************************************************************
      * Codigo del error detectado
       01  cod-error                    pic xx.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input                    pic x(86).
      ******************************************************************
      * Tabla de errores de consistencia del input
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx.
      *    errores del registro actual
           03 E-errores-reg             pic x(300).
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8).
      *    tabla de errores
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).

      ******************************************************************

       PROCEDURE DIVISION using cod-error reg-input E-errores.
       00.
      *    marca al reg actual como erroneo
           move "SI" to E-hay-error

      *    cuenta y muestra el registro de input
           if reg-input not = reg-input-anterior
               add 1 to E-cont-regs-con-error
               display " "
               display reg-input
               move reg-input to reg-input-anterior
               move spaces to E-errores-reg
               move 2 to errIndex
           end-if

      *    contabiliza el error en la tabla de errores
           set Ex to 1
           search E-error varying Ex
           at end
               display "--- falla en la tabla de errores ---" cod-error
           when E-codigo(Ex) = "00"
               add 1 to E-contador(Ex)
               display "--- error tipo exotico: " cod-error
               add 1 to E-contador(Ex)
           when E-codigo(Ex) = cod-error
               add 1 to E-contador(Ex)
               display "Error " cod-error " " E-descripcion(Ex)
           end-search

      *    agrega a la lista de errores del registro
           if errIndex < (300 - 59 - 3)
               move cod-error to E-errores-reg(errIndex:2)
               add 3 to errIndex
               move E-descripcion(Ex) to E-errores-reg(errIndex:59)
               add 59 to errIndex
           end-if

           exit program.


       end program PONERR.

       end program CARGAJUR2.

      ******************************************************************
      ******************************************************************


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cat CARGAJUR.CBL
      $SET LIST SETTING 
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    CARGAJUR2.
      ******************************************************************
      * Actualizacion del archivo de alertas con los datos provistos
      * por Jurad
      * Procesa el archivo JURAD. Controla cada registro: si es OK usa
      * los datos para actualizar BDIIALE, si tiene defecto lo graba en
      * el archivo ERRS.
      ******************************************************************
       AUTHOR.        Globant JL.
       DATE-WRITTEN.
       DATE-COMPILED.
       CONFIGURATION section.
       SOURCE-COMPUTER. microfocus.
       OBJECT-COMPUTER. microfocus.
       INPUT-OUTPUT section.
       FILE-CONTROL.

      ******************************************************************
      ******************************************************************
       select JURAD assign to P-file-path
           organization is line sequential
           file status is JURAD-fs.

      ******************************************************************
      ******************************************************************
       select ERRS assign to ERRS-file-name
           organization is line sequential
           file status is ERRS-fs.

      ******************************************************************
      ******************************************************************
           copy BDIIREGI.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIDIAN.FS.
 
      ******************************************************************
      ******************************************************************
           copy BDIIDAS.FS.

      ******************************************************************
      ******************************************************************
           copy BDIIALE.FS replacing == on record.== by == on record
              file status is EST-BDIIALE.==.

      ******************************************************************
      ******************************************************************
       DATA DIVISION.
       FILE section.

      ******************************************************************
      * Archivo de entrada con los datos de demandas y embargos de JURAD
      ******************************************************************
       FD JURAD.
       01  JURAD-reg.
      * Registros de movimientos I, M, E
      *    Tipo de Novedad {I, M, E} Inser/Modif/Elim
           03 JURAD-tipo-novedad        pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 JURAD-id-tipo             pic x.
      *    Numero de identificacion
           03 JURAD-id-numeroX          pic x(11).
           03 JURAD-id-numero           redefines JURAD-id-numeroX
                                        pic 9(11).
      *    Nombres y Apellidos
           03 JURAD-nombre              pic x(45).
      *    Numero de demandas vigentes
           03 JURAD-demandas-vigentes   pic 999.
      *    Numero de demandas terminadas
           03 JURAD-demandas-terminadas pic 999.
      *    Fecha ultima demanda vigente YYYYMMDD
           03 JURAD-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 JURAD-embargos-vigentes   pic 999.
      *    Numero de embargos terminados
           03 JURAD-embargos-terminados pic 999.
      *    Fecha ultimo embargo vigente YYYYMMDD
           03 JURAD-embargos-fecha-ultimo pic x(8).

       01  JURADT-reg.
      * Registro de totales de control T
      *    Tipo de Novedad = "T"
           03 JURADT-tipo-novedad       pic x.
           03                           pic x.
      *    Cantidad de registros
           03 JURADT-registros          pic 9(11).
           03                           pic x.
      *    Total numero de demandas vigentes
           03 JURADT-demandas-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de demandas terminadas
           03 JURADT-demandas-terminadas pic 9(7).
           03                           pic x.
      *    Total numero de embargos vigentes
           03 JURADT-embargos-vigentes  pic 9(7).
           03                           pic x.
      *    Total numero de embargos terminados
           03 JURADT-embargos-terminados pic 9(7).
           03                           pic x(41).

      ******************************************************************
      * Archivo de salida con los registros defectuosos del arch JURAD
      ******************************************************************
       FD ERRS.
       01  ERRS-reg.
      *    Tipo de Novedad {I, M, E, T} Inser/Modif/Elim/Totales
           03 ERRS-tipo-novedad         pic x.
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           03 ERRS-id-tipo              pic x.
      *    Numero de identificacion
           03 ERRS-id-numero            pic x(11).
      *    Nombres y Apellidos
           03 ERRS-nombre               pic x(45).
      *    Numero de demandas vigentes
           03 ERRS-demandas-vigentes    pic 999.
      *    Numero de demandas terminadas
           03 ERRS-demandas-terminadas  pic 999.
      *    Fecha ultima demanda vigente YYMMDD
           03 ERRS-demandas-fecha-ultima pic x(8).
      *    Numero de embargos vigentes
           03 ERRS-embargos-vigentes    pic 999.
      *    Numero de embargos terminados
           03 ERRS-embargos-terminados  pic 999.
      *    Fecha ultimo embargo vigente YYMMDD
           03 ERRS-embargos-fecha-ultimo pic x(8).
      *    Causa del rechazo
           03 ERRS-causa-rechazo        pic x(300).

      ******************************************************************
      * Contiene los ids y nombres de personas
      ******************************************************************
       copy BDIIREGI.FD.

      ******************************************************************
      * Maestro de personas juridicas nacionales y extranjeras reportada
      * por la DIAN
      ******************************************************************
       copy BDIIDIAN.FD.

      ******************************************************************
      * Archivo maestro de cedulas de extranjeria suministrado por DAS
      ******************************************************************
       copy BDIIDAS.FD.

      ******************************************************************
      * Maestro de alertas reportadas por suscriptores
      ******************************************************************
       copy BDIIALE.FD.

      ******************************************************************
       WORKING-STORAGE section.
      ******************************************************************
      * Nombre del programa
       01  pgm                          pic x(10) value "CARGAJUR".

      ******************************************************************
      * Variables para rutina de validacion de identificaciones
      ******************************************************************
       copy BDIIVIDE.WS.

      ******************************************************************
      * Variables relacionadas con las alertas del sistema
      ******************************************************************
       copy BDIIALE.WS.

      ******************************************************************
      * Datos para las rutinas de validacion de nombres de VALNOM.PROC
      ******************************************************************
       copy VALNOM.WS.

      *****************************************************************
      * Direcciones de los archivos en el file system
      *****************************************************************
       copy ICFILE.WS.

      ******************************************************************
      * Indica que se termino el proceso, por agotamiento del archivo
      * de entrada (normal) o alguna otra condicion (error)
       01  IND-fin-proceso              pic xx value "NO".

      * Copia del ultimo reg de input, para mensajes (Ult reg: ...)
       01  JURAD-reg-anterior           pic x(100) value "(vacio)".
       01  JURAD-fs                     pic xx value spaces.

       01  ERRS-fs                      pic xx value spaces.

      * Datos de demandas o embargos que van en el registro BDIIALE
       01 D-datahost.
           05 D-vigentes                pic 9(5).
           05 D-terminados              pic 9(5).
           05 D-fecha-ultima            pic x(8).
      ******************************************************************
      * Parametros iniciales, de la linea de comando
      * La linea de comando que contiene los parametros
       01 P-command-line                pic x(80) value spaces.
       01 P-parametros.
      *    Proceso real: contiene "1" para activar, "2" por defecto
           03 P-proceso-real            pic xx value "2".
           88 PROCESO-REAL              value "1".

      *    Nombre del archivo de entrada JJJJJJaaaDDMMAAbbXX.txt
           03 P-file-name               pic x(80) value spaces.
           03 P-file-name-R             redefines P-file-name.
      *        JJJJJJ = Codigo de suscriptor JURAD en Experian
               05 P-cod-suscriptor      pic 9(6).
      *        aaa = Codificacion del producto ("100")
               05 P-producto            pic xxx.
      *        DDMMAA = Fecha de proceso
               05 P-fecha-proceso       pic x(6).
      *        bb =  01 a CI
               05 P-ci-bi               pic xx.
      *        XX = Tipo de proceso
      *        01 Envio Original - Carga TOTAL - primera vez
      *        02 Archivo Semanal - Carga PARCIAL
      *        03 Archivo Mensual - Carga PARCIAL
      *        04 Refresque Total - Carga TOTAL
               05 P-tipo-proceso        pic xx.
      *        extension del archivo ".txt"
               05 P-extension           pic x(4).
               05                       pic x(57).
           03 P-file-path               pic x(80) value spaces.
      * Nombre del archivo de errores JJJJJJaaaDDMMAAbbXX.errs
          03 ERRS-file-name             pic x(80) value spaces.

      * Fecha de proceso editada YYYYMMDD
       01 P-fecha-proceso-YYYYMMDD      pic x(8).
      * Fecha de proceso + 50 años
       01 P-fecha-proceso-50.
           03  P-fecha-proceso-50YYYY   pic 9999.
           03                           pic x(4).
      ******************************************************************
      * Datos para el reporte final
       01 W-tiempo.
           03 W-hora-inicio             pic 9(8).
           03 W-hora-fin                pic 9(8).
       01 N-edit                        pic z(8)B.
       01 N-editp100                    redefines N-edit
                                        pic z(5)9.9B.
       01 N-contadores.
      *    Registros en el archivo de entrada
           03 N-reg-leidos              pic 9(8) value zero.
      *    Registros procesados sin error
           03 N-reg-OK                  pic 9(8) value zero.
      *    Registros con error
           03 N-reg-con-error           pic 9(8) value zero.

      *    Cantidades de registros por tipo de novedad
           03 N-reg-tipo-I-OK           pic 9(8) value zero.
           03 N-reg-tipo-M-OK           pic 9(8) value zero.
           03 N-reg-tipo-E-OK           pic 9(8) value zero.
           03 N-reg-tipo-I-err          pic 9(8) value zero.
           03 N-reg-tipo-M-err          pic 9(8) value zero.
           03 N-reg-tipo-E-err          pic 9(8) value zero.

      *    Alertas borradas previo al refresque total
           03 N-ale-leidas              pic 9(8) value zero.
           03 N-ale-borradas            pic 9(8) value zero.
      *    Alertas insertadas
           03 N-ale-insertadas          pic 9(8) value zero.
      *    Alertas modificadas
           03 N-ale-modificadas         pic 9(8) value zero.
      *    Alertas eliminadas
           03 N-ale-eliminadas          pic 9(8) value zero.
      *    Insercion de alerta existente
           03 N-ale-ya-existe           pic 9(8) value zero.
      *    Modificacion o eliminacion de alerta inexistente
           03 N-ale-no-existe           pic 9(8) value zero.

      *    Sumas de cantidades de demandas y embargos
           03 N-demandas-vigentes       pic 9(5).
           03 N-demandas-terminadas     pic 9(5).
           03 N-embargos-vigentes       pic 9(5).
           03 N-embargos-terminados     pic 9(5).

      ******************************************************************
      * Armado de las lineas de alerta
       01 LA-lineas-alerta.
      *    Los modelos a continuacion deberan obtenerse de un 
      *    archivo, como BDIIALE-ALERTAS
           03 LAend                     pic 999 comp value 0.
           03 LA-modelos.
      *         12345678901234567890123456789012345678901234567890
               05 pic x(50) value
               "TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS        ".
               05 pic x(50) value
               "LA ABIERTA MAS RECIENTE SE INSTAURO EL [&&&&&&&&]".
               05 pic x(50) value
               "TIENE &&& EMBARGOS CANCELADOS Y &&& VIGENTES      ".
               05 pic x(50) value
               "EL EMBARGO MAS RECIENTE SE INSTAURO EL [&&&&&&&&] ".
               05 pic x(50) value high-values. *> end marker
           03 LA-modelos2               redefines LA-modelos.
               05 LA-modelo             pic x(50) occurs 5 
                                        indexed LAm.
      *    Funcionamiento de los templates.
      *    Hay dos templates por de alerta, uno por linea.
      *    Cada template consiste en hasta 10 frases fijas con
      *    ampersands (&) donde se van a reemplazar los valores.
      *    Por ejemplo: 
      *    TIENE &&& DEMANDAS CERRADAS Y &&& ABIERTAS
      *    tiene 3 frases fijas y 2 reemplazos. 
      *    La cantidad de ampersands es irrelevante, pero parece
      *    conveniente que informe sobre el tamanio del contenido.
           03 LA-templates.
               05 LA-template           occurs 4 indexed LAx.
                   07 LA-parte          pic x(50)
                                        occurs 10 indexed LAy.
      *    Las dos lineas armadas
           03 LA-lineas.
               05 LA-linea1             pic x(50).
               05 LA-linea2             pic x(50).
      *    Los valores a insertar en una linea
           03 LA-valores.
               05 LA-valor              pic x(50) 
                                        occurs 10 indexed LAv.
      *    Datos para editar valores a insertar
           03 LA-num                    pic -(11)0.
           03 LA-numX                   redefines LA-num
                                        pic x(12).
           03 LA-descarte               pic x(50).


      ******************************************************************
      * Errores de consistencia del input
      * Cada error tiene un codigo de 2 digitos, un espacio, contador
      * de ocurrencias de 7 digitos, un espacio, y descripcion de 59
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx value "NO".
      *    errores del registro actual
           03 E-errores-reg             pic x(300) value spaces.
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8) value zero.
      *    tabla de errores
           03 pic x(11) value "01 0000000 ".
           03 pic x(59) value
           "Tipo de movimiento invalido, debe ser I M E T".
           03 pic x(11) value "02 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion invalido, debe ser 1 2 3 4".
           03 pic x(11) value "03 0000000 ".
           03 pic x(59) value
           "Numero de identificacion invalido, debe ser numerico".
           03 pic x(11) value "04 0000000 ".
           03 pic x(59) value
           "Tipo de identificacion debe ser mayor que cero".
           03 pic x(11) value "05 0000000 ".
           03 pic x(59) value
           "Falta el nombre o denominacion".
           03 pic x(11) value "06 0000000 ".
           03 pic x(59) value
           "Numero de demandas vigentes: debe ser numerico".
           03 pic x(11) value "07 0000000 ".
           03 pic x(59) value
           "Numero de demandas terminadas: debe ser numerico".
           03 pic x(11) value "08 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "09 0000000 ".
           03 pic x(59) value
           "Fecha ultima demanda vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "10 0000000 ".
           03 pic x(59) value
           "Numero de embargos vigentes: debe ser numerico".
           03 pic x(11) value "11 0000000 ".
           03 pic x(59) value
           "Numero de embargos terminados: debe ser numerico".
           03 pic x(11) value "12 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: debe ser numerica".
           03 pic x(11) value "13 0000000 ".
           03 pic x(59) value
           "Fecha ultimo embargo vigente YYYYMMDD: fuera de rango".
           03 pic x(11) value "14 0000000 ".
           03 pic x(59) value
           "El numero de id no se encuentra en el archivo maestro".
           03 pic x(11) value "15 0000000 ".
           03 pic x(59) value
           "El nombre en el input no coincide con el registrado".
           03 pic x(11) value "16 0000000 ".
           03 pic x(59) value
           "Numero de id fuera del rango del tipo de id informado".
      *----------------- insertar nuevos items aqui -------------------
           03 pic x(11) value "00 0000000 ".
           03 pic x(59) value "--- fin de la lista (cod 00) ---".
           03                           pic x(3500). *> los 50 items
       01 E-errores-2                   redefines E-errores.
           03                           pic xx.
           03                           pic x(300).
           03                           pic 9(8).
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).
       01 E-edit                        pic z(8)B.

      ******************************************************************
      * Control de rangos de valores de las fechas del input
       01 VALIDACIONES-FECHAS.
           02 ANO-VAL-X                 pic 9(04).
              88 ANO-VAL                value 1900 thru 2050.
           02 MES-VAL-X                 pic 9(02).
              88 MES-VAL                value 01   thru 12.
           02 DIA-VAL-X                 pic 9(02).
              88 DIA-VAL                value 01   thru 31.

      /*****************************************************************
      ******************************************************************
       PROCEDURE DIVISION.
      *    0000-PROGRAMA-PRINCIPAL
      *    4000-PROCESAR-REGISTRO
      *    4000-PROCESAR-REGISTRO-2
      *    4100-VALIDACION-FORMAL
      *    4200-VALIDACION-SEMANTICA
      *    4300-MODIFICAR-BDIIALE
      *    4300-MODIFICAR-BDIIALE-DATOS
      *    4300-MODIFICAR-BDIIALE-I
      *    4300-MODIFICAR-BDIIALE-M
      *    4300-MODIFICAR-BDIIALE-E
      *    4333-LEER-BDIIALE-RANDOM
      *    4333-GRABAR-BDIIALE
      *    4333-REGRABAR-BDIIALE
      *    4333-ELIMINAR-BDIIALE
      *    4900-GRABAR-ERROR
      *    4320-ARMAR-TEXTO-ALERTA
      *    1000-RUTINA-INICIAL
      *    1001-ELIMINAR-TODO
      *    7000-RUTINA-FINAL
      *    9000-CANCELAR-PROGRAMA


       0000-PROGRAMA-PRINCIPAL.
      ******************************************************************
      *    inicializa el ambiente y abre los archivos
           perform 1000-RUTINA-INICIAL
      *    procesa cada uno de los registros del archivo JURAD hasta
      *    encontrar el registro "T" de totales
           perform 4000-PROCESAR-REGISTRO until IND-fin-proceso = "SI"
      *    cierra archivos y produce el reporte final
           perform 7000-RUTINA-FINAL
           goback.

       4000-PROCESAR-REGISTRO.
      ****************************************************************
      * Proceso de un registro del archivo de entrada JURAD
      * Lectura y control del file status del archivo
      ****************************************************************
      *    lectura del proximo registro
           read JURAD
           evaluate JURAD-fs
           when "00"
      *        controla el reg y lo aplica si es OK
               perform 4000-PROCESAR-REGISTRO-2
               move JURAD-reg to JURAD-reg-anterior
           when "10"
      *        fin del archivo de input:
      *        esto es un error, no se encontro el registro "T" antes
      *        de que se terminara el archivo
               display "Falta el reg de totales del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           when other
      *        error de lectura: cancelacion del proceso
               display "Error en lectura del archivo JURAD "
               display "Nombre del archivo: " P-file-name
               display "File status: " JURAD-fs
               display "Ultimo registro leido: " N-reg-leidos
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4000-PROCESAR-REGISTRO-2.
      ****************************************************************
      * Controla los datos de un registro de JURAD y si es OK lo usa
      * para actualizar el archivo de alertas en linea
      * La informacion esta leida en JURAD-reg
      ****************************************************************
           move "NO" to E-hay-error

      *    validacion del tipo de movimiento
           if JURAD-tipo-novedad not = "I" and "M" and "E" and "T" 
               call "PONERR" using "01" JURAD-reg E-errores
           end-if

      *    si es el registro "T" hay que senialar el fin de proceso
           if JURAD-tipo-novedad = "T" 
               move "SI" to IND-fin-proceso
               perform 4800-PROCESO-REG-T
               exit paragraph
           end-if

           add 1 to N-reg-leidos

      *    validacion formal de los datos
           perform 4100-VALIDACION-FORMAL
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               exit paragraph
           end-if

      *    si la validacion formal dio OK se hace validacion semantica
           perform 4200-VALIDACION-SEMANTICA
           if E-hay-error = "SI"
               perform 4900-GRABAR-ERROR
               exit paragraph
           end-if

      *    intento de actualizacion de BDIIALE
           perform 4300-MODIFICAR-BDIIALE
           add 1 to N-reg-OK.



       4100-VALIDACION-FORMAL.
      ******************************************************************
      * Validacion formal de los datos del input
      ******************************************************************
      *    Tipo de identificacion Numero {1, 2, 3, 4}
           if JURAD-id-tipo not = "1" and "2" and "3" and "4"
               call "PONERR" using "02" JURAD-reg E-errores
           end-if
      *    Numero de identificacion
           if JURAD-id-numeroX is not numeric
               call "PONERR" using "03" JURAD-reg E-errores
           end-if
           if JURAD-id-numero not > 0
               call "PONERR" using "04" JURAD-reg E-errores
           end-if
      *    si el movimiento es una eliminacion los datos subsiguientes
      *    no se controlan
           if JURAD-tipo-novedad = "E"
               exit paragraph
           end-if
      *    Nombres y Apellidos
           if JURAD-nombre = spaces
               call "PONERR" using "05" JURAD-reg E-errores
           end-if
      *    Numero de demandas vigentes
           if JURAD-demandas-vigentes is not numeric
               call "PONERR" using "06" JURAD-reg E-errores
           end-if
      *    Numero de demandas terminadas
           if JURAD-demandas-terminadas is not numeric
               call "PONERR" using "07" JURAD-reg E-errores
           end-if
      *    Fecha ultima demanda vigente YYMMDD
           if JURAD-demandas-fecha-ultima is not numeric
               call "PONERR" using "08" JURAD-reg E-errores
           end-if
           move JURAD-demandas-fecha-ultima to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "09" JURAD-reg E-errores
           end-if
      *    Numero de embargos vigentes
           if JURAD-embargos-vigentes not numeric
               call "PONERR" using "10" JURAD-reg E-errores
           end-if
      *    Numero de embargos terminados
           if JURAD-embargos-terminados not numeric
               call "PONERR" using "11" JURAD-reg E-errores
           end-if
      *    Fecha ultimo embargo vigente YYMMDD
           if JURAD-embargos-fecha-ultimo is not numeric
               call "PONERR" using "12" JURAD-reg E-errores
           end-if
           move JURAD-embargos-fecha-ultimo to VALIDACIONES-FECHAS
           if not ANO-VAL or not MES-VAL or not DIA-VAL
               call "PONERR" using "13" JURAD-reg E-errores
           end-if.


       4200-VALIDACION-SEMANTICA.
      ****************************************************************
      * Validacion del numero de identificacion y de su relacion con
      * el nombre
      ****************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIVIDE
           move JURAD-id-numero to NUM-IDE-BDIIVIDE-R
           move JURAD-nombre to NOMBRE-BDIIVIDE
           move 1 to SW-VERIFNOM-BDIIVIDE
           move 0 to SW-DIGCHEQUEO-BDIIVIDE SW-ASGTIPID-BDIIVIDE
           perform 80100-VALIDAR-IDENTIFICACION
      *    a ver si la validacion cambio el tipo de ide
           if JURAD-id-tipo not = TIP-IDE-BDIIVIDE
               call "PONERR" using "16" JURAD-reg E-errores
               display "Tipo ide cambiado de " JURAD-id-tipo " a " 
               TIP-IDE-BDIIVIDE " num ide: " JURAD-id-numero
           end-if
      *    SW-ID-BDIIVIDE: 0 si existe el id, 1 si no existe
           if SW-ID-BDIIVIDE = 1
               call "PONERR" using "14" JURAD-reg E-errores
           else
      *        existe id, a ver si el nombre coincide
               if SW-NOMBRES-BDIIVIDE = 1    *> nombre no coincide
                   call "PONERR" using "15" JURAD-reg E-errores
                   display "novedad:  " JURAD-nombre
                   display "registro: " NOM-LEIDO-BDIIVIDE
               end-if
           end-if.


       4300-MODIFICAR-BDIIALE.
      ******************************************************************
      * Se impacta el archivo BDIIALE con una o dos inserciones, 
      * modificaciones o eliminaciones segun haya o no demandas y 
      * embargos
      ******************************************************************
           initialize REG-BDIIALE

      *    si hay demandas
           if JURAD-demandas-vigentes > zero
           or JURAD-demandas-terminadas > zero 
               move "J001" to LLASEC-BDIIALE
      *        arma datos de demandas
               move JURAD-demandas-vigentes to D-vigentes
               move JURAD-demandas-terminadas to D-terminados
               string "20" JURAD-demandas-fecha-ultima 
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS 
           end-if.

      *    si hay embargos
           if JURAD-embargos-vigentes > zero
           or JURAD-embargos-terminados > zero 
               move "J002" to LLASEC-BDIIALE
      *        arma datos de embargos
               move JURAD-embargos-vigentes to D-vigentes
               move JURAD-embargos-terminados to D-terminados
               string "20" JURAD-embargos-fecha-ultimo
               delimited size into D-fecha-ultima
               perform 4300-MODIFICAR-BDIIALE-DATOS 
           end-if.



       4300-MODIFICAR-BDIIALE-DATOS.
      ******************************************************************
      * Parte de la carga de datos en el registro BDIIALE y grabacion
      * del mismo que es comun a demandas y embargos
      * El dato LLASEC-BDIIALE ya tiene "J001" o "J002"
      ******************************************************************
      *    completa la clave e intenta leer la alerta, si se leyo OK
      *    el file status de BDIIALE queda con "00"
           perform 4333-LEER-BDIIALE-RANDOM

      *    procesa segun el tipo de novedad I M E
           evaluate JURAD-tipo-novedad
           when "I"
               add 1 to N-reg-tipo-I-OK
               perform 4300-MODIFICAR-BDIIALE-I
           when "M"
               add 1 to N-reg-tipo-M-OK
               perform 4300-MODIFICAR-BDIIALE-M
           when "E"
               add 1 to N-reg-tipo-E-OK
               perform 4300-MODIFICAR-BDIIALE-E
           when other
      *        esto es "imposible" por control de consistencia anterior
               display "error de logica: tipo-novedad="
               JURAD-tipo-novedad " reg nÂ°: " N-reg-leidos
               display "Registro de JURAD: " display JURAD-reg
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4300-MODIFICAR-BDIIALE-I.
      ******************************************************************
      * Insercion de una alerta nueva
      * Si ya existia muestra un mensaje y continua
      ******************************************************************
      *    si el registro existia es un error
           if EST-BDIIALE = "00"
               display "Insercion de alerta nueva que ya existe "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               add 1 to N-ale-ya-existe
           end-if

      *    completa los datos del registro
           initialize ENCABEZADO-BDIIALE
           move P-fecha-proceso-YYYYMMDD to FEC-NOV-BDIIALE
           FEC-REP-BDIIALE 
           move P-fecha-proceso-50 to FEC-VEN-BDIIALE
           move 0 to BLOQUEO-BDIIALE
           move D-datahost to INF-DATAHOST-BDIIALE
           perform 4320-ARMAR-TEXTO-ALERTA
           if EST-BDIIALE = "00"
               perform 4333-REGRABAR-BDIIALE
           else
               perform 4333-GRABAR-BDIIALE
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-I k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4300-MODIFICAR-BDIIALE-M.
      ******************************************************************
      * Modificacion de una alerta existente
      * Si no existia muestra un mensaje y continua
      ******************************************************************
      *    si el registro no existia es un error
           if EST-BDIIALE not = "00"
               display "Modificacion de alerta inexistente "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               display "Datos en la alerta: " INF-DATAHOST-BDIIALE
               add 1 to N-ale-no-existe
           end-if
      *    reemplaza la fecha de reporte y los valores
           move P-fecha-proceso-YYYYMMDD to FEC-REP-BDIIALE 
           move D-datahost to INF-DATAHOST-BDIIALE
           perform 4320-ARMAR-TEXTO-ALERTA
           if EST-BDIIALE = "00"
               perform 4333-REGRABAR-BDIIALE
           else
               perform 4333-GRABAR-BDIIALE
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-M k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4300-MODIFICAR-BDIIALE-E.
      ******************************************************************
      * Eliminacion de una alerta
      * Si no existia muestra un mensaje y continua
      ******************************************************************
      *    elimina el registro
           if EST-BDIIALE = "00"
               perform 4333-ELIMINAR-BDIIALE
           else
               display "Eliminacion de alerta inexistente "
               " key: " LLAVE-BDIIALE
               display "Registro de input: "
               display JURAD-reg
               add 1 to N-ale-no-existe
           end-if.
      *    display "4300-MODIFICAR-BDIIALE-E k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-LEER-BDIIALE-RANDOM.
      ******************************************************************
      * Arma clave exacta y lee un registro de BDIIALE
      * Usa los datos del reg input, excepto LLASEC que esta precargado
      * Cuando pudo leer OK el file status EST-BDIIALE queda con "00"
      ******************************************************************
           move JURAD-id-tipo to TIP-IDE-BDIIALE
           move JURAD-id-numero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move 000 to COD-ALERTA-BDIIALE
      *    LLASEC-BDIIALE fué previamente cargado con J001 o J002

           read BDIIALE
           evaluate EST-BDIIALE
           when "00"
               continue
           when "23"
               continue
           when other
               display "Error al leer BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Ultimo registro procesado: "
               display JURAD-reg-anterior
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.
      *    display "4333-LEER-BDIIALE-RANDOM k:" LLAVE-BDIIALE
      *    " fs:" EST-BDIIALE.


       4333-GRABAR-BDIIALE.
      ******************************************************************
      * Inserta un registro nuevo en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           write REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-insertadas
           when other
               display "Error al grabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-REGRABAR-BDIIALE.
      ******************************************************************
      * Regraba un registro modificado en BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           rewrite REG-BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-modificadas
           when other
               display "Error al regrabar BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.


       4333-ELIMINAR-BDIIALE.
      ******************************************************************
      * Elimina un registro de BDIIALE
      ******************************************************************
           if not PROCESO-REAL
               exit paragraph
           end-if
           delete BDIIALE
           evaluate EST-BDIIALE
           when "00"
               add 1 to N-ale-eliminadas
           when other
               display "Error al deletear BDIIALE fs: " EST-BDIIALE
               " key: " LLAVE-BDIIALE
               display "Registro BDIIALE: "
               display REG-BDIIALE
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

       4800-PROCESO-REG-T.
      ******************************************************************
      * El registro leido en el archivo JURAD es tipo "T" con totales
      * de control, y debería ser el ultimo del archivo
      ******************************************************************
      * Control de los totales calculados contra los esperados
           move "NO" to E-hay-error
      *    cantidad de registros I M E
           if function numval(JURADT-registros) = N-reg-leidos
               continue
           else
               display " "
               display "No coincide la cantidad de registros:"
               JURADT-registros " con los leidos:" N-reg-leidos
               move "SI" to E-hay-error
           end-if

      *    Sumas de cantidades de demandas y embargos
           if function numval(JURADT-demandas-terminadas)
           = N-demandas-terminadas
               continue
           else
               display " "
               display "No coincide total de demandas terminadas:"
               JURADT-demandas-terminadas " con el calculado:"
               N-demandas-terminadas
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-vigentes)
           = N-embargos-vigentes
               continue
           else
               display " "
               display "No coincide total de embargos vigentes:"
               JURADT-embargos-vigentes " con el calculado:"
               N-embargos-vigentes
               move "SI" to E-hay-error
           end-if

           if function numval(JURADT-embargos-terminados)
           = N-embargos-terminados
               continue
           else
               display " "
               display "No coincide total de embargos terminados:"
               JURADT-embargos-terminados " con el calculado:"
               N-embargos-terminados
               move "SI" to E-hay-error
           end-if.

      *    si hubo cualquier cosa se invalida el proceso
           if E-hay-error = "SI"
               display "Error en registro T de totales de control"
               display "Nombre del archivo: " ERRS-file-name
               perform 9000-CANCELAR-PROGRAMA
           end-if.


       4900-GRABAR-ERROR.
      ******************************************************************
      * El registro de JURAD tiene error: se graba en el archivo ERRS
      * con indicacion del error detectado
      ******************************************************************
           move JURAD-reg to ERRS-reg
           move E-errores-reg to ERRS-causa-rechazo
      *    lista de los codigos de los errores del registro
           move E-errores-reg to ERRS-causa-rechazo
           write ERRS-reg
           evaluate ERRS-fs
               when "00"
                   continue
               when other
                   display "Error al grabar el archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA
                   goback
           end-evaluate.
 

       4320-ARMAR-TEXTO-ALERTA.
      ****************************************************************
      * Hace el reemplazo de los valores adecuados en los templates
      * de las linea de alerta que corresponde
      ****************************************************************
      *    segun se trate de demandas o embargos
           if JURAD-demandas-vigentes not = 0 
           or JURAD-demandas-terminadas not = 0
               set LAx to 1
               move high-values to LA-valores
               move JURAD-demandas-vigentes to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(1)
      *        delimited by all space
               move LA-numx(9:12) to LA-valor(1)
               move JURAD-demandas-terminadas to LA-num
      * >>>> esto esta anulado x que no se como hacer para que lo compile
      *        unstring LA-numX into LA-descarte LA-valor(2)
      *        delimited by all space
               move LA-numx(9:12) to LA-valor(2)

      * >>>> esto esta anulado x que no se como hacer para que lo compile
      * >>>> da error en el end-if
      *        string LA-parte(LAx, 1) LA-valor(1)
      *        LA-parte(LAx, 2) LA-valor(2) LA-parte(LAx, 3) LA-valor(3)
      *        LA-parte(LAx, 4) LA-valor(4) LA-parte(LAx, 5) LA-valor(5)
      *        LA-parte(LAx, 6) LA-valor(6) LA-parte(LAx, 7) LA-valor(7)
      *        LA-parte(LAx, 8) LA-valor(8) LA-parte(LAx, 9) LA-valor(9)
      *        LA-parte(LAx, 10) LA-valor(10)
      *        delimited by high-value
           end-if.


       1000-RUTINA-INICIAL.
      ******************************************************************
      * Todas las operaciones que se realizan una sola vez, al comienzo
      * del programa:
      *   - obtencion de los parametros
      *   - apertura del archivo de entrada
      *   - apertura de todos los demas archivos
      *   - eliminacion de datos existentes si es refresque completo
      ******************************************************************
      * Registra hora de inicio
           accept W-hora-inicio from time

      * Obtiene informacion sobre la corrida de la linea de comando: el
      * nombre del archivo de entrada (que contiene el tipo de proceso),
      * el indicador de proceso real o en falso (default)
           accept P-command-line from COMMAND-LINE
           display "Parametros: " P-command-line
           unstring P-command-line delimited by all " " into
           P-file-name P-proceso-real

      * El programa se anuncia en la consola
      * TODO: se usa un anuncio mas vistoso?
           if PROCESO-REAL
               display pgm " Carga de archivo JURAD - proceso REAL"
           else
               display pgm " Carga de archivo JURAD - proceso en falso"
           end-if

      * El indicador de proceso real debe ser 1 o 2
           if P-proceso-real not = "1" and "2"
               display "El indicador de proceso real es invalido"
               display "debe ser 1 o 2"
               perform 9000-CANCELAR-PROGRAMA
           end-if

      * TODO: controlar los componentes del filename
           evaluate P-tipo-proceso
           when "01"
               display "01 Envio Original - Carga TOTAL 1a vez"
           when "02"
               display "02 Archivo Semanal - Carga PARCIAL"
           when "03"
               display "03 Archivo Mensual - Carga PARCIAL"
           when "04"
               display "04 Refresque Total - Carga TOTAL"
           when other
      *        valor invalido
               display "El tipo de proceso " P-tipo-proceso
               " es invalido (debe ser 01 02 03 o 04)"
               perform 9000-CANCELAR-PROGRAMA
           end-evaluate.

      * Edita la fecha de proceso DDMMAA del parametro en formato
      * YYYYMMDD 
           string "20" P-fecha-proceso(5:6) P-fecha-proceso(3:4)
           P-fecha-proceso(1:2) delimited size 
           into P-fecha-proceso-YYYYMMDD
           display "Fecha de proceso: " P-fecha-proceso-YYYYMMDD

      * Calcula una fecha 50 anios posterior a la de proceso
           move P-fecha-proceso-YYYYMMDD to P-fecha-proceso-50
           add 50 to P-fecha-proceso-50YYYY

      * Apertura del archivo de entrada
           string "$TEMPORALES/" P-file-name into P-file-path
           open input JURAD
           evaluate JURAD-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo JURAD "
                   display "Path del archivo: " P-file-path
                   display "File status: " JURAD-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura del archivo de errores
           string "$TEMPORALES/" P-file-name(1:19) ".errs"
           into ERRS-file-name
           open output ERRS
           evaluate ERRS-fs
               when "00"
                    continue
               when other
                   display "Error en open del archivo de errores "
                   display "Nombre del archivo: " ERRS-file-name
                   display "File status: " ERRS-fs
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
                   goback
           end-evaluate.

      * Apertura de los archivos maestros
      * TODO: falta capturar el status de estas operaciones?
           open input BDIIREGI
           open input BDIIDIAN
           open input BDIIDAS.

      * Apertura del archivo de alertas en linea
           if PROCESO-REAL
               open i-o BDIIALE
           else
               open input BDIIALE
           end-if.

      * Si es un refresque total (codigo 04) se eliminan los registros
      * de Jurad existentes
           if P-tipo-proceso = "04" and PROCESO-REAL
               perform 1001-ELIMINAR-TODO
           end-if.

       1000-NOT-USED.
      * >>>> esto da un error de compilacion que no puedo resolver
      * >>>> por ahora esta anulado
      ******************************************************************
      * Carga de los templates para armar el texto de alertas
      * TODO: por ahora los templates son literales
           set LAx to 0
           move high-values to LA-templates
           perform varying LAm from 1 by 1 
           until LA-modelo(LAm) = high-values
               set LAx up by 1
      *        separa las partes de la linea
      *        unstring LA-modelo(LAm) into LA-parte(LAx, 1)
      *        LA-parte(LAx, 2) LA-parte(LAx, 3) LA-parte(LAx, 4)
      *        LA-parte(LAx, 5) LA-parte(LAx, 6) LA-parte(LAx, 7)
      *        LA-parte(LAx, 8) LA-parte(LAx, 9) LA-parte(LAx, 10)
      *        delimited by all "&"
      *        prepara para omitir los espacios al final de c/parte
               perform varying LAy from 1 by 1 until LAy > 10
                   inspect LA-parte(LAx, LAy) replacing trailing
                   spaces by high-values
                   inspect LA-parte(LAx, LAy) replacing first
                   high-value by space
               end-perform
           end-perform.


       1001-ELIMINAR-TODO.
      ******************************************************************
      * Elimina los registros de alertas existentes en el archivo de
      * alertas en linea, previo a un refresque total
      ******************************************************************
           display "Eliminando toda la informacion con fuente JURAD"
      *    posiciona en el primer reg de JURAD
           move zero to TIP-IDE-BDIIALE
           move zero to NUM-IDE-BDIIALE
           move P-cod-suscriptor to FUENTE-BDIIALE
           move zeros to COD-ALERTA-BDIIALE
           move low-values to LLASEC-BDIIALE
           start BDIIALE key > LLAVE-BDIIALE
      *    display "Start BDIIALE k:" LLAVE-BDIIALE
           evaluate EST-BDIIALE
           when "00"
      *        posicionado
               continue
           when other
      *        no hay registros
               display "No hay registros a eliminar fs:" EST-BDIIALE
               exit paragraph
           end-evaluate.

      *    lee secuencialmente y elimina los registros de JURAD
      *    hasta el fin del archivo
           perform until EST-BDIIALE not = "00"
               read BDIIALE next record
               evaluate EST-BDIIALE
               when "00"
      *            display "BDIIALE leido fs:" EST-BDIIALE
      *            " k:" LLAVE-BDIIALE
                   if FUENTE-BDIIALE = P-cod-suscriptor
      *                es un alerta de JURAD
                       delete BDIIALE
                       if EST-BDIIALE = "00"
      *                    display "BDIIALE eliminado k:" LLAVE-BDIIALE
                           add 1 to N-ale-borradas
                       else
      *                    error en la eliminacion
                           display "Error al eliminar un registro de "
                           "BDIIALE vaciando los datos"
                           display "Clave: " LLAVE-BDIIALE
                           display "Reg borrados: " N-ale-borradas
                           perform 9000-CANCELAR-PROGRAMA
                       end-if
                   end-if
               when "10"
      *            fin de archivo: sale normalmente
                   display "Fin de los registros a eliminar - leídos:"
                   N-ale-leidas
               when other
      *            lectura anormal: cancelacion del programa
                   display "Error en lectura del archivo de alertas "
                   "online"
                   display "File status: " EST-BDIIALE
                   perform 9000-CANCELAR-PROGRAMA *> no retorna
               end-evaluate
           end-perform.
           display "Termino la eliminacion total de JURAD"
           display "Reg borrados: " N-ale-borradas.


       7000-RUTINA-FINAL.
      ******************************************************************
      * Registra hora de finalizacion
           accept W-hora-fin from time

      * Leer JURAD a ver si hay registros despues del "T"

      * Close todos los archivos
           close JURAD ERRS BDIIREGI BDIIDIAN BDIIDAS BDIIALE.
      
      * Emision de contadores de registros
           display " "
           display "Totales de registros:"
           display " "
           compute N-editp100 rounded = 100.0 * E-cont-regs-con-error
           / N-reg-leidos
           display N-editp100 "% de registros inconsistentes" 
           move N-reg-leidos to N-edit 
           display N-edit "Registros IME en el archivo de entrada"
           move N-reg-OK to N-edit 
           display N-edit "Registros procesados sin error"

      * >>>> not OK: suma para J001 y tambien J002, hay que cambiar la
      * definicion de estos contadores
      *    move N-reg-tipo-I-OK to N-edit
      *    display N-edit "Registros tipo I aceptados"
      *    move N-reg-tipo-M-OK to N-edit
      *    display N-edit "Registros tipo M aceptados"
      *    move N-reg-tipo-E-OK to N-edit
      *    display N-edit "Registros tipo E aceptados"

           move E-cont-regs-con-error to N-reg-con-error
           move N-reg-con-error to N-edit 
           display N-edit "Registros con error"
           move N-ale-borradas to N-edit 
           display N-edit "Alertas borradas previo al refresque total"
           move N-ale-insertadas to N-edit 
           display N-edit "Alertas insertadas"
           move N-ale-modificadas to N-edit 
           display N-edit "Alertas modificadas"
           move N-ale-eliminadas to N-edit 
           display N-edit "Alertas eliminadas"
           move N-ale-ya-existe to N-edit 
           display N-edit "Insercion de alerta existente"
           move N-ale-no-existe to N-edit 
           display N-edit "Modif o elim de alerta inexistente".

      * Emision del reporte de errores
           display " "
           display "Totales por tipo de error detectado:"
           perform varying Ex from 1 by 1 until Ex > 50
           or E-codigo(Ex) = "00"
               if E-contador(Ex) not = 0 
                   move E-contador(ex) to E-edit
                   display E-edit E-codigo(Ex) "-" E-descripcion(Ex)
               end-if
           end-perform.


       9000-CANCELAR-PROGRAMA.
      ******************************************************************
      * Procedimiento standard de cancelacion de programa batch
      ******************************************************************
      * TODO: hay un standard para comunicar una cancelacion de proceso?
           display " "
           display pgm " - proceso cancelado"
           goback returning 99.


           copy BDIIVIDE.PROC.


           copy VALNOM.PROC.


      /
       IDENTIFICATION DIVISION.
       PROGRAM-ID. PONERR.
      ******************************************************************
      * Rutina de conveniencia para procesar un error detectado en un
      * registro de input
      * Contabiliza el error en la tabla de errores, activa el indicador
      * de registro con error, muestra el mensaje en la pantalla, cuenta
      * el registro erroneo
      ******************************************************************
       ENVIRONMENT DIVISION.
       DATA DIVISION.
       WORKING-STORAGE SECTION.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input-anterior           pic x(86) value low-values.
      * Posicion del proximo error en la lista de errores del reg
       01  errIndex                     pic 999 comp.
      ******************************************************************

       LINKAGE SECTION.
      ******************************************************************
      * Codigo del error detectado
       01  cod-error                    pic xx.
      ******************************************************************
      * Registro de input (primeros 86 caracteres)
       01  reg-input                    pic x(86).
      ******************************************************************
      * Tabla de errores de consistencia del input
       01 E-errores.
      *    indica si el registro actual tiene error
           03 E-hay-error               pic xx.
      *    errores del registro actual
           03 E-errores-reg             pic x(300).
      *    contador de registros con error
           03 E-cont-regs-con-error     pic 9(8).
      *    tabla de errores
           03 E-error                   occurs 50 indexed Ex.
               05 E-codigo              pic xx.
               05                       pic x.
               05 E-contador            pic 9(7).
               05                       pic x.
               05 E-descripcion         pic x(59).

      ******************************************************************

       PROCEDURE DIVISION using cod-error reg-input E-errores.
       00.
      *    marca al reg actual como erroneo
           move "SI" to E-hay-error

      *    cuenta y muestra el registro de input
           if reg-input not = reg-input-anterior
               add 1 to E-cont-regs-con-error
               display " "
               display reg-input
               move reg-input to reg-input-anterior
               move spaces to E-errores-reg
               move 2 to errIndex
           end-if

      *    contabiliza el error en la tabla de errores
           set Ex to 1
           search E-error varying Ex
           at end
               display "--- falla en la tabla de errores ---" cod-error
           when E-codigo(Ex) = "00"
               add 1 to E-contador(Ex)
               display "--- error tipo exotico: " cod-error
               add 1 to E-contador(Ex)
           when E-codigo(Ex) = cod-error
               add 1 to E-contador(Ex)
               display "Error " cod-error " " E-descripcion(Ex)
           end-search

      *    agrega a la lista de errores del registro
           if errIndex < (300 - 59 - 3)
               move cod-error to E-errores-reg(errIndex:2)
               add 3 to errIndex
               move E-descripcion(Ex) to E-errores-reg(errIndex:59)
               add 59 to errIndex
           end-if

           exit program.


       end program PONERR.

       end program CARGAJUR2.

      ******************************************************************
      ******************************************************************


/d/iccol/desarrollo/fuentes>^[  /d/iccol/desarrollo/fuentes>cat CARGAJUR.CBL CARGAJUR.CBL   v CARGAJUR.CBLi CARGAJUR.CBL
"CARGAJUR.CBL" 1324 lines, 56025 characters $SET LIST SETTINGIDENTIFICATION DIVISION.
PROGRAM-ID.    CARGAJUR2.
******************************************************************
* Actualizacion del archivo de alertas con los datos provistos
* por Jurad
* Procesa el archivo JURAD. Controla cada registro: si es OK usa
* los datos para actualizar BDIIALE, si tiene defecto lo graba en
* el archivo ERRS.
******************************************************************
AUTHOR.Globant JL.
DATE-WRITTEN.
DATE-COMPILED.
CONFIGURATION section.
SOURCE-COMPUTER. microfocus.
OBJECT-COMPUTER. microfocus.
INPUT-OUTPUT section.
FILE-CONTROL.******************************************************************
******************************************************************
select JURAD assign to P-file-pathorganization is line sequentialfile status is JURAD-fs.******************************************************************
******************************************************************
select ERRS assign to ERRS-file-nameorganization is line sequentialfile status is ERRS-fs.******************************************************************
******************************************************************copy BDIIREGI.FS.******************************************************************
******************************************************************copy BDIIDIAN.FS.******************************************************************
******************************************************************copy BDIIDAS.FS.******************************************************************
******************************************************************copy BDIIALE.FS replacing == on record.== by == on recordfile status is EST-BDIIALE.==.******************************************************************
******************************************************************
DATA DIVISION.
FILE section.******************************************************************
* Archivo de entrada con los datos de demandas y embargos de JURAD"CARGAJUR.CBL" 1324 lines, 56025 characters
 
"CARGAJUR.CBL" 1324 lines, 56024 characters /d/iccol/desarrollo/fuentes>jobs
/d/iccol/desarrollo/fuentes>l co*
-rw-rw-r--   1 227      icdatacr    4295 Nov 20  2001 co-sus.cbl
-rw-r-----   1 1414     icdatacr   55338 Jul 27  2010 cobol-db2yyyy
-rw-rw-r--   1 icgjcd   icdatacr       0 Jan 22 16:28 cobol.dir
-rw-rw-r--   1 icjdld   icdatacr   29042 Apr 20  2010 colomb.cbl
-rwxrwxrwx   1 227      icdatacr    1085 Jan 16  2002 comp_conver16
-rwxrwxr-x   1 227      icdatacr     996 Jan 18  2002 comp_conver32
-rwxrwxr-x   1 227      icdatacr    1167 Jan 16  2002 comp_conver64
-rw-rw-r--   1 icjdld   icdatacr   17529 Apr 20  2010 comp-cre.cbl
-rwxrwxr-x   1 icfacd   icdatacr     362 May 26  2005 comp-pais
-rw-rw-r--   1 227      icdatacr   33491 Nov 20  2001 compar-n.cbl
-rw-rw-r--   1 227      icdatacr   40893 Nov 20  2001 compara.cbl
-rw-rw-r--   1 icjdld   icdatacr   18752 Apr 20  2010 compcre.cbl
-rw-rw-r--   1 icjdld   icdatacr   16613 Apr 20  2010 compcre1.cbl
-rw-rw-r--   1 icjdld   icdatacr   16462 Apr 20  2010 compcre2.cbl
-rw-rw-r--   1 icjdld   icdatacr   25660 Mar 11  2010 con-510046.cbl
-rw-rw-r--   1 icjdld   icdatacr    5964 Apr 20  2010 con-achk.cbl
-rw-rw-r--   1 227      icdatacr    9562 Nov 20  2001 con-acre.cbl
-rw-rw-r--   1 227      icdatacr    4870 Nov 20  2001 con-asup.cbl
-rw-rw-r--   1 227      icdatacr    5244 May 29  2002 con-hist
-rw-rw-r--   1 icjdld   icdatacr    7532 Apr 20  2010 con-mchk.cbl
-rw-rw-r--   1 227      icdatacr   17250 Nov 20  2001 con-mcre.cbl
-rw-rw-r--   1 227      icdatacr    5918 Nov 20  2001 con-msup.cbl
-rw-rw-r--   1 227      icdatacr    4851 Nov 20  2001 conbat-msup.cbl
-rw-rw-r--   1 icjdld   icdatacr   29297 Apr 20  2010 concol.cbl
-rw-rw-r--   1 227      icdatacr    4851 Nov 20  2001 conmsup.cbl
-rw-rw-r--   1 icjdld   icdatacr   31823 Mar 11  2010 cons-act-rev.cbl
-rw-rw-r--   1 icjdld   icdatacr   10766 Mar 11  2010 cons-act.cbl
-rw-rw-r--   1 icjdld   icdatacr   22961 Mar 11  2010 cons-act1.cbl
-rw-rw-r--   1 icjdld   icdatacr   83909 Mar 11  2010 cons-actarev.cbl
-rw-rw-r--   1 iccavd   icdatacr    8609 Jul  8  2009 cons-camp-sus-nw.cbl
-rw-rw-r--   1 iccavd   icdatacr    8597 Jul  7  2009 cons-camp-sus.cbl
-rw-rw-r--   1 iccavd   icdatacr      78 Oct  2  2008 cons-cvs
-rw-rw-r--   1 iccavd   icdatacr   11757 Oct 22  2012 cons-det-gar.cbl
-rw-rw-r--   1 icjdld   icdatacr   33362 Mar 11  2010 cons-mchkval-rev.cbl
-rw-rw-r--   1 icjdld   icdatacr   23328 Mar 11  2010 cons-mchkval.cbl
-rw-rw-r--   1 icjdld   icdatacr   10274 Mar 11  2010 cons-mcre.cbl
-rw-rw-r--   1 icjdld   icdatacr   23239 Mar 11  2010 cons-mcre1-mov1.cbl
-rw-rw-r--   1 icjdld   icdatacr   10549 Mar 11  2010 cons-mcre1.cbl
-rw-rw-r--   1 icjdld   icdatacr  148171 Mar 11  2010 cons-mcreval-emp.cbl
-rw-rw-r--   1 icjdld   icdatacr   53044 Mar 11  2010 cons-mcreval-mig.cbl
-rw-rw-r--   1 icjdld   icdatacr   23398 Mar 11  2010 cons-mcreval.cbl
-rw-rw-r--   1 icjdld   icdatacr   19133 Mar 11  2010 cons-mcte1-mov1.cbl
-rw-rw-r--   1 iccavd   icdatacr   10947 Sep 21  2011 cons-mvlr-cavs.cbl
-rw-rw-r--   1 icjdld   icdatacr   10300 Oct 23  2012 cons-mvlr1.cbl
-rw-rw-r--   1 iccavd   icdatacr   71408 Jun 12  2012 cons-tot-desa.cbl
-rw-rw-r--   1 iccavd   icdatacr   74221 Jun 21  2012 cons-tot.cbl
-rw-rw-r--   1 iccavd   icdatacr    8631 Sep 24  2010 consbdscore-t8.cbl
-rw-rw-r--   1 iccavd   icdatacr   14752 Aug 27  2007 conscsvpru.cbl
-rw-rw-r--   1 iccavd   icdatacr   17355 Feb 15  2011 const-bbva-gar.cbl
-rw-rw-r--   1 iccavd   icdatacr    9212 Oct  2  2008 consult-csv.cbl
-rw-rw-r--   1 iccavd   icdatacr    5964 Apr  3  2009 consult-csv1.cbl
-rwxrwxr-x   1 icrmbd   icdatacr   21859 Oct 14  2003 consulta.c
-rwxrwxr-x   1 icrmbd   icdatacr    1630 Oct  7  2003 consulta.cpy
-rwxrwxr-x   1 icrmbd   icdatacr     729 Oct  7  2003 consulta.h
-rw-rw-r--   1 icvhfd   icdatacr   24888 Sep 13  2005 consulta.o
-rw-r-----   1 1395     icdatacr     148 Feb 28  2011 consumid.log
-rw-r-----   1 1395     icdatacr   11433 Feb 28  2011 consumid.txt
-rw-rw-r--   1 iccavd   icdatacr   45984 Sep 19  2011 cont-hsbc.cbl
-rw-rw-r--   1 227      icdatacr    3867 Nov 20  2001 contced.cbl
-rwxrwxrwx   1 icrmbd   icdatacr  100541 Feb  4 14:43 convccitcp.cbl
-rwxrwxr-x   1 icrmbd   icdatacr   99856 Feb  3 09:46 convccitcp.cbl.ant
-rw-rw-r--   1 227      icdatacr    9171 Nov 20  2001 convcla.cbl
-rw-rw-r--   1 227      icdatacr   14127 Nov 20  2001 conversor1.cbl
-rw-rw-r--   1 icgjcd   icdatacr  102918 Feb 26 09:44 convtcpregistro.cbl
-rw-rw-r--   1 icjdld   icdatacr    6888 Mar 11  2010 copia-mcte1-mov1.cbl
-rw-r-----   1 1414     icdatacr      62 Jul 27  2010 copyscopy1.fd
-rw-rw-r--   1 227      icdatacr   15629 Nov 20  2001 cornopr1.cbl

cobol:
total 17732
-rw-r--r--   1 icbuild  icprodd   125686 May  6  2013 ACTAREVCR.CBL
-rw-r--r--   1 icbuild  icprodd   348954 May  6  2013 ACTEUNI.CBL
-rw-r--r--   1 icbuild  icprodd    42084 May  6  2013 ACTMEDRP.CBL
-rw-r--r--   1 icbuild  icprodd   205013 May  6  2013 ACTMIGRAC.CBL
-rw-r--r--   1 icbuild  icprodd   835749 May  6  2013 ACTVLCR.CBL
-rw-r--r--   1 icbuild  icprodd    15842 May  6  2013 BDAPLSUS.CBL
-rw-r--r--   1 icbuild  icprodd   137354 May 30  2013 BDLDIREC.CBL
-rw-r--r--   1 icbuild  icprodd    85552 Apr  4  2013 CARACTUSA.CBL
-rw-r--r--   1 icbuild  icprodd    61005 Nov  1  2012 CTLN97_PRUEBABF_as.CBL
-rw-r--r--   1 icbuild  icprodd    59831 Nov  1  2012 CTLN97_PRUEBABF_bi.CBL
-rw-r--r--   1 icbuild  icprodd    86598 Apr 18  2013 CVCIFDCRE-HSBC.CBL
-rw-r--r--   1 icbuild  icprodd    95319 May 22  2013 CVCIFDCRE.CBL
-rw-r--r--   1 icbuild  icprodd    10136 Mar  1  2013 icepredat665_pruebabf.cbl
-rw-r--r--   1 icbuild  icprodd   143047 May 10  2013 icestd81.cbl
-rw-rw-r--   1 icdgd    icdatacr  178581 May 21 10:39 icestd81.gnt
-rw-rw-r--   1 icdgd    icdatacr  439040 May 21 10:39 icestd81.idy
-rw-rw-r--   1 icdgd    icdatacr   93696 May 21 10:39 icestd81.int
-rw-rw-r--   1 icdgd    icdatacr  526319 May 21 10:39 icestd81.lst
-rw-rw-r--   1 icdgd    icdatacr 1369753 May 21 10:39 icestd81.s
-rw-r--r--   1 icbuild  icprodd   144639 May 10  2013 icestd81CyG01.cbl
-rw-r--r--   1 icbuild  icprodd    80537 May 22  2013 icestdmnt95.cbl
-rw-r--r--   1 icbuild  icprodd    97831 Apr 22  2013 icestVECSCOBL01.cbl
-rw-r--r--   1 icbuild  icprodd   184499 Mar  1  2013 ICGD38.CBL
-rw-r--r--   1 icbuild  icprodd   326955 Feb  1  2013 ICGD57.CBL
-rw-r--r--   1 icbuild  icprodd   231395 Nov 14  2012 ICGD75D.CBL
-rw-r--r--   1 icbuild  icprodd   279708 Apr 25  2013 ICGD82_BF_2.CBL
-rw-r--r--   1 icbuild  icprodd   274991 Mar 27  2013 ICGD82_BF.CBL
-rw-r--r--   1 icbuild  icprodd   279708 Mar 19  2013 ICGD82ABCBF.CBL
-rw-r--r--   1 icbuild  icprodd  1293822 Feb 11  2013 ICGMDFBF_2.CBL
-rw-r--r--   1 icbuild  icprodd   255633 May  6  2013 ICJSUS.CBL
-rw-r--r--   1 icbuild  icprodd    83367 May  6  2013 ICSAC1.CBL
-rw-r--r--   1 icbuild  icprodd     2240 May  6  2013 UTLUINISUS4.CBL
-rw-r--r--   1 icbuild  icprodd     7610 Jun 11  2013 UTLULONGITUDESBF.CBL
-rw-r--r--   1 icbuild  icprodd     7789 Mar  1  2013 UTLULONGITUDESPRUEBA.CBL
-rw-r--r--   1 icbuild  icprodd     7777 Oct  8  2012 UTLULONGITUDESPRUEBA2.CBL
-rw-r--r--   1 icbuild  icprodd     7810 Nov  1  2012 UTLULONGITUDESPRUEBA3.CBL
-rw-r--r--   1 icbuild  icprodd   334332 May  6  2013 VALCALCR.CBL
-rw-r--r--   1 icbuild  icprodd    57193 May  6  2013 VALVORDCR.CBL

cobol-db2:
total 8260
-rw-r--r--   1 icbuild  icprodd   145410 Apr 22  2013 CMSSMS.CBL
-rw-r-----   1 1414     icdatacr   55338 Aug 25  2010 DTCASUS.CBL
-rw-r--r--   1 icbuild  icprodd    55339 Jun 11  2013 DTCASUSBF.CBL
-rw-rw-r--   1 icbuild  icprodd    17862 Jun 11  2013 DTCASUSBF.err
-rw-r--r--   1 icbuild  icprodd     9929 Feb 11  2013 icepredat665_pruebabf.cbl
-rw-r--r--   1 icbuild  icprodd  1293822 Mar  8  2013 ICGMDFBF_2.CBL
-rw-r--r--   1 icbuild  icprodd  1312738 Feb 19  2013 ICGMDFBF_3.CBL
-rw-r--r--   1 icbuild  icprodd  1293822 Mar  1  2013 ICGMDFBF.CBL

cobol-java:
total 804
-rw-r--r--   1 icbuild  icprodd     9929 Feb 11  2013 icepredat665_pruebabf.cbl
-rw-rw-r--   1 icgjcd   icdatacr  386595 Jul 28  2010 ICGDDEGJ.CBL

cobranzor:
total 7750
-rwxrwxr-x   1 1381     icdatacr   13050 Feb  6  2009 icecobrf1.cbl
-rw-rw-r--   1 1381     icdatacr   51456 Feb  6  2009 icecobrf1.idy
-rw-rw-r--   1 1381     icdatacr    5376 Feb  6  2009 icecobrf1.int
-rw-rw-r--   1 1381     icdatacr  333568 Feb  6  2009 icecobrf2-n.idy
-rw-rw-r--   1 1381     icdatacr   59392 Feb  6  2009 icecobrf2-n.int
-rwxrwxr-x   1 1381     icdatacr  130842 Feb  6  2009 icecobrf2.cbl
-rw-rw-r--   1 1381     icdatacr  324608 Feb  6  2009 icecobrf2.idy
-rw-rw-r--   1 1381     icdatacr   58880 Feb  6  2009 icecobrf2.int
-rwxrwxr-x   1 1381     icdatacr   13211 Feb  6  2009 icecobrf3-1.cbl
-rw-rw-r--   1 1381     icdatacr   51712 Feb  6  2009 icecobrf3-1.idy
-rw-rw-r--   1 1381     icdatacr    4352 Feb  6  2009 icecobrf3-1.int
-rwxrwxr-x   1 1381     icdatacr  139452 Feb  6  2009 icecobrf3.cbl
-rw-rw-r--   1 1381     icdatacr  344320 Feb  6  2009 icecobrf3.idy
-rw-rw-r--   1 1381     icdatacr   63232 Feb  6  2009 icecobrf3.int
-rwxrwxr-x   1 1381     icdatacr   12493 Feb  6  2009 icecobrf4-1.cbl
-rwxrwxr-x   1 1381     icdatacr   40220 Feb  6  2009 icecobrf4-3AC.cbl
-rwxrwxr-x   1 1381     icdatacr  138870 Feb  6  2009 icecobrf4-AC.cbl
-rw-rw-r--   1 1381     icdatacr  343040 Feb  6  2009 icecobrf4-AC.idy
-rw-rw-r--   1 1381     icdatacr   61440 Feb  6  2009 icecobrf4-AC.int
-rwxrwxr-x   1 1381     icdatacr  134770 Feb  6  2009 icecobrf4.cbl
-rwxrwxr-x   1 1381     icdatacr  147067 Feb  6  2009 icecobrf5-1.cbl
-rw-rw-r--   1 1381     icdatacr  145222 Feb  6  2009 icecobrf5-1.cbl-DAR
-rw-rw-r--   1 1381     icdatacr  349952 Feb  6  2009 icecobrf5-1.idy
-rw-rw-r--   1 1381     icdatacr   61952 Feb  6  2009 icecobrf5-1.int
-rwxrwxr-x   1 1381     icdatacr  142597 Feb  6  2009 icecobrf5-2.cbl
-rw-rw-r--   1 1381     icdatacr  140691 Feb  6  2009 icecobrf5-2.cbl-DAR
-rw-rw-r--   1 1381     icdatacr  344832 Feb  6  2009 icecobrf5-2.idy
-rw-rw-r--   1 1381     icdatacr   61184 Feb  6  2009 icecobrf5-2.int
-rwxrwxr-x   1 1381     icdatacr    2250 Feb  6  2009 sh-cobranza
-rwxrwxr-x   1 1381     icdatacr    9927 Feb  6  2009 sh-cobranza-monitor
-rwxrwxr-x   1 1381     icdatacr    5460 Feb  6  2009 sh-cobranza-param
-rwxrwxr-x   1 1381     icdatacr    6920 Feb  6  2009 sh-cobranza-param-lg
-rwxrwxr-x   1 1381     icdatacr    6091 Feb  6  2009 sh-cobranza-procseg-1
-rwxrwxr-x   1 1381     icdatacr    8492 Feb  6  2009 sh-cobranza-procseg-2
-rwxrwxr-x   1 1381     icdatacr    7082 Feb  6  2009 sh-cobranza-procseg-3
-rwxrwxr-x   1 1381     icdatacr    2679 Feb  6  2009 sh-cobranza-procseg-3AC
-rwxrwxr-x   1 1381     icdatacr    7925 Feb  6  2009 sh-cobranza-procseg-3fase2
-rwxrwxr-x   1 1381     icdatacr    7523 Feb  6  2009 sh-cobranza-procseg-4
-rwxrwxr-x   1 1381     icdatacr    2250 Feb  6  2009 sh-cobranza-prueba
-rwxrwxr-x   1 1381     icdatacr    5214 Feb  6  2009 sh-cobranza-segmentacion
/d/iccol/desarrollo/fuentes>l cobol
total 17732
-rw-r--r--   1 icbuild  icprodd   125686 May  6  2013 ACTAREVCR.CBL
-rw-r--r--   1 icbuild  icprodd   348954 May  6  2013 ACTEUNI.CBL
-rw-r--r--   1 icbuild  icprodd    42084 May  6  2013 ACTMEDRP.CBL
-rw-r--r--   1 icbuild  icprodd   205013 May  6  2013 ACTMIGRAC.CBL
-rw-r--r--   1 icbuild  icprodd   835749 May  6  2013 ACTVLCR.CBL
-rw-r--r--   1 icbuild  icprodd    15842 May  6  2013 BDAPLSUS.CBL
-rw-r--r--   1 icbuild  icprodd   137354 May 30  2013 BDLDIREC.CBL
-rw-r--r--   1 icbuild  icprodd    85552 Apr  4  2013 CARACTUSA.CBL
-rw-r--r--   1 icbuild  icprodd    61005 Nov  1  2012 CTLN97_PRUEBABF_as.CBL
-rw-r--r--   1 icbuild  icprodd    59831 Nov  1  2012 CTLN97_PRUEBABF_bi.CBL
-rw-r--r--   1 icbuild  icprodd    86598 Apr 18  2013 CVCIFDCRE-HSBC.CBL
-rw-r--r--   1 icbuild  icprodd    95319 May 22  2013 CVCIFDCRE.CBL
-rw-r--r--   1 icbuild  icprodd    10136 Mar  1  2013 icepredat665_pruebabf.cbl
-rw-r--r--   1 icbuild  icprodd   143047 May 10  2013 icestd81.cbl
-rw-rw-r--   1 icdgd    icdatacr  178581 May 21 10:39 icestd81.gnt
-rw-rw-r--   1 icdgd    icdatacr  439040 May 21 10:39 icestd81.idy
-rw-rw-r--   1 icdgd    icdatacr   93696 May 21 10:39 icestd81.int
-rw-rw-r--   1 icdgd    icdatacr  526319 May 21 10:39 icestd81.lst
-rw-rw-r--   1 icdgd    icdatacr 1369753 May 21 10:39 icestd81.s
-rw-r--r--   1 icbuild  icprodd   144639 May 10  2013 icestd81CyG01.cbl
-rw-r--r--   1 icbuild  icprodd    80537 May 22  2013 icestdmnt95.cbl
-rw-r--r--   1 icbuild  icprodd    97831 Apr 22  2013 icestVECSCOBL01.cbl
-rw-r--r--   1 icbuild  icprodd   184499 Mar  1  2013 ICGD38.CBL
-rw-r--r--   1 icbuild  icprodd   326955 Feb  1  2013 ICGD57.CBL
-rw-r--r--   1 icbuild  icprodd   231395 Nov 14  2012 ICGD75D.CBL
-rw-r--r--   1 icbuild  icprodd   279708 Apr 25  2013 ICGD82_BF_2.CBL
-rw-r--r--   1 icbuild  icprodd   274991 Mar 27  2013 ICGD82_BF.CBL
-rw-r--r--   1 icbuild  icprodd   279708 Mar 19  2013 ICGD82ABCBF.CBL
-rw-r--r--   1 icbuild  icprodd  1293822 Feb 11  2013 ICGMDFBF_2.CBL
-rw-r--r--   1 icbuild  icprodd   255633 May  6  2013 ICJSUS.CBL
-rw-r--r--   1 icbuild  icprodd    83367 May  6  2013 ICSAC1.CBL
-rw-r--r--   1 icbuild  icprodd     2240 May  6  2013 UTLUINISUS4.CBL
-rw-r--r--   1 icbuild  icprodd     7610 Jun 11  2013 UTLULONGITUDESBF.CBL
-rw-r--r--   1 icbuild  icprodd     7789 Mar  1  2013 UTLULONGITUDESPRUEBA.CBL
-rw-r--r--   1 icbuild  icprodd     7777 Oct  8  2012 UTLULONGITUDESPRUEBA2.CBL
-rw-r--r--   1 icbuild  icprodd     7810 Nov  1  2012 UTLULONGITUDESPRUEBA3.CBL
-rw-r--r--   1 icbuild  icprodd   334332 May  6  2013 VALCALCR.CBL
-rw-r--r--   1 icbuild  icprodd    57193 May  6  2013 VALVORDCR.CBL
/d/iccol/desarrollo/fuentes>cd cobol
/d/iccol/desarrollo/fuentes/cobol>l ices*
-rw-r--r--   1 icbuild  icprodd   143047 May 10  2013 icestd81.cbl
-rw-rw-r--   1 icdgd    icdatacr  178581 May 21 10:39 icestd81.gnt
-rw-rw-r--   1 icdgd    icdatacr  439040 May 21 10:39 icestd81.idy
-rw-rw-r--   1 icdgd    icdatacr   93696 May 21 10:39 icestd81.int
-rw-rw-r--   1 icdgd    icdatacr  526319 May 21 10:39 icestd81.lst
-rw-rw-r--   1 icdgd    icdatacr 1369753 May 21 10:39 icestd81.s
-rw-r--r--   1 icbuild  icprodd   144639 May 10  2013 icestd81CyG01.cbl
-rw-r--r--   1 icbuild  icprodd    80537 May 22  2013 icestdmnt95.cbl
-rw-r--r--   1 icbuild  icprodd    97831 Apr 22  2013 icestVECSCOBL01.cbl
/d/iccol/desarrollo/fuentes/cobol>view icestd81.lst
"icestd81.lst" [Read only] 8905 lines, 526319 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*list("icestd81.lst")1*icestd81.cbl.v.01.00022 IDENTIFICATION DIVISION.3 PROGRAM-ID.    icestd81-DATACREDITO.4 AUTHOR.DATACREDITO-JAGR.5 DATE-WRITTEN.  OCT/2006.6 DATE-COMPILED. 21-May-14 10:39.7******************************************************************8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.*
    10* GER.DESARR.|*
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.*
    15* GER.DESARR.|*
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
29*   sh-datainforme
    30*
31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43ASSIGN TO DISK MAES-DIRECC-TITLE
    44ORGANIZATION IS INDEXED
    45ACCESS MODE IS DYNAMIC
    46RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51XFILE STATUS IS EST-ICBDIR^"icestd81.lst" [Read only] 8905 lines, 526319 characters^:q/d/iccol/desarrollo/fuentes/cobol>^[  /d/iccol/desarrollo/fuentes/cobol>view icestd81.lstl ices*          
-rw-r--r--   1 icbuild  icprodd   143047 May 10  2013 icestd81.cbl
-rw-rw-r--   1 icdgd    icdatacr  178581 May 21 10:39 icestd81.gnt
-rw-rw-r--   1 icdgd    icdatacr  439040 May 21 10:39 icestd81.idy
-rw-rw-r--   1 icdgd    icdatacr   93696 May 21 10:39 icestd81.int
-rw-rw-r--   1 icdgd    icdatacr  526319 May 21 10:39 icestd81.lst
-rw-rw-r--   1 icdgd    icdatacr 1369753 May 21 10:39 icestd81.s
-rw-r--r--   1 icbuild  icprodd   144639 May 10  2013 icestd81CyG01.cbl
-rw-r--r--   1 icbuild  icprodd    80537 May 22  2013 icestdmnt95.cbl
-rw-r--r--   1 icbuild  icprodd    97831 Apr 22  2013 icestVECSCOBL01.cbl
/d/iccol/desarrollo/fuentes/cobol>clear
/d/iccol/desarrollo/fuentes/cobol>
/d/iccol/desarrollo/fuentes/cobol>
/d/iccol/desarrollo/fuentes/cobol>
/d/iccol/desarrollo/fuentes/cobol>clear
/d/iccol/desarrollo/fuentes/cobol>cat icestd81.lst
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*          list("icestd81.lst")
     1*icestd81.cbl.v.01.0002
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.    icestd81-DATACREDITO.
     4 AUTHOR.        DATACREDITO-JAGR.
     5 DATE-WRITTEN.  OCT/2006.
     6 DATE-COMPILED. 21-May-14 10:39.
     7******************************************************************
     8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *
     9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.        *
    10* GER.DESARR.|                                                   *
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.                                *
    15* GER.DESARR.|                                                   *
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
    23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
    25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
    27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
    29*   sh-datainforme
    30*
    31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.                                              GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
    41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43            ASSIGN TO DISK MAES-DIRECC-TITLE
    44            ORGANIZATION IS INDEXED
    45            ACCESS MODE IS DYNAMIC
    46            RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51X           FILE STATUS IS EST-ICBDIR
    52$END
    53            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    54 $SET IDXFORMAT"0"
*   55     COPY BDACSV.FS.                                              GDT0001
    56* BDACSV-FS.V.0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   2
* )d/iccol/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
    57* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
    58* DATOS OFICIALES DE REGIS, DIAN Y DAS
    59     SELECT BDACSV
    60            ASSIGN TO DISK "$DATABASE/BDACSV"
    61            ORGANIZATION IS INDEXED
    62            ACCESS MODE IS DYNAMIC
    63            RECORD KEY IS LLAVE-BDACSV
    64            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*   65     COPY NOAMNISTIA21.FS.                                        GDT0001
    66* NOAMNISTIA21-FS.V.0001
    67* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
    68* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
    69     SELECT NOAMNISTIA21
    70            ASSIGN TO DISK "$DATABASE/NOAMNISTIA21"
    71            ORGANIZATION IS INDEXED
    72            ACCESS MODE IS DYNAMIC
    73            RECORD KEY IS LLAVE-NOAMNISTIA21
    74            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    75*                                                                 GDT0001
*   76     COPY ICBSUS.FS.
    78$SET CONSTANT SW-STATUS-ICBSUS"NO"
    79     SELECT SUSCRIPTOR
    80            ASSIGN TO DISK SUSCRIPTOR-TITLE
    81            ORGANIZATION IS INDEXED
    82            ACCESS MODE IS DYNAMIC
    83            RECORD KEY IS LLAVE-SUSCRIP
    84$IF SW-STATUS-ICBSUS = "NO"
    85$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."
    86$ELSE
    87$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."
    88X           FILE STATUS IS COD-RETORNO-ICBSUS
    89$END
    90            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    91
*   92     COPY ICBCON.FS.
    93* EST005.v.02.002
    94* ARCHIVO QIE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
    95* TIPO 5
    96     SELECT INDEXADO
    97            ASSIGN TO DISK INDEXADO-TITLE
    98            ORGANIZATION IS INDEXED
    99            ACCESS MODE IS DYNAMIC
   100            RECORD KEY IS LLAVE-INDEX
   101            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   102*    COPY  ICBCHK.FS.                                             GDT0002
*  103     COPY  ICBCHK0001.FS.                                         GDT0002
   104*ICBCHK0001.FS.v.01.0001
   105******************************************************************
   106* EST027.v.02.002                                                *
   107* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO*
   108* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                     *
   109******************************************************************
   110 $SET IDXFORMAT"8"
   111
   112     SELECT  MAESTRO-CHECK  ASSIGN TO  MAES-CHECK-TITLE
   113             ORGANIZATION          IS  INDEXED
   114             ACCESS         MODE   IS  DYNAMIC
   115             RECORD         KEY    IS  LLAVE-MAES-CHECK
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   3
* )21.FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   116             LOCK           MODE   IS  MANUAL WITH LOCK ON RECORD.
   117
   118 $SET IDXFORMAT"0"
*  119     COPY ICBCRE.FS.
   120* EST029.v.02.003
   121* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS
   122* POR LOS DIFERENTES SUSCRIPTORES
   123 $SET IDXFORMAT"8"
   124
   125     SELECT MAESTRO-CREDIT
   126            ASSIGN TO DISK MAES-CREDIT-TITLE
   127            ORGANIZATION IS INDEXED
   128            ACCESS MODE IS DYNAMIC
   129            RECORD KEY IS LLAVE-MAES-CREDIT
   130*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT
   131            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   132
   133 $SET IDXFORMAT"0"
*  134     COPY BDIEMSUP0001.FS.
   135* BDIEMSUP-FS.v.0001
   136**********************************************************
   137*MAESTRO DE INFORMACION SUPERINTENDENCIA FORMATO TIPO 8  *
   138**********************************************************
   139 $SET IDXFORMAT"8"
   140     SELECT BDIEMSUP ASSIGN TO DISK TITLE-BDIEMSUP
   141            ORGANIZATION IS INDEXED
   142            ACCESS MODE IS DYNAMIC
   143            RECORD KEY IS BDIEMSUP-LLAVE
   144            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   145 $SET IDXFORMAT"0"
   146
*  147     COPY BDIEENTI.FS.
   148* BDIEENTI-FS.v.0002
   149*******************************************
   150*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
   151*******************************************
   152
   153     SELECT BDIEENTI ASSIGN TO DISK SI-BDIEENTI
   154            ORGANIZATION IS INDEXED
   155            ACCESS IS DYNAMIC
   156            RECORD KEY IS BDIEENTI-LLAVE
   157            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   158
*  159     COPY BDACUE.FS.
   161*****************************************************************
   162* ARCHIVO DE TIPOS DE CUENTA DE DATACREDITO
   163*****************************************************************
   164$SET CONSTANT SW-STATUS-BDACUE"NO"
   165     SELECT BDACUE    ASSIGN TO DISK "$DATABASE/BDACUE"
   166           ORGANIZATION IS LINE SEQUENTIAL
   167           ACCESS MODE IS SEQUENTIAL
   168$IF SW-STATUS-BDACUE = "NO"
   169$DISPLAY ".............COMPILANDO BDACUE SIN STATUS.........."
   170$ELSE
   171$DISPLAY ".............COMPILANDO BDACUE CON STATUS.........."
   172X           FILE STATUS IS COD-RETORNO-BDACUE
   173$END
   174            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   4
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   175     SELECT ENTRADA  ASSIGN TO DISK ARCHIVO-ENTRADA
   176            ORGANIZATION   IS LINE SEQUENTIAL
   177            ACCESS MODE    IS SEQUENTIAL
   178            FILE STATUS    IS W-STATUS-ENT.
   179
   180     SELECT INCONSIS ASSIGN TO DISK ARCHIVO-INCONC
   181            ORGANIZATION   IS LINE SEQUENTIAL
   182            ACCESS MODE    IS SEQUENTIAL
   183            FILE STATUS    IS W-STATUS-INC.
   184
   185     SELECT SALIDA   ASSIGN  TO DISK ARCHIVO-SALIDA
   186            ORGANIZATION   IS LINE SEQUENTIAL
   187            ACCESS MODE    IS SEQUENTIAL.
   188
   189     SELECT ESTADIS  ASSIGN  TO DISK ARCHIVO-ESTADIS
   190            ORGANIZATION   IS LINE SEQUENTIAL
   191            ACCESS MODE    IS SEQUENTIAL.
   192
   193
   194 DATA DIVISION.
   195 FILE SECTION.
*  196 COPY ICBDIR0001.FD.                                              GDT0001
   197* ICBDIR0001-FD.V01.007.
   198* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS
   199* POR LOS DIFERENTES SUSCRIPTORES
   200******************************************************************
   201* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL
   202* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE
   203* FEB.15/2006  * DATACLIENTES.
   204******************************************************************
   205* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *
   206* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *
   207* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *
   208* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *
   209*              *          DIRECCION FUE GEOREFERENCIADA.         *
   210******************************************************************
   211* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *
   212* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *
   213* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *
   214******************************************************************
   215* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *
   216* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*
   217* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *
   218* JUL.25/2008  *                                                 *
   219******************************************************************
   220* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*
   221* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*
   222* SEP/07/2011  *          CIA.                                   *
   223******************************************************************
   224* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *
   225* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *
   226* OCT/25/2012  *          ACTUALIZO.                             *
   227******************************************************************
   228 FD  MAESTRO-DIRECC.
   229 01  REG-DIRECC.
   230     03  LLAVE-DIRECC.
   231         05  LLAVE-PRI-DIRECC.
   232             07  TIPO-ID-DIRECC    PIC 9(01).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   5
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   233             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002
   234         05  LLAVE-ALT-DIRECC.
   235             07  COD-SUS-DIRECC    PIC 9(06).
   236             07  COD-CTA-DIRECC    PIC 9(02).
   237             07  NUM-CTA-DIRECC    PIC X(18).
   238     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   239     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   240     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   241     03  CIURES-DIRECC             PIC X(20).                     FAC0002
   242     03  DPTRES-DIRECC             PIC X(20).                     FAC0002
   243     03  DIRRES-DIRECC             PIC X(60).                     FAC0002
   244     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002
   245     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002
   246     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005
   247     03  CIULAB-DIRECC             PIC X(20).                     FAC0002
   248     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002
   249     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002
   250     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002
   251     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002
   252     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005
   253     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002
   254     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002
   255     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002
   256     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   257     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005
   258     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002
   259     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002
   260     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   261     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005
   262     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   263***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003
   264***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003
   265***  COR-CORRESPONDENCIA)                                         VHF0003
   266***     CER???-DIRECC:                                            VHF0003
   267***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003
   268***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003
   269***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003
   270***     ADI???-DIRECC:                                            VHF0003
   271***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003
   272***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003
   273***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003
   274     03  CERRES-DIRECC             PIC 9(01).                     VHF0003
   275     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003
   276     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003
   277     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003
   278     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003
   279     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003
   280     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004
   281     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005
   282     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005
   283     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005
   284*    03  FILLER-DIRECC             PIC X(40).                     VHF0005
   285*    03  FILLER-DIRECC             PIC X(28).                     RMB0006
   286     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006
   287     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006
   288     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006
   289     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007
   290     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   6
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   291     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007
   292     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007
   293     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007
   294     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007
   295     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007
   296*    03  FILLER-DIRECC             PIC X(13).                     CAV0007
   297     03  FILLER-DIRECC             PIC X(06).                     CAV0007
*  298 COPY BDACSV.FD.                                                  GDT0001
   299* BDACSV-FD.v.0003
   300* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   301* DATOS OFICIALES DE REGIS, DIAN Y DAS
   302******************************************************************
   303* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
   304* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
   305* R.MARTINEZ *          POR T7
   306******************************************************************
   307* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
   308* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE
   309* LUIS GOMEZ *          CONFIABLE
   310******************************************************************
   311 FD  BDACSV.
   312 01  REG-BDACSV.
   313     03 LLAVE-BDACSV.
   314        05  TIPO-ID-BDACSV    PIC 9(01).
   315        05  NUM-ID-BDACSV     PIC 9(15).
   316        05  COD-SUS-BDACSV    PIC 9(06).
   317        05  COD-CTA-BDACSV    PIC 9(02).
   318        05  NUM-CTA-BDACSV    PIC X(25).
   319     03  NOMBRE-BDACSV        PIC X(45).
   320     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003
   321        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003
   322        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003
   323        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003
   324     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
   325     03  FECHA-CREA-BDACSV       PIC 9(08).
   326     03  NUM-PORTAF-BDACSV    PIC 9(02).
   327     03  IND-NOMBRE-BDACSV    PIC 9(02).
   328     03  MEJOR-PORTAF-BDACSV  PIC 9(02).
   329     03  IND-ACTUALIZ-BDACSV  PIC 9(02).
   330     03  FUENTE-REG-BDACSV    PIC 9(02).
   331     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002
   332     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002
   333*    03  FILLER               PIC X(50).                          STT0003
   334     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003
   335         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003
   336         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003
   337         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003
   338         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003
   339         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003
   340         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003
   341         05  IND-SEXO-BDACSV       PIC X.                         STT0003
   342         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003
   343         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003
   344         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003
   345     03  FILLER                    PIC X(07).                     STT0003
   346*    03  FILLER               PIC X(48).
   347
   348
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   7
* ).FD)S)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   349
*  350 COPY NOAMNISTIA21.FD.                                            GDT0001
   351* NOAMNISTIA21-FD.v.0001
   352* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
   353* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
   354******************************************************************
   355******************************************************************
   356 FD  NOAMNISTIA21.
   357 01  REG-NOAMNISTIA21.
   358     03 LLAVE-NOAMNISTIA21.
   359        05  TIPO-ID-NOAMNISTIA21      PIC 9(01).
   360        05  NUM-ID-NOAMNISTIA21       PIC 9(11).
   361     03  FECHA-CREA-NOAMNISTIA21      PIC 9(08).
   362     03  FILLER                       PIC X(10).
   363*                                                                 GDT0001
   364 FD  ENTRADA.
   365 01  REG-ENTRADA.
   366     03 ENT-TIPO-ID               PIC 9(01).
   367     03 ENT-NUME-ID               PIC 9(11).
   368     03 ENT-NOMBRE                PIC X(45).
   369     03 ENT-FEC-EXPED             PIC 9(08).
   370     03 ENT-CIUDAD-EXP            PIC X(15).
   371     03 ENT-DEP-EXP-VAL           PIC X(15).
   372     03 ENT-VIG-VAL               PIC X(02).
   373     03 ENT-GENERO-VAL            PIC X(01).
   374     03 ENT-EDAD                  PIC X(03).
   375     03 ENT-EDAD-RANGO            PIC X(05).
   376     03 FILLER                    PIC X(51).
   377
   378 FD  INCONSIS.
   379 01  REG-INCONSIS.
   380     03 TIP-INC                   PIC 9.
   381     03 CED-INC                   PIC 9(11).
   382     03 NOM1-INC                  PIC X(45).
   383     03 NOM2-INC                  PIC X(45).
   384     03 FEC-EXP-INC               PIC 9(08).
   385     03 MUN-EXP-INC               PIC X(15).
   386     03 DEP-EXP-INC               PIC X(15).
   387     03 VIG-INC                   PIC X(02).
   388     03 CODERR-INC                PIC 9(02).
   389     03 FILLER-2-INC              PIC X(60).
   390
   391
   392 FD  SALIDA.
   393 01  REG-SALIDA.
   394     03 SLD-TIPO-ID                    PIC 9(01).
   395     03 FILLER01                       PIC X(01) VALUE ";".
   396     03 SLD-NUME-ID                    PIC 9(11).
   397     03 FILLER02                       PIC X(01) VALUE ";".
   398     03 SLD-NOMBRE                     PIC X(45).
   399     03 FILLER03                       PIC X(01) VALUE ";".
   400     03 SLD-RANGO-EDAD                 PIC X(05).
   401     03 FILLER04                       PIC X(01) VALUE ";".
   402     03 SLD-GENERO                     PIC X(01).
   403     03 FILLER05                       PIC X(01) VALUE ";".
   404     03 SLD-CIUDAD-EXPED               PIC X(15).
   405     03 FILLER06                       PIC X(01) VALUE ";".
   406     03 SLD-CREDITOS-ACTV              PIC 9(04).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   8
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   407     03 FILLER07                       PIC X(01) VALUE ";".
   408     03 SLD-NUM-OBLIG-CAB              PIC 9(04).
   409     03 FILLER08                       PIC X(01) VALUE ";".
   410     03 SLD-TOT-INICIAL-CAB            PIC 9(15).
   411     03 FILLER09                       PIC X(01) VALUE ";".
   412     03 SLD-TOT-SALDOS-CAB             PIC 9(15).
   413     03 FILLER10                       PIC X(01) VALUE ";".
   414     03 SLD-TOT-CUOTAS-CAB             PIC 9(11).
   415     03 FILLER11                       PIC X(01) VALUE ";".
   416     03 SLD-TOT-MORA-CAB               PIC 9(11).
   417     03 FILLER12                       PIC X(01) VALUE ";".
   418     03 SLD-NUM-OBLIG-CAV              PIC 9(04).
   419     03 FILLER13                       PIC X(01) VALUE ";".
   420     03 SLD-TOT-INICIAL-CAV            PIC 9(15).
   421     03 FILLER14                       PIC X(01) VALUE ";".
   422     03 SLD-TOT-SALDOS-CAV             PIC 9(15).
   423     03 FILLER15                       PIC X(01) VALUE ";".
   424     03 SLD-TOT-CUOTAS-CAV             PIC 9(11).
   425     03 FILLER16                       PIC X(01) VALUE ";".
   426     03 SLD-TOT-MORA-CAV               PIC 9(11).
   427     03 FILLER17                       PIC X(01) VALUE ";".
   428     03 SLD-NUM-OBLIG-OTR              PIC 9(04).
   429     03 FILLER18                       PIC X(01) VALUE ";".
   430     03 SLD-TOT-INICIAL-OTR            PIC 9(15).
   431     03 FILLER19                       PIC X(01) VALUE ";".
   432     03 SLD-TOT-SALDOS-OTR             PIC 9(15).
   433     03 FILLER20                       PIC X(01) VALUE ";".
   434     03 SLD-TOT-CUOTAS-OTR             PIC 9(11).
   435     03 FILLER21                       PIC X(01) VALUE ";".
   436     03 SLD-TOT-MORA-OTR               PIC 9(11).
   437     03 FILLER22                       PIC X(01) VALUE ";".
   438     03 SLD-TOT-NUM-TDC                PIC 9(04).
   439     03 FILLER23                       PIC X(01) VALUE ";".
   440     03 SLD-TOT-CUPOS-TDC              PIC 9(15).
   441     03 FILLER24                       PIC X(01) VALUE ";".
   442     03 SLD-TOT-SALDO-TDC              PIC 9(15).
   443     03 FILLER25                       PIC X(01) VALUE ";".
   444     03 SLD-POR-UTILIZ-TDC             PIC Z.ZZZZZ.
   445     03 FILLER26                       PIC X(01) VALUE ";".
   446     03 SLD-TOT-CUOTAS-TDC             PIC 9(11).
   447     03 FILLER27                       PIC X(01) VALUE ";".
   448     03 SLD-TOT-MORA-TDC               PIC 9(11).
   449     03 FILLER28                       PIC X(01) VALUE ";".
   450     03 SLD-NRO-RANGO-0                PIC 9(03).
   451     03 FILLER29                       PIC X(01) VALUE ";".
   452     03 SLD-NRO-RANGO-1                PIC 9(03).
   453     03 FILLER30                       PIC X(01) VALUE ";".
   454     03 SLD-NRO-RANGO-2                PIC 9(03).
   455     03 FILLER31                       PIC X(01) VALUE ";".
   456     03 SLD-NRO-RANGO-3                PIC 9(03).
   457     03 FILLER32                       PIC X(01) VALUE ";".
   458     03 SLD-NRO-RANGO-4                PIC 9(03).
   459     03 FILLER33                       PIC X(01) VALUE ";".
   460     03 SLD-NRO-RANGO-5                PIC 9(03).
   461     03 FILLER34                       PIC X(01) VALUE ";".
   462     03 SLD-NRO-RANGO-6                PIC 9(03).
   463     03 FILLER35                       PIC X(01) VALUE ";".
   464     03 SLD-FECHA-TDC                  PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   9
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   465     03 FILLER36                       PIC X(01) VALUE ";".
   466     03 SLD-NUM-OBLIG-REAL             PIC 9(04).
   467     03 FILLER37                       PIC X(01) VALUE ";".
   468     03 SLD-TOT-INICIAL-REAL           PIC 9(15).
   469     03 FILLER38                       PIC X(01) VALUE ";".
   470     03 SLD-TOT-SALDOS-REAL            PIC 9(15).
   471     03 FILLER39                       PIC X(01) VALUE ";".
   472     03 SLD-TOT-CUOTAS-REAL            PIC 9(11).
   473     03 FILLER40                       PIC X(01) VALUE ";".
   474     03 SLD-TOT-MORA-REAL              PIC 9(11).
   475     03 FILLER41                       PIC X(01) VALUE ";".
   476     03 SLD-NUM-OBLIG-TELE             PIC 9(04).
   477     03 FILLER42                       PIC X(01) VALUE ";".
   478     03 SLD-TOT-CUOTAS-TELE            PIC 9(11).
   479     03 FILLER43                       PIC X(01) VALUE ";".
   480     03 SLD-TOT-MORA-TELE              PIC 9(11).
   481     03 FILLER44                       PIC X(01) VALUE ";".
   482     03 SLD-NUM-OBLIG-COOP             PIC 9(04).
   483     03 FILLER45                       PIC X(01) VALUE ";".
   484     03 SLD-TOT-INICIAL-COOP           PIC 9(15).
   485     03 FILLER46                       PIC X(01) VALUE ";".
   486     03 SLD-TOT-SALDOS-COOP            PIC 9(15).
   487     03 FILLER47                       PIC X(01) VALUE ";".
   488     03 SLD-TOT-CUOTAS-COOP            PIC 9(11).
   489     03 FILLER48                       PIC X(01) VALUE ";".
   490     03 SLD-TOT-MORA-COOP              PIC 9(11).
   491     03 FILLER49                       PIC X(01) VALUE ";".
   492     03 SLD-NUM-OBLIG-CODEU            PIC 9(04).
   493     03 FILLER50                       PIC X(01) VALUE ";".
   494     03 SLD-TOT-SALDOS-CODEU           PIC 9(15).
   495     03 FILLER51                       PIC X(01) VALUE ";".
   496     03 SLD-TOT-CUOTAS-CODEU           PIC 9(11).
   497     03 FILLER52                       PIC X(01) VALUE ";".
   498     03 SLD-TOT-MORA-CODEU             PIC 9(11).
   499     03 FILLER53                       PIC X(01) VALUE ";".
   500     03 SLD-CREDITOS-ALDIA             PIC 9(03).
   501     03 FILLER54                       PIC X(01) VALUE ";".
   502     03 SLD-MORA-30                    PIC 9(03).
   503     03 FILLER55                       PIC X(01) VALUE ";".
   504     03 SLD-MORA-60                    PIC 9(03).
   505     03 FILLER56                       PIC X(01) VALUE ";".
   506     03 SLD-MORA-90                    PIC 9(03).
   507     03 FILLER57                       PIC X(01) VALUE ";".
   508     03 SLD-MORA-120                   PIC 9(03).
   509     03 FILLER58                       PIC X(01) VALUE ";".
   510     03 SLD-CAR-CASTIGA                PIC 9(03).
   511     03 FILLER59                       PIC X(01) VALUE ";".
   512     03 SLD-DUD-RECAUDO                PIC 9(03).
   513     03 FILLER60                       PIC X(01) VALUE ";".
   514     03 SLD-CUENTAS-COBRADOR           PIC 9(03).
   515     03 FILLER61                       PIC X(01) VALUE ";".
   516     03 SLD-MORA-30-HIS                PIC 9(03).
   517     03 FILLER62                       PIC X(01) VALUE ";".
   518     03 SLD-MORA-60-HIS                PIC 9(03).
   519     03 FILLER63                       PIC X(01) VALUE ";".
   520     03 SLD-MORA-90-HIS                PIC 9(03).
   521     03 FILLER64                       PIC X(01) VALUE ";".
   522     03 SLD-MORA-120-HIS               PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  10
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   523     03 FILLER65                       PIC X(01) VALUE ";".
   524     03 SLD-CANC-MMANEJO               PIC 9(03).
   525     03 FILLER66                       PIC X(01) VALUE ";".
   526     03 SLD-CAR-RECUPERADA             PIC 9(03).
   527     03 FILLER67                       PIC X(01) VALUE ";".
   528     03 SLD-MORA-MAX-TDC               PIC 9(03).
   529     03 FILLER68                       PIC X(01) VALUE ";".
   530     03 SLD-MORA-MAX-CAB               PIC 9(03).
   531     03 FILLER69                       PIC X(01) VALUE ";".
   532     03 SLD-MORA-MAX-COOP              PIC 9(03).
   533     03 FILLER70                       PIC X(01) VALUE ";".
   534     03 SLD-MORA-MAX-CAV               PIC 9(03).
   535     03 FILLER71                       PIC X(01) VALUE ";".
   536     03 SLD-END-CALIF-1-TRIM           PIC X(01).
   537     03 FILLER72                       PIC X(01) VALUE ";".
   538     03 SLD-END-CALIF-2-TRIM           PIC X(01).
   539     03 FILLER73                       PIC X(01) VALUE ";".
   540     03 SLD-CTAS-AHORRO                PIC 9(03).
   541     03 FILLER74                       PIC X(01) VALUE ";".
   542     03 SLD-CTES-CORRIENTES            PIC 9(03).
   543     03 FILLER75                       PIC X(01) VALUE ";".
   544     03 SLD-CTES-EMBARGADAS            PIC 9(03).
   545     03 FILLER76                       PIC X(01) VALUE ";".
   546     03 SLD-CTES-MAL-MANEJO            PIC 9(03).
   547     03 FILLER77                       PIC X(01) VALUE ";".
   548     03 SLD-CTES-SALDADAS              PIC 9(03).
   549     03 FILLER78                       PIC X(01) VALUE ";".
   550     03 SLD-TOTAL-CONSULTAS            PIC 9(03).
   551     03 FILLER79                       PIC X(01) VALUE ";".
   552     03 SLD-CALIFICACION               PIC X(01).
   553*-----------------------------------------------------------*
   554 FD  ESTADIS.
   555 01  REG-ESTADIS.
   556     03 SLD-DETALLE                    PIC X(30).
   557     03 FILLER                         PIC X(01) VALUE ";".
   558     03 SLD-ESTADIS-VALOR-1            PIC Z(11).
   559     03 FILLER                         PIC X(01) VALUE ";".
   560     03 SLD-ESTADIS-VALOR-2            PIC Z(11).
   561     03 FILLER                         PIC X(01) VALUE ";".
   562     03 SLD-ESTADIS-VALOR-3            PIC Z(11).
   563     03 FILLER                         PIC X(01) VALUE ";".
   564     03 SLD-ESTADIS-VALOR-4            PIC Z(11).
   565     03 FILLER                         PIC X(01) VALUE ";".
   566     03 SLD-ESTADIS-VALOR-5            PIC Z(07).
   567
*  568 COPY ICBSUS.FD.
   571*******************************************************************
   572* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR
   573* F.CUADROS *         DATAHOST
   574* FEB.2003  *
   575*******************************************************************
   576* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES
   577* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.
   578* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES
   579******************************************************************
   580* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL
   581* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR
   582* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  11
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   583******************************************************************
   584* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE
   585* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL
   586* ENE. 07/2004 * HABITO DE PAGO.
   587******************************************************************
   588* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE
   589* F.CUADROS C. * FRAUDE
   590* JUN. 04/2004 *
   591******************************************************************
   592* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES
   593* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.
   594* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL
   595*              * A SUI, 2-PASO AUTOMATICO A SUI.
   596******************************************************************
   597* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE
   598* F.CUADROS C. * ENDEUDAMIENTO GLOBAL
   599* MAR. 14/2005 *
   600******************************************************************
   601* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO
   602* R.MARTINEZ   * A TRAVES DE DATA WEB
   603* ABR. 21/2005 *
   604******************************************************************
   605* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS
   606* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-
   607* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO
   608******************************************************************
   609* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *
   610* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *
   611* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *
   612******************************************************************
   613* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *
   614* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *
   615* NOV. 01/2005 *                                                 *
   616******************************************************************
   617* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *
   618* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *
   619* MAR.17/2006  *
   620******************************************************************
   621* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*
   622* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *
   623* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *
   624******************************************************************
   625* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIÓN DE *
   626* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *
   627* JUL.05/2006  *                                                 *
   628******************************************************************
   629* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*
   630* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *
   631* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *
   632******************************************************************
   633* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *
   634* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*
   635* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *
   636******************************************************************
   637* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*
   638* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*
   639* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *
   640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  12
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   641* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *
   642* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *
   643* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *
   644*              * S- SI -DEFAULT
   645******************************************************************
   646* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *
   647* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*
   648* JULIO /2009  *         LIZADOR O NO.                           *
   649******************************************************************
   650* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *
   651* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *
   652* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO ASÍ: 0-NO CERTI*
   653*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *
   654*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*
   655*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *
   656*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *
   657*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *
   658******************************************************************
   659* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS
   660* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *
   661* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*
   662*              *         PRODUCTO) = 0
   663*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO
   664*              *          = 1
   665*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*
   666*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *
   667*              *         CONSULTA DATAHOST O WEBSERVICE          *
   668******************************************************************
   669* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*
   670* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*
   671* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*
   672*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *
   673******************************************************************
   674* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *
   675* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *
   676* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *
   677******************************************************************
   678* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *
   679* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *
   680* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *
   681*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *
   682******************************************************************
   683* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *
   684* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *
   685* FEBRERO/2013 *         DE SUSCRIPTOR.                          *
   686*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *
   687*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*
   688*              *         NUMERO DE TARJETA.                      *
   689*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *
   690******************************************************************
   691 FD  SUSCRIPTOR.
   692 01  REG-SUSCRIPTOR.
   693     03  COD-SUSCRIP-ABD02       PIC 9(6).
   694     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02
   695                                 PIC X(6).
   696     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.
   697     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012
   698     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  13
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   699     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.
   700*        04 FILLER               PIC X(16).                       FAC0012
   701         04 NOM-COR1-ABD02       PIC X(14).
   702         04 NOM-COR2-ABD02       PIC X(14).
   703         04 IND-COR-ABD02        PIC 9.
   704     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009
   705     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.
   706     03  IND-REGIST-ABD02        PIC 99    COMP-3.
   707     03  ESTADO-ABD02            PIC 9     COMP-3.
   708     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.
   709     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.
   710     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.
   711     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.
   712     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5
   713     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1
   714     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1
   715     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017
   716     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015
   717     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008
   718     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008
   719     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008
   720     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009
   721     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009
   722     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009
   723     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009
   724     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009
   725     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010
   726     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011
   727     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013
   728     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014
   729     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016
   730     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018
   731     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019
   732     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020
   733     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021
   734     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022
   735     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023
   736     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024
   737     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025
   738     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026
   739     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027
   740     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028
   741     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029
   742     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029
   743     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030
   744     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030
   745     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031
   746     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031
   747     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032
   748     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033
   749     03  DIRRES-ABD02            PIC X(01).                       RMB0034
   750     03  TELRES-ABD02            PIC X(01).                       RMB0034
   751     03  DIRLAB-ABD02            PIC X(01).                       RMB0034
   752     03  TELLAB-ABD02            PIC X(01).                       RMB0034
   753     03  DIRCOR-ABD02            PIC X(01).                       RMB0034
   754     03  TELCEL-ABD02            PIC X(01).                       RMB0034
   755     03  E-MAIL-ABD02            PIC X(01).                       RMB0034
   756     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  14
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   757     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036
   758     03  FILLER-ABD02-2          PIC X(05).                       CAV0036
   759*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036
   760*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034
   761*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033
*  762 COPY ICBCON.001.FD.
   763* ICBCON-FD.0004
   764* ARCHIVO QUE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
   765* TIPO 5
   766*******************************************************************
   767* RMB003       * FENA001: PARA LAS CONSULTAS REPETIDAS (MISMO DIA *
   768* R.MARTINEZ.  * SUSCRIPTOR, CLAVE) SE DEJA UN SOLA CONSULTA Y LA *
   769* JULIO 30/2001* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   770*              * NUM-CONS-IND.                                    *
   771*----------------------------------------------------------------**
   772* RMB003       * SCR002: PARA MANEJO DE PREFILTRO SE REDEFINEN    *
   773* R.MARTINEZ.  * CAMPOS.                                          *
   774* AGOS. 30/2002* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   775*----------------------------------------------------------------**
   776* GJC0004      * AMPLI1: AMPLIACION DEL ARCHIVO DE CONSULTA DE    *
   777* G.JIMENEZ.   * 50 A 123 POSICIONES, SE AMPLIA CON FILLER DE 50  *
   778* ENE.03/2003  * CARACTERES.                                      *
   779* FAC0004      * INCLUSION DE NUEVOS CAMPOS                       *
   780* ENE.22/2003  *                                                  *
   781*----------------------------------------------------------------**
   782 FD  INDEXADO.
   783*    FILE OF SUCCESSFUL INQUIRIES, FOR BILLING AND SUSPICIOUS
   784*    NUMBER OF CREDIT INQUIRIES
   785 01  REG-INDEX.
   786     03  COD-SUSCRIP-IND         PIC 9(6).
   787     03  FEC-CONSUL-IND          PIC 9(6).
   788     03  LLAVE-INDEX.
   789         05  TIP-ID-IND          PIC 9.
   790         05  NUM-ID-IND          PIC 9(11).
   791         05  CONSECUTIVO-IND     PIC 9(2).
   792*    SCORES 0=score10,1-9= SCORE1-9
   793     03  SCO-PRE-INDEX           PIC 9.
   794     03  CIUDAD-CONS-IND         PIC 9(2).
   795     03  OFICINA-CONS-IND        PIC X(15).
   796     03  NUM-CONS-IND            PIC 99.                           RMB003
   797     03  FILLER-INDEX.
   798         05 PRE-SCORE-INDEX      PIC X VALUE SPACES.
   799         05 PUN-SCORE-INDEX      PIC S9(05) COMP-3.
   800     03  RAZCON-IND              PIC 99.                          GJC0004
   801     03  TIP-SCORE-IND           PIC 9(3).                        FAC0004
   802     03  CLASIFICA-IND           PIC X(2).                        FAC0004
   803     03  CALIFICA-IND            PIC S9(3)V99.                    FAC0004
   804     03  CLAVE-IND               PIC X(5).                        FAC0004
   805     03  CONTADOR-IND            PIC 9(3).                        FAC0004
   806     03  FILLER-1-INDEX          PIC X(50).                       GJC0004
*  807 COPY ICBCHK.FD.
   808* ICBCHK.-FD.v.0009
   809* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO
   810* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES
   811*----------------------------------------------------------------*
   812******************************************************************
   813* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   814* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  15
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   815* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   816* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   817* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   818*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   819*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   820*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   821*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   822******************************************************************
   823* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*
   824* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *
   825*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   826* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *
   827*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   828******************************************************************
   829* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   830* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   831* 04/MAY/2009 *          CREDITO.                                *
   832******************************************************************
   833* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *
   834* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *
   835* 04/ENE/2010 *                                                  *
   836******************************************************************
   837* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   838* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   839* OCTUBRE/2010*          SON MÁS DE 10                           *
   840******************************************************************
   841
   842 FD  MAESTRO-CHECK.
   843*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2
   844 01  COMPLETO-ABD06.
   845     03  LLAVE-MAES-CHECK.
   846         05  LLAVE-MAES-CHECK-PRI.
   847             07  TIPO-ID-ABD06     PIC 9.
   848             07  NUM-ID-ABD06      PIC 9(11).
   849         05  LLAVE-MAES-CHECK-ALT.
   850             07  COD-SUS-ABD06     PIC 9(6).
   851             07  COD-CTA-ABD06     PIC 99.
   852             07  NUM-CTA-ABD06     PIC X(18).
   853     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.
   854     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.
   855     03  CALIFIC-ABD06             PIC 9     COMP-3.
   856     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.
   857     03  NOV-REPORT-ABD06          PIC 99    COMP-3.
   858     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.
   859     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.
   860     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.
   861     03  ADJETIVO-ABD06            PIC 9     COMP-3.
   862     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.
   863     03  ART15-ABD06               PIC 9     COMP-3.
   864     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005
   865         REDEFINES                 ART15-ABD06.                   VHF0005
   866     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.
   867     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005
   868                                   PIC 9(3).                      FAC0005
   869     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005
   870         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005
   871         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006
   872         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  16
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   873
   874     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH
   875*    03  FILLER-ABD06              PIC X(8).                      AMPLIA
   876     03  OFICINA-ABD06             PIC X(15).                     AMPINF5
   877     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5
   879     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004
   880     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008
   881         REDEFINES FEC-NOVANT-ABD06.                              CAV0008
   882     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004
   883*    03  FILLER-ABD06              PIC X(4).                      CAV0007
   884     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007
   885     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007
   886     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007
   887     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009
*  888 COPY ICBCRE.FD.
   889* ICBCRE-FD.v.02.0013
   890* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS
   891* POR LOS DIFERENTES SUSCRIPTORES
   892*----------------------------------------------------------------*
   893******************************************************************
   894* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   895* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   896* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   897* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   898* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   899*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   900*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   901*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   902*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   903******************************************************************
   904* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*
   905* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *
   906*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   907* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *
   908*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   909******************************************************************
   910* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *
   911* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *
   912*             *          CUARTO AÑO DE HISTORIA CREDITICIA       *
   913* 09/AGO/2007 *                                                  *
   914******************************************************************
   915* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   916* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   917* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *
   918*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *
   919*             *          ENDEUDAMIENTO                           *
   920******************************************************************
   921* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   922* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   923* OCTUBRE/2010*          SON MÁS DE 10                           *
   924******************************************************************
   925* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *
   926* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *
   927* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *
   928******************************************************************
   929 FD  MAESTRO-CREDIT.
   930 01  COMPLETO-ABD07.
   931     03  LLAVE-MAES-CREDIT.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  17
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   932         05  LLAVE-MAES-CREDIT-PRI.
   933             07  TIPO-ID-ABD07     PIC 9.
   934             07  NUM-ID-ABD07      PIC 9(11).
   935         05  LLAVE-MAES-CREDIT-ALT.
   936             07  COD-SUS-ABD07     PIC 9(6).
   937             07  COD-CTA-ABD07     PIC 99.
   938             07  NUM-CTA-ABD07     PIC X(18).
   939             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA
   940                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA
   941                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA
   942     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.
   943     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.
   944     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.
   945     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.
   946     03  CALIFIC-ABD07             PIC 9     COMP-3.
   947     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.
   948     03  NOV-REPORT-ABD07          PIC 99    COMP-3.
   949     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.
   950     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.
   951     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.
   952     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AÑO 1   JGR0010
   953         REDEFINES                 ESTADO-MES-ABD07.               JGR0010
   954     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.
   955     03  ADJETIVO1-ABD07           PIC 9     COMP-3.
   956     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.
   957     03  ADJETIVO2-ABD07           PIC 9     COMP-3.
   958     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.
   959     03  ADJETIVO3-ABD07           PIC 9     COMP-3.
   960     03  ART15-ABD07               PIC 9     COMP-3.
   961     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008
   962         REDEFINES                 ART15-ABD07.                   VHF0008
   963     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.
   964     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008
   965                                   PIC 9(3).                      FAC0008
   966     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008
   967         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008
   968         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009
   969         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009
   970         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011
   971            FILLER-RECLAMO-ABD07.                                 GJC0011
   972         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011
   973            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011
   974         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011
   975            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011
   976*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013
   977     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013
   978     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013
   979         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013
   980     03  CALIFIC-R-ABD07           PIC 9     COMP-3.
   981     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.
   982     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007
   983                                   PIC 9     COMP-3.
   984     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.
   985     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.
   986     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.
   987     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007
   988                                   PIC X(02).                     FAC0007
   989     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  18
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   990     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AÑO 3   JGR0010
   991         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010
   992     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.
   993     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA
   994*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011
   995*                              *> CAMPOS                          GJC0011
   996*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011
   997*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011
   998*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011
   999*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011
  1000*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011
  1001*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011
  1002*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011
  1003*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011
  1004     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011
  1005* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011
  1006        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011
  1007        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011
  1008        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1009        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011
  1010        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1011* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011
  1012         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011
  1013         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011
  1014         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011
  1015         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011
  1016         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011
  1017         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011
  1018             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1019         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011
  1020             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1021         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011
  1022         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011
  1023         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011
  1024*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012
  1025         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012
  1026* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011
  1027     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA
  1028     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1029     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1030     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA
  1031     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA
  1032     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA
  1033     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA
  1034     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA
  1035     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA
  1036     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA
  1037     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA
  1038     03  SITUACION-ABD07            PIC X.                         AMPLIA
  1039     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA
  1040     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011
  1041         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011
  1042         05  CAMPOS-TARJETA-ABD07.                                GJC0011
  1043             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011
  1044             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011
  1045                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011
  1046         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012
  1047     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  19
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
  1048     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA
  1049     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1050*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1051     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7
  1052     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA
  1053     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010
  1054         REDEFINES                  VECTOR-2-ABD07.     *> AÑO 2   JGR0010
  1055     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5
  1056     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5
  1057     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5
  1058     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5
  1059     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7
  1060     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002
  1061     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AÑO 4   JGR0010
  1062         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010
  1063
* 1064 COPY BDIEMSUP.FD.
  1065* BDIEMSUP-FD.v.0005
  1066*-------------------------------------------
  1067*  MAESTRO CON INFORMACION SUPERINTENDENCIA
  1068*-------------------------------------------
  1069******************************************************************
  1070* GJC0002   * MICROC: SE ADICIONA VARIABLE DE SUBTIPO DE DEUDA QUE
  1071* G.JIMENEZ * PERMITE IDENTIFICAR LOS MICROCREDITOS Y LAS
  1072* JUN./2003 * FIDUCIAS.
  1073******************************************************************
  1074* RMB0003   * DRP001: SE ADICIONA CAMPO PARA CALCULAR CAMBIO EN
  1075* R.MARTINEZ* EL REGISTRO Y ACTUALIZAR EL DRP
  1076* DIC./2007 *
  1077******************************************************************
  1078* VHF0004     * GARANT - SE MODIFICA FILLER PARA GUARDAR         *
  1079* VICTOR HUGO *          INFORMACION DE GARANTIAS                *
  1080* FORERO      *                                                  *
  1081* SEP.24/2009 *                                                  *
  1082******************************************************************
  1083* LAG0005     * TIPGAR - BDIEMSUP-TIPGAR SE DEJA ALFANUMERICO    *
  1084* VICTOR HUGO *          PARA DEJAR "A" CUANDO VEGA 10, "B"      *
  1085* FORERO      *          CUANDA VENGA 11 Y "C" CUANDO VENGA 12   *
  1086* SEP.24/2009 *                                                  *
  1087******************************************************************
  1088 FD BDIEMSUP.
  1089 01 BDIEMSUP-REGISTRO.
  1090    03 BDIEMSUP-LLAVE.
  1091       05 BDIEMSUP-TIP-ID           PIC 9(1).
  1092       05 BDIEMSUP-NUM-ID           PIC 9(11).
  1093       05 BDIEMSUP-FECHA            PIC 9(8).
  1094       05 BDIEMSUP-TIP-ENTID        PIC 9(2).
  1095       05 BDIEMSUP-COD-ENTID        PIC 9(6).
  1096       05 BDIEMSUP-MONEDA           PIC X(1).
  1097       05 BDIEMSUP-TIP-DEUDA        PIC X(1).
  1098       05 BDIEMSUP-CALIFICA         PIC X(1).
  1099       05 BDIEMSUP-GARANTIA         PIC X(1).
  1100    03 BDIEMSUP-ENCABEZADO.
  1101       05 BDIEMSUP-DESCRIP          PIC X(45).
  1102       05 BDIEMSUP-CIIU             PIC 9(4).
  1103       05 BDIEMSUP-FEC-APERT        PIC 9(8).
  1104       05 BDIEMSUP-SUBTIPO-DEUDA    PIC X.                        GJC0002
  1105       05 FILLER                    PIC X(6).                     GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  20
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDIE
  1106    03 BDIEMSUP-ITEMS REDEFINES BDIEMSUP-ENCABEZADO.
  1107       05 BDIEMSUP-VALOR            PIC S9(14)  COMP-3.
  1108       05 BDIEMSUP-INTERES          PIC S9(14)  COMP-3.
  1109       05 BDIEMSUP-CONTING          PIC S9(14)  COMP-3.
  1110       05 BDIEMSUP-CANTIDAD         PIC 9(3)    COMP-3.
  1111       05 BDIEMSUP-IND-BLOQ         PIC 9(1)    COMP-3.
  1112       05 BDIEMSUP-ART-15           PIC 9(2)    COMP-3.
  1113       05 BDIEMSUP-FEC-ART-15       PIC 9(8)    COMP-3.
  1114       05 BDIEMSUP-FEC-ACTUALIZ     PIC 9(8)    COMP-3.
  1115       05 BDIEMSUP-ART-15-CTI       PIC 9(2)    COMP-3.
  1116       05 BDIEMSUP-FEC-ART-15-CTI   PIC 9(8)    COMP-3.
  1117       05 BDIEMSUP-NUM-RECLAMO      PIC 9(5)    COMP-3.
  1118       05 FILLER-X                  PIC X(14).                    VHF0004
  1119       05 BDIEMSUP-GAR              REDEFINES FILLER-X.           VHF0004
  1120          07 BDIEMSUP-VLRGAR        PIC S9(14)  COMP-3.           VHF0004
  1121          07 BDIEMSUP-TIPGAR        PIC X(1).                     LAG0005
  1122          07 BDIEMSUP-FECGAR        PIC S9(8)   COMP-3.           VHF0004
  1123       05 BDIEMSUP-DRP              PIC X(01).                    VHF0004
* 1124 COPY BDIEENTI.FD.
  1125* BDIEENTI-FD.v.0002
  1126******************************************************************
  1127* JGR0002     * NITENT - SE COMPARTE EL CAMPO NOMBRE DE LA       *
  1128* JAIRO GOMEZ.*          ENTIDAD, PARA PORDER GRABAR EL NUMERO   *
  1129*             *          DE NIT DE LA ENTIDAD REPORTANTE         *
  1130* 09/ENE/2008 *                                                  *
  1131******************************************************************
  1132********************************************
  1133*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
  1134********************************************
  1135
  1136 FD BDIEENTI.
  1137 01 BDIEENTI-REGISTRO.
  1138    03 BDIEENTI-LLAVE.
  1139       05 BDIEENTI-TIP-ENTID        PIC 9(2).
  1140       05 BDIEENTI-COD-ENTID        PIC 9(6).
  1141    03 BDIEENTI-NOM-ENTID.
  1142       05 BDIEENTI-NOMBRE           PIC X(29).                     JGR0002
  1143       05 BDIEENTI-NIT-ENTID        PIC 9(11).                     JGR0002
* 1144 COPY BDACUE.FD.
  1146* BDACUE.v.01.001
  1147*ARCHIVO TIPOS DE CUENTA VS. NOVEDADES Y ADJETIVOS VALIDOS
  1148*----------------------------------------------------------------*
  1149*-TABLA CON 10 OCURRENCIAS QUE CORRESPONDEN A CAMPOS DEL MAESTRO
  1150* RESUMIDO CON RANGO DE VALORES INICIAL Y FINAL PARA VALIDACION
  1151* TAB-RANGOS: EL ORDEN DE LOS CAMPOS ALMACENADOS ES CUOTA-MES,
  1152* VALOR-INICIAL, SALDO-DEUDA, SALDO-MORA, VALOR-DISPONIBLE, CUOTAS-
  1153* CANCELADAS, CUOTAS-EN-MORA, 3 OCURRENCIAS PARA USO FUTURO
  1154* IND-SECTOR-BDACUE: F-FINANCIERO, C-COOPERATIVO, R-REAL
  1155*-TABLA CON 15 INDICADORES DE LOS CAMPOS CONTENIDOS EN EL MAPA DE
  1156* BITS; VALOR=0 SI NO APLICA VALOR=1 SI APLICA AL TIPO DE CUENTA.
  1157*-CAMPOS CONTROL0X USADOS COMO DELIMITADORES.
  1158*----------------------------------------------------------------*
  1159* GJC0002    * NEWACT- PARA NUEVA ACTUALIZACION LOS ADJETIVOS
  1160* G JIMENEZ  *         VAN DE 1 A 9. SE DEFINE NUEVA TABLA DE
  1161* 21-07-2009 *         ADJETIVOS VALIDOS
  1162*****************************************************************
  1163 FD  BDACUE.
  1164 01  REG-BDACUE.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  21
* FD)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
  1165     03  TIP-CTA-BDACUE               PIC 9(2).
  1166     03  DES-CORTA-BDACUE             PIC X(3).
  1167     03  DES-LARGA-BDACUE             PIC X(21).
  1168     03  DES-COMPLETA-BDACUE          PIC X(30).
  1169     03  CONTROL01-BDACUE             PIC X(01).
  1170     03  IND-NOV-BDACUE OCCURS 35     PIC 9(1).
  1171     03  CONTROL02-BDACUE             PIC X(01).
  1172     03  IND-ADJ-BDACUE OCCURS 31     PIC 9(2).
  1173     03  CONTROL03-BDACUE             PIC X(01).
  1174     03  IND-SECTOR-BDACUE            PIC X(1).
  1175     03  CONTROL04-BDACUE             PIC X(01).
  1176     03  TAB-RANGOS-BDACUE OCCURS 10.
  1177         04 VAL-INI-BDACUE            PIC 9(10).
  1178         04 VAL-FIN-BDACUE            PIC 9(10).
  1179     03  CONTROL05-BDACUE             PIC X(01).
  1180     03  TAB-IND-VAL-BDACUE.
  1181         04 VEC-IND-VAL-BDACUE OCCURS 15 TIMES PIC 9.
  1182     03  CONTROL06-BDACUE             PIC X(01).
  1183     03  IND-ADJ-NWACT-BDACUE OCCURS 9 TIMES                      GJC0002
  1184                                      PIC 9.                      GJC0002
  1185     03  CONTROL07-BDACUE             PIC X(1).                   GJC0002
  1186     03  FILLER-BDACUE                PIC X(40).                  GJC0002
  1187
  1188*----------------------------------*
  1189 WORKING-STORAGE SECTION.
  1190*----------------------------------*
  1191 01  W-REG-SALIDA.
  1192     03 W-TIPO-ID                    PIC 9(01).
  1193     03 FILLER                       PIC X(01) VALUE ";".
  1194     03 W-NUME-ID                    PIC 9(11).
  1195     03 FILLER                       PIC X(01) VALUE ";".
  1196     03 W-NOMCLI                     PIC X(45).
  1197     03 FILLER                       PIC X(01) VALUE ";".
  1198     03 W-CALENDPERANT               PIC X(02).
  1199     03 FILLER                       PIC X(01) VALUE ";".
  1200     03 W-CALENDPERACT               PIC X(02).
  1201     03 FILLER                       PIC X(01) VALUE ";".
  1202     03 W-ACIERTA                    PIC 9(05).
  1203     03 FILLER                       PIC X(01) VALUE ";".
  1204     03 W-NUM-CTA                    PIC X(18).
  1205     03 FILLER                       PIC X(01) VALUE ";".
  1206     03 W-DESPRODU                   PIC X(35).
  1207     03 FILLER                       PIC X(01) VALUE ";".
  1208     03 W-SUSCRIPTOTOR               PIC X(40).
  1209     03 FILLER                       PIC X(01) VALUE ";".
  1210     03 W-FECHA-INICIAL              PIC X(06).
  1211     03 FILLER                       PIC X(01) VALUE ";".
  1212     03 W-FECHA-NOVEDAD              PIC X(06).
  1213     03 FILLER                       PIC X(01) VALUE ";".
  1214     03 W-NOVEDAD                    PIC X(10).
  1215     03 FILLER                       PIC X(01) VALUE ";".
  1216     03 W-VECTOR-1                   PIC X(48).
  1217     03 FILLER                       PIC X(01) VALUE ";".
  1218     03 W-VALOR-INI                  PIC 9(07).
  1219     03 FILLER                       PIC X(01) VALUE ";".
  1220     03 W-SALDO-CARTERA              PIC 9(07).
  1221     03 FILLER                       PIC X(01) VALUE ";".
  1222     03 W-SALDO-MORA                 PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  22
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1223     03 FILLER                       PIC X(01) VALUE ";".
  1224     03 W-VALOR-CUOTA                PIC 9(07).
  1225     03 FILLER                       PIC X(01) VALUE ";".
  1226     03 W-TIPOCLI                    PIC X(01).
  1227     03 FILLER                       PIC X(01) VALUE ";".
  1228     03 W-FECHA-VENCIM               PIC X(06).
  1229
  1230 01  W-VARIABLES.
  1231     03 W-VEC-APROBACI.
  1232        05 W-CC-SN            PIC X VALUE SPACES.                      **>
  1233        05 W-DR-SN            PIC X VALUE SPACES.
  1234        05 W-COBRA-SN         PIC X VALUE SPACES.
  1235        05 W-CALI-SN          PIC X VALUE SPACES.
  1236     03 FILLER  REDEFINES W-VEC-APROBACI.
  1237        05 W-VEC-APROBACI-X   PIC X(04).
  1238*
  1239     03 RELLENO                     PIC X(48).
  1240     03 FECHA-AUX                   PIC 9(04).
  1241     03 II                          PIC 9(04).
  1242     03 LL                          PIC 9(04).
  1243     03 TOPE-V                      PIC S9999     VALUE  ZEROS.
  1244     03 W-MESES-NOV                 PIC 9(04)     VALUE  ZEROS.
  1245     03 W-CREDITOS-ACTV             PIC 9(04)     VALUE  ZEROS.
  1246     03 W-NUM-OBLIG-CAB             PIC 9(04)     VALUE  ZEROS.
  1247     03 W-TOT-INICIAL-CAB           PIC 9(15)     VALUE  ZEROS.
  1248     03 W-TOT-SALDOS-CAB            PIC 9(15)     VALUE  ZEROS.
  1249     03 W-TOT-CUOTAS-CAB            PIC 9(11)     VALUE  ZEROS.
  1250     03 W-TOT-MORA-CAB              PIC 9(11)     VALUE  ZEROS.
  1251     03 W-NUM-OBLIG-CAV             PIC 9(04)     VALUE  ZEROS.
  1252     03 W-TOT-INICIAL-CAV           PIC 9(15)     VALUE  ZEROS.
  1253     03 W-TOT-SALDOS-CAV            PIC 9(15)     VALUE  ZEROS.
  1254     03 W-TOT-CUOTAS-CAV            PIC 9(11)     VALUE  ZEROS.
  1255     03 W-TOT-MORA-CAV              PIC 9(11)     VALUE  ZEROS.
  1256     03 W-NUM-OBLIG-OTR             PIC 9(04)     VALUE  ZEROS.
  1257     03 W-TOT-INICIAL-OTR           PIC 9(15)     VALUE  ZEROS.
  1258     03 W-TOT-SALDOS-OTR            PIC 9(15)     VALUE  ZEROS.
  1259     03 W-TOT-CUOTAS-OTR            PIC 9(11)     VALUE  ZEROS.
  1260     03 W-TOT-MORA-OTR              PIC 9(11)     VALUE  ZEROS.
  1261     03 W-TOT-NUM-TDC               PIC 9(04)     VALUE  ZEROS.
  1262     03 W-TOT-CUPOS-TDC             PIC 9(15)     VALUE  ZEROS.
  1263     03 W-TOT-SALDO-TDC             PIC 9(15)     VALUE  ZEROS.
  1264     03 W-SAL-CUPOS-TDC             PIC 9(11)     VALUE  ZEROS.
  1265     03 W-UTLIZACION-TDC            PIC 9(3)V9999 VALUE  ZEROS.
  1266     03 W-TOT-CUOTAS-TDC            PIC 9(11)     VALUE  ZEROS.
  1267     03 W-TOT-MORA-TDC              PIC 9(11)     VALUE  ZEROS.
  1268     03 W-NRO-RANGO-0               PIC 9(03)     VALUE  ZEROS.
  1269     03 W-NRO-RANGO-1               PIC 9(03)     VALUE  ZEROS.
  1270     03 W-NRO-RANGO-2               PIC 9(03)     VALUE  ZEROS.
  1271     03 W-NRO-RANGO-3               PIC 9(03)     VALUE  ZEROS.
  1272     03 W-NRO-RANGO-4               PIC 9(03)     VALUE  ZEROS.
  1273     03 W-NRO-RANGO-5               PIC 9(03)     VALUE  ZEROS.
  1274     03 W-NRO-RANGO-6               PIC 9(03)     VALUE  ZEROS.
  1275     03 W-FEC-MENOR-TDC.
  1276        05 W-ANO-MEN-TDC            PIC 9(04)     VALUE  ZEROS.
  1277        05 W-MES-MEN-TDC            PIC 9(02)     VALUE  ZEROS.
  1278     03 W-FEC-APERTURA.
  1279        05 W-ANO-APERTURA           PIC 9(04)     VALUE  ZEROS.
  1280        05 W-MES-APERTURA           PIC 9(02)     VALUE  ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  23
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1281     03 W-FEC-NOVEDAD.
  1282        05 W-ANO-NOV                PIC 9(04)     VALUE  ZEROS.
  1283        05 W-MES-NOV                PIC 9(02)     VALUE  ZEROS.
  1284     03 W-NUM-OBLIG-REAL            PIC 9(04)     VALUE  ZEROS.
  1285     03 W-TOT-INICIAL-REAL          PIC 9(15)     VALUE  ZEROS.
  1286     03 W-TOT-SALDOS-REAL           PIC 9(15)     VALUE  ZEROS.
  1287     03 W-TOT-CUOTAS-REAL           PIC 9(11)     VALUE  ZEROS.
  1288     03 W-TOT-MORA-REAL             PIC 9(11)     VALUE  ZEROS.
  1289     03 W-NUM-OBLIG-TELE            PIC 9(04)     VALUE  ZEROS.
  1290     03 W-TOT-CUOTAS-TELE           PIC 9(11)     VALUE  ZEROS.
  1291     03 W-TOT-MORA-TELE             PIC 9(11)     VALUE  ZEROS.
  1292     03 W-NUM-OBLIG-COOP            PIC 9(04)     VALUE  ZEROS.
  1293     03 W-TOT-INICIAL-COOP          PIC 9(15)     VALUE  ZEROS.
  1294     03 W-TOT-SALDOS-COOP           PIC 9(15)     VALUE  ZEROS.
  1295     03 W-TOT-CUOTAS-COOP           PIC 9(11)     VALUE  ZEROS.
  1296     03 W-TOT-MORA-COOP             PIC 9(11)     VALUE  ZEROS.
  1297     03 W-NUM-OBLIG-CODEU           PIC 9(04)     VALUE  ZEROS.
  1298     03 W-TOT-SALDOS-CODEU          PIC 9(15)     VALUE  ZEROS.
  1299     03 W-TOT-CUOTAS-CODEU          PIC 9(11)     VALUE  ZEROS.
  1300     03 W-TOT-MORA-CODEU            PIC 9(11)     VALUE  ZEROS.
  1301     03 W-CREDITOS-ALDIA            PIC 9(03)     VALUE  ZEROS.
  1302     03 W-MORAS-30-ACT              PIC 9(03)     VALUE  ZEROS.
  1303     03 W-MORAS-60-ACT              PIC 9(03)     VALUE  ZEROS.
  1304     03 W-MORAS-90-ACT              PIC 9(03)     VALUE  ZEROS.
  1305     03 W-MORAS-120-ACT             PIC 9(03) VALUE ZEROS.
  1306     03 W-CAR-CASTIGA               PIC 9(03) VALUE ZEROS.
  1307     03 W-DUD-RECAUDO               PIC 9(03) VALUE ZEROS.
  1308     03 W-CUENTAS-COBRADOR          PIC 9(03) VALUE ZEROS.
  1309     03 W-MORAS-30-HIS              PIC 9(03) VALUE ZEROS.
  1310     03 W-MORAS-60-HIS              PIC 9(03) VALUE ZEROS.
  1311     03 W-MORAS-90-HIS              PIC 9(03) VALUE ZEROS.
  1312     03 W-MORAS-120-HIS             PIC 9(03) VALUE ZEROS.
  1313     03 W-CANC-MMANEJO              PIC 9(03) VALUE ZEROS.
  1314     03 W-CAR-RECUPERADA            PIC 9(03) VALUE ZEROS.
  1315     03 W-MORA-MAX-TDC              PIC 9(03) VALUE ZEROS.
  1316     03 W-MORA-MAX-CAB              PIC 9(03) VALUE ZEROS.
  1317     03 W-MORA-MAX-COOP             PIC 9(03) VALUE ZEROS.
  1318     03 W-MORA-MAX-CAV              PIC 9(03) VALUE ZEROS.
  1319     03 W-CTAS-AHORROS              PIC 9(03) VALUE ZEROS.
  1320     03 W-CTES-CORRIENTES           PIC 9(03) VALUE ZEROS.
  1321     03 W-CTES-EMBARGADAS           PIC 9(03) VALUE ZEROS.
  1322     03 W-CTES-MAL-MANEJO           PIC 9(03) VALUE ZEROS.
  1323     03 W-CTES-SALDADAS             PIC 9(03) VALUE ZEROS.
  1324     03 W-TOTAL-CONSULTAS           PIC 9(03) VALUE ZEROS.
  1325     03 W-ALDIA-FINA                PIC 9(03) VALUE ZEROS.
  1326     03 W-ALDIA-REAL                PIC 9(03) VALUE ZEROS.
  1327     03 W-ALDIA-COOP                PIC 9(03) VALUE ZEROS.
  1328     03 W-ALDIA-TELE                PIC 9(03) VALUE ZEROS.
  1329     03 W-MORAS-FINA                PIC 9(03) VALUE ZEROS.
  1330     03 W-MORAS-REAL                PIC 9(03) VALUE ZEROS.
  1331     03 W-MORAS-COOP                PIC 9(03) VALUE ZEROS.
  1332     03 W-MORAS-TELE                PIC 9(03) VALUE ZEROS.
  1333     03 W-CC-DR-FINA                PIC 9(03) VALUE ZEROS.
  1334     03 W-CC-DR-REAL                PIC 9(03) VALUE ZEROS.
  1335     03 W-CC-DR-COOP                PIC 9(03) VALUE ZEROS.
  1336     03 W-CC-DR-TELE                PIC 9(03) VALUE ZEROS.
  1337     03 W-EDAD                      PIC 9(03) VALUE ZEROS.
  1338     03 FIN-CHECK                   PIC 9(01) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  24
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1339     03 SALIR-END                   PIC 9(01) VALUE ZEROS.
  1340     03 IND-E                       PIC 9(03) VALUE ZEROS.
  1341     03 F                           PIC 9(01) VALUE ZEROS.
  1342     03 J                           PIC 9(04) VALUE ZEROS.
  1343
  1344     03 W-ENDEUDA                   PIC X(01) VALUE SPACES.
  1345     03 IND-J                       PIC 9(02) VALUE ZEROS.
  1346     03 SW-CODEUDOR                 PIC 9(01) VALUE ZEROS.
  1347     03 TOPE-IND                    PIC 9(03) VALUE ZEROS.
  1348     03 SW-FECHA-LOW                PIC 9(01) VALUE ZEROS.
  1349     03 SW-END                      PIC 9(01) VALUE ZEROS.
  1350     03 FEC-MENOR-TDC               PIC 9(06) VALUE ZEROS.
  1351     03 EVALUA-FINAL                PIC 9(01) VALUE ZEROS.
  1352     03 CONT-LECTURA                PIC 9(03) VALUE ZEROS.
  1353     03 EVALUA-CREDITO              PIC 9(01) VALUE ZEROS.
  1354     03 EVALUA-ENDEUDA              PIC 9(01) VALUE ZEROS.
  1355     03 EVALUA-CTA-CTE              PIC 9(01) VALUE ZEROS.
  1356     03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.
  1357     03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.
  1358     03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.
  1359        05 W-ANO-EXPE               PIC 9(04).
  1360        05 W-MES-EXPE               PIC 9(02).
  1361        05 W-DIA-EXPE               PIC 9(02).
  1362     03 W-ACU-MMAX-TDC              PIC 9(03) VALUE ZEROS.
  1363     03 W-ACU-MMAX-CAB              PIC 9(03) VALUE ZEROS.
  1364     03 W-ACU-MMAX-COOP             PIC 9(03) VALUE ZEROS.
  1365     03 W-ACU-MMAX-CAV              PIC 9(03) VALUE ZEROS.
  1366     03 TEM-NRO-CTA.
  1367        05 TEM-NRO-CTA-C16          PIC X(16) VALUE ZEROS.
  1368        05 TEM-NRO-CTA-C17          PIC X(01) VALUE ZEROS.
  1369        05 TEM-NRO-CTA-C18          PIC X(01) VALUE ZEROS.
  1370     03 W-SUSCRIPTOR.
  1371        05 W-CODIGO-TIPOCTA         PIC 9(02).
  1372        05 W-CODIGO-RESTCTA         PIC 9(04).
  1373     03 W-TABLA-END-MAYOR.
  1374        05 W-TRIMESTRE-END  OCCURS   3 TIMES.
  1375           07 W-FECHA-END           PIC 9(08).
  1376           07 W-MAYOR-END           PIC X(01).
  1377     03 W-TABLA-SUS-CONSU.
  1378        05 W-SUS-CONSU      OCCURS  50 TIMES PIC 9(06).
  1379     03 W-FECHA-AUX                 PIC  9(04).
  1380     03 W-FECHA-AUX-R REDEFINES W-FECHA-AUX.
  1381        05 W-MES-AUX                PIC  9(02).
  1382        05 W-ANO-AUX                PIC  9(02).
  1383     03 W-FECHA-AUX1              PIC 9(06) VALUE ZEROS.
  1384     03 W-FECHA-AUX1-R REDEFINES W-FECHA-AUX1.
  1385        05 W-MES-AUX1             PIC 9(02).
  1386        05 W-ANO-AUX1             PIC 9(04).
  1387     03 W-FECHA-OK                PIC 9(06) VALUE ZEROS.
  1388     03 W-FECHA-OK-R REDEFINES W-FECHA-OK.
  1389        05 W-SLGANO-OK            PIC 9(04).
  1390        05 W-SLGANO-OK-R REDEFINES W-SLGANO-OK.
  1391           07 W-SGL-OK            PIC 9(02).
  1392           07 W-ANO-OK            PIC 9(02).
  1393        05 W-MES-OK               PIC 9(02).
  1394     03 W-FECHA-FINAL             PIC 9(06) VALUE ZEROS.
  1395     03 W-FECHA-APERTURA          PIC 9(06) VALUE ZEROS.
  1396
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  25
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1397*-------------------------------------------------------------*
  1398  01 FECHAS-AAAAMM.
  1399    02 FECHA-TAG                   PIC 9(6).
  1400    02 FILLER REDEFINES FECHA-TAG.
  1401       03 SIG-ANO-TAG              PIC 9(4).
  1402       03 FILLER REDEFINES SIG-ANO-TAG.
  1403          04 SIG-TAG               PIC 9(2).
  1404          04 ANO-TAG               PIC 9(2).
  1405       03 MES-TAG                  PIC 9(2).
  1406    02 FECHA-NOVEDAD07             PIC 9(6).
  1407    02 FILLER REDEFINES FECHA-NOVEDAD07.
  1408       03 SIG-ANO-NOV              PIC 9(4).
  1409       03 FILLER REDEFINES SIG-ANO-NOV.
  1410          04 SIG-NOV               PIC 9(2).
  1411          04 ANO-NOV               PIC 9(2).
  1412       03 MES-NOV                  PIC 9(2).
  1413    02 FECHA-APERTURA07            PIC 9(6).
  1414    02 FILLER REDEFINES FECHA-APERTURA07.
  1415       03 SIG-ANO-APE              PIC 9(4).
  1416       03 FILLER REDEFINES SIG-ANO-APE.
  1417          04 SIG-APE               PIC 9(2).
  1418          04 ANO-APE               PIC 9(2).
  1419       03 MES-APE                  PIC 9(2).
  1420    02 FECHA-VENCIMIENTO07         PIC 9(6).
  1421    02 FILLER REDEFINES FECHA-VENCIMIENTO07.
  1422       03 SIG-ANO-VEN              PIC 9(4).
  1423       03 FILLER REDEFINES SIG-ANO-VEN.
  1424          04 SIG-VEN               PIC 9(2).
  1425          04 ANO-VEN               PIC 9(2).
  1426       03 MES-VEN                  PIC 9(2).
  1427   02 FECHA-INGRESO               PIC 9(6).
  1428    02 FILLER REDEFINES FECHA-INGRESO.
  1429       03 SIG-ANO-ING              PIC 9(4).
  1430       03 FILLER REDEFINES SIG-ANO-ING.
  1431          04 SIG-ING               PIC 9(2).
  1432          04 ANO-ING               PIC 9(2).
  1433       03 MES-ING                  PIC 9(2).
  1434 01  FECHA-SITMMAAAA-ORI     PIC 9(6).
  1435 01  FILLER REDEFINES FECHA-SITMMAAAA-ORI.
  1436     03 FECHA-SITMM-ORI      PIC 9(2).
  1437     03 FECHA-SITAAAA-ORI    PIC 9(4).
  1438 01  FECHA-SITAAAAMM         PIC 9(6).
  1439 01  FILLER REDEFINES FECHA-SITAAAAMM.
  1440     03 FECHA-SITAAAA        PIC 9(4).
  1441     03 FECHA-SITMM          PIC 9(2).
  1442 01  FECHA-VALAAAAMM         PIC 9(6).
  1443 01  FILLER REDEFINES FECHA-VALAAAAMM.
  1444     03 FECHA-VALAAAA        PIC 9(4).
  1445     03 FECHA-VALMM          PIC 9(2).
  1446*---------------------------------------------------------------*
  1447 01  W-FECHA-MILENIO.
  1448     03 W-FMILENIO-SIGLO            PIC  9(02).
  1449     03 W-FMILENIO-ANIO             PIC  9(02).
  1450     03 W-FMILENIO-MES              PIC  9(02).
  1451*----------------------------------------------------------------*
  1452 01  W-CONSTANTES.
  1453     03 SW-READ-INC                 PIC 9(01) VALUE ZEROS.
  1454     03 W-IND                       PIC 9(02) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  26
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1455     03 LEIDOS                      PIC 9(08) VALUE ZEROS.
  1456     03 GRABADOS                    PIC 9(08) VALUE ZEROS.
  1457     03 END-RUN                     PIC X(01) VALUE " ".
  1458     03 W-STATUS-ENT                PIC 9(02) VALUE ZEROS.
  1459     03 W-STATUS-INC                PIC 9(02) VALUE ZEROS.
  1460*
  1461     03 W-RESET-LEIDOS              PIC 9(09) VALUE 9.
  1462     03 W-LEIDOS                    PIC 9(09) VALUE ZEROS.
  1463     03 W-LEIDOS-RED REDEFINES W-LEIDOS.
  1464        05 FILLER                   PIC 9(06).
  1465        05 CEROS                    PIC 9(03).
  1466     03 W-GRABADOS                  PIC 9(09) VALUE ZEROS.
  1467     03 W-SOLO-CODEUDORES           PIC 9(09) VALUE ZEROS.
  1468     03 W-SOLO-COOPERATIVAS         PIC 9(09) VALUE ZEROS.
  1469     03 W-SOLO-CERRADOS             PIC 9(09) VALUE ZEROS.
  1470     03 W-MORA-TOT-SEC-FINA         PIC 9(09) VALUE ZEROS.
  1471     03 W-MORA-TOT-SEC-REAL         PIC 9(09) VALUE ZEROS.
  1472     03 W-MORA-TOT-REAL-FINA        PIC 9(09) VALUE ZEROS.
  1473
  1474     03 W-FECHA-BASE                PIC 9(06) VALUE ZEROS.
  1475     03 W-OPCION                    PIC X(01) VALUE SPACES.
  1476     03 W-VECTOR-L                  PIC 9(02) VALUE 12.
  1477     03 END-RUN                     PIC X(01) VALUE SPACES.
  1478     03 W-CC                        PIC 9(05) VALUE ZEROS.
  1479     03 W-DR                        PIC 9(05) VALUE ZEROS.
  1480     03 W-COBRA                     PIC 9(05) VALUE ZEROS.
  1481     03 W-CALI                      PIC X(01) VALUE ZEROS.
  1482
  1483*------------------------------------------------------------*
  1484*     AREA WORK ACUMULADORES
  1485*------------------------------------------------------------*
  1486 01  W-ACUMULADORES-ESTA.
  1487     03 W-EDITOR-CON                PIC Z,ZZZ,ZZ9.
  1488     03 W-EDITOR-SIN                PIC Z,ZZZ,ZZ9.
  1489     03 W-EDITOR-INC                PIC Z,ZZZ,ZZ9.
  1490     03 W-EDITOR-TOT                PIC Z,ZZZ,ZZ9.
  1491     03 W-CON-INFORMACION           PIC 9(07) VALUE ZEROS.
  1492     03 W-SIN-INFORMACION           PIC 9(07) VALUE ZEROS.
  1493     03 W-INCONSISTENCIAS           PIC 9(07) VALUE ZEROS.
  1494*----------------------------------------------------------------*
  1495*     VARIABLES DEL MANEJO DE BDACUE                             *
  1496*----------------------------------------------------------------*
  1497 01  VAL-VARIABLES.
  1498     03  W-CTA-BDCUE                 PIC 9(02) VALUE ZEROS.
  1499     03  SW-LOAD-TBL                 PIC 9(01) VALUE ZEROS.
  1500     03  T                           PIC 9(04) VALUE ZEROS.
  1501     03  TOPE-T                      PIC 9(04) VALUE ZEROS.
  1502     03  TABLA-VAL-TIP-CTA OCCURS 100 TIMES.
  1503         04 VEC-VALOR-BDACUE OCCURS 15 TIMES PIC 9.
  1504*----------------------------------------------------------------*
  1505*     VARIABLES ESTADISTICAS                                     *
  1506*----------------------------------------------------------------*
  1507 01  W-ACUMULADORES-ESTA.
  1508     03 W-ESTADO-INF          OCCURS  3 TIMES.
  1509        05 W-TABLA-TIPO-ID    OCCURS  5 TIMES.
  1510           07 W-ACUM-TIPO-ID    PIC  9(07) VALUE ZEROS.
  1511*------------------------------------------------------------*
  1512*    ACUMULACION VARIABLES DEMOGRAFICAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  27
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1513*------------------------------------------------------------*
  1514     03 W-EDAD-66           PIC  9(07) VALUE ZEROS.
  1515     03 W-EDAD-56-65        PIC  9(07) VALUE ZEROS.
  1516     03 W-EDAD-46-55        PIC  9(07) VALUE ZEROS.
  1517     03 W-EDAD-36-45        PIC  9(07) VALUE ZEROS.
  1518     03 W-EDAD-29-35        PIC  9(07) VALUE ZEROS.
  1519     03 W-EDAD-22-28        PIC  9(07) VALUE ZEROS.
  1520     03 W-EDAD-18-21        PIC  9(07) VALUE ZEROS.
  1521*------------------------------------------------------------*
  1522*    ACUMULACION ESTADO ACTUAL
  1523*------------------------------------------------------------*
  1524     03 W-TOT-CAR-CASTIGA      PIC  9(07) VALUE ZEROS.
  1525     03 W-TOT-DUD-RECAUDO      PIC  9(07) VALUE ZEROS.
  1526     03 W-TOT-CTES-EMBARGADAS  PIC  9(07) VALUE ZEROS.
  1527     03 W-TOT-MORAS-120-ACT    PIC  9(07) VALUE ZEROS.
  1528     03 W-TOT-MORAS-90-ACT     PIC  9(07) VALUE ZEROS.
  1529     03 W-TOT-MORAS-60-ACT     PIC  9(07) VALUE ZEROS.
  1530     03 W-TOT-MORAS-30-ACT     PIC  9(07) VALUE ZEROS.
  1531     03 W-TOT-W-ENDEUDA        PIC  9(07) VALUE ZEROS.
  1532     03 W-TOT-ALDIA            PIC  9(07) VALUE ZEROS.
  1533     03 W-TOT-SIN-CTAS         PIC  9(07) VALUE ZEROS.
  1534*------------------------------------------------------------*
  1535*    ACUMULACION ESTADO SECTOR
  1536*------------------------------------------------------------*
  1537     03 W-TOT-CC-DR-FINA       PIC  9(07) VALUE ZEROS.
  1538     03 W-TOT-MORAS-FINA       PIC  9(07) VALUE ZEROS.
  1539     03 W-TOT-ALDIA-FINA       PIC  9(07) VALUE ZEROS.
  1540     03 W-TOT-CC-DR-REAL       PIC  9(07) VALUE ZEROS.
  1541     03 W-TOT-MORAS-REAL       PIC  9(07) VALUE ZEROS.
  1542     03 W-TOT-ALDIA-REAL       PIC  9(07) VALUE ZEROS.
  1543     03 W-TOT-CC-DR-COOP       PIC  9(07) VALUE ZEROS.
  1544     03 W-TOT-MORAS-COOP       PIC  9(07) VALUE ZEROS.
  1545     03 W-TOT-ALDIA-COOP       PIC  9(07) VALUE ZEROS.
  1546     03 W-TOT-CC-DR-TELE       PIC  9(07) VALUE ZEROS.
  1547     03 W-TOT-MORAS-TELE       PIC  9(07) VALUE ZEROS.
  1548     03 W-TOT-ALDIA-TELE       PIC  9(07) VALUE ZEROS.
  1549*------------------------------------------------------------*
  1550*    ACUMULACION VALORES TOTALES
  1551*------------------------------------------------------------*
  1552     03 W-SALDOS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1553     03 W-CUOTAS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1554     03 W-MORAS-SEC-FINA       PIC  9(15) VALUE ZEROS.
  1555     03 W-SALDOS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1556     03 W-CUOTAS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1557     03 W-MORAS-SEC-REAL       PIC  9(15) VALUE ZEROS.
  1558     03 W-SALDOS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1559     03 W-CUOTAS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1560     03 W-MORAS-SEC-COOP       PIC  9(15) VALUE ZEROS.
  1561
  1562*---------------------------------------------------------*
  1563 01  W-PARAMETROS              PIC  X(94) VALUE SPACES.
  1564*---------------------------------------------------------*
  1565
  1566*----------------------------------------------------------------*
  1567* Estas son las variables para analizar los vectores de          *
  1568* comportamiento de moras HISTORICAS (estado-mes-abd07) y        *
  1569* (vector-2-abd07)                                               *
  1570*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  28
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1571 01  WS-ESTADO-MES-1                        PIC 9(12).
  1572 01  WS-ESTADO-MES-2                        PIC 9(12).
  1573 01  WS-ESTADO-MES                          PIC 9(12).
  1574 01  WS-ESTADO-MES-R REDEFINES WS-ESTADO-MES.
  1575     03  WS-MES                             PIC X OCCURS 12 TIMES.
  1576 01  ESTADO-MES-IMP.
  1577     03  E-MES-IMP                          PIC X OCCURS 12 TIMES.
  1578
  1579 01  ESTADO-ANUAL.
  1580     03  CHAR-H                             PIC X OCCURS 12 TIMES.
  1581 01  I                                      PIC 9(3)   VALUE ZERO.
  1582
  1583 01  E                                      PIC 9(3)   VALUE ZERO.
  1584 01  K                                      PIC 9(4)   VALUE 01.
  1585 01  N                                      PIC 9(3)   VALUE ZERO.
  1586 01  TIV                                    PIC 9(3)   VALUE ZERO.
  1587 01  TFV                                    PIC 9(3)   VALUE ZERO.
  1588 01  F-AUX-1                                PIC 9(4)   VALUE ZERO.
  1589 01  F-AUX                                  PIC 9(4)   VALUE ZERO.
  1590 01  F-UACT-2                               PIC 9(4)   VALUE ZERO.
  1591 01  F-APE-7                                PIC 9(4)   VALUE ZERO.
  1592 01  F-ING-2                                PIC 9(4)   VALUE ZERO.
  1593 01  F-NOV-7                                PIC 9(4)   VALUE ZERO.
  1594 01  F-VIEJ                                 PIC 9(4)   VALUE ZERO.
  1595 01  ENCONTRO                               PIC 9(1)   VALUE ZERO.
  1596*01  RELLENO                                PIC 9(1)   VALUE ZERO.
  1597 01  CINCO                                  PIC 9(2)   VALUE 5.
  1598 01  NUEVO                                  PIC 9      VALUE 0.
  1599 01  COD-SUSCRIP-AUX                        PIC 9(6)   VALUE ZERO.
  1600*------------------------------------------------------------*
  1601 01  VECTOR-S.
  1602     03 VECTOR-A-R1                        PIC X(24).
  1603     03 VECTOR-A-R2                        PIC X(24).
  1604 01  VECTOR-S-12.
  1605     03 VECTOR-N-R1                        PIC X(24).
  1606     03 VECTOR-N-R2                        PIC X(24).
  1607*------------------------------------------------------------*
  1608  01 V-NOR.
  1609     02 V-NOR1                     PIC 9(12).
  1610     02 V-NOR2                     PIC 9(12).
  1611     02 V-NOR3                     PIC 9(12).
  1612     02 V-NOR4                     PIC 9(12).
  1613  01 V-NOR-AUX     PIC X(47) VALUE SPACES.
  1614
  1615  01 VECTORES-W.
  1616    02 VECTOR-MORA.
  1617       03 FILLER PIC X(25) VALUE "5PMPPPPPPPPP5555123411212".
  1618       03 FILLER PIC X(25) VALUE "3234123412341234999CRD999".
  1619    02 FILLER REDEFINES VECTOR-MORA.
  1620       03 V-MORA OCCURS 50 TIMES PIC X.
  1621*------------------------------------------------------------*
  1622 01  SALIDA-48.
  1623     05 S48-EST                     PIC X(15).
  1624     05 S48-SUS                     PIC X(14).
  1625     05 S48-FEC                     PIC 9(6).
  1626     05 S48-FECALPHA REDEFINES S48-FEC    PIC X(6).
  1627     05 S48-AVA                     PIC X(9).
  1628     05 S48-VEC                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  29
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1629     05 S48-VEC-12                  PIC X(12).
  1630*------------------------------------------------------------*
  1631 01  F-APE-07                      PIC 9999.
  1632 01  F-APE-07-R                    REDEFINES F-APE-07.
  1633     03  M-APE-07                  PIC 99.
  1634     03  A-APE-07                  PIC 99.
  1635*------------------------------------------------------------*
  1636 01  F-ING-02                      PIC 9999.
  1637 01  F-ING-02-R                    REDEFINES F-ING-02.
  1638     03  M-ING-02                  PIC 99.
  1639     03  A-ING-02                  PIC 99.
  1640 01  F-NOV-07                      PIC 9999.
  1641 01  F-NOV-07-R                    REDEFINES F-NOV-07.
  1642     03  M-NOV-07                  PIC 99.
  1643     03  A-NOV-07                  PIC 99.
  1644*---------------------------------------------------------------*
  1645 01  W-FECHA-APE.
  1646     03  W-ANIO-APE                PIC 9(04).
  1647     03  W-MES-APE                 PIC 9(02).
  1648*---------------------------------------------------------------*
  1649 01  W-FECHA-HOY                   PIC X(08).
  1650 01  W-FECHA-HOY-R                 REDEFINES W-FECHA-HOY.
  1651     03  W-ANO-HOY                 PIC 9(04).
  1652     03  W-MES-HOY                 PIC 9(02).
  1653     03  W-DIA-HOY                 PIC 9(02).
  1654 01  CAL-NRO-MESES                 PIC S9(05).
  1655*---------------------------------------------------------------*
  1656 01  F-UACT-02                     PIC 9999.
  1657 01  F-UACT-02-R                   REDEFINES F-UACT-02.
  1658     03  M-UACT-02                 PIC 99.
  1659     03  A-UACT-02                 PIC 99.
  1660 01  WS-EST-MES.
  1661     03  WS-MES-NUEV               PIC 9.
  1662     03  WS-MESES-VIEJ             PIC 9(12).
  1663 01  WS-EST-MES-R REDEFINES WS-EST-MES.
  1664     03  WS-MESES-NUEV             PIC 9(12).
  1665     03  WS-MES-VIEJ               PIC 9.
  1666 01  FN.
  1667     03  FEC-NOV-S                 PIC 9(4)   VALUE ZERO.
  1668     03  FEC-NOV-RED-S REDEFINES FEC-NOV-S
  1669                                   PIC X(04).
  1670 01 ANO-2000                       PIC 99  VALUE 0.
  1671 01  SCREEN-HEADER.
  1672     03  FILLER                    PIC X(30) VALUE SPACES.
  1673     03  FILLER                    PIC X(20) VALUE
  1674         "=== DATA CREDITO ===" .
  1675     03  FILLER                    PIC X(30) VALUE SPACES.
  1676 01  SCREEN-TITLE REDEFINES SCREEN-HEADER PIC X(80).
  1677 01  MULT-TABLA OCCURS 200 TIMES.
  1678     03 MULT-CODIGO                PIC 9(6).
  1679     03 MULT-CLAVE                 PIC X(5).
  1680     03 MULT-TERMINAL              PIC 9(4).
  1681     03 MULT-PRODUCTO              PIC 9(2).
  1682     03 MULT-MODALIDAD             PIC 9(2).
  1683     03 MULT-ESTADO                PIC 9.
  1684     03 MULT-TTY                   PIC X(8).
  1685     03 MULT-SESION                PIC X(4) COMP-5.
  1686     03 MULT-PRIV-CLAVE            PIC 9(1).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  30
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1687     03 MULT-PRO-EXCLU             PIC 9(1).
  1688     03 MULT-NOM-SUS               PIC X(14).
  1689     03 MULT-NIT                   PIC 9(11) COMP-3.
  1690 01  NOM-COR-AUX             PIC X(14) VALUE SPACES.
  1691 01  FILLER REDEFINES NOM-COR-AUX.
  1692      02 NOM-COR-AUXN        PIC 9(6).
  1693      02 FILLER              PIC X(8).
  1694 01  NOM-COR-AUX2            PIC X(14) VALUE SPACES.
  1695 01  MENSAJE-CS.
  1696     02 HEADER.
  1697       03 HEADER-USUARIO           PIC X(10).
  1698       03 HEADER-TIPO-MENSAJE      PIC 9.
  1699       03 HEADER-LSN               PIC 9(4).
  1700       03 HEADER-LONGITUD          PIC 9(4).
  1701       03 HEADER-TERMINAL          PIC X(8).
  1702       03 HEADER-NOMB-PROG         PIC X(6).
  1703       03 HEADER-FILA              PIC 99.
  1704       03 HEADER-COLUMNA           PIC 99.
  1705       03 HEADER-CARACT-INICIO     PIC 9.
  1706       03 HEADER-CARACT-FIN        PIC 9.
  1707       03 HEADER-TIPO-TERMINAL     PIC X(6).
  1708       03 HEADER-FILLER            PIC X(5).
  1709    02 TEXTO                       PIC X(2000).
  1710    02 TEXTO-INPUT REDEFINES TEXTO.
  1711       03 AREA-INPUT               PIC X(80).
  1712       03 FILLER                   PIC X(1920).
  1713*-----------------------------------------------------------*
  1714 01  TABLA-HISTORICA-MORAS.
  1715     03 w-moras-historicas-v       pic X(48) value zeros.
  1716     03 w-moras-historicas-v-r redefines w-moras-historicas-v.
  1717        05 w-moras-historicas occurs 48 times pic X(01).
  1718 01  ARRASTRE                      PIC 9 VALUE ZEROS.
  1719*------------------------------------------------------------*
* 1720 COPY ICFILE.WS.
  1721* ICFILE-WS.v.0043.
  1722* COPY PARA DIRECCIONAR LOS ARCHIVOS.
  1723*****************************************************************
  1724* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS
  1725*R.MARTINEZ   * UNIVERSAL.
  1726******************************************************************
  1727* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *
  1728* VICTOR HUGO *                                                  *
  1729* FORERO      *                                                  *
  1730* DIC.01/2000 *                                                  *
  1731******************************************************************
  1732* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *
  1733* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *
  1734* FORERO      * NOMREG - REGISTRADURIA                           *
  1735* SEP.10/2001 * NOMDAS - DAS                                     *
  1736*             * NMDIAN - DIAN                                    *
  1737******************************************************************
  1738* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *
  1739* VICTOR HUGO * BYINGTON                                         *
  1740* FORERO      *                                                  *
  1741* FEB.18/2002 *                                                  *
  1742******************************************************************
  1743* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *
  1744* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  31
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1745* SEP.04/2002 *                                                  *
  1746* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*
  1747* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *
  1748* OCT.29/2002 *                                                  *
  1749******************************************************************
  1750* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *
  1751* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *
  1752* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *
  1753* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*
  1754*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *
  1755*             *          ENTRADA-ENTIDAD                         *
  1756*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *
  1757* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *
  1758*             *          CIONES Y TELEFONOS                      *
  1759*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1760*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1761*             *          RRIENTES CON RECLAMOS VIGENTES          *
  1762******************************************************************
  1763* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1764* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1765* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*
  1766*             *          NOMBRE                                  *
  1767******************************************************************
  1768* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *
  1769* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *
  1770* FEB.14/2003 *                                                  *
  1771******************************************************************
  1772* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1773* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *
  1774* MAR.03/2003 *          CON NUEVOS DISENOS.                     *
  1775******************************************************************
  1776* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *
  1777* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *
  1778* JUN.05/2003 *                                                  *
  1779* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *
  1780* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *
  1781* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *
  1782******************************************************************
  1783* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1784* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *
  1785* JUL.09/2003 *          en $TRABAJO/logs                        *
  1786******************************************************************
  1787* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*
  1788* G.JIMENEZ  .*                                                  *
  1789* SEP.11/2003 *                                                  *
  1790******************************************************************
  1791* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *
  1792* G.JIMENEZ  .*                                                  *
  1793* OCT.14/2004 *                                                  *
  1794******************************************************************
  1795* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1796* G.JIMENEZ   *          PRODUCTOS                               *
  1797* ABR/2005    *                                                  *
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1800* F.CUADROS   *          FRAINQ.DAT                              *
  1801* JUN.23/2005 *                                                  *
  1802******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *
  1804* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *
  1805* SEP.02/2005 *                                                  *
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *
  1808* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *          TIPO 8                                  *
  1810*             *                                                  *
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *
  1814* OCT.17/2006 *                                                  *
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *
  1817* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *
  1818* SEP.11/2007 *                                                  *
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *
  1821* F.LOZANO T. *          SCORES MENSUALES.                       *
  1822* OCT.31/2007 *                                                  *
  1823******************************************************************
  1824* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1825* C.VELASCO   *          DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1826* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP        *
  1827******************************************************************
  1828* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1829* E.ALVAREZ   *          PARA PROCESAR 48 MESES DEL ARCHIVO      *
  1830* JUN.19/2009 *                                                  *
  1831******************************************************************
  1832* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES        *
  1833* R.GALVIS    *          MAES-DIRECTORY ARCHIVOS ICMVLR          *
  1834* JUL.09/2009 *          DE 17 A 16 POSICIONES                   *
  1835*             * CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1836*             *          CHEQUES                                 *
  1837******************************************************************
  1838* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1839* V.FORERO    *          CLIENTES                                *
  1840* SEP.28/2009 *                                                  *
  1841******************************************************************
  1842* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1843* C.VELASCO   *          MARCAS PRIVADAS PARA TARJETAS           *
  1844* OCT.09/2009 *                                                  *
  1845******************************************************************
  1846* RGH0032       * MOD032 - INCLUIR ARCHIVOS DE RECONOCER +       *
  1847* R. GALVIS H.  *          BDLDIRACE                             *
  1848* ENE. 01/2010  *          BDLMAIEXC                             *
  1849* INTERSCHEMES. *          BDLTELEXC                             *
  1850******************************************************************
  1851* LAG0033       * SCOPRE - INCLUIR ARCHIVO SCOREPREC             *
  1852* AGO. 02/2010  *          BDLMAIEXC                             *
  1853* G.DESARROLLO  *          BDLTELEXC                             *
  1854* GJC0033       * FRZMYR - SE INCLUYE MANEJO DE ARCHIVO DE DES-  *
  1855* G.JIMENEZ     *          PLAZADOS Y SECUESTRADOS - FUERZA MA-  *
  1856* OCT./2010     *          YOR                                   *
  1857******************************************************************
  1858* GJC0034       * BDANOM - SE INCLUYE MANEJO DE ARCHIVO DE POR-  *
  1859* G.JIMENEZ     *          CENTAJE DE NOMBRES Y APELLIDOS BDANOM *
  1860* FEB./2011     *                                                *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  33
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1861******************************************************************
  1862* CAV0035       * AJDANE - SE INCLUYE MANEJO DE ARCHIVO DANE DE  *
  1863* C.VELASCO     *          CIUDADES,DEPARTEAMENTOS Y CABECERAS O *
  1864* ABR./2011     *          CENTROS POBLADOS (DVPDANE)            *
  1865******************************************************************
  1866* CAV0036       * CARIND - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1867* C.VELASCO     *          CARACTERISTICAS USA PRECALCULADAS     *
  1868* MAY./2011     *          TITLE-CARACT-IND                      *
  1869******************************************************************
  1870* FARF037       * FRABDU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1871* F.RODRIGUEZ   *          DE DATOS UNIVERSAL DE PREGUNTAS       *
  1872* JUN.22/2011   *                                                *
  1873******************************************************************
  1874* CAV0038       * AJCIIU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1875* C.VELASCO.    *          HISTORICA DE CODIGOS CIIU Y ACTIVIDAD *
  1876* SEP.21/2011   *          ECONOMICA                             *
  1877******************************************************************
  1878* CAV0039       * MCREHI - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1879* C.VELASCO     *          ICMCREH QUE CONTIENE EL HISTORICO     *
  1880* JUN./2011     *          DE REGISTRO CERRADOS > 5 AÑOS         *
  1881******************************************************************
  1882* CAV0040       * NUECMP - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1883* C.VELASCO     *          ICMCONTTRJ  CONTIENE LA RELACION DE   *
  1884* 09/ABR./2013  *          CONTRATO-TARJETA PARA TIPO CTA = 02.  *
  1885******************************************************************
  1886* GJC0041       * VALOR1 - REQUERIMIENTO 15452 CREACION PRODUCTO *
  1887* G.JIMENEZ     *          VALORA. DEFINICION DE ARCHIVO QUE MA- *
  1888* 20/SEP./2013  *          NEJA LOS COBROS EN 2 MOMENTOS, UN     *
  1889*               *          QUE COBRA Y LOS OTROS NO
  1890******************************************************************
  1891* GLB0042       * EVID03 - MEJORAS SISTEMA EVIDENTE              *
  1892* GLOBANT       *          PROD00006585                          *
  1893* NOV-2013      * SPRINT3                                        *
  1894******************************************************************
  1895* JJM0043       * SCORPJ - SE INCLUYE UN NUEVO TITLE PARA EL     *
  1896* J. MELGAREJO  *          SCORE PJ.                             *
  1897* MAR-2014      * SCOSTB - SE INCLUYE UN NUEVO TITLE PARA EL     *
  1898*               *          SCORE STABILITY  (BDSCOREHIS)
  1899******************************************************************
  1900*
  1901 01  FILE-TITLES.
  1902     05  BDUUNI-TITLE        PIC X(80) VALUE "$BDU/BDUUNI".       RMB0008
  1903     05  NOMB-APEL-TITLE     PIC X(80) VALUE "$DATABASE/ICBNAP".
  1904     05  CLAVE-TITLE         PIC X(80) VALUE "$DATABASE/ICBCLA".
  1905     05  TERM-TITLE          PIC X(80) VALUE "$DATABASE/ICBTER".
  1906     05  MAES-PERSON-TITLE   PIC X(80) VALUE "$DATABASE/ICMPER".
  1907     05  MAES-CHECK-TITLE    PIC X(80) VALUE "$DATABASE/ICMCHK".
  1908     05  MAES-CREDIT-TITLE   PIC X(80) VALUE "$DATABASE/ICMCRE".
  1909     05  MAES-MICROC-TITLE   PIC X(80) VALUE "$DATABASE/ICMMCR".  DLM0001
  1910     05  MAES-ICMCHQ-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQ".  GJC0029
  1911     05  INDEXADO-TITLE      PIC X(80) VALUE "$DATABASE/ICBCON".
  1912     05  SECUENCIAL-TITLE    PIC X(80) VALUE "$DATABASE/ICBTCO".
  1913     05  SUSCRIPTOR-TITLE    PIC X(80) VALUE "$DATABASE/ICBSUS".
  1914     05  ARCHNITS-TITLE      PIC X(80) VALUE "ICDIAN".
  1915     05  ARCHIVO-CLIENTE     PIC X(80) VALUE "$DATABASE/ICMCLI".
  1916     05  MAES-ICMCLN-TITLE   PIC X(80) VALUE "$DATABASE/ICMCLN".  VHF0030
  1917     05  ARCHIVO-PREPAGOS    PIC X(80) VALUE "$DATABASE/ICMPRE".
  1918     05  ARCHIVO-USUARIOS    PIC X(80) VALUE "$DATABASE/ICMUSU".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  34
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1919     05  TITLE-SCODTB        PIC X(80) VALUE "$DATABASE/SCODTB".
  1920     05  TITLE-BDIRMAE1      PIC X(80) VALUE "$DATABASE/BDIRMAE1".
  1921     05  TITLE-BDIRMAE2      PIC X(80) VALUE "$DATABASE/BDIRMAE2".
  1922     05  TITLE-BDIRMAE3      PIC X(80) VALUE "$DATABASE/BDIRMAE3".
  1923     05  TITLE-BDIRMAE4      PIC X(80) VALUE "$DATABASE/BDIRMAE4".
  1924     05  TITLE-BDIRCTR       PIC X(80) VALUE "$DATABASE/BDIRCTR".
  1925     05  TITLE-BDIMHIS       PIC X(80) VALUE "$DATABASE/BDIMHIS". FAC0023
  1926     05  BDAPRVTR-TITLE      PIC X(80) VALUE "$DATABASE/BDAPRVTR".CAV0031
  1927     05  TITLE-DTCABD.
  1928         07 FILLER           PIC X(13) VALUE "$DATOS/DTCABD".     GJC0014
  1929         07 ANOMESDIA-DTCABD PIC 9(08) VALUE ZEROS.               GJC0014
  1930     05  BDLCLI-TITLE        PIC X(80) VALUE "$DATABASE/BDLCLI".  GJC0013
  1931     05  SCOREPREC-TITLE     PIC X(80) VALUE "$DATOS/SCOREPREC".  LAG0033
  1932     05  ARCHIVO-LOGS        PIC X(80) VALUE
  1933         "/ic/datacred/desarrollo/logs/ICL325".
  1934     05  ARCHIVO-TEMPORAL    PIC X(80) VALUE
  1935                                 "$TEMPORALES/TEMPORAL".
  1936     05  ESTAD-CADUC         PIC X(80) VALUE
  1937                                 "$TEMPORALES/ESTCAD.DAT".
  1938     05  MATRIZ-CADUC        PIC X(80) VALUE
  1939                                 "$DATABASE/ICTCAD".
  1940     05  ETQ-CIN             PIC X(80) VALUE
  1941                                 "$TEMPORALES/ICINCO.DAT".
  1942     05  RECLACOM-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCM".
  1943     05  RECLAMOS-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCL".
  1944     05 MAESTRO-FACUCLI      PIC X(80) VALUE "$DATABASE/FACUCLI".
  1945     05 TITLE-FACUCLP        PIC X(80) VALUE "$DATABASE/FACUCLP".
  1946     05 TITLE-FACUAUT        PIC X(80) VALUE "$DATABASE/FACUAUT".
  1947     05 TITLE-FACULOG        PIC X(80) VALUE "$DATABASE/FACULOG".
  1948     05 TITLE-FACUPAR        PIC X(80) VALUE
  1949                                 "$DATABASE/FACUPAR.DAT".
  1950     05 MAES-ICMCREH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCREH". CAV0039
  1951     05 MAES-ICMCHKH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHKH". CAV0039
  1952     05 MAES-ICMCHQH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQH". CAV0039
  1953
  1954     05 TITLE-CIIU          PIC X(80) VALUE "$DATABASE/ICTCIIU".  VHF0009
  1955     05 TITLE-BDINCCB       PIC X(80) VALUE "$ICREGIS/BDINCCB".   VHF0010
  1956     05 TITLE-BDINREG       PIC X(80) VALUE "$ICREGIS/BDINREG".   VHF0010
  1957     05 TITLE-BDINDAS       PIC X(80) VALUE "$ICREGIS/BDINDAS".   VHF0010
  1958     05 TITLE-BDINDIAN      PIC X(80) VALUE "$ICREGIS/BDINDIAN".  VHF0010
  1959     05 TITLE-CONRAZ        PIC X(80)                             GJC0019
  1960                            VALUE "$DATABASE/CONRAZ.DAT".         GJC0019
  1961     05 TITLE-FRALOG        PIC x(80) VALUE "$DATABASE/FRALOG".   GJC0020
  1962     05 TITLE-FRAINQ        PIC X(80) VALUE                       FAC0022
  1963                            "$DATABASE/FRAINQ.DAT".               FAC0022
  1964     05 TITLE-FRAINQGR      PIC X(80) VALUE                       CAV0025
  1965                            "$DATABASE/FRAINQGR.DAT".             CAV0025
  1966     05 TITLE-BDSCORES.                                           FLT0026
  1967        07 FILLER           PIC X(15) VALUE "$SCORES/BDSCORE".    FLT0026
  1968        07 T-FECHA-PROC     PIC 9(04).                            FLT0026
  1969     05 TITLE-ICBPRO        PIC x(80) VALUE "$DATABASE/ICBPRO".   GJC0021
  1970     05 TITLE-DTRLLA        PIC x(80) VALUE "$DATABASE/DTRLLA".
  1971     05 TITLE-DTCLOG        PIC X(80) VALUE "$DATABASE/DTCLOG".   GJC0012
  1972     05 TITLE-DTCCOM        PIC X(80) VALUE "$DATABASE/DTCCOM".   GJC0017
  1973     05 TITLE-DTCING        PIC X(80) VALUE "$DATABASE/DTCING".   VHF0013
  1974     05 TITLE-DTCFAL        PIC X(80) VALUE "$DATABASE/DTCFAL".   VHF0013
  1975     05 TITLE-DTCMDF        PIC X(80) VALUE "$DATABASE/DTCMDF".   VHF0013
  1976     05 TITLE-DTCTRA        PIC X(80) VALUE "$DATABASE/DTCTRA".   VHF0013
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  35
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1977     05 TITLE-BDINBYN       PIC X(80) VALUE "$ICREGIS/BDINBYN".   VHF0011
  1978     05 SI-BDIEMSUP         PIC X(80) VALUE "$DBSUPER/BDIEMSUP".  FAC0012
  1979     05 TITLE-BDIEMSUP      PIC X(80) VALUE "$DBSUPER/BDIESU".    FAC0023
  1980     05 TITLE-UTLESTACT     PIC X(80) VALUE "$DATABASE/UTLESTACT".GLB0042
  1981     05 SI-BDIEENTI         PIC X(80) VALUE "$DBSUPER/BDIEENTI".  FAC0012
  1982     05 SI-BDIEMPER         PIC X(80) VALUE "$DBSUPER/BDIEMPER".  FAC0012
  1983     05 SI-BDIETEMA         PIC X(80) VALUE "$DBSUPER/BDIETEMA".  FAC0012
  1984     05 SI-BDIEAPER         PIC X(80) VALUE "$DBSUPER/BDIEAPER".  FAC0012
  1985     05 SI-BDIEMENT         PIC X(80) VALUE "$DBSUPER/BDIEMENT".  FAC0012
  1986     05 SI-BDIEMOVI         PIC X(80) VALUE "$DBSUPER/BDIEMOVI".  FAC0012
  1987     05 SI-BDIEHSUP         PIC X(80) VALUE "$DBSUPER/BDIEHSUP".  FAC0012
  1988     05 SI-BDIERECL         PIC X(80) VALUE "$DBSUPER/BDIERECL".  FAC0012
  1989     05 SI-BDIEMTOT         PIC X(80) VALUE "$DBSUPER/BDIEMTOT".  FAC0012
  1990     05 NOMBRE-WEB-SAL.                                           FAC0015
  1991        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/WEB-SAL.".     FAC0015
  1992        07 FECHA-WEB-SAL   PIC 9(8).                              FAC0015
  1993     05 NOMBRE-RAS-SAL.                                           FAC0015
  1994        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/RAS-SAL.".     FAC0015
  1995        07 FECHA-RAS-SAL   PIC 9(8).                              FAC0015
  1996     05 NOMBRE-CLAVE-WEB.                                         FAC0015
  1997        07 NOMBRE-WEB-W    PIC X(80) VALUE "$DATABASE/ARCH-WEB".  FAC0015
  1998     05 NOMBRE-RAS-LOG.                                           FAC0015
  1999        07 NOM-RAS-LOG     PIC X(19) VALUE                        FAC0015
  2000                           "$DATOS/WEB-RAS.LOG.".                 FAC0015
  2001        07 FECHA-RAS-LOG   PIC 9(8).                              FAC0015
  2002     05 TITLE-BDIIDIAN     PIC X(80)  VALUE "$DATABASE/BDIIDIAN". FAC0016
  2003     05 TITLE-BDIIREGI     PIC X(80)  VALUE "$ICREGIS/BDIIRE".    FAC0016
  2004     05 TITLE-BDIIDAS      PIC X(80)  VALUE "$DATABASE/BDIIDAS".  FAC0016
  2005     05 TITLE-DTCNHAB      PIC X(80)  VALUE "$DATABASE/DTCNHAB".  VHF0017
  2006     05 TITLE-ICDACT       PIC X(80)  VALUE                       VHF0017
  2007                           "$TEMPORALES/ICDACT.DAT".              VHF0017
  2008     05 NOMBRE-ACTALOG     PIC X(80)  VALUE                       FAC0018
  2009                           "$TRABAJO/logs/ACTALOG".               FAC0018
  2010     05 NOMBRE-VALVEST     PIC X(80)  VALUE                       FAC0018
  2011                           "$TRABAJO/logs/VALVEST.DAT".           FAC0018
  2012     05 NOMBRE-CALIDLOG.                                          CAV0027
  2013        07 NOM-CALIDLOG    PIC X(23)  VALUE                       CAV0027
  2014                           "$TRABAJO/logs/CALIDLOG-".             CAV0027
  2015        07 FCH-CALIDLOG    PIC 9(8).                              CAV0027
  2016     05 NOMBRE-CALIDDRP.                                          CAV0027
  2017        07 NOM-CALIDDRP    PIC X(24) VALUE                        CAV0027
  2018                           "$TEMPORALES/CALIDAD-DRP.".            CAV0027
  2019        07 FCH-CALIDDRP    PIC 9(8).                              CAV0027
  2020     05  MAES-ICMVLR-TITLE.                                       EAL0028
  2021         07 MAES-DIRECTORY1          PIC X(16) VALUE              RGH0029
  2022                                              "$VALORES/ICMVLR-". EAL0028
  2023         07 MAES-FILE1               PIC X(63).                   EAL0028
  2024                                                                  EAL0028
  2025     05  MAES-ICMVLR-TITLE2.                                      EAL0028
  2026         07 MAES-DIRECTORY2          PIC X(16) VALUE              RGH0029
  2027                                              "$VALORES/ICMVLR-". EAL0028
  2028         07 MAES-FILE2               PIC X(63).                   EAL0028
  2029                                                                  EAL0028
  2030     05  MAES-ICMVLR-TITLE3.                                      EAL0028
  2031         07 MAES-DIRECTORY3          PIC X(16) VALUE              RGH0029
  2032                                              "$VALORES/ICMVLR-". EAL0028
  2033         07 MAES-FILE3               PIC X(63).                   EAL0028
  2034                                                                  EAL0028
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  36
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  2035     05  MAES-ICMVLR-TITLE4.                                      EAL0028
  2036         07 MAES-DIRECTORY4          PIC X(16) VALUE              RGH0029
  2037                                              "$VALORES/ICMVLR-". EAL0028
  2038         07 MAES-FILE4               PIC X(63).                   EAL0028
  2039                                                                  EAL0028
  2040     05  MAES-ICMVLR-TITLE5.                                      EAL0028
  2041         07 MAES-DIRECTORY5          PIC X(16) VALUE              RGH0029
  2042                                              "$VALORES/ICMVLR-". EAL0028
  2043         07 MAES-FILE5               PIC X(63).                   EAL0028
  2044                                                                  EAL0028
  2045     05  MAES-ICMVLR-TITLE6.                                      EAL0028
  2046         07 MAES-DIRECTORY6          PIC X(16) VALUE              RGH0029
  2047                                              "$VALORES/ICMVLR-". EAL0028
  2048         07 MAES-FILE6               PIC X(63).                   EAL0028
  2049     05 TITLE-BDLDIRACE  PIC X(80) VALUE "$DATABASE/BDLDIRACE".   RGH0032
  2050     05 TITLE-BDLMAIEXC  PIC X(80) VALUE "$DATABASE/BDLMAIEXC".   RGH0032
  2051     05 TITLE-BDLTELEXC  PIC X(80) VALUE "$DATABASE/BDLTELEXC".   RGH0032
  2052     05 TITLE-BDANOM     PIC X(80) VALUE "$DATABASE/BDANOM".      GJC0034
  2053     05 TITLE-FRZMYR     PIC X(80) VALUE "$DATABASE/FRZMYR".      GJC0033
  2054     05 TITLE-DVPDANE    PIC X(80) VALUE "$DATABASE/DVPDANE.DAT". CAV0035
  2055     05 TITLE-CARACT-IND PIC X(80) VALUE                          CAV0036
  2056                                   "$DATABASE/CARACTUSA-INDCL".   CAV0036
  2057     05 FRABDU-TITLE     PIC X(25) VALUE                          FARF037
  2058                                 "$VALORES/frabduact/FRABDU".     FARF037
  2059     05 FRABDV-TITLE     PIC X(29) VALUE                          FARF037
  2060                                 "$VALORES/frabduact/FRABDU.NEW". FARF037
  2061     05 MAES-ICMHCIIU-TITLE PIC X(80) VALUE "$DATABASE/ICMHCIIU". CAV0038
  2062     05 MAES-ICMCONTTRJ-TITLE PIC X(80) VALUE                     CAV0040
  2063                                    "$DATABASE/ICMCONTTRJ".       CAV0040
  2064     05 TITLE-ICBCOB     PIC X(16) VALUE "$DATABASE/ICBCOB".      GJC0041
  2065     05 TITLE-SCODAPJA   PIC X(37) VALUE "$DATABASE/SCODAPJA".    JJM0043
  2066 01 TITLE-BDSCOREHIS.                                             JJM0043
  2067    02 FILLER          PIC X(21) VALUE "$DATABASE/BDSCOREHIS.".   JJM0043
  2068    02 ANO-ANT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2013.            JJM0043
  2069    02 FILLER                    PIC X(01) VALUE "-".             JJM0043
  2070    02 ANO-ACT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2014.            JJM0043
* 2071 COPY UTLBIT.WS.
  2076 01 VARIABLES-UTLBIT.
  2077    03 I-UTLBIT             PIC 9(5).
  2078    03 POSCAR-UTLBIT        PIC 9(5).
  2079    03 POSFLA-UTLBIT        PIC 9(5).
  2080    03 INPUT-STR-UTLBIT     PIC X(100).
  2081    03 INPUT-LEN-UTLBIT     PIC 9(03).
  2082    03 INPUT-FLA-UTLBIT     PIC 9(03).
  2083    03 INPUT-VAL-UTLBIT     PIC 9(01).
  2084    03 OUTPUT-ERR-UTLBIT    PIC 9(01).
  2085    03 OUTPUT-VAL-UTLBIT    PIC 9(01).
  2086    03 VALOR-UTLBIT         PIC 9(05).
  2087    03 ASCII-UTLBIT         PIC 9(05).
  2088    03 ASCXX-UTLBIT         PIC 9(05).
  2089    03 CAR-UTLBIT           PIC X(01).
  2090 01 CARACTERES-UTLBIT.
  2091    03 FILLER PIC X(16) VALUE X'000102030405060708090A0B0C0D0E0F'.
  2092    03 FILLER PIC X(16) VALUE X'101112131415161718191A1B1C1D1E1F'.
  2093    03 FILLER PIC X(16) VALUE X'202122232425262728292A2B2C2D2E2F'.
  2094    03 FILLER PIC X(16) VALUE X'303132333435363738393A3B3C3D3E3F'.
  2095    03 FILLER PIC X(16) VALUE X'404142434445464748494A4B4C4D4E4F'.
  2096    03 FILLER PIC X(16) VALUE X'505152535455565758595A5B5C5D5E5F'.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  37
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/UTLB
  2097    03 FILLER PIC X(16) VALUE X'606162636465666768696A6B6C6D6E6F'.
  2098    03 FILLER PIC X(16) VALUE X'707172737475767778797A7B7C7D7E7F'.
  2099    03 FILLER PIC X(16) VALUE X'808182838485868788898A8B8C8D8E8F'.
  2100    03 FILLER PIC X(16) VALUE X'909192939495969798999A9B9C9D9E9F'.
  2101    03 FILLER PIC X(16) VALUE X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'.
  2102    03 FILLER PIC X(16) VALUE X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'.
  2103    03 FILLER PIC X(16) VALUE X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'.
  2104    03 FILLER PIC X(16) VALUE X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'.
  2105    03 FILLER PIC X(16) VALUE X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'.
  2106    03 FILLER PIC X(16) VALUE X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'.
  2107 01 FILLER REDEFINES CARACTERES-UTLBIT.
  2108    03 V-UTLBIT OCCURS 256 TIMES PIC X.
* 2109 COPY VALVLR.WS.
  2110* VALVLR-WS.0003
  2111*************************************************************************
  2112* CONTIENE LAS VARIABLES NECESARIAS PARA EL COPY VALCRE.PROC
  2113*************************************************************************
  2114* FAC0002     * SE ADICIONA VARIABLE FLAG-VALVLR PARA MANEJO DE MAPA    *
  2115* FLOR ANGELA * DE BITS                                                 *
  2116* CUADROS     *                                                         *
  2117* MAY.28/2002 *                                                         *
  2118*************************************************************************
  2119* RMB0003     * COLP02- SE ACTIVA LA OCURRENCIA 16 DEL MAPA DE BITS PARA*
  2120* R.MARTINEZ  *         MANEJO DEL CUPO INICIAL COMO USO EXCLUSIVO DEL  *
  2121* JUN.15/2006 *         CLIENTE                                         *
  2122*************************************************************************
  2123 01  FECHA-SITUACION-AUX-VALVLR     PIC 9(06).
  2124 01  FECHA-SITUACION-AUX-R-VALVLR   REDEFINES
  2125                                    FECHA-SITUACION-AUX-VALVLR.
  2126     03 ANO-SITUACION-AUX-VALVLR    PIC 9(04).
  2127     03 MES-SITUACION-AUX-VALVLR    PIC 9(02).
  2128 01  F-ULT-ACT-AUX-VALVLR           PIC 9(06).
  2129 01  F-ULT-ACT-AUX-R-VALVLR         REDEFINES
  2130                                    F-ULT-ACT-AUX-VALVLR.
  2131     03 ANO-ULT-ACT-AUX-VALVLR      PIC 9(04).
  2132     03 MES-ULT-ACT-AUX-VALVLR      PIC 9(02).
  2133 01  FEC-NOVEDAD-AUX-VALVLR         PIC 9(06).
  2134 01  FEC-NOVEDAD-AUX-R-VALVLR REDEFINES FEC-NOVEDAD-AUX-VALVLR.
  2135     03 ANO-NOVEDAD-AUX-VALVLR      PIC 9(04).
  2136     03 MES-NOVEDAD-AUX-VALVLR      PIC 9(02).
  2137 01  FECHA-ACT-VALOR-AUX-VALVLR     PIC 9(06).
  2138 01  FECHA-ACT-VALOR-AUX-R-VALVLR
  2139     REDEFINES               FECHA-ACT-VALOR-AUX-VALVLR.
  2140     03 ANO-ACT-VALOR-AUX-VALVLR    PIC 9(04).
  2141     03 MES-ACT-VALOR-AUX-VALVLR    PIC 9(02).
  2142 01  FEC-4-MA-VALVLR                PIC 9(04).
  2143 01  FEC-4-MA-R-VALVLR       REDEFINES FEC-4-MA-VALVLR.
  2144     03 MES-4-MA-VALVLR             PIC 9(02).
  2145     03 ANO-4-MA-VALVLR             PIC 9(02).
  2146 01  FEC-6-MA-VALVLR                PIC 9(06).
  2147 01  FEC-6-MA-R-VALVLR            REDEFINES FEC-6-MA-VALVLR.
  2148     03 MES-6-MA-VALVLR             PIC 9(02).
  2149     03 ANO-6-MA-VALVLR .
  2150        04 SIG-6-MA-VALVLR          PIC 9(02).
  2151        04 ANO2-6-MA-VALVLR         PIC 9(02).
  2152 01  FEC-6-AM-VALVLR                PIC 9(06).
  2153 01  FEC-6-AM-R-VALVLR            REDEFINES FEC-6-AM-VALVLR.
  2154     03 SIG-6-AM-VALVLR             PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  38
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  2155     03 ANO-6-AM-VALVLR             PIC 9(02).
  2156     03 MES-6-AM-VALVLR             PIC 9(02).
  2157 01  IND-VALORES-VALVLR             PIC 9(01) VALUE 0.
  2158 01  FLAG-VALVLR                    PIC 9(02) VALUE 0.            FAC0002
  2159 01  VECTOR-VALORES-VALVLR.
  2160     03 VEC-VALOR-VALVLR            PIC 9(01) OCCURS 16 TIMES.    RMB0003
  2161 01  VECTOR-ACTIVADO-VALVLR         PIC X(16) VALUE               RMB0003
  2162                                             "1111111111111110".  RMB0003
  2163*------------------------------------------------------------*
* 2164  COPY PE-TIME.WS.
  2165*PE-TIME.WS.v.01.0001.
  2166*----------------------------------------------------------------*
  2167*
  2168*    COPY  WORKING  PROCESOS ESPECIALES VERSION OCT/2004
  2169*
  2170*----------------------------------------------------------------*
  2171*    COPY AREA DE LOG PARA CONTROL DE TIEMPOS
  2172*----------------------------------------------------------------*
  2173
  2174*-----------------------------------------------------------*
  2175*      VARIABLES DE   LOG  DE EJECUCION
  2176*-----------------------------------------------------------*
  2177 01  W-RETORNO-LOG.
  2178     03 W-STATUS-LOG            PIC  9(02) VALUE ZEROS.
  2179     03 W-ARCHIVO-LOG.
  2180        05 W-ENTIDAD-LOG        PIC  X(03) VALUE SPACES.
  2181        05 W-FILLER-LOG         PIC  X(27) VALUE SPACES.
  2182     03 W-PROGRAMA              PIC  X(20) VALUE SPACES.
  2183     03 W-FECHA-HORA-INI.
  2184        05 W-FECHA-INI          PIC  X(10) VALUE SPACES.
  2185        05 W-HORA-INI           PIC  X(08) VALUE SPACES.
  2186     03 W-FECHA-HORA-FIN.
  2187        05 W-FECHA-FIN          PIC  X(10) VALUE SPACES.
  2188        05 W-HORA-FIN           PIC  X(08) VALUE SPACES.
  2189     03 W-USER-UNIX             PIC  9(06) VALUE ZEROS.
  2190*-----------------------------------------------------------*
  2191*      VARIABLES DE TIEMPO DE EJECUCION
  2192*-----------------------------------------------------------*
  2193 01  FECHAS-LOG.
  2194     03  HORA-SIS               PIC  9(08).
  2195     03  HORA-SIS-R  REDEFINES  HORA-SIS.
  2196         05  HORA-S             PIC  9(02).
  2197         05  MINU-S             PIC  9(02).
  2198         05  SEGU-S             PIC  9(02).
  2199         05  DESE-S             PIC  9(02).
  2200     03  FECHA-S                PIC  9(08).
  2201     03  FECHA-CURRENT-DATE  REDEFINES  FECHA-S.
  2202         05  FECHA-SISTEMA      PIC  X(8).
  2203     03  FECHA-S-R           REDEFINES  FECHA-S.
  2204         05 ANIO-S             PIC  9(04).
  2205         05 ANIO-S-R         REDEFINES  ANIO-S.
  2206            07  ANIO-SIG1      PIC  9(02).
  2207            07  ANIO-SIG2      PIC  9(02).
  2208         05 MESE-S             PIC  9(02).
  2209         05 DIAS-S             PIC  9(02).
  2210     03 FECHA-PG.
  2211        05 ANIO-P              PIC  9(04)     VALUE ZEROS.
  2212        05 SLASH-1             PIC  X(01)     VALUE "/".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  39
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/PE-T
  2213        05 MESE-P              PIC  9(02)     VALUE ZEROS.
  2214        05 SLASH-2             PIC  X(01)     VALUE "/".
  2215        05 DIAS-P              PIC  9(02)     VALUE ZEROS.
  2216     03 HORA-PG.
  2217        05 HORA-P              PIC  9(02)     VALUE ZERO.
  2218        05 DOSPUNTO-1          PIC  X(01)     VALUE ":".
  2219        05 MINU-P              PIC  9(02)     VALUE ZERO.
  2220        05 DOSPUNTO-2          PIC  X(01)     VALUE ":".
  2221        05 SEGU-P              PIC  9(02)     VALUE ZEROS.
  2222*------------------------------------------------------------*
  2223 01  w-msup-ind-bloq-n           PIC 9(01) VALUE zeros.
  2224 01  w-msup-ind-bloq-x redefines w-msup-ind-bloq-n
  2225                                 PIC x(01).
  2226*------------------------------------------------------------*
  2227 01  ARCHIVOS.
  2228     03 ARCHIVO-ENTRADA.
  2229        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2230        05 ARCH-ENTRADA       PIC X(30) VALUE  SPACES.
  2231     03 ARCHIVO-INCONC.
  2232        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2233        05 ARCH-INCONC        PIC X(30) VALUE  SPACES.
  2234     03 ARCHIVO-SALIDA.
  2235        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2236        05 ARCH-SALIDA        PIC X(30) VALUE  SPACES.
  2237     03 ARCHIVO-ESTADIS.
  2238        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2239        05 ARCH-ESTADIS       PIC X(30) VALUE  SPACES.
  2240*------------------------------------------------------------*
  2241 01  TABLAS-EVALUACION.
  2242     03  TABLA-NOVEDADES-CARTERA.
  2243         05  FILLER  PIC X(23) VALUE  "0101NORMAL.-.AL.DIA1   ".
  2244         05  FILLER  PIC X(23) VALUE  "0202TARJ. NO.RECLAM1   ".
  2245         05  FILLER  PIC X(23) VALUE  "0803CANCEL.MAL.MANE1   ".
  2246         05  FILLER  PIC X(23) VALUE  "0404TARJETA.ROBADA 1   ".
  2247         05  FILLER  PIC X(23) VALUE  "0505CANCEL.VOLUNTAR1   ".
  2248         05  FILLER  PIC X(23) VALUE  "0606CANCEL.MMX<60  1   ".
  2249         05  FILLER  PIC X(23) VALUE  "0707TARJ.EXTRAV.   1   ".
  2250         05  FILLER  PIC X(23) VALUE  "0308PAGO VOLUNT.SAT1   ".
  2251         05  FILLER  PIC X(23) VALUE  "0309PAGO.MMX.A.30  1   ".
  2252         05  FILLER  PIC X(23) VALUE  "0310PAGO.MMX.A.60  1   ".
  2253         05  FILLER  PIC X(23) VALUE  "0311PAGO.MORA.90   1   ".
  2254         05  FILLER  PIC X(23) VALUE  "0312PAGO.VOL.MOR1201   ".
  2255         05  FILLER  PIC X(23) VALUE  "0113MORA.30.AL.DIA 1   ".
  2256         05  FILLER  PIC X(23) VALUE  "0114MORA.60.AL.DIA 1   ".
  2257         05  FILLER  PIC X(23) VALUE  "0115MORA.90.AL.DIA 1   ".
  2258         05  FILLER  PIC X(23) VALUE  "0116MORA.120.AL.DIA1   ".
  2259         05  FILLER  PIC X(23) VALUE  "1217ESTA.MORA.30   1   ".
  2260         05  FILLER  PIC X(23) VALUE  "1318ESTA.MORA.60   1   ".
  2261         05  FILLER  PIC X(23) VALUE  "1419ESTA.MORA.90   1   ".
  2262         05  FILLER  PIC X(23) VALUE  "1520ESTA.MORA.120  1   ".
  2263         05  FILLER  PIC X(23) VALUE  "1221FU.60.Y.ESTA.301   ".
  2264         05  FILLER  PIC X(23) VALUE  "1222FU.90.Y.ESTA.301   ".
  2265         05  FILLER  PIC X(23) VALUE  "1323FU.90.Y.ESTA.601   ".
  2266         05  FILLER  PIC X(23) VALUE  "1224FU.120.ESTA.30 1   ".
  2267         05  FILLER  PIC X(23) VALUE  "1325FU.120.ESTA.60 1   ".
  2268         05  FILLER  PIC X(23) VALUE  "1426FU.120.ESTA.90 1   ".
  2269         05  FILLER  PIC X(23) VALUE  "1327RE.30.ESTA.60  1   ".
  2270         05  FILLER  PIC X(23) VALUE  "1428RE.30.Y.ESTA.901   ".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  40
* S))D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-T
  2271         05  FILLER  PIC X(23) VALUE  "1529RE.30.ESTA.120 1   ".
  2272         05  FILLER  PIC X(23) VALUE  "1230RE.60.Y.ESTA.301   ".
  2273         05  FILLER  PIC X(23) VALUE  "1331RE.60.Y.ESTA.601   ".
  2274         05  FILLER  PIC X(23) VALUE  "1432RE.60.Y.ESTA.901   ".
  2275         05  FILLER  PIC X(23) VALUE  "1533RE.60.ESTA.120 1   ".
  2276         05  FILLER  PIC X(23) VALUE  "1234RE.90.Y.ESTA.301   ".
  2277         05  FILLER  PIC X(23) VALUE  "1335RE.90.Y.ESTA.601   ".
  2278         05  FILLER  PIC X(23) VALUE  "1436RE.90.Y.ESTA.901   ".
  2279         05  FILLER  PIC X(23) VALUE  "1537RE.90.ESTA.120 1   ".
  2280         05  FILLER  PIC X(23) VALUE  "1238RE.120.ESTA.30 1   ".
  2281         05  FILLER  PIC X(23) VALUE  "1339RE.120.ESTA.60 1   ".
  2282         05  FILLER  PIC X(23) VALUE  "1440RE.120.ESTA.90 1   ".
  2283         05  FILLER  PIC X(23) VALUE  "1541RE.120.ESTA.1201   ".
  2284         05  FILLER  PIC X(23) VALUE  "2042ADJ.NO.LOCALIZA1   ".
  2285         05  FILLER  PIC X(23) VALUE  "2143ADJ.CTA.COBRADO1   ".
  2286         05  FILLER  PIC X(23) VALUE  "2244FALLECIDO      0   ".
  2287         05  FILLER  PIC X(23) VALUE  "0945CARTERA.CASTIGA1   ".
  2288         05  FILLER  PIC X(23) VALUE  "1046CARTERA.RECUPER1   ".
  2289         05  FILLER  PIC X(23) VALUE  "1147DUDOSO.RECAUDO 1   ".
  2290         05  FILLER  PIC X(23) VALUE  "2348CONSULTA       0   ".
  2291         05  FILLER  PIC X(23) VALUE  "4949NO RENOVADA    1   ".
  2292         05  FILLER  PIC X(23) VALUE  "50                 0   ".
  2293     03  TABLA-NOVEDADES-CARTERA-R  REDEFINES
  2294         TABLA-NOVEDADES-CARTERA.
  2295         05  TAB-NOVEDADES-CARTERA  OCCURS  50  TIMES.
  2296             07  TAB-NOV-CART-CODINT PIC 9(02).
  2297             07  TAB-NOV-CART-COD    PIC 9(02).
  2298             07  TAB-NOV-CART-NOM    PIC X(15).
  2299             07  TAB-NOV-CART-CAL    PIC 9(01).
  2300             07  TAB-NOV-CART-RAN    PIC 9(02).
  2301             07  TAB-NOV-CART-CAL2   PIC 9(01).
  2302
  2303     03  TABLA-NOVEDADES-CTA-CTE.
  2304         05 FILLER  PIC X(23) VALUE  "3001NORMAL.-.AL.DIA1   ".
  2305         05 FILLER  PIC X(23) VALUE  "3102CANCEL.MAL.MANE1   ".
  2306         05 FILLER  PIC X(23) VALUE  "0003               0   ".
  2307         05 FILLER  PIC X(23) VALUE  "0004               0   ".
  2308         05 FILLER  PIC X(23) VALUE  "3205SALDADA        1   ".
  2309         05 FILLER  PIC X(23) VALUE  "3306EMBARGADA      1   ".
  2310         05 FILLER  PIC X(23) VALUE  "3507EMBARGADA.NORMA1   ".
  2311         05 FILLER  PIC X(23) VALUE  "0008               0   ".
  2312         05 FILLER  PIC X(23) VALUE  "3409INACTIVA       1   ".
  2313     03  TABLA-NOVEDADES-CTA-CTE-R  REDEFINES
  2314         TABLA-NOVEDADES-CTA-CTE.
  2315         05  TAB-NOVEDADES-CTA-CTE  OCCURS   9  TIMES.
  2316             07  TAB-NOV-CTAC-CODINT PIC 9(02).
  2317             07  TAB-NOV-CTAC-COD    PIC 9(02).
  2318             07  TAB-NOV-CTAC-NOM    PIC X(15).
  2319             07  TAB-NOV-CTAC-CAL    PIC 9(01).
  2320             07  TAB-NOV-CTAC-RAN    PIC 9(02).
  2321             07  TAB-NOV-CTAC-CAL2   PIC 9(01).
  2322
  2323     03  TABLA-ENDEUDAMIENTO.
  2324         05  FILLER  PIC X(23) VALUE  "24A NORMAL         1   ".
  2325         05  FILLER  PIC X(23) VALUE  "25B SUB-NORMAL     1   ".
  2326         05  FILLER  PIC X(23) VALUE  "26C DEFICIENTE     1   ".
  2327         05  FILLER  PIC X(23) VALUE  "27D DIFICIL-COBRO  1   ".
  2328         05  FILLER  PIC X(23) VALUE  "28E IRRECUPERABLE  1   ".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  41
* S))D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-T
  2329         05  FILLER  PIC X(23) VALUE  "29+ CONTINGENCIA   0   ".
  2330         05  FILLER  PIC X(23) VALUE  "00T                0   ".
  2331         05  FILLER  PIC X(23) VALUE  "00R                0   ".
  2332     03  TABLA-ENDEUDAMIENTO-R      REDEFINES
  2333         TABLA-ENDEUDAMIENTO.
  2334         05  TAB-ENDEUDAMIENTO      OCCURS   8  TIMES.
  2335             07  TAB-END-CODINT     PIC 9(02).
  2336             07  TAB-END-COD        PIC X(01).
  2337             07  TAB-END-NOM        PIC X(16).
  2338             07  TAB-END-CAL        PIC 9(01).
  2339             07  TAB-END-RAN        PIC 9(02).
  2340             07  TAB-END-CAL2       PIC 9(01).
  2341*------------------------------------------------------------*
  2342 01 TABLA-VIGENTES.
  2343     03  tabla-vigentes-cartera.
  2344         05 filler        PIC x(10)   VALUE  "1000000000".
  2345         05 filler        PIC x(10)   VALUE  "0011111111".
  2346         05 filler        PIC x(10)   VALUE  "1111111111".
  2347         05 filler        PIC x(10)   VALUE  "1111111111".
  2348         05 filler        PIC x(10)   VALUE  "1111101101".
  2349     03  tabla-vigentes-cartera-r redefines
  2350         tabla-vigentes-cartera.
  2351         05 tab-vigentes-cartera   occurs 50 times  PIC 9(01).
  2352*------------------------------------------------------------*
  2353 01 TABLA-TIPO-CARTERA.
  2354     03 W-TIPO-CARTERA.
  2355        05 FILLER  PIC 9(07) VALUE 0101000.
  2356        05 FILLER  PIC 9(07) VALUE 0201000.
  2357        05 FILLER  PIC 9(07) VALUE 0301000.
  2358        05 FILLER  PIC 9(07) VALUE 0402000.
  2359        05 FILLER  PIC 9(07) VALUE 0501000.
  2360        05 FILLER  PIC 9(07) VALUE 0603000.
  2361        05 FILLER  PIC 9(07) VALUE 0701000.
  2362        05 FILLER  PIC 9(07) VALUE 0802000.
  2363        05 FILLER  PIC 9(07) VALUE 0902000.
  2364        05 FILLER  PIC 9(07) VALUE 1002000.
  2365        05 FILLER  PIC 9(07) VALUE 1102000.
  2366        05 FILLER  PIC 9(07) VALUE 1202000.
  2367        05 FILLER  PIC 9(07) VALUE 1301000.
  2368        05 FILLER  PIC 9(07) VALUE 1401000.
  2369        05 FILLER  PIC 9(07) VALUE 1502000.
  2370        05 FILLER  PIC 9(07) VALUE 1602000.
  2371        05 FILLER  PIC 9(07) VALUE 1701000.
  2372        05 FILLER  PIC 9(07) VALUE 1801000.
  2373        05 FILLER  PIC 9(07) VALUE 1902000.
  2374        05 FILLER  PIC 9(07) VALUE 2001000.
  2375        05 FILLER  PIC 9(07) VALUE 2102000.
  2376        05 FILLER  PIC 9(07) VALUE 2202000.
  2377        05 FILLER  PIC 9(07) VALUE 2304000.
  2378        05 FILLER  PIC 9(07) VALUE 2402000.
  2379        05 FILLER  PIC 9(07) VALUE 2501000.
  2380        05 FILLER  PIC 9(07) VALUE 2602000.
  2381        05 FILLER  PIC 9(07) VALUE 2703000.
  2382        05 FILLER  PIC 9(07) VALUE 2802000.
  2383        05 FILLER  PIC 9(07) VALUE 2902000.
  2384     03 W-TIPO-CARTERA-R REDEFINES W-TIPO-CARTERA.
  2385        05 W-TIPO-CART OCCURS 29 TIMES.
  2386           07 W-CART-CONSEC          PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  42
* S))D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-T
  2387           07 W-CART-TIPO            PIC 9(02).
  2388           07 W-FLAG-EVALUA-SN       PIC 9(01).
  2389           07 W-FLAG-MESES-CONTEM    PIC 9(02).
  2390
  2391*---------------------------------------------------- *
* 2392 COPY  LEEMAESTROS.WS.                                            GDT0001
  2393*LEEMAESTROS.WS.v.0003.
  2394********************************************************************
  2395* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
  2396* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
  2397* AMNISTIA (AMNISTIA21.WS).
  2398********************************************************************
  2399* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
  2400* G.JIMENEZ  *          ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
  2401* MAY 18/2009*                                                       *
  2402**********************************************************************
  2403* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
  2404* G.JIMENEZ  *          BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
  2405* AGO 25/2009*          NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
  2406*            *          PES,ETC) SI LAS DEBEN TENER EN CUENTA        *
  2407**********************************************************************
* 2408 COPY BDAMATCH.WS.
  2409*BDAMATCH-WS.v.0003.
  2410********************************************************************
  2411* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
  2412* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS
  2413* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
  2414********************************************************************
  2415* RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE
  2416*         *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO
  2417********************************************************************
  2418* RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
  2419* R-MARTINEZ. *          DEL PORTAFOLIO .                          *
  2420* 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  *
  2421*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH          *
  2422*             * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *
  2423********************************************************************
  2424 01 VARIABLES-MAQ.                                                RMB0003
  2425     03 I-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
  2426     03 J-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
  2427     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.              RMB0003
  2428     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.         RMB0003
  2429     03 NOMBRE-OUTMAQ-OK         PIC X(45)  VALUE SPACES.         RMB0003
  2430     03 NOMBRE-INPMAQ-X.                                          RMB0003
  2431        04 FILLER                PIC X(02)  VALUE "A ".           RMB0003
  2432        04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.         RMB0003
  2433     03 PARTICULAS-INPMAQ.                                        RMB0003
  2434        04 BASURA-INPMAQ            PIC X(45).                    RMB0003
  2435        04 P1-INPMAQ                PIC X(45).                    RMB0003
  2436        04 P2-INPMAQ                PIC X(45).                    RMB0003
  2437        04 P3-INPMAQ                PIC X(45).                    RMB0003
  2438        04 P4-INPMAQ                PIC X(45).                    RMB0003
  2439        04 P5-INPMAQ                PIC X(45).                    RMB0003
  2440        04 P6-INPMAQ                PIC X(45).                    RMB0003
  2441        04 P7-INPMAQ                PIC X(45).                    RMB0003
  2442        04 P8-INPMAQ                PIC X(45).                    RMB0003
  2443        04 P9-INPMAQ                PIC X(45).                    RMB0003
  2444        04 P10-INPMAQ               PIC X(45).                    RMB0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  43
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2445 01  SIG-MAQ                     PIC X(1).                        RMB0003
  2446     88 SIG-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
  2447 01  ANT-MAQ                     PIC X(1).                        RMB0003
  2448     88 ANT-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
  2449 01  ACTUAL-MAQ                  PIC X(1).                        RMB0003
  2450     88 TILDE-MAQ   VALUE "Á" "É" "Í" "Ó" "Ú" "á" "é" "í" "ó" "ú".RMB0003
  2451     88 QUITAR-MAQ  VALUE  "'" "´"  "`" '"' .                     RMB0003
  2452     88 BORRAR-MAQ  VALUE "-" "." "1" "2" "3" "4"                 RMB0003
  2453                          "5" "6" "7" "8" "9" '0' ")" "," .       RMB0003
  2454     88 ELIMINAR-MAQ VALUE "(" .                                  RMB0003
  2455     88 VALIDO-MAQ   VALUE "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"RMB0003
  2456                           "K" "L" "M" "N" "O" "P" "Q" "R" "S"    RMB0003
  2457                           "T" "U" "V" "W" "X" "Y" "Z" " ".       RMB0003
  2458 01 LLAVE-AUX11-BDAMATCH.
  2459    02  TIPO-ID-AUX11-BDAMATCH    PIC 9(01).
  2460    02  NUM-ID-AUX11-BDAMATCH     PIC 9(11).
  2461    02  COD-SUS-AUX11-BDAMATCH    PIC 9(06).
  2462    02  COD-CTA-AUX11-BDAMATCH    PIC 9(02).
  2463    02  NUM-CTA-AUX11-BDAMATCH    PIC X(18).
  2464 01 LLAVE-AUX13-BDAMATCH.
  2465    02  TIPO-ID-AUX13-BDAMATCH    PIC 9(01).
  2466    02  NUM-ID-AUX13-BDAMATCH     PIC 9(13).
  2467    02  COD-SUS-AUX13-BDAMATCH    PIC 9(06).
  2468    02  COD-CTA-AUX13-BDAMATCH    PIC 9(02).
  2469    02  NUM-CTA-AUX13-BDAMATCH    PIC X(18).
  2470 01 VARIABLES-BDAMATCH.
  2471    02 I2-BDAMATCH                PIC 9(2).                       RMB0003
  2472    02 TIPCTA-BDAMATCH.                                           RMB0003
  2473*******2=CK,1=CR,2=BS,3=CC,4=OT,9=INVALIDO                        RMB0003
  2474       03 FILLER PIC X(30) VALUE "211422244444224442444433442444".RMB0003
  2475       03 FILLER PIC X(30) VALUE "444444444444444444442999999999".RMB0003
  2476       03 FILLER PIC X(30) VALUE "999999999999999999999999999999".RMB0003
  2477       03 FILLER PIC X(10) VALUE "9999999999".                    RMB0003
  2478    02 FILLER REDEFINES TIPCTA-BDAMATCH.                          RMB0003
  2479       03 V-TIPCTA-BDAMATCH  OCCURS 100 TIMES PIC 9.              RMB0003
  2480    02 APELLIDO-INPUT-BDAMATCH    PIC X(60) VALUE SPACES.         RMB0003
  2481    02 ENT-FIN-PORT-BDAMATCH      PIC 9(3)  VALUE 0.              RMB0003
  2482    02 ENT-UNICAS-PORT-BDAMATCH   PIC 9(3)  VALUE 0.              RMB0003
  2483    02 ENT-FIN-MEJ-PORT-BDAMATCH  PIC 9(3)  VALUE 0.              RMB0003
  2484    02 FALLECIDO-BDAMATCH         PIC 9(01) VALUE 0.              RMB0002
  2485    02 IDE-TIPO-BDAMATCH          PIC 9(01) VALUE 0.
  2486    02 ABIERTO-BDAMATCH           PIC 9(01) VALUE 0.
  2487    02 PROCESAR-BDAMATCH          PIC 9(01) VALUE 0.
  2488    02 FIN-BDAMATCH               PIC 9(01) VALUE 0.
  2489    02 NUM-IDE-INPUT-BDAMATCH     PIC 9(11).
  2490    02 TIP-IDE-INPUT-BDAMATCH     PIC 9(01).
  2491    02 I-GRU-BDAMATCH             PIC 9(5) VALUE 0.
  2492    02 GRU-NOM-BDAMATCH           PIC 9(5) VALUE 0.
  2493    02 MOVIDO-BDAMATCH            PIC 9(1) VALUE 0.
  2494    02 BUSCADO-D-BDAMATCH.
  2495       03 BUSCADO-BDAMATCH        PIC 9(3) VALUE 0.
  2496       03 FILLER                  PIC X(1) VALUE " ".
  2497    02 PORINSERTAR-D-BDAMATCH.
  2498       03 PORINSERTAR-BDAMATCH    PIC 9(03) VALUE 0.
  2499       03 FILLER                  PIC X(1) VALUE " ".
  2500    02 EXISTE-BDAMATCH            PIC 9(05) VALUE 0.
  2501    02 MEJOR-PORTAFOLIO-BDAMATCH  PIC 9(05) VALUE 0.
  2502    02 GRU-ANT-BDAMATCH           PIC 9(05) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  44
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2503    02 MAX-CUENTAS-BDAMATCH       PIC 9(05) VALUE 5.
  2504    02 MAX-REL-BDAMATCH           PIC 9(05) VALUE 5.
  2505    02 MAXREL-PER-BDAMATCH        PIC 9(05) VALUE 0.
  2506    02 FIN-FUENTE-BDAMATCH        PIC 9(05) VALUE 0.
  2507    02 FIL-BUS-BDAMATCH           PIC 9(05) VALUE 0.
  2508    02 COL-BUS-BDAMATCH           PIC 9(05) VALUE 0.
  2509    02 FIN-BUSCADO-BDAMATCH       PIC 9(05) VALUE 0.
  2510    02 LIBRE-BUSCADO-BDAMATCH     PIC 9(05) VALUE 0.
  2511    02 FIL-FUE-BDAMATCH           PIC 9(05) VALUE 0.
  2512    02 COL-FUE-BDAMATCH           PIC 9(05) VALUE 0.
  2513    02 I-BDAMATCH                 PIC 9(08) VALUE 0.
  2514    02 J-BDAMATCH                 PIC 9(08) VALUE 0.
  2515    02 I-DIR-BDAMATCH             PIC 9(05) VALUE 0.
  2516    02 I-TEL-BDAMATCH             PIC 9(05) VALUE 0.
  2517    02 I-NOM-BDAMATCH             PIC 9(05) VALUE 0.
  2518    02 I-CTA-BDAMATCH             PIC 9(05) VALUE 0.
  2519    02 NUM-DIR-ANT-BDAMATCH       PIC X(50).
  2520    02 NUM-TEL-ANT-BDAMATCH       PIC 9(15).
  2521    02 CTA-DIR-ANT-BDAMATCH       PIC 9(05).
  2522    02 CTA-TEL-ANT-BDAMATCH       PIC 9(05).
  2523    02 CTA-NOM-ANT-BDAMATCH       PIC 9(05).
  2524    02 GRU-NOM-ANT-BDAMATCH       PIC 9(05).
  2525    02 TABLA-DIR-BDAMATCH.
  2526       03 T-DIR-BDAMATCH OCCURS 501 TIMES.
  2527          04 CTA-DIR-BDAMATCH     PIC 9(03).
  2528          04 NUM-DIR-BDAMATCH     PIC X(50).
  2529          04 NUM-CTAS-DIR-BDAMATCH PIC 9(03).
  2530          04 SUS-DIR-BDAMATCH     PIC 9(06).
  2531          04 LNG-DIR-BDAMATCH     PIC 9(03).
  2532    02 TABLA-TEL-BDAMATCH.
  2533       03 T-TEL-BDAMATCH   OCCURS 501 TIMES.
  2534          04 CTA-TEL-BDAMATCH     PIC 9(03).
  2535          04 NUM-TEL-BDAMATCH     PIC 9(15).
  2536          04 NUM-CTAS-TEL-BDAMATCH PIC 9(03).
  2537          04 SUS-TEL-BDAMATCH     PIC 9(06).
  2538    02 TABLA-NOM-BDAMATCH.
  2539       03 T-NOM-BDAMATCH OCCURS 501 TIMES.
  2540          04 CTA-NOM-BDAMATCH     PIC 9(03).
  2541          04 NOM-NOM-BDAMATCH     PIC X(60).
  2542          04 SUS-NOM-BDAMATCH     PIC 9(06).
  2543          04 GRU-NOMS-BDAMATCH     PIC 9(03).
  2544          04 LNG-NOM-BDAMATCH     PIC 9(02).
  2545    02 TABLA-CUENTAS-BDAMATCH.
  2546       03 T-CUENTAS-BDAMATCH OCCURS 501 TIMES.
  2547          04 CTA-CUENTAS-BDAMATCH PIC X(38).
  2548          04 CTA-FALLECIDO-BDAMATCH   PIC 9(1).                   RMB0002
  2549          04 FUEEXT-CUENTAS-BDAMATCH   PIC 9(1).                  RMB0003
  2550    02 TABLA-GRUNOM-BDAMATCH.
  2551       03 T-GRUNOM-BDAMATCH OCCURS 501 TIMES.
  2552          04 GRUPO-GRUNOM-BDAMATCH PIC 9(03).
  2553          04 NOM-GRUNOM-BDAMATCH   PIC X(60).
  2554          04 NUM-CTAS-GRUNOM-BDAMATCH PIC 9(03).
  2555          04 LNG-GRUNOM-BDAMATCH   PIC 9(02).
  2556          04 APE-GRUNOM-BDAMATCH   PIC 9(03).                     RMB0003
  2557    02  WS-PESOS-CUENTAS-BDAMATCH.
  2558      03  ESTA-CTA-BDAMATCH        PIC  9(01)  VALUE  ZEROS.
  2559      03  INV-BDAMATCH             PIC 9(04) VALUE ZEROS.
  2560      03  SUSC-CTAS-BDAMATCH       PIC 9(06) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  45
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2561      03  SUSC-GRUPO-BDAMATCH.
  2562        05  SUSC-GRUP-SUS-BDAMATCH PIC  9(06)  VALUE  ZEROS.
  2563        05  SUSC-GRUP-GRU-BDAMATCH PIC  9(03)  VALUE  ZEROS.
  2564      03  PESO-CTAS-TOT-BDAMATCH   PIC 9(12) VALUE ZEROS.
  2565      03  PESOS-CTRL-BDAMATCH      PIC 9(12) VALUE ZEROS.
  2566      03  NOM-LIMPI-BDAMATCH       PIC X(60) VALUE SPACES.
  2567      03  CTA-A-BUSCAR-BDAMATCH    PIC 9(03) VALUE ZEROS.
  2568      03  PESO-TEL-BDAMATCH        PIC 9(02) VALUE 1.
  2569      03  PESO-DIR-BDAMATCH        PIC 9(02) VALUE 3.
  2570      03  PESO-NOM-BDAMATCH        PIC 9(02) VALUE 9.
  2571      03  POSIC-TEL-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2572      03  POSIC-DIR-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2573      03  POSIC-NOM-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2574      03  POSIC-GRU-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2575      03  NRO-VECES-1-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2576      03  NRO-VECES-2-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2577      03  NRO-VECES-3-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2578      03  POSIC-SUMA-BDAMATCH      PIC 9(03) VALUE ZEROS.
  2579      03  POSIC-SUSC-BDAMATCH      PIC 9(03) VALUE ZEROS.
  2580      03  POSIC-SUS-GRU-BDAMATCH   PIC 9(03) VALUE ZEROS.
  2581 01 V-INTERRELAC-BDAMATCH.
  2582    02 CARAC-REL-BDAMATCH  OCCURS 501 TIMES PIC X(03).
  2583    02 FILA-REL-BDAMATCH OCCURS 501 TIMES.
  2584       03 COLUMNA-REL-BDAMATCH OCCURS 501 TIMES.
  2585          04 CAJA-BDAMATCH         PIC 9(03).
  2586          04 DELIMITADOR-BDAMATCH  PIC X(01).
  2587 01 VARIABLES-NOMBRES-BDAMATCH.
  2588    03 LIM-BDAMATCH                PIC  9(03) VALUE 500.
  2589    03 DIR-INPUT-BDAMATCH          PIC  X(60).
  2590    03 DIR-OUTPUT-BDAMATCH         PIC  X(60).
  2591    03 CTA-INPUT-BDAMATCH          PIC  X(38).
  2592    03 TEL-INPUT-BDAMATCH          PIC  9(15).
  2593    03 TEL-OUTPUT-BDAMATCH         PIC  9(15).
  2594    03 NOM-INPUT-BDAMATCH          PIC  X(60).
  2595    03 NOM-OUTPUT-BDAMATCH         PIC  X(60).
  2596    03 NUM-MUERTOS-OUTPUT-BDAMATCH PIC  9(03).                    RMB0002
  2597    03 NUM-CTAS-OUTPUT-BDAMATCH    PIC  9(03).                    RMB0002
  2598    03 VALCTA-OUTPUT-BDAMATCH      PIC  9(01).
  2599    03 CAR-ANT-BDAMATCH            PIC  X(01).
  2600    03 CAR-ACT-BDAMATCH            PIC  9(01).
  2601    03 T-CARDIR-BDAMATCH.
  2602       04 V-CARDIR-BDAMATCH       OCCURS 60 TIMES PIC X(01).
  2603    03 T-CARTOT-BDAMATCH.
  2604       04 V-CARTOT-BDAMATCH       OCCURS 10 TIMES PIC 9(05).
  2605 01  TABLA-SUSC-DIR-BDAMATCH.
  2606   03  REG-SUSC-DIR-BDAMATCH   OCCURS 501 TIMES
  2607       ASCENDING KEY IS COD-SUSC-DIR-BDAMATCH  INDEXED BY
  2608                                               IND-DIR-BDAMATCH.
  2609     05  COD-SUSC-DIR-BDAMATCH     PIC 9(06).
  2610     05  FLAG-YA-CTA-BDAMATCH      PIC 9(01).
  2611     05  FLAG-YA-DIR-BDAMATCH      PIC 9(01).
  2612     05  FLAG-YA-TEL-BDAMATCH      PIC 9(01).
  2613     05  FLAG-YA-NOM-BDAMATCH      PIC 9(01).
  2614 01  TABLA-SUSC-NOMBRE-BDAMATCH.
  2615   03  REG-SUSC-NOM-BDAMATCH        OCCURS 501 TIMES
  2616       ASCENDING  KEY  IS  KEY-SUSC-NOM-BDAMATCH  INDEXED
  2617                           BY IND-NOM-BDAMATCH.
  2618     05  KEY-SUSC-NOM-BDAMATCH.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  46
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2619       07  COD-SUSC-NOM-BDAMATCH   PIC 9(06).
  2620       07  GRUPO-SUS-NOM-BDAMATCH  PIC 9(03).
* 2621 COPY AMNISTIA21.WS.
  2622* AMNISTIA21.v.0004
  2623*******************************************************************
  2624* VARIABLES DEFINIDAS PARA APLICACION DE LEYES, AMNISTIA, PARA
  2625* CLEENTES SEGUN FECHA DE PROMULGACION DE LA LEY
  2626*******************************************************************
  2627* JGR  FECHA:20/08/2007 06:19:07 p.m.
  2628* CAV  FECHA:16/01/2008
  2629******************************************************************
  2630* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*
  2631* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *
  2632* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *
  2633******************************************************************
  2634* GJC0003    | LEY002 - DEFINICIONES PARA APLICACION DE LEY DEFINI*
  2635* G. JIMENEZ |  TIVO. DOBLE EL TIEMPODE LA MORA                   *
  2636* 23-ENE-2009|                                                    *
  2637*******************************************************************
  2638* GJC0004    | CADUC1 - SE DEFINEN LAS VARIABLES NECESARIAS PARA  *
  2639* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE  *
  2640* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13         *
  2641*******************************************************************
  2642 01  ABD07-AMNIST21             PIC  X(220) VALUE SPACES.
  2643 01  MESES-FALTAN-AMNIST21      PIC  9(03)  VALUE 999.
  2644 01  FECHA-INI-AMNIST21         PIC 9(06) VALUE ZEROS.
  2645 01  FECHA-INI-AMNIST21-R REDEFINES FECHA-INI-AMNIST21.
  2646     03 ANO-INI-AMNIST21        PIC 9(04).
  2647     03 MES-INI-AMNIST21        PIC 9(02).
  2648 01  VERSION-AMNIST21           PIC 9      VALUE ZEROS.
  2649 01  MESES-GRACIA-AMNIST21      PIC 9(02)  VALUE 06.
  2650 01  MESES-CANCELAC-AMNIST21    PIC 9(02)  VALUE 12.
  2651
  2652 01  WORK-CLIENTE-AMNIST21.
  2653     03 CTAS-MEN12-AMNIST21     PIC  9(01) VALUE ZEROS.
  2654     03 CTAS-MAY12-AMNIST21     PIC  9(01) VALUE ZEROS.
  2655     03 MESES-NOV-AMNIST21      PIC  9(04) VALUE ZEROS.
  2656     03 MESES-VEC-AMNIST21      PIC  9(04) VALUE ZEROS.
  2657     03 MESES-GRC-AMNIST21      PIC  9(04) VALUE ZEROS.
  2658     03 MORAS-ACTUAL-AMNIST21   PIC  9(05) VALUE ZEROS.
  2659     03 TIPO-ID-MAES-AMNIST21   PIC  9(01) VALUE ZEROS.
  2660     03 NUM-ID-MAES-AMNIST21    PIC  9(11) VALUE ZEROS.
  2661     03 K-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2662     03 L-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2663     03 M-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2664     03 X-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2665     03 Z-AMNIST21              PIC  9(03)  VALUE ZEROS.          GJC0003
  2666     03 IND-APLICO-CAD-AMNIST21 PIC  9(01) VALUE ZEROS.           GJC0004
  2667     03 FEC-NOVEDAD-AMNIST21.
  2668        05 ANO-NOV-AMNIST21     PIC  9(04) VALUE ZEROS.
  2669        05 MES-NOV-AMNIST21     PIC  9(02) VALUE ZEROS.
  2670     03 FECHA-AUX-AMNIST21      PIC  9(04).
  2671     03 FECHA-AUX-AMNIST21-R REDEFINES FECHA-AUX-AMNIST21.
  2672        05 MES-AUX-AMNIST21     PIC  9(02).
  2673        05 ANO-AUX-AMNIST21     PIC  9(02).
  2674*---------------------------------------------------------------*
  2675 01  LLAVE-INI-AMNIST21.
  2676     03 TIPO-ID-AMNIST21        PIC  9.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  47
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2677     03 NUM-ID-AMNIST21         PIC  9(11).
  2678     03 COD-SUS-AMNIST21        PIC  9(6).
  2679     03 COD-CTA-AMNIST21        PIC  99.
  2680     03 NUM-CTA-AMNIST21        PIC  X(18).
  2681*---------------------------------------------------------------*
  2682 01  REG-SUSCRIPTOR-AMNISTIA21  PIC X(220).
  2683*01  SW-CANDIDATO-AMNIST21      PIC 9(01) VALUE ZEROS.            GJC0003
  2684*---------------------------------------------------------------*
  2685 01  MUMERO-ID-AMNIST21.
  2686     03 SW-AMNIST21             PIC  9(01) VALUE ZEROS.
  2687     03 SW-SALIR-VECT           PIC  9(01) VALUE ZEROS.
  2688     03 TIPO-ID-INI-AMNIST21    PIC  9(01) VALUE ZEROS.
  2689     03 NUME-ID-INI-AMNIST21    PIC  9(11) VALUE ZEROS.
  2690*---------------------------------------------------------------*
  2691 01  FECHA-MILENIO-AMNIST21.
  2692     03 FMILENIO-SIGLO-AMNIST21 PIC  9(02).
  2693     03 FMILENIO-ANIO-AMNIST21  PIC  9(02).
  2694     03 FMILENIO-MES-AMNIST21   PIC  9(02).
  2695*---------------------------------------------------------------*
  2696*   PRUEBAS  FECHA 200608                                       *
  2697*---------------------------------------------------------------*
  2698 01  FECHA-HOY-AMNIST21         PIC X(08).
  2699 01  FECHA-HOY-AMNIST21-R  REDEFINES FECHA-HOY-AMNIST21.
  2700     03 FECHA-SYS-AMNIST21.
  2701        05 ANO-HOY-AMNIST21     PIC 9(04).
  2702        05 MES-HOY-AMNIST21     PIC 9(02).
  2703     03 DIA-HOY-AMNIST21        PIC 9(02).
  2704*---------------------------------------------------------------*
  2705 01  FECHA-GRACIA-AMNIST21.
  2706     05 ANO-GRACIA-AMNIST21     PIC  9(04) VALUE ZEROS.
  2707     05 MES-GRACIA-AMNIST21     PIC  9(02) VALUE ZEROS.
  2708*---------------------------------------------------------------
  2709 01  VECTOR-AMNISTA21.
  2710     03 VECTOR1-AMNIST21        PIC 9(12) VALUE ZEROS.
  2711     03 VECTOR2-AMNIST21        PIC 9(12) VALUE ZEROS.
  2712     03 VECTOR3-AMNIST21        PIC 9(12) VALUE ZEROS.
  2713     03 VECTOR4-AMNIST21        PIC 9(12) VALUE ZEROS.
  2714*---------------------------------------------------------------
  2715 01  VECT-AMNIST21.
  2716     03 VECT1-AMNIST21          PIC 9(12).
  2717     03 VECT2-AMNIST21          PIC 9(12).
  2718     03 VECT3-AMNIST21          PIC 9(12).
  2719     03 VECT4-AMNIST21          PIC 9(12).
  2720     03 HISTORIA-TOTAL-AMNIST21.
  2721        05 VECTOR-TOT-AMNIST21  PIC X(48).
  2722     03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.
  2723        05 V-VEC-AMNIST21  OCCURS 48 TIMES PIC X.
  2724*---------------------------------------------------------------
  2725*TABLA QUE IDENTIFICA EL ESTADO DEL REGISTRO POR LA NOVEDAD
  2726* 0-OBLIGACION CANCELADA
  2727* 1-OBLIGACIONES ABIERTAS
  2728*---------------------------------------------------------------
  2729 01  TAB-VIGENTES-AMNIST21.
  2730     03 TABLA-VIGENTES-AMNIST21.
  2731        05 FILLER        PIC X(10)   VALUE  "1000000000".
  2732        05 FILLER        PIC X(10)   VALUE  "0011111111".
  2733        05 FILLER        PIC X(10)   VALUE  "1111111111".
  2734        05 FILLER        PIC X(10)   VALUE  "1111111111".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  48
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2735        05 FILLER        PIC X(10)   VALUE  "1111101101".
  2736     03 TABLA-VIGENTES-AMNIST21-R REDEFINES
  2737        TABLA-VIGENTES-AMNIST21.
  2738        05 TAB-VIG-CART-AMNIST21   OCCURS 50 TIMES  PIC 9(01).
  2739*---------------------------------------------------------------*
  2740 01  TABLAS-CR-AMNIST21.
  2741     03 TABLA-NOV-CAR-AMNIST21.                                   GJC0003
  2742        05  FILLER  PIC X(35) VALUE                               GJC0003
  2743            "01 01 5 AL DIA         1718192001 5".                GJC0003
  2744        05  FILLER  PIC X(35) VALUE                               GJC0003
  2745            "02 02 5 TDC NO RECLAMAD0000000000 0".                GJC0003
  2746        05  FILLER  PIC X(35) VALUE                               GJC0003
  2747            "08 03 5 TDC CANC.MALMAN0000000000 0".                GJC0003
  2748        05  FILLER  PIC X(35) VALUE                               GJC0003
  2749            "04 04 5 TDC ROBADA     0000000000 0".                GJC0003
  2750        05  FILLER  PIC X(35) VALUE                               GJC0003
  2751            "05 05 5 CANCEL.VOLUNTAR0000000000 0".                GJC0003
  2752        05  FILLER  PIC X(35) VALUE                               GJC0003
  2753            "06 06 5 CANCEL.MMX<60  0000000000 0".                GJC0003
  2754        05  FILLER  PIC X(35) VALUE                               GJC0003
  2755            "07 07 5 TDC EXTRAVIADA 0000000000 0".                GJC0003
  2756        05  FILLER  PIC X(35) VALUE                               GJC0003
  2757            "03 08 5 PAGO VOLUNT.SAT0000000000 0".                GJC0003
  2758        05  FILLER  PIC X(35) VALUE                               GJC0003
  2759            "03 09 5 PAGO.MMX.A.30  09EEEEEE08 0".                GJC0003
  2760        05  FILLER  PIC X(35) VALUE                               GJC0003
  2761            "03 10 5 PAGO.MMX.A.60  0910EEEE08 0".                GJC0003
  2762        05  FILLER  PIC X(35) VALUE                               GJC0003
  2763            "03 11 5 PAGO.MORA.90   091011EE08 0".                GJC0003
  2764        05  FILLER  PIC X(35) VALUE                               GJC0003
  2765            "03 12 5 PAGO.VOL.MOR1200910111208 0".                GJC0003
  2766        05  FILLER  PIC X(35) VALUE                               GJC0003
  2767            "01 13 5 MORA.30.AL.DIA 1727282913 1".                GJC0003
  2768        05  FILLER  PIC X(35) VALUE                               GJC0003
  2769            "01 14 5 MORA.60.AL.DIA 3031323314 2".                GJC0003
  2770        05  FILLER  PIC X(35) VALUE                               GJC0003
  2771            "01 15 5 MORA.90.AL.DIA 3435363715 3".                GJC0003
  2772        05  FILLER  PIC X(35) VALUE                               GJC0003
  2773            "01 16 5 MORA.120.AL.DIA3839404116 4".                GJC0003
  2774        05  FILLER  PIC X(35) VALUE                               GJC0003
  2775            "12 17 1 ESTA.MORA.30   1718192013 1".                GJC0003
  2776        05  FILLER  PIC X(35) VALUE                               GJC0003
  2777            "13 18 2 ESTA.MORA.60   2118192014 2".                GJC0003
  2778        05  FILLER  PIC X(35) VALUE                               GJC0003
  2779            "14 19 3 ESTA.MORA.90   2223192015 3".                GJC0003
  2780        05  FILLER  PIC X(35) VALUE                               GJC0003
  2781            "15 20 4 ESTA.MORA.120  2425262016 4".                GJC0003
  2782        05  FILLER  PIC X(35) VALUE                               GJC0003
  2783            "12 21 1 FU.60.Y.ESTA.302118192014 2".                GJC0003
  2784        05  FILLER  PIC X(35) VALUE                               GJC0003
  2785            "12 22 1 FU.90.Y.ESTA.302223192015 3".                GJC0003
  2786        05  FILLER  PIC X(35) VALUE                               GJC0003
  2787            "13 23 2 FU.90.Y.ESTA.602223192015 3".                GJC0003
  2788        05  FILLER  PIC X(35) VALUE                               GJC0003
  2789            "12 24 1 FU.120.ESTA.30 2425262016 4".                GJC0003
  2790        05  FILLER  PIC X(35) VALUE                               GJC0003
  2791            "13 25 2 FU.120.ESTA.60 2425262016 4".                GJC0003
  2792        05  FILLER  PIC X(35) VALUE                               GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  49
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2793            "14 26 3 FU.120.ESTA.90 2425262016 4".                GJC0003
  2794        05  FILLER  PIC X(35) VALUE                               GJC0003
  2795            "13 27 2 RE.30.ESTA.60  2127282914 2".                GJC0003
  2796        05  FILLER  PIC X(35) VALUE                               GJC0003
  2797            "14 28 3 RE.30.Y.ESTA.902223282915 3".                GJC0003
  2798        05  FILLER  PIC X(35) VALUE                               GJC0003
  2799            "15 29 4 RE.30.ESTA.120 2425262916 4".                GJC0003
  2800        05  FILLER  PIC X(35) VALUE                               GJC0003
  2801            "12 30 1 RE.60.Y.ESTA.303031323314 2".                GJC0003
  2802        05  FILLER  PIC X(35) VALUE                               GJC0003
  2803            "13 31 2 RE.60.Y.ESTA.602131323314 2".                GJC0003
  2804        05  FILLER  PIC X(35) VALUE                               GJC0003
  2805            "14 32 3 RE.60.Y.ESTA.902223323315 3".                GJC0003
  2806        05  FILLER  PIC X(35) VALUE                               GJC0003
  2807            "15 33 4 RE.60.ESTA.120 2425263316 4".                GJC0003
  2808        05  FILLER  PIC X(35) VALUE                               GJC0003
  2809            "12 34 1 RE.90.Y.ESTA.303435363715 3".                GJC0003
  2810        05  FILLER  PIC X(35) VALUE                               GJC0003
  2811            "13 35 2 RE.90.Y.ESTA.603435363715 3".                GJC0003
  2812        05  FILLER  PIC X(35) VALUE                               GJC0003
  2813            "14 36 3 RE.90.Y.ESTA.902223363715 3".                GJC0003
  2814        05  FILLER  PIC X(35) VALUE                               GJC0003
  2815            "15 37 4 RE.90.ESTA.120 2425263716 4".                GJC0003
  2816        05  FILLER  PIC X(35) VALUE                               GJC0003
  2817            "12 38 1 RE.120.ESTA.30 3839404116 4".                GJC0003
  2818        05  FILLER  PIC X(35) VALUE                               GJC0003
  2819            "13 39 2 RE.120.ESTA.60 3839404116 4".                GJC0003
  2820        05  FILLER  PIC X(35) VALUE                               GJC0003
  2821            "14 40 3 RE.120.ESTA.90 3839404116 4".                GJC0003
  2822        05  FILLER  PIC X(35) VALUE                               GJC0003
  2823            "15 41 4 RE.120.ESTA.1202425264116 4".                GJC0003
  2824        05  FILLER  PIC X(35) VALUE                               GJC0003
  2825            "20 42   ADJ.NO.LOCALIZA0000000000 0".                GJC0003
  2826        05  FILLER  PIC X(35) VALUE                               GJC0003
  2827            "21 43   ADJ.CTA.COBRADO0000000000 0".                GJC0003
  2828        05  FILLER  PIC X(35) VALUE                               GJC0003
  2829            "22 44   FALLECIDO      0000000000 0".                GJC0003
  2830        05  FILLER  PIC X(35) VALUE                               GJC0003
  2831            "09 45 4 CARTERA.CASTIGA0000000000 4".                GJC0003
  2832        05  FILLER  PIC X(35) VALUE                               GJC0003
  2833            "10 46 5 CARTERA.RECUPER0000000000 5".                GJC0003
  2834        05  FILLER  PIC X(35) VALUE                               GJC0003
  2835            "11 47 4 DUDOSO.RECAUDO 0000000000 4".                GJC0003
  2836        05  FILLER  PIC X(35) VALUE                               GJC0003
  2837            "23 48   CONSULTA       0000000000 0".                GJC0003
  2838        05  FILLER  PIC X(35) VALUE                               GJC0003
  2839            "49 49 5 NO RENOVADA    0000000000 0".                GJC0003
  2840        05  FILLER  PIC X(35) VALUE                               GJC0003
  2841            "50                     0000000000 0".                GJC0003
  2842     03  TABLA-NOV-CAR-AMNIST21-R  REDEFINES
  2843                                     TABLA-NOV-CAR-AMNIST21.
  2844         05  TAB-NOV-CARTERA-AMNIST21   OCCURS  50  TIMES.
  2845             07 NOV-CART-CODINT-AMNIST21 PIC 9(02).
  2846             07 FILLER                   PIC X.                   GJC0003
  2847             07 NOV-CART-COD-AMNIST21    PIC 9(02).
  2848             07 FILLER                   PIC X.                   GJC0003
  2849             07 NOV-CART-MORA-AMNIST21   PIC 9(01).               GJC0003
  2850             07 FILLER                   PIC X.                   GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  50
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2851             07 NOV-CART-NOM-AMNIST21    PIC X(15).
  2852             07 NOV-CRUCES-AMNIST21   OCCURS 5 TIMES PIC X(2).    GJC0003
  2853             07 FILLER                   PIC X.                   GJC0003
  2854             07 NOV-CART-MORMAX-AMNIST21 PIC 9(01).               GJC0003
  2855*---------------------------------------------------------------*
  2856* DEFINICION DE VARIABLES DE AMBIENTE
  2857*---------------------------------------------------------------*
  2858  01 VAR-AMBIENTE-AMNIST21          PIC X(10) VALUE "FECHA_AMNI".
  2859  01 VAR-AMB-HOY-AMNIST21           PIC X(10) VALUE "FECHA_HOY ". GJC0003
  2860  01 VAR-FEC-AMB-AMNIST21.                                        GJC0003
  2861     03 ANO-VAR-FEC-AMB-AMNIST21    PIC 9(04).                    GJC0003
  2862     03 MES-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003
  2863     03 DIA-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003
  2864* 01  WS-FECHA-HISTORICA         PIC  9(08) VALUE  ZEROS.         GJC0003
  2865* 01                       REDEFINES  WS-FECHA-HISTORICA.         GJC0003
  2866*   03  WS-FECHA-HIST-ANNO       PIC  9(04).                      GJC0003
  2867*   03  WS-FECHA-HIST-MES        PIC  9(02).                      GJC0003
  2868*   03  WS-FECHA-HIST-DIA        PIC  9(02).                      GJC0003
  2869
  2870*----------------------------------------------------------------*
  2871*DEFINICION DE LAS VALIABLES QUE SE UTILIZAN PARA EL CALCULO DE  *
  2872*LEY ARTICULO 13 DOBLE DEL TIEMPO DE LA MORA
  2873*----------------------------------------------------------------*
  2874  01 VAR-LEY-DOBLE-DE-MORA-AMNIST21.                              GJC0003
  2875     03 SW-ART13-AMNIST21   PIC 9 VALUE 1. *> APLICAR SIEMPRE LEY GJC0003
  2876     03 VECTORES-13-AMNIST21.                                     GJC0003
  2877* VECTOR DE MORAS DE LA PERSONA                                   GJC0003
  2878        05 VECTOR-MORAS-IDE-13-AMNIST21 PIC X(100) VALUE ALL "5". GJC0003
  2879        05 VEC-MOR-IDE-13-AMNIST21 REDEFINES                      GJC0003
  2880           VECTOR-MORAS-IDE-13-AMNIST21 PIC 9 OCCURS 100 TIMES.   GJC0003
  2881* VECTOR DE LA CUENTA REAL                                        GJC0003
  2882        05 VECTOR-TOT-CTA-AMNIST21.                               GJC0003
  2883           07  VECTOR-4-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2884           07  VECTOR4-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2885               VECTOR-4-CTA-AMNIST21  PIC X(12).                  GJC0003
  2886           07  VECTOR-3-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2887           07  VECTOR3A-CTA-AMNIST21 REDEFINES                    GJC0003
  2888               VECTOR-3-CTA-AMNIST21  PIC X(12).                  GJC0003
  2889           07  VECTOR-2-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2890           07  VECTOR2-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2891               VECTOR-2-CTA-AMNIST21  PIC X(12).                  GJC0003
  2892           07  VECTOR-1-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2893           07  VECTOR1-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2894               VECTOR-1-CTA-AMNIST21  PIC X(12).                  GJC0003
  2895           07  MOR-EST-CTA-AMNIST21   PIC 9     VALUE 0.          GJC0003
  2896        05 VEC-TOT-CTA-AMNIST21 REDEFINES                         GJC0003
  2897              VECTOR-TOT-CTA-AMNIST21 OCCURS 49 TIMES PIC 9.      GJC0003
  2898* VECTOR DE LA CUENTA SOBRE EL QUE SE BUSCA SI SE PERDONA         GJC0003
  2899       05 VECTOR-TOT-CTA2-AMNIST21.                               GJC0003
  2900           07  VECTOR-4-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2901           07  VECTOR4-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2902               VECTOR-4-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2903           07  VECTOR-3-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2904           07  VECTOR3A-CTA2-AMNIST21 REDEFINES                   GJC0003
  2905               VECTOR-3-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2906           07  VECTOR-2-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2907           07  VECTOR2-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2908               VECTOR-2-CTA2-AMNIST21  PIC X(12).                 GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  51
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2909           07  VECTOR-1-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2910           07  VECTOR1-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2911               VECTOR-1-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2912           07  MOR-EST-CTA2-AMNIST21   PIC 9     VALUE 0.         GJC0003
  2913           07  MOR-MORA-CTA2-AMNIST21  PIC 9     VALUE 1.         GJC0003
  2914        05 VEC-TOT-CTA2-AMNIST21 REDEFINES                        GJC0003
  2915              VECTOR-TOT-CTA2-AMNIST21 OCCURS 50 TIMES PIC 9.     GJC0003
  2916* VECTOR DE CUENTA EN 100 POSICIONES NORMALIZADO                  GJC0003
  2917        05 VECTOR-100-CTA-AMNIST21     PIC X(101).                GJC0003
  2918        05 VEC-100-CTA-AMNIST21 REDEFINES                         GJC0003
  2919           VECTOR-100-CTA-AMNIST21 pic 9 OCCURS 101 TIMES.        GJC0003
  2920* VECTOR DE LAPSOS DE MORAS                                       GJC0003
  2921        05 VECTOR-LAPSOS OCCURS 30 TIMES.                         GJC0003
  2922           07 PERDON-GRUPO-AMNIST21  PIC 9(01).                   GJC0003
  2923           07 INI-GRUPO-AMNIST21     PIC 9(02).                   GJC0003
  2924           07 LONG-GRUPO-AMNIST21    PIC 9(02).                   GJC0003
  2925                                                                  GJC0003
  2926     03 VARIALES-MORAS-13-AMNIST21.                               GJC0003
  2927        05 LONG-LAPSO-13-AMNIST21 PIC 9(02) VALUE 0.              GJC0003
  2928        05 MAX-LONG-LAPSO-13-AMNIST21 PIC 9(02).                  GJC0003
  2929     03  OTRAS-VAR-13-AMNIS21.                                    GJC0003
  2930        05 CINCOS-AMNIST21        PIC X(100) VALUE ALL "5".       GJC0003
  2931        05 UNOS-AMNIST21          PIC X(100) VALUE ALL "1".       GJC0003
  2932        05 MAYOR-LAPSO-AMNIST21   PIC 9(02).                      GJC0003
  2933        05 SALIR-AMNIST21         PIC 9.                          GJC0003
  2934        05 CTA-PERDONADA-AMNIST21 PIC 9.                          GJC0003
  2935        05 LAPSO-AMNIST21         PIC 9(02).                      GJC0003
  2936        05 MESES-MORAS-AMNIST21   PIC 9(02).                      GJC0003
  2937        05 ESTOY-MOROSO-AMNIST21  PIC 9.                          GJC0003
  2938        05 MESES-AMNIST21         PIC 9(3).                       GJC0003
  2939        05 FEC-NOV-AUX-AMNIST21 PIC 9(4).                         GJC0003
  2940        05 FEC-NOV-AUX1-AMNIST21 PIC 9(4).                        GJC0003
  2941        05 FEC-SIT-45Y47-AMNIST21 PIC 9(6).                       GJC0003
  2942        05 FEC-SIT-45Y47-R-AMNIST21 REDEFINES                     GJC0003
  2943           FEC-SIT-45Y47-AMNIST21.                                GJC0003
  2944           07 MES-SIT-AMNIST21     PIC 9(02).                     GJC0003
  2945           07 ANO-SIT-AMNIST21     PIC 9(04).                     GJC0003
  2946*DEFINICION DE VARIABLES PARA HACER RECALCULO DE ESTADO Y OTROS CAGJC0003
  2947 01 VARIABLES-RECALCULO.                                          GJC0003
  2948    03 HISTORIA-TOTAL-AMNIST21.                                   GJC0003
  2949       05 VECTOR-1-AMNIST21        PIC X(12).                     GJC0003
  2950       05 VECTOR-2-AMNIST21        PIC X(12).                     GJC0003
  2951       05 VECTOR-3-AMNIST21        PIC X(12).                     GJC0003
  2952       05 VECTOR-4-AMNIST21        PIC X(12).                     GJC0003
  2953       05 EST-HIST-AMNIST21        PIC X(1).                      GJC0003
  2954    03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.                  GJC0003
  2955       05 V-VECTOR-AMNIST21   OCCURS 49 TIMES PIC X.              GJC0003
  2956    03 FIN-AMNIST21                 PIC 9 VALUE 0.                GJC0003
  2957    03 FIN-MATRIZ-AMNIST21          PIC 99 VALUE 0.               GJC0003
  2958    03 ESTADO-AMNIST21              PIC 99.                       GJC0003
  2959    03 ESTADO-INI-AMNIST21          PIC 99.                       GJC0003
  2960    03 ESTADO-FIN-AMNIST21          PIC 99.                       GJC0003
  2961    03 ESTADO-INI48-AMNIST21          PIC 99.                     GJC0003
  2962    03 ESTADO-FIN48-AMNIST21          PIC 99.                     GJC0003
  2963    03 FECHA-AMNIST21.                                            GJC0003
  2964       05 ANO-T-AMNIST21            PIC 9(4).                     GJC0003
  2965       05 FILLER REDEFINES ANO-T-AMNIST21.                        GJC0003
  2966          07 SIGLO-AMNIST21         PIC 99.                       GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  52
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2967          07 ANO-AMNIST21           PIC 9(2).                     GJC0003
  2968       05 MES-AMNIST21              PIC 9(2).                     GJC0003
  2969    03 FECHA-1-AMNIST21.                                          GJC0003
  2970       05 ANO-T-1-AMNIST21          PIC 9(4).                     GJC0003
  2971       05 FILLER REDEFINES ANO-T-1-AMNIST21.                      GJC0003
  2972          07 SIGLO-1-AMNIST21       PIC 99.                       GJC0003
  2973          07 ANO-1-AMNIST21         PIC 9(2).                     GJC0003
  2974       05 MES-1-AMNIST21            PIC 9(2).                     GJC0003
  2975    03 FEC-INI-MOR-AMNIST21         PIC 9(6).                     GJC0003
  2976    03 MES-MORA-MAX-AMNIST21        PIC 9(2).                     GJC0003
  2977    03 MES-MORA-MAX-48-AMNIST21        PIC 9(2).                  GJC0003
  2978    03 FEC-MM-AA-AMNIST21           PIC 9(4).                     GJC0003
  2979    03 FEC-MM-AAAA-AMNIST21         PIC 9(6).                     GJC0003
  2980    03 NOV-ENT-AMNIST21             PIC 9(02).                    GJC0003
  2981    03 FEC-NOV-AMNIST21             PIC 9(04).                    GJC0003
  2982    03 FEC-MORMAX-AMNIST21          PIC 9(06).                    GJC0003
  2983    03 FEC-MORMAX-48-AMNIST21       PIC 9(06).                    GJC0003
  2984    03 MORMAX-AMNIST21              PIC 9(01).                    GJC0003
  2985    03 MORMAX48-AMNIST21            PIC 9(01).                    GJC0003
  2986    03 NUM-MOR30-AMNIST21           PIC 9(02).                    GJC0003
  2987    03 NUM-MOR30-48-AMNIST21        PIC 9(02).                    GJC0003
  2988    03 NOV-SAL-AMNIST21             PIC 9(02).                    GJC0003
  2989    03 FEC-NOV-48-AMNIST21          PIC 9(04).                    GJC0003
  2990    03 NOV-SAL-48-AMNIST21          PIC 9(02).                    GJC0003
  2991    03 POSICION-INI-AMNIST21        PIC 9(03).                    GJC0003
  2992
  2993
* 2994 COPY VALNOM.WS.
  2999* GJC0002    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION
  3000* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES
  3001* MARZO/2003 *
  3002*************************************************************************
  3003  01 VARIABLES-VALNOM.
  3004     03 VECTOR-INPUT-VALNOM.
  3005       04 VM-INPUT-VALNOM     OCCURS 20 TIMES .
  3006          05 VMM-INPUT-VALNOM OCCURS 15 TIMES PIC X.
  3007     03 VECTOR-OK-VALNOM.
  3008       04 VM-OK-VALNOM         OCCURS 20 TIMES.
  3009          05 VMM-OK-VALNOM    OCCURS 15 TIMES PIC X.
  3010     03 BLOQOK-AUX-VALNOM           PIC 9(2).
  3011     03 CADENA-VALNOM.
  3012        04 FILLER                   PIC X(2) VALUE "A ".
  3013        04 NOMBRE-AUX-VALNOM        PIC X(65).
  3014        04 FILLER REDEFINES NOMBRE-AUX-VALNOM.
  3015           05 VNOM-AUX-VALNOM OCCURS 65 TIMES PIC X.
  3016     03 BASURA-VALNOM               PIC X(10).
  3017     03 BLOQUES-INPUT-VALNOM        PIC 9(2).
  3018     03 NOMBRE-INPUT-VALNOM         PIC X(65).
  3019     03 FILLER REDEFINES NOMBRE-INPUT-VALNOM.
  3020        05 V-NOMBRE-VALNOM          PIC X OCCURS 65 TIMES.
  3021     03 NOMBOK-INPUT-VALNOM         PIC X(65).
  3022     03 FILLER REDEFINES NOMBOK-INPUT-VALNOM.
  3023        05 V-NOMBOK-VALNOM          PIC X OCCURS 65 TIMES.
  3024     03 TIP-ID-INPUT-VALNOM         PIC 9(02).
  3025     03 MATCH-OK-OUT-VALNOM         PIC 9(01).
  3026     03 A-VALNOM                    PIC 9(05).
  3027     03 I-VALNOM                    PIC 9(05).                    GJC0002
  3028     03 J-VALNOM                    PIC 9(05).                    GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  53
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  3029     03 K-VALNOM                    PIC 9(05).                    GJC0002
  3030     03 L-VALNOM                    PIC 9(05).                    GJC0002
  3031     03 M-VALNOM                    PIC 9(05).                    GJC0002
  3032     03 INI-VALNOM                  PIC 9(02).
  3033     03 LON-VALNOM                  PIC 9(02).
  3034     03 LETRAS-OK-VALNOM            PIC 9(02).
  3035     03 LETRAS-OK2-VALNOM           PIC 9(02).
  3036     03 TOTLET-OK-VALNOM            PIC 9(02).
  3037     03 TOTLET-INP-VALNOM           PIC 9(02).
  3038     03 PEDAZO-VALNOM               PIC X(15).
  3039     03 POR-TOT-VALNOM              PIC 9(05).
  3040     03 POR-INP-VALNOM              PIC 9(05).
  3041     03 APROX-TOT-VALNOM            PIC 9(05).
  3042     03 APROX-INP-VALNOM            PIC 9(05).
  3043     03 VECTORES-VALNOM.                                          GJC0002
  3044        04 FILLER                   OCCURS 256 TIMES.             GJC0002
  3045           05 CONT-LET-INPUT-VALNOM PIC 9(2).                     GJC0002
  3046           05 CONT-LET-OK-VALNOM    PIC 9(2).                     GJC0002
  3047     03 VAL-APELLIDO-VALNOM         PIC 9.                        GJC0002
* 3048 COPY DIRECC.WS.
  3053* VHF0004     * SE ADICIONAN NOMBRES DE ARCHIVOS DE              *
  3054* VICTOR HUGO * ESTANDARIZACION DE DIRECCIONES                  *
  3055* FORERO      *                                                  *
  3056* JUL.08/2002 *                                                  *
  3057******************************************************************
  3058* FAC0005     * HDIR01 * INCLUSION RUTA PARA MAESTRO HISTORICO DE*
  3059* F.CUADROS C.* DIRECCIONES                                      *
  3060* MAR.04/2003 *                                                  *
  3062* FAC0006     * BDLLOC * AMPLIACION DE LAS OCURRENCIAS DEL VECTOR*
  3063* F.CUADROS C.* T-LOCALIZACION PARA NUEVOS CAMPOS DE MAESTROS DEL*
  3064* DIC.11/2003 * CLUB BDLCLI
  3066* FAC0007     * AMPDIR * AMPLIACIÓN DE LA ESTRUCTURA DE ARCHIVOS*
  3067* F.CUADROS C.* ICBDIR Y BDUHDIR. SE AMPLIAN LOS TAMAÑOS DE LOS *
  3068* FEB.14/2006 * CAMPOS: TELÉFONOS, DIRECCIONES, CIUDADES, DPTOS.*
  3070* VHF0008     * RCNCER - SE INCLUYE TITULO DE ARCHIVO DE        *
  3071* VICTOR HUGO *          ACEPCIONES DE CIUDADES PARA OPTIMIZAR  *
  3072* FORERO      *          PRODUCTO RECONOCER.                    *
  3073* JUL.06/2006 *                                                 *
  3074* FAC0008     *          SE INCLUYEN CONTROLES EN HISTÓRICO PARA*
  3075* JUL.18/2006 *          GEORREFERENCIACIÓN                     *
  3076*****************************************************************
  3077* CAV0009      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI  *
  3078* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA  *
  3079* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION            *
  3080*****************************************************************
  3081* VHF0010      * FASEII - SE ADICIONAN NUEVAS VARIABLES PARA EL  *
  3082* VICTOR HUGO  *          ACTUALIZADOR                           *
  3083* FORERO       *                                                 *
  3084* JUL.25/2008  *                                                 *
  3085******************************************************************
  3086 01 CONTADORES-DIRECC.
  3087    03 TOTAL-DIRECC            PIC 9(8) VALUE 0.
  3088    03 CAMBIOS-DIRECC          PIC 9(8) VALUE 0.
  3089    03 SINCAMBIOS-DIRECC       PIC 9(8) VALUE 0.
  3090    03 CREACIONES-DIRECC       PIC 9(8) VALUE 0.
  3091    03 ERRORES-DIRECC          PIC 9(8) VALUE 0.
  3092    03 CAMPOSVACIOS-DIRECC     PIC 9(8) VALUE 0.
  3093    03 MENOSACTUAL-DIRECC      PIC 9(8) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  54
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/DIRE
  3094    03 ERRLLAVE-DIRECC         PIC 9(8) VALUE 0.
  3095 01 VARIABLES-DIRECC.
  3096    03 IND-DIRECC              PIC 9 VALUE 0.
  3097    03 FECHA6-DIRECC           PIC 9(06).
  3098    03 ERROR-DIRECC            PIC 9 VALUE 0.
  3099    03 CAMBIO-DIRECC           PIC 9 VALUE 0.
  3100    03 REG-CSV-DIRECC          PIC 9(1).                          CAV0009
  3101    03 MAES-DIRECC-TITLE PIC X(50) VALUE "$DIRECCIONES/ICBDIR".
  3102    03 TITLE-DIREST            PIC X(40) VALUE                    VHF0004
  3103       "$DIRECCIONES/DIREST".                                     VHF0004
  3104    03 TITLE-DIRCON            PIC X(40) VALUE                    VHF0004
  3105       "$DIRECCIONES/DIRCON".                                     VHF0004
  3106    03 VALLOC-DIRECC.
  3107       04 T-LOCALIZACION OCCURS 15 TIMES PIC 9.                   FAC0006
  3108    03 MAES-BDUHDIR-TITLE PIC X(20) VALUE "$DIRECCIONES/BDUHDIR". FAC0005
  3109    03 TITLE-BDLSTDCIU    PIC X(80)  VALUE "$DATABASE/BDLSTDCIU". VHF0008
  3110 01 VARIABLES-TRAB-DIRECC.                                        FAC0003
  3111    03 TEL-W1                  PIC X(12).                         FAC0007
  3112    03 TEL-W2                  PIC X(12).                         FAC0007
  3113    03 TEL-WW2                 PIC X(12).                         FAC0007
  3114    03 CAR-W                   PIC 9(1).                          FAC0003
  3115    03 CAR-WW                  PIC 9(2).                          FAC0003
  3116    03 NUM-CAR-W               PIC 9(2).                          FAC0003
  3117 01 VARIABLES-NEW-DIRECC.                                         VHF0010
  3118    03 SW-HACER-CAMBIO         PIC 9.                             VHF0010
  3119    03 DIR-ACTUAL              PIC X(60).                         VHF0010
  3120    03 DIR-NUEVA               PIC X(60).                         VHF0010
  3121 01 REG-BDUHDIR-WS.                                               FAC0005
  3122    03  LLAVE-BDUHDIR-WS.                                         FAC0005
  3123        05  LLAVE-PRI-BDUHDIR-WS.                                 FAC0005
  3124            07  TIPO-ID-BDUHDIR-WS    PIC 9(01).                  FAC0005
  3125            07  NUM-ID-BDUHDIR-WS     PIC 9(13).                  FAC0007
  3126        05  LLAVE-ALT-BDUHDIR-WS.                                 FAC0005
  3127            07  COD-SUS-BDUHDIR-WS    PIC 9(06).                  FAC0005
  3128            07  COD-CTA-BDUHDIR-WS    PIC 9(02).                  FAC0005
  3129            07  NUM-CTA-BDUHDIR-WS    PIC X(18).                  FAC0005
  3130        05  LLAVE-CONSEC-BDUHDIR-WS.                              FAC0005
  3131            07  NUM-CONSEC-BDUHDIR-WS PIC 9(3).                   FAC0005
  3132     03  FECAPE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3133     03  FECCRE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3134     03  FECACT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3135     03  CIURES-BDUHDIR-WS            PIC X(20).                  FAC0007
  3136     03  DPTRES-BDUHDIR-WS            PIC X(20).                  FAC0007
  3137     03  DIRRES-BDUHDIR-WS            PIC X(60).                  FAC0007
  3138     03  TELRES-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  3139*    03  FECRES-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3140     03  FECDRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3141     03  CIULAB-BDUHDIR-WS            PIC X(20).                  FAC0007
  3142     03  DPTLAB-BDUHDIR-WS            PIC X(20).                  FAC0007
  3143     03  DIRLAB-BDUHDIR-WS            PIC X(60).                  FAC0007
  3144     03  TELLAB-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  3145*    03  FECLAB-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3146     03  FECDLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3147     03  CIUCOR-BDUHDIR-WS            PIC X(20).                  FAC0007
  3148     03  DPTCOR-BDUHDIR-WS            PIC X(20).                  FAC0007
  3149     03  DIRCOR-BDUHDIR-WS            PIC X(60).                  FAC0007
  3150*    03  FECCOR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3151     03  FECDCOR-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  55
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/DIRE
  3152     03  E-MAIL-BDUHDIR-WS            PIC X(40).                  FAC0007
  3153     03  TELCEL-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  3154*    03  FECOTR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3155     03  FECCEL-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3156     03  FECSIS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3157     03  FECSUS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3158     03  FECULT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3159     03  CERRES-BDUHDIR-WS            PIC 9(01).                  FAC0008
  3160     03  ADIRES-BDUHDIR-WS            PIC 9(02).                  FAC0008
  3161     03  CERLAB-BDUHDIR-WS            PIC 9(01).                  FAC0008
  3162     03  ADILAB-BDUHDIR-WS            PIC 9(02).                  FAC0008
  3163     03  CERCOR-BDUHDIR-WS            PIC 9(01).                  FAC0008
  3164     03  ADICOR-BDUHDIR-WS            PIC 9(02).                  FAC0008
  3165     03  INDCSV-BDUHDIR-WS            PIC 9(01).                  CAV0009
  3166     03  FECTRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3167     03  FECTLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3168     03  FECMAIL-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3169*    03  FILLER-BDUHDIR-WS            PIC X(40).                  VHF0010
  3170     03  FILLER-BDUHDIR-WS            PIC X(28).                  VHF0010
  3171
  3172
  3173********************************************************************
  3174* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
  3175* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
  3176 01  HACERMATCH-LEEMSTRS        PIC 9(01)  VALUE 1.
  3177 01  AMNISTIA21-LEEMSTRS        PIC 9(01)  VALUE 1.
  3178********************************************************************
  3179 01  SW-LECTURA-MAESTROS        PIC 9(01)  VALUE ZEROS.
  3180 01  TIP-IDE-ANT-LEEMSTRS       PIC 9(01)  VALUE ZEROS.
  3181 01  NUM-IDE-ANT-LEEMSTRS       PIC 9(11)  VALUE ZEROS.
  3182 01  REG-ICMCRE-LEEMSTRS        PIC X(220) VALUE SPACES.
  3183 01  REG-ICMCHK-LEEMSTRS        PIC X(94)  VALUE SPACES.
  3184 01  REG-ICBSUS-LEEMSTRS        PIC X(200) VALUE SPACES.
  3185 01  REG-ICBDIR-LEEMSTRS        PIC X(483) VALUE SPACES.
  3186 01  TIPO-ID-LEEMSTRS           PIC 9(01)  VALUE ZEROS.
  3187 01  NRO-ID-LEEMSTRS            PIC 9(11)  VALUE ZEROS.
  3188 01  SW-FCHGRACIA-LEEMSTRS      PIC 9(01)  VALUE ZEROS.
  3189 01  SW-NOV-48-LEEMSTRS         PIC 9(01)  VALUE 1.               GJC0002
  3190 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003
  3191$SET CONSTANT HACERMATCH"SI"                                      GDT0001
  3192$SET CONSTANT AMNISTIA21"SI"                                      GDT0001
  3193 PROCEDURE DIVISION.
  3194*---------------------------------------------------- *
  3195 0010-PROGRAMA-PRINCIPAL.
  3196     DISPLAY "       "
  3197     DISPLAY " ** Datacredito*   MAYOR INFORMACION STANDARD  **"
  3198     DISPLAY "       "
  3199     DISPLAY "PROGRAMA:icestd81.int           VERSION:NOV/2006 "
  3200     DISPLAY "       "
  3201     DISPLAY "       "
  3202     ACCEPT   W-PARAMETROS   FROM COMMAND-LINE
  3203     UNSTRING W-PARAMETROS  DELIMITED BY SPACES INTO
  3204              ARCH-ENTRADA
  3205              ARCH-INCONC
  3206     END-UNSTRING
  3207     OPEN INPUT INCONSIS
  3208     IF W-STATUS-INC = 35
  3209        DISPLAY "!! Archivo inconsistencias no existe.!!"
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  56
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  3210        STOP RUN
  3211     END-IF
  3212     OPEN INPUT ENTRADA
  3213     IF W-STATUS-ENT = 35
  3214        DISPLAY "!! Archivo no existe..Proceso termina.!!"
  3215        STOP RUN
  3216     ELSE
  3217        STRING  ARCH-ENTRADA DELIMITED BY "."
  3218                ".DATINF"    DELIMITED BY SIZE
  3219                INTO         ARCH-SALIDA
  3220        END-STRING
  3221        STRING  ARCH-ENTRADA DELIMITED BY "."
  3222                ".ESTADI"    DELIMITED BY SIZE
  3223                INTO         ARCH-ESTADIS
  3224        END-STRING
  3225        CLOSE   ENTRADA
  3226
  3227        PERFORM 0015-CARGUE-TABLA-BDACUE
  3228
  3229        PERFORM 0020-APERTURA-ARCHIVOS
  3230
  3231        PERFORM 0030-EVALUA-CTAS
  3232
  3233        PERFORM 0450-READ-INCONSISTENCIAS
  3234
  3235        PERFORM 9800-GRABAR-ESTADISTICA
  3236
  3237        PERFORM 9900-RESUMEN-PROCESO
  3238        STOP RUN
  3239     END-IF.
  3240
  3241*-----------------------------*
* 3242 COPY UTLBIT.PROC.
  3243* UTLBIT.PROC.v.0001
  3244* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
  3245* BITS EN STRINGS COMO FLAGS SI/NO UTILES PARA AHORRO DE ESPACIO
  3246* AL LLAMAR CUALQUIER RUTINA SE MANEJA UN CODIGO DE ERROR QUE DEBE
  3247* SER CHEQUEADO PARA ASEGURAR QUE TODO ESTA OK
  3248*
  3249 0001-VALOR-FLAG-UTLBIT.
  3250******************************************************************
  3251*0001-VALOR-FLAG-UTLBIT.
  3252* ESTA RUTINA BUSCA EN EL STRING DADOS EL VALOR DEL FLAG BUSCADO
  3253* RETORNANDO 1 O 0 DE ACUERDO AL VALOR DEL BIT CORRESPONDIENTE
  3254*      ALINEACION :
  3255*         0        1        2
  3256*      12345678 90123456 78901234 ..........NUMERACION DE FLAGS
  3257*      11011010 11011101 00010010 ..........FLAGS O BITS
  3258*      CARACTE1 CARACTE2 CARACTE3 ..........STRING
  3259*      PARAMETROS DE ENTRADA:
  3260*         STRING MAX 100 A FLAGEAR     INPUT-STR-UTLBIT
  3261*         LONGITUD  DEL STRING        INPUT-LEN-UTLBIT
  3262*         FLAG BUSCADO                INPUT-FLA-UTLBIT
  3263*      DATOS DE SALIDA:
  3264*         VALOR DEL FLAG              OUTPUT-VAL-UTLBIT
  3265*         ERROR EN DATOS(0,1)         OUTPUT-ERR-UTLBIT
  3266*      OBSERVACION: ESTA RUTINA NO DEBE SER USADO EN ARCHIVOS
  3267*                   LINE SEQUENTIAL
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  57
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/UTLB
  3268******************************************************************
  3269     MOVE 0 TO OUTPUT-ERR-UTLBIT
  3270     COMPUTE POSCAR-UTLBIT = ((INPUT-FLA-UTLBIT - 1 )  / 8) + 1
  3271     COMPUTE POSFLA-UTLBIT = INPUT-FLA-UTLBIT -
  3272                             (POSCAR-UTLBIT - 1 ) * 8
  3273     IF POSCAR-UTLBIT > INPUT-LEN-UTLBIT OR
  3274        INPUT-LEN-UTLBIT > 100
  3275        MOVE 1 TO OUTPUT-ERR-UTLBIT
  3276     ELSE
  3277        MOVE INPUT-STR-UTLBIT(POSCAR-UTLBIT:1) TO CAR-UTLBIT
  3278        MOVE FUNCTION ORD(CAR-UTLBIT) TO ASCII-UTLBIT
  3279        SUBTRACT 1 FROM ASCII-UTLBIT
  3280        MOVE ASCII-UTLBIT TO ASCXX-UTLBIT
  3281        MOVE 0 TO OUTPUT-VAL-UTLBIT
  3282        MOVE 1 TO I-UTLBIT
  3283        MOVE 128 TO VALOR-UTLBIT
  3284        PERFORM UNTIL I-UTLBIT > 8 OR OUTPUT-VAL-UTLBIT = 1
  3285          IF ASCXX-UTLBIT >= VALOR-UTLBIT
  3286             COMPUTE ASCXX-UTLBIT = ASCXX-UTLBIT - VALOR-UTLBIT
  3287             IF I-UTLBIT = POSFLA-UTLBIT
  3288                MOVE 1 TO OUTPUT-VAL-UTLBIT
  3289             END-IF
  3290          END-IF
  3291          COMPUTE VALOR-UTLBIT = VALOR-UTLBIT / 2
  3292          ADD 1 TO I-UTLBIT
  3293        END-PERFORM.
  3294 0002-UPDATE-FLAG-UTLBIT.
  3295******************************************************************
  3296*0002-UPDATE-FLAG-UTLBIT.
  3297******************************************************************
  3298* ESTA RUTINA ACTUALIZA EN EL STRING DADO EL VALOR DEL FLAG DADO
  3299* RETORNANDO EL STRING ACTUALIZADO
  3300*      ALINEACION :
  3301*         0        1        2
  3302*      12345678 90123456 78901234 ..........NUMERACION DE FLAGS
  3303*      11011010 11011101 00010010 ..........FLAGS O BITS
  3304*      CARACTE1 CARACTE2 CARACTE3 ..........STRING
  3305*      PARAMETROS DE ENTRADA:
  3306*         STRING MAX 100 A FLAGEAR    INPUT-STR-UTLBIT
  3307*         LONGITUD  DEL STRING        INPUT-LEN-UTLBIT
  3308*         FLAG BUSCADO                INPUT-FLA-UTLBIT
  3309*         NUEVO VALOR DEL FLAG        INPUT-VAL-UTLBIT
  3310*      DATOS DE SALIDA:
  3311*         STRING CON EL BIT ACTUALIZ. INPUT-STR-UTLBIT
  3312*         ERROR EN DATOS(0,1,2)       OUTPUT-ERR-UTLBIT
  3313*      OBSERVACION: ESTA RUTINA NO DEBE SER USADO EN ARCHIVOS
  3314*                   LINE SEQUENTIAL
  3315******************************************************************
  3316       MOVE 0 TO OUTPUT-ERR-UTLBIT.
  3317       IF INPUT-VAL-UTLBIT = 1 OR 0
  3318          PERFORM 0001-VALOR-FLAG-UTLBIT
  3319       ELSE
  3320          MOVE 1 TO OUTPUT-ERR-UTLBIT
  3321       END-IF.
  3322       IF OUTPUT-ERR-UTLBIT = 0
  3323          IF INPUT-VAL-UTLBIT NOT = OUTPUT-VAL-UTLBIT
  3324             IF INPUT-VAL-UTLBIT = 1
  3325                COMPUTE ASCII-UTLBIT = ASCII-UTLBIT +
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  58
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/UTLB
  3326                        2 ** (8 - POSFLA-UTLBIT) + 1
  3327             ELSE
  3328                COMPUTE ASCII-UTLBIT = ASCII-UTLBIT -
  3329                        2 ** (8 - POSFLA-UTLBIT) + 1
  3330
  3331             END-IF
  3332             IF ASCII-UTLBIT > 0 AND < 257
  3333                MOVE V-UTLBIT(ASCII-UTLBIT) TO
  3334                     INPUT-STR-UTLBIT(POSCAR-UTLBIT:1)
  3335             ELSE
  3336                DISPLAY "ERROR INTERNO RUTINA DE BITS"
  3337                MOVE 2 TO OUTPUT-ERR-UTLBIT
  3338             END-IF
  3339          END-IF
  3340       END-IF.
* 3341 COPY VALVLR.PROC.
  3342* VALVLR-PROC.0004
  3343*****************************************************************
  3344* ESTE COPY CONTIENE LAS RUTINAS PARA DETERMINAR SI LOS VALORES *
  3345* SE DEBEN O NO PRESENTAR COMO REPORTADOS                       *
  3346*****************************************************************
  3347* FAC0002     * MAPBIT - SE ADICIONA MANEJO DE MAPA DE BITS     *
  3348* FLOR ANGELA *                                                 *
  3349* CUADROS     *                                                 *
  3350* VHF0002     * VLNORE - SE VERIFICA QUE EXISTAN LOS CUATRO     *
  3351* VICTOR HUGO *          VALORES DESPLEGABLES EN EL REPORTE DE  *
  3352* FORERO      *          LO CONTRARIO SE TRATA LA CUENTA COMO   *
  3353* MAY.28/2002 *          SIN VALORES REPORTADOS. SI LOS VALORES *
  3354*             *          SON ANTES DEL MAPA DE BITS Y NO        *
  3355*             *          CORRESPONDEN A LAS FECHAS VALIDAS, SE  *
  3356*             *          VERIFICA EL VALOR INICIAL SI ES > 0 SE *
  3357*             *          DESPLIEGA DE LO CONTRARIO NINGUNO      *
  3358*****************************************************************
  3359* RMB0003     * COLP02 - SE MANEJAN LAS 16 OCURRENCIAS DEL      *
  3360* R. MARTINEZ.*          MAPA DE BITS                           *
  3361* JUN.15/06   *                                                 *
  3362*****************************************************************
  3363* ABB0004     * CPYVLR - SE LEE MAPA DE BITS PARA CUENTAS NO    *
  3364* ALBEIRO B.  *          ACTIVAS                                *
  3365* SEP.21/11   *                                                 *
  3366* VHF0004     * NOVEXT - SE DUPLICA LA RUTINA PARA USO DE       *
  3367* VICTOR HUGO *          NOVEDAT EXTENDIDO                      *
  3368* FORERO      *                                                 *
  3369* ENE.27/2012 *                                                 *
  3370*****************************************************************
  3371
  3372 32000-PROCESAR-VALORES.
  3373*****************************************************************
  3374*32000-PROCESAR-VALORES.                                        *
  3375*    ESTA RUTINA SE ENCARGA DE DETERMINAR SI SE DEBEN MOSTRAR   *
  3376*    VALORES Y SI ESTOS ESTAN ACTUALIZADOS O NO                 *
  3377*****************************************************************
  3378     INITIALIZE VECTOR-VALORES-VALVLR IND-VALORES-VALVLR.         FAC0002
  3379     IF (NOV-REPORT-ABD07 = 01 OR 45 OR 47 OR
  3380        (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 42 )) AND
  3381        IND-AMPLIACION-ABD02 = 5 AND
  3382        FECHA-ACTUALIZ-VALOR-ABD07 > 0
  3383        MOVE 1 TO IND-VALORES-VALVLR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  59
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3384        MOVE FEC-NOVEDAD-ABD07 TO FEC-4-MA-VALVLR
  3385        IF ANO-4-MA-VALVLR > 60
  3386           MOVE 19 TO SIG-6-AM-VALVLR
  3387        ELSE
  3388           MOVE 20 TO SIG-6-AM-VALVLR
  3389        END-IF
  3390        MOVE ANO-4-MA-VALVLR TO ANO-6-AM-VALVLR
  3391        MOVE MES-4-MA-VALVLR TO MES-6-AM-VALVLR
  3392        MOVE FEC-6-AM-VALVLR TO FEC-NOVEDAD-AUX-VALVLR
  3393        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO FEC-6-MA-VALVLR
  3394        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR
  3395        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR
  3396        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR
  3397        MOVE FEC-6-AM-VALVLR  TO FECHA-ACT-VALOR-AUX-VALVLR
  3398        MOVE F-ULT-ACT-ABD02 TO FEC-4-MA-VALVLR
  3399        IF ANO-4-MA-VALVLR > 60
  3400           MOVE 19       TO SIG-6-AM-VALVLR
  3401        ELSE
  3402           MOVE 20       TO SIG-6-AM-VALVLR
  3403        END-IF
  3404        MOVE ANO-4-MA-VALVLR    TO ANO-6-AM-VALVLR
  3405        MOVE MES-4-MA-VALVLR    TO MES-6-AM-VALVLR
  3406        MOVE FEC-6-AM-VALVLR  TO F-ULT-ACT-AUX-VALVLR
  3407        MOVE FECHA-SITUACION-ABD07 TO FEC-6-MA-VALVLR
  3408        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR
  3409        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR
  3410        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR
  3411        MOVE FEC-6-AM-VALVLR  TO FECHA-SITUACION-AUX-VALVLR
  3412        IF IND-MAPA-BITS-VLR-ABD07 <> 9                           FAC0002
  3413           IF NOV-REPORT-ABD07 = 01 OR
  3414              (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 17)
  3415              IF (FEC-NOVEDAD-AUX-VALVLR <  200108 AND
  3416                  FEC-NOVEDAD-AUX-VALVLR <=
  3417                  FECHA-ACT-VALOR-AUX-VALVLR) OR
  3418                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND
  3419                  FEC-NOVEDAD-AUX-VALVLR >=
  3420                  FECHA-ACT-VALOR-AUX-VALVLR)
  3421                  MOVE VECTOR-ACTIVADO-VALVLR TO
  3422                       VECTOR-VALORES-VALVLR
  3423              ELSE
  3424                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0002
  3425                    VALOR-INICIAL-ABD07 > 0                       VHF0002
  3426                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0002
  3427                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0002
  3428                 ELSE                                             VHF0002
  3429                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0002
  3430                 END-IF                                           VHF0002
  3431              END-IF
  3432           END-IF
  3433           IF (NOV-REPORT-ABD07 > 16 AND NOV-REPORT-ABD07 < 42)
  3434              IF (FEC-NOVEDAD-AUX-VALVLR < 200108 AND
  3435                  FEC-NOVEDAD-AUX-VALVLR =
  3436                  FECHA-ACT-VALOR-AUX-VALVLR) OR
  3437                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND
  3438                  FEC-NOVEDAD-AUX-VALVLR >=
  3439                  FECHA-ACT-VALOR-AUX-VALVLR)
  3440                  MOVE VECTOR-ACTIVADO-VALVLR TO
  3441                       VECTOR-VALORES-VALVLR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  60
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3442              ELSE
  3443                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0002
  3444                    VALOR-INICIAL-ABD07 > 0                       VHF0002
  3445                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0002
  3446                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0002
  3447                 ELSE                                             VHF0002
  3448                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0002
  3449                 END-IF                                           VHF0002
  3450              END-IF
  3451           END-IF
  3452           IF NOV-REPORT-ABD07 = 45 OR 47
  3453              IF FEC-NOVEDAD-AUX-VALVLR <=
  3454                 FECHA-ACT-VALOR-AUX-VALVLR OR
  3455                 F-ULT-ACT-AUX-VALVLR =
  3456                 FECHA-SITUACION-AUX-VALVLR
  3457                 MOVE VECTOR-ACTIVADO-VALVLR TO
  3458                      VECTOR-VALORES-VALVLR
  3459              ELSE
  3460                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0002
  3461                    VALOR-INICIAL-ABD07 > 0                       VHF0002
  3462                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0002
  3463                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0002
  3464                 ELSE                                             VHF0002
  3465                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0002
  3466                 END-IF                                           VHF0002
  3467              END-IF
  3468           END-IF
  3469        ELSE
  3470           PERFORM 33000-LEER-BITMAP-VALORES
  3471        END-IF
  3472     END-IF
  3473     IF IND-VALORES-VALVLR = 1                                    VHF0002
  3474***     SE VERIFICA QUE POR LO MENOS UNO DE LOS CUATRO VALORES QUE
  3475***     SE DESPLIEGAN EN EL REPORTE HAYA SIDO REPORTADO DE LO
  3476***     CONTRARIO NO SE MUESTRAN VALORES PARA LA CUENTA
  3477        IF VEC-VALOR-VALVLR (01) = 0 AND                          VHF0002
  3478           VEC-VALOR-VALVLR (02) = 0 AND                          VHF0002
  3479           VEC-VALOR-VALVLR (03) = 0 AND                          VHF0002
  3480           VEC-VALOR-VALVLR (05) = 0                              VHF0002
  3481           MOVE 0 TO IND-VALORES-VALVLR                           VHF0002
  3482        END-IF                                                    VHF0002
  3483     END-IF.                                                      VHF0002
  3484
  3485 32500-PROCESAR-VALORES-EXT.                                      VHF0004
  3486***************************************************************** VHF0004
  3487*32500-PROCESAR-VALORES-EXT.                                    * VHF0004
  3488*    ESTA RUTINA SE ENCARGA DE DETERMINAR SI SE DEBEN MOSTRAR   * VHF0004
  3489*    VALORES Y SI ESTOS ESTAN ACTUALIZADOS O NO PARA NOVEDAT    * VHF0004
  3490*    EXTENDIDO                                                  * VHF0004
  3491***************************************************************** VHF0004
  3492     INITIALIZE VECTOR-VALORES-VALVLR IND-VALORES-VALVLR.         VHF0004
  3493     IF (NOV-REPORT-ABD07 = 01 OR 45 OR 47 OR                     VHF0004
  3494        (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 42 )) AND   VHF0004
  3495        IND-AMPLIACION-ABD02 = 5 AND                              VHF0004
  3496        FECHA-ACTUALIZ-VALOR-ABD07 > 0                            VHF0004
  3497        MOVE 1 TO IND-VALORES-VALVLR                              VHF0004
  3498        MOVE FEC-NOVEDAD-ABD07 TO FEC-4-MA-VALVLR                 VHF0004
  3499        IF ANO-4-MA-VALVLR > 60                                   VHF0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  61
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3500           MOVE 19 TO SIG-6-AM-VALVLR                             VHF0004
  3501        ELSE                                                      VHF0004
  3502           MOVE 20 TO SIG-6-AM-VALVLR                             VHF0004
  3503        END-IF                                                    VHF0004
  3504        MOVE ANO-4-MA-VALVLR TO ANO-6-AM-VALVLR                   VHF0004
  3505        MOVE MES-4-MA-VALVLR TO MES-6-AM-VALVLR                   VHF0004
  3506        MOVE FEC-6-AM-VALVLR TO FEC-NOVEDAD-AUX-VALVLR            VHF0004
  3507        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO FEC-6-MA-VALVLR        VHF0004
  3508        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR                  VHF0004
  3509        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR                 VHF0004
  3510        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR                  VHF0004
  3511        MOVE FEC-6-AM-VALVLR  TO FECHA-ACT-VALOR-AUX-VALVLR       VHF0004
  3512        MOVE F-ULT-ACT-ABD02 TO FEC-4-MA-VALVLR                   VHF0004
  3513        IF ANO-4-MA-VALVLR > 60                                   VHF0004
  3514           MOVE 19       TO SIG-6-AM-VALVLR                       VHF0004
  3515        ELSE                                                      VHF0004
  3516           MOVE 20       TO SIG-6-AM-VALVLR                       VHF0004
  3517        END-IF                                                    VHF0004
  3518        MOVE ANO-4-MA-VALVLR    TO ANO-6-AM-VALVLR                VHF0004
  3519        MOVE MES-4-MA-VALVLR    TO MES-6-AM-VALVLR                VHF0004
  3520        MOVE FEC-6-AM-VALVLR  TO F-ULT-ACT-AUX-VALVLR             VHF0004
  3521        MOVE FECHA-SITUACION-ABD07 TO FEC-6-MA-VALVLR             VHF0004
  3522        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR                  VHF0004
  3523        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR                 VHF0004
  3524        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR                  VHF0004
  3525        MOVE FEC-6-AM-VALVLR  TO FECHA-SITUACION-AUX-VALVLR       VHF0004
  3526        IF IND-MAPA-BITS-VLR-ABD07 <> 9                           VHF0004
  3527           IF NOV-REPORT-ABD07 = 01 OR                            VHF0004
  3528              (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 17)   VHF0004
  3529              IF (FEC-NOVEDAD-AUX-VALVLR <  200108 AND            VHF0004
  3530                  FEC-NOVEDAD-AUX-VALVLR <=                       VHF0004
  3531                  FECHA-ACT-VALOR-AUX-VALVLR) OR                  VHF0004
  3532                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND            VHF0004
  3533                  FEC-NOVEDAD-AUX-VALVLR >=                       VHF0004
  3534                  FECHA-ACT-VALOR-AUX-VALVLR)                     VHF0004
  3535                  MOVE VECTOR-ACTIVADO-VALVLR TO                  VHF0004
  3536                       VECTOR-VALORES-VALVLR                      VHF0004
  3537              ELSE                                                VHF0004
  3538                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0004
  3539                    VALOR-INICIAL-ABD07 > 0                       VHF0004
  3540                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0004
  3541                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0004
  3542                 ELSE                                             VHF0004
  3543                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0004
  3544                 END-IF                                           VHF0004
  3545              END-IF                                              VHF0004
  3546           END-IF                                                 VHF0004
  3547           IF (NOV-REPORT-ABD07 > 16 AND NOV-REPORT-ABD07 < 42)   VHF0004
  3548              IF (FEC-NOVEDAD-AUX-VALVLR < 200108 AND             VHF0004
  3549                  FEC-NOVEDAD-AUX-VALVLR =                        VHF0004
  3550                  FECHA-ACT-VALOR-AUX-VALVLR) OR                  VHF0004
  3551                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND            VHF0004
  3552                  FEC-NOVEDAD-AUX-VALVLR >=                       VHF0004
  3553                  FECHA-ACT-VALOR-AUX-VALVLR)                     VHF0004
  3554                  MOVE VECTOR-ACTIVADO-VALVLR TO                  VHF0004
  3555                       VECTOR-VALORES-VALVLR                      VHF0004
  3556              ELSE                                                VHF0004
  3557                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  62
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3558                    VALOR-INICIAL-ABD07 > 0                       VHF0004
  3559                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0004
  3560                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0004
  3561                 ELSE                                             VHF0004
  3562                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0004
  3563                 END-IF                                           VHF0004
  3564              END-IF                                              VHF0004
  3565           END-IF                                                 VHF0004
  3566           IF NOV-REPORT-ABD07 = 45 OR 47                         VHF0004
  3567              IF FEC-NOVEDAD-AUX-VALVLR <=                        VHF0004
  3568                 FECHA-ACT-VALOR-AUX-VALVLR OR                    VHF0004
  3569                 F-ULT-ACT-AUX-VALVLR =                           VHF0004
  3570                 FECHA-SITUACION-AUX-VALVLR                       VHF0004
  3571                 MOVE VECTOR-ACTIVADO-VALVLR TO                   VHF0004
  3572                      VECTOR-VALORES-VALVLR                       VHF0004
  3573              ELSE                                                VHF0004
  3574                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0004
  3575                    VALOR-INICIAL-ABD07 > 0                       VHF0004
  3576                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0004
  3577                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0004
  3578                 ELSE                                             VHF0004
  3579                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0004
  3580                 END-IF                                           VHF0004
  3581              END-IF                                              VHF0004
  3582           END-IF                                                 VHF0004
  3583        ELSE                                                      VHF0004
  3584           PERFORM 33000-LEER-BITMAP-VALORES                      VHF0004
  3585        END-IF                                                    VHF0004
  3586     ELSE                                                         ABB0004
  3587        PERFORM 33000-LEER-BITMAP-VALORES                         ABB0004
  3588     END-IF                                                       VHF0004
  3589     IF IND-VALORES-VALVLR = 1                                    VHF0004
  3590***     SE VERIFICA QUE POR LO MENOS UNO DE LOS CUATRO VALORES QUEVHF0004
  3591***     SE DESPLIEGAN EN EL REPORTE HAYA SIDO REPORTADO DE LO     VHF0004
  3592***     CONTRARIO NO SE MUESTRAN VALORES PARA LA CUENTA           VHF0004
  3593        IF VEC-VALOR-VALVLR (01) = 0 AND                          VHF0004
  3594           VEC-VALOR-VALVLR (02) = 0 AND                          VHF0004
  3595           VEC-VALOR-VALVLR (03) = 0 AND                          VHF0004
  3596           VEC-VALOR-VALVLR (05) = 0                              VHF0004
  3597           MOVE 0 TO IND-VALORES-VALVLR                           VHF0004
  3598        END-IF                                                    VHF0004
  3599     END-IF.                                                      VHF0004
  3600
  3601 33000-LEER-BITMAP-VALORES.                                       FAC0002
  3602******************************************************************
  3603*33000-LEER-BITMAP-VALORES.                                      *
  3604*   RUTINA QUE TOMA LA VARIABLE MAPA-BITS-VLR-ABD07 Y LA PASA AL *
  3605*   VECTOR DE VALORES PARA PODER PROCESAR EL BIT DE CADA VALOR   *
  3606******************************************************************
  3607    INITIALIZE VARIABLES-UTLBIT VECTOR-VALORES-VALVLR             FAC0002
  3608    MOVE MAPA-BITS-VLR-ABD07 TO INPUT-STR-UTLBIT                  FAC0002
  3609    MOVE 2 TO INPUT-LEN-UTLBIT                                    FAC0002
  3610    PERFORM VARYING FLAG-VALVLR FROM 1 BY 1 UNTIL                 FAC0002
  3611            FLAG-VALVLR > 16                                      RMB0003
  3612       INITIALIZE OUTPUT-ERR-UTLBIT OUTPUT-VAL-UTLBIT             FAC0002
  3613                  INPUT-VAL-UTLBIT                                FAC0002
  3614       MOVE FLAG-VALVLR TO INPUT-FLA-UTLBIT                       FAC0002
  3615       PERFORM 0001-VALOR-FLAG-UTLBIT                             FAC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  63
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/VALV
  3616       MOVE OUTPUT-VAL-UTLBIT TO VEC-VALOR-VALVLR(FLAG-VALVLR)    FAC0002
  3617    END-PERFORM.                                                  FAC0002
  3618*-----------------------------*
  3619
  3620*-----------------------------------------------------------------*
  3621* Rutina para manejar VALORES                                     *
  3622*-----------------------------------------------------------------*
  3623 0015-CARGUE-TABLA-BDACUE.
* 3624      COPY PE-VALORES.PROC.
  3625*PE-VALORES.PROC.v.01.0001.
  3626*------------------------------------------------*
  3627*
  3628*   COPY  VERSION  SEPTIMBRE 2004
  3629*
  3630*------------------------------------------------*
  3631* COPY Verifica valores para mostrar en informe  *
  3632*------------------------------------------------*
  3633
  3634     INITIALIZE  VAL-VARIABLES
  3635     MOVE    1   TO   T
  3636     OPEN INPUT  BDACUE
  3637     PERFORM  UNTIL SW-LOAD-TBL = 9
  3638              READ BDACUE
  3639                   AT  END
  3640                       MOVE   9 TO SW-LOAD-TBL
  3641                   NOT AT END
  3642                       IF T > 100
  3643                          MOVE   9 TO SW-LOAD-TBL
  3644                       ELSE
  3645                          MOVE  TAB-IND-VAL-BDACUE  TO
  3646                                TABLA-VAL-TIP-CTA (T)
  3647                          ADD   1   TO   T
  3648                       END-IF
  3649              END-READ
  3650     END-PERFORM
  3651     CLOSE BDACUE
  3652     COMPUTE TOPE-T = T - 1.
  3653*    DISPLAY " Cuentas cargadas (BDACUE) : "   TOPE-T.
  3654
  3655*----------------------------------------------------------------*
  3656 33000-PROCESAR-BDACUE.
  3657*----------------------------------------------------------------*
  3658*  --->    VALOR INICIAL
  3659*----------------------------------------------------------------*
  3660     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,2) = 0
  3661        MOVE  ZEROS  TO  VEC-VALOR-VALVLR (2)
  3662     END-IF
  3663
  3664*----------------------------------------------------------------*
  3665*  --->    VALOR SALDO
  3666*----------------------------------------------------------------*
  3667     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,3) = 0
  3668        MOVE  ZEROS  TO  VEC-VALOR-VALVLR (3)
  3669     END-IF
  3670
  3671*----------------------------------------------------------------*
  3672*  --->    VALOR MORA
  3673*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  64
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/PE-V
  3674     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,5) = 0
  3675        MOVE  ZEROS TO   VEC-VALOR-VALVLR (5)
  3676     END-IF
  3677*----------------------------------------------------------------*
  3678*  --->    VALOR CUOTA
  3679*----------------------------------------------------------------*
  3680     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,1) = 0
  3681        MOVE  ZEROS TO   VEC-VALOR-VALVLR (1)
  3682     END-IF.
  3683
  3684
  3685*-----------------------------------------------------------------*
  3686* Se abren los archivos de trabajo, se realiza la primera lectura *
  3687* del archivo de entrada para validar c¢digo y clave y se verIFica*
  3688* los suscriptores que esten bloqueados.                          *
  3689*-----------------------------------------------------------------*
  3690 0020-APERTURA-ARCHIVOS.
  3691     OPEN INPUT  ENTRADA
  3692     OPEN INPUT  MAESTRO-CHECK
  3693     OPEN  INPUT  MAESTRO-DIRECC                                  GDT0001
  3694     OPEN  INPUT  NOAMNISTIA21                                    GDT0001
  3695*                                                                 GDT0001
  3696     OPEN INPUT  MAESTRO-CREDIT
  3697     OPEN INPUT  SUSCRIPTOR
  3698     OPEN INPUT  BDIEMSUP
  3699     OPEN INPUT  BDIEENTI
  3700     OPEN INPUT  INDEXADO
  3701     OPEN OUTPUT SALIDA
  3702     OPEN OUTPUT ESTADIS
  3703     MOVE  FUNCTION CURRENT-DATE TO W-FECHA-HOY.
  3704
  3705*-----------------------------------------------------------------*
  3706* Se verifica si el cliente posee informaci¢n crediticia y de ser *
  3707* as¡ se llaman las rutinas para evaluar ctasctes y cartera       *
  3708*-----------------------------------------------------------------*
  3709 0030-EVALUA-CTAS.
  3710     PERFORM  UNTIL CONT-LECTURA = 999
  3711              READ ENTRADA   AT  END
  3712                       MOVE 999 TO CONT-LECTURA
  3713                   NOT AT END
  3714                       INITIALIZE W-VARIABLES
  3715                       MOVE W-VECTOR-L TO LL
  3716                       COMPUTE II = 49 - LL
  3717*
  3718                       INITIALIZE REG-SALIDA
  3719                       PERFORM 0031-FILLERS
  3720                       MOVE  999999 TO  W-FEC-MENOR-TDC
  3721                       ADD     1    TO  LEIDOS
  3722
  3723                       PERFORM 0100-EVALUA-CTASCTES
  3724
  3725                       PERFORM 0200-EVALUA-CARTERA
  3726
  3727                       PERFORM 0300-EVALUA-ENDEUDAMIENTO
  3728
  3729                       PERFORM 0400-EVALUA-CONSULTAS
  3730
  3731                       PERFORM 0500-GRABAR-SALIDA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  65
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3732
  3733              END-READ
  3734     END-PERFORM.
  3735
  3736 0031-FILLERS.
  3737     MOVE ";" TO FILLER01 FILLER02 FILLER03 FILLER04 FILLER05
  3738        FILLER06 FILLER07 FILLER08 FILLER09 FILLER10 FILLER11
  3739        FILLER12 FILLER13 FILLER14 FILLER15 FILLER16 FILLER17
  3740        FILLER18 FILLER19 FILLER20 FILLER21 FILLER22 FILLER23
  3741        FILLER24 FILLER25 FILLER26 FILLER27 FILLER28 FILLER29
  3742        FILLER30 FILLER31 FILLER32 FILLER33 FILLER34 FILLER35
  3743        FILLER36 FILLER37 FILLER38 FILLER39 FILLER40 FILLER41
  3744        FILLER42 FILLER43 FILLER44 FILLER45 FILLER46 FILLER47
  3745        FILLER48 FILLER49 FILLER50 FILLER51 FILLER52 FILLER53
  3746        FILLER54 FILLER55 FILLER56 FILLER57 FILLER58 FILLER59
  3747        FILLER60 FILLER61 FILLER62 FILLER63 FILLER64 FILLER65
  3748        FILLER66 FILLER67 FILLER68 FILLER69 FILLER70 FILLER71
  3749        FILLER72 FILLER73 FILLER74 FILLER75 FILLER76 FILLER77
  3750        FILLER78 FILLER79.
  3751
  3752*------------------------------------------------------------------*
  3753* Verifica las novedades de ctasctes y califica                    *
  3754*------------------------------------------------------------------*
  3755 0100-EVALUA-CTASCTES.
  3756     INITIALIZE     LLAVE-MAES-CHECK
  3757     MOVE  ENT-TIPO-ID  TO  TIPO-ID-ABD06
  3758     MOVE  ENT-NUME-ID  TO  NUM-ID-ABD06
  3759     PERFORM  0600-ASIGNA-ID-ICMCHK-START                         GDT0001
  3760     START MAESTRO-CHECK KEY NOT < LLAVE-MAES-CHECK
  3761           INVALID KEY
  3762                   MOVE 9 TO TIPO-ID-ABD06
  3763           NOT INVALID KEY
  3764*                   READ MAESTRO-CHECK NEXT                       GDT0001
  3765*                        AT END                                   GDT0001
  3766*                           MOVE 9 TO TIPO-ID-ABD06               GDT0001
  3767*                   END-READ                                      GDT0001
  3768     PERFORM  3000-LEE-ICMCHK-SECUENCIAL                          GDT0001
  3769     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3770                                                                  GDT0001
  3771                                                                  GDT0001
  3772                             MOVE 9 TO TIPO-ID-ABD06              GDT0001
  3773                                                                  GDT0001
  3774     END-IF                                                       GDT0001
  3775     END-START
  3776     PERFORM UNTIL  TIPO-ID-ABD06 NOT = ENT-TIPO-ID  OR
  3777                    NUM-ID-ABD06  NOT = ENT-NUME-ID
  3778           MOVE COD-SUS-ABD06  TO  COD-SUSCRIP-ABD02
  3779           MOVE COD-SUS-ABD06  TO  W-SUSCRIPTOR
  3780           READ SUSCRIPTOR  IGNORE LOCK
  3781                INVALID KEY
  3782                        MOVE 0 TO ESTADO-ABD02
  3783           END-READ
  3784           IF nov-report-abd06 > 0 AND nov-report-abd06  < 10
  3785              IF ESTADO-ABD02 = 1  AND IND-BLOQUEO-ABD06 =  0
  3786                 move tab-nov-ctac-cal (nov-report-abd06)
  3787                                    to  evalua-cta-cte
  3788
  3789                 PERFORM 0120-EVALUA-CUENTAS-BANCARIAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  66
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3790
  3791                 IF EVALUA-FINAL < evalua-cta-cte
  3792                    move evalua-cta-cte to EVALUA-FINAL
  3793                 END-IF
  3794              END-IF
  3795           END-IF
  3796*          READ MAESTRO-CHECK NEXT                                GDT0001
  3797*               AT END                                            GDT0001
  3798*                  MOVE 9 TO TIPO-ID-ABD06                        GDT0001
  3799*          END-READ                                               GDT0001
  3800     PERFORM  3000-LEE-ICMCHK-SECUENCIAL                          GDT0001
  3801     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3802                                                                  GDT0001
  3803                                                                  GDT0001
  3804                    MOVE 9 TO TIPO-ID-ABD06                       GDT0001
  3805                                                                  GDT0001
  3806     END-IF                                                       GDT0001
  3807     END-PERFORM.
  3808
  3809*-----------------------------------------------*
  3810 0120-EVALUA-CUENTAS-BANCARIAS.
  3811*-----------------------------------------------*
  3812     IF W-CODIGO-TIPOCTA = 01
  3813        EVALUATE TAB-NOV-CTAC-CODINT(NOV-REPORT-ABD06)
  3814              WHEN 30
  3815                   ADD  1  TO  W-CTES-CORRIENTES
  3816              WHEN 31
  3817                   ADD  1  TO  W-CTES-MAL-MANEJO
  3818              WHEN 32
  3819                   ADD  1  TO  W-CTES-SALDADAS
  3820              WHEN 33
  3821                   ADD  1  TO  W-CTES-EMBARGADAS
  3822              WHEN 35
  3823                   ADD  1  TO  W-CTES-CORRIENTES
  3824        END-EVALUATE
  3825     ELSE
  3826        IF TAB-NOV-CTAC-CODINT(NOV-REPORT-ABD06) = 30 OR 35
  3827           ADD   1   TO   W-CTAS-AHORROS
  3828        END-IF
  3829     END-IF.
  3830
  3831*-------------------------------------------------------*
  3832* Verifica las novedades de cartera y califica          *
  3833*-------------------------------------------------------*
  3834 0200-EVALUA-CARTERA.
  3835     INITIALIZE        LLAVE-MAES-CREDIT
  3836     MOVE   ZEROS      TO  W-SUSCRIPTOR
  3837     MOVE  ENT-TIPO-ID TO  TIPO-ID-ABD07
  3838     MOVE  ENT-NUME-ID TO  NUM-ID-ABD07
  3839     PERFORM  0500-ASIGNA-ID-ICMCRE-START                         GDT0001
  3840     START MAESTRO-CREDIT  KEY NOT < LLAVE-MAES-CREDIT
  3841           INVALID KEY
  3842                   MOVE 9 TO TIPO-ID-ABD07
  3843           NOT INVALID KEY
  3844*                  READ MAESTRO-CREDIT NEXT                       GDT0001
  3845*                           AT  END                               GDT0001
  3846*                               MOVE 9 TO TIPO-ID-ABD07           GDT0001
  3847*                        NOT AT END                               GDT0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  67
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3848*                            MOVE COD-CTA-ABD07 TO W-CTA-BDCUE    GDT0001
  3849*                            IF COD-CTA-ABD07 > 29                GDT0001
  3850*                               MOVE 11 TO COD-CTA-ABD07          GDT0001
  3851*                            END-IF                               GDT0001
  3852*                  END-READ                                       GDT0001
  3853     PERFORM  1000-LEE-ICMCRE-SECUENCIAL                          GDT0001
  3854     IF  SW-LECTURA-MAESTROS  =  0                                GDT0001
  3855                                                                  GDT0001
  3856                              MOVE COD-CTA-ABD07 TO W-CTA-BDCUE   GDT0001
  3857                              IF COD-CTA-ABD07 > 29               GDT0001
  3858                                 MOVE 11 TO COD-CTA-ABD07         GDT0001
  3859                              END-IF                              GDT0001
  3860                                                                  GDT0001
  3861     END-IF                                                       GDT0001
  3862     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3863                                                                  GDT0001
  3864                                                                  GDT0001
  3865                                 MOVE 9 TO TIPO-ID-ABD07          GDT0001
  3866     END-IF                                                       GDT0001
  3867     END-START
  3868     PERFORM UNTIL TIPO-ID-ABD07 NOT = ENT-TIPO-ID  OR
  3869                   NUM-ID-ABD07  NOT = ENT-NUME-ID
  3870           MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  3871           READ SUSCRIPTOR  IGNORE LOCK
  3872                INVALID KEY
  3873                        MOVE 0 TO ESTADO-ABD02
  3874           END-READ
  3875           IF NOV-REPORT-ABD07 > 0 AND NOV-REPORT-ABD07 < 51
  3876              IF ESTADO-ABD02  = 1 AND IND-BLOQUEO-ABD07 = 0
  3877                 move tab-nov-cart-cal (nov-report-abd07)
  3878                                   to   evalua-credito
  3879                 IF COD-CTA-ABD07 = 02 OR
  3880                    COD-SUS-ABD07 = 240033 OR 080001
  3881                    PERFORM 5000-EVALUAR-PRODUCTO
  3882                 END-IF
  3883                 IF COD-SUS-ABD07 = 020151 OR 020167 OR 020370
  3884                    MOVE   11  TO  COD-CTA-ABD07
  3885                 END-IF
  3886                 IF COD-SUS-ABD07 = 020055 OR 020007
  3887                    MOVE   03  TO  COD-CTA-ABD07
  3888                 END-IF
  3889
  3890                 INITIALIZE  W-REG-SALIDA
  3891                 PERFORM  5900-EVALUA-FECHAS
  3892                 PERFORM  1900-EVALUAR-CODEUDOR
  3893                 PERFORM  2000-EVALUAR-CLASE-CARTERA
  3894                 PERFORM  6000-CUENTA-MORAS-ACTUAL-ESTADO
  3895*                PERFORM  7500-ANALIZA-VECTOR-HISTORICO
  3896
  3897                 MOVE V-NOR(II:LL) TO  W-VECTOR-1
  3898                 MOVE W-VECTOR-1   TO  VECTOR-S
  3899                 MOVE VECTOR-S     TO  W-MORAS-HISTORICAS-V
  3900                 DISPLAY "VECTOR ; " ENT-TIPO-ID ";" ENT-NUME-ID
  3901                 ";" ENT-NOMBRE ";" NUM-CTA-ABD07 ";" W-VECTOR-1
  3902                 PERFORM  5900-CUENTA-MORAS-HISTORICAS
  3903*                 PERFORM  5800-CUENTA-MORAS-HISTORICAS
  3904                 PERFORM  6200-MORA-MAXIMA-CUENTAS
  3905                 IF EVALUA-CREDITO >  EVALUA-FINAL
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  68
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3906                    MOVE EVALUA-CREDITO TO EVALUA-FINAL
  3907                 END-IF
  3908              END-IF
  3909           END-IF
  3910*          READ MAESTRO-CREDIT NEXT                               GDT0001
  3911*               AT  END                                           GDT0001
  3912*                   MOVE 9 TO TIPO-ID-ABD07                       GDT0001
  3913*               NOT AT END                                        GDT0001
  3914*                   MOVE COD-CTA-ABD07 TO W-CTA-BDCUE             GDT0001
  3915*                   IF COD-CTA-ABD07 > 29                         GDT0001
  3916*                      MOVE 11         TO COD-CTA-ABD07           GDT0001
  3917*                   END-IF                                        GDT0001
  3918*          END-READ                                               GDT0001
  3919     PERFORM  1000-LEE-ICMCRE-SECUENCIAL                          GDT0001
  3920     IF  SW-LECTURA-MAESTROS  =  0                                GDT0001
  3921                                                                  GDT0001
  3922                     MOVE COD-CTA-ABD07 TO W-CTA-BDCUE            GDT0001
  3923                     IF COD-CTA-ABD07 > 29                        GDT0001
  3924                        MOVE 11         TO COD-CTA-ABD07          GDT0001
  3925                     END-IF                                       GDT0001
  3926                                                                  GDT0001
  3927     END-IF                                                       GDT0001
  3928     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3929                                                                  GDT0001
  3930                                                                  GDT0001
  3931                     MOVE 9 TO TIPO-ID-ABD07                      GDT0001
  3932     END-IF                                                       GDT0001
  3933     END-PERFORM.
  3934
  3935*------------------------------------------------------------------*
  3936* VerIFica el endeudamiento y calIFica                             *
  3937*------------------------------------------------------------------*
  3938 0300-EVALUA-ENDEUDAMIENTO.
  3939     move zeros       to  salir-end
  3940     MOVE    1        TO  E
  3941     move ent-tipo-id to BDIEMSUP-tip-id
  3942     move ent-nume-id to BDIEMSUP-num-id
  3943     start BDIEMSUP key >= BDIEMSUP-llave
  3944            invalid key
  3945                    move 1 to salir-end
  3946     end-start
  3947     IF salir-end  =  0
  3948        PERFORM  0330-READ-NEXT-ENDEUDA
  3949     END-IF.
  3950
  3951*----------------------------------------------------------------*
  3952* READ INDEXD ENDEUDAMIENTO                                      *
  3953*----------------------------------------------------------------*
  3954 0330-READ-NEXT-ENDEUDA.
  3955     READ BDIEMSUP next record
  3956          at end
  3957          move 9 to BDIEMSUP-tip-id
  3958     END-READ
  3959     PERFORM UNTIL BDIEMSUP-tip-id not = ent-tipo-id or
  3960                   BDIEMSUP-num-id not = ent-nume-id
  3961          IF BDIEMSUP-ind-bloq is not numeric
  3962             move 0 to BDIEMSUP-ind-bloq
  3963          END-IF
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  69
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3964          IF BDIEMSUP-ind-bloq not = 1
  3965             IF BDIEMSUP-fecha > zeros
  3966                PERFORM varying IND-E from 1 by 1
  3967                                      until IND-E > 8
  3968                     IF BDIEMSUP-CALIFICA = tab-end-cod(IND-E)
  3969                        MOVE TAB-END-CAL(IND-E)
  3970                                      TO evalua-endeuda
  3971                        MOVE TAB-END-COD(IND-E)  TO W-ENDEUDA
  3972
  3973                        PERFORM 0360-TRIMESTRE-ENDEUDA
  3974
  3975                        IF EVALUA-FINAL < evalua-endeuda
  3976                           MOVE evalua-endeuda to EVALUA-FINAL
  3977                           MOVE TAB-END-COD(IND-E) TO W-ENDEUDA
  3978                        END-IF
  3979                        ADD 7 TO IND-E
  3980                     END-IF
  3981                END-PERFORM
  3982             END-IF
  3983          END-IF
  3984          read BDIEMSUP next record
  3985               at end
  3986                  move 9 to BDIEMSUP-tip-id
  3987          end-read
  3988     END-PERFORM.
  3989
  3990*----------------------------------------------------------------*
  3991* VALORES ENDEUDAMIENTO                                          *
  3992*----------------------------------------------------------------*
  3993 0360-TRIMESTRE-ENDEUDA.
  3994      IF BDIEMSUP-CALIFICA NOT = "T"
  3995         IF SW-END = ZEROS
  3996            MOVE     1               TO  SW-END
  3997            MOVE  BDIEMSUP-CALIFICA  TO  W-MAYOR-END (E)
  3998            MOVE  BDIEMSUP-FECHA     TO  W-FECHA-END (E)
  3999         END-IF
  4000         IF BDIEMSUP-FECHA = W-FECHA-END (E)
  4001            IF BDIEMSUP-CALIFICA > W-MAYOR-END (E)
  4002               MOVE  BDIEMSUP-CALIFICA  TO  W-MAYOR-END (E)
  4003            END-IF
  4004         ELSE
  4005            ADD   1   TO   E
  4006            IF E > 3
  4007               MOVE  3  TO   E
  4008               MOVE W-MAYOR-END (E)  TO  W-MAYOR-END (2)
  4009               MOVE W-FECHA-END (E)  TO  W-FECHA-END (2)
  4010            END-IF
  4011            MOVE BDIEMSUP-FECHA      TO  W-FECHA-END (E)
  4012            MOVE BDIEMSUP-CALIFICA   TO  W-MAYOR-END (E)
  4013         END-IF
  4014      END-IF.
  4015*----------------------------------------------------------------*
  4016* Rutina que establece el numero de consultas que se hicieron por*
  4017* parte de entidades financieras solamente                       *
  4018*----------------------------------------------------------------*
  4019 0400-EVALUA-CONSULTAS.
  4020*----------------------*
  4021      INITIALIZE           LLAVE-INDEX
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  70
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4022      MOVE ENT-TIPO-ID TO  TIP-ID-IND
  4023      MOVE ENT-NUME-ID TO  NUM-ID-IND
  4024      START INDEXADO KEY NOT < LLAVE-INDEX
  4025            INVALID KEY
  4026              MOVE 9 TO TIP-ID-IND
  4027            NOT INVALID KEY
  4028                READ INDEXADO NEXT
  4029                AT END
  4030                   MOVE 9 TO TIP-ID-IND
  4031                END-READ
  4032      END-START
  4033      PERFORM UNTIL  TIP-ID-IND NOT = ENT-TIPO-ID  OR
  4034                     NUM-ID-IND NOT = ENT-NUME-ID
  4035            IF COD-SUSCRIP-IND < 800000
  4036               ADD  1  TO  W-TOTAL-CONSULTAS
  4037            END-IF
  4038            READ INDEXADO NEXT
  4039                 AT END
  4040                 MOVE 9 TO TIP-ID-IND
  4041            END-READ
  4042      END-PERFORM.
  4043
  4044*----------------------------------------------------------------*
  4045* Lee el total de inconsistencias para estadisticas              *
  4046*----------------------------------------------------------------*
  4047 0450-READ-INCONSISTENCIAS.
  4048     PERFORM  UNTIL SW-READ-INC = 9
  4049              READ INCONSIS  AT  END
  4050                   MOVE  9  TO SW-READ-INC
  4051              NOT AT END
  4052                  ADD   1   TO  W-INCONSISTENCIAS
  4053                  ADD   1   TO  W-ACUM-TIPO-ID (3, 1)
  4054              END-READ
  4055     END-PERFORM.
  4056
  4057*-----------------------------------------------------------------*
  4058* Evalua el estado final de la variable de calIFicaci¢n y arma el *
  4059* registro de salida.                                             *
  4060*-----------------------------------------------------------------*
  4061 0500-GRABAR-SALIDA.
  4062      IF EVALUA-FINAL = 1
  4063         MOVE "1" TO SLD-CALIFICACION
  4064         MOVE  1  TO F
  4065         ADD   1  TO W-CON-INFORMACION
  4066      ELSE
  4067         IF EVALUA-FINAL = 0
  4068            MOVE "5" TO SLD-CALIFICACION
  4069            MOVE  2  TO F
  4070            ADD   1  TO W-SIN-INFORMACION
  4071         END-IF
  4072      END-IF
  4073      MOVE    ENT-TIPO-ID       TO  SLD-TIPO-ID
  4074      MOVE    ENT-NUME-ID       TO  SLD-NUME-ID
  4075      MOVE    ENT-NOMBRE        TO  SLD-NOMBRE
  4076      MOVE    ENT-CIUDAD-EXP    TO  SLD-CIUDAD-EXPED
  4077      IF ENT-TIPO-ID = 1
  4078         MOVE  ENT-GENERO-VAL   TO  SLD-GENERO
  4079         MOVE  ENT-EDAD-RANGO   TO  SLD-RANGO-EDAD
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  71
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4080      END-IF
  4081      MOVE  W-CREDITOS-ACTV     TO  SLD-CREDITOS-ACTV
  4082*------------------------------------------------------*
  4083*     INFORMACION SECTOR FINANCIERO
  4084*------------------------------------------------------*
  4085      MOVE  W-NUM-OBLIG-CAB  TO  SLD-NUM-OBLIG-CAB
  4086      COMPUTE SLD-TOT-INICIAL-CAB = W-TOT-INICIAL-CAB * 1000
  4087      COMPUTE SLD-TOT-SALDOS-CAB  = W-TOT-SALDOS-CAB  * 1000
  4088      COMPUTE SLD-TOT-CUOTAS-CAB  = W-TOT-CUOTAS-CAB  * 1000
  4089      COMPUTE SLD-TOT-MORA-CAB    = W-TOT-MORA-CAB    * 1000
  4090
  4091      MOVE  W-NUM-OBLIG-CAV  TO  SLD-NUM-OBLIG-CAV
  4092      COMPUTE SLD-TOT-INICIAL-CAV = W-TOT-INICIAL-CAV * 1000
  4093      COMPUTE SLD-TOT-SALDOS-CAV  = W-TOT-SALDOS-CAV  * 1000
  4094      COMPUTE SLD-TOT-CUOTAS-CAV  = W-TOT-CUOTAS-CAV  * 1000
  4095      COMPUTE SLD-TOT-MORA-CAV    = W-TOT-MORA-CAV    * 1000
  4096
  4097      MOVE  W-NUM-OBLIG-OTR    TO  SLD-NUM-OBLIG-OTR
  4098      COMPUTE SLD-TOT-INICIAL-OTR = W-TOT-INICIAL-OTR * 1000
  4099      COMPUTE SLD-TOT-SALDOS-OTR  = W-TOT-SALDOS-OTR  * 1000
  4100      COMPUTE SLD-TOT-CUOTAS-OTR  = W-TOT-CUOTAS-OTR  * 1000
  4101      COMPUTE SLD-TOT-MORA-OTR    = W-TOT-MORA-OTR    * 1000
  4102*------------------------------------------------------*
  4103*     RANGOS DE TARJETAS ACTIVAS
  4104*------------------------------------------------------*
  4105      MOVE  W-TOT-NUM-TDC   TO  SLD-TOT-NUM-TDC
  4106      COMPUTE SLD-TOT-CUPOS-TDC = W-TOT-CUPOS-TDC * 1000
  4107      COMPUTE SLD-TOT-SALDO-TDC = W-TOT-SALDO-TDC * 1000
  4108      IF W-TOT-CUPOS-TDC > 0
  4109         COMPUTE W-UTLIZACION-TDC =
  4110         (W-SAL-CUPOS-TDC * 1000) / (W-TOT-CUPOS-TDC * 1000)
  4111         IF W-UTLIZACION-TDC > ZEROS
  4112            MOVE W-UTLIZACION-TDC  TO SLD-POR-UTILIZ-TDC
  4113         END-IF
  4114      END-IF
  4115      COMPUTE SLD-TOT-CUOTAS-TDC = W-TOT-CUOTAS-TDC * 1000
  4116      COMPUTE SLD-TOT-MORA-TDC   = W-TOT-MORA-TDC   * 1000
  4117      MOVE  W-NRO-RANGO-0     TO   SLD-NRO-RANGO-0
  4118      MOVE  W-NRO-RANGO-1     TO   SLD-NRO-RANGO-1
  4119      MOVE  W-NRO-RANGO-2     TO   SLD-NRO-RANGO-2
  4120      MOVE  W-NRO-RANGO-3     TO   SLD-NRO-RANGO-3
  4121      MOVE  W-NRO-RANGO-4     TO   SLD-NRO-RANGO-4
  4122      MOVE  W-NRO-RANGO-5     TO   SLD-NRO-RANGO-5
  4123      MOVE  W-NRO-RANGO-6     TO   SLD-NRO-RANGO-6
  4124      IF W-FEC-MENOR-TDC < 999999
  4125         MOVE W-FEC-MENOR-TDC TO   SLD-FECHA-TDC
  4126      END-IF
  4127*------------------------------------------------------*
  4128*     INFORMACION SECTOR REAL
  4129*------------------------------------------------------*
  4130      MOVE  W-NUM-OBLIG-REAL TO  SLD-NUM-OBLIG-REAL
  4131      COMPUTE SLD-TOT-INICIAL-REAL = W-TOT-INICIAL-REAL * 1000
  4132      COMPUTE SLD-TOT-SALDOS-REAL = W-TOT-SALDOS-REAL * 1000
  4133      COMPUTE SLD-TOT-CUOTAS-REAL = W-TOT-CUOTAS-REAL * 1000
  4134      COMPUTE SLD-TOT-MORA-REAL   = W-TOT-MORA-REAL   * 1000
  4135*------------------------------------------------------*
  4136*     INFORMACION SECTOR TELCOS
  4137*------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  72
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4138     MOVE W-NUM-OBLIG-TELE   TO   SLD-NUM-OBLIG-TELE
  4139     COMPUTE  SLD-TOT-CUOTAS-TELE = W-TOT-CUOTAS-TELE * 1000
  4140     COMPUTE  SLD-TOT-MORA-TELE   = W-TOT-MORA-TELE * 1000
  4141*------------------------------------------------------*
  4142*     INFORMACION SECTOR COOPERATIVO
  4143*------------------------------------------------------*
  4144      MOVE  W-NUM-OBLIG-COOP TO  SLD-NUM-OBLIG-COOP
  4145      COMPUTE SLD-TOT-INICIAL-COOP = W-TOT-INICIAL-COOP * 1000
  4146      COMPUTE SLD-TOT-SALDOS-COOP = W-TOT-SALDOS-COOP * 1000
  4147      COMPUTE SLD-TOT-CUOTAS-COOP = W-TOT-CUOTAS-COOP * 1000
  4148      COMPUTE SLD-TOT-MORA-COOP   = W-TOT-MORA-COOP   * 1000
  4149*------------------------------------------------------*
  4150*     INFORMACION CODEUDORES
  4151*------------------------------------------------------*
  4152      MOVE W-NUM-OBLIG-CODEU  TO  SLD-NUM-OBLIG-CODEU
  4153      COMPUTE SLD-TOT-SALDOS-CODEU = W-TOT-SALDOS-CODEU * 1000
  4154      COMPUTE SLD-TOT-CUOTAS-CODEU = W-TOT-CUOTAS-CODEU * 1000
  4155      COMPUTE SLD-TOT-MORA-CODEU   = W-TOT-MORA-CODEU   * 1000
  4156*------------------------------------------------------*
  4157*     MORAS  ACTUALES
  4158*------------------------------------------------------*
  4159      MOVE   W-CREDITOS-ALDIA    TO   SLD-CREDITOS-ALDIA
  4160      MOVE   W-MORAS-30-ACT      TO   SLD-MORA-30
  4161      MOVE   W-MORAS-60-ACT      TO   SLD-MORA-60
  4162      MOVE   W-MORAS-90-ACT      TO   SLD-MORA-90
  4163      MOVE   W-MORAS-120-ACT     TO   SLD-MORA-120
  4164      MOVE   W-CAR-CASTIGA       TO   SLD-CAR-CASTIGA
  4165      MOVE   W-DUD-RECAUDO       TO   SLD-DUD-RECAUDO
  4166      MOVE   W-CUENTAS-COBRADOR  TO   SLD-CUENTAS-COBRADOR
  4167*------------------------------------------------------*
  4168*     MORAS  HISTORICAS
  4169*------------------------------------------------------*
  4170      MOVE  W-MORAS-30-HIS       TO   SLD-MORA-30-HIS
  4171      MOVE  W-MORAS-60-HIS       TO   SLD-MORA-60-HIS
  4172      MOVE  W-MORAS-90-HIS       TO   SLD-MORA-90-HIS
  4173      MOVE  W-MORAS-120-HIS      TO   SLD-MORA-120-HIS
  4174      MOVE  W-CANC-MMANEJO       TO   SLD-CANC-MMANEJO
  4175      MOVE  W-CAR-RECUPERADA     TO   SLD-CAR-RECUPERADA
  4176*------------------------------------------------------*
  4177*     MORAS  MAXIMAS POR SECTOR
  4178*------------------------------------------------------*
  4179      MOVE  W-MORA-MAX-TDC      TO   SLD-MORA-MAX-TDC
  4180      MOVE  W-MORA-MAX-CAB      TO   SLD-MORA-MAX-CAB
  4181      MOVE  W-MORA-MAX-COOP     TO   SLD-MORA-MAX-COOP
  4182      MOVE  W-MORA-MAX-CAV      TO   SLD-MORA-MAX-CAV
  4183*------------------------------------------------------*
  4184*     ENDEUDAMIENTO
  4185*------------------------------------------------------*
  4186      IF E = 3
  4187         MOVE  W-MAYOR-END (3) TO SLD-END-CALIF-1-TRIM
  4188         MOVE  W-MAYOR-END (2) TO SLD-END-CALIF-2-TRIM
  4189      ELSE
  4190         IF E = 2
  4191            MOVE W-MAYOR-END (2) TO SLD-END-CALIF-1-TRIM
  4192            MOVE W-MAYOR-END (1) TO SLD-END-CALIF-2-TRIM
  4193         ELSE
  4194            MOVE W-MAYOR-END (1) TO SLD-END-CALIF-1-TRIM
  4195            MOVE SPACES          TO SLD-END-CALIF-2-TRIM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  73
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4196         END-IF
  4197      END-IF
  4198*------------------------------------------------------*
  4199*     CUENTA CORRIENTE
  4200*------------------------------------------------------*
  4201      MOVE  W-CTAS-AHORROS        TO  SLD-CTAS-AHORRO
  4202      MOVE  W-CTES-CORRIENTES     TO  SLD-CTES-CORRIENTES
  4203      MOVE  W-CTES-EMBARGADAS     TO  SLD-CTES-EMBARGADAS
  4204      MOVE  W-CTES-MAL-MANEJO     TO  SLD-CTES-MAL-MANEJO
  4205      MOVE  W-CTES-SALDADAS       TO  SLD-CTES-SALDADAS
  4206      MOVE  W-TOTAL-CONSULTAS     TO  SLD-TOTAL-CONSULTAS
  4207      PERFORM 1000-ACUMULAR-ESTADISTICO
  4208      WRITE REG-SALIDA
  4209      ADD    1    TO  GRABADOS.
  4210
  4211*----------------------------------------*
  4212* Rutina manejo valores estadisticos     *
  4213*----------------------------------------*
  4214 1000-ACUMULAR-ESTADISTICO.
  4215     IF ENT-TIPO-ID = 1
  4216        EVALUATE ENT-EDAD-RANGO
  4217              WHEN "66+  "
  4218                   ADD  1  TO  W-EDAD-66
  4219              WHEN "56-65"
  4220                   ADD  1  TO  W-EDAD-56-65
  4221              WHEN "46-55"
  4222                   ADD  1  TO  W-EDAD-46-55
  4223              WHEN "36-45"
  4224                   ADD  1  TO  W-EDAD-36-45
  4225              WHEN "29-35"
  4226                   ADD  1  TO  W-EDAD-29-35
  4227              WHEN "22-28"
  4228                   ADD  1  TO  W-EDAD-22-28
  4229              WHEN "18-21"
  4230                   ADD  1  TO  W-EDAD-18-21
  4231        END-EVALUATE
  4232     END-IF
  4233     PERFORM  1100-ACUMULAR-ESTADO.
  4234
  4235*------------------------------------------------------------*
  4236*    ACUMULACION PARA CLIENTES POR ESTADO
  4237*------------------------------------------------------------*
  4238 1100-ACUMULAR-ESTADO.
  4239     ADD   1   TO  W-ACUM-TIPO-ID (F, 1)
  4240     IF ENT-TIPO-ID = 1
  4241        IF ENT-GENERO-VAL = "M"
  4242           ADD  1  TO  W-ACUM-TIPO-ID (F, 2)
  4243        ELSE
  4244           IF ENT-GENERO-VAL = "F"
  4245              ADD  1  TO  W-ACUM-TIPO-ID (F, 3)
  4246           ELSE
  4247              ADD  1  TO  W-ACUM-TIPO-ID (F, 2)
  4248           END-IF
  4249        END-IF
  4250     ELSE
  4251        IF ENT-TIPO-ID = 4
  4252           ADD  1  TO  W-ACUM-TIPO-ID (F, 4)
  4253        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  74
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4254           ADD  1  TO  W-ACUM-TIPO-ID (F, 5)
  4255        END-IF
  4256     END-IF
  4257     IF F = 1
  4258        PERFORM  1200-SELECT-PEOR-ESTADO
  4259        PERFORM  1400-SELECT-SECTOR
  4260     END-IF.
  4261
  4262*------------------------------------------------------------*
  4263*    PEOR ESTADO ACTUAL INFORME GENERAL
  4264*------------------------------------------------------------*
  4265 1200-SELECT-PEOR-ESTADO.
  4266     IF W-CAR-CASTIGA > ZEROS
  4267        ADD 1 TO W-TOT-CAR-CASTIGA
  4268     ELSE
  4269        IF W-DUD-RECAUDO > ZEROS
  4270           ADD 1 TO W-TOT-DUD-RECAUDO
  4271        ELSE
  4272           IF W-CTES-EMBARGADAS > ZEROS
  4273              ADD 1 TO W-TOT-CTES-EMBARGADAS
  4274           ELSE
  4275              IF W-MORAS-120-ACT  > ZEROS
  4276                 ADD 1 TO W-TOT-MORAS-120-ACT
  4277              ELSE
  4278                 IF W-MORAS-90-ACT  > ZEROS
  4279                    ADD 1 TO W-TOT-MORAS-90-ACT
  4280                 ELSE
  4281                    IF W-MORAS-60-ACT > ZEROS
  4282                       ADD 1 TO W-TOT-MORAS-60-ACT
  4283                    ELSE
  4284                       IF W-MORAS-30-ACT  > ZEROS
  4285                          ADD 1 TO W-TOT-MORAS-30-ACT
  4286                       ELSE
  4287                          IF W-ENDEUDA = "B" OR "C" OR
  4288                                         "D" OR "E"
  4289                             ADD 1 TO W-TOT-W-ENDEUDA
  4290                          ELSE
  4291                             IF W-CREDITOS-ALDIA > ZEROS OR
  4292                                W-ENDEUDA = "A"
  4293                                ADD 1 TO W-TOT-ALDIA
  4294                             ELSE
  4295                                ADD 1 TO W-TOT-SIN-CTAS
  4296                             END-IF
  4297                          END-IF
  4298                       END-IF
  4299                    END-IF
  4300                 END-IF
  4301              END-IF
  4302           END-IF
  4303        END-IF
  4304     END-IF.
  4305
  4306*------------------------------------------------------------*
  4307*    PEOR ESTADO ACTUAL SECTORES
  4308*------------------------------------------------------------*
  4309 1400-SELECT-SECTOR.
  4310      IF W-CC-DR-FINA > ZEROS
  4311         ADD 1 TO W-TOT-CC-DR-FINA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  75
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4312      ELSE
  4313         IF W-MORAS-FINA > ZEROS
  4314            ADD 1 TO W-TOT-MORAS-FINA
  4315         ELSE
  4316            IF W-ALDIA-FINA > ZEROS
  4317               ADD 1 TO W-TOT-ALDIA-FINA
  4318            END-IF
  4319         END-IF
  4320      END-IF
  4321      IF W-CC-DR-REAL > ZEROS
  4322         ADD 1 TO W-TOT-CC-DR-REAL
  4323      ELSE
  4324         IF W-MORAS-REAL > ZEROS
  4325            ADD 1 TO W-TOT-MORAS-REAL
  4326         ELSE
  4327            IF W-ALDIA-REAL > ZEROS
  4328               ADD 1 TO W-TOT-ALDIA-REAL
  4329            END-IF
  4330         END-IF
  4331      END-IF
  4332      IF W-CC-DR-COOP > ZEROS
  4333         ADD 1 TO W-TOT-CC-DR-COOP
  4334      ELSE
  4335         IF W-MORAS-COOP > ZEROS
  4336            ADD 1 TO W-TOT-MORAS-COOP
  4337         ELSE
  4338            IF W-ALDIA-COOP > ZEROS
  4339               ADD 1 TO W-TOT-ALDIA-COOP
  4340            END-IF
  4341         END-IF
  4342      END-IF
  4343      IF W-CC-DR-TELE > ZEROS
  4344         ADD 1 TO W-TOT-CC-DR-TELE
  4345      ELSE
  4346         IF W-MORAS-TELE > ZEROS
  4347            ADD 1 TO W-TOT-MORAS-TELE
  4348         ELSE
  4349            IF W-ALDIA-TELE > ZEROS
  4350               ADD 1 TO W-TOT-ALDIA-TELE
  4351            END-IF
  4352         END-IF
  4353      END-IF.
  4354*-------------------------------------*
  4355* REVISA CODEUDOR                     *
  4356*-------------------------------------*
  4357 1900-EVALUAR-CODEUDOR.
  4358      MOVE  ZEROS        TO SW-CODEUDOR
  4359      MOVE NUM-CTA-ABD07 TO TEM-NRO-CTA
  4360      IF TEM-NRO-CTA-C17 = "C" OR "c"
  4361         MOVE  1 TO  SW-CODEUDOR
  4362      ELSE
  4363         IF GARANTE-ABD07 > ZEROS AND GARANTE-ABD07 < 8 AND
  4364           (IND-AMPLIACION-ABD02 = 5 OR 2)
  4365            MOVE  1  TO  SW-CODEUDOR
  4366         END-IF
  4367      END-IF.
  4368
  4369*-------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  76
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4370* EVALUA TODA CLASE DE CARTERA PARA INFORMES
  4371*-------------------------------------------------*
  4372 2000-EVALUAR-CLASE-CARTERA.
  4373     IF TAB-VIGENTES-CARTERA (NOV-REPORT-ABD07) = 1
  4374        PERFORM 32000-PROCESAR-VALORES
  4375        PERFORM 33000-PROCESAR-BDACUE
  4376        ADD   1   TO   W-CREDITOS-ACTV
  4377        IF SW-CODEUDOR = ZEROS
  4378           IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4379              PERFORM 2200-SECTOR-FINANCIERO
  4380           ELSE
  4381              IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4382                 PERFORM 4200-SECTOR-REAL
  4383              ELSE
  4384                 IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4385                    PERFORM 4400-SECTOR-COOPERATIVO
  4386                 ELSE
  4387                    IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4388                       PERFORM 4000-SECTOR-TELCOS
  4389                    END-IF
  4390                 END-IF
  4391              END-IF
  4392           END-IF
  4393        ELSE
  4394           PERFORM  4600-VALORES-CODEUDORES
  4395        END-IF
  4396     END-IF.
  4397
  4398*----------------------------------------------------------------*
  4399* EVALUA VALORES SECTOR FINANCIERO
  4400*----------------------------------------------------------------*
  4401 2200-SECTOR-FINANCIERO.
  4402      IF COD-CTA-ABD07 = 02
  4403         PERFORM 3000-EVALUA-TDC-ACTIVA
  4404      ELSE
  4405         IF COD-CTA-ABD07 = 13
  4406            PERFORM 2300-ACUM-VLRES-CAV
  4407         ELSE
  4408            IF COD-CTA-ABD07 = 05 OR 03
  4409               IF TIPO-OBLIGACION-ABD07 = 3
  4410                  PERFORM 2300-ACUM-VLRES-CAV
  4411               ELSE
  4412                  PERFORM 2400-ACUM-VLRES-CAB
  4413               END-IF
  4414            ELSE
  4415               PERFORM 2500-ACUM-VLRES-OTROS
  4416            END-IF
  4417         END-IF
  4418      END-IF.
  4419
  4420*----------------------------------------------------------------*
  4421* VALORES CARTERA  CAV
  4422*----------------------------------------------------------------*
  4423 2300-ACUM-VLRES-CAV.
  4424      ADD  1  TO  W-NUM-OBLIG-CAV
  4425      IF IND-VALORES-VALVLR = 1
  4426         IF VEC-VALOR-VALVLR (2) = 1
  4427            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-CAV
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  77
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4428         END-IF
  4429         IF VEC-VALOR-VALVLR (3) = 1
  4430            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-CAV
  4431                                            W-SALDOS-SEC-FINA
  4432         END-IF
  4433         IF VEC-VALOR-VALVLR (1) = 1
  4434            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-CAV
  4435                                            W-CUOTAS-SEC-FINA
  4436         END-IF
  4437         IF VEC-VALOR-VALVLR (5) = 1
  4438            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4439               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4440            END-IF
  4441            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-CAV
  4442                                            W-MORAS-SEC-FINA
  4443         END-IF
  4444      END-IF.
  4445
  4446*----------------------------------------------------------------*
  4447* VALORES CARTERA  CAB
  4448*----------------------------------------------------------------*
  4449 2400-ACUM-VLRES-CAB.
  4450      ADD  1  TO  W-NUM-OBLIG-CAB
  4451      IF IND-VALORES-VALVLR = 1
  4452         IF VEC-VALOR-VALVLR (2) = 1
  4453            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-CAB
  4454         END-IF
  4455         IF VEC-VALOR-VALVLR (3) = 1
  4456            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-CAB
  4457                                            W-SALDOS-SEC-FINA
  4458         END-IF
  4459         IF VEC-VALOR-VALVLR (1) = 1
  4460            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-CAB
  4461                                            W-CUOTAS-SEC-FINA
  4462         END-IF
  4463         IF VEC-VALOR-VALVLR (5) = 1
  4464            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4465               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4466            END-IF
  4467            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-CAB
  4468                                            W-MORAS-SEC-FINA
  4469         END-IF
  4470      END-IF.
  4471
  4472*----------------------------------------------------------------*
  4473* VALORES CARTERA  OTRAS CUENTAS SECTOR FINANCIERO
  4474*----------------------------------------------------------------*
  4475 2500-ACUM-VLRES-OTROS.
  4476      ADD  1  TO  W-NUM-OBLIG-OTR
  4477      IF IND-VALORES-VALVLR = 1
  4478         IF VEC-VALOR-VALVLR (2) = 1
  4479            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-OTR
  4480         END-IF
  4481         IF VEC-VALOR-VALVLR (3) = 1
  4482            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-OTR
  4483                                            W-SALDOS-SEC-FINA
  4484         END-IF
  4485         IF VEC-VALOR-VALVLR (1) = 1
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  78
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4486            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-OTR
  4487                                            W-CUOTAS-SEC-FINA
  4488         END-IF
  4489         IF VEC-VALOR-VALVLR (5) = 1
  4490            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4491               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4492            END-IF
  4493            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-OTR
  4494                                            W-MORAS-SEC-FINA
  4495         END-IF
  4496      END-IF.
  4497
  4498*----------------------------------------------------------------*
  4499* EVALUAR VALORES DE TARJETA DE CREDITO                          *
  4500*----------------------------------------------------------------*
  4501 3000-EVALUA-TDC-ACTIVA.
  4502      ADD   1    TO    W-TOT-NUM-TDC
  4503      IF IND-VALORES-VALVLR = 1
  4504         IF VEC-VALOR-VALVLR (2) = 1
  4505            IF VALOR-INICIAL-ABD07 > ZEROS
  4506               ADD VALOR-INICIAL-ABD07  TO W-TOT-CUPOS-TDC
  4507               IF VEC-VALOR-VALVLR (3) = 1
  4508                  ADD VALOR-SALDO-DEUDAM-ABD07
  4509                                        TO W-SAL-CUPOS-TDC
  4510               END-IF
  4511            END-IF
  4512         END-IF
  4513         IF VEC-VALOR-VALVLR (3) = 1
  4514            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDO-TDC
  4515                                            W-SALDOS-SEC-FINA
  4516         END-IF
  4517         IF VEC-VALOR-VALVLR (1) = 1
  4518            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-TDC
  4519                                            W-CUOTAS-SEC-FINA
  4520         END-IF
  4521         IF VEC-VALOR-VALVLR (5) = 1
  4522            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4523               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4524            END-IF
  4525            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-TDC
  4526                                            W-MORAS-SEC-FINA
  4527         END-IF
  4528      END-IF
  4529      IF IND-VALORES-VALVLR = 1
  4530         IF VEC-VALOR-VALVLR (2) = 1
  4531            IF VALOR-INICIAL-ABD07 = ZEROS
  4532               ADD   1   TO   W-NRO-RANGO-0
  4533            ELSE
  4534               IF VALOR-INICIAL-ABD07 <= 1000
  4535                  ADD   1   TO   W-NRO-RANGO-1
  4536               ELSE
  4537                  IF VALOR-INICIAL-ABD07 <= 2000
  4538                     ADD   1   TO   W-NRO-RANGO-2
  4539                  ELSE
  4540                     IF VALOR-INICIAL-ABD07 <= 4000
  4541                        ADD   1   TO   W-NRO-RANGO-3
  4542                     ELSE
  4543                        IF VALOR-INICIAL-ABD07 <= 8000
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  79
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4544                           ADD   1   TO   W-NRO-RANGO-4
  4545                        ELSE
  4546                           IF VALOR-INICIAL-ABD07 <= 12000
  4547                              ADD   1   TO   W-NRO-RANGO-5
  4548                           ELSE
  4549                              ADD   1   TO   W-NRO-RANGO-6
  4550                           END-IF
  4551                        END-IF
  4552                     END-IF
  4553                  END-IF
  4554               END-IF
  4555            END-IF
  4556         ELSE
  4557            ADD   1   TO   W-NRO-RANGO-0
  4558         END-IF
  4559      ELSE
  4560         ADD   1   TO   W-NRO-RANGO-0
  4561      END-IF
  4562      MOVE  ZEROS             TO  W-FECHA-AUX
  4563      MOVE FECHA-APERT-ABD07  TO  W-FECHA-AUX
  4564      MOVE  W-MES-AUX         TO  W-FMILENIO-MES
  4565      MOVE  W-ANO-AUX         TO  W-FMILENIO-ANIO
  4566      IF W-ANO-AUX   > 60
  4567         MOVE 19              TO  W-FMILENIO-SIGLO
  4568      ELSE
  4569         MOVE 20              TO  W-FMILENIO-SIGLO
  4570      END-IF
  4571      MOVE  W-FECHA-MILENIO   TO  W-FEC-APERTURA
  4572      IF W-FEC-APERTURA < W-FEC-MENOR-TDC
  4573         MOVE W-FEC-APERTURA  TO  W-FEC-MENOR-TDC
  4574      END-IF.
  4575
  4576*----------------------------------------------------------------*
  4577* VALORES SECTOR TELCOS
  4578*----------------------------------------------------------------*
  4579 4000-SECTOR-TELCOS.
  4580      ADD  1  TO  W-NUM-OBLIG-TELE
  4581      IF IND-VALORES-VALVLR = 1
  4582         IF VEC-VALOR-VALVLR (1) = 1
  4583            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-TELE
  4584         END-IF
  4585         IF VEC-VALOR-VALVLR (5) = 1
  4586            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4587               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4588            END-IF
  4589            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-TELE
  4590         END-IF
  4591      END-IF.
  4592
  4593*----------------------------------------------------------------*
  4594* VALORES CARTERA  SECTOR REAL
  4595*----------------------------------------------------------------*
  4596 4200-SECTOR-REAL.
  4597      ADD  1  TO  W-NUM-OBLIG-REAL
  4598      IF IND-VALORES-VALVLR = 1
  4599         IF VEC-VALOR-VALVLR (2) = 1
  4600            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-REAL
  4601         END-IF
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  80
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4602         IF VEC-VALOR-VALVLR (3) = 1
  4603            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-REAL
  4604                                            W-SALDOS-SEC-REAL
  4605         END-IF
  4606         IF VEC-VALOR-VALVLR (1) = 1
  4607            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-REAL
  4608                                            W-CUOTAS-SEC-REAL
  4609         END-IF
  4610         IF VEC-VALOR-VALVLR (5) = 1
  4611            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4612               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4613            END-IF
  4614            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-REAL
  4615                                            W-MORAS-SEC-REAL
  4616         END-IF
  4617      END-IF.
  4618
  4619*----------------------------------------------------------------*
  4620* VALORES CARTERA  SECTOR COOPERATIVO
  4621*----------------------------------------------------------------*
  4622 4400-SECTOR-COOPERATIVO.
  4623      ADD  1  TO  W-NUM-OBLIG-COOP
  4624      IF IND-VALORES-VALVLR = 1
  4625         IF VEC-VALOR-VALVLR (2) = 1
  4626            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-COOP
  4627         END-IF
  4628         IF VEC-VALOR-VALVLR (3) = 1
  4629            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-COOP
  4630                                            W-SALDOS-SEC-COOP
  4631         END-IF
  4632         IF VEC-VALOR-VALVLR (1) = 1
  4633            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-COOP
  4634                                            W-CUOTAS-SEC-COOP
  4635         END-IF
  4636         IF VEC-VALOR-VALVLR (5) = 1
  4637            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4638               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4639            END-IF
  4640            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-COOP
  4641                                            W-MORAS-SEC-COOP
  4642         END-IF
  4643      END-IF.
  4644
  4645*--------------------------------------------------*
  4646* REVISA VALORES DE CODEUDORES
  4647*--------------------------------------------------*
  4648 4600-VALORES-CODEUDORES.
  4649      ADD  1  TO  W-NUM-OBLIG-CODEU
  4650      IF IND-VALORES-VALVLR = 1
  4651         IF VEC-VALOR-VALVLR (3) = 1
  4652            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-CODEU
  4653         END-IF
  4654         IF VEC-VALOR-VALVLR (1) = 1
  4655            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-CODEU
  4656         END-IF
  4657         IF VEC-VALOR-VALVLR (5) = 1
  4658            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4659               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  81
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4660            END-IF
  4661            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-CODEU
  4662         END-IF
  4663      END-IF.
  4664
  4665*----------------------------------------------------------------*
  4666* RECATEGORIZA EL PRODUCTO DEPENDIENDO DEL SUSCRIPTOR            *
  4667*----------------------------------------------------------------*
  4668 5000-EVALUAR-PRODUCTO.
  4669*---------------------*
  4670     IF COD-SUS-ABD07 = 080001
  4671        IF TAB-VIGENTES-CARTERA (NOV-REPORT-ABD07) = 1
  4672           PERFORM 32000-PROCESAR-VALORES
  4673           PERFORM 33000-PROCESAR-BDACUE
  4674           IF IND-VALORES-VALVLR    = 1 AND
  4675              VEC-VALOR-VALVLR (11) = 1
  4676              IF TOTAL-CUOTAS-ABD07 > 60
  4677                 MOVE  13  TO  COD-CTA-ABD07
  4678              END-IF
  4679           END-IF
  4680        END-IF
  4681     ELSE
  4682        IF COD-SUS-ABD07 = 020151 OR 020167 OR 020370
  4683           MOVE   11  TO  COD-CTA-ABD07
  4684        ELSE
  4685           IF COD-SUS-ABD07 = 020055 OR 020007
  4686              MOVE   03  TO  COD-CTA-ABD07
  4687           ELSE
  4688              IF COD-SUS-ABD07 = 240033
  4689                 MOVE   23  TO  COD-CTA-ABD07
  4690              END-IF
  4691           END-IF
  4692        END-IF
  4693     END-IF.
  4694
  4695*----------------------------------------------------------------*
  4696* CUENTA MORAS ACTUALES Y ESTADOS ESPECIALES                     *
  4697*----------------------------------------------------------------*
  4698 6000-CUENTA-MORAS-ACTUAL-ESTADO.
  4699      EVALUATE TAB-NOV-CART-CODINT(NOV-REPORT-ABD07)
  4700           WHEN 01
  4701                ADD  1  TO  W-CREDITOS-ALDIA
  4702           WHEN 12
  4703                ADD  1  TO  W-MORAS-30-ACT
  4704           WHEN 13
  4705                ADD  1  TO  W-MORAS-60-ACT
  4706           WHEN 14
  4707                ADD  1  TO  W-MORAS-90-ACT
  4708           WHEN 15
  4709                ADD  1  TO  W-MORAS-120-ACT
  4710           WHEN 09
  4711                ADD  1  TO  W-CAR-CASTIGA
  4712           WHEN 11
  4713                ADD  1  TO  W-DUD-RECAUDO
  4714           WHEN 08
  4715                ADD  1  TO  W-CANC-MMANEJO
  4716           WHEN 10
  4717                ADD  1  TO  W-CAR-RECUPERADA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  82
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4718      END-EVALUATE
  4719      IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 01
  4720         IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4721            ADD  1  TO  W-ALDIA-FINA
  4722         ELSE
  4723            IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4724               ADD  1  TO  W-ALDIA-REAL
  4725            ELSE
  4726               IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4727                  ADD  1  TO  W-ALDIA-COOP
  4728               ELSE
  4729                  IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4730                     ADD  1  TO  W-ALDIA-TELE
  4731                  END-IF
  4732               END-IF
  4733            END-IF
  4734         END-IF
  4735      ELSE
  4736         IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 12 OR 13
  4737                                                OR  14 OR 15
  4738            IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4739               ADD  1  TO  W-MORAS-FINA
  4740            ELSE
  4741               IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4742                  ADD  1  TO  W-MORAS-REAL
  4743               ELSE
  4744                  IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4745                     ADD  1  TO  W-MORAS-COOP
  4746                  ELSE
  4747                     IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4748                        ADD  1  TO  W-MORAS-TELE
  4749                     END-IF
  4750                  END-IF
  4751               END-IF
  4752            END-IF
  4753         ELSE
  4754            IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 09 OR 11
  4755               IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4756                  ADD  1  TO  W-CC-DR-FINA
  4757               ELSE
  4758                  IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4759                     ADD  1  TO  W-CC-DR-REAL
  4760                  ELSE
  4761                     IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4762                        ADD  1  TO  W-CC-DR-COOP
  4763                     ELSE
  4764                        IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4765                           ADD  1  TO  W-CC-DR-TELE
  4766                        END-IF
  4767                     END-IF
  4768                  END-IF
  4769               END-IF
  4770            END-IF
  4771         END-IF
  4772      END-IF.
  4773
  4774*-------------------------------------------*
  4775*    DETERMINACION DE LA MORA MAXIMA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  83
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4776*-------------------------------------------*
  4777 6200-MORA-MAXIMA-CUENTAS.
  4778     IF COD-CTA-ABD07 = 03 OR 05
  4779        IF TIPO-OBLIGACION-ABD07 = 3
  4780           IF MORA-MAXIMA-ABD07 > W-MORA-MAX-CAV
  4781              MOVE  MORA-MAXIMA-ABD07 TO W-MORA-MAX-CAV
  4782           END-IF
  4783        ELSE
  4784           IF MORA-MAXIMA-ABD07 > W-MORA-MAX-CAB
  4785              MOVE  MORA-MAXIMA-ABD07  TO  W-MORA-MAX-CAB
  4786           END-IF
  4787        END-IF
  4788     ELSE
  4789        IF COD-CTA-ABD07 = 02
  4790           IF MORA-MAXIMA-ABD07 > W-MORA-MAX-TDC
  4791              MOVE  MORA-MAXIMA-ABD07  TO  W-MORA-MAX-TDC
  4792           END-IF
  4793        ELSE
  4794           IF COD-CTA-ABD07 = 13
  4795              IF MORA-MAXIMA-ABD07 > W-MORA-MAX-CAV
  4796                 MOVE  MORA-MAXIMA-ABD07 TO W-MORA-MAX-CAV
  4797              END-IF
  4798           ELSE
  4799              IF COD-CTA-ABD07 = 06 OR 27
  4800                 IF MORA-MAXIMA-ABD07 > W-MORA-MAX-COOP
  4801                    MOVE  MORA-MAXIMA-ABD07 TO  W-MORA-MAX-COOP
  4802                 END-IF
  4803              END-IF
  4804           END-IF
  4805        END-IF
  4806     END-IF
  4807     IF ADJETIVO1-ABD07 = 2  OR
  4808        ADJETIVO2-ABD07 = 2  OR
  4809        ADJETIVO3-ABD07 = 2
  4810        ADD  1 TO W-CUENTAS-COBRADOR
  4811     END-IF.
  4812
  4813*----------------------------------------------------------------*
  4814* EVALUA  SI EN EL ULTIMO AÑO TUVO ALGUN TIPO DE MORA            *
  4815*----------------------------------------------------------------*
  4816 5800-CUENTA-MORAS-HISTORICAS.
  4817      MOVE    ZEROS     TO     TOPE-V
  4818      IF TAB-VIGENTES-CARTERA (NOV-REPORT-ABD07) = 1
  4819         MOVE     12       TO  TOPE-V
  4820         PERFORM  5900-CUENTA-MORAS-HIST-12MESES
  4821      ELSE
  4822         MOVE  ZEROS              TO  W-FECHA-AUX
  4823         MOVE  FEC-NOVEDAD-ABD07  TO  W-FECHA-AUX
  4824         MOVE  W-MES-AUX          TO  W-FMILENIO-MES
  4825         MOVE  W-ANO-AUX          TO  W-FMILENIO-ANIO
  4826         IF W-ANO-AUX   > 60
  4827            MOVE 19               TO  W-FMILENIO-SIGLO
  4828         ELSE
  4829            MOVE 20               TO  W-FMILENIO-SIGLO
  4830         END-IF
  4831         MOVE  W-FECHA-MILENIO    TO  W-FEC-NOVEDAD
  4832         MOVE    ZEROS            TO  W-MESES-NOV
  4833         COMPUTE W-MESES-NOV =
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  84
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4834                (W-ANO-HOY * 12 + W-MES-HOY) -
  4835                (W-ANO-NOV * 12 + W-MES-NOV)
  4836         IF W-MESES-NOV < 13
  4837            COMPUTE  TOPE-V = 12 - W-MESES-NOV
  4838            PERFORM  5900-CUENTA-MORAS-HIST-12MESES
  4839         END-IF
  4840      END-IF.
  4841
  4842*----------------------------------------------------------------*
  4843* EVALUA  SI EN LOS ULTIMOS 12 meses TUVO ALGUN TIPO DE MORA     *
  4844*----------------------------------------------------------------*
  4845 5900-CUENTA-MORAS-HIST-12MESES.
  4846      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "5" BY "N"
  4847      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "9" BY "-"
  4848      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "6" BY "-"
  4849      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "7" BY "-"
  4850      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "8" BY "N"
  4851      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "0" BY " "
  4852      PERFORM VARYING W-IND FROM 1 BY 1 UNTIL W-IND > TOPE-V
  4853            IF W-MORAS-HISTORICAS (W-IND) = "1"
  4854               ADD 1 TO W-MORAS-30-HIS
  4855            ELSE
  4856               IF W-MORAS-HISTORICAS (W-IND) = "2"
  4857                  ADD 1 TO W-MORAS-60-HIS
  4858               ELSE
  4859                  IF W-MORAS-HISTORICAS (W-IND) = "3"
  4860                     ADD 1 TO W-MORAS-90-HIS
  4861                  ELSE
  4862                     IF W-MORAS-HISTORICAS (W-IND) = "4"
  4863                        ADD 1 TO W-MORAS-120-HIS
  4864                     END-IF
  4865                  END-IF
  4866               END-IF
  4867            END-IF
  4868      END-PERFORM.
  4869
  4870*----------------------------------------------------------------*
  4871* EVALUA SI EN LOS ULTIMOS meses TUVO ALGUN TIPO DE MORA         *
  4872*----------------------------------------------------------------*
  4873 5900-CUENTA-MORAS-HISTORICAS.
  4874      PERFORM VARYING W-IND FROM 1 BY 1 UNTIL W-IND > W-VECTOR-L
  4875            IF W-MORAS-HISTORICAS (W-IND) = "1"
  4876               ADD 1 TO W-MORAS-30-HIS
  4877            ELSE
  4878               IF W-MORAS-HISTORICAS (W-IND) = "2"
  4879                  ADD 1 TO W-MORAS-60-HIS
  4880               ELSE
  4881                  IF W-MORAS-HISTORICAS (W-IND) = "3"
  4882                     ADD 1 TO W-MORAS-90-HIS
  4883                  ELSE
  4884                     IF W-MORAS-HISTORICAS (W-IND) = "4"
  4885                        ADD 1 TO W-MORAS-120-HIS
  4886                     END-IF
  4887                  END-IF
  4888               END-IF
  4889            END-IF
  4890*
  4891      END-PERFORM.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  85
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4892
  4893
  4894*------------------------------------------------------------*
  4895*    ESTADISTICO  POR TIPO DE IDENTIFICACION
  4896*------------------------------------------------------------*
  4897 9800-GRABAR-ESTADISTICA.
  4898     PERFORM VARYING  F FROM 1 BY 1 UNTIL F > 3
  4899           INITIALIZE  REG-ESTADIS
  4900           IF F = 1
  4901              MOVE "Clientes con informacion"  TO SLD-DETALLE
  4902           ELSE
  4903              IF F = 2
  4904                 MOVE "Clientes sin informacion" TO SLD-DETALLE
  4905              ELSE
  4906                 MOVE "Inconsistencias         " TO SLD-DETALLE
  4907              END-IF
  4908           END-IF
  4909           MOVE  W-ACUM-TIPO-ID (F, 1) TO SLD-ESTADIS-VALOR-1
  4910           MOVE  W-ACUM-TIPO-ID (F, 2) TO SLD-ESTADIS-VALOR-2
  4911           MOVE  W-ACUM-TIPO-ID (F, 3) TO SLD-ESTADIS-VALOR-3
  4912           MOVE  W-ACUM-TIPO-ID (F, 4) TO SLD-ESTADIS-VALOR-4
  4913           MOVE  W-ACUM-TIPO-ID (F, 5) TO SLD-ESTADIS-VALOR-5
  4914           WRITE  REG-ESTADIS
  4915     END-PERFORM
  4916     INITIALIZE  REG-ESTADIS
  4917     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  4918     WRITE  REG-ESTADIS
  4919     WRITE  REG-ESTADIS
  4920*------------------------------------------------------------*
  4921*    ESTADISTICO POR RANGO DE EDAD
  4922*------------------------------------------------------------*
  4923     INITIALIZE  REG-ESTADIS
  4924     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  4925     INITIALIZE  REG-ESTADIS
  4926     MOVE "18 a 21 años"    TO   SLD-DETALLE
  4927     MOVE W-EDAD-18-21      TO   SLD-ESTADIS-VALOR-1
  4928     WRITE  REG-ESTADIS
  4929     INITIALIZE  REG-ESTADIS
  4930     MOVE "22 a 28 años"    TO   SLD-DETALLE
  4931     MOVE W-EDAD-22-28      TO   SLD-ESTADIS-VALOR-1
  4932     WRITE  REG-ESTADIS
  4933     INITIALIZE  REG-ESTADIS
  4934     MOVE "29 a 35 años"    TO   SLD-DETALLE
  4935     MOVE W-EDAD-29-35      TO   SLD-ESTADIS-VALOR-1
  4936     WRITE  REG-ESTADIS
  4937     INITIALIZE  REG-ESTADIS
  4938     MOVE "36 a 45 años"    TO   SLD-DETALLE
  4939     MOVE W-EDAD-36-45      TO   SLD-ESTADIS-VALOR-1
  4940     WRITE  REG-ESTADIS
  4941     INITIALIZE  REG-ESTADIS
  4942     MOVE "46 a 55 años"    TO   SLD-DETALLE
  4943     MOVE W-EDAD-46-55      TO   SLD-ESTADIS-VALOR-1
  4944     WRITE  REG-ESTADIS
  4945     INITIALIZE  REG-ESTADIS
  4946     MOVE "56 a 65 años"    TO   SLD-DETALLE
  4947     MOVE W-EDAD-56-65      TO   SLD-ESTADIS-VALOR-1
  4948     WRITE  REG-ESTADIS
  4949     INITIALIZE  REG-ESTADIS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  86
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4950     MOVE "más de 66 años"  TO   SLD-DETALLE
  4951     MOVE W-EDAD-66         TO   SLD-ESTADIS-VALOR-1
  4952     WRITE  REG-ESTADIS
  4953     INITIALIZE  REG-ESTADIS
  4954     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  4955     WRITE  REG-ESTADIS
  4956     WRITE  REG-ESTADIS
  4957*------------------------------------------------------------*
  4958*    ESTADISTICO ESTADO ACTUAL
  4959*------------------------------------------------------------*
  4960     INITIALIZE  REG-ESTADIS
  4961     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  4962     INITIALIZE  REG-ESTADIS
  4963     MOVE "Al día        "  TO   SLD-DETALLE
  4964     MOVE W-TOT-ALDIA       TO   SLD-ESTADIS-VALOR-1
  4965     WRITE  REG-ESTADIS
  4966     INITIALIZE  REG-ESTADIS
  4967     MOVE "Mora 30       "    TO  SLD-DETALLE
  4968     MOVE W-TOT-MORAS-30-ACT  TO  SLD-ESTADIS-VALOR-1
  4969     WRITE  REG-ESTADIS
  4970     INITIALIZE  REG-ESTADIS
  4971     MOVE "Mora 60       "    TO  SLD-DETALLE
  4972     MOVE W-TOT-MORAS-60-ACT  TO  SLD-ESTADIS-VALOR-1
  4973     WRITE  REG-ESTADIS
  4974     INITIALIZE  REG-ESTADIS
  4975     MOVE "Mora 90       "    TO  SLD-DETALLE
  4976     MOVE W-TOT-MORAS-90-ACT  TO  SLD-ESTADIS-VALOR-1
  4977     WRITE  REG-ESTADIS
  4978     INITIALIZE  REG-ESTADIS
  4979     MOVE "Mora 120      "    TO  SLD-DETALLE
  4980     MOVE W-TOT-MORAS-120-ACT TO  SLD-ESTADIS-VALOR-1
  4981     WRITE  REG-ESTADIS
  4982     INITIALIZE  REG-ESTADIS
  4983     MOVE "Cartera castigada" TO  SLD-DETALLE
  4984     MOVE W-TOT-CAR-CASTIGA   TO  SLD-ESTADIS-VALOR-1
  4985     WRITE  REG-ESTADIS
  4986     INITIALIZE  REG-ESTADIS
  4987     MOVE "Dudoso recaudo   " TO  SLD-DETALLE
  4988     MOVE W-TOT-DUD-RECAUDO   TO  SLD-ESTADIS-VALOR-1
  4989     WRITE  REG-ESTADIS
  4990     INITIALIZE  REG-ESTADIS
  4991     MOVE "Endeudamiento    " TO  SLD-DETALLE
  4992     MOVE W-TOT-W-ENDEUDA     TO  SLD-ESTADIS-VALOR-1
  4993     WRITE  REG-ESTADIS
  4994     INITIALIZE  REG-ESTADIS
  4995     MOVE "Cuenta corriente Embargada" TO  SLD-DETALLE
  4996     MOVE W-TOT-CTES-EMBARGADAS TO SLD-ESTADIS-VALOR-1
  4997     WRITE  REG-ESTADIS
  4998     INITIALIZE  REG-ESTADIS
  4999     MOVE "Sin cuentas activas" TO  SLD-DETALLE
  5000     MOVE W-TOT-SIN-CTAS        TO  SLD-ESTADIS-VALOR-1
  5001     WRITE  REG-ESTADIS
  5002     INITIALIZE  REG-ESTADIS
  5003     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  5004     WRITE  REG-ESTADIS
  5005     WRITE  REG-ESTADIS
  5006*------------------------------------------------------------*
  5007*    ESTADISTICO ESTADO ACTUAL POR SECTOR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  87
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5008*------------------------------------------------------------*
  5009     INITIALIZE  REG-ESTADIS
  5010     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  5011     INITIALIZE  REG-ESTADIS
  5012     MOVE "Al día        "  TO  SLD-DETALLE
  5013     MOVE W-TOT-ALDIA-FINA  TO  SLD-ESTADIS-VALOR-1
  5014     MOVE W-TOT-ALDIA-REAL  TO  SLD-ESTADIS-VALOR-2
  5015     MOVE W-TOT-ALDIA-COOP  TO  SLD-ESTADIS-VALOR-3
  5016     MOVE W-TOT-ALDIA-TELE  TO  SLD-ESTADIS-VALOR-4
  5017     WRITE  REG-ESTADIS
  5018     INITIALIZE  REG-ESTADIS
  5019     MOVE "Mora 30 - 120 "  TO  SLD-DETALLE
  5020     MOVE W-TOT-MORAS-FINA  TO  SLD-ESTADIS-VALOR-1
  5021     MOVE W-TOT-MORAS-REAL  TO  SLD-ESTADIS-VALOR-2
  5022     MOVE W-TOT-MORAS-COOP  TO  SLD-ESTADIS-VALOR-3
  5023     MOVE W-TOT-MORAS-TELE  TO  SLD-ESTADIS-VALOR-4
  5024     WRITE  REG-ESTADIS
  5025     INITIALIZE  REG-ESTADIS
  5026     MOVE "Cart.Castig -  Dud.Recaud"  TO  SLD-DETALLE
  5027     MOVE W-TOT-CC-DR-FINA  TO  SLD-ESTADIS-VALOR-1
  5028     MOVE W-TOT-CC-DR-REAL  TO  SLD-ESTADIS-VALOR-2
  5029     MOVE W-TOT-CC-DR-COOP  TO  SLD-ESTADIS-VALOR-3
  5030     MOVE W-TOT-CC-DR-TELE  TO  SLD-ESTADIS-VALOR-4
  5031     WRITE  REG-ESTADIS
  5032     INITIALIZE  REG-ESTADIS
  5033     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  5034     WRITE  REG-ESTADIS
  5035     WRITE  REG-ESTADIS
  5036*------------------------------------------------------------*
  5037*    ESTADISTICO VALORES POR SECTOR
  5038*------------------------------------------------------------*
  5039     INITIALIZE  REG-ESTADIS
  5040     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  5041     INITIALIZE  REG-ESTADIS
  5042     MOVE "Sector Financiero  " TO  SLD-DETALLE
  5043     MOVE W-SALDOS-SEC-FINA     TO  SLD-ESTADIS-VALOR-1
  5044     MOVE W-CUOTAS-SEC-FINA     TO  SLD-ESTADIS-VALOR-2
  5045     MOVE W-MORAS-SEC-FINA      TO  SLD-ESTADIS-VALOR-3
  5046     WRITE  REG-ESTADIS
  5047     INITIALIZE  REG-ESTADIS
  5048     MOVE "Sector Real        " TO  SLD-DETALLE
  5049     MOVE W-SALDOS-SEC-REAL     TO  SLD-ESTADIS-VALOR-1
  5050     MOVE W-CUOTAS-SEC-REAL     TO  SLD-ESTADIS-VALOR-2
  5051     MOVE W-MORAS-SEC-REAL      TO  SLD-ESTADIS-VALOR-3
  5052     WRITE  REG-ESTADIS
  5053     INITIALIZE  REG-ESTADIS
  5054     MOVE "Sector Cooperativo " TO  SLD-DETALLE
  5055     MOVE W-SALDOS-SEC-COOP     TO  SLD-ESTADIS-VALOR-1
  5056     MOVE W-CUOTAS-SEC-COOP     TO  SLD-ESTADIS-VALOR-2
  5057     MOVE W-MORAS-SEC-COOP      TO  SLD-ESTADIS-VALOR-3
  5058     WRITE  REG-ESTADIS.
  5059
  5060
  5061*------------------------------*
  5062 9900-RESUMEN-PROCESO.
  5063*------------------------------*
  5064     DISPLAY "       "
  5065     DISPLAY "REG. LEIDOS   => " LEIDOS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  88
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5066     DISPLAY "REG. GRABADOS => " GRABADOS
  5067     DISPLAY "       "
  5068     DISPLAY "                "
  5069     MOVE   W-CON-INFORMACION   TO  W-EDITOR-CON
  5070     MOVE   W-SIN-INFORMACION   TO  W-EDITOR-SIN
  5071     MOVE   W-INCONSISTENCIAS   TO  W-EDITOR-INC
  5072     MOVE   LEIDOS              TO  W-EDITOR-TOT
  5073     DISPLAY "+------------------------------------------"
  5074             "---------+"
  5075     DISPLAY "|      *** RESULTADOS DEL INFORME       ***"
  5076             "         |"
  5077     DISPLAY "+----------------------------------+-------"
  5078             "---------+"
  5079     DISPLAY "|     DETALLE CALIFICACION         | CALF |"
  5080             "  # REG. |"
  5081     DISPLAY "+----------------------------------+------+"
  5082             "---------+"
  5083     DISPLAY "| - Registros con informacion      | O.K  |"
  5084                                            W-EDITOR-CON
  5085     DISPLAY "| - Registros sin informacion      | SIN  |"
  5086                                            W-EDITOR-SIN
  5087     DISPLAY "| - Registros inconsistencias      | INC  |"
  5088                                            W-EDITOR-INC
  5089     DISPLAY "+----------------------------------+------+"
  5090             "---------+"
  5091     DISPLAY "| - Total Registro procesados             |"
  5092                                            W-EDITOR-TOT
  5093     DISPLAY "+----------------------------------+------+"
  5094             "---------+"
  5095     CLOSE ENTRADA
  5096     CLOSE MAESTRO-CHECK
  5097     CLOSE  MAESTRO-DIRECC                                        GDT0001
  5098     CLOSE  NOAMNISTIA21                                          GDT0001
  5099*                                                                 GDT0001
  5100     CLOSE MAESTRO-CREDIT
  5101     CLOSE SUSCRIPTOR
  5102     CLOSE BDIEMSUP
  5103     CLOSE BDIEENTI
  5104     CLOSE INDEXADO
  5105     CLOSE SALIDA.
  5106
  5107
  5108******************************************************************
  5109*  INTERCAMBIA EL VECTOR DEL ESTADO-MES Y COMPLETA EL VECTOR SI  *
  5110*  LA FECHA DE ACTUALIZACION ES MAYOR QUE LA FECHA DE LA ULTIMA  *
  5111*  NOVEDAD DE LA CUENTA                                          *
  5112******************************************************************
  5113 7500-ANALIZA-VECTOR-HISTORICO.
  5114     MOVE ZEROS            TO WS-ESTADO-MES.
  5115     MOVE ESTADO-MES-ABD07 TO WS-ESTADO-MES.
  5116     MOVE ZEROS            TO ESTADO-MES-IMP.
  5117     PERFORM 7600-MESES VARYING I FROM 1 BY 1 UNTIL I = 13.
  5118     MOVE ESTADO-MES-IMP   TO WS-ESTADO-MES-1.
  5119     MOVE ZEROS            TO WS-ESTADO-MES.
  5120     MOVE VECTOR-2-ABD07   TO WS-ESTADO-MES.
  5121     MOVE ZEROS  TO ESTADO-MES-IMP.
  5122     PERFORM 7600-MESES VARYING I FROM 1 BY 1 UNTIL I = 13.
  5123     MOVE ESTADO-MES-IMP   TO WS-ESTADO-MES-2.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  89
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5124     MOVE COD-SUS-ABD07    TO COD-SUSCRIP-AUX.
  5125     PERFORM 7700-BUS-SUSCR.
  5126     MOVE WS-ESTADO-MES-1 TO ESTADO-MES-IMP.
  5127     MOVE ESTADO-MES-IMP  TO VECTOR-S
  5128     INSPECT ESTADO-MES-IMP REPLACING ALL "0" BY SPACES.
  5129     INSPECT ESTADO-MES-IMP REPLACING ALL "5" BY "N".
  5130     INSPECT ESTADO-MES-IMP REPLACING ALL "9" BY "-".
  5131     IF NUEVO = 1
  5132        INSPECT ESTADO-MES-IMP REPLACING ALL "6" BY "-"
  5133        INSPECT ESTADO-MES-IMP REPLACING ALL "7" BY "-"
  5134        INSPECT ESTADO-MES-IMP REPLACING ALL "8" BY "n"
  5135     ELSE
  5136        INSPECT ESTADO-MES-IMP REPLACING ALL "6" BY "-"
  5137        INSPECT ESTADO-MES-IMP REPLACING ALL "7" BY "-"
  5138        INSPECT ESTADO-MES-IMP REPLACING ALL "8" BY "n"
  5139     END-IF.
  5140     MOVE ESTADO-MES-IMP  TO VECTOR-S-12
  5141     MOVE WS-ESTADO-MES-2 TO ESTADO-MES-IMP.
  5142     MOVE ESTADO-MES-IMP  TO S48-VEC
  5143     INSPECT ESTADO-MES-IMP REPLACING ALL "0" BY SPACES.
  5144     INSPECT ESTADO-MES-IMP REPLACING ALL "5" BY "N".
  5145     INSPECT ESTADO-MES-IMP REPLACING ALL "9" BY "-".
  5146     INSPECT ESTADO-MES-IMP REPLACING ALL "6" BY "-".
  5147     INSPECT ESTADO-MES-IMP REPLACING ALL "7" BY "-".
  5148     INSPECT ESTADO-MES-IMP REPLACING ALL "8" BY "n".
  5149     MOVE ESTADO-MES-IMP  TO S48-VEC-12
  5150     MOVE VECTOR-S        TO W-MORAS-HISTORICAS-V.
  5151
  5152 7600-MESES.
  5153******************************************************************
  5154*7600-MESES.
  5155* SE RECORRE EL VECTOR DE COMPORTAMIENTO MOVIENDO LOS CAMPOS DE  *
  5156* ACUERDO AL REPORTE DERECHA A IZQUIERDA.                        *
  5157******************************************************************
  5158     SUBTRACT I FROM 13 GIVING J.
  5159     MOVE WS-MES ( I ) TO E-MES-IMP ( J ).
  5160 7700-BUS-SUSCR.
  5161******************************************************************
  5162*7700-BUS-SUSCR.
  5163* SE BUSCA LA FECHA DE ULTIMA ACTUALIZACION DEL SUSCRIPTOR Y SE  *
  5164* PROCEDE A REALIZAR CORRIMIENTOS EN CASO DE ESTAR AL DIA        *
  5165******************************************************************
  5166     PERFORM 6600-LECT-SUSCR.
  5167     IF ENCONTRO = 0
  5168        MOVE 1 TO IND-BLOQUEO-ABD07
  5169     ELSE
  5170         PERFORM 7800-COMP-VEC.
  5171 7800-COMP-VEC.
  5172*****************************************************************
  5173*7800-COMP-VEC.
  5174*  SE COMPARAN LAS FECHAS DE ULTIMA NOVEDAD E INGRESO DEL SUSCR.*
  5175*  DANDO ASI EL NUMERO DE POSICIONES DEL VECTOR. EN CASO DE QUE *
  5176*  LA ULTIMA NOVEDAD SEA 01 O 13 O 14 O 15 O 16 SE LE AUMENTAN
  5177*  LAS POSICIONES DE NORMALIDAD QUE FALTAN HASTA LA FECHA DE LA *
  5178*  ULTIMA ACTUALIZACION DEL SUSCRIPTOR.                         *
  5179*****************************************************************
  5180     MOVE 1 TO FIN-CHECK
  5181     IF F-UACT-2 = 0
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  90
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5182        MOVE F-ING-2 TO F-UACT-2.
  5183     IF FIN-CHECK = 1
  5184        MOVE FECHA-APERT-ABD07 TO F-APE-07
  5185     ELSE
  5186        MOVE FECHA-APERT-ABD06 TO F-APE-07.
  5187     IF FIN-CHECK = 1
  5188        MOVE FEC-NOVEDAD-ABD07 TO F-NOV-07
  5189     ELSE
  5190        MOVE FEC-NOVEDAD-ABD06 TO F-NOV-07.
  5191     MOVE A-APE-07             TO ANO-2000                        ANO2000
  5192     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5193     MOVE ANO-2000             TO A-APE-07                        ANO2000
  5194     MOVE A-NOV-07             TO ANO-2000                        ANO2000
  5195     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5196     MOVE ANO-2000             TO A-NOV-07                        ANO2000
  5197     MOVE A-ING-02             TO ANO-2000                        ANO2000
  5198     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5199     MOVE ANO-2000             TO A-ING-02                        ANO2000
  5200     MOVE A-UACT-02            TO ANO-2000                        ANO2000
  5201     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5202     MOVE ANO-2000             TO A-UACT-02                       ANO2000
  5203     COMPUTE  F-APE-7 = A-APE-07 * 12 + M-APE-07.
  5204     COMPUTE  F-NOV-7 = A-NOV-07 * 12 + M-NOV-07.
  5205     COMPUTE  F-ING-2 = A-ING-02 * 12 + M-ING-02.
  5206     COMPUTE  F-UACT-2 = A-UACT-02 * 12 + M-UACT-02.
  5207     IF F-APE-7 < F-ING-2
  5208        MOVE  F-ING-2 TO F-VIEJ
  5209     ELSE
  5210        MOVE F-APE-7 TO F-VIEJ.
  5211     IF (F-NOV-7 > F-VIEJ)
  5212     OR (F-NOV-7 = F-VIEJ)
  5213        COMPUTE TIV = F-NOV-7 - F-VIEJ
  5214     ELSE
  5215        MOVE 0 TO TIV.
  5216* OJO LO SIGUIENTE ARREGLA CUANDO DA NEGATIVA LA RESTA !!!!!!
  5217* ES UNA INCONSISTENCIA EN LA BD POR FEC-NOVEDAD < FEC-INGRESO
  5218     ADD 1 to tiv giving n
  5219     perform varying i from n by 1 until i > 24
  5220       IF i < 13
  5221         MOVE "0" TO WS-ESTADO-MES-1(I:1)
  5222       ELSE
  5223         COMPUTE J = I - 12
  5224         MOVE "0" TO WS-ESTADO-MES-2(J:1)
  5225       END-IF
  5226     end-perform
  5227     IF (F-UACT-2 > F-VIEJ)
  5228     OR (F-UACT-2 = F-VIEJ)
  5229        COMPUTE TFV = F-UACT-2 - F-VIEJ + 1
  5230     ELSE
  5231        MOVE 0 TO TFV.
  5232     IF TFV > TIV
  5233        COMPUTE N = TFV - TIV - 1
  5234     ELSE
  5235        MOVE 0 TO N.
  5236     MOVE A-APE-07             TO ANO-2000                        ANO2000
  5237     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5238     MOVE ANO-2000             TO A-APE-07                        ANO2000
  5239     MOVE A-NOV-07             TO ANO-2000                        ANO2000
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  91
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5240     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5241     MOVE ANO-2000             TO A-NOV-07                        ANO2000
  5242     MOVE A-ING-02             TO ANO-2000                        ANO2000
  5243     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5244     MOVE ANO-2000             TO A-ING-02                        ANO2000
  5245     MOVE A-UACT-02            TO ANO-2000                        ANO2000
  5246     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5247     MOVE ANO-2000             TO A-UACT-02                       ANO2000
  5248     IF (NOV-REPORT-ABD07 = 01 OR 13 OR 14 OR 16 OR 15) AND
  5249        (ARRASTRE = 1)
  5250        MOVE CINCO TO RELLENO
  5251        MOVE F-UACT-02 TO F-AUX
  5252        MOVE F-AUX TO FEC-NOV-S
  5253        IF N > 24
  5254           MOVE 25 TO N
  5255        END-IF
  5256        PERFORM  7900-ADICION N TIMES
  5257     END-IF.
  5258*
  5259 7900-ADICION.
  5260*****************************************************************
  5261*7900-ADICION.
  5262*  SE ADICIONA UNA N (NORMAL) AL VECTOR POR CADA VEZ QUE SE     *
  5263*  LLAMA ESTA RUTINA.                                           *
  5264*                                                               *
  5265*****************************************************************
  5266     MOVE ZEROS           TO WS-EST-MES.
  5267     MOVE WS-ESTADO-MES-1 TO WS-MESES-VIEJ.
  5268     MOVE RELLENO         TO WS-MES-NUEV.
  5269     MOVE WS-MESES-NUEV   TO WS-ESTADO-MES-1.
  5270     MOVE WS-MES-VIEJ     TO WS-MES-NUEV.
  5271     MOVE WS-ESTADO-MES-2 TO WS-MESES-VIEJ.
  5272     MOVE WS-MESES-NUEV   TO WS-ESTADO-MES-2.
  5273 6600-LECT-SUSCR.
  5274*****************************************************************
  5275*6600-LECT-SUSCR.
  5276*  SE LEE LA TABLA DE SUSCRIPTORES Y SE ASIGNAN LAS FECHAS DE   *
  5277*  INGRESO Y ULTIMA ACTUALIZACION DEL SUSCRIPTOR.               *
  5278*                                                               *
  5279*****************************************************************
  5280     MOVE COD-SUSCRIP-AUX TO COD-SUSCRIP-ABD02.
  5281     MOVE 1 TO ENCONTRO.
  5282     READ SUSCRIPTOR IGNORE LOCK INVALID KEY
  5283          MOVE 0 TO ENCONTRO
  5284          MOVE 0 TO IND-COR-ABD02.
  5285     IF ENCONTRO NOT = 0
  5286        IF IND-COR-ABD02 = 1 OR 2
  5287           MOVE NOM-COR1-ABD02 TO NOM-COR-AUX
  5288           MOVE NOM-COR2-ABD02 TO NOM-COR-AUX2
  5289        ELSE
  5290           MOVE SPACES TO NOM-COR-AUX
  5291           MOVE COD-SUSCRIP-ABD02 TO NOM-COR-AUXN
  5292        END-IF
  5293        MOVE FECHA-ING-ABD02 TO F-ING-02
  5294        MOVE F-ULT-ACT-ABD02 TO F-UACT-02.
  5295
  5296 7900-CONVERSION-OUTPUT-2000.                                     ANO2000
  5297******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  92
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5298*7900-CONVERSION-OUTPUT-2000.                                     ANO2000
  5299* RUTINA ESTANDAR PARA Y2K, METODO WINDOW ANO 61. CONVERSION DESPUES
  5300* DE LA OPERACION ENTRE FECHAS.                                  *
  5301******************************************************************
  5302     IF ANO-2000                  <  39                           ANO2000
  5303        ADD 61                    TO   ANO-2000                   ANO2000
  5304     ELSE
  5305        SUBTRACT 39               FROM ANO-2000.                  ANO2000
  5306
  5307 7800-CONVERSION-INPUT-2000.                                      ANO2000
  5308******************************************************************
  5309*7800-CONVERSION-INPUT-2000.                                      ANO2000
  5310* RUTINA ESTANDAR PARA Y2K, METODO WINDOW ANO 61. CONVERSION ANTES
  5311* DE LA OPERACION ENTRE FECHAS.                                  *
  5312******************************************************************
  5313     IF ANO-2000                  >  61                           ANO2000
  5314        SUBTRACT 61               FROM ANO-2000                   ANO2000
  5315     ELSE                                                         ANO2000
  5316        ADD 39                    TO   ANO-2000.                  ANO2000
  5317
* 5318  COPY  LEEMAESTROS.PROC.                                         GDT0001
  5319* LEEMAESTROS.PROC.v.0004
  5320* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
  5321* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
  5322* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
  5323******************************************************************
  5324* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
  5325* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
  5326* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
  5327*           * GISTRO                                             *
  5328*           * NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
  5329*           *        CITA EL PROGRAMA, EL DEFAULT ES 48
  5330******************************************************************
  5331* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
  5332* G. JIMENEZ*        BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
  5333* AGOST/2009*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *
  5334*           *        CARTERA                                     *
  5335******************************************************************
  5336* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
  5337* G. JIMENEZ*        DE BLOQUEO 7 Y 8                            *
  5338* OCTUB/2011*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *
  5339*           *        EL MAESTRO DE CARTERA                       *
  5340******************************************************************
  5341$SET CONSTANT HACERMATCH"NO"
  5342$SET CONSTANT AMNISTIA21"NO"
  5343
  5344$IF HACERMATCH = "SI"
  5345$DISPLAY "........COMPILANDO LEEMAESTROS CON MATCH **********
  5346$ELSE
  5347$DISPLAY "........COMPILANDO LEEMAESTROS SIN MATCH **********
  5348$END
  5349
  5350$IF AMNISTIA21 = "SI"
  5351$DISPLAY "........COMPILANDO LEEMAESTROS CON AMNISTIA *******
  5352$ELSE
  5353$DISPLAY "...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
  5354$END
  5355
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  93
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
* 5356 COPY BDAMATCH.PROC.
  5358* BDAMATCH.PROC.v.0005
  5359******************************************************************
  5360* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
  5361* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
  5362* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
  5363* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
  5364* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
  5365********************************************************************
  5366* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *
  5367* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
  5368* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *
  5369******************************************************************
  5370* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
  5371* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
  5372*             *        MEJOR PORTAFOLIO
  5373* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
  5374*             *                  NUM-CTAS-OUTPUT-BDAMATCH
  5375*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
  5376*             *        BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
  5377*             *        DE FRENADAS
  5378*****************************************************************
  5379* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
  5380* R-MARTINEZ. *          DEL PORTAFOLIO .                       *
  5381* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
  5382*             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       *
  5383*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               *
  5384*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH       *
  5385*             * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7      *
  5386*             * NOMB01 - MAQUILLAR EL NOMBRE                    *
  5387*             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
  5388*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
  5389*****************************************************************
  5390* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
  5391* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
  5392* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
  5393*             *          DECUENTA DE LA MISMA CUENTA            *
  5394*****************************************************************
  5395
  5396 1000-U-RECORRER-CSV-BDAMATCH.
  5397******************************************************************
  5398*1000-U-RECORRER-CSV-BDAMATCH.
  5399* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
  5400* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
  5401* MATCH
  5402******************************************************************
  5403     MOVE 0 TO IDE-TIPO-BDAMATCH
  5404     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003
  5405     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                         RMB0003
  5406     MOVE 0 TO MAX-CUENTAS-BDAMATCH.
  5407     IF ABIERTO-BDAMATCH  = 0
  5408        OPEN INPUT  BDACSV
  5409        MOVE 1 TO ABIERTO-BDAMATCH
  5410     END-IF.
  5411     INITIALIZE LLAVE-BDACSV.
  5412     MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .
  5413     MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .
  5414     MOVE 0 TO FIN-BDAMATCH .
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  94
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5415     MOVE 0 TO PROCESAR-BDAMATCH .
  5416     START BDACSV  KEY > LLAVE-BDACSV
  5417           INVALID KEY
  5418              MOVE 1 TO FIN-BDAMATCH
  5419           NOT INVALID KEY
  5420              READ BDACSV IGNORE LOCK NEXT RECORD
  5421                 AT END
  5422                    MOVE 1 TO FIN-BDAMATCH
  5423              END-READ
  5424     END-START.
  5425     PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
  5426                                      NUM-IDE-INPUT-BDAMATCH  OR
  5427                                      TIPO-ID-BDACSV  NOT =
  5428                                      TIP-IDE-INPUT-BDAMATCH
  5429        MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02
  5430        READ SUSCRIPTOR IGNORE LOCK
  5431           INVALID KEY
  5432              MOVE 0 TO PROCESAR-BDAMATCH
  5433           NOT INVALID KEY
  5434              MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004
  5435        END-READ
  5436        IF PROCESAR-BDAMATCH = 1                                  RMB0004
  5437           IF ESTADO-ABD02 = 1                                    RMB0004
  5438              IF IND-BLOQUEO-BDACSV <> "B"                        RMB0004
  5439                 MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004
  5440                 IF FUENTE-REG-BDACSV <= 01                       RMB0004
  5441                    PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH       RMB0004
  5442                 ELSE                                             RMB0004
  5443                    PERFORM 1100-LLENAR-AUX-BDAMATCH              RMB0004
  5444                 END-IF                                           RMB0004
  5445              ELSE                                                RMB0004
  5446                 MOVE 0 TO PROCESAR-BDAMATCH                      RMB0004
  5447              END-IF                                              RMB0004
  5448           ELSE                                                   RMB0004
  5449              MOVE 0 TO PROCESAR-BDAMATCH                         RMB0004
  5450           END-IF                                                 RMB0004
  5451        END-IF                                                    RMB0004
  5452        IF PROCESAR-BDAMATCH = 1
  5453           PERFORM 1200-PROC-REG-CSV-BDAMATCH
  5454        END-IF
  5455        READ BDACSV IGNORE LOCK   NEXT RECORD
  5456        AT END
  5457           MOVE 1 TO FIN-BDAMATCH
  5458        END-READ
  5459        IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
  5460           MOVE 1 TO FIN-BDAMATCH               *> SE ABLIGA A TIPRMB0004
  5461           MOVE 0 TO MAX-CUENTAS-BDAMATCH       *> EFICIENCIA Y   RMB0004
  5462           MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
  5463        END-IF                                                    RMB0004
  5464     END-PERFORM.
  5465     IF MAX-CUENTAS-BDAMATCH > 0
  5466        IF APELLIDO-INPUT-BDAMATCH <> SPACES AND                  RMB0004
  5467           MAX-CUENTAS-BDAMATCH > 1                               RMB0004
  5468           PERFORM 1100-LLENAR-CSV-APE-BDAMATCH                   RMB0004
  5469           PERFORM 1100-LLENAR-AUX-BDAMATCH                       RMB0004
  5470           PERFORM 1200-PROC-REG-CSV-BDAMATCH                     RMB0004
  5471        END-IF                                                    RMB0004
  5472        PERFORM 9000-U-REALIZAR-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  95
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5473        IF NOM-OUTPUT-BDAMATCH <> SPACES AND                      RMB0004
  5474           (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)                      RMB0004
  5475           MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQ              RMB0004
  5476           PERFORM 1100-MAQUILLAR-NOMBRE-MAQ                      RMB0004
  5477           MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCH           RMB0004
  5478        END-IF                                                    RMB0004
  5479        IF NOM-OUTPUT-BDAMATCH <> SPACES
  5480           MOVE 1 TO IDE-TIPO-BDAMATCH
  5481        END-IF
  5482     END-IF.
  5483 1100-MAQUILLAR-NOMBRE-MAQ.                                       RMB0004
  5484     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
  5485     MOVE 0 TO I-MAQ                                              RMB0004
  5486     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
  5487             INITIAL "Y/O"                                        RMB0004
  5488             OR      "Y\O"                                        RMB0004
  5489             OR      " Y/OTRO "                                   RMB0004
  5490             OR      " Y/OTRA "                                   RMB0004
  5491             OR      " Y\OTRO "                                   RMB0004
  5492             OR      " Y\OTRA "                                   RMB0004
  5493             OR      " Y OTRO "                                   RMB0004
  5494             OR      " Y OTRA "                                   RMB0004
  5495     IF I-MAQ < 45 AND I-MAQ > 2                                  RMB0004
  5496        ADD 1 TO I-MAQ                                            RMB0004
  5497        MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)                      RMB0004
  5498     ELSE                                                         RMB0004
  5499        IF I-MAQ < 45                                             RMB0004
  5500           ADD 1 TO I-MAQ                                         RMB0004
  5501           MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)                  RMB0004
  5502        END-IF                                                    RMB0004
  5503     END-IF                                                       RMB0004
  5504     MOVE 0 TO SW-BORRAR-MAQ                                      RMB0004
  5505     MOVE 1 TO I-MAQ.                                             RMB0004
  5506     PERFORM UNTIL I-MAQ > 45                                     RMB0004
  5507       MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ                  RMB0004
  5508       IF TILDE-MAQ                                               RMB0004
  5509          PERFORM 1000-CAMBIAR-TILDE-MAQ                          RMB0004
  5510          MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)               RMB0004
  5511       END-IF                                                     RMB0004
  5512       IF FUNCTION ORD(ACTUAL-MAQ) < 31                           RMB0004
  5513          MOVE "." TO ACTUAL-MAQ                                  RMB0004
  5514       END-IF                                                     RMB0004
  5515       MOVE " " TO ANT-MAQ                                        RMB0004
  5516       IF I-MAQ > 1                                               RMB0004
  5517          COMPUTE J-MAQ = I-MAQ - 1                               RMB0004
  5518          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQ                  RMB0004
  5519       END-IF                                                     RMB0004
  5520       MOVE " " TO SIG-MAQ                                        RMB0004
  5521       IF I-MAQ < 45                                              RMB0004
  5522          COMPUTE J-MAQ = I-MAQ + 1                               RMB0004
  5523          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQ                  RMB0004
  5524       END-IF                                                     RMB0004
  5525       IF ACTUAL-MAQ = ")"                                        RMB0004
  5526          MOVE 0 TO SW-BORRAR-MAQ                                 RMB0004
  5527       END-IF                                                     RMB0004
  5528       IF SW-BORRAR-MAQ = 0                                       RMB0004
  5529          IF ELIMINAR-MAQ                                         RMB0004
  5530             MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                  RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  96
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5531             IF I-MAQ > 1                                         RMB0004
  5532                MOVE 1 TO SW-BORRAR-MAQ                           RMB0004
  5533             END-IF                                               RMB0004
  5534          ELSE                                                    RMB0004
  5535             IF BORRAR-MAQ                                        RMB0004
  5536                MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)               RMB0004
  5537             ELSE                                                 RMB0004
  5538                IF QUITAR-MAQ                                     RMB0004
  5539                   COMPUTE J-MAQ = I-MAQ + 1                      RMB0004
  5540                   MOVE NOMBRE-INPMAQ(J-MAQ:) TO                  RMB0004
  5541                        NOMBRE-INPMAQ(I-MAQ:)                     RMB0004
  5542                   COMPUTE I-MAQ = I-MAQ - 1                      RMB0004
  5543                ELSE                                              RMB0004
  5544                   IF VALIDO-MAQ                                  RMB0004
  5545                      CONTINUE                                    RMB0004
  5546                   ELSE                                           RMB0004
  5547                      IF ANT-MAQ = "N" AND SIG-VOCAL-MAQ          RMB0004
  5548                         COMPUTE J-MAQ = I-MAQ + 1                RMB0004
  5549                         MOVE NOMBRE-INPMAQ(J-MAQ:) TO            RMB0004
  5550                              NOMBRE-INPMAQ(I-MAQ:)               RMB0004
  5551                         COMPUTE I-MAQ = I-MAQ - 1                RMB0004
  5552                      ELSE                                        RMB0004
  5553                         IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
  5554                            (ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
  5555                            IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
  5556                               COMPUTE J-MAQ = I-MAQ + 1          RMB0004
  5557                               MOVE NOMBRE-INPMAQ(J-MAQ:) TO      RMB0004
  5558                                    NOMBRE-INPMAQ(I-MAQ:)         RMB0004
  5559                            ELSE                                  RMB0004
  5560                               MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5561                            END-IF                                RMB0004
  5562                         ELSE                                     RMB0004
  5563                            IF NOT ANT-VOCAL-MAQ AND              RMB0004
  5564                                   SIG-VOCAL-MAQ                  RMB0004
  5565                               MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5566                            ELSE                                  RMB0004
  5567                               MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5568                            END-IF                                RMB0004
  5569                         END-IF                                   RMB0004
  5570                      END-IF                                      RMB0004
  5571                   END-IF                                         RMB0004
  5572                END-IF                                            RMB0004
  5573             END-IF                                               RMB0004
  5574          END-IF                                                  RMB0004
  5575       ELSE                                                       RMB0004
  5576          MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                     RMB0004
  5577       END-IF                                                     RMB0004
  5578       ADD 1 TO I-MAQ                                             RMB0004
  5579     END-PERFORM.                                                 RMB0004
  5580     INITIALIZE PARTICULAS-INPMAQ                                 RMB0004
  5581     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "                RMB0004
  5582       INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
  5583            P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
  5584            P10-INPMAQ                                            RMB0004
  5585     MOVE SPACES TO NOMBRE-OUTMAQ-OK                              RMB0004
  5586     STRING P1-INPMAQ DELIMITED BY " "                            RMB0004
  5587            " " DELIMITED BY SIZE                                 RMB0004
  5588            P2-INPMAQ DELIMITED BY " "                            RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  97
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5589            " " DELIMITED BY SIZE                                 RMB0004
  5590            P3-INPMAQ DELIMITED BY " "                            RMB0004
  5591            " " DELIMITED BY SIZE                                 RMB0004
  5592            P4-INPMAQ DELIMITED BY " "                            RMB0004
  5593            " " DELIMITED BY SIZE                                 RMB0004
  5594            P5-INPMAQ DELIMITED BY " "                            RMB0004
  5595            " " DELIMITED BY SIZE                                 RMB0004
  5596            P6-INPMAQ DELIMITED BY " "                            RMB0004
  5597            " " DELIMITED BY SIZE                                 RMB0004
  5598            P7-INPMAQ DELIMITED BY " "                            RMB0004
  5599            " " DELIMITED BY SIZE                                 RMB0004
  5600            P8-INPMAQ DELIMITED BY " "                            RMB0004
  5601            " " DELIMITED BY SIZE                                 RMB0004
  5602            P9-INPMAQ DELIMITED BY " "                            RMB0004
  5603            " " DELIMITED BY SIZE                                 RMB0004
  5604            P10-INPMAQ DELIMITED BY " "                           RMB0004
  5605            " " DELIMITED BY SIZE                                 RMB0004
  5606       INTO NOMBRE-OUTMAQ-OK.                                     RMB0004
  5607       INSPECT NOMBRE-OUTMAQ-OK                                   RMB0004
  5608         REPLACING ALL  " PE A " BY " PENA ".                     RMB0004
  5609  1000-CAMBIAR-TILDE-MAQ.                                         RMB0004
  5610       EVALUATE ACTUAL-MAQ                                        RMB0004
  5611          WHEN "Á"                                                RMB0004
  5612            MOVE "A" TO ACTUAL-MAQ                                RMB0004
  5613          WHEN "É"                                                RMB0004
  5614            MOVE "E" TO ACTUAL-MAQ                                RMB0004
  5615          WHEN "Í"                                                RMB0004
  5616            MOVE "I" TO ACTUAL-MAQ                                RMB0004
  5617          WHEN "Ó"                                                RMB0004
  5618            MOVE "O" TO ACTUAL-MAQ                                RMB0004
  5619          WHEN "Ú"                                                RMB0004
  5620            MOVE "U" TO ACTUAL-MAQ                                RMB0004
  5621          WHEN "á"                                                RMB0004
  5622            MOVE "A" TO ACTUAL-MAQ                                RMB0004
  5623          WHEN "é"                                                RMB0004
  5624            MOVE "E" TO ACTUAL-MAQ                                RMB0004
  5625          WHEN "í"                                                RMB0004
  5626            MOVE "I" TO ACTUAL-MAQ                                RMB0004
  5627          WHEN "ó"                                                RMB0004
  5628            MOVE "O" TO ACTUAL-MAQ                                RMB0004
  5629          WHEN "Ú"                                                RMB0004
  5630            MOVE "U" TO ACTUAL-MAQ                                RMB0004
  5631        END-EVALUATE.                                             RMB0004
  5632 1100-LLENAR-CSV-APE-BDAMATCH.                                    RMB0004
  5633     INITIALIZE REG-BDACSV                                        RMB0004
  5634     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSV               RMB0004
  5635     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSV                RMB0004
  5636     MOVE 980001         TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
  5637     MOVE 02             TO  COD-CTA-BDACSV                       RMB0004
  5638     MOVE "APELLID-01"   TO  NUM-CTA-BDACSV                       RMB0004
  5639     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSV               RMB0004
  5640     MOVE ".-,"                   TO  NOMBRE-BDACSV(43:3)         RMB0004
  5641     MOVE 20110801       TO  FECHA-CREA-BDACSV                    RMB0004
  5642     MOVE 0              TO  NUM-PORTAF-BDACSV                    RMB0004
  5643     MOVE 0              TO  IND-NOMBRE-BDACSV                    RMB0004
  5644     MOVE 0              TO  MEJOR-PORTAF-BDACSV                  RMB0004
  5645     MOVE 0              TO  IND-ACTUALIZ-BDACSV                  RMB0004
  5646     MOVE 01             TO  FUENTE-REG-BDACSV.                   RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  98
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5647 1100-LLENAR-AUX-BDAMATCH.                                        RMB0004
  5648***********************************************************************
  5649*1100-LLENAR-AUX-BDAMATCH.
  5650* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE
  5651* TAMAÑO
  5652***********************************************************************
  5653     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .          RMB0004
  5654     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .          RMB0004
  5655     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .          RMB0004
  5656     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .          RMB0004
  5657     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .          RMB0004
  5658     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .          RMB0004
  5659     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .          RMB0004
  5660     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .          RMB0004
  5661     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .          RMB0004
  5662     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .          RMB0004
  5663     MOVE 0 TO FALLECIDO-BDAMATCH.                                RMB0004
  5664 1100-UBICAR-CHKCRE-CSV-BDAMATCH.
  5665***********************************************************************
  5666*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
  5667* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
  5668* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
  5669***********************************************************************
  5670     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .
  5671     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .
  5672     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .
  5673     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .
  5674     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .
  5675     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .
  5676     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .
  5677     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .
  5678     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .
  5679     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
  5680     MOVE 0 TO FALLECIDO-BDAMATCH                                 RMB0003
  5681     IF COD-CTA-BDACSV = 01 OR 51
  5682        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECK
  5683        READ MAESTRO-CHECK IGNORE LOCK INVALID KEY
  5684             MOVE 0 TO PROCESAR-BDAMATCH
  5685        NOT INVALID KEY                                           RMB0003
  5686            IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)                  RMB0004
  5687                AND CONSECUTIVO-ABD06 = 1
  5688               IF ADJETIVO-ABD06 = 1                              RMB0003
  5689                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
  5690               END-IF                                             RMB0003
  5691            ELSE                                                  RMB0003
  5692               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
  5693            END-IF                                                RMB0003
  5694        END-READ
  5695     ELSE
  5696        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDIT
  5697        READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY
  5698             MOVE 0 TO PROCESAR-BDAMATCH
  5699        NOT INVALID KEY                                           RMB0003
  5700            IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)                  RMB0004
  5701               AND CONSECUTIVO-ABD07 = 1
  5702               IF ADJETIVO1-ABD07 = 1 OR                          RMB0003
  5703                  ADJETIVO2-ABD07 = 1 OR                          RMB0003
  5704                  ADJETIVO3-ABD07 = 1                             RMB0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  99
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5705                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
  5706               END-IF                                             RMB0003
  5707            ELSE                                                  RMB0003
  5708               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
  5709            END-IF                                                RMB0003
  5710        END-READ
  5711     END-IF.
  5712
  5713 1200-PROC-REG-CSV-BDAMATCH.
  5714***********************************************************************
  5715*1200-PROC-REG-CSV-BDAMATCH.
  5716* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
  5717* SI LO HAY
  5718***********************************************************************
  5719     IF MAX-CUENTAS-BDAMATCH = 0
  5720        PERFORM 1000-U-INICIALIZAR-BDAMATCH
  5721     END-IF.
  5722     MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.
  5723     MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLM
  5724     PERFORM 2000-U-INSERTAR-CTA-BDAMATCH.
  5725     MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.
  5726     PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.
  5727     MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.
  5728     READ MAESTRO-DIRECC IGNORE LOCK
  5729*         NOT INVALID KEY                                         RMB0004
  5730*             PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                 RMB0004
  5731          INVALID KEY                                             RMB0004
  5732              MOVE SPACES TO LLAVE-DIRECC                         RMB0004
  5733     END-READ.
  5734     IF LLAVE-DIRECC <> SPACES                                    RMB0004
  5735        PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                       RMB0004
  5736     END-IF.                                                      RMB0004
  5737
  5738 1210-DIRTEL-BDACSV-BDAMATCH.
  5739***********************************************************************
  5740*1210-DIRTEL-BDACSV-BDAMATCH.
  5741* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
  5742* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
  5743***********************************************************************
  5744     IF CIURES-DIRECC NOT = SPACES
  5745        IF DIRRES-DIRECC NOT = SPACES
  5746           MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCH
  5747           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5748        END-IF
  5749        IF TELRES-DIRECC > 0 AND
  5750           TELRES-DIRECC < 9999999999
  5751           MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCH
  5752           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH
  5753        END-IF
  5754     END-IF.
  5755     IF CIULAB-DIRECC NOT = SPACES
  5756        IF DIRLAB-DIRECC NOT = SPACES
  5757           MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCH
  5758           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5759        END-IF
  5760        IF TELLAB-DIRECC > 0 AND
  5761           TELLAB-DIRECC < 9999999999
  5762           MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 100
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5763           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH
  5764        END-IF
  5765     END-IF.
  5766     IF CIUCOR-DIRECC NOT = SPACES AND
  5767        DIRCOR-DIRECC NOT = SPACES
  5768        MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCH
  5769        PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5770     END-IF.
  5771
  5772 8000-U-VER-CTAABD07-BDAMATCH.
  5773***********************************************************************
  5774*8000-U-VER-CTAABD07-BDAMATCH.
  5775*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
  5776*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
  5777*  DE BLOQUEO A 0
  5778***********************************************************************
  5779     IF IDE-TIPO-BDAMATCH = 1
  5780        MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCH
  5781        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH
  5782        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9
  5783           MOVE 0 TO IND-BLOQUEO-ABD07
  5784        END-IF
  5785     END-IF.
  5786
  5787 8000-U-VER-CTAABD06-BDAMATCH.
  5788***********************************************************************
  5789*8000-U-VER-CTAABD06-BDAMATCH.
  5790*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
  5791*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
  5792*  DE BLOQUEO A 0
  5793***********************************************************************
  5794     IF IDE-TIPO-BDAMATCH = 1
  5795        MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCH
  5796        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH
  5797        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9
  5798           MOVE 0 TO IND-BLOQUEO-ABD06
  5799        END-IF
  5800     END-IF.
  5801
  5802*======================================================================
  5803 1000-U-INICIALIZAR-BDAMATCH.
  5804********************************************************************
  5805*1000-U-INICIALIZAR-BDAMATCH.
  5806* INPUT = VACIO
  5807* OUTPUT= VACIO
  5808* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
  5809* DEl MATCH.
  5810********************************************************************
  5811     MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.
  5812     MOVE 0 TO I-CTA-BDAMATCH.
  5813     INITIALIZE TABLA-CUENTAS-BDAMATCH.                           RMB0004
  5814     INITIALIZE TABLA-DIR-BDAMATCH.
  5815     INITIALIZE TABLA-TEL-BDAMATCH.
  5816     INITIALIZE TABLA-NOM-BDAMATCH.
  5817     INITIALIZE TABLA-GRUNOM-BDAMATCH.
  5818     INITIALIZE V-INTERRELAC-BDAMATCH.
  5819     MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
  5820                      POSIC-SUS-GRU-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 101
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5821     MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH
  5822     MOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.
  5823
  5824 2000-U-INSERTAR-DIR-BDAMATCH.
  5825********************************************************************
  5826*2000-U-INSERTAR-DIR-BDAMATCH.
  5827* INPUT = DIR-INPUT-BDAMATCH
  5828* OUTPUT= VACIO
  5829* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
  5830* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
  5831* LA DIRECCION CONTENGA ALGUN NUMERO
  5832********************************************************************
  5833     MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.
  5834     MOVE 1 TO I-BDAMATCH
  5835     MOVE 0 TO J-BDAMATCH
  5836     MOVE " " TO CAR-ANT-BDAMATCH
  5837     INITIALIZE T-CARTOT-BDAMATCH
  5838     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10            CAV0002
  5839       IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERIC
  5840          MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCH
  5841          IF CAR-ANT-BDAMATCH   NUMERIC
  5842             COMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)
  5843                     = V-CARTOT-BDAMATCH  (J-BDAMATCH)
  5844                     * 10 + CAR-ACT-BDAMATCH
  5845          ELSE
  5846             ADD 1 TO J-BDAMATCH
  5847             MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)
  5848                  TO V-CARTOT-BDAMATCH  (J-BDAMATCH)
  5849          END-IF
  5850       END-IF
  5851       MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCH
  5852       ADD 1 TO I-BDAMATCH
  5853     END-PERFORM.
  5854     SORT V-CARTOT-BDAMATCH   DESCENDING.
  5855     IF T-CARTOT-BDAMATCH   NOT = ZEROS AND
  5856        I-DIR-BDAMATCH < LIM-BDAMATCH
  5857        MOVE T-CARTOT-BDAMATCH TO
  5858             NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5859        MOVE SUSC-CTAS-BDAMATCH TO
  5860             SUS-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5861        MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5862        PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1
  5863                 UNTIL  POSIC-SUMA-BDAMATCH  >  10 OR
  5864                 V-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZERO
  5865           ADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)
  5866        END-PERFORM
  5867        ADD 1 TO I-DIR-BDAMATCH
  5868     END-IF.
  5869
  5870 2000-U-INSERTAR-TEL-BDAMATCH.
  5871********************************************************************
  5872*2000-U-INSERTAR-TEL-BDAMATCH.
  5873* INPUT = TEL-INPUT-BDAMATCH
  5874* OUTPUT= VACIO
  5875* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
  5876* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
  5877********************************************************************
  5878     IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 102
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5879        MOVE TEL-INPUT-BDAMATCH TO
  5880                                NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5881        MOVE SUSC-CTAS-BDAMATCH TO
  5882                                SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5883        MOVE I-CTA-BDAMATCH     TO
  5884                                CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5885        ADD 1 TO I-TEL-BDAMATCH
  5886     END-IF.
  5887
  5888 2000-U-INSERTAR-NOM-BDAMATCH.
  5889********************************************************************
  5890*2000-U-INSERTAR-NOM-BDAMATCH.
  5891* INPUT = NOM-INPUT-BDAMATCH
  5892* OUTPUT= VACIO
  5893* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
  5894* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
  5895********************************************************************
  5896     IF I-NOM-BDAMATCH < LIM-BDAMATCH AND
  5897        NOM-INPUT-BDAMATCH <> SPACES
  5898        MOVE NOM-INPUT-BDAMATCH  TO
  5899             NOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5900                                   NOM-LIMPI-BDAMATCH
  5901        MOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5902        MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCH
  5903                            NRO-VECES-2-BDAMATCH
  5904        PERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1
  5905          UNTIL  NRO-VECES-1-BDAMATCH  >  60
  5906          IF NRO-VECES-1-BDAMATCH  >  1 AND
  5907           NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "
  5908             SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCH
  5909          END-IF
  5910          IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "
  5911            COMPUTE  NRO-VECES-2-BDAMATCH =
  5912                     60 - NRO-VECES-1-BDAMATCH
  5913            MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +
  5914                  1:NRO-VECES-2-BDAMATCH)
  5915                TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)
  5916            IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +
  5917               1:NRO-VECES-2-BDAMATCH) = SPACES
  5918               MOVE  85           TO  NRO-VECES-1-BDAMATCH
  5919            END-IF
  5920          END-IF
  5921        END-PERFORM
  5922        INSPECT NOM-LIMPI-BDAMATCH
  5923                TALLYING       PESO-CTAS-TOT-BDAMATCH
  5924                FOR CHARACTERS BEFORE INITIAL " "
  5925        MOVE  PESO-CTAS-TOT-BDAMATCH TO
  5926              LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5927        IF FUENTE-REG-BDACSV >= 02                                RMB0004
  5928           MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)            RMB0004
  5929        END-IF                                                    RMB0004
  5930        MOVE  SUSC-CTAS-BDAMATCH TO
  5931              SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5932        ADD 1 TO I-NOM-BDAMATCH
  5933     END-IF.
  5934
  5935 2000-U-INSERTAR-CTA-BDAMATCH.
  5936********************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 103
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5937*2000-U-INSERTAR-CTA-BDAMATCH.
  5938* INPUT = CTA-INPUT-BDAMATCH
  5939* OUTPUT= VACIO
  5940* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
  5941* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
  5942********************************************************************
  5943     IF I-CTA-BDAMATCH < LIM-BDAMATCH AND
  5944        CTA-INPUT-BDAMATCH <> SPACES
  5945        ADD 1 TO I-CTA-BDAMATCH
  5946        MOVE CTA-INPUT-BDAMATCH TO
  5947             CTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)
  5948        MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
  5949        MOVE FALLECIDO-BDAMATCH TO                                RMB0003
  5950             CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)               RMB0003
  5951        IF FUENTE-REG-BDACSV >= 2                                 RMB0004
  5952           MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)      RMB0004
  5953        END-IF                                                    RMB0004
  5954     END-IF.
  5955 3000-U-ORDENAR-DIR-BDAMATCH.
  5956********************************************************************
  5957*3000-U-ORDENAR-DIR-BDAMATCH.
  5958* INPUT = TABLA DE DIRECCIONES LLENA
  5959* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
  5960* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
  5961* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  5962********************************************************************
  5963     SORT T-DIR-BDAMATCH
  5964          DESCENDING NUM-DIR-BDAMATCH
  5965          ASCENDING  CTA-DIR-BDAMATCH.
  5966     MOVE 1 TO I-CTA-BDAMATCH.
  5967     MOVE 0 TO FIL-FUE-BDAMATCH
  5968     MOVE 1 TO COL-FUE-BDAMATCH
  5969     MOVE 999                TO CTA-DIR-ANT-BDAMATCH
  5970     MOVE ALL "9"            TO NUM-DIR-ANT-BDAMATCH
  5971     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
  5972                         CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0
  5973       IF NUM-DIR-ANT-BDAMATCH <>
  5974                                 NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)
  5975          ADD  1 TO FIL-FUE-BDAMATCH
  5976          MOVE 1 TO COL-FUE-BDAMATCH
  5977          MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5978               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  5979          MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  5980          ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)
  5981          MOVE  I-CTA-BDAMATCH       TO  POSIC-SUMA-BDAMATCH
  5982          ADD 1 TO COL-FUE-BDAMATCH
  5983       ELSE
  5984          IF CTA-DIR-ANT-BDAMATCH <>
  5985             CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)
  5986             MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5987               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  5988             MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  5989             ADD 1 TO COL-FUE-BDAMATCH
  5990          END-IF
  5991            ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)
  5992       END-IF
  5993       MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5994                                          CTA-DIR-ANT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 104
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5995       MOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5996                                           NUM-DIR-ANT-BDAMATCH
  5997       ADD 1 TO I-CTA-BDAMATCH
  5998     END-PERFORM.
  5999     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6000
  6001 3000-U-ORDENAR-TEL-BDAMATCH.
  6002********************************************************************
  6003*3000-U-ORDENAR-TEL-BDAMATCH.
  6004* INPUT = TABLA DE TELEFONOS   LLENA
  6005* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
  6006* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
  6007* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6008********************************************************************
  6009     SORT T-TEL-BDAMATCH
  6010          DESCENDING NUM-TEL-BDAMATCH
  6011          ASCENDING  CTA-TEL-BDAMATCH .
  6012     MOVE 1 TO I-CTA-BDAMATCH.
  6013     MOVE 1 TO COL-FUE-BDAMATCH
  6014     MOVE 999      TO CTA-TEL-ANT-BDAMATCH
  6015     MOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCH
  6016     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH
  6017             OR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0
  6018             OR  FIL-FUE-BDAMATCH > LIM-BDAMATCH
  6019             OR  COL-FUE-BDAMATCH > LIM-BDAMATCH
  6020       IF NUM-TEL-ANT-BDAMATCH <>
  6021          NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6022          ADD  1 TO FIL-FUE-BDAMATCH
  6023          MOVE 1 TO COL-FUE-BDAMATCH
  6024          MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6025               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6026          MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6027          ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6028          MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCH
  6029          ADD 1 TO COL-FUE-BDAMATCH
  6030       ELSE
  6031          IF CTA-TEL-ANT-BDAMATCH <>
  6032             CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6033             MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6034                 CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6035             MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6036             ADD 1 TO COL-FUE-BDAMATCH
  6037          END-IF
  6038            ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)
  6039       END-IF
  6040       MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6041                                           CTA-TEL-ANT-BDAMATCH
  6042       MOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6043                                           NUM-TEL-ANT-BDAMATCH
  6044       ADD 1 TO I-CTA-BDAMATCH
  6045     END-PERFORM.
  6046     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6047
  6048 3000-U-ORDENAR-NOM-BDAMATCH.
  6049********************************************************************
  6050*3000-U-ORDENAR-NOM-BDAMATCH.
  6051* INPUT = TABLA DE NOMBRES     LLENA
  6052* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 105
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6053* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
  6054* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6055********************************************************************
  6056     SORT T-NOM-BDAMATCH
  6057          DESCENDING NOM-NOM-BDAMATCH
  6058          DESCENDING LNG-NOM-BDAMATCH
  6059          ASCENDING  CTA-NOM-BDAMATCH .
  6060     MOVE 1 TO I-NOM-BDAMATCH.
  6061     MOVE 1 TO GRU-NOM-BDAMATCH.
  6062     MOVE GRU-NOM-BDAMATCH TO
  6063          GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).
  6064     MOVE GRU-NOM-BDAMATCH TO
  6065          GRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).
  6066     MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6067          NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).
  6068     MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6069          SUSC-GRUP-SUS-BDAMATCH
  6070     MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TO
  6071          SUSC-GRUP-GRU-BDAMATCH
  6072     PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6073     IF  INV-BDAMATCH  =  1
  6074       ADD   1        TO
  6075       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6076     END-IF
  6077     MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6078          LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6079     ADD 1 TO I-NOM-BDAMATCH.
  6080     PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCH
  6081             OR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0
  6082       MOVE 1 TO I-GRU-BDAMATCH
  6083       MOVE 0 TO MATCH-OK-OUT-VALNOM
  6084       PERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =
  6085               SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCH
  6086               OR MATCH-OK-OUT-VALNOM = 1
  6087         MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6088              NOMBRE-INPUT-VALNOM
  6089         MOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TO
  6090              NOMBOK-INPUT-VALNOM
  6091         IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3                      RMB0004
  6092            IF NUM-IDE-INPUT-BDAMATCH >= 600000000 AND            RMB0004
  6093               NUM-IDE-INPUT-BDAMATCH <= 999999999                RMB0004
  6094               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004
  6095               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004
  6096            ELSE                                                  RMB0004
  6097               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004
  6098               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004
  6099            END-IF                                                RMB0004
  6100         ELSE                                                     RMB0004
  6101            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004
  6102            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004
  6103         END-IF                                                   RMB0004
  6104         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004
  6105            NOMBOK-INPUT-VALNOM(43:3) = ".-,"                     RMB0004
  6106            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004
  6107         END-IF                                                   RMB0004
  6108         PERFORM 10000-MATCH-NOMBRES-VALNOM
  6109         IF MATCH-OK-OUT-VALNOM = 1
  6110            MOVE I-GRU-BDAMATCH TO
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 106
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6111                 GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)
  6112            MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  6113                                 TO  SUSC-GRUP-SUS-BDAMATCH
  6114            MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6115                                 TO  SUSC-GRUP-GRU-BDAMATCH
  6116            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004
  6117               MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
  6118            END-IF                                                RMB0004
  6119            PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6120            IF  INV-BDAMATCH  =  1
  6121              ADD   1  TO
  6122       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6123            END-IF
  6124            IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >
  6125                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6126              MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6127                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6128              MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO            RMB0004
  6129                NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)             RMB0004
  6130            END-IF
  6131         END-IF
  6132         ADD 1 TO I-GRU-BDAMATCH
  6133       END-PERFORM
  6134       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO
  6135          ADD 1 TO GRU-NOM-BDAMATCH
  6136          MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6137               NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6138          MOVE GRU-NOM-BDAMATCH  TO
  6139               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)
  6140          MOVE GRU-NOM-BDAMATCH  TO
  6141               GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLM
  6142          MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  6143                             TO  SUSC-GRUP-SUS-BDAMATCH
  6144          MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6145                             TO  SUSC-GRUP-GRU-BDAMATCH
  6146          PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6147          IF  INV-BDAMATCH  =  1
  6148            ADD   1   TO
  6149       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6150          END-IF
  6151          MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6152               LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6153       ELSE                                                    *>
  6154          MOVE GRU-NOM-BDAMATCH TO
  6155               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLM
  6156       END-IF
  6157       ADD 1 TO I-NOM-BDAMATCH
  6158     END-PERFORM.
  6159     SORT T-NOM-BDAMATCH
  6160          DESCENDING NOM-NOM-BDAMATCH
  6161          DESCENDING GRU-NOMS-BDAMATCH
  6162          DESCENDING LNG-NOM-BDAMATCH
  6163          ASCENDING  CTA-NOM-BDAMATCH .
  6164     MOVE 1 TO I-CTA-BDAMATCH.
  6165     MOVE 1 TO COL-FUE-BDAMATCH
  6166     MOVE 999                TO CTA-NOM-ANT-BDAMATCH
  6167     MOVE ALL "9"            TO GRU-NOM-ANT-BDAMATCH
  6168     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 107
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6169             OR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0
  6170             OR FIL-FUE-BDAMATCH > LIM-BDAMATCH
  6171             OR COL-FUE-BDAMATCH > LIM-BDAMATCH
  6172       IF GRU-NOM-ANT-BDAMATCH <>
  6173          GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)
  6174          ADD  1 TO FIL-FUE-BDAMATCH
  6175          MOVE 1 TO COL-FUE-BDAMATCH
  6176          MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6177               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6178          MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6179          ADD 1 TO COL-FUE-BDAMATCH
  6180       ELSE
  6181          IF CTA-NOM-ANT-BDAMATCH <>
  6182             CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)
  6183             MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6184                  CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6185             MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6186             ADD 1 TO COL-FUE-BDAMATCH
  6187          END-IF
  6188       END-IF
  6189       MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6190            CTA-NOM-ANT-BDAMATCH
  6191       MOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TO
  6192            GRU-NOM-ANT-BDAMATCH
  6193       ADD 1 TO I-CTA-BDAMATCH
  6194     END-PERFORM.
  6195     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6196
  6197 4000-U-INTERELACIONAR-BDAMATCH.
  6198********************************************************************
  6199*4000-U-INTERELACIONAR-BDAMATCH.
  6200* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
  6201* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
  6202* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
  6203* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6204********************************************************************
  6205*    PERFORM 1110-MOSTRAR-MATRIZ1                                 RMB0004
  6206     MOVE 1 TO MOVIDO-BDAMATCH    .
  6207     PERFORM UNTIL MOVIDO-BDAMATCH = 0
  6208        MOVE 0 TO MOVIDO-BDAMATCH
  6209        MOVE 1 TO FIL-BUS-BDAMATCH
  6210        PERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCH
  6211          MOVE 1 TO COL-BUS-BDAMATCH
  6212          PERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCH
  6213            IF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)
  6214               > 0
  6215            MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)
  6216                 TO BUSCADO-BDAMATCH
  6217               PERFORM 4100-BUSCAR-RELACION-BDAMATCH
  6218            ELSE
  6219               MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCH
  6220            END-IF
  6221            ADD 1 TO COL-BUS-BDAMATCH
  6222          END-PERFORM
  6223          ADD 1 TO FIL-BUS-BDAMATCH
  6224        END-PERFORM
  6225     END-PERFORM.
  6226
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 108
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6227 4100-BUSCAR-RELACION-BDAMATCH.
  6228********************************************************************
  6229*4100-BUSCAR-RELACION-BDAMATCH.
  6230* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
  6231********************************************************************
  6232     MOVE 1 TO FIL-FUE-BDAMATCH.
  6233     PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH
  6234        IF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCH
  6235           MOVE 0 TO EXISTE-BDAMATCH
  6236           INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6237              TALLYING EXISTE-BDAMATCH
  6238              FOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCH
  6239            ADD 1 TO EXISTE-BDAMATCH
  6240            IF EXISTE-BDAMATCH <= 2000
  6241                PERFORM 4110-MOVER-RELACIONES-BDAMATCH
  6242           END-IF
  6243        END-IF
  6244        ADD 1 TO FIL-FUE-BDAMATCH
  6245     END-PERFORM.
  6246
  6247 4110-MOVER-RELACIONES-BDAMATCH.
  6248********************************************************************
  6249*4110-MOVER-RELACIONES-BDAMATCH.
  6250* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
  6251* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
  6252********************************************************************
  6253       MOVE 0 TO FIN-FUENTE-BDAMATCH.
  6254       INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6255               TALLYING FIN-FUENTE-BDAMATCH
  6256               FOR CHARACTERS BEFORE INITIAL "000 "
  6257       COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4
  6258       MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.
  6259       INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)
  6260               TALLYING LIBRE-BUSCADO-BDAMATCH
  6261               FOR CHARACTERS BEFORE INITIAL "000 "
  6262       COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4
  6263       ADD 1 TO LIBRE-BUSCADO-BDAMATCH.
  6264       MOVE 1 TO COL-FUE-BDAMATCH.
  6265       PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCH
  6266          MOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TO
  6267                         PORINSERTAR-BDAMATCH
  6268          MOVE 0 TO EXISTE-BDAMATCH
  6269          INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)
  6270               TALLYING EXISTE-BDAMATCH
  6271              FOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCH
  6272          ADD 1 TO EXISTE-BDAMATCH
  6273          IF EXISTE-BDAMATCH > 2000
  6274            MOVE PORINSERTAR-BDAMATCH TO
  6275            CAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)
  6276            ADD 1 TO LIBRE-BUSCADO-BDAMATCH
  6277            MOVE 1 TO MOVIDO-BDAMATCH
  6278          END-IF
  6279          ADD 1 TO COL-FUE-BDAMATCH
  6280       END-PERFORM.
  6281       INITIALIZE
  6282            FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR
  6283
  6284 5000-U-MEJOR-PORTAFOL-BDAMATCH.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 109
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6285********************************************************************
  6286*5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6287* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
  6288* PORTAFOLIO QUE TIENE MAS CUENTAS
  6289********************************************************************
  6290      MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.
  6291      MOVE 0 TO MAXREL-PER-BDAMATCH
  6292      MOVE 0 TO FIN-FUENTE-BDAMATCH.
  6293      MOVE 1 TO FIL-FUE-BDAMATCH.
  6294      MOVE 0 TO  PESOS-CTRL-BDAMATCH
  6295      PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH
  6296        INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6297               TALLYING FIN-FUENTE-BDAMATCH
  6298               FOR CHARACTERS BEFORE INITIAL "000 "
  6299        COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4
  6300        MOVE 0 TO PESO-CTAS-TOT-BDAMATCH
  6301        MOVE 1 TO POSIC-SUMA-BDAMATCH
  6302        MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH                   RMB0004
  6303        MOVE 0 TO  POSIC-SUSC-BDAMATCH                            RMB0004
  6304        MOVE 0 TO ENT-FIN-PORT-BDAMATCH                           RMB0004
  6305        MOVE 0 TO ENT-UNICAS-PORT-BDAMATCH                        RMB0004
  6306        PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1
  6307           UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCH
  6308           MOVE
  6309        FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)
  6310                TO  CTA-A-BUSCAR-BDAMATCH
  6311           IF CTA-A-BUSCAR-BDAMATCH > 0                           RMB0004
  6312            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
  6313                 TO SUSC-CTAS-BDAMATCH                            RMB0004
  6314            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
  6315                 TO I2-BDAMATCH                                   RMB0005
  6316            PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCH               RMB0004
  6317            PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCH               RMB0004
  6318            PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCH               RMB0004
  6319           END-IF                                                 RMB0004
  6320           ADD 4 TO  POSIC-SUMA-BDAMATCH
  6321        END-PERFORM
  6322        PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCH                    RMB0004
  6323        ADD 1 TO FIL-FUE-BDAMATCH
  6324      END-PERFORM.
  6325 5100-CALCULAR-PESO-DIR-BDAMATCH.                                 RMB0004
  6326     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1       RMB0004
  6327        UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH OR           RMB0004
  6328        CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROS           RMB0004
  6329        IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)                 RMB0004
  6330                                     =  CTA-A-BUSCAR-BDAMATCH     RMB0004
  6331          COMPUTE PESO-CTAS-TOT-BDAMATCH  =                       RMB0004
  6332                   PESO-CTAS-TOT-BDAMATCH +                       RMB0004
  6333          (NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *          RMB0004
  6334                  PESO-DIR-BDAMATCH )                             RMB0004
  6335        END-IF                                                    RMB0004
  6336     END-PERFORM.                                                 RMB0004
  6337 5200-CALCULAR-PESO-TEL-BDAMATCH.                                 RMB0004
  6338     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1             RMB0004
  6339        UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH OR              RMB0004
  6340        CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROS            RMB0004
  6341        IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)                RMB0004
  6342                                      =  CTA-A-BUSCAR-BDAMATCH    RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 110
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6343          COMPUTE  PESO-CTAS-TOT-BDAMATCH  =                      RMB0004
  6344             PESO-CTAS-TOT-BDAMATCH +                             RMB0004
  6345           (NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *         RMB0004
  6346             PESO-TEL-BDAMATCH )                                  RMB0004
  6347        END-IF                                                    RMB0004
  6348     END-PERFORM.                                                 RMB0004
  6349 5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
  6350******************************************************************
  6351*5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
  6352* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
  6353* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
  6354******************************************************************
  6355     SET IND-DIR-BDAMATCH TO 1.                                   RMB0004
  6356     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT END                      RMB0004
  6357         MOVE 1 TO  INV-BDAMATCH                                  RMB0004
  6358       WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =             RMB0004
  6359            SUSC-CTAS-BDAMATCH                                    RMB0004
  6360         MOVE 0 TO  INV-BDAMATCH                                  RMB0004
  6361     END-SEARCH.                                                  RMB0004
  6362     IF INV-BDAMATCH  =  1                                        RMB0004
  6363        AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCH                  RMB0004
  6364        COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
  6365                                       + PESO-NOM-BDAMATCH        RMB0004
  6366        ADD   1                TO  POSIC-SUSC-BDAMATCH            RMB0004
  6367        MOVE SUSC-CTAS-BDAMATCH  TO                               RMB0004
  6368             COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)           RMB0004
  6369*       MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCH             RMB0005
  6370        IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100                 RMB0005
  6371           IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2             RMB0005
  6372              ADD 1 TO ENT-FIN-PORT-BDAMATCH                      RMB0005
  6373           END-IF                                                 RMB0005
  6374        END-IF                                                    RMB0005
  6375        ADD 1 TO ENT-UNICAS-PORT-BDAMATCH                         RMB0004
  6376     END-IF.                                                      RMB0004
  6377     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1        RMB0004
  6378        ADD 1000 TO PESO-CTAS-TOT-BDAMATCH                        RMB0004
  6379     END-IF.                                                      RMB0004
  6380 5400-DEDUCIR-MEJ-PORT-BDAMATCH.                                  RMB0004
  6381     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCH                 RMB0004
  6382        MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCH        RMB0004
  6383     END-IF                                                       RMB0004
  6384     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCH            RMB0004
  6385        MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
  6386        MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
  6387        MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
  6388     ELSE                                                         RMB0004
  6389        IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCH         RMB0004
  6390           PERFORM 5410-DESEMPATAR-BDAMATCH                       RMB0004
  6391        END-IF                                                    RMB0004
  6392     END-IF.                                                      RMB0004
  6393 5410-DESEMPATAR-BDAMATCH.                                        RMB0004
  6394      IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCH        RMB0004
  6395         MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
  6396         MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
  6397         MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
  6398      ELSE                                                        RMB0004
  6399         IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
  6400            IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 AND      RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 111
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6401               NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
  6402                                                             ".-,"RMB0004
  6403               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
  6404               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
  6405               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
  6406                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
  6407            ELSE                                                  RMB0004
  6408              IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >          RMB0004
  6409                 LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
  6410               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
  6411               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
  6412               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
  6413                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
  6414            END-IF                                                RMB0004
  6415         END-IF                                                   RMB0004
  6416      END-IF.                                                     RMB0004
  6417 5000-U-VALIDAR-CUENTA-BDAMATCH.
  6418*********************************************************************
  6419*5000-U-VALIDAR-CUENTA-BDAMATCH.
  6420* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
  6421* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
  6422*********************************************************************
  6423     MOVE 0 TO VALCTA-OUTPUT-BDAMATCH
  6424     MOVE 1 TO I-BDAMATCH.
  6425     IF MEJOR-PORTAFOLIO-BDAMATCH > 0
  6426        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR
  6427          VALCTA-OUTPUT-BDAMATCH = 1 OR
  6428          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0
  6429          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)
  6430               TO J-BDAMATCH
  6431          IF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCH
  6432             MOVE 1 TO VALCTA-OUTPUT-BDAMATCH
  6433          END-IF
  6434          ADD 1 TO I-BDAMATCH
  6435        END-PERFORM
  6436     END-IF.
  6437*
  6438 6000-U-MEJOR-DIR-BDAMATCH.
  6439*********************************************************************
  6440*6000-U-MEJOR-DIR-BDAMATCH.
  6441*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
  6442*********************************************************************
  6443     SORT T-DIR-BDAMATCH
  6444          DESCENDING  NUM-CTAS-DIR-BDAMATCH
  6445          DESCENDING       LNG-DIR-BDAMATCH
  6446          DESCENDING       NUM-DIR-BDAMATCH
  6447          DESCENDING       CTA-DIR-BDAMATCH.
  6448    MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.
  6449
  6450 6000-U-MEJOR-TEL-BDAMATCH.
  6451*********************************************************************
  6452*6000-U-MEJOR-TEL-BDAMATCH.
  6453*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
  6454*********************************************************************
  6455     SORT T-TEL-BDAMATCH
  6456          DESCENDING  NUM-CTAS-TEL-BDAMATCH
  6457          DESCENDING       NUM-TEL-BDAMATCH
  6458          DESCENDING       CTA-TEL-BDAMATCH.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 112
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6459    MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
  6460*
  6461 6000-U-MEJOR-NOM-BDAMATCH.
  6462*********************************************************************
  6463*6000-U-MEJOR-NOM-BDAMATCH.
  6464*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
  6465*********************************************************************
  6466     SORT T-GRUNOM-BDAMATCH
  6467          DESCENDING  NUM-CTAS-GRUNOM-BDAMATCH
  6468          DESCENDING  LNG-GRUNOM-BDAMATCH
  6469          DESCENDING  NOM-GRUNOM-BDAMATCH.
  6470     MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.
  6471     PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1
  6472       UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCH
  6473          OR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROS
  6474          OR ESTA-CTA-BDAMATCH  =  1
  6475      PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1
  6476       UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH
  6477          OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROS
  6478          OR ESTA-CTA-BDAMATCH  =  1
  6479        IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =
  6480            GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)
  6481         PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1
  6482          UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCH
  6483           OR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
  6484              NRO-VECES-1-BDAMATCH) = 0
  6485           OR ESTA-CTA-BDAMATCH  =  1
  6486           IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =
  6487               CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
  6488                             NRO-VECES-1-BDAMATCH)
  6489             MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TO
  6490                  POSIC-SUS-GRU-BDAMATCH
  6491             MOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TO
  6492                  NOM-OUTPUT-BDAMATCH
  6493             MOVE 1 TO  ESTA-CTA-BDAMATCH
  6494           END-IF
  6495         END-PERFORM
  6496        END-IF
  6497      END-PERFORM
  6498     END-PERFORM.
  6499*
  6500 9000-U-REALIZAR-BDAMATCH.
  6501******************************************************************
  6502*9000-U-REALIZAR-BDAMATCH.
  6503* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL
  6504* MEJOR NOMBRE
  6505******************************************************************
  6506     MOVE  ZEROS                 TO  POSIC-SUSC-BDAMATCH
  6507     MOVE  ALL "9"               TO  TABLA-SUSC-DIR-BDAMATCH
  6508     PERFORM 3000-U-ORDENAR-DIR-BDAMATCH
  6509     PERFORM 3000-U-ORDENAR-TEL-BDAMATCH
  6510     PERFORM 3000-U-ORDENAR-NOM-BDAMATCH
  6511     PERFORM 4000-U-INTERELACIONAR-BDAMATCH
  6512     PERFORM 6000-U-MEJOR-DIR-BDAMATCH.
  6513     PERFORM 6000-U-MEJOR-TEL-BDAMATCH.
  6514     PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6515     PERFORM 6000-U-MEJOR-NOM-BDAMATCH.
  6516*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 113
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6517 9010-U-VER-FALLECIDO-BDAMATCH.
  6518*********************************************************************
  6519*9010-U-VER-FALLECIDO-BDAMATCH.
  6520* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL
  6521* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.
  6522*********************************************************************
  6523     MOVE 1 TO I-BDAMATCH.                                        RMB0003
  6524     IF MEJOR-PORTAFOLIO-BDAMATCH > 0                             RMB0003
  6525        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR                RMB0003
  6526          VALCTA-OUTPUT-BDAMATCH = 1 OR                           RMB0003
  6527          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
  6528          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
  6529               TO J-BDAMATCH                                      RMB0003
  6530          ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCH                       RMB0003
  6531          IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1               RMB0003
  6532             ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCH                 RMB0003
  6533          END-IF                                                  RMB0003
  6534          ADD 1 TO I-BDAMATCH                                     RMB0003
  6535        END-PERFORM                                               RMB0003
  6536     END-IF.                                                      RMB0003
  6537*                                                                 RMB0003
  6538 400-BUSCAR-SUSC-GRUPO-BDAMATCH.
  6539******************************************************************
  6540*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
  6541* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
  6542******************************************************************
  6543     SET IND-NOM-BDAMATCH TO 1.
  6544     SEARCH ALL REG-SUSC-NOM-BDAMATCH AT END
  6545         MOVE 1 TO  INV-BDAMATCH
  6546         WHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =
  6547              SUSC-GRUPO-BDAMATCH
  6548         MOVE 0 TO  INV-BDAMATCH
  6549     END-SEARCH.
  6550     IF  INV-BDAMATCH = 1
  6551     AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCH
  6552       ADD 1 TO  POSIC-SUS-GRU-BDAMATCH
  6553       MOVE SUSC-GRUP-SUS-BDAMATCH TO
  6554            COD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)
  6555       MOVE SUSC-GRUP-GRU-BDAMATCH TO
  6556            GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)
  6557     END-IF.
* 6558 COPY AMNISTIA21.PROC.
  6559*AMNISTIA21.PROC.v.0013
  6560* OJO CAMBIO PARA QUE APLIQUE CON 2n y no 2n+1 y solo hasta que
  6561* FISICAMENTE SE HAYA RECIBIDO LA INFORMACIÓN
  6562****************************************************************
  6563
  6564* 21/01/2009
  6565******************************************************************
  6566*  Interpretación técnica de la Aplicación la ley de habeas data
  6567*  para Datacredito según la discusión del documento
  6568*  "Amnistía - temas por definir" y la aplicación de las
  6569*  definiciones dadas.
  6570*
  6571*  La aplicación de la amnistía a cuentas para un individuo
  6572*  se otorgará solo bajo las siguiente condiciones:
  6573*
  6574*  Para cualquier fecha de consulta al individuo después de
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 114
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6575*  la aprobación o vigencia de la ley
  6576*
  6577* -> Sí el individuo está al día en todas sus obligaciones
  6578*   (sin importar fecha de actualización)
  6579*
  6580* ->      Sí el individuo tiene cuentas canceladas que hayan
  6581*    tenido mora y llevan un año o más de cancelación
  6582*
  6583* -> Sí la fecha de la consulta está dentro del
  6584*    periodo de gracia
  6585*
  6586*    = Se deben amnistiar dichas cuentas canceladas
  6587*
  6588* -> Sí la fecha de la consulta es posterior al
  6589*    periodo de gracia
  6590*
  6591*    -> Sí no existe ninguna mora después del
  6592*       periodo de gracia
  6593*
  6594*       = Se deben amnistiar dichas cuentas canceladas
  6595******************************************************************
  6596*  Colorarios:
  6597*
  6598* - Solo se amnistían las cuentas canceladas que tuvieron mora
  6599*
  6600* - El derecho a la amnistía de obligaciones se pierde si incurre
  6601*   en mora el individuo después del periodo de gracia
  6602*
  6603* - Solo se tiene el derecho a la amnistía de cuentas si el
  6604*   individuo está con todas sus obligaciones al día
  6605*
  6606******************************************************************
  6607* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*
  6608* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *
  6609* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *
  6610*            | AJUST1 - AJUSTES A LAS RUTINA DE CALCULO DE AMNIS-*
  6611*            |          TIA CON 48 POSICIONES                    *
  6612******************************************************************
  6613* CAV0003    | MORVEC - NO ASUMIR EL ESTADO DEL VECTOR PARA EL   *
  6614* 19-DIC-2008|    MES EN QUE SE HACE LA CONSULTA. SE CAMBIA LA   *
  6615* C. VELASCO |    CONDICION DE PRIMERA MORA DEL VECTOR DE MENOR  *
  6616*            |    A 12 MESES PARA NO AMNISTIAR A MENOR IGUAL A 12*
  6617******************************************************************
  6618* GJC0004    | LEY002 - POR SOLICITUD DE JURIDICO SE DEBE APLICAR*
  6619* 21-ENE-2009|    AMNISTIA A CARTERAS RECUPERADAS Y CANCELADAS   *
  6620* G. JIMENEZ |    POR MAL MANEJO AUNQUE NO TENGAN MORA MAXIMA >  *
  6621*            |    QUE 0. O VECTOR SIN HISTORIA                   *
  6622******************************************************************
  6623* GJC0005    | LEY003 - SE DEJA EL PERDON DE LAS CARTERAS RECUPE-*
  6624* 19-MAR-2009|    RADAS Y CANCELADAS POR MAL MANEJO CON IGUAL    *
  6625* G. JIMENEZ |    MANEJO QUE CUALQUIER OTRA CUENTA QUE HAYA TENI-*
  6626*            |    DO MORA.                                       *
  6627******************************************************************
  6628* GJC0006    | LEY004 - APLICACION DE ARTICULO 13 DE LA LEY 1266 *
  6629* 28-ENE-2009|    CORRESPONDIENTE A LA APLICACION DE CADUCIDADES *
  6630* G. JIMENEZ |    EN UN TIEMPO CORRESPONDIENTE AL DOBLE DE LA    *
  6631*            |    MORA                                           *
  6632******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 115
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6633* GJC0007    | LEY005 - AJUSTE A RECALCULO DE NOVEDAD PARA QUE SI*
  6634* 05-JUN-2009|    HAY CARTERA RECUPERADA O CANCELADA POR MAL MANE*
  6635* G. JIMENEZ |    JO SIN MORAS SOLO SE PERDONE EL ESTADO SI LA   *
  6636*            |    CUENTA TUVO PERDON DE OTRA FORMA NO            *
  6637******************************************************************
  6638* GJC0008    | LEY006 - AJUSTE PARA QUE CUANDO EN EL MES QUE SE  *
  6639* 09-JUN-2009|   CUMPLE EL TIEMPO DEL PERDON HAY MORA PARA LA    *
  6640* G. JIMENEZ |   IDENTIFICACION Y HAY QUE HACER DESPLAZAMIENTO SE*
  6641*            |   APLIQUE EL PERDON ADECUADAMENTE                 *
  6642*            |   SE TOMA LA FECHA DEL CURRENT DATE POR CADA TRAN-*
  6643*            |   SACCION QUE ENTRA A LA RUTINA
  6644******************************************************************
  6645* GJC0009    | LEY007 - SE CAMBIA LA APLICACION DE ARTICULO 13 DE*
  6646* 26-JUN-2009|   POR PERSONA A POR CUENTA                        *
  6647* G. JIMENEZ |                                                   *
  6648******************************************************************
  6649* GJC0010    | BBVA01 - SE CREA LOGICA PARA QUE EN LA REVISION DE*
  6650* AGOSTO-2009|   LA AMNISTIA CUANDO SE MIRA AL CLIENTE SE ELIMINE*
  6651* G. JIMENEZ |   LA REVISION DE CUENTAS DEL BBVA                 *
  6652******************************************************************
  6653* GJC0011    | DBLMOR - SE CONTEMPLA EL CASO EN QUE EL TIEMPO EN *
  6654* AGOSTO-2011|   MORA HAYA SIDO MAYOR DE 24 MESES Y EL DOBLE DE  *
  6655* G. JIMENEZ |   ESTAS MORAS SIEMPRE DEBE SER 48                 *
  6656*            | PRSCRP - CUANDO UNA CUENTA TIENE PRESCIPCION NO SE*
  6657*            |   PUEDE APLICAR ARTÍCULO 21 PORQUE FINALMENTE NO  *
  6658*            |   PAGO Y SIEMPRE SE APLICA ARTICULO 13 A MENOS QUE*
  6659*            |   EL VECTOR SOLO TENGA MORAS DE 120 Y CEROS       *
  6660******************************************************************
  6661* GJC0012    | CADUC1 - SE HACEN LOS CAMBIOS NECESARIOS PARA     *
  6662* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE *
  6663* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13        *
  6664*            | ESTA48 - SI SE APLICÓ ARTICULO 13 O CADUCIDAD
  6665******************************************************************
  6666* GJC0013    | LEY008 - SE HACE EL CAMBIO PARA NO EXAMINAR SI LA *
  6667* G. JIMENEZ |          PERSONA TIENE DERECHO A LA AMNISTIA, YA  *
  6668* 23-ENE-2014|          NO APLICA, SOLO ARTICULO 13. (C.VELASCO) *
  6669******************************************************************
  6670
  6671
  6672*200700-AMNISTIA-CLIENTES.                                       *
  6673* RUTINA QUE LEE EL ARCHIVO DE CARTERA PARA                      *
  6674* DETERMINAR SI EL CLIENTE ES OBJETO DE BENEFICIO DE AMNISTIA    *
  6675******************************************************************
  6676 200700-AMNISTIA-CLIENTES.
  6677*    PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009
  6678     IF SW-FCHGRACIA-LEEMSTRS = ZEROS
  6679        IF FECHA-INI-AMNIST21 = ZEROS
  6680           PERFORM 200710-VALIDAR-FECHA-INI-AMNI
  6681        END-IF
  6682        COMPUTE MES-GRACIA-AMNIST21 = MES-INI-AMNIST21 +
  6683                                 MESES-GRACIA-AMNIST21
  6684        MOVE  ANO-INI-AMNIST21  TO  ANO-GRACIA-AMNIST21
  6685        IF MES-GRACIA-AMNIST21 > 12
  6686           COMPUTE MES-GRACIA-AMNIST21 = MES-GRACIA-AMNIST21 - 12
  6687           ADD   1         TO  ANO-GRACIA-AMNIST21
  6688        END-IF
  6689        MOVE 1 TO SW-FCHGRACIA-LEEMSTRS
  6690     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 116
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6691     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009
  6692     IF FECHA-SYS-AMNIST21 >= FECHA-INI-AMNIST21
  6693        AND ANO-HOY-AMNIST21 < 2014                               GJC0013
  6694        IF TIPO-ID-ABD07 <> TIPO-ID-INI-AMNIST21  OR
  6695           NUM-ID-ABD07  <> NUME-ID-INI-AMNIST21
  6696           MOVE TIPO-ID-ABD07 TO TIPO-ID-INI-AMNIST21
  6697           MOVE NUM-ID-ABD07  TO NUME-ID-INI-AMNIST21
  6698           PERFORM 5000-EXAMINAR-AMINISTIA-PERSONA
  6699        END-IF
  6700     END-IF.
  6701
  6702******************************************************************
  6703 200710-VALIDAR-FECHA-INI-AMNI.
  6704******************************************************************
  6705     DISPLAY VAR-AMBIENTE-AMNIST21 UPON ENVIRONMENT-NAME
  6706     ACCEPT VAR-AMBIENTE-AMNIST21 FROM ENVIRONMENT-VALUE
  6707     IF VAR-AMBIENTE-AMNIST21 = "FECHA_AMNI"
  6708        DISPLAY
  6709         "NO SE HA FIJADO LA VARIABLE DE AMBIENTE DE AMNISTIA"
  6710        STOP RUN
  6711     ELSE
  6712        IF VAR-AMBIENTE-AMNIST21 = SPACES
  6713           MOVE 208001 TO FECHA-INI-AMNIST21
  6714           MOVE 1 TO VERSION-AMNIST21
  6715           DISPLAY "EJECUCION SIN TOMAR AMNISTIA "
  6716                    FECHA-INI-AMNIST21
  6717        ELSE
  6718           MOVE VAR-AMBIENTE-AMNIST21(1:6) TO FECHA-INI-AMNIST21
  6719           IF ANO-INI-AMNIST21 > 2007 AND < 2030 AND
  6720              MES-INI-AMNIST21 > 0 AND < 13
  6721              DISPLAY
  6722              "EJECUCION DE PROG CON AMNISTIA INICIADO EN "
  6723               FECHA-INI-AMNIST21
  6724              MOVE VAR-AMBIENTE-AMNIST21(7:1) TO VERSION-AMNIST21
  6725              IF VERSION-AMNIST21 > 0 AND < 3
  6726                 DISPLAY
  6727                "EJECUCION DE PROG CON AMNISTIA CON RUTINA  "
  6728                 VERSION-AMNIST21
  6729              ELSE
  6730                 DISPLAY
  6731                "LA VERSION DE RUTINA DE AMNISTIA ES INVALIDA "
  6732                 VERSION-AMNIST21
  6733                 STOP RUN
  6734              END-IF
  6735           ELSE
  6736              DISPLAY
  6737              "FECHA DE EJECUCION DE AMNISTIA INVALIDA "
  6738               FECHA-INI-AMNIST21
  6739              STOP RUN
  6740           END-IF
  6741        END-IF
  6742     END-IF.
  6743     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0008
  6744 200711-CALCULE-FECHA-HOY.                                        GJC0009
  6745******************************************************************
  6746* 200711-CALCULE-FECHA-HOY.
  6747* SE ASIGNA LA FECHA DEL DÍA PARA PODER REALIZAR EL MANEJO DE PROCESOS
  6748* HISTORICOS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 117
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6749******************************************************************
  6750        MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21        GJC0009
  6751        DISPLAY VAR-AMB-HOY-AMNIST21 UPON ENVIRONMENT-NAME        GJC0009
  6752        ACCEPT VAR-AMB-HOY-AMNIST21 FROM ENVIRONMENT-VALUE        GJC0009
  6753        IF VAR-AMB-HOY-AMNIST21(1:9) = "FECHA_HOY"                GJC0009
  6754           MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21     GJC0009
  6755        ELSE                                                      GJC0009
  6756           IF VAR-AMB-HOY-AMNIST21 = SPACES                       GJC0009
  6757              MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21  GJC0009
  6758           ELSE                                                   GJC0009
  6759              MOVE VAR-AMB-HOY-AMNIST21 TO VAR-FEC-AMB-AMNIST21   GJC0009
  6760              IF (ANO-VAR-FEC-AMB-AMNIST21 < 2000 OR > 2030) OR   GJC0009
  6761                 (MES-VAR-FEC-AMB-AMNIST21 < 1 AND > 12) OR       GJC0009
  6762                 (DIA-VAR-FEC-AMB-AMNIST21 < 1 AND > 31)          GJC0009
  6763                 DISPLAY "FECHA DE VARIABLE DE AMBIENTE FECHA-HOY"GJC0009
  6764                 DISPLAY "ES INVALIDA, SE TOMA FECHA DEL DIA DE"  GJC0009
  6765                 DISPLAY "HOY"                                    GJC0009
  6766              ELSE                                                GJC0009
  6767                 MOVE VAR-FEC-AMB-AMNIST21 TO FECHA-HOY-AMNIST21  GJC0009
  6768              END-IF                                              GJC0009
  6769           END-IF                                                 GJC0009
  6770        END-IF                                                    GJC0009
  6771     IF SW-FCHGRACIA-LEEMSTRS = 0                                 GJC0009
  6772     DISPLAY                                                      GJC0009
  6773     "PARA APLICACION DE ARTICULO 13 SE TOMA COMO FECHA DEL DIA " GJC0009
  6774     FECHA-HOY-AMNIST21                                           GJC0009
  6775     END-IF.                                                      GJC0009
  6776
  6777******************************************************************
  6778 5000-EXAMINAR-AMINISTIA-PERSONA.
  6779******************************************************************
  6780     MOVE  0     TO SW-AMNIST21
  6781     INITIALIZE   WORK-CLIENTE-AMNIST21                           CAV0002
  6782     MOVE  LLAVE-MAES-CREDIT TO  LLAVE-INI-AMNIST21               GJC0006
  6783     MOVE  TIPO-ID-ABD07     TO  TIPO-ID-MAES-AMNIST21            GJC0006
  6784     MOVE  NUM-ID-ABD07      TO  NUM-ID-MAES-AMNIST21             GJC0006
  6785     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006
  6786     INITIALIZE VECTOR-MORAS-IDE-13-AMNIST21 REPLACING            GJC0006
  6787             ALPHANUMERIC DATA BY CINCOS-AMNIST21                 GJC0006
  6788     MOVE   0   TO  SW-AMNIST21                                   GJC0006
  6789     MOVE 999 TO MESES-FALTAN-AMNIST21                            GJC0006
  6790     PERFORM 200710-READ-ICMCRE-AMNISTIA                          GJC0006
  6791     IF MORAS-ACTUAL-AMNIST21 = ZEROS                             GJC0006
  6792        IF VERSION-AMNIST21 = 1                                   GJC0006
  6793           IF CTAS-MAY12-AMNIST21 = 1                             GJC0006
  6794              MOVE 1 TO SW-AMNIST21                               GJC0006
  6795           END-IF                                                 GJC0006
  6796        ELSE                                                      GJC0006
  6797           IF CTAS-MAY12-AMNIST21 = 1 AND                         GJC0006
  6798              CTAS-MEN12-AMNIST21 = 0                             GJC0006
  6799              MOVE 1 TO SW-AMNIST21                               GJC0006
  6800           END-IF                                                 GJC0006
  6801        END-IF                                                    GJC0006
  6802     END-IF                                                       GJC0006
  6803     PERFORM 200800-RESTAURAR-REGISTROS.                          GJC0006
  6804*    END-IF.                                                      GJC0006
  6805
  6806******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 118
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6807*200710-READ-ICMCRE-AMNISTIA.                                    *
  6808* RUTINA ENCARGADA DE LEER EL MAESTRO DE CARTERA  ICMCRE         *
  6809******************************************************************
  6810 200710-READ-ICMCRE-AMNISTIA.
  6811     INITIALIZE        LLAVE-MAES-CREDIT
  6812     MOVE  TIPO-ID-MAES-AMNIST21  TO  TIPO-ID-ABD07
  6813     MOVE  NUM-ID-MAES-AMNIST21   TO  NUM-ID-ABD07
  6814     START MAESTRO-CREDIT  KEY NOT < LLAVE-MAES-CREDIT
  6815           INVALID KEY
  6816                   MOVE 9 TO TIPO-ID-ABD07
  6817           NOT INVALID KEY
  6818                   READ MAESTRO-CREDIT NEXT
  6819                            AT  END
  6820                                MOVE 9 TO TIPO-ID-ABD07
  6821                   END-READ
  6822     END-START
  6823     PERFORM UNTIL TIPO-ID-ABD07 NOT = TIPO-ID-MAES-AMNIST21 OR
  6824                   NUM-ID-ABD07  NOT = NUM-ID-MAES-AMNIST21       GJC0006
  6825*                         MORAS-ACTUAL-AMNIST21 > ZEROS           GJC0006
  6826           IF COD-SUS-ABD07 = 020050 OR 030050 OR 050050 OR       GJC0010
  6827                              130050                              GJC0010
  6828              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0010
  6829           END-IF                                                 GJC0010
  6830           IF NOV-REPORT-ABD07 > 0 AND NOV-REPORT-ABD07 < 51
  6831              PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  6832              IF IND-BLOQUEO-ABD07 = 0
  6833                 MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  6834                 READ SUSCRIPTOR  IGNORE LOCK
  6835                   INVALID KEY MOVE 0 TO ESTADO-ABD02
  6836                 END-READ
  6837                 IF ESTADO-ABD02 = 1
  6838                    IF MORAS-ACTUAL-AMNIST21 = 0                  GJC0006
  6839                       PERFORM 200720-AMNIST-OBLIGACIONES         GJC0006
  6840                    END-IF                                        GJC0006
  6841* SE DEBE HABILITAR ESTE LLAMADO SI SE QUIERE PERDON POR PERSONA  GJC0009
  6842* Y NO POR CUENTA                                                 GJC0009
  6843*PER                PERFORM 200760-LLENAR-VEC-MORAS-PERS          GJC0009
  6844                 END-IF
  6845              END-IF
  6846           END-IF
  6847           READ MAESTRO-CREDIT NEXT
  6848                AT  END
  6849                    MOVE 9 TO TIPO-ID-ABD07
  6850           END-READ
  6851     END-PERFORM.
  6852
  6853******************************************************************
  6854*200720-AMNIST-OBLIGACIONES.                                     *
  6855* DETERMINA SI EXISTEN MORAS ACTUALES Y LOS REGISTROS CON MORA   *
  6856* CANCELADOS QUE CULPLIERON EL TIEMPO ESTIPULA EN LA LEY (1 AÑO) *
  6857******************************************************************
  6858 200720-AMNIST-OBLIGACIONES.
  6859     IF NOV-CART-CODINT-AMNIST21(NOV-REPORT-ABD07) = 12 OR 13
  6860                                                     OR 14 OR 15
  6861                                                     OR 09 OR 11
  6862        ADD 1 TO MORAS-ACTUAL-AMNIST21
  6863     END-IF
  6864     IF ESTADO-OBLIG-ABD07 = 10                                   GJC0011
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 119
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6865        ADD 1 TO MORAS-ACTUAL-AMNIST21                            GJC0011
  6866     END-IF                                                       GJC0011
  6867     IF MORAS-ACTUAL-AMNIST21 = ZEROS AND
  6868       ((MORA-MAXIMA-ABD07 > ZEROS OR MORA-MAXIMA-R-ABD07 > ZEROS)GJC0004
  6869        OR (NOV-REPORT-ABD07 = 03 OR 46))                         GJC0004
  6870        PERFORM 200740-VER-ANTIGUEDAD-MORAS
  6871     END-IF.
  6872
  6873******************************************************************
  6874*200740-VER-ANTIGUEDAD-MORAS.                                    *
  6875* DETERMINA SI HAY MORAS MAYORES O MENORES A UN AÑO              *
  6876******************************************************************
  6877 200740-VER-ANTIGUEDAD-MORAS.
  6878     MOVE ZEROS TO MESES-VEC-AMNIST21 VECT1-AMNIST21
  6879                   VECTOR-TOT-AMNIST21 MESES-GRC-AMNIST21
  6880                   VECT2-AMNIST21 VECT3-AMNIST21 VECT4-AMNIST21
  6881     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006
  6882     IF MESES-NOV-AMNIST21 >= 12
  6883        MOVE ZEROS TO MESES-VEC-AMNIST21
  6884     ELSE
  6885        COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -
  6886                MESES-NOV-AMNIST21
  6887     END-IF
  6888     IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21
  6889        COMPUTE MESES-GRC-AMNIST21 =
  6890             (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -
  6891             (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)
  6892     ELSE
  6893        MOVE ZEROS TO MESES-GRC-AMNIST21
  6894     END-IF
  6895        MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21
  6896        MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21
  6897        MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21
  6898        MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21
  6899        MOVE  1 TO K-AMNIST21
  6900        MOVE 12 TO L-AMNIST21
  6901        PERFORM UNTIL L-AMNIST21 = 0
  6902          MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO
  6903               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6904          ADD 1 TO K-AMNIST21
  6905          SUBTRACT 1 FROM L-AMNIST21
  6906        END-PERFORM
  6907        MOVE 12 TO L-AMNIST21
  6908        PERFORM UNTIL L-AMNIST21 = 0
  6909          MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO
  6910               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6911          ADD 1 TO K-AMNIST21
  6912          SUBTRACT 1 FROM L-AMNIST21
  6913        END-PERFORM
  6914        MOVE 12 TO L-AMNIST21
  6915        PERFORM UNTIL L-AMNIST21 = 0
  6916          MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO
  6917               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6918          ADD 1 TO K-AMNIST21
  6919          SUBTRACT 1 FROM L-AMNIST21
  6920        END-PERFORM
  6921        MOVE 12 TO L-AMNIST21
  6922        PERFORM UNTIL L-AMNIST21 = 0
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 120
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6923          MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO
  6924               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6925          ADD 1 TO K-AMNIST21
  6926          SUBTRACT 1 FROM L-AMNIST21
  6927        END-PERFORM
  6928        MOVE ZEROS TO SW-SALIR-VECT
  6929        PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL
  6930                X-AMNIST21 >  48 OR
  6931                MORAS-ACTUAL-AMNIST21 > ZEROS OR
  6932                SW-SALIR-VECT > ZEROS
  6933         IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR "3" OR "4"
  6934             IF FECHA-SYS-AMNIST21 > FECHA-GRACIA-AMNIST21
  6935                IF X-AMNIST21 < MESES-GRC-AMNIST21
  6936                   ADD  1  TO  MORAS-ACTUAL-AMNIST21
  6937                END-IF
  6938             END-IF
  6939             IF MORAS-ACTUAL-AMNIST21 = ZEROS
  6940                IF  X-AMNIST21 <= MESES-VEC-AMNIST21              CAV0003
  6941                    MOVE 1 TO CTAS-MEN12-AMNIST21
  6942                    MOVE 1 TO SW-SALIR-VECT
  6943                ELSE
  6944                    MOVE 1 TO CTAS-MAY12-AMNIST21
  6945                    MOVE 1 TO SW-SALIR-VECT
  6946                END-IF
  6947             END-IF
  6948         END-IF
  6949        END-PERFORM
  6950        IF X-AMNIST21 > 48 *> CASOS DE NO HAY MORA EN EL VECTOR
  6951           MOVE 1 TO CTAS-MAY12-AMNIST21
  6952        END-IF.                                                   GJC0005
  6953*****************************************************************
  6954*200745-CALCULAR-MESES-A-HOY.                             *
  6955*SE REALIZA EL CALCULO PARA DETERMINAR CUANTOS MESES DE DESACTUA-*
  6956*LIZACION O CIERRE TIENE LA CUENTA RESPECTO AL DIA DE HOY        *
  6957******************************************************************
  6958 200745-CALCULAR-MESES-A-HOY.                                     GJC0006
  6959     MOVE ZEROS              TO  FECHA-AUX-AMNIST21               GJC0006
  6960     MOVE FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21               GJC0006
  6961     PERFORM 200950-CONVIERTE-FECHA                               GJC0006
  6962     MOVE    ZEROS           TO  MESES-NOV-AMNIST21               GJC0006
  6963     COMPUTE MESES-NOV-AMNIST21 =                                 GJC0006
  6964          (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -            GJC0006
  6965          (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21).             GJC0006
  6966*****************************************************************
  6967*200760-LLENAR-VEC-MORAS-PERS.                             *
  6968*DE CADA CUENTA QUE SE VA LEYENDO SE TOMAN LAS MORAS Y SE VA LLE-*
  6969* NANDO EL VECTOR DE MORAS DE TODA LA PERSONA                    *
  6970******************************************************************
  6971 200760-LLENAR-VEC-MORAS-PERS.                                    GJC0006
  6972     MOVE 0 TO K-AMNIST21                                         GJC0006
  6973     IF MORA-MAXIMA-ABD07 > 0 OR MORA-MAXIMA-R-ABD07 > 0          GJC0006
  6974        MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21          GJC0006
  6975        MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21          GJC0006
  6976        MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21          GJC0006
  6977        MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21          GJC0006
  6978        MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO          GJC0006
  6979             MOR-EST-CTA-AMNIST21                                 GJC0006
  6980        PERFORM 200745-CALCULAR-MESES-A-HOY                       GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 121
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6981        IF MESES-NOV-AMNIST21 < 100                               GJC0006
  6982           COMPUTE K-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006
  6983        ELSE                                                      GJC0006
  6984           MOVE 0 TO K-AMNIST21                                   GJC0006
  6985        END-IF                                                    GJC0006
  6986        MOVE 49 TO L-AMNIST21                                     GJC0006
  6987        PERFORM UNTIL K-AMNIST21 = 0 OR L-AMNIST21 = 0            GJC0006
  6988          IF VEC-MOR-IDE-13-AMNIST21(K-AMNIST21) = 5              GJC0006
  6989             IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5      GJC0006
  6990                MOVE  1 TO VEC-MOR-IDE-13-AMNIST21(K-AMNIST21)    GJC0006
  6991             END-IF                                               GJC0006
  6992          END-IF                                                  GJC0006
  6993          COMPUTE K-AMNIST21 = K-AMNIST21 - 1                     GJC0006
  6994          COMPUTE L-AMNIST21 = L-AMNIST21 - 1                     GJC0006
  6995        END-PERFORM                                               GJC0006
  6996        IF MOR-EST-CTA-AMNIST21 <> 5                              GJC0006
  6997           MOVE 100 TO L-AMNIST21                                 GJC0006
  6998           PERFORM VARYING K-AMNIST21 FROM 1 BY 1 UNTIL           GJC0006
  6999               K-AMNIST21 > MESES-NOV-AMNIST21 OR L-AMNIST21 = 0  GJC0006
  7000              MOVE 1 TO VEC-MOR-IDE-13-AMNIST21(L-AMNIST21)       GJC0006
  7001              COMPUTE L-AMNIST21 = L-AMNIST21 - 1                 GJC0006
  7002           END-PERFORM                                            GJC0006
  7003        END-IF                                                    GJC0006
  7004     END-IF.                                                      GJC0006
  7005******************************************************************
  7006*200800-RESTAURAR-REGISTROS.                                      *
  7007* RUTINA ENCARGADA DE LEER EL REGISTRO ORIGINAL PARA AMNISTIAR   *
  7008******************************************************************
  7009 200800-RESTAURAR-REGISTROS.
  7010     MOVE LLAVE-INI-AMNIST21 TO LLAVE-MAES-CREDIT
  7011     READ MAESTRO-CREDIT INVALID KEY
  7012           DISPLAY " ERROR READ ICMCRE "
  7013     END-READ
  7014     IF REG-SUSCRIPTOR-AMNISTIA21 <> REG-SUSCRIPTOR
  7015        MOVE REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR
  7016     END-IF.
  7017
  7018 200850-AMNISTIA-REGISTROS.
  7019******************************************************************
  7020*200850-AMNISTIA-REGISTROS.                                      *
  7021* RUTINA ENCARGADA DE VALIDAR SI APLICA O NO AMNISTIA AL RESGISTR*
  7022******************************************************************
  7023       MOVE ZEROS TO MESES-VEC-AMNIST21 MESES-GRC-AMNIST21
  7024                     VECT1-AMNIST21 VECT2-AMNIST21 VECT3-AMNIST21
  7025                     VECT4-AMNIST21 VECTOR-TOT-AMNIST21
  7026       MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21
  7027       MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  7028       READ SUSCRIPTOR  IGNORE LOCK
  7029            INVALID KEY MOVE 0 TO ESTADO-ABD02
  7030       END-READ
  7031       IF ESTADO-ABD02 = 1
  7032        IF TAB-VIG-CART-AMNIST21(NOV-REPORT-ABD07) = 0 OR
  7033           ((NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16) OR          CAV0002
  7034            (NOV-REPORT-R-ABD07 = 13 OR 14 OR 15 OR 16))          CAV0002
  7035          IF ((MORA-MAXIMA-ABD07 > ZEROS OR                       GJC0004
  7036              MORA-MAXIMA-R-ABD07 > ZEROS) OR                     GJC0004
  7037               (NOV-REPORT-ABD07 = 03 OR 46)) AND                 GJC0004
  7038              IND-BLOQUEO-ABD07 = 0                               CAV0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 122
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7039           MOVE  ZEROS              TO  FECHA-AUX-AMNIST21
  7040           MOVE  FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21
  7041           PERFORM 200950-CONVIERTE-FECHA
  7042           MOVE    ZEROS            TO  MESES-NOV-AMNIST21
  7043           COMPUTE MESES-NOV-AMNIST21 =
  7044                   (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -
  7045                   (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21)
  7046           IF MESES-NOV-AMNIST21 >= 12
  7047              MOVE ZEROS TO MESES-VEC-AMNIST21
  7048           ELSE
  7049           COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -
  7050                   MESES-NOV-AMNIST21
  7051           END-IF
  7052           IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21
  7053              COMPUTE MESES-GRC-AMNIST21 =
  7054                 (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -
  7055                 (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)
  7056           ELSE
  7057              MOVE ZEROS TO MESES-GRC-AMNIST21
  7058           END-IF
  7059           MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21
  7060           MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21
  7061           MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21
  7062           MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21
  7063           MOVE  1 TO K-AMNIST21
  7064           MOVE 12 TO L-AMNIST21
  7065           PERFORM UNTIL L-AMNIST21 = 0
  7066             MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO
  7067                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7068             ADD 1 TO K-AMNIST21
  7069             SUBTRACT 1 FROM L-AMNIST21
  7070           END-PERFORM
  7071           MOVE 12 TO L-AMNIST21
  7072           PERFORM UNTIL L-AMNIST21 = 0
  7073             MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO
  7074                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7075             ADD 1 TO K-AMNIST21
  7076             SUBTRACT 1 FROM L-AMNIST21
  7077           END-PERFORM
  7078           MOVE 12 TO L-AMNIST21
  7079           PERFORM UNTIL L-AMNIST21 = 0
  7080             MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO
  7081                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7082             ADD 1 TO K-AMNIST21
  7083             SUBTRACT 1 FROM L-AMNIST21
  7084           END-PERFORM
  7085           MOVE 12 TO L-AMNIST21
  7086           PERFORM UNTIL L-AMNIST21 = 0
  7087             MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO
  7088                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7089             ADD 1 TO K-AMNIST21
  7090             SUBTRACT 1 FROM L-AMNIST21
  7091           END-PERFORM
  7092           MOVE ZEROS TO SW-SALIR-VECT
  7093           PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL
  7094                   X-AMNIST21 >  48 OR
  7095                   SW-SALIR-VECT > ZEROS
  7096             IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 123
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7097                                             "3" OR "4"
  7098                   IF X-AMNIST21 <= MESES-VEC-AMNIST21            CAV0003
  7099                      MOVE 1 TO SW-SALIR-VECT
  7100                   ELSE
  7101                        PERFORM 200870-APLICA-AMNISTIA            GJC0006
  7102                        MOVE 1 TO SW-SALIR-VECT                   GJC0004
  7103                   END-IF
  7104             END-IF
  7105           END-PERFORM
  7106           IF X-AMNIST21 > 48    *> CASOS EN QUE NO HAY MORA EN
  7107              PERFORM 200870-APLICA-AMNISTIA *>  EL VECTOR        GJC0006
  7108           END-IF
  7109          END-IF
  7110        END-IF
  7111       END-IF
  7112       MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.
  7113
  7114******************************************************************
  7115*200870-APLICA-AMNISTIA.                                         *
  7116* RUTINA ENCARGADA DE APLICAR LA AMNISTIA AL REGISTRO            *
  7117******************************************************************
  7118 200870-APLICA-AMNISTIA.                                          GJC0006
  7119     INITIALIZE VECTOR1-AMNIST21 VECTOR2-AMNIST21
  7120     MOVE 0 TO NUM-MORAS30-ABD07
  7121     MOVE 0 TO MORA-MAXIMA-ABD07
  7122     MOVE 0 TO FECHA-MORA-MAXIMA-ABD07
  7123     IF ADJETIVO1-ABD07 > 1
  7124        MOVE 0        TO ADJETIVO1-ABD07
  7125     END-IF
  7126     IF ADJETIVO2-ABD07 > 1
  7127            MOVE 0        TO ADJETIVO2-ABD07
  7128     END-IF
  7129     IF ADJETIVO3-ABD07 > 1
  7130            MOVE 0        TO ADJETIVO3-ABD07
  7131     END-IF
  7132     IF NOV-REPORT-ABD07 = 46
  7133        IF COD-CTA-ABD07 = 02
  7134           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7135        ELSE
  7136           MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7137        END-IF
  7138     ELSE
  7139        IF NOV-REPORT-ABD07 = 03
  7140           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7141        ELSE
  7142           IF NOV-REPORT-ABD07 = 09 OR 10 OR 11 OR 12
  7143              MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7144           ELSE
  7145              IF NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16
  7146                 MOVE 01 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7147              END-IF
  7148           END-IF
  7149        END-IF
  7150     END-IF
  7151     MOVE ESTADO-MES-ABD07   TO VECTOR1-AMNIST21
  7152     MOVE VECTOR-2-ABD07     TO VECTOR2-AMNIST21
  7153     MOVE VECTOR-HIS-3-ABD07 TO VECTOR3-AMNIST21
  7154     MOVE VECTOR-HIS-4-ABD07 TO VECTOR4-AMNIST21
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 124
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7155     INSPECT VECTOR1-AMNIST21 REPLACING ALL "1" BY "8"
  7156     INSPECT VECTOR1-AMNIST21 REPLACING ALL "2" BY "8"
  7157     INSPECT VECTOR1-AMNIST21 REPLACING ALL "3" BY "8"
  7158     INSPECT VECTOR1-AMNIST21 REPLACING ALL "4" BY "8"
  7159     INSPECT VECTOR2-AMNIST21 REPLACING ALL "1" BY "8"
  7160     INSPECT VECTOR2-AMNIST21 REPLACING ALL "2" BY "8"
  7161     INSPECT VECTOR2-AMNIST21 REPLACING ALL "3" BY "8"
  7162     INSPECT VECTOR2-AMNIST21 REPLACING ALL "4" BY "8"
  7163     INSPECT VECTOR3-AMNIST21 REPLACING ALL "1" BY "8"
  7164     INSPECT VECTOR3-AMNIST21 REPLACING ALL "2" BY "8"
  7165     INSPECT VECTOR3-AMNIST21 REPLACING ALL "3" BY "8"
  7166     INSPECT VECTOR3-AMNIST21 REPLACING ALL "4" BY "8"
  7167     INSPECT VECTOR4-AMNIST21 REPLACING ALL "1" BY "8"
  7168     INSPECT VECTOR4-AMNIST21 REPLACING ALL "2" BY "8"
  7169     INSPECT VECTOR4-AMNIST21 REPLACING ALL "3" BY "8"
  7170     INSPECT VECTOR4-AMNIST21 REPLACING ALL "4" BY "8"
  7171     MOVE VECTOR1-AMNIST21 TO ESTADO-MES-ABD07
  7172     MOVE VECTOR2-AMNIST21 TO VECTOR-2-ABD07.
  7173     MOVE VECTOR3-AMNIST21 TO VECTOR-HIS-3-ABD07
  7174     MOVE VECTOR4-AMNIST21 TO VECTOR-HIS-4-ABD07.
  7175*****************************************************************
  7176*200900-APLICAR-ART13-REGISTRO.                                         *
  7177* RUTINA ENCARGADA DE APLICAR PERDON CON 8 AL DOBLE DEL TIEMPO DE*
  7178* LA MORA (ARTICULO 13 DE LA LEY). PARA PERDONAR SE APOYA EN EL
  7179* VECTOR DE MORAS DE TODA LA PERSONA
  7180******************************************************************
  7181 200900-APLICAR-ART13-REGISTRO.                                   GJC0006
  7182     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006
  7183     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006
  7184     MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                      GJC0006
  7185     IF IND-BLOQUEO-ABD07 = 0                                     GJC0006
  7186        READ SUSCRIPTOR  IGNORE LOCK                              GJC0006
  7187           INVALID KEY MOVE 0 TO ESTADO-ABD02                     GJC0006
  7188       END-READ                                                   GJC0006
  7189       IF ESTADO-ABD02 = 1                                        GJC0006
  7190* PRIMERO SE REVISA SI ES DUDOSO RECAUDO O CAN MM CON MORA EN 0   GJC0006
  7191* SE CAMBIA EL ESTADO SIN MÁS ANALISIS                            GJC0006
  7192          IF (NOV-REPORT-ABD07 = 46 OR NOV-REPORT-ABD07 = 03) AND GJC0006
  7193             (MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0)  GJC0006
  7194            IF NOV-REPORT-ABD07 = 03                              GJC0006
  7195               MOVE 06 TO NOV-REPORT-ABD07                        GJC0006
  7196                         NOV-REPORT-R-ABD07                       GJC0006
  7197            ELSE                                                  GJC0006
  7198              IF COD-CTA-ABD07 = 02                               GJC0006
  7199                 MOVE 06 TO NOV-REPORT-ABD07                      GJC0006
  7200                            NOV-REPORT-R-ABD07                    GJC0006
  7201              ELSE                                                GJC0006
  7202                 MOVE 08 TO NOV-REPORT-ABD07                      GJC0006
  7203                            NOV-REPORT-R-ABD07                    GJC0006
  7204              END-IF                                              GJC0006
  7205          ELSE                                                    GJC0006
  7206             IF MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0 GJC0006
  7207                MOVE 1 TO X-AMNIST21                              GJC0006
  7208             ELSE                                                 GJC0006
  7209                IF ESTADO-OBLIG-ABD07 <> 10                       GJC0011
  7210                   PERFORM 200930-ART13-CTA-CON-MORA              GJC0011
  7211                ELSE                                              GJC0011
  7212                   MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21     GJC0011
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 125
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7213                   MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21     GJC0011
  7214                   MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21     GJC0011
  7215                   MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21     GJC0011
  7216                   PERFORM VARYING L-AMNIST21 FROM 1 BY 1         GJC0011
  7217                        UNTIL L-AMNIST21 >12                      GJC0011
  7218                     IF (VECT1-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7219                                               4 AND <> 0) OR     GJC0011
  7220                        (VECT2-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7221                                               4 AND <> 0) OR     GJC0011
  7222                        (VECT3-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7223                                               4 AND <> 0) OR     GJC0011
  7224                        (VECT4-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7225                                               4 AND <> 0)        GJC0011
  7226                        MOVE 100 TO L-AMNIST21                    GJC0011
  7227                    END-IF                                        GJC0011
  7228                   END-PERFORM                                    GJC0011
  7229                   IF L-AMNIST21 >= 100                           GJC0011
  7230                      PERFORM 200930-ART13-CTA-CON-MORA           GJC0011
  7231                   END-IF                                         GJC0011
  7232                END-IF                                            GJC0011
  7233             END-IF                                               GJC0006
  7234          END-IF                                                  GJC0006
  7235     END-IF                                                       GJC0006
  7236* SE RECUPERA EL REGISTRO DE SUSCRIPTOR QUE ESTABA LEIDO          GJC0006
  7237     MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.           GJC0006
  7238*****************************************************************
  7239*200930-APLICAR-ART13-CTA-CON-MORA.                               *
  7240* A ESTA RUTINA SOLO LLEGAN CUENTAS QUE HAYAN TENIDO MORA.SU OBJE-*
  7241* TIVO ES VERIFICAR QUE LAPSOS DE MORA SE PUEDEN PERDONAR Y QUE   *
  7242* LAPSOS NO
  7243******************************************************************
  7244 200930-ART13-CTA-CON-MORA.                                       GJC0006
  7245     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006
  7246     INITIALIZE K-AMNIST21 L-AMNIST21 Z-AMNIST21 X-AMNIST21       GJC0006
  7247                 M-AMNIST21                                       GJC0006
  7248                 IND-APLICO-CAD-AMNIST21                          GJC0012
  7250     INITIALIZE VECTOR-100-CTA-AMNIST21 REPLACING                 GJC0006
  7251             ALPHANUMERIC DATA BY CINCOS-AMNIST21(1:100)          GJC0006
  7252     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006
  7253     MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21             GJC0006
  7254     MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21             GJC0006
  7255     MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21             GJC0006
  7256     MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21             GJC0006
  7257     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0006
  7258          MOR-EST-CTA-AMNIST21                                    GJC0006
  7259*    PRIMERO SE LLENA EL VECTOR DE LA CUENTA EN 100 POSICIONES    GJC0006
  7260     IF MESES-NOV-AMNIST21 < 52                                   GJC0006
  7261        COMPUTE POSICION-INI-AMNIST21 = 52 - MESES-NOV-AMNIST21   GJC0006
  7262        MOVE POSICION-INI-AMNIST21 TO K-AMNIST21                  GJC0006
  7263        MOVE VECTOR-TOT-CTA-AMNIST21 TO                           GJC0006
  7264             VECTOR-100-CTA-AMNIST21(K-AMNIST21:49)               GJC0006
  7265             COMPUTE Z-AMNIST21 = K-AMNIST21 + 49                 GJC0006
  7266     ELSE                                                         GJC0006
  7267        PERFORM 200933-CADUCAR-MORAS                              GJC0012
  7268        MOVE  1 TO POSICION-INI-AMNIST21                          GJC0006
  7269        IF MESES-NOV-AMNIST21 <  100    *> <=                     GJC0006
  7270           COMPUTE L-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006
  7271              COMPUTE K-AMNIST21 = 50 - L-AMNIST21    *>49        GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 126
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7272            MOVE VECTOR-TOT-CTA-AMNIST21(K-AMNIST21:L-AMNIST21) TOGJC0006
  7273                VECTOR-100-CTA-AMNIST21(1:L-AMNIST21)             GJC0006
  7274              COMPUTE Z-AMNIST21 = L-AMNIST21 + 1                 GJC0006
  7275        ELSE                                                      GJC0006
  7276           MOVE 1 TO Z-AMNIST21 K-AMNIST21                        GJC0006
  7277        END-IF                                                    GJC0006
  7278     END-IF                                                       GJC0006
  7279* SI EL ESTADO ACTUAL DE LA CUENTA ES MOROSO SE RELLENA DE MORAS  GJC0009
  7280* HASTA LA POSICION 100                                           GJC0009
  7281     IF (NOV-REPORT-ABD07 > 12 AND < 46) OR                       GJC0009
  7282        NOV-REPORT-ABD07 = 47                                     GJC0009
  7283        PERFORM UNTIL Z-AMNIST21 > 100                            GJC0006
  7284           IF NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) <> 5       GJC0008
  7285              MOVE 1 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)          GJC0009
  7286           ELSE                                                   GJC0008
  7287             MOVE 2 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)           GJC0008
  7288           END-IF                                                 GJC0008
  7289          ADD 1 TO Z-AMNIST21                                     GJC0006
  7290        END-PERFORM                                               GJC0006
  7291     ELSE
  7292        MOVE 1 TO  VEC-100-CTA-AMNIST21(100)
  7293     END-IF                                                       GJC0006
  7294* SE REEEMPLAZAN EN EL VECTOR LAS POSICONES QUE NO SON MORA POR   GJC0009
  7295* AL DIA                                                          GJC0009
  7296     MOVE 1 TO VEC-100-CTA-AMNIST21(101)                          GJC0006
  7297     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "0" BY "5"    GJC0006
  7298     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "6" BY "5"    GJC0006
  7299     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "7" BY "5"    GJC0006
  7300     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "8" BY "5"    GJC0006
  7301     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "9" BY "5"    GJC0006
  7302* SE INICIA EL RECORRIDO PARA HALLAR LOS LAPOS DE MORA Y LA MORA  GJC0006
  7303* CORRIDA                                                         GJC0006
  7304     MOVE 0 TO LAPSO-AMNIST21                                     GJC0006
  7305     MOVE 0 TO MAYOR-LAPSO-AMNIST21 SALIR-AMNIST21                GJC0006
  7306               ESTOY-MOROSO-AMNIST21 MESES-MORAS-AMNIST21         GJC0006
  7307     PERFORM VARYING Z-AMNIST21 FROM 1 BY 1 UNTIL Z-AMNIST21 > 30 GJC0006
  7308             MOVE ZEROS TO VECTOR-LAPSOS(Z-AMNIST21)              GJC0006
  7309     END-PERFORM                                                  GJC0006
  7310     PERFORM UNTIL K-AMNIST21 > 101 OR SALIR-AMNIST21 = 1         GJC0006
  7311        IF ESTOY-MOROSO-AMNIST21 = 1                              GJC0006
  7312           IF VEC-100-CTA-AMNIST21(K-AMNIST21) <> 5               GJC0006
  7313              ADD 1 TO MESES-MORAS-AMNIST21                       GJC0006
  7314           ELSE                                                   GJC0006
  7315              MOVE 0 TO ESTOY-MOROSO-AMNIST21                     GJC0006
  7316             MOVE K-AMNIST21 TO L-AMNIST21                        GJC0006
  7317           END-IF                                                 GJC0006
  7318        ELSE                                                      GJC0006
  7319           IF VEC-100-CTA-AMNIST21(K-AMNIST21) > 0 AND < 5        GJC0006
  7320              IF MESES-MORAS-AMNIST21 > 0                         GJC0006
  7321                 MOVE MESES-MORAS-AMNIST21 TO                     GJC0006
  7322                 LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)              GJC0006
  7323                 PERFORM 200935-VER-SI-DOBLE-MORA                 GJC0006
  7324              END-IF                                              GJC0006
  7325              ADD 1 TO LAPSO-AMNIST21                             GJC0006
  7326              MOVE 1 TO MESES-MORAS-AMNIST21                      GJC0006
  7327              MOVE 1 TO ESTOY-MOROSO-AMNIST21                     GJC0006
  7328              MOVE K-AMNIST21 TO                                  GJC0006
  7329                   INI-GRUPO-AMNIST21(LAPSO-AMNIST21)             GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 127
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7330              MOVE 0 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006
  7331           END-IF                                                 GJC0006
  7332        END-IF                                                    GJC0006
  7333        ADD 1 TO K-AMNIST21                                       GJC0006
  7334     END-PERFORM                                                  GJC0006
  7335     COMPUTE L-AMNIST21 = LAPSO-AMNIST21 + 1                      GJC0006
  7336     IF CTA-PERDONADA-AMNIST21 = 1 OR IND-APLICO-CAD-AMNIST21 = 1 GJC0012
  7337        PERFORM 200940-PERDONAR-VECTOR-CTA                        GJC0006
  7338        MOVE VECTOR-4-CTA-AMNIST21 TO VECTOR-HIS-4-ABD07          GJC0006
  7339        MOVE VECTOR-3-CTA-AMNIST21 TO VECTOR-HIS-3-ABD07          GJC0006
  7340        MOVE VECTOR-2-CTA-AMNIST21 TO VECTOR-HIS-2-ABD07          GJC0006
  7341        MOVE VECTOR-1-CTA-AMNIST21 TO VECTOR-HIS-1-ABD07          GJC0006
  7342        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0006
  7343        PERFORM 555000-MANEJO-RECUP-Y-MM                          GJC0007
  7344     END-IF.                                                      GJC0006
  7345
  7346******************************************************************
  7347*200933-CADUCAR-MORAS                                            *
  7348* A LAS CUENTAS CUYO VECTOR DE COMPORTAMIENTO NO CABE EN LAS 100
  7349* POSICIONES DEL VECTOR EN QUE SE CALCULA LA APLICACION DEL AR-  *
  7350* TICULO 13 SE APLICA LA CADUCIDAD SOBRE LO QUE LLEVA MAS DE
  7351* 48 MESES
  7352******************************************************************
  7353 200933-CADUCAR-MORAS.                                            GJC0012
  7354     IF NOV-REPORT-ABD07 < 13 OR  = 46                            GJC0012
  7355      PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 48GJC0012
  7356       IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5            GJC0012
  7357          MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)              GJC0012
  7358          IF IND-APLICO-CAD-AMNIST21 = 0                          GJC0012
  7359             MOVE 1 TO IND-APLICO-CAD-AMNIST21                    GJC0012
  7360          END-IF                                                  GJC0012
  7361       END-IF                                                     GJC0012
  7362      END-PERFORM                                                 GJC0012
  7363     END-IF.                                                      GJC0012
  7364
  7365******************************************************************
  7366*200935-VER-SI-DOBLE-MORA                                          *
  7367* VALIDA SI SE PUEDE PERDONAR O NO EL PERIODO DE GRACIA QUE SE
  7368*ESTÁ ANALIZANDO*
  7369******************************************************************
  7370 200935-VER-SI-DOBLE-MORA.                                        GJC0006
  7371     IF MESES-MORAS-AMNIST21 >  MAYOR-LAPSO-AMNIST21              GJC0006
  7372        COMPUTE X-AMNIST21 = (MESES-MORAS-AMNIST21 * 2) *> OJO + 1GJC0006
  7373     ELSE                                                         GJC0006
  7374        COMPUTE X-AMNIST21 = (MAYOR-LAPSO-AMNIST21 * 2) *> OJO + 1GJC0006
  7375     END-IF                                                       GJC0006
  7376     IF X-AMNIST21 > 48                                           GJC0011
  7377       MOVE 48 TO X-AMNIST21                                      GJC0011
  7378     END-IF                                                       GJC0011
  7379     IF X-AMNIST21 <= 101 - L-AMNIST21                            GJC0006
  7380        MOVE 0 TO M-AMNIST21                                      GJC0006
  7381        INSPECT VECTOR-100-CTA-AMNIST21(L-AMNIST21:X-AMNIST21)    GJC0006
  7382             TALLYING M-AMNIST21 FOR ALL                          GJC0006
  7383                      CINCOS-AMNIST21(1:X-AMNIST21)               GJC0006
  7384        IF M-AMNIST21 > 0                                         GJC0006
  7385* LAS 2 SIGUIENTES INSTRUCCIONES Y EL ELSE DEL IF SE DEBEN DESCO- GJC0009
  7386* MENTAREAR SI SE DECIDE APLICAR ARTICULO 13 POR PERSONA CUENTA   GJC0009
  7387*PER       COMPUTE MESES-AMNIST21 = L-AMNIST21 + X-AMNIST21 - 1   GJC0009
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 128
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7388*PER       IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21) = 5         GJC0009
  7389              MOVE 1 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006
  7390              MOVE 1 TO CTA-PERDONADA-AMNIST21                    GJC0006
  7391              IF LAPSO-AMNIST21 > 1                               GJC0006
  7392                 COMPUTE Z-AMNIST21 = LAPSO-AMNIST21 - 1          GJC0006
  7393                 PERFORM UNTIL Z-AMNIST21 = 0                     GJC0006
  7394                    IF PERDON-GRUPO-AMNIST21(Z-AMNIST21) = 0      GJC0006
  7395                       MOVE 1 TO                                  GJC0006
  7396                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)        GJC0006
  7397                       COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1        GJC0006
  7398                    ELSE                                          GJC0006
  7399                       MOVE 0 TO Z-AMNIST21                       GJC0006
  7400                    END-IF                                        GJC0006
  7401                 END-PERFORM                                      GJC0006
  7402                 MOVE 0 TO MAYOR-LAPSO-AMNIST21                   GJC0006
  7403              END-IF                                              GJC0006
  7404*PER       ELSE                                                   GJC0009
  7405*PER          COMPUTE X-AMNIST21 =  X-AMNIST21 + L-AMNIST21       GJC0009
  7406*PER          ADD 1 TO  MESES-AMNIST21                            GJC0009
  7407*PER          PERFORM UNTIL X-AMNIST21 > 100 OR                   GJC0009
  7408*PER               PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)= 1       GJC0009
  7409*PER             IF VEC-100-CTA-AMNIST21(X-AMNIST21) = "5" OR "2" GJC0009
  7410*PER                IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21)    GJC0009
  7411*PER                      = "5"                                   GJC0009
  7412*PER                   MOVE 1 TO                                  GJC0009
  7413*PER                         PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)GJC0009
  7414*PER                   MOVE 1 TO CTA-PERDONADA-AMNIST21           GJC0009
  7415*PER                   IF LAPSO-AMNIST21 > 1                      GJC0009
  7416*PER                      MOVE LAPSO-AMNIST21 TO Z-AMNIST21       GJC0009
  7417*PER                      PERFORM UNTIL Z-AMNIST21 = 0            GJC0009
  7418*PER                         MOVE 1 TO                            GJC0009
  7419*PER                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)    GJC0009
  7420*PER                         COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1  GJC0009
  7421*PER                      END-PERFORM                             GJC0009
  7422*PER                      MOVE 0 TO MAYOR-LAPSO-AMNIST21          GJC0009
  7423*PER                   END-IF                                     GJC0009
  7424*PER                END-IF                                        GJC0009
  7425*PER             ELSE                                             GJC0009
  7426*PER               MOVE 105 TO X-AMNIST21                         GJC0009
  7427*PER             END-IF                                           GJC0009
  7428*PER             ADD 1 TO X-AMNIST21                              GJC0009
  7429*PER             ADD 1 TO MESES-AMNIST21                          GJC0009
  7430*PER          END-PERFORM                                         GJC0009
  7431*PER       END-IF                                                 GJC0009
  7432        ELSE                                                      GJC0006
  7433          IF MAYOR-LAPSO-AMNIST21 <                               GJC0006
  7434             LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)                  GJC0006
  7435              MOVE LONG-GRUPO-AMNIST21(LAPSO-AMNIST21) TO         GJC0006
  7436                                    MAYOR-LAPSO-AMNIST21          GJC0006
  7437          END-IF                                                  GJC0006
  7438        END-IF                                                    GJC0006
  7439     ELSE
  7440        MOVE 1 TO SALIR-AMNIST21                                  GJC0006
  7441     END-IF.                                                      GJC0006
  7442
  7443******************************************************************
  7444*200940-PERDONAR-VECTOR-CTA.                                     *
  7445* SE HACE EL PERDOS SOBRE CADA UNO DE LOS LAPSOS DE MORA SOBRE   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 129
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7446* LOS QUE LA CUENTA TIENE DERECHO A PERDON
  7447******************************************************************
  7448 200940-PERDONAR-VECTOR-CTA.                                      GJC0006
  7449     PERFORM VARYING LAPSO-AMNIST21 FROM 1 BY 1 UNTIL             GJC0006
  7450        LAPSO-AMNIST21 > 30                                       GJC0006
  7451       IF PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21) = 1               GJC0006
  7452          COMPUTE Z-AMNIST21 = INI-GRUPO-AMNIST21(LAPSO-AMNIST21) GJC0006
  7453                             - POSICION-INI-AMNIST21 + 1          GJC0006
  7454          MOVE 0 TO K-AMNIST21                                    GJC0006
  7455          PERFORM VARYING L-AMNIST21 FROM                         GJC0006
  7456            Z-AMNIST21 BY 1 UNTIL                                 GJC0006
  7457                K-AMNIST21 = LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)  GJC0006
  7458            IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5       GJC0006
  7459               MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)         GJC0006
  7460            END-IF                                                GJC0006
  7461            ADD 1 TO K-AMNIST21                                   GJC0006
  7462          END-PERFORM                                             GJC0006
  7463       ELSE                                                       GJC0006
  7464          MOVE 51 TO LAPSO-AMNIST21                               GJC0006
  7465       END-IF                                                     GJC0006
  7466     END-PERFORM.                                                 GJC0006
  7467
  7468******************************************************************
  7469*50000-RECONSTRUCCION-HISTORIA.
  7470*VOLTEA LOS VECTORES Y LLAMA A LAS RUTINAS QUE RECALCULAN EL ESTADO
  7471*DEJANDO FINALMENTE LOS VECTORES COMO DEBEN QUEDAR
  7472******************************************************************
  7473 500000-RECONSTRUCCION-HISTORIA.                                  GJC0006
  7474     MOVE 0 TO MES-MORA-MAX-AMNIST21  MES-MORA-MAX-48-AMNIST21.   GJC0006
  7475     INITIALIZE FEC-MORMAX-AMNIST21 FEC-MORMAX-48-AMNIST21.       GJC0006
  7476     MOVE NOV-REPORT-ABD07 TO ESTADO-AMNIST21 ESTADO-FIN-AMNIST21 GJC0006
  7477     MOVE FEC-NOVEDAD-ABD07 TO  FEC-MM-AA-AMNIST21                GJC0006
  7478     IF FEC-MM-AA-AMNIST21 (3:2) > 60                             GJC0006
  7479        MOVE 19 TO SIGLO-AMNIST21                                 GJC0006
  7480     ELSE                                                         GJC0006
  7481        MOVE 20 TO SIGLO-AMNIST21                                 GJC0006
  7482     END-IF                                                       GJC0006
  7483     MOVE FEC-MM-AA-AMNIST21 (1:2)  TO MES-AMNIST21               GJC0006
  7484     MOVE FEC-MM-AA-AMNIST21 (3:2)  TO ANO-AMNIST21               GJC0006
  7485     MOVE FECHA-AMNIST21  TO FEC-INI-MOR-AMNIST21.                GJC0006
  7486     PERFORM 500500-NUEVA-NOVEDAD                                 GJC0006
  7487     PERFORM 500600-CALCULO-FECHAMX                               GJC0006
  7488*    IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007
  7489*       (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007
  7490*       IF ESTADO-FIN-AMNIST21 = 03                               GJC0007
  7491*          MOVE 06 TO NOV-REPORT-ABD07                            GJC0007
  7492*                     NOV-REPORT-R-ABD07                          GJC0007
  7493*       ELSE                                                      GJC0007
  7494*          IF COD-CTA-ABD07 = 02                                  GJC0007
  7495*             MOVE 06 TO NOV-REPORT-ABD07                         GJC0007
  7496*                     NOV-REPORT-R-ABD07                          GJC0007
  7497*          ELSE                                                   GJC0007
  7498*             MOVE 08 TO NOV-REPORT-ABD07                         GJC0007
  7499*                        NOV-REPORT-R-ABD07                       GJC0007
  7500*          END-IF                                                 GJC0007
  7501*     ELSE *> LINEAS CONVERTIDAS EN RUT 555000-MANEJO-RECUP-Y-MM  GJC0007
  7502*       MOVE ESTADO-FIN-AMNIST21 TO NOV-REPORT-ABD07              GJC0012
  7503        MOVE ESTADO-FIN48-AMNIST21 TO NOV-REPORT-R-ABD07          GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 130
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7504                                      NOV-REPORT-ABD07            GJC0012
  7505*     END-IF                                                      GJC0007
  7506*    MOVE FEC-MORMAX-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07          GJC0006
  7507*    MOVE NUM-MOR30-AMNIST21 TO NUM-MORAS30-ABD07                 GJC0006
  7508     MOVE FEC-MORMAX-48-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07       GJC0006
  7509*    MOVE MORMAX-AMNIST21 TO MORA-MAXIMA-ABD07.                   GJC0006
  7510     MOVE MORMAX48-AMNIST21 TO MORA-MAXIMA-R-ABD07                GJC0006
  7511                               MORA-MAXIMA-ABD07.                 GJC0006
  7512     MOVE NUM-MOR30-48-AMNIST21 TO NUM-MORAS30-ABD07.             GJC0006
  7513  500500-NUEVA-NOVEDAD.
  7514******************************************************************
  7515* 50500-NUEVA-NOVEDAD.
  7516* CON EL VECTOR DE COMPORTAMIENTO PERDONADO Y SEGÚN LA NOVEDAD
  7517* ACTUAL, CALCULA CON LA MATRIZ DE RECONSTRUCCIÓN HISTÓRICA
  7518* LA NUEVA NOVEDAD DE LA OBLIGACIÓN
  7519******************************************************************
  7520     MOVE 0 TO NUM-MOR30-AMNIST21  NUM-MOR30-48-AMNIST21          GJC0006
  7521     MOVE 0 TO MORMAX-AMNIST21 MORMAX48-AMNIST21                  GJC0006
  7522     MOVE 0 TO FEC-MORMAX-AMNIST21   FEC-MORMAX-48-AMNIST21       GJC0006
  7523     MOVE 01 TO ESTADO-INI-AMNIST21 ESTADO-INI48-AMNIST21         GJC0006
  7524     PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 49 GJC0006
  7525      MOVE VEC-TOT-CTA-AMNIST21(L-AMNIST21) TO K-AMNIST21         GJC0006
  7526      IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX48-AMNIST21        GJC0006
  7527      COMPUTE MES-MORA-MAX-48-AMNIST21 = (49 - L-AMNIST21) + 1    GJC0006
  7528         MOVE K-AMNIST21 TO MORMAX48-AMNIST21                     GJC0006
  7529      END-IF                                                      GJC0006
  7530      IF K-AMNIST21 = 1                                           GJC0006
  7531         ADD 1 TO NUM-MOR30-48-AMNIST21                           GJC0006
  7532      END-IF                                                      GJC0006
  7533      IF L-AMNIST21 > 24                                          GJC0006
  7534       IF K-AMNIST21 = 1                                          GJC0006
  7535          ADD 1 TO NUM-MOR30-AMNIST21                             GJC0006
  7536       END-IF                                                     GJC0006
  7537       IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX-AMNIST21         GJC0006
  7538          COMPUTE  MES-MORA-MAX-AMNIST21 = (49 - L-AMNIST21) + 1  GJC0006
  7539          MOVE K-AMNIST21 TO MORMAX-AMNIST21                      GJC0006
  7540       END-IF                                                     GJC0006
  7541      END-IF                                                      GJC0006
  7542       IF L-AMNIST21 = 49                                         GJC0006
  7543          IF (ESTADO-AMNIST21 > 12 AND < 42) OR                   GJC0006
  7544             ESTADO-AMNIST21 = 01                                 GJC0006
  7545             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006
  7546             ESTADO-FIN-AMNIST21                                  GJC0006
  7547             MOVE                                                 GJC0006
  7548             NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,             GJC0006
  7549                             ESTADO-FIN-AMNIST21)                 GJC0006
  7550                           TO ESTADO-FIN-AMNIST21                 GJC0006
  7551             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006
  7552                  ESTADO-FIN48-AMNIST21                           GJC0006
  7553             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,      GJC0006
  7554                  ESTADO-FIN48-AMNIST21) TO ESTADO-FIN48-AMNIST21 GJC0006
  7555          ELSE                                                    GJC0006
  7556             IF ESTADO-AMNIST21 > 07 AND < 13                     GJC0006
  7557                COMPUTE ESTADO-FIN-AMNIST21 =                     GJC0006
  7558                        08 + MORMAX-AMNIST21                      GJC0006
  7559                COMPUTE ESTADO-FIN48-AMNIST21 =                   GJC0006
  7560                        08 + MORMAX48-AMNIST21                    GJC0006
  7561             ELSE                                                 GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 131
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7562                MOVE ESTADO-AMNIST21 TO ESTADO-FIN-AMNIST21       GJC0006
  7563                MOVE ESTADO-AMNIST21 TO ESTADO-FIN48-AMNIST21     GJC0006
  7564             END-IF                                               GJC0006
  7565          END-IF                                                  GJC0006
  7566       ELSE                                                       GJC0006
  7567         IF K-AMNIST21 = 7 OR 8                                   GJC0006
  7568            MOVE 5 TO K-AMNIST21                                  GJC0006
  7569         END-IF                                                   GJC0006
  7570         IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                     GJC0006
  7571            MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,       GJC0006
  7572                                       K-AMNIST21) TO             GJC0006
  7573                 ESTADO-INI48-AMNIST21                            GJC0006
  7574         END-IF                                                   GJC0006
  7575         IF L-AMNIST21 > 24                                       GJC0006
  7576          IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                    GJC0006
  7577             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,        GJC0006
  7578                 K-AMNIST21) TO ESTADO-INI-AMNIST21               GJC0006
  7579          END-IF                                                  GJC0006
  7580         END-IF                                                   GJC0006
  7581       END-IF                                                     GJC0006
  7582     END-PERFORM.                                                 GJC0006
  7583
  7584******************************************************************
  7585*500600-CALCULO-FECHAMX.
  7586* CON EL VECTOR YA PERDONADO, CALCULA LA NUEVA FECHA DE MORA
  7587* MÁXIMA
  7588******************************************************************
  7589 500600-CALCULO-FECHAMX.                                          GJC0006
  7590     IF MES-MORA-MAX-AMNIST21 > 0                                 GJC0006
  7591        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0006
  7592        MOVE 1 TO L-AMNIST21                                      GJC0006
  7593        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21=                GJC0006
  7594                MES-MORA-MAX-AMNIST21                             GJC0006
  7595**SE DEBE CONTROLAR SI L-AMNIST21SE PASA de 25  ******************GJC0006
  7596        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006
  7597        MOVE MES-AMNIST21   TO FEC-MM-AAAA-AMNIST21 (1:2)         GJC0006
  7598        MOVE FEC-MM-AAAA-AMNIST21  TO FEC-MORMAX-AMNIST21         GJC0006
  7599     END-IF.                                                      GJC0006
  7600     IF MES-MORA-MAX-48-AMNIST21 > 0                              GJC0006
  7601        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0010
  7602        MOVE 1 TO L-AMNIST21                                      GJC0006
  7603        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21 =               GJC0006
  7604                                          MES-MORA-MAX-48-AMNIST21GJC0006
  7605        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006
  7606        MOVE MES-AMNIST21  TO FEC-MM-AAAA-AMNIST21 (1:2)          GJC0006
  7607        MOVE FEC-MM-AAAA-AMNIST21 TO FEC-MORMAX-48-AMNIST21       GJC0006
  7608     END-IF.                                                      GJC0006
  7609 555000-MANEJO-RECUP-Y-MM.                                        GJC0007
  7610******************************************************************
  7611*555000-MANEJO-RECUP-Y-MM
  7612* SOLO SE DEBE INVOCAR CUANDO UNA CUANTA ES PERDONADA Y SIRVE PARA
  7613* DEJAR UNA CUENTA QUE FUE RECUPERADA O CANCELADA POR MAL MANEJO
  7614* EN PAGO VOLUNTARIO O CANCELADA VOL SI NO QUEDARON MORAS
  7615******************************************************************
  7616     IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007
  7617        (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007
  7618        IF ESTADO-FIN-AMNIST21 = 03                               GJC0007
  7619           MOVE 06 TO NOV-REPORT-ABD07                            GJC0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 132
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7620                      NOV-REPORT-R-ABD07                          GJC0007
  7621        ELSE                                                      GJC0007
  7622           IF COD-CTA-ABD07 = 02                                  GJC0007
  7623              MOVE 06 TO NOV-REPORT-ABD07                         GJC0007
  7624                      NOV-REPORT-R-ABD07                          GJC0007
  7625           ELSE                                                   GJC0007
  7626              MOVE 08 TO NOV-REPORT-ABD07                         GJC0007
  7627                         NOV-REPORT-R-ABD07                       GJC0007
  7628           END-IF                                                 GJC0007
  7629        END-IF                                                    GJC0007
  7630     END-IF.                                                      GJC0007
  7631********************************************************************
  7632*510000-ADDUNOTOI.
  7633* RETROCEDE UN MES EN EL TIEMPO TENIENDO EN CUENTA EL CAMBIO DE AÑO
  7634* Y SI LA INFORMACIÓN VALIDA DEL VECTOR HA TERMINADO, FINALIZA LA
  7635* REVISIÓN DE CADUCIDAD SOBRE EL VECTOR
  7636********************************************************************
  7637 510000-ADDUNOTOI.                                                GJC0006
  7638     ADD 1 TO L-AMNIST21                                          GJC0006
  7639     SUBTRACT 1 FROM MES-AMNIST21                                 GJC0006
  7640     IF MES-AMNIST21 = 0                                          GJC0006
  7641        MOVE 12 TO MES-AMNIST21                                   GJC0006
  7642        SUBTRACT 1 FROM ANO-T-AMNIST21                            GJC0006
  7643     END-IF.                                                      GJC0006
  7644
  7645******************************************************************
  7646*200950-CONVIERTE-FECHA                                          *
  7647* CONVIERTE FECHA DE FORMATO MMYY A YYYYMM                       *
  7648******************************************************************
  7649 200950-CONVIERTE-FECHA.
  7650     MOVE  MES-AUX-AMNIST21   TO  FMILENIO-MES-AMNIST21
  7651     MOVE  ANO-AUX-AMNIST21   TO  FMILENIO-ANIO-AMNIST21
  7652     IF ANO-AUX-AMNIST21   > 60
  7653        MOVE 19               TO  FMILENIO-SIGLO-AMNIST21
  7654     ELSE
  7655        MOVE 20               TO  FMILENIO-SIGLO-AMNIST21
  7656     END-IF
  7657     MOVE  FECHA-MILENIO-AMNIST21  TO  FEC-NOVEDAD-AMNIST21.
* 7658 COPY VALNOM.PROC.
  7659*VALNOM-PROC.v.0005
  7660******************************************************************
  7661* RUTINA CREADA PARA HACER LA VALIDACION DE NOMBRES CONTRA LOS
  7662* ARCHIVOS DE LA REGISTRADURIA, DIAN Y DAS, DEPENDIENDO DEL TIPO
  7663* DE IDENTIFICACION RECIBIDA.
  7664*    PARAMETROS
  7665*        BLOQUES-INPUT-VALNOM - NUMERO DE BLOQUES A VALIDAR
  7666*        NOMBRE-INPUT-VALNOM  - NOMBRE A VALIDAR
  7667*        NOMBOK-INPUT-VALNOM  - NOMBRE CORRECTO CON EL QUE SE
  7668*                               DEBE COMPARAR NOMBRE-INPUT-VALNOM
  7669*        TIP-ID-INPUT-VALNOM  - TIPO DE IDENTIFICACION A VALIDAR
  7670*    SALIDAS:
  7671*        MATCH-OK-OUT-VALNOM  - 0-NO HUBO       1-HUBO
  7672*******************************************************************
  7673* RMB0002   * VAL001: SE MEJORA LA VALIDACION DE NOMBRES EN PERSONAS
  7674* R.MARTINEZ* JURIDICAS
  7675* DIC.2002  *
  7676*******************************************************************
  7677* GJC0003    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 133
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7678* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES
  7679* MARZO/2003 * PARA CEDULAS, EL COMODIN QUE USUALMENTE CORRESPONDE A LA N
  7680*            * SOLO SE COMPARA CONTRA N O CONTRA BLANCOS
  7681*************************************************************************
  7682* GJC0004    * VALME1 :CON EL FIN DE AFINAR AUN MAS EL PROCESO DE VALIDA-
  7683* R.MARTINEZ * CION DE NOMBRES, EN EL MATCH A PROXIMADO DE PERSONAS NATU-
  7684* G.JIMENEZ  * RALES SE CAMBIA EL CALCULO FINAL PARA DETERMINAR SI UN BLO-
  7685* MARZO/2003 * QUE ES O NO VALIDO. PARA QUE UN NOMBRE QUE VENGA NUMERICO
  7686*            * NO SE CONVIERTA EN COMODIN, EN LAS SUSTITUCIONES POR *
  7687*            * SE VALIDA QUE EL CONTENIDO NO SEA NUMERICO.
  7688*************************************************************************
  7689* GJC0005    * VLNM01: LOS PROGRAMAS ABORTAN CUANDO ALGUNO DE LOS
  7690* G.JIMENEZ  *         PARAMETROS DE UN SUBSTRING QUEDA EN 0 O EN
  7691* NOV/2005   *         UN NUMERO MENOR QUE 0. EJ: NOMBRE(I:J) DONDE I O
  7692*            *         J ES 0.
  7693*************************************************************************
  7694 10000-MATCH-NOMBRES-VALNOM.
  7695******************************************************************
  7696*10000-MATCH-NOMBRE-VALNOM.
  7697* SE BUSCA DETERMINAR SI EL NOMBRE DE LA PERSONA CONSULTADA HACE
  7698*       CON EL NOMBRE ENVIADO EN LA CONSULTA.
  7699******************************************************************
  7700     MOVE 0 TO MATCH-OK-OUT-VALNOM.
  7701     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  7702     IF TIP-ID-INPUT-VALNOM  = 2
  7703         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  7704           " S.A. " BY "      ",                                  RMB0002
  7705           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7706           " LIMITADA " BY "          ",                          RMB0002
  7707           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7708           " INVERSIONES " BY "             ",                    RMB0002
  7709           " EMPRESA " BY "         ",                            RMB0002
  7710           " CORPORACION " BY "             ",                    RMB0002
  7711           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7712           " S " BY "   ", " A " BY "   "                         RMB0002
  7713           " Y " BY "   "                                         GJC0003
  7714         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7715           " S.A. " BY "      ",                                  RMB0002
  7716           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7717           " LIMITADA " BY "          ",                          RMB0002
  7718           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7719           " INVERSIONES " BY "             ",                    RMB0002
  7720           " EMPRESA " BY "         ",                            RMB0002
  7721           " CORPORACION " BY "             ",                    RMB0002
  7722           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7723           " S " BY "   ", " A " BY "   "                         RMB0002
  7724           " Y " BY "   "                                         GJC0003
  7725         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
  7726                "." BY " ","-" BY " ",                            GJC0003
  7727                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7728                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7729         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
  7730                "." BY " ","-" BY " ",                            GJC0003
  7731                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7732                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7733         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
  7734     ELSE
  7735        INSPECT CADENA-VALNOM    REPLACING ALL
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 134
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7736                 "." BY " ","-" BY " ", "," BY " ",
  7737                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  7738                "Y" BY "G","H" BY "G","I" BY "G",
  7739                " DE " BY "    "," LA " BY "    ",
  7740                " DEL " BY "     "
  7741        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
  7742                 "." BY " ","-" BY " ", "," BY " ",
  7743                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      RMB0002
  7744                "Y" BY "G","H" BY "G","I" BY "G",                 RMB0002
  7745                " DE " BY "    "," LA " BY "    ",                RMB0002
  7746                " DEL " BY "     "                                RMB0002
  7747                PERFORM VARYING I-VALNOM FROM 1 BY 1
  7748                        UNTIL I-VALNOM >= 66
  7749                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  7750                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  7751                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  7752                  END-IF
  7753                END-PERFORM
  7754     END-IF.
  7755     MOVE SPACES TO VECTOR-INPUT-VALNOM.
  7756     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
  7757                  BASURA-VALNOM
  7758      VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)
  7759      VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)
  7760      VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)
  7761      VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)
  7762      VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)
  7763      VM-INPUT-VALNOM(14)
  7764      VM-INPUT-VALNOM(15)
  7765      VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)
  7766      VM-INPUT-VALNOM(19)
  7767      VM-INPUT-VALNOM(20)
  7768******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********
  7769     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  7770     IF TIP-ID-INPUT-VALNOM  NOT = 2
  7771        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  7772                 "." BY " ","-" BY " ","," BY " ",
  7773                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  7774                "Y" BY "G","H" BY "G","I" BY "G"
  7775                PERFORM VARYING I-VALNOM FROM 1 BY 1
  7776                        UNTIL I-VALNOM >= 66
  7777                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  7778                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  7779                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  7780                  END-IF
  7781                END-PERFORM
  7782     ELSE
  7783         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7784           " S.A. " BY "      ",                                  RMB0002
  7785           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7786           " LIMITADA " BY "          ",                          RMB0002
  7787           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7788           " INVERSIONES " BY "             ",                    RMB0002
  7789           " EMPRESA " BY "         ",                            RMB0002
  7790           " CORPORACION " BY "             ",                    RMB0002
  7791           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7792           " S " BY "   ", " A " BY "   "                         RMB0002
  7793           " Y " BY "   "                                         GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 135
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7794         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7795           " S.A. " BY "      ",                                  RMB0002
  7796           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7797           " LIMITADA " BY "          ",                          RMB0002
  7798           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7799           " INVERSIONES " BY "             ",                    RMB0002
  7800           " EMPRESA " BY "         ",                            RMB0002
  7801           " CORPORACION " BY "             ",                    RMB0002
  7802           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7803           " S " BY "   ", " A " BY "   "                         RMB0002
  7804           " Y " BY "   "                                         GJC0003
  7805        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
  7806                "." BY " ","-" BY " ",                            GJC0003
  7807                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7808                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7809         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
  7810     END-IF.
  7811     MOVE SPACES TO VECTOR-OK-VALNOM.
  7812     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
  7813                  BASURA-VALNOM
  7814      VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)
  7815      VM-OK-VALNOM(4) VM-OK-VALNOM(5)
  7816      VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)
  7817      VM-OK-VALNOM(9) VM-OK-VALNOM(10)
  7818      VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)
  7819      VM-OK-VALNOM(14) VM-OK-VALNOM(15)
  7820      VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)
  7821      VM-OK-VALNOM(19) VM-OK-VALNOM(20).
  7822***********HACE LA VALIDACION BLOQUE A BLOQUE********************
  7823     MOVE 1 TO I-VALNOM.
  7824     MOVE 0 TO BLOQOK-AUX-VALNOM.
  7825     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
  7826       MOVE 1 TO J-VALNOM
  7827       PERFORM UNTIL J-VALNOM > 20
  7828         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
  7829            ADD 1 TO BLOQOK-AUX-VALNOM
  7830            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7831                           VM-INPUT-VALNOM(I-VALNOM)
  7832            MOVE 21 TO J-VALNOM
  7833         ELSE
  7834            MOVE 0 TO M-VALNOM
  7835            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
  7836                    FOR CHARACTERS BEFORE INITIAL "*"
  7837            IF M-VALNOM >= 15
  7838               MOVE 0 TO M-VALNOM
  7839               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
  7840                    FOR CHARACTERS BEFORE INITIAL "N"
  7841            END-IF
  7842            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
  7843               AND (14 - M-VALNOM > 0)                            GJC0005
  7844               COMPUTE INI-VALNOM = M-VALNOM + 2
  7845               COMPUTE LON-VALNOM = 14 - M-VALNOM
  7846               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
  7847               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
  7848                  VM-INPUT-VALNOM(I-VALNOM + 1 ) AND
  7849                  PEDAZO-VALNOM(1:M-VALNOM) =
  7850                  VM-INPUT-VALNOM(I-VALNOM)
  7851                  ADD 1 TO BLOQOK-AUX-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 136
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7852                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7853                           VM-INPUT-VALNOM(I-VALNOM)
  7854                  MOVE 21 TO J-VALNOM
  7855                  ADD 1 TO I-VALNOM
  7856                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
  7857               END-IF
  7858            END-IF
  7859         END-IF
  7860         ADD 1 TO J-VALNOM
  7861       END-PERFORM
  7862       ADD 1 TO I-VALNOM
  7863       IF I-VALNOM = 21
  7864          NEXT SENTENCE
  7865       END-IF
  7866     END-PERFORM.
  7867     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
  7868        MOVE 1 TO MATCH-OK-OUT-VALNOM
  7869     ELSE
  7870        IF TIP-ID-INPUT-VALNOM <> 2
  7871           PERFORM 10100-MATCH-APROXIMADO
  7872        ELSE
  7873           PERFORM 10100-MATCH-APROX-EMPRESAS
  7874        END-IF
  7875        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
  7876           MOVE 1 TO MATCH-OK-OUT-VALNOM
  7877        END-IF
  7878     END-IF.
  7879**********************************************************************
  7880*10100-MATCH-APROXIMADO.
  7881*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS
  7882*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON
  7883*     LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.
  7884**********************************************************************
  7885 10100-MATCH-APROXIMADO.
  7886     IF BLOQOK-AUX-VALNOM > 0
  7887        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
  7888     ELSE
  7889        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
  7890     END-IF
  7891     MOVE 1 TO I-VALNOM.
  7892     PERFORM UNTIL I-VALNOM > 10
  7893       MOVE 1 TO J-VALNOM
  7894       PERFORM UNTIL J-VALNOM > 10
  7895         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
  7896         MOVE 1 TO K-VALNOM
  7897         MOVE 1 TO L-VALNOM
  7898         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
  7899            VM-OK-VALNOM   (J-VALNOM) NOT = SPACES
  7900            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
  7901              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7902                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)
  7903                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003
  7904                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003
  7905                      OR = "N"))                                  GJC0003
  7906                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
  7907                    ADD 1 TO LETRAS-OK-VALNOM
  7908                    ADD 1 TO K-VALNOM
  7909                    ADD 1 TO L-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 137
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7910                 ELSE
  7911                    MOVE 19 TO K-VALNOM
  7912                 END-IF
  7913              ELSE
  7914                 ADD 1   TO K-VALNOM
  7915                 IF K-VALNOM <= 15 AND L-VALNOM < 15
  7916                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
  7917                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM )
  7918                       ADD 1 TO L-VALNOM
  7919                    END-IF
  7920                 END-IF
  7921              END-IF
  7922            END-PERFORM
  7923            MOVE 1 TO K-VALNOM
  7924            MOVE 1 TO L-VALNOM
  7925            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
  7926              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7927                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)
  7928                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003
  7929                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003
  7930                      OR = "N"))                                  GJC0003
  7931                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
  7932                    ADD 1 TO LETRAS-OK2-VALNOM
  7933                    ADD 1 TO K-VALNOM
  7934                    ADD 1 TO L-VALNOM
  7935                 ELSE
  7936                    MOVE 19 TO K-VALNOM
  7937                 END-IF
  7938              ELSE
  7939                 ADD 1   TO L-VALNOM
  7940                 IF L-VALNOM <= 15 AND K-VALNOM < 15
  7941                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7942                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM + 1)
  7943                       ADD 1 TO K-VALNOM
  7944                    END-IF
  7945                 END-IF
  7946              END-IF
  7947            END-PERFORM
  7948         END-IF
  7949         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
  7950            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
  7951         END-IF
  7952         IF LETRAS-OK-VALNOM > 0
  7953            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
  7954            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
  7955                    TOTLET-INP-VALNOM
  7956                    FOR CHARACTERS BEFORE INITIAL " "
  7957            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
  7958                    TOTLET-OK-VALNOM
  7959                    FOR CHARACTERS BEFORE INITIAL " "
  7960            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
  7961            IF TOTLET-OK-VALNOM >= 3
  7962               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
  7963                                       TOTLET-OK-VALNOM
  7964            END-IF
  7965            IF TOTLET-INP-VALNOM >= 3
  7966               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
  7967                                       TOTLET-INP-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 138
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7968            END-IF
  7969            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
  7970               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
  7971                                 TOTLET-OK-VALNOM
  7972            ELSE
  7973               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
  7974                                 TOTLET-INP-VALNOM
  7975            END-IF
  7976            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
  7977                                  APROX-TOT-VALNOM) AND
  7978                 A-VALNOM >= 63
  7979****   display "%TOT=",POR-TOT-VALNOM, " %INP=", POR-INP-VALNOM,
  7980****           "A-VALNOM=", A-VALNOM
  7981*****       IF (POR-TOT-VALNOM >= APROX-TOT-VALNOM AND
  7982*****           POR-INP-VALNOM >= APROX-INP-VALNOM ) OR
  7983*****          ((POR-TOT-VALNOM >= APROX-TOT-VALNOM OR
  7984*****            POR-INP-VALNOM >= APROX-INP-VALNOM ) AND
  7985*****            A-VALNOM >= 70)
  7986               ADD 1 TO BLOQOK-AUX-VALNOM
  7987               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7988                           VM-INPUT-VALNOM(I-VALNOM)
  7989            END-IF
  7990         END-IF
  7991         ADD 1 TO J-VALNOM
  7992       END-PERFORM
  7993       ADD 1 TO I-VALNOM
  7994     END-PERFORM.
  7995**********************************************************************
  7996*10100-MATCH-APROX-EMPRESAS
  7997*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS
  7998*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON
  7999*     LOS TIPOS DE IDENTIFICACION 2.
  8000**********************************************************************
  8001 10100-MATCH-APROX-EMPRESAS.
  8002   MOVE ZEROS TO TOTLET-INP-VALNOM
  8003   MOVE ZEROS TO LETRAS-OK2-VALNOM
  8004    MOVE ZEROS TO A-VALNOM                                        GJC0003
  8005   MOVE 1 TO K-VALNOM
  8006   PERFORM UNTIL K-VALNOM > 65
  8007     MOVE K-VALNOM  TO I-VALNOM
  8008     MOVE 1       TO J-VALNOM
  8009     MOVE ZEROS TO LETRAS-OK-VALNOM
  8010     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
  8011        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
  8012           V-NOMBRE-VALNOM(I-VALNOM) <> "."
  8013           IF V-NOMBRE-VALNOM(I-VALNOM) =
  8014              V-NOMBOK-VALNOM(J-VALNOM)
  8015              ADD 1 TO LETRAS-OK-VALNOM
  8016              ADD 1 TO I-VALNOM
  8017              ADD 1 TO J-VALNOM
  8018           ELSE
  8019              ADD 1 TO J-VALNOM
  8020           END-IF
  8021        ELSE
  8022           ADD 1 TO I-VALNOM
  8023        END-IF
  8024     END-PERFORM
  8025     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 139
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  8026        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
  8027     END-IF
  8028     ADD 1 TO K-VALNOM
  8029   END-PERFORM.
  8030   MOVE 1 TO I-VALNOM
  8031   PERFORM UNTIL I-VALNOM > 65
  8032     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
  8033        V-NOMBRE-VALNOM(I-VALNOM) <> "."
  8034        ADD 1 TO TOTLET-INP-VALNOM
  8035     END-IF
  8036     ADD 1 TO I-VALNOM
  8037   END-PERFORM.
  8038   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
  8039                     TOTLET-INP-VALNOM.
  8040   IF A-VALNOM >= 75
  8041       ADD 1 TO BLOQOK-AUX-VALNOM
  8042   END-IF.
  8043    MOVE 0 TO K-VALNOM                                            GJC0003
  8044   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
  8045      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
  8046      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
  8047               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
  8048                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
  8049                   TO I-VALNOM                                    GJC0003
  8050                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
  8051              END-IF                                              GJC0003
  8052               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
  8053                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
  8054                    TO I-VALNOM                                   GJC0003
  8055                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
  8056              END-IF                                              GJC0003
  8057      END-PERFORM                                                 GJC0003
  8058      MOVE 0 TO I-VALNOM                                          GJC0003
  8059       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
  8060         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
  8061            ADD 1 TO I-VALNOM                                     GJC0003
  8062            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
  8063               CONT-LET-INPUT-VALNOM(J-VALNOM)                    GJC0003
  8064               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
  8065            ELSE                                                  GJC0003
  8066               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
  8067                                  (CONT-LET-INPUT-VALNOM(J-VALNOM)GJC0003
  8068                           *  100 /CONT-LET-OK-VALNOM(J-VALNOM))  GJC0003
  8069            END-IF                                                GJC0003
  8070         END-IF                                                   GJC0003
  8071      END-PERFORM                                                 GJC0003
  8072      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
  8073       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
  8074         ((A-VALNOM >= 35 AND A-VALNOM < 40) AND K-VALNOM > 85) ORGJC0003
  8075         ((A-VALNOM >= 25 AND A-VALNOM < 35) AND K-VALNOM = 100)  GJC0003
  8076         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
  8077       END-IF                                                     GJC0003
  8078   END-IF.                                                        GJC0003
  8079
  8080 0500-ASIGNA-ID-ICMCRE-START.
  8081******************************************************************
  8082*0500-ASIGNA-ID-ICMCRE-START.
  8083******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 140
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8084        MOVE TIPO-ID-ABD07 TO TIPO-ID-LEEMSTRS
  8085        MOVE NUM-ID-ABD07  TO NRO-ID-LEEMSTRS.
  8086
  8087 0600-ASIGNA-ID-ICMCHK-START.
  8088******************************************************************
  8089*0600-ASIGNA-ID-ICMCHK-START.
  8090******************************************************************
  8091        MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRS
  8092        MOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.
  8093
  8094 1000-LEE-ICMCRE-SECUENCIAL.
  8095******************************************************************
  8096*1000-LEE-ICMCRE-SECUENCIAL.
  8097*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
  8098*    ARCHIVO:
  8099*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8100*                         1: LECTURA CON ERROR O FIN ARCHIVO
  8101* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
  8102* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
  8103******************************************************************
  8104     MOVE 0 TO SW-LECTURA-MAESTROS
  8105     READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT END
  8106          MOVE 1 TO SW-LECTURA-MAESTROS
  8107     END-READ
  8108     IF SW-LECTURA-MAESTROS = 0
  8109      IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS AND
  8110          NUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR
  8111          (TIPO-ID-LEEMSTRS = ZEROS AND
  8112           NRO-ID-LEEMSTRS  = ZEROS)
  8113$       IF HACERMATCH = "SI"
  8114          IF HACERMATCH-LEEMSTRS = 1
  8115           IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR
  8116              NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS
  8117              MOVE 0 TO IDE-TIPO-BDAMATCH
  8118              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8119              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8120              IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004
  8121                                 CONSECUTIVO-ABD07 = 01           GJC0004
  8122                 PERFORM 7000-GUARDAR-REG-INICIALES
  8123                 MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH
  8124                 MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH
  8125                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8126                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8127                 MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS
  8128                 MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS
  8129              END-IF
  8130           END-IF
  8131          END-IF
  8132$       END
  8133        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8134           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003
  8135                              050050 OR 130050                    GJC0003
  8136              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003
  8137           END-IF                                                 GJC0003
  8138        END-IF                                                    GJC0003
  8139$       IF AMNISTIA21 = "SI"
  8140           IF AMNISTIA21-LEEMSTRS = 1
  8141              PERFORM 200700-AMNISTIA-CLIENTES
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 141
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8142* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
  8143* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
  8144              IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003
  8145                 IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003
  8146                                    050050 OR 130050              GJC0003
  8147                    MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003
  8148                 END-IF                                           GJC0003
  8149              END-IF                                              GJC0003
  8150           END-IF
  8151           IF SW-ART13-AMNIST21 = 1                               GJC0002
  8152              IF IDE-TIPO-BDAMATCH = 1                            GJC0002
  8153                 IF HACERMATCH-LEEMSTRS = 1                       GJC0002
  8154                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002
  8155                 END-IF                                           GJC0002
  8156              END-IF                                              GJC0002
  8157              PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002
  8158           END-IF                                                 GJC0002
  8159$       END
  8160        IF SW-AMNIST21 = 1
  8161           IF IDE-TIPO-BDAMATCH = 1                               GJC0002
  8162              IF HACERMATCH-LEEMSTRS = 1                          GJC0002
  8163                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002
  8164              END-IF                                              GJC0002
  8165           END-IF                                                 GJC0002
  8166           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002
  8167              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002
  8168*             ELSE                                                GJC0002
  8169*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002
  8170*             END-IF                                              GJC0002
  8171           END-IF
  8172        ELSE
  8173           IF IDE-TIPO-BDAMATCH = 1
  8174              IF HACERMATCH-LEEMSTRS = 1
  8175                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  8176              END-IF
  8177           END-IF
  8178        END-IF
  8179
  8180      END-IF
  8181      IF SW-NOV-48-LEEMSTRS = 0  *>                               GJC0002
  8182         MOVE ZEROS TO VECTOR-HIS-3-ABD07                         GJC0002
  8183                       VECTOR-HIS-4-ABD07                         GJC0002
  8184           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002
  8185           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002
  8186           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002
  8187           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002
  8188     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002
  8189          MOR-EST-CTA-AMNIST21                                    GJC0002
  8190        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0002
  8191      END-IF                                                      GJC0002
  8192     END-IF.
  8193     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8194
  8195 2000-LEE-ICMCRE-DINAMICO.
  8196******************************************************************
  8197*2000-LEE-ICMCRE-DINAMICO.
  8198*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
  8199*    DEL ARCHIVO:
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 142
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8200*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8201*                         1: LECTURA CON ERROR
  8202******************************************************************
  8203     MOVE 0 TO SW-LECTURA-MAESTROS
  8204     READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY
  8205          MOVE 1 TO SW-LECTURA-MAESTROS
  8206     END-READ
  8207     IF SW-LECTURA-MAESTROS = 0
  8208$       IF HACERMATCH = "SI"
  8209          IF HACERMATCH-LEEMSTRS = 1
  8210           IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR
  8211              NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS
  8212              MOVE 0 TO IDE-TIPO-BDAMATCH
  8213              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8214              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8215              IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004
  8216                                 CONSECUTIVO-ABD07 = 01           GJC0004
  8217                 PERFORM 7000-GUARDAR-REG-INICIALES
  8218                 MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH
  8219                 MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH
  8220                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8221                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8222                 MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS
  8223                 MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS
  8224              END-IF
  8225           END-IF
  8226         END-IF
  8227$       END
  8228        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8229           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003
  8230                              050050 OR 130050                    GJC0003
  8231              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003
  8232           END-IF                                                 GJC0003
  8233        END-IF                                                    GJC0003
  8234$       IF AMNISTIA21 = "SI"
  8235           IF AMNISTIA21-LEEMSTRS = 1
  8236              PERFORM 200700-AMNISTIA-CLIENTES
  8237* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
  8238* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
  8239              IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003
  8240                 IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003
  8241                                    050050 OR 130050              GJC0003
  8242                    MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003
  8243                 END-IF                                           GJC0003
  8244              END-IF                                              GJC0003
  8245           END-IF
  8246           IF SW-ART13-AMNIST21 = 1                               GJC0002
  8247              IF IDE-TIPO-BDAMATCH = 1                            GJC0002
  8248                 IF HACERMATCH-LEEMSTRS = 1                       GJC0002
  8249                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002
  8250                 END-IF                                           GJC0002
  8251              END-IF                                              GJC0002
  8252              PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002
  8253           END-IF                                                 GJC0002
  8254$       END
  8255        IF SW-AMNIST21 = 1
  8256           IF IDE-TIPO-BDAMATCH = 1                               GJC0002
  8257              IF HACERMATCH-LEEMSTRS = 1                          GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 143
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8258                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002
  8259              END-IF                                              GJC0002
  8260           END-IF                                                 GJC0002
  8261           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002
  8262              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002
  8263*             ELSE                                                GJC0002
  8264*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002
  8265*             END-IF                                              GJC0002
  8266           END-IF
  8267        ELSE
  8268           IF IDE-TIPO-BDAMATCH = 1
  8269              IF HACERMATCH-LEEMSTRS = 1
  8270                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  8271              END-IF
  8272           END-IF
  8273        END-IF
  8274        IF SW-NOV-48-LEEMSTRS = 0                                 GJC0002
  8275           MOVE ZEROS TO VECTOR-HIS-3-ABD07                       GJC0002
  8276                       VECTOR-HIS-4-ABD07                         GJC0002
  8277           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002
  8278           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002
  8279           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002
  8280           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002
  8281     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002
  8282          MOR-EST-CTA-AMNIST21                                    GJC0002
  8283          PERFORM 500000-RECONSTRUCCION-HISTORIA                  GJC0002
  8284        END-IF                                                    GJC0002
  8285     END-IF.
  8286     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8287
  8288 3000-LEE-ICMCHK-SECUENCIAL.
  8289******************************************************************
  8290*3000-LEE-ICMCHK-SECUENCIAL.
  8291*    LEEE MAESTRO ICMCHK EN FORMA SECUENCIAL Y VALIDA EL FIN DE
  8292*    ARCHIVO:
  8293*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8294*                         1: LECTURA CON ERROR O FIN ARCHIVO
  8295******************************************************************
  8296     MOVE 0 TO SW-LECTURA-MAESTROS
  8297     READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK AT END
  8298          MOVE 1 TO SW-LECTURA-MAESTROS
  8299     END-READ
  8300     IF SW-LECTURA-MAESTROS = 0
  8301      IF (TIPO-ID-ABD06 = TIPO-ID-LEEMSTRS AND
  8302          NUM-ID-ABD06  = NRO-ID-LEEMSTRS) OR
  8303          (TIPO-ID-LEEMSTRS = ZEROS AND
  8304           NRO-ID-LEEMSTRS  = ZEROS)
  8305$       IF HACERMATCH = "SI"
  8306          IF HACERMATCH-LEEMSTRS = 1
  8307           IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR
  8308              NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS
  8309              MOVE 0 TO IDE-TIPO-BDAMATCH
  8310              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8311              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8312              IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004
  8313                                 CONSECUTIVO-ABD06 = 01           GJC0004
  8314                 PERFORM 7000-GUARDAR-REG-INICIALES
  8315                 MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 144
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8316                 MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH
  8317                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8318                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8319                 MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS
  8320                 MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS
  8321              END-IF
  8322           END-IF
  8323           IF IDE-TIPO-BDAMATCH = 1
  8324              IF HACERMATCH-LEEMSTRS = 1
  8325                 PERFORM 8000-U-VER-CTAABD06-BDAMATCH
  8326              END-IF
  8327           END-IF
  8328          END-IF
  8329$       END
  8330        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8331           IF COD-SUS-ABD06 = 010050                              GJC0003
  8332              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003
  8333           END-IF                                                 GJC0003
  8334        END-IF                                                    GJC0003
  8335        ADD 0 TO SW-LECTURA-MAESTROS
  8336      END-IF
  8337     END-IF.
  8338     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8339
  8340 4000-LEE-ICMCHK-DINAMICO.
  8341******************************************************************
  8342*4000-LEE-ICMCHK-DINAMICO.
  8343*    LEEE MAESTRO ICMCHK EN FORMA DIMANICA Y VALIDA EL INVALID KEY
  8344*    DEL ARCHIVO:
  8345*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8346*                         1: LECTURA CON ERROR
  8347******************************************************************
  8348     MOVE 0 TO SW-LECTURA-MAESTROS
  8349     READ MAESTRO-CHECK IGNORE LOCK INVALID KEY
  8350          MOVE 1 TO SW-LECTURA-MAESTROS
  8351     END-READ
  8352     IF SW-LECTURA-MAESTROS = 0
  8353$       IF HACERMATCH = "SI"
  8354          IF HACERMATCH-LEEMSTRS = 1
  8355           IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR
  8356              NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS
  8357              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8358              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8359              MOVE 0 TO IDE-TIPO-BDAMATCH
  8360              IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004
  8361                                 CONSECUTIVO-ABD06 = 01           GJC0004
  8362                 PERFORM 7000-GUARDAR-REG-INICIALES
  8363                 MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH
  8364                 MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH
  8365                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8366                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8367                 MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS
  8368                 MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS
  8369              END-IF
  8370           END-IF
  8371           IF IDE-TIPO-BDAMATCH = 1
  8372              IF HACERMATCH-LEEMSTRS = 1
  8373                 PERFORM 8000-U-VER-CTAABD06-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 145
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8374              END-IF
  8375           END-IF
  8376          END-IF
  8377$       END
  8378        ADD 0 TO SW-LECTURA-MAESTROS
  8379        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8380           IF COD-SUS-ABD06 = 010050                              GJC0003
  8381              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003
  8382           END-IF                                                 GJC0003
  8383        END-IF                                                    GJC0003
  8384     END-IF.
  8385     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8386
  8387 7000-GUARDAR-REG-INICIALES.
  8388******************************************************************
  8389*7000-GUARDAR-REGISTROS-INICIALES.
  8390*    GUARDA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES DE
  8391*    EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
  8392******************************************************************
  8393      MOVE SPACES TO REG-ICMCRE-LEEMSTRS REG-ICMCHK-LEEMSTRS
  8394                     REG-ICBSUS-LEEMSTRS REG-ICBDIR-LEEMSTRS
  8395      MOVE COMPLETO-ABD07  TO REG-ICMCRE-LEEMSTRS
  8396      MOVE COMPLETO-ABD06  TO REG-ICMCHK-LEEMSTRS
  8397      MOVE REG-SUSCRIPTOR  TO REG-ICBSUS-LEEMSTRS
  8398      MOVE REG-DIRECC      TO REG-ICBDIR-LEEMSTRS.
  8399
  8400 8000-RECUPERAR-REG-INICIALES.
  8401******************************************************************
  8402*8000-RECUPERA-REGISTROS-INICIALES.
  8403*    RECUPERA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES
  8404*    DE EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
  8405******************************************************************
  8406      IF COMPLETO-ABD07  <> REG-ICMCRE-LEEMSTRS AND
  8407         REG-ICMCRE-LEEMSTRS <> SPACES
  8408         MOVE REG-ICMCRE-LEEMSTRS TO COMPLETO-ABD07
  8409         START MAESTRO-CREDIT KEY = LLAVE-MAES-CREDIT
  8410               NOT INVALID KEY
  8411               READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK
  8412               END-READ
  8413         END-START
  8414      END-IF
  8415      IF COMPLETO-ABD06  <> REG-ICMCHK-LEEMSTRS AND
  8416         REG-ICMCHK-LEEMSTRS <> SPACES
  8417         MOVE REG-ICMCHK-LEEMSTRS TO COMPLETO-ABD06
  8418         START MAESTRO-CHECK  KEY = LLAVE-MAES-CHECK
  8419               NOT INVALID KEY
  8420               READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK
  8421               END-READ
  8422         END-START
  8423      END-IF
  8424      IF REG-SUSCRIPTOR  <> REG-ICBSUS-LEEMSTRS AND
  8425         REG-ICBSUS-LEEMSTRS <> SPACES
  8426         MOVE REG-ICBSUS-LEEMSTRS TO REG-SUSCRIPTOR
  8427         START SUSCRIPTOR KEY = LLAVE-SUSCRIP
  8428               NOT INVALID KEY
  8429               READ SUSCRIPTOR NEXT RECORD IGNORE LOCK
  8430               END-READ
  8431         END-START
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 146
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8432      END-IF
  8433      IF REG-DIRECC      <> REG-ICBDIR-LEEMSTRS AND
  8434         REG-ICBDIR-LEEMSTRS <> SPACES
  8435         MOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECC
  8436         START MAESTRO-DIRECC KEY = LLAVE-DIRECC
  8437               NOT INVALID KEY
  8438               READ MAESTRO-DIRECC NEXT RECORD IGNORE LOCK
  8439               END-READ
  8440         END-START
  8441      END-IF.
  8442
  8443*------------------------------------------------------*
  8444* EVALUAR FECHAS APERTURA Y NOVEDAD                    *
  8445*------------------------------------------------------*
  8446 5900-EVALUA-FECHAS.
  8447     MOVE FECHA-APERT-ABD07  TO  W-FECHA-AUX
  8448     IF W-ANO-AUX > 50
  8449        MOVE 19 TO W-SGL-OK    SIG-APE
  8450     ELSE
  8451        MOVE 20 TO W-SGL-OK    SIG-APE
  8452     END-IF
  8453     MOVE W-ANO-AUX   TO  W-ANO-OK     ANO-APE
  8454     MOVE W-MES-AUX   TO  W-MES-OK     MES-APE
  8455     MOVE W-FECHA-OK  TO  W-FECHA-INICIAL
  8456     MOVE FEC-NOVEDAD-ABD07  TO  W-FECHA-AUX
  8457     IF W-ANO-AUX > 50
  8458        MOVE 19 TO W-SGL-OK
  8459     ELSE
  8460        MOVE 20 TO W-SGL-OK
  8461     END-IF
  8462     MOVE W-ANO-AUX   TO  W-ANO-OK
  8463     MOVE W-MES-AUX   TO  W-MES-OK
  8464     MOVE W-FECHA-OK  TO  W-FECHA-NOVEDAD
  8466     MOVE 0  TO J
  8467     MOVE FECHA-VENC-ABD07 TO FECHA-AUX
  8468     MOVE FECHA-AUX(1:2) TO MES-VEN
  8469     MOVE FECHA-AUX(3:2) TO ANO-VEN
  8470     IF ANO-VEN < 50
  8471            MOVE 20 TO SIG-VEN
  8472     ELSE
  8473            MOVE 19 TO SIG-VEN
  8474     END-IF
  8475     MOVE W-ANO-AUX   TO  W-ANO-OK
  8476     MOVE W-MES-AUX   TO  W-MES-OK
  8477
  8478     MOVE FECHA-VENCIMIENTO07  TO  W-FECHA-VENCIM
  8479     IF FECHA-VENCIMIENTO07 > FECHA-APERTURA07
  8480            COMPUTE J = ( SIG-ANO-VEN * 12 + MES-VEN ) -
  8481                        ( SIG-ANO-APE * 12 + MES-APE )
  8482     END-IF
  8483     PERFORM 030-NORMALIZAR-VECTOR
  8485     PERFORM 32000-PROCESAR-VALORES
  8486     PERFORM 8000-EXAMINA-VALORES.
  8487
  8488 8000-EXAMINA-VALORES.
  8489*---------------------------------------------------*
  8490     IF COD-SUS-ABD07 = 020008 OR 029908
  8491        MOVE 1 TO IND-VALORES-VALVLR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 147
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  8492        MOVE 1 TO VEC-VALOR-VALVLR (2)
  8493        MOVE 1 TO VEC-VALOR-VALVLR (3)
  8494     END-IF
  8495     IF IND-VALORES-VALVLR = 1
  8496        IF VEC-VALOR-VALVLR (2) = 1
  8497           MOVE VALOR-INICIAL-ABD07    TO W-VALOR-INI
  8498        END-IF
  8499        IF VEC-VALOR-VALVLR (1) = 1
  8500           MOVE CUANTIA-ABD07          TO W-VALOR-CUOTA
  8501        END-IF
  8502        IF VEC-VALOR-VALVLR (3) = 1
  8503           MOVE VALOR-SALDO-DEUDAM-ABD07 TO W-SALDO-CARTERA
  8504        END-IF
  8505        IF VEC-VALOR-VALVLR (5) = 1
  8506           MOVE VALOR-SALDO-MORAM-ABD07 TO W-SALDO-MORA
  8507           IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 01
  8508              MOVE ZERO                 TO W-SALDO-MORA
  8509           END-IF
  8510        END-IF
  8511     END-IF.
  8512
  8513
  8514 030-NORMALIZAR-VECTOR.
  8515*===============================================================
  8516*030-NORMALIZAR-VECTOR.
  8517* Se dejan todas las fechas en formato ANO(4).MES(2)          *
  8518*===============================================================
  8519     MOVE FEC-NOVEDAD-ABD07 TO FECHA-AUX.
  8520     MOVE FECHA-AUX(1:2) TO MES-NOV.
  8521     MOVE FECHA-AUX(3:2) TO ANO-NOV.
  8522     IF ANO-NOV < 50
  8523        MOVE 20          TO SIG-NOV
  8524     ELSE
  8525        MOVE 19          TO SIG-NOV
  8526     END-IF.
  8527     MOVE FECHA-ING-ABD02      TO FECHA-AUX.
  8528     MOVE FECHA-AUX(1:2) TO MES-ING.
  8529     MOVE FECHA-AUX(3:2) TO ANO-ING.
  8530     IF ANO-ING < 50
  8531        MOVE 20          TO SIG-ING
  8532     ELSE
  8533        MOVE 19          TO SIG-ING
  8534     END-IF.
  8535***************************************************************
  8536* Se calcula si es necesario borrar información inválida      *
  8537***************************************************************
  8538     MOVE ESTADO-MES-ABD07 TO V-NOR4.
  8539     MOVE VECTOR-2-ABD07   TO V-NOR3.
  8540     MOVE ESTADO-MES-R-ABD07 TO V-NOR2.
  8541     MOVE VECTOR-2-R-ABD07   TO V-NOR1.
  8542     IF FECHA-APERTURA07 > FECHA-INGRESO
  8543        MOVE FECHA-APERTURA07 TO FECHA-INGRESO
  8544     END-IF
  8545     IF FECHA-NOVEDAD07 > FECHA-INGRESO
  8546        COMPUTE J = ( SIG-ANO-NOV * 12 + MES-NOV ) -
  8547                    ( SIG-ANO-ING * 12 + MES-ING )
  8548     ELSE
  8549        MOVE 0 TO J
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 148
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  8550     END-IF
  8551     IF J < 48
  8552        COMPUTE J = 48 - J
  8553     ELSE
  8554        MOVE 0 TO J
  8555     END-IF
  8556     PERFORM UNTIL J = 0
  8557        MOVE "0" TO V-NOR(J:1)
  8558        SUBTRACT 1 FROM J
  8559     END-PERFORM
  8560*    CASTIGADAS Y DUDOSO RECAUDO
  8561     IF NOV-REPORT-ABD07 = 45 OR 47
  8562        IF NOV-REPORT-ABD07 = 47
  8563           MOVE ALL "D" TO RELLENO
  8564        ELSE
  8565           MOVE ALL "C" TO RELLENO
  8566        END-IF
  8567        MOVE FECHA-SITUACION-ABD07 TO FECHA-SITMMAAAA-ORI
  8568        MOVE FECHA-SITAAAA-ORI     TO FECHA-SITAAAA
  8569        MOVE FECHA-SITMM-ORI       TO FECHA-SITMM
  8570        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO FECHA-SITMMAAAA-ORI
  8571        MOVE FECHA-SITAAAA-ORI     TO FECHA-VALAAAA
  8572        MOVE FECHA-SITMM-ORI       TO FECHA-VALMM
  8573        IF FECHA-VALAAAAMM > FECHA-SITAAAAMM
  8574           MOVE FECHA-VALAAAAMM TO FECHA-SITAAAAMM
  8575        END-IF
  8576        IF FECHA-SITAAAAMM  > FECHA-NOVEDAD07
  8577           COMPUTE J = ( FECHA-SITAAAA * 12 + FECHA-SITMM ) -
  8578                       ( SIG-ANO-NOV   * 12 + MES-NOV     )
  8579           IF J < 48
  8580              PERFORM UNTIL J = 0
  8581                 MOVE V-NOR(2:47) TO V-NOR(1:47)
  8582                 MOVE RELLENO(1:1) TO V-NOR(48:1)
  8583                 SUBTRACT 1 FROM J
  8584              END-PERFORM
  8585           ELSE
  8586              MOVE RELLENO TO V-NOR(1:48)
  8587           END-IF
  8588           MOVE  FECHA-SITAAAAMM  TO  FECHA-NOVEDAD07
  8589        END-IF
  8590     END-IF.
  8591*    ADICIONAR NOVEDAD
  8592     MOVE V-NOR(2:47) TO V-NOR(1:47)
  8593     MOVE V-MORA(NOV-REPORT-ABD07) TO V-NOR(48:1)
  8594*    NORMALIZAR
  8595     IF FECHA-TAG >= FECHA-NOVEDAD07
  8596        COMPUTE J = ( SIG-ANO-TAG * 12 + MES-TAG ) -
  8597                    ( SIG-ANO-NOV * 12 + MES-NOV )
  8598        IF J < 48
  8599           PERFORM UNTIL J = 0
  8600             MOVE V-NOR(2:47) TO V-NOR(1:47)
  8601             MOVE "0"         TO V-NOR(48:1)
  8602             SUBTRACT 1 FROM J
  8603           END-PERFORM
  8604        ELSE
  8605           MOVE ALL "0"        TO V-NOR
  8606        END-IF
  8607     ELSE                           *> NO SE CONSIDERA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 149
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  8608             INITIALIZE V-NOR-AUX
  8609             MOVE V-NOR       TO V-NOR-AUX
  8610             MOVE V-NOR-AUX   TO V-NOR(2:47)
  8611             MOVE "0"         TO V-NOR(1:1)
  8612     END-IF.
  8613*    REEMPLAZOS
  8614     INSPECT V-NOR REPLACING ALL "0" BY "."
  8615     INSPECT V-NOR REPLACING ALL "5" BY "0"   *> AL DIA
  8616     INSPECT V-NOR REPLACING ALL "P" BY "0"   *> PAGO TOTAL
  8617     INSPECT V-NOR REPLACING ALL "7" BY "."
  8618     INSPECT V-NOR REPLACING ALL "8" BY "."
  8619     INSPECT V-NOR REPLACING ALL "9" BY "."
  8620     INSPECT V-NOR REPLACING ALL "M" BY "5"   *> CANCELADA MM
  8621     INSPECT V-NOR REPLACING ALL "D" BY "6"   *> DUDOSO RECAUDO
  8622     INSPECT V-NOR REPLACING ALL "C" BY "7"   *> CASTIGADA
  8623     INSPECT V-NOR REPLACING ALL "R" BY "8".  *> RECUPERADA
  8624*===============================================================
  8625
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-015065005AF
* Total Messages:     0
* Data:     1201560     Code:       74854
/d/iccol/desarrollo/fuentes/cobol>^[  /d/iccol/desarrollo/fuentes/cobol>cat icestd81.lst
"/tmp/sh9091.3" 1 line, 17 characters cat icestd81.lst
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~"/tmp/sh9091.3" 1 line, 17 characterscaca$CHANGE MODEvivi"/tmp/sh9091.3" 1 line, 16 characters vi icestd81.lst
"icestd81.lst" 8905 lines, 526319 characters ^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*list("icestd81.lst")1*icestd81.cbl.v.01.00022 IDENTIFICATION DIVISION.3 PROGRAM-ID.    icestd81-DATACREDITO.4 AUTHOR.DATACREDITO-JAGR.5 DATE-WRITTEN.  OCT/2006.6 DATE-COMPILED. 21-May-14 10:39.7******************************************************************8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.*
    10* GER.DESARR.|*
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.*
    15* GER.DESARR.|*
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
29*   sh-datainforme
    30*
31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43ASSIGN TO DISK MAES-DIRECC-TITLE
    44ORGANIZATION IS INDEXED
    45ACCESS MODE IS DYNAMIC
    46RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51XFILE STATUS IS EST-ICBDIR^"icestd81.lst" 8905 lines, 526319 characters^/1821  1797* ABR/2005    **
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE*
  1800* F.CUADROS   *FRAINQ.DAT*
  1801* JUN.23/2005 **
  1802******************************************************************
^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO*
  1804* F.CUADROS   *HISTORICO PARA MICROCREDITO*
  1805* SEP.02/2005 **
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE*
  1808* F.CUADROS   *LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *TIPO 8*
  1810***
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *PARA PROCESOS DEL AREA DE CALIDAD.*
  1814* OCT.17/2006 **
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE*
  1817* F.CUADROS   *PREGUNTAS GRUPALES PARA FRAINQGR*
  1818* SEP.11/2007 **
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE*
  1821* F.LOZANO T. *SCORES MENSUALES.*
  1822* OCT.31/2007 **
  1823******************************************************************
  1824* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1825* C.VELASCO   *DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1826* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP*
  1827******************************************************************
  1828* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1829* E.ALVAREZ   *PARA PROCESAR 48 MESES DEL ARCHIVO*
  1830* JUN.19/2009 **
  1831******************************************************************
  1832* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES*
  1833* R.GALVIS    *MAES-DIRECTORY ARCHIVOS ICMVLR*
  1834* JUL.09/2009 *DE 17 A 16 POSICIONES*
  1835** CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1836**CHEQUES*
  1837******************************************************************
  1838* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1839* V.FORERO    *CLIENTES*
  1840* SEP.28/2009 **
  1841******************************************************************
  1842* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1843* C.VELASCO   *MARCAS PRIVADAS PARA TARJETAS*
  1844* OCT.09/2009 **
  1845******************************************************************
  1846* RGH0032* MOD032 - INCLUIR ARCHIVOS DE RECONOCER +*
  1847* R. GALVIS H.  *BDLDIRACE*
  1848* ENE. 01/2010  *BDLMAIEXC*
  1849* INTERSCHEMES. *BDLTELEXC*  1821* F.LOZANO T. *SCORES MENSUALES.*
  1822* OCT.31/2007 **
  1823******************************************************************
  1824* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1825* C.VELASCO   *DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1826* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP*
  1827******************************************************************
  1828* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1829* E.ALVAREZ   *PARA PROCESAR 48 MESES DEL ARCHIVO*
  1830* JUN.19/2009 **
  1831******************************************************************
  1832* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES*
  1833* R.GALVIS    *MAES-DIRECTORY ARCHIVOS ICMVLR*
  1834* JUL.09/2009 *DE 17 A 16 POSICIONES*
  1835** CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1836**CHEQUES*
  1837******************************************************************
  1838* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1839* V.FORERO    *CLIENTES*
  1840* SEP.28/2009 **
  1841******************************************************************
  1842* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1843* C.VELASCO   *MARCAS PRIVADAS PARA TARJETAS*
  1844* OCT.09/2009 **
  1845******************************************************************
  1846* RGH0032* MOD032 - INCLUIR ARCHIVOS DE RECONOCER +*
  1847* R. GALVIS H.  *BDLDIRACE*
  1848* ENE. 01/2010  *BDLMAIEXC*
  1849* INTERSCHEMES. *BDLTELEXC*
  1850******************************************************************
  1851* LAG0033* SCOPRE - INCLUIR ARCHIVO SCOREPREC*
  1852* AGO. 02/2010  *BDLMAIEXC*
  1853* G.DESARROLLO  *BDLTELEXC*
  1854* GJC0033* FRZMYR - SE INCLUYE MANEJO DE ARCHIVO DE DES-  *
  1855* G.JIMENEZ     *PLAZADOS Y SECUESTRADOS - FUERZA MA-  *
  1856* OCT./2010     *YOR*
  1857******************************************************************
  1858* GJC0034* BDANOM - SE INCLUYE MANEJO DE ARCHIVO DE POR-  *
  1859* G.JIMENEZ     *CENTAJE DE NOMBRES Y APELLIDOS BDANOM *
  1860* FEB./2011     **
^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page  33
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1861******************************************************************
  1862* CAV0035* AJDANE - SE INCLUYE MANEJO DE ARCHIVO DANE DE  *
  1863* C.VELASCO     *CIUDADES,DEPARTEAMENTOS Y CABECERAS O *
  1864* ABR./2011     *CENTROS POBLADOS (DVPDANE)*
  1865******************************************************************
  1866* CAV0036* CARIND - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1867* C.VELASCO     *CARACTERISTICAS USA PRECALCULADAS     *
  1868* MAY./2011     *TITLE-CARACT-IND*
  1869******************************************************************
  1870* FARF037* FRABDU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1871* F.RODRIGUEZ   *DE DATOS UNIVERSAL DE PREGUNTAS*
  1872* JUN.22/2011   **
  1873******************************************************************
1880 lines deleted  ^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*list("icestd81.lst")1*icestd81.cbl.v.01.00022 IDENTIFICATION DIVISION.3 PROGRAM-ID.    icestd81-DATACREDITO.4 AUTHOR.DATACREDITO-JAGR.5 DATE-WRITTEN.  OCT/2006.6 DATE-COMPILED. 21-May-14 10:39.7******************************************************************8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.*
    10* GER.DESARR.|*
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.*
    15* GER.DESARR.|*
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
29*   sh-datainforme
    30*
31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43ASSIGN TO DISK MAES-DIRECC-TITLE
    44ORGANIZATION IS INDEXED
    45ACCESS MODE IS DYNAMIC
    46RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51XFILE STATUS IS EST-ICBDIR
1880 more lines^/  1797* ABR/2005    **
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE*
  1800* F.CUADROS   *FRAINQ.DAT*
  1801* JUN.23/2005 **
  1802******************************************************************
^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO*
  1804* F.CUADROS   *HISTORICO PARA MICROCREDITO*
  1805* SEP.02/2005 **
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE*
  1808* F.CUADROS   *LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *TIPO 8*
  1810***
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *PARA PROCESOS DEL AREA DE CALIDAD.*
  1814* OCT.17/2006 **
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE*
  1817* F.CUADROS   *PREGUNTAS GRUPALES PARA FRAINQGR*
  1818* SEP.11/2007 **
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE*
  1821* F.LOZANO T. *SCORES MENSUALES.*
  1822* OCT.31/2007 **
  1823******************************************************************
  1824* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1825* C.VELASCO   *DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1826* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP*
  1827******************************************************************
  1828* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1829* E.ALVAREZ   *PARA PROCESAR 48 MESES DEL ARCHIVO*
  1830* JUN.19/2009 **
  1831******************************************************************
  1832* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES*
  1833* R.GALVIS    *MAES-DIRECTORY ARCHIVOS ICMVLR*
  1834* JUL.09/2009 *DE 17 A 16 POSICIONES*
  1835** CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1836**CHEQUES*
  1837******************************************************************
  1838* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1839* V.FORERO    *CLIENTES*
  1840* SEP.28/2009 **
  1841******************************************************************
  1842* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1843* C.VELASCO   *MARCAS PRIVADAS PARA TARJETAS*
  1844* OCT.09/2009 **
  1845******************************************************************
  1846* RGH0032* MOD032 - INCLUIR ARCHIVOS DE RECONOCER +*
  1847* R. GALVIS H.  *BDLDIRACE*
  1848* ENE. 01/2010  *BDLMAIEXC*
  1849* INTERSCHEMES. *BDLTELEXC*~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
7025 lines deleted[1] + Stopped (SIGTSTP)        vi icestd81.lst
/d/iccol/desarrollo/fuentes/cobol>^[  /d/iccol/desarrollo/fuentes/cobol>vi icestd81.lstcat icestd81.lst
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*          list("icestd81.lst")
     1*icestd81.cbl.v.01.0002
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.    icestd81-DATACREDITO.
     4 AUTHOR.        DATACREDITO-JAGR.
     5 DATE-WRITTEN.  OCT/2006.
     6 DATE-COMPILED. 21-May-14 10:39.
     7******************************************************************
     8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *
     9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.        *
    10* GER.DESARR.|                                                   *
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.                                *
    15* GER.DESARR.|                                                   *
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
    23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
    25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
    27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
    29*   sh-datainforme
    30*
    31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.                                              GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
    41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43            ASSIGN TO DISK MAES-DIRECC-TITLE
    44            ORGANIZATION IS INDEXED
    45            ACCESS MODE IS DYNAMIC
    46            RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51X           FILE STATUS IS EST-ICBDIR
    52$END
    53            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    54 $SET IDXFORMAT"0"
*   55     COPY BDACSV.FS.                                              GDT0001
    56* BDACSV-FS.V.0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   2
* )d/iccol/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
    57* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
    58* DATOS OFICIALES DE REGIS, DIAN Y DAS
    59     SELECT BDACSV
    60            ASSIGN TO DISK "$DATABASE/BDACSV"
    61            ORGANIZATION IS INDEXED
    62            ACCESS MODE IS DYNAMIC
    63            RECORD KEY IS LLAVE-BDACSV
    64            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*   65     COPY NOAMNISTIA21.FS.                                        GDT0001
    66* NOAMNISTIA21-FS.V.0001
    67* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
    68* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
    69     SELECT NOAMNISTIA21
    70            ASSIGN TO DISK "$DATABASE/NOAMNISTIA21"
    71            ORGANIZATION IS INDEXED
    72            ACCESS MODE IS DYNAMIC
    73            RECORD KEY IS LLAVE-NOAMNISTIA21
    74            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    75*                                                                 GDT0001
*   76     COPY ICBSUS.FS.
    78$SET CONSTANT SW-STATUS-ICBSUS"NO"
    79     SELECT SUSCRIPTOR
    80            ASSIGN TO DISK SUSCRIPTOR-TITLE
    81            ORGANIZATION IS INDEXED
    82            ACCESS MODE IS DYNAMIC
    83            RECORD KEY IS LLAVE-SUSCRIP
    84$IF SW-STATUS-ICBSUS = "NO"
    85$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."
    86$ELSE
    87$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."
    88X           FILE STATUS IS COD-RETORNO-ICBSUS
    89$END
    90            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    91
*   92     COPY ICBCON.FS.
    93* EST005.v.02.002
    94* ARCHIVO QIE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
    95* TIPO 5
    96     SELECT INDEXADO
    97            ASSIGN TO DISK INDEXADO-TITLE
    98            ORGANIZATION IS INDEXED
    99            ACCESS MODE IS DYNAMIC
   100            RECORD KEY IS LLAVE-INDEX
   101            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   102*    COPY  ICBCHK.FS.                                             GDT0002
*  103     COPY  ICBCHK0001.FS.                                         GDT0002
   104*ICBCHK0001.FS.v.01.0001
   105******************************************************************
   106* EST027.v.02.002                                                *
   107* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO*
   108* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                     *
   109******************************************************************
   110 $SET IDXFORMAT"8"
   111
   112     SELECT  MAESTRO-CHECK  ASSIGN TO  MAES-CHECK-TITLE
   113             ORGANIZATION          IS  INDEXED
   114             ACCESS         MODE   IS  DYNAMIC
   115             RECORD         KEY    IS  LLAVE-MAES-CHECK
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   3
* )21.FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   116             LOCK           MODE   IS  MANUAL WITH LOCK ON RECORD.
   117
   118 $SET IDXFORMAT"0"
*  119     COPY ICBCRE.FS.
   120* EST029.v.02.003
   121* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS
   122* POR LOS DIFERENTES SUSCRIPTORES
   123 $SET IDXFORMAT"8"
   124
   125     SELECT MAESTRO-CREDIT
   126            ASSIGN TO DISK MAES-CREDIT-TITLE
   127            ORGANIZATION IS INDEXED
   128            ACCESS MODE IS DYNAMIC
   129            RECORD KEY IS LLAVE-MAES-CREDIT
   130*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT
   131            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   132
   133 $SET IDXFORMAT"0"
*  134     COPY BDIEMSUP0001.FS.
   135* BDIEMSUP-FS.v.0001
   136**********************************************************
   137*MAESTRO DE INFORMACION SUPERINTENDENCIA FORMATO TIPO 8  *
   138**********************************************************
   139 $SET IDXFORMAT"8"
   140     SELECT BDIEMSUP ASSIGN TO DISK TITLE-BDIEMSUP
   141            ORGANIZATION IS INDEXED
   142            ACCESS MODE IS DYNAMIC
   143            RECORD KEY IS BDIEMSUP-LLAVE
   144            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   145 $SET IDXFORMAT"0"
   146
*  147     COPY BDIEENTI.FS.
   148* BDIEENTI-FS.v.0002
   149*******************************************
   150*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
   151*******************************************
   152
   153     SELECT BDIEENTI ASSIGN TO DISK SI-BDIEENTI
   154            ORGANIZATION IS INDEXED
   155            ACCESS IS DYNAMIC
   156            RECORD KEY IS BDIEENTI-LLAVE
   157            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   158
*  159     COPY BDACUE.FS.
   161*****************************************************************
   162* ARCHIVO DE TIPOS DE CUENTA DE DATACREDITO
   163*****************************************************************
   164$SET CONSTANT SW-STATUS-BDACUE"NO"
   165     SELECT BDACUE    ASSIGN TO DISK "$DATABASE/BDACUE"
   166           ORGANIZATION IS LINE SEQUENTIAL
   167           ACCESS MODE IS SEQUENTIAL
   168$IF SW-STATUS-BDACUE = "NO"
   169$DISPLAY ".............COMPILANDO BDACUE SIN STATUS.........."
   170$ELSE
   171$DISPLAY ".............COMPILANDO BDACUE CON STATUS.........."
   172X           FILE STATUS IS COD-RETORNO-BDACUE
   173$END
   174            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   4
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   175     SELECT ENTRADA  ASSIGN TO DISK ARCHIVO-ENTRADA
   176            ORGANIZATION   IS LINE SEQUENTIAL
   177            ACCESS MODE    IS SEQUENTIAL
   178            FILE STATUS    IS W-STATUS-ENT.
   179
   180     SELECT INCONSIS ASSIGN TO DISK ARCHIVO-INCONC
   181            ORGANIZATION   IS LINE SEQUENTIAL
   182            ACCESS MODE    IS SEQUENTIAL
   183            FILE STATUS    IS W-STATUS-INC.
   184
   185     SELECT SALIDA   ASSIGN  TO DISK ARCHIVO-SALIDA
   186            ORGANIZATION   IS LINE SEQUENTIAL
   187            ACCESS MODE    IS SEQUENTIAL.
   188
   189     SELECT ESTADIS  ASSIGN  TO DISK ARCHIVO-ESTADIS
   190            ORGANIZATION   IS LINE SEQUENTIAL
   191            ACCESS MODE    IS SEQUENTIAL.
   192
   193
   194 DATA DIVISION.
   195 FILE SECTION.
*  196 COPY ICBDIR0001.FD.                                              GDT0001
   197* ICBDIR0001-FD.V01.007.
   198* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS
   199* POR LOS DIFERENTES SUSCRIPTORES
   200******************************************************************
   201* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL
   202* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE
   203* FEB.15/2006  * DATACLIENTES.
   204******************************************************************
   205* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *
   206* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *
   207* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *
   208* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *
   209*              *          DIRECCION FUE GEOREFERENCIADA.         *
   210******************************************************************
   211* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *
   212* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *
   213* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *
   214******************************************************************
   215* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *
   216* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*
   217* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *
   218* JUL.25/2008  *                                                 *
   219******************************************************************
   220* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*
   221* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*
   222* SEP/07/2011  *          CIA.                                   *
   223******************************************************************
   224* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *
   225* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *
   226* OCT/25/2012  *          ACTUALIZO.                             *
   227******************************************************************
   228 FD  MAESTRO-DIRECC.
   229 01  REG-DIRECC.
   230     03  LLAVE-DIRECC.
   231         05  LLAVE-PRI-DIRECC.
   232             07  TIPO-ID-DIRECC    PIC 9(01).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   5
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   233             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002
   234         05  LLAVE-ALT-DIRECC.
   235             07  COD-SUS-DIRECC    PIC 9(06).
   236             07  COD-CTA-DIRECC    PIC 9(02).
   237             07  NUM-CTA-DIRECC    PIC X(18).
   238     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   239     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   240     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   241     03  CIURES-DIRECC             PIC X(20).                     FAC0002
   242     03  DPTRES-DIRECC             PIC X(20).                     FAC0002
   243     03  DIRRES-DIRECC             PIC X(60).                     FAC0002
   244     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002
   245     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002
   246     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005
   247     03  CIULAB-DIRECC             PIC X(20).                     FAC0002
   248     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002
   249     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002
   250     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002
   251     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002
   252     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005
   253     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002
   254     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002
   255     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002
   256     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   257     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005
   258     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002
   259     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002
   260     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   261     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005
   262     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   263***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003
   264***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003
   265***  COR-CORRESPONDENCIA)                                         VHF0003
   266***     CER???-DIRECC:                                            VHF0003
   267***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003
   268***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003
   269***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003
   270***     ADI???-DIRECC:                                            VHF0003
   271***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003
   272***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003
   273***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003
   274     03  CERRES-DIRECC             PIC 9(01).                     VHF0003
   275     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003
   276     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003
   277     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003
   278     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003
   279     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003
   280     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004
   281     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005
   282     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005
   283     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005
   284*    03  FILLER-DIRECC             PIC X(40).                     VHF0005
   285*    03  FILLER-DIRECC             PIC X(28).                     RMB0006
   286     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006
   287     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006
   288     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006
   289     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007
   290     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   6
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   291     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007
   292     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007
   293     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007
   294     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007
   295     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007
   296*    03  FILLER-DIRECC             PIC X(13).                     CAV0007
   297     03  FILLER-DIRECC             PIC X(06).                     CAV0007
*  298 COPY BDACSV.FD.                                                  GDT0001
   299* BDACSV-FD.v.0003
   300* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   301* DATOS OFICIALES DE REGIS, DIAN Y DAS
   302******************************************************************
   303* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
   304* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
   305* R.MARTINEZ *          POR T7
   306******************************************************************
   307* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
   308* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE
   309* LUIS GOMEZ *          CONFIABLE
   310******************************************************************
   311 FD  BDACSV.
   312 01  REG-BDACSV.
   313     03 LLAVE-BDACSV.
   314        05  TIPO-ID-BDACSV    PIC 9(01).
   315        05  NUM-ID-BDACSV     PIC 9(15).
   316        05  COD-SUS-BDACSV    PIC 9(06).
   317        05  COD-CTA-BDACSV    PIC 9(02).
   318        05  NUM-CTA-BDACSV    PIC X(25).
   319     03  NOMBRE-BDACSV        PIC X(45).
   320     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003
   321        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003
   322        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003
   323        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003
   324     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
   325     03  FECHA-CREA-BDACSV       PIC 9(08).
   326     03  NUM-PORTAF-BDACSV    PIC 9(02).
   327     03  IND-NOMBRE-BDACSV    PIC 9(02).
   328     03  MEJOR-PORTAF-BDACSV  PIC 9(02).
   329     03  IND-ACTUALIZ-BDACSV  PIC 9(02).
   330     03  FUENTE-REG-BDACSV    PIC 9(02).
   331     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002
   332     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002
   333*    03  FILLER               PIC X(50).                          STT0003
   334     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003
   335         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003
   336         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003
   337         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003
   338         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003
   339         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003
   340         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003
   341         05  IND-SEXO-BDACSV       PIC X.                         STT0003
   342         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003
   343         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003
   344         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003
   345     03  FILLER                    PIC X(07).                     STT0003
   346*    03  FILLER               PIC X(48).
   347
   348
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   7
* ).FD)S)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   349
*  350 COPY NOAMNISTIA21.FD.                                            GDT0001
   351* NOAMNISTIA21-FD.v.0001
   352* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
   353* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
   354******************************************************************
   355******************************************************************
   356 FD  NOAMNISTIA21.
   357 01  REG-NOAMNISTIA21.
   358     03 LLAVE-NOAMNISTIA21.
   359        05  TIPO-ID-NOAMNISTIA21      PIC 9(01).
   360        05  NUM-ID-NOAMNISTIA21       PIC 9(11).
   361     03  FECHA-CREA-NOAMNISTIA21      PIC 9(08).
   362     03  FILLER                       PIC X(10).
   363*                                                                 GDT0001
   364 FD  ENTRADA.
   365 01  REG-ENTRADA.
   366     03 ENT-TIPO-ID               PIC 9(01).
   367     03 ENT-NUME-ID               PIC 9(11).
   368     03 ENT-NOMBRE                PIC X(45).
   369     03 ENT-FEC-EXPED             PIC 9(08).
   370     03 ENT-CIUDAD-EXP            PIC X(15).
   371     03 ENT-DEP-EXP-VAL           PIC X(15).
   372     03 ENT-VIG-VAL               PIC X(02).
   373     03 ENT-GENERO-VAL            PIC X(01).
   374     03 ENT-EDAD                  PIC X(03).
   375     03 ENT-EDAD-RANGO            PIC X(05).
   376     03 FILLER                    PIC X(51).
   377
   378 FD  INCONSIS.
   379 01  REG-INCONSIS.
   380     03 TIP-INC                   PIC 9.
   381     03 CED-INC                   PIC 9(11).
   382     03 NOM1-INC                  PIC X(45).
   383     03 NOM2-INC                  PIC X(45).
   384     03 FEC-EXP-INC               PIC 9(08).
   385     03 MUN-EXP-INC               PIC X(15).
   386     03 DEP-EXP-INC               PIC X(15).
   387     03 VIG-INC                   PIC X(02).
   388     03 CODERR-INC                PIC 9(02).
   389     03 FILLER-2-INC              PIC X(60).
   390
   391
   392 FD  SALIDA.
   393 01  REG-SALIDA.
   394     03 SLD-TIPO-ID                    PIC 9(01).
   395     03 FILLER01                       PIC X(01) VALUE ";".
   396     03 SLD-NUME-ID                    PIC 9(11).
   397     03 FILLER02                       PIC X(01) VALUE ";".
   398     03 SLD-NOMBRE                     PIC X(45).
   399     03 FILLER03                       PIC X(01) VALUE ";".
   400     03 SLD-RANGO-EDAD                 PIC X(05).
   401     03 FILLER04                       PIC X(01) VALUE ";".
   402     03 SLD-GENERO                     PIC X(01).
   403     03 FILLER05                       PIC X(01) VALUE ";".
   404     03 SLD-CIUDAD-EXPED               PIC X(15).
   405     03 FILLER06                       PIC X(01) VALUE ";".
   406     03 SLD-CREDITOS-ACTV              PIC 9(04).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   8
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   407     03 FILLER07                       PIC X(01) VALUE ";".
   408     03 SLD-NUM-OBLIG-CAB              PIC 9(04).
   409     03 FILLER08                       PIC X(01) VALUE ";".
   410     03 SLD-TOT-INICIAL-CAB            PIC 9(15).
   411     03 FILLER09                       PIC X(01) VALUE ";".
   412     03 SLD-TOT-SALDOS-CAB             PIC 9(15).
   413     03 FILLER10                       PIC X(01) VALUE ";".
   414     03 SLD-TOT-CUOTAS-CAB             PIC 9(11).
   415     03 FILLER11                       PIC X(01) VALUE ";".
   416     03 SLD-TOT-MORA-CAB               PIC 9(11).
   417     03 FILLER12                       PIC X(01) VALUE ";".
   418     03 SLD-NUM-OBLIG-CAV              PIC 9(04).
   419     03 FILLER13                       PIC X(01) VALUE ";".
   420     03 SLD-TOT-INICIAL-CAV            PIC 9(15).
   421     03 FILLER14                       PIC X(01) VALUE ";".
   422     03 SLD-TOT-SALDOS-CAV             PIC 9(15).
   423     03 FILLER15                       PIC X(01) VALUE ";".
   424     03 SLD-TOT-CUOTAS-CAV             PIC 9(11).
   425     03 FILLER16                       PIC X(01) VALUE ";".
   426     03 SLD-TOT-MORA-CAV               PIC 9(11).
   427     03 FILLER17                       PIC X(01) VALUE ";".
   428     03 SLD-NUM-OBLIG-OTR              PIC 9(04).
   429     03 FILLER18                       PIC X(01) VALUE ";".
   430     03 SLD-TOT-INICIAL-OTR            PIC 9(15).
   431     03 FILLER19                       PIC X(01) VALUE ";".
   432     03 SLD-TOT-SALDOS-OTR             PIC 9(15).
   433     03 FILLER20                       PIC X(01) VALUE ";".
   434     03 SLD-TOT-CUOTAS-OTR             PIC 9(11).
   435     03 FILLER21                       PIC X(01) VALUE ";".
   436     03 SLD-TOT-MORA-OTR               PIC 9(11).
   437     03 FILLER22                       PIC X(01) VALUE ";".
   438     03 SLD-TOT-NUM-TDC                PIC 9(04).
   439     03 FILLER23                       PIC X(01) VALUE ";".
   440     03 SLD-TOT-CUPOS-TDC              PIC 9(15).
   441     03 FILLER24                       PIC X(01) VALUE ";".
   442     03 SLD-TOT-SALDO-TDC              PIC 9(15).
   443     03 FILLER25                       PIC X(01) VALUE ";".
   444     03 SLD-POR-UTILIZ-TDC             PIC Z.ZZZZZ.
   445     03 FILLER26                       PIC X(01) VALUE ";".
   446     03 SLD-TOT-CUOTAS-TDC             PIC 9(11).
   447     03 FILLER27                       PIC X(01) VALUE ";".
   448     03 SLD-TOT-MORA-TDC               PIC 9(11).
   449     03 FILLER28                       PIC X(01) VALUE ";".
   450     03 SLD-NRO-RANGO-0                PIC 9(03).
   451     03 FILLER29                       PIC X(01) VALUE ";".
   452     03 SLD-NRO-RANGO-1                PIC 9(03).
   453     03 FILLER30                       PIC X(01) VALUE ";".
   454     03 SLD-NRO-RANGO-2                PIC 9(03).
   455     03 FILLER31                       PIC X(01) VALUE ";".
   456     03 SLD-NRO-RANGO-3                PIC 9(03).
   457     03 FILLER32                       PIC X(01) VALUE ";".
   458     03 SLD-NRO-RANGO-4                PIC 9(03).
   459     03 FILLER33                       PIC X(01) VALUE ";".
   460     03 SLD-NRO-RANGO-5                PIC 9(03).
   461     03 FILLER34                       PIC X(01) VALUE ";".
   462     03 SLD-NRO-RANGO-6                PIC 9(03).
   463     03 FILLER35                       PIC X(01) VALUE ";".
   464     03 SLD-FECHA-TDC                  PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   9
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   465     03 FILLER36                       PIC X(01) VALUE ";".
   466     03 SLD-NUM-OBLIG-REAL             PIC 9(04).
   467     03 FILLER37                       PIC X(01) VALUE ";".
   468     03 SLD-TOT-INICIAL-REAL           PIC 9(15).
   469     03 FILLER38                       PIC X(01) VALUE ";".
   470     03 SLD-TOT-SALDOS-REAL            PIC 9(15).
   471     03 FILLER39                       PIC X(01) VALUE ";".
   472     03 SLD-TOT-CUOTAS-REAL            PIC 9(11).
   473     03 FILLER40                       PIC X(01) VALUE ";".
   474     03 SLD-TOT-MORA-REAL              PIC 9(11).
   475     03 FILLER41                       PIC X(01) VALUE ";".
   476     03 SLD-NUM-OBLIG-TELE             PIC 9(04).
   477     03 FILLER42                       PIC X(01) VALUE ";".
   478     03 SLD-TOT-CUOTAS-TELE            PIC 9(11).
   479     03 FILLER43                       PIC X(01) VALUE ";".
   480     03 SLD-TOT-MORA-TELE              PIC 9(11).
   481     03 FILLER44                       PIC X(01) VALUE ";".
   482     03 SLD-NUM-OBLIG-COOP             PIC 9(04).
   483     03 FILLER45                       PIC X(01) VALUE ";".
   484     03 SLD-TOT-INICIAL-COOP           PIC 9(15).
   485     03 FILLER46                       PIC X(01) VALUE ";".
   486     03 SLD-TOT-SALDOS-COOP            PIC 9(15).
   487     03 FILLER47                       PIC X(01) VALUE ";".
   488     03 SLD-TOT-CUOTAS-COOP            PIC 9(11).
   489     03 FILLER48                       PIC X(01) VALUE ";".
   490     03 SLD-TOT-MORA-COOP              PIC 9(11).
   491     03 FILLER49                       PIC X(01) VALUE ";".
   492     03 SLD-NUM-OBLIG-CODEU            PIC 9(04).
   493     03 FILLER50                       PIC X(01) VALUE ";".
   494     03 SLD-TOT-SALDOS-CODEU           PIC 9(15).
   495     03 FILLER51                       PIC X(01) VALUE ";".
   496     03 SLD-TOT-CUOTAS-CODEU           PIC 9(11).
   497     03 FILLER52                       PIC X(01) VALUE ";".
   498     03 SLD-TOT-MORA-CODEU             PIC 9(11).
   499     03 FILLER53                       PIC X(01) VALUE ";".
   500     03 SLD-CREDITOS-ALDIA             PIC 9(03).
   501     03 FILLER54                       PIC X(01) VALUE ";".
   502     03 SLD-MORA-30                    PIC 9(03).
   503     03 FILLER55                       PIC X(01) VALUE ";".
   504     03 SLD-MORA-60                    PIC 9(03).
   505     03 FILLER56                       PIC X(01) VALUE ";".
   506     03 SLD-MORA-90                    PIC 9(03).
   507     03 FILLER57                       PIC X(01) VALUE ";".
   508     03 SLD-MORA-120                   PIC 9(03).
   509     03 FILLER58                       PIC X(01) VALUE ";".
   510     03 SLD-CAR-CASTIGA                PIC 9(03).
   511     03 FILLER59                       PIC X(01) VALUE ";".
   512     03 SLD-DUD-RECAUDO                PIC 9(03).
   513     03 FILLER60                       PIC X(01) VALUE ";".
   514     03 SLD-CUENTAS-COBRADOR           PIC 9(03).
   515     03 FILLER61                       PIC X(01) VALUE ";".
   516     03 SLD-MORA-30-HIS                PIC 9(03).
   517     03 FILLER62                       PIC X(01) VALUE ";".
   518     03 SLD-MORA-60-HIS                PIC 9(03).
   519     03 FILLER63                       PIC X(01) VALUE ";".
   520     03 SLD-MORA-90-HIS                PIC 9(03).
   521     03 FILLER64                       PIC X(01) VALUE ";".
   522     03 SLD-MORA-120-HIS               PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  10
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   523     03 FILLER65                       PIC X(01) VALUE ";".
   524     03 SLD-CANC-MMANEJO               PIC 9(03).
   525     03 FILLER66                       PIC X(01) VALUE ";".
   526     03 SLD-CAR-RECUPERADA             PIC 9(03).
   527     03 FILLER67                       PIC X(01) VALUE ";".
   528     03 SLD-MORA-MAX-TDC               PIC 9(03).
   529     03 FILLER68                       PIC X(01) VALUE ";".
   530     03 SLD-MORA-MAX-CAB               PIC 9(03).
   531     03 FILLER69                       PIC X(01) VALUE ";".
   532     03 SLD-MORA-MAX-COOP              PIC 9(03).
   533     03 FILLER70                       PIC X(01) VALUE ";".
   534     03 SLD-MORA-MAX-CAV               PIC 9(03).
   535     03 FILLER71                       PIC X(01) VALUE ";".
   536     03 SLD-END-CALIF-1-TRIM           PIC X(01).
   537     03 FILLER72                       PIC X(01) VALUE ";".
   538     03 SLD-END-CALIF-2-TRIM           PIC X(01).
   539     03 FILLER73                       PIC X(01) VALUE ";".
   540     03 SLD-CTAS-AHORRO                PIC 9(03).
   541     03 FILLER74                       PIC X(01) VALUE ";".
   542     03 SLD-CTES-CORRIENTES            PIC 9(03).
   543     03 FILLER75                       PIC X(01) VALUE ";".
   544     03 SLD-CTES-EMBARGADAS            PIC 9(03).
   545     03 FILLER76                       PIC X(01) VALUE ";".
   546     03 SLD-CTES-MAL-MANEJO            PIC 9(03).
   547     03 FILLER77                       PIC X(01) VALUE ";".
   548     03 SLD-CTES-SALDADAS              PIC 9(03).
   549     03 FILLER78                       PIC X(01) VALUE ";".
   550     03 SLD-TOTAL-CONSULTAS            PIC 9(03).
   551     03 FILLER79                       PIC X(01) VALUE ";".
   552     03 SLD-CALIFICACION               PIC X(01).
   553*-----------------------------------------------------------*
   554 FD  ESTADIS.
   555 01  REG-ESTADIS.
   556     03 SLD-DETALLE                    PIC X(30).
   557     03 FILLER                         PIC X(01) VALUE ";".
   558     03 SLD-ESTADIS-VALOR-1            PIC Z(11).
   559     03 FILLER                         PIC X(01) VALUE ";".
   560     03 SLD-ESTADIS-VALOR-2            PIC Z(11).
   561     03 FILLER                         PIC X(01) VALUE ";".
   562     03 SLD-ESTADIS-VALOR-3            PIC Z(11).
   563     03 FILLER                         PIC X(01) VALUE ";".
   564     03 SLD-ESTADIS-VALOR-4            PIC Z(11).
   565     03 FILLER                         PIC X(01) VALUE ";".
   566     03 SLD-ESTADIS-VALOR-5            PIC Z(07).
   567
*  568 COPY ICBSUS.FD.
   571*******************************************************************
   572* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR
   573* F.CUADROS *         DATAHOST
   574* FEB.2003  *
   575*******************************************************************
   576* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES
   577* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.
   578* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES
   579******************************************************************
   580* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL
   581* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR
   582* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  11
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   583******************************************************************
   584* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE
   585* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL
   586* ENE. 07/2004 * HABITO DE PAGO.
   587******************************************************************
   588* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE
   589* F.CUADROS C. * FRAUDE
   590* JUN. 04/2004 *
   591******************************************************************
   592* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES
   593* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.
   594* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL
   595*              * A SUI, 2-PASO AUTOMATICO A SUI.
   596******************************************************************
   597* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE
   598* F.CUADROS C. * ENDEUDAMIENTO GLOBAL
   599* MAR. 14/2005 *
   600******************************************************************
   601* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO
   602* R.MARTINEZ   * A TRAVES DE DATA WEB
   603* ABR. 21/2005 *
   604******************************************************************
   605* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS
   606* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-
   607* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO
   608******************************************************************
   609* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *
   610* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *
   611* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *
   612******************************************************************
   613* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *
   614* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *
   615* NOV. 01/2005 *                                                 *
   616******************************************************************
   617* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *
   618* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *
   619* MAR.17/2006  *
   620******************************************************************
   621* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*
   622* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *
   623* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *
   624******************************************************************
   625* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIÓN DE *
   626* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *
   627* JUL.05/2006  *                                                 *
   628******************************************************************
   629* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*
   630* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *
   631* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *
   632******************************************************************
   633* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *
   634* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*
   635* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *
   636******************************************************************
   637* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*
   638* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*
   639* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *
   640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  12
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   641* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *
   642* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *
   643* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *
   644*              * S- SI -DEFAULT
   645******************************************************************
   646* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *
   647* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*
   648* JULIO /2009  *         LIZADOR O NO.                           *
   649******************************************************************
   650* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *
   651* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *
   652* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO ASÍ: 0-NO CERTI*
   653*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *
   654*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*
   655*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *
   656*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *
   657*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *
   658******************************************************************
   659* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS
   660* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *
   661* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*
   662*              *         PRODUCTO) = 0
   663*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO
   664*              *          = 1
   665*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*
   666*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *
   667*              *         CONSULTA DATAHOST O WEBSERVICE          *
   668******************************************************************
   669* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*
   670* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*
   671* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*
   672*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *
   673******************************************************************
   674* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *
   675* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *
   676* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *
   677******************************************************************
   678* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *
   679* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *
   680* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *
   681*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *
   682******************************************************************
   683* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *
   684* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *
   685* FEBRERO/2013 *         DE SUSCRIPTOR.                          *
   686*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *
   687*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*
   688*              *         NUMERO DE TARJETA.                      *
   689*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *
   690******************************************************************
   691 FD  SUSCRIPTOR.
   692 01  REG-SUSCRIPTOR.
   693     03  COD-SUSCRIP-ABD02       PIC 9(6).
   694     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02
   695                                 PIC X(6).
   696     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.
   697     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012
   698     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  13
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   699     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.
   700*        04 FILLER               PIC X(16).                       FAC0012
   701         04 NOM-COR1-ABD02       PIC X(14).
   702         04 NOM-COR2-ABD02       PIC X(14).
   703         04 IND-COR-ABD02        PIC 9.
   704     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009
   705     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.
   706     03  IND-REGIST-ABD02        PIC 99    COMP-3.
   707     03  ESTADO-ABD02            PIC 9     COMP-3.
   708     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.
   709     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.
   710     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.
   711     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.
   712     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5
   713     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1
   714     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1
   715     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017
   716     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015
   717     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008
   718     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008
   719     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008
   720     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009
   721     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009
   722     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009
   723     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009
   724     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009
   725     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010
   726     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011
   727     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013
   728     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014
   729     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016
   730     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018
   731     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019
   732     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020
   733     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021
   734     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022
   735     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023
   736     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024
   737     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025
   738     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026
   739     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027
   740     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028
   741     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029
   742     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029
   743     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030
   744     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030
   745     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031
   746     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031
   747     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032
   748     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033
   749     03  DIRRES-ABD02            PIC X(01).                       RMB0034
   750     03  TELRES-ABD02            PIC X(01).                       RMB0034
   751     03  DIRLAB-ABD02            PIC X(01).                       RMB0034
   752     03  TELLAB-ABD02            PIC X(01).                       RMB0034
   753     03  DIRCOR-ABD02            PIC X(01).                       RMB0034
   754     03  TELCEL-ABD02            PIC X(01).                       RMB0034
   755     03  E-MAIL-ABD02            PIC X(01).                       RMB0034
   756     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  14
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   757     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036
   758     03  FILLER-ABD02-2          PIC X(05).                       CAV0036
   759*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036
   760*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034
   761*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033
*  762 COPY ICBCON.001.FD.
   763* ICBCON-FD.0004
   764* ARCHIVO QUE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
   765* TIPO 5
   766*******************************************************************
   767* RMB003       * FENA001: PARA LAS CONSULTAS REPETIDAS (MISMO DIA *
   768* R.MARTINEZ.  * SUSCRIPTOR, CLAVE) SE DEJA UN SOLA CONSULTA Y LA *
   769* JULIO 30/2001* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   770*              * NUM-CONS-IND.                                    *
   771*----------------------------------------------------------------**
   772* RMB003       * SCR002: PARA MANEJO DE PREFILTRO SE REDEFINEN    *
   773* R.MARTINEZ.  * CAMPOS.                                          *
   774* AGOS. 30/2002* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   775*----------------------------------------------------------------**
   776* GJC0004      * AMPLI1: AMPLIACION DEL ARCHIVO DE CONSULTA DE    *
   777* G.JIMENEZ.   * 50 A 123 POSICIONES, SE AMPLIA CON FILLER DE 50  *
   778* ENE.03/2003  * CARACTERES.                                      *
   779* FAC0004      * INCLUSION DE NUEVOS CAMPOS                       *
   780* ENE.22/2003  *                                                  *
   781*----------------------------------------------------------------**
   782 FD  INDEXADO.
   783*    FILE OF SUCCESSFUL INQUIRIES, FOR BILLING AND SUSPICIOUS
   784*    NUMBER OF CREDIT INQUIRIES
   785 01  REG-INDEX.
   786     03  COD-SUSCRIP-IND         PIC 9(6).
   787     03  FEC-CONSUL-IND          PIC 9(6).
   788     03  LLAVE-INDEX.
   789         05  TIP-ID-IND          PIC 9.
   790         05  NUM-ID-IND          PIC 9(11).
   791         05  CONSECUTIVO-IND     PIC 9(2).
   792*    SCORES 0=score10,1-9= SCORE1-9
   793     03  SCO-PRE-INDEX           PIC 9.
   794     03  CIUDAD-CONS-IND         PIC 9(2).
   795     03  OFICINA-CONS-IND        PIC X(15).
   796     03  NUM-CONS-IND            PIC 99.                           RMB003
   797     03  FILLER-INDEX.
   798         05 PRE-SCORE-INDEX      PIC X VALUE SPACES.
   799         05 PUN-SCORE-INDEX      PIC S9(05) COMP-3.
   800     03  RAZCON-IND              PIC 99.                          GJC0004
   801     03  TIP-SCORE-IND           PIC 9(3).                        FAC0004
   802     03  CLASIFICA-IND           PIC X(2).                        FAC0004
   803     03  CALIFICA-IND            PIC S9(3)V99.                    FAC0004
   804     03  CLAVE-IND               PIC X(5).                        FAC0004
   805     03  CONTADOR-IND            PIC 9(3).                        FAC0004
   806     03  FILLER-1-INDEX          PIC X(50).                       GJC0004
*  807 COPY ICBCHK.FD.
   808* ICBCHK.-FD.v.0009
   809* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO
   810* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES
   811*----------------------------------------------------------------*
   812******************************************************************
   813* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   814* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  15
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   815* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   816* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   817* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   818*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   819*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   820*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   821*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   822******************************************************************
   823* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*
   824* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *
   825*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   826* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *
   827*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   828******************************************************************
   829* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   830* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   831* 04/MAY/2009 *          CREDITO.                                *
   832******************************************************************
   833* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *
   834* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *
   835* 04/ENE/2010 *                                                  *
   836******************************************************************
   837* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   838* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   839* OCTUBRE/2010*          SON MÁS DE 10                           *
   840******************************************************************
   841
   842 FD  MAESTRO-CHECK.
   843*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2
   844 01  COMPLETO-ABD06.
   845     03  LLAVE-MAES-CHECK.
   846         05  LLAVE-MAES-CHECK-PRI.
   847             07  TIPO-ID-ABD06     PIC 9.
   848             07  NUM-ID-ABD06      PIC 9(11).
   849         05  LLAVE-MAES-CHECK-ALT.
   850             07  COD-SUS-ABD06     PIC 9(6).
   851             07  COD-CTA-ABD06     PIC 99.
   852             07  NUM-CTA-ABD06     PIC X(18).
   853     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.
   854     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.
   855     03  CALIFIC-ABD06             PIC 9     COMP-3.
   856     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.
   857     03  NOV-REPORT-ABD06          PIC 99    COMP-3.
   858     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.
   859     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.
   860     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.
   861     03  ADJETIVO-ABD06            PIC 9     COMP-3.
   862     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.
   863     03  ART15-ABD06               PIC 9     COMP-3.
   864     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005
   865         REDEFINES                 ART15-ABD06.                   VHF0005
   866     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.
   867     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005
   868                                   PIC 9(3).                      FAC0005
   869     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005
   870         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005
   871         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006
   872         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  16
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   873
   874     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH
   875*    03  FILLER-ABD06              PIC X(8).                      AMPLIA
   876     03  OFICINA-ABD06             PIC X(15).                     AMPINF5
   877     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5
   879     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004
   880     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008
   881         REDEFINES FEC-NOVANT-ABD06.                              CAV0008
   882     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004
   883*    03  FILLER-ABD06              PIC X(4).                      CAV0007
   884     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007
   885     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007
   886     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007
   887     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009
*  888 COPY ICBCRE.FD.
   889* ICBCRE-FD.v.02.0013
   890* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS
   891* POR LOS DIFERENTES SUSCRIPTORES
   892*----------------------------------------------------------------*
   893******************************************************************
   894* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   895* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   896* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   897* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   898* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   899*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   900*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   901*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   902*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   903******************************************************************
   904* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*
   905* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *
   906*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   907* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *
   908*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   909******************************************************************
   910* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *
   911* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *
   912*             *          CUARTO AÑO DE HISTORIA CREDITICIA       *
   913* 09/AGO/2007 *                                                  *
   914******************************************************************
   915* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   916* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   917* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *
   918*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *
   919*             *          ENDEUDAMIENTO                           *
   920******************************************************************
   921* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   922* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   923* OCTUBRE/2010*          SON MÁS DE 10                           *
   924******************************************************************
   925* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *
   926* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *
   927* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *
   928******************************************************************
   929 FD  MAESTRO-CREDIT.
   930 01  COMPLETO-ABD07.
   931     03  LLAVE-MAES-CREDIT.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  17
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   932         05  LLAVE-MAES-CREDIT-PRI.
   933             07  TIPO-ID-ABD07     PIC 9.
   934             07  NUM-ID-ABD07      PIC 9(11).
   935         05  LLAVE-MAES-CREDIT-ALT.
   936             07  COD-SUS-ABD07     PIC 9(6).
   937             07  COD-CTA-ABD07     PIC 99.
   938             07  NUM-CTA-ABD07     PIC X(18).
   939             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA
   940                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA
   941                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA
   942     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.
   943     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.
   944     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.
   945     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.
   946     03  CALIFIC-ABD07             PIC 9     COMP-3.
   947     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.
   948     03  NOV-REPORT-ABD07          PIC 99    COMP-3.
   949     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.
   950     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.
   951     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.
   952     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AÑO 1   JGR0010
   953         REDEFINES                 ESTADO-MES-ABD07.               JGR0010
   954     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.
   955     03  ADJETIVO1-ABD07           PIC 9     COMP-3.
   956     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.
   957     03  ADJETIVO2-ABD07           PIC 9     COMP-3.
   958     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.
   959     03  ADJETIVO3-ABD07           PIC 9     COMP-3.
   960     03  ART15-ABD07               PIC 9     COMP-3.
   961     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008
   962         REDEFINES                 ART15-ABD07.                   VHF0008
   963     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.
   964     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008
   965                                   PIC 9(3).                      FAC0008
   966     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008
   967         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008
   968         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009
   969         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009
   970         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011
   971            FILLER-RECLAMO-ABD07.                                 GJC0011
   972         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011
   973            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011
   974         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011
   975            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011
   976*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013
   977     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013
   978     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013
   979         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013
   980     03  CALIFIC-R-ABD07           PIC 9     COMP-3.
   981     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.
   982     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007
   983                                   PIC 9     COMP-3.
   984     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.
   985     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.
   986     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.
   987     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007
   988                                   PIC X(02).                     FAC0007
   989     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  18
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   990     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AÑO 3   JGR0010
   991         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010
   992     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.
   993     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA
   994*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011
   995*                              *> CAMPOS                          GJC0011
   996*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011
   997*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011
   998*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011
   999*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011
  1000*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011
  1001*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011
  1002*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011
  1003*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011
  1004     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011
  1005* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011
  1006        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011
  1007        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011
  1008        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1009        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011
  1010        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1011* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011
  1012         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011
  1013         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011
  1014         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011
  1015         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011
  1016         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011
  1017         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011
  1018             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1019         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011
  1020             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1021         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011
  1022         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011
  1023         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011
  1024*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012
  1025         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012
  1026* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011
  1027     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA
  1028     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1029     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1030     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA
  1031     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA
  1032     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA
  1033     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA
  1034     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA
  1035     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA
  1036     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA
  1037     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA
  1038     03  SITUACION-ABD07            PIC X.                         AMPLIA
  1039     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA
  1040     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011
  1041         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011
  1042         05  CAMPOS-TARJETA-ABD07.                                GJC0011
  1043             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011
  1044             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011
  1045                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011
  1046         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012
  1047     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  19
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
  1048     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA
  1049     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1050*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1051     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7
  1052     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA
  1053     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010
  1054         REDEFINES                  VECTOR-2-ABD07.     *> AÑO 2   JGR0010
  1055     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5
  1056     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5
  1057     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5
  1058     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5
  1059     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7
  1060     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002
  1061     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AÑO 4   JGR0010
  1062         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010
  1063
* 1064 COPY BDIEMSUP.FD.
  1065* BDIEMSUP-FD.v.0005
  1066*-------------------------------------------
  1067*  MAESTRO CON INFORMACION SUPERINTENDENCIA
  1068*-------------------------------------------
  1069******************************************************************
  1070* GJC0002   * MICROC: SE ADICIONA VARIABLE DE SUBTIPO DE DEUDA QUE
  1071* G.JIMENEZ * PERMITE IDENTIFICAR LOS MICROCREDITOS Y LAS
  1072* JUN./2003 * FIDUCIAS.
  1073******************************************************************
  1074* RMB0003   * DRP001: SE ADICIONA CAMPO PARA CALCULAR CAMBIO EN
  1075* R.MARTINEZ* EL REGISTRO Y ACTUALIZAR EL DRP
  1076* DIC./2007 *
  1077******************************************************************
  1078* VHF0004     * GARANT - SE MODIFICA FILLER PARA GUARDAR         *
  1079* VICTOR HUGO *          INFORMACION DE GARANTIAS                *
  1080* FORERO      *                                                  *
  1081* SEP.24/2009 *                                                  *
  1082******************************************************************
  1083* LAG0005     * TIPGAR - BDIEMSUP-TIPGAR SE DEJA ALFANUMERICO    *
  1084* VICTOR HUGO *          PARA DEJAR "A" CUANDO VEGA 10, "B"      *
  1085* FORERO      *          CUANDA VENGA 11 Y "C" CUANDO VENGA 12   *
  1086* SEP.24/2009 *                                                  *
  1087******************************************************************
  1088 FD BDIEMSUP.
  1089 01 BDIEMSUP-REGISTRO.
  1090    03 BDIEMSUP-LLAVE.
  1091       05 BDIEMSUP-TIP-ID           PIC 9(1).
  1092       05 BDIEMSUP-NUM-ID           PIC 9(11).
  1093       05 BDIEMSUP-FECHA            PIC 9(8).
  1094       05 BDIEMSUP-TIP-ENTID        PIC 9(2).
  1095       05 BDIEMSUP-COD-ENTID        PIC 9(6).
  1096       05 BDIEMSUP-MONEDA           PIC X(1).
  1097       05 BDIEMSUP-TIP-DEUDA        PIC X(1).
  1098       05 BDIEMSUP-CALIFICA         PIC X(1).
  1099       05 BDIEMSUP-GARANTIA         PIC X(1).
  1100    03 BDIEMSUP-ENCABEZADO.
  1101       05 BDIEMSUP-DESCRIP          PIC X(45).
  1102       05 BDIEMSUP-CIIU             PIC 9(4).
  1103       05 BDIEMSUP-FEC-APERT        PIC 9(8).
  1104       05 BDIEMSUP-SUBTIPO-DEUDA    PIC X.                        GJC0002
  1105       05 FILLER                    PIC X(6).                     GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  20
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDIE
  1106    03 BDIEMSUP-ITEMS REDEFINES BDIEMSUP-ENCABEZADO.
  1107       05 BDIEMSUP-VALOR            PIC S9(14)  COMP-3.
  1108       05 BDIEMSUP-INTERES          PIC S9(14)  COMP-3.
  1109       05 BDIEMSUP-CONTING          PIC S9(14)  COMP-3.
  1110       05 BDIEMSUP-CANTIDAD         PIC 9(3)    COMP-3.
  1111       05 BDIEMSUP-IND-BLOQ         PIC 9(1)    COMP-3.
  1112       05 BDIEMSUP-ART-15           PIC 9(2)    COMP-3.
  1113       05 BDIEMSUP-FEC-ART-15       PIC 9(8)    COMP-3.
  1114       05 BDIEMSUP-FEC-ACTUALIZ     PIC 9(8)    COMP-3.
  1115       05 BDIEMSUP-ART-15-CTI       PIC 9(2)    COMP-3.
  1116       05 BDIEMSUP-FEC-ART-15-CTI   PIC 9(8)    COMP-3.
  1117       05 BDIEMSUP-NUM-RECLAMO      PIC 9(5)    COMP-3.
  1118       05 FILLER-X                  PIC X(14).                    VHF0004
  1119       05 BDIEMSUP-GAR              REDEFINES FILLER-X.           VHF0004
  1120          07 BDIEMSUP-VLRGAR        PIC S9(14)  COMP-3.           VHF0004
  1121          07 BDIEMSUP-TIPGAR        PIC X(1).                     LAG0005
  1122          07 BDIEMSUP-FECGAR        PIC S9(8)   COMP-3.           VHF0004
  1123       05 BDIEMSUP-DRP              PIC X(01).                    VHF0004
* 1124 COPY BDIEENTI.FD.
  1125* BDIEENTI-FD.v.0002
  1126******************************************************************
  1127* JGR0002     * NITENT - SE COMPARTE EL CAMPO NOMBRE DE LA       *
  1128* JAIRO GOMEZ.*          ENTIDAD, PARA PORDER GRABAR EL NUMERO   *
  1129*             *          DE NIT DE LA ENTIDAD REPORTANTE         *
  1130* 09/ENE/2008 *                                                  *
  1131******************************************************************
  1132********************************************
  1133*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
  1134********************************************
  1135
  1136 FD BDIEENTI.
  1137 01 BDIEENTI-REGISTRO.
  1138    03 BDIEENTI-LLAVE.
  1139       05 BDIEENTI-TIP-ENTID        PIC 9(2).
  1140       05 BDIEENTI-COD-ENTID        PIC 9(6).
  1141    03 BDIEENTI-NOM-ENTID.
  1142       05 BDIEENTI-NOMBRE           PIC X(29).                     JGR0002
  1143       05 BDIEENTI-NIT-ENTID        PIC 9(11).                     JGR0002
* 1144 COPY BDACUE.FD.
  1146* BDACUE.v.01.001
  1147*ARCHIVO TIPOS DE CUENTA VS. NOVEDADES Y ADJETIVOS VALIDOS
  1148*----------------------------------------------------------------*
  1149*-TABLA CON 10 OCURRENCIAS QUE CORRESPONDEN A CAMPOS DEL MAESTRO
  1150* RESUMIDO CON RANGO DE VALORES INICIAL Y FINAL PARA VALIDACION
  1151* TAB-RANGOS: EL ORDEN DE LOS CAMPOS ALMACENADOS ES CUOTA-MES,
  1152* VALOR-INICIAL, SALDO-DEUDA, SALDO-MORA, VALOR-DISPONIBLE, CUOTAS-
  1153* CANCELADAS, CUOTAS-EN-MORA, 3 OCURRENCIAS PARA USO FUTURO
  1154* IND-SECTOR-BDACUE: F-FINANCIERO, C-COOPERATIVO, R-REAL
  1155*-TABLA CON 15 INDICADORES DE LOS CAMPOS CONTENIDOS EN EL MAPA DE
  1156* BITS; VALOR=0 SI NO APLICA VALOR=1 SI APLICA AL TIPO DE CUENTA.
  1157*-CAMPOS CONTROL0X USADOS COMO DELIMITADORES.
  1158*----------------------------------------------------------------*
  1159* GJC0002    * NEWACT- PARA NUEVA ACTUALIZACION LOS ADJETIVOS
  1160* G JIMENEZ  *         VAN DE 1 A 9. SE DEFINE NUEVA TABLA DE
  1161* 21-07-2009 *         ADJETIVOS VALIDOS
  1162*****************************************************************
  1163 FD  BDACUE.
  1164 01  REG-BDACUE.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  21
* FD)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
  1165     03  TIP-CTA-BDACUE               PIC 9(2).
  1166     03  DES-CORTA-BDACUE             PIC X(3).
  1167     03  DES-LARGA-BDACUE             PIC X(21).
  1168     03  DES-COMPLETA-BDACUE          PIC X(30).
  1169     03  CONTROL01-BDACUE             PIC X(01).
  1170     03  IND-NOV-BDACUE OCCURS 35     PIC 9(1).
  1171     03  CONTROL02-BDACUE             PIC X(01).
  1172     03  IND-ADJ-BDACUE OCCURS 31     PIC 9(2).
  1173     03  CONTROL03-BDACUE             PIC X(01).
  1174     03  IND-SECTOR-BDACUE            PIC X(1).
  1175     03  CONTROL04-BDACUE             PIC X(01).
  1176     03  TAB-RANGOS-BDACUE OCCURS 10.
  1177         04 VAL-INI-BDACUE            PIC 9(10).
  1178         04 VAL-FIN-BDACUE            PIC 9(10).
  1179     03  CONTROL05-BDACUE             PIC X(01).
  1180     03  TAB-IND-VAL-BDACUE.
  1181         04 VEC-IND-VAL-BDACUE OCCURS 15 TIMES PIC 9.
  1182     03  CONTROL06-BDACUE             PIC X(01).
  1183     03  IND-ADJ-NWACT-BDACUE OCCURS 9 TIMES                      GJC0002
  1184                                      PIC 9.                      GJC0002
  1185     03  CONTROL07-BDACUE             PIC X(1).                   GJC0002
  1186     03  FILLER-BDACUE                PIC X(40).                  GJC0002
  1187
  1188*----------------------------------*
  1189 WORKING-STORAGE SECTION.
  1190*----------------------------------*
  1191 01  W-REG-SALIDA.
  1192     03 W-TIPO-ID                    PIC 9(01).
  1193     03 FILLER                       PIC X(01) VALUE ";".
  1194     03 W-NUME-ID                    PIC 9(11).
  1195     03 FILLER                       PIC X(01) VALUE ";".
  1196     03 W-NOMCLI                     PIC X(45).
  1197     03 FILLER                       PIC X(01) VALUE ";".
  1198     03 W-CALENDPERANT               PIC X(02).
  1199     03 FILLER                       PIC X(01) VALUE ";".
  1200     03 W-CALENDPERACT               PIC X(02).
  1201     03 FILLER                       PIC X(01) VALUE ";".
  1202     03 W-ACIERTA                    PIC 9(05).
  1203     03 FILLER                       PIC X(01) VALUE ";".
  1204     03 W-NUM-CTA                    PIC X(18).
  1205     03 FILLER                       PIC X(01) VALUE ";".
  1206     03 W-DESPRODU                   PIC X(35).
  1207     03 FILLER                       PIC X(01) VALUE ";".
  1208     03 W-SUSCRIPTOTOR               PIC X(40).
  1209     03 FILLER                       PIC X(01) VALUE ";".
  1210     03 W-FECHA-INICIAL              PIC X(06).
  1211     03 FILLER                       PIC X(01) VALUE ";".
  1212     03 W-FECHA-NOVEDAD              PIC X(06).
  1213     03 FILLER                       PIC X(01) VALUE ";".
  1214     03 W-NOVEDAD                    PIC X(10).
  1215     03 FILLER                       PIC X(01) VALUE ";".
  1216     03 W-VECTOR-1                   PIC X(48).
  1217     03 FILLER                       PIC X(01) VALUE ";".
  1218     03 W-VALOR-INI                  PIC 9(07).
  1219     03 FILLER                       PIC X(01) VALUE ";".
  1220     03 W-SALDO-CARTERA              PIC 9(07).
  1221     03 FILLER                       PIC X(01) VALUE ";".
  1222     03 W-SALDO-MORA                 PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  22
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1223     03 FILLER                       PIC X(01) VALUE ";".
  1224     03 W-VALOR-CUOTA                PIC 9(07).
  1225     03 FILLER                       PIC X(01) VALUE ";".
  1226     03 W-TIPOCLI                    PIC X(01).
  1227     03 FILLER                       PIC X(01) VALUE ";".
  1228     03 W-FECHA-VENCIM               PIC X(06).
  1229
  1230 01  W-VARIABLES.
  1231     03 W-VEC-APROBACI.
  1232        05 W-CC-SN            PIC X VALUE SPACES.                      **>
  1233        05 W-DR-SN            PIC X VALUE SPACES.
  1234        05 W-COBRA-SN         PIC X VALUE SPACES.
  1235        05 W-CALI-SN          PIC X VALUE SPACES.
  1236     03 FILLER  REDEFINES W-VEC-APROBACI.
  1237        05 W-VEC-APROBACI-X   PIC X(04).
  1238*
  1239     03 RELLENO                     PIC X(48).
  1240     03 FECHA-AUX                   PIC 9(04).
  1241     03 II                          PIC 9(04).
  1242     03 LL                          PIC 9(04).
  1243     03 TOPE-V                      PIC S9999     VALUE  ZEROS.
  1244     03 W-MESES-NOV                 PIC 9(04)     VALUE  ZEROS.
  1245     03 W-CREDITOS-ACTV             PIC 9(04)     VALUE  ZEROS.
  1246     03 W-NUM-OBLIG-CAB             PIC 9(04)     VALUE  ZEROS.
  1247     03 W-TOT-INICIAL-CAB           PIC 9(15)     VALUE  ZEROS.
  1248     03 W-TOT-SALDOS-CAB            PIC 9(15)     VALUE  ZEROS.
  1249     03 W-TOT-CUOTAS-CAB            PIC 9(11)     VALUE  ZEROS.
  1250     03 W-TOT-MORA-CAB              PIC 9(11)     VALUE  ZEROS.
  1251     03 W-NUM-OBLIG-CAV             PIC 9(04)     VALUE  ZEROS.
  1252     03 W-TOT-INICIAL-CAV           PIC 9(15)     VALUE  ZEROS.
  1253     03 W-TOT-SALDOS-CAV            PIC 9(15)     VALUE  ZEROS.
  1254     03 W-TOT-CUOTAS-CAV            PIC 9(11)     VALUE  ZEROS.
  1255     03 W-TOT-MORA-CAV              PIC 9(11)     VALUE  ZEROS.
  1256     03 W-NUM-OBLIG-OTR             PIC 9(04)     VALUE  ZEROS.
  1257     03 W-TOT-INICIAL-OTR           PIC 9(15)     VALUE  ZEROS.
  1258     03 W-TOT-SALDOS-OTR            PIC 9(15)     VALUE  ZEROS.
  1259     03 W-TOT-CUOTAS-OTR            PIC 9(11)     VALUE  ZEROS.
  1260     03 W-TOT-MORA-OTR              PIC 9(11)     VALUE  ZEROS.
  1261     03 W-TOT-NUM-TDC               PIC 9(04)     VALUE  ZEROS.
  1262     03 W-TOT-CUPOS-TDC             PIC 9(15)     VALUE  ZEROS.
  1263     03 W-TOT-SALDO-TDC             PIC 9(15)     VALUE  ZEROS.
  1264     03 W-SAL-CUPOS-TDC             PIC 9(11)     VALUE  ZEROS.
  1265     03 W-UTLIZACION-TDC            PIC 9(3)V9999 VALUE  ZEROS.
  1266     03 W-TOT-CUOTAS-TDC            PIC 9(11)     VALUE  ZEROS.
  1267     03 W-TOT-MORA-TDC              PIC 9(11)     VALUE  ZEROS.
  1268     03 W-NRO-RANGO-0               PIC 9(03)     VALUE  ZEROS.
  1269     03 W-NRO-RANGO-1               PIC 9(03)     VALUE  ZEROS.
  1270     03 W-NRO-RANGO-2               PIC 9(03)     VALUE  ZEROS.
  1271     03 W-NRO-RANGO-3               PIC 9(03)     VALUE  ZEROS.
  1272     03 W-NRO-RANGO-4               PIC 9(03)     VALUE  ZEROS.
  1273     03 W-NRO-RANGO-5               PIC 9(03)     VALUE  ZEROS.
  1274     03 W-NRO-RANGO-6               PIC 9(03)     VALUE  ZEROS.
  1275     03 W-FEC-MENOR-TDC.
  1276        05 W-ANO-MEN-TDC            PIC 9(04)     VALUE  ZEROS.
  1277        05 W-MES-MEN-TDC            PIC 9(02)     VALUE  ZEROS.
  1278     03 W-FEC-APERTURA.
  1279        05 W-ANO-APERTURA           PIC 9(04)     VALUE  ZEROS.
  1280        05 W-MES-APERTURA           PIC 9(02)     VALUE  ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  23
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1281     03 W-FEC-NOVEDAD.
  1282        05 W-ANO-NOV                PIC 9(04)     VALUE  ZEROS.
  1283        05 W-MES-NOV                PIC 9(02)     VALUE  ZEROS.
  1284     03 W-NUM-OBLIG-REAL            PIC 9(04)     VALUE  ZEROS.
  1285     03 W-TOT-INICIAL-REAL          PIC 9(15)     VALUE  ZEROS.
  1286     03 W-TOT-SALDOS-REAL           PIC 9(15)     VALUE  ZEROS.
  1287     03 W-TOT-CUOTAS-REAL           PIC 9(11)     VALUE  ZEROS.
  1288     03 W-TOT-MORA-REAL             PIC 9(11)     VALUE  ZEROS.
  1289     03 W-NUM-OBLIG-TELE            PIC 9(04)     VALUE  ZEROS.
  1290     03 W-TOT-CUOTAS-TELE           PIC 9(11)     VALUE  ZEROS.
  1291     03 W-TOT-MORA-TELE             PIC 9(11)     VALUE  ZEROS.
  1292     03 W-NUM-OBLIG-COOP            PIC 9(04)     VALUE  ZEROS.
  1293     03 W-TOT-INICIAL-COOP          PIC 9(15)     VALUE  ZEROS.
  1294     03 W-TOT-SALDOS-COOP           PIC 9(15)     VALUE  ZEROS.
  1295     03 W-TOT-CUOTAS-COOP           PIC 9(11)     VALUE  ZEROS.
  1296     03 W-TOT-MORA-COOP             PIC 9(11)     VALUE  ZEROS.
  1297     03 W-NUM-OBLIG-CODEU           PIC 9(04)     VALUE  ZEROS.
  1298     03 W-TOT-SALDOS-CODEU          PIC 9(15)     VALUE  ZEROS.
  1299     03 W-TOT-CUOTAS-CODEU          PIC 9(11)     VALUE  ZEROS.
  1300     03 W-TOT-MORA-CODEU            PIC 9(11)     VALUE  ZEROS.
  1301     03 W-CREDITOS-ALDIA            PIC 9(03)     VALUE  ZEROS.
  1302     03 W-MORAS-30-ACT              PIC 9(03)     VALUE  ZEROS.
  1303     03 W-MORAS-60-ACT              PIC 9(03)     VALUE  ZEROS.
  1304     03 W-MORAS-90-ACT              PIC 9(03)     VALUE  ZEROS.
  1305     03 W-MORAS-120-ACT             PIC 9(03) VALUE ZEROS.
  1306     03 W-CAR-CASTIGA               PIC 9(03) VALUE ZEROS.
  1307     03 W-DUD-RECAUDO               PIC 9(03) VALUE ZEROS.
  1308     03 W-CUENTAS-COBRADOR          PIC 9(03) VALUE ZEROS.
  1309     03 W-MORAS-30-HIS              PIC 9(03) VALUE ZEROS.
  1310     03 W-MORAS-60-HIS              PIC 9(03) VALUE ZEROS.
  1311     03 W-MORAS-90-HIS              PIC 9(03) VALUE ZEROS.
  1312     03 W-MORAS-120-HIS             PIC 9(03) VALUE ZEROS.
  1313     03 W-CANC-MMANEJO              PIC 9(03) VALUE ZEROS.
  1314     03 W-CAR-RECUPERADA            PIC 9(03) VALUE ZEROS.
  1315     03 W-MORA-MAX-TDC              PIC 9(03) VALUE ZEROS.
  1316     03 W-MORA-MAX-CAB              PIC 9(03) VALUE ZEROS.
  1317     03 W-MORA-MAX-COOP             PIC 9(03) VALUE ZEROS.
  1318     03 W-MORA-MAX-CAV              PIC 9(03) VALUE ZEROS.
  1319     03 W-CTAS-AHORROS              PIC 9(03) VALUE ZEROS.
  1320     03 W-CTES-CORRIENTES           PIC 9(03) VALUE ZEROS.
  1321     03 W-CTES-EMBARGADAS           PIC 9(03) VALUE ZEROS.
  1322     03 W-CTES-MAL-MANEJO           PIC 9(03) VALUE ZEROS.
  1323     03 W-CTES-SALDADAS             PIC 9(03) VALUE ZEROS.
  1324     03 W-TOTAL-CONSULTAS           PIC 9(03) VALUE ZEROS.
  1325     03 W-ALDIA-FINA                PIC 9(03) VALUE ZEROS.
  1326     03 W-ALDIA-REAL                PIC 9(03) VALUE ZEROS.
  1327     03 W-ALDIA-COOP                PIC 9(03) VALUE ZEROS.
  1328     03 W-ALDIA-TELE                PIC 9(03) VALUE ZEROS.
  1329     03 W-MORAS-FINA                PIC 9(03) VALUE ZEROS.
  1330     03 W-MORAS-REAL                PIC 9(03) VALUE ZEROS.
  1331     03 W-MORAS-COOP                PIC 9(03) VALUE ZEROS.
  1332     03 W-MORAS-TELE                PIC 9(03) VALUE ZEROS.
  1333     03 W-CC-DR-FINA                PIC 9(03) VALUE ZEROS.
  1334     03 W-CC-DR-REAL                PIC 9(03) VALUE ZEROS.
  1335     03 W-CC-DR-COOP                PIC 9(03) VALUE ZEROS.
  1336     03 W-CC-DR-TELE                PIC 9(03) VALUE ZEROS.
  1337     03 W-EDAD                      PIC 9(03) VALUE ZEROS.
  1338     03 FIN-CHECK                   PIC 9(01) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  24
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1339     03 SALIR-END                   PIC 9(01) VALUE ZEROS.
  1340     03 IND-E                       PIC 9(03) VALUE ZEROS.
  1341     03 F                           PIC 9(01) VALUE ZEROS.
  1342     03 J                           PIC 9(04) VALUE ZEROS.
  1343
  1344     03 W-ENDEUDA                   PIC X(01) VALUE SPACES.
  1345     03 IND-J                       PIC 9(02) VALUE ZEROS.
  1346     03 SW-CODEUDOR                 PIC 9(01) VALUE ZEROS.
  1347     03 TOPE-IND                    PIC 9(03) VALUE ZEROS.
  1348     03 SW-FECHA-LOW                PIC 9(01) VALUE ZEROS.
  1349     03 SW-END                      PIC 9(01) VALUE ZEROS.
  1350     03 FEC-MENOR-TDC               PIC 9(06) VALUE ZEROS.
  1351     03 EVALUA-FINAL                PIC 9(01) VALUE ZEROS.
  1352     03 CONT-LECTURA                PIC 9(03) VALUE ZEROS.
  1353     03 EVALUA-CREDITO              PIC 9(01) VALUE ZEROS.
  1354     03 EVALUA-ENDEUDA              PIC 9(01) VALUE ZEROS.
  1355     03 EVALUA-CTA-CTE              PIC 9(01) VALUE ZEROS.
  1356     03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.
  1357     03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.
  1358     03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.
  1359        05 W-ANO-EXPE               PIC 9(04).
  1360        05 W-MES-EXPE               PIC 9(02).
  1361        05 W-DIA-EXPE               PIC 9(02).
  1362     03 W-ACU-MMAX-TDC              PIC 9(03) VALUE ZEROS.
  1363     03 W-ACU-MMAX-CAB              PIC 9(03) VALUE ZEROS.
  1364     03 W-ACU-MMAX-COOP             PIC 9(03) VALUE ZEROS.
  1365     03 W-ACU-MMAX-CAV              PIC 9(03) VALUE ZEROS.
  1366     03 TEM-NRO-CTA.
  1367        05 TEM-NRO-CTA-C16          PIC X(16) VALUE ZEROS.
  1368        05 TEM-NRO-CTA-C17          PIC X(01) VALUE ZEROS.
  1369        05 TEM-NRO-CTA-C18          PIC X(01) VALUE ZEROS.
  1370     03 W-SUSCRIPTOR.
  1371        05 W-CODIGO-TIPOCTA         PIC 9(02).
  1372        05 W-CODIGO-RESTCTA         PIC 9(04).
  1373     03 W-TABLA-END-MAYOR.
  1374        05 W-TRIMESTRE-END  OCCURS   3 TIMES.
  1375           07 W-FECHA-END           PIC 9(08).
  1376           07 W-MAYOR-END           PIC X(01).
  1377     03 W-TABLA-SUS-CONSU.
  1378        05 W-SUS-CONSU      OCCURS  50 TIMES PIC 9(06).
  1379     03 W-FECHA-AUX                 PIC  9(04).
  1380     03 W-FECHA-AUX-R REDEFINES W-FECHA-AUX.
  1381        05 W-MES-AUX                PIC  9(02).
  1382        05 W-ANO-AUX                PIC  9(02).
  1383     03 W-FECHA-AUX1              PIC 9(06) VALUE ZEROS.
  1384     03 W-FECHA-AUX1-R REDEFINES W-FECHA-AUX1.
  1385        05 W-MES-AUX1             PIC 9(02).
  1386        05 W-ANO-AUX1             PIC 9(04).
  1387     03 W-FECHA-OK                PIC 9(06) VALUE ZEROS.
  1388     03 W-FECHA-OK-R REDEFINES W-FECHA-OK.
  1389        05 W-SLGANO-OK            PIC 9(04).
  1390        05 W-SLGANO-OK-R REDEFINES W-SLGANO-OK.
  1391           07 W-SGL-OK            PIC 9(02).
  1392           07 W-ANO-OK            PIC 9(02).
  1393        05 W-MES-OK               PIC 9(02).
  1394     03 W-FECHA-FINAL             PIC 9(06) VALUE ZEROS.
  1395     03 W-FECHA-APERTURA          PIC 9(06) VALUE ZEROS.
  1396
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  25
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1397*-------------------------------------------------------------*
  1398  01 FECHAS-AAAAMM.
  1399    02 FECHA-TAG                   PIC 9(6).
  1400    02 FILLER REDEFINES FECHA-TAG.
  1401       03 SIG-ANO-TAG              PIC 9(4).
  1402       03 FILLER REDEFINES SIG-ANO-TAG.
  1403          04 SIG-TAG               PIC 9(2).
  1404          04 ANO-TAG               PIC 9(2).
  1405       03 MES-TAG                  PIC 9(2).
  1406    02 FECHA-NOVEDAD07             PIC 9(6).
  1407    02 FILLER REDEFINES FECHA-NOVEDAD07.
  1408       03 SIG-ANO-NOV              PIC 9(4).
  1409       03 FILLER REDEFINES SIG-ANO-NOV.
  1410          04 SIG-NOV               PIC 9(2).
  1411          04 ANO-NOV               PIC 9(2).
  1412       03 MES-NOV                  PIC 9(2).
  1413    02 FECHA-APERTURA07            PIC 9(6).
  1414    02 FILLER REDEFINES FECHA-APERTURA07.
  1415       03 SIG-ANO-APE              PIC 9(4).
  1416       03 FILLER REDEFINES SIG-ANO-APE.
  1417          04 SIG-APE               PIC 9(2).
  1418          04 ANO-APE               PIC 9(2).
  1419       03 MES-APE                  PIC 9(2).
  1420    02 FECHA-VENCIMIENTO07         PIC 9(6).
  1421    02 FILLER REDEFINES FECHA-VENCIMIENTO07.
  1422       03 SIG-ANO-VEN              PIC 9(4).
  1423       03 FILLER REDEFINES SIG-ANO-VEN.
  1424          04 SIG-VEN               PIC 9(2).
  1425          04 ANO-VEN               PIC 9(2).
  1426       03 MES-VEN                  PIC 9(2).
  1427   02 FECHA-INGRESO               PIC 9(6).
  1428    02 FILLER REDEFINES FECHA-INGRESO.
  1429       03 SIG-ANO-ING              PIC 9(4).
  1430       03 FILLER REDEFINES SIG-ANO-ING.
  1431          04 SIG-ING               PIC 9(2).
  1432          04 ANO-ING               PIC 9(2).
  1433       03 MES-ING                  PIC 9(2).
  1434 01  FECHA-SITMMAAAA-ORI     PIC 9(6).
  1435 01  FILLER REDEFINES FECHA-SITMMAAAA-ORI.
  1436     03 FECHA-SITMM-ORI      PIC 9(2).
  1437     03 FECHA-SITAAAA-ORI    PIC 9(4).
  1438 01  FECHA-SITAAAAMM         PIC 9(6).
  1439 01  FILLER REDEFINES FECHA-SITAAAAMM.
  1440     03 FECHA-SITAAAA        PIC 9(4).
  1441     03 FECHA-SITMM          PIC 9(2).
  1442 01  FECHA-VALAAAAMM         PIC 9(6).
  1443 01  FILLER REDEFINES FECHA-VALAAAAMM.
  1444     03 FECHA-VALAAAA        PIC 9(4).
  1445     03 FECHA-VALMM          PIC 9(2).
  1446*---------------------------------------------------------------*
  1447 01  W-FECHA-MILENIO.
  1448     03 W-FMILENIO-SIGLO            PIC  9(02).
  1449     03 W-FMILENIO-ANIO             PIC  9(02).
  1450     03 W-FMILENIO-MES              PIC  9(02).
  1451*----------------------------------------------------------------*
  1452 01  W-CONSTANTES.
  1453     03 SW-READ-INC                 PIC 9(01) VALUE ZEROS.
  1454     03 W-IND                       PIC 9(02) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  26
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1455     03 LEIDOS                      PIC 9(08) VALUE ZEROS.
  1456     03 GRABADOS                    PIC 9(08) VALUE ZEROS.
  1457     03 END-RUN                     PIC X(01) VALUE " ".
  1458     03 W-STATUS-ENT                PIC 9(02) VALUE ZEROS.
  1459     03 W-STATUS-INC                PIC 9(02) VALUE ZEROS.
  1460*
  1461     03 W-RESET-LEIDOS              PIC 9(09) VALUE 9.
  1462     03 W-LEIDOS                    PIC 9(09) VALUE ZEROS.
  1463     03 W-LEIDOS-RED REDEFINES W-LEIDOS.
  1464        05 FILLER                   PIC 9(06).
  1465        05 CEROS                    PIC 9(03).
  1466     03 W-GRABADOS                  PIC 9(09) VALUE ZEROS.
  1467     03 W-SOLO-CODEUDORES           PIC 9(09) VALUE ZEROS.
  1468     03 W-SOLO-COOPERATIVAS         PIC 9(09) VALUE ZEROS.
  1469     03 W-SOLO-CERRADOS             PIC 9(09) VALUE ZEROS.
  1470     03 W-MORA-TOT-SEC-FINA         PIC 9(09) VALUE ZEROS.
  1471     03 W-MORA-TOT-SEC-REAL         PIC 9(09) VALUE ZEROS.
  1472     03 W-MORA-TOT-REAL-FINA        PIC 9(09) VALUE ZEROS.
  1473
  1474     03 W-FECHA-BASE                PIC 9(06) VALUE ZEROS.
  1475     03 W-OPCION                    PIC X(01) VALUE SPACES.
  1476     03 W-VECTOR-L                  PIC 9(02) VALUE 12.
  1477     03 END-RUN                     PIC X(01) VALUE SPACES.
  1478     03 W-CC                        PIC 9(05) VALUE ZEROS.
  1479     03 W-DR                        PIC 9(05) VALUE ZEROS.
  1480     03 W-COBRA                     PIC 9(05) VALUE ZEROS.
  1481     03 W-CALI                      PIC X(01) VALUE ZEROS.
  1482
  1483*------------------------------------------------------------*
  1484*     AREA WORK ACUMULADORES
  1485*------------------------------------------------------------*
  1486 01  W-ACUMULADORES-ESTA.
  1487     03 W-EDITOR-CON                PIC Z,ZZZ,ZZ9.
  1488     03 W-EDITOR-SIN                PIC Z,ZZZ,ZZ9.
  1489     03 W-EDITOR-INC                PIC Z,ZZZ,ZZ9.
  1490     03 W-EDITOR-TOT                PIC Z,ZZZ,ZZ9.
  1491     03 W-CON-INFORMACION           PIC 9(07) VALUE ZEROS.
  1492     03 W-SIN-INFORMACION           PIC 9(07) VALUE ZEROS.
  1493     03 W-INCONSISTENCIAS           PIC 9(07) VALUE ZEROS.
  1494*----------------------------------------------------------------*
  1495*     VARIABLES DEL MANEJO DE BDACUE                             *
  1496*----------------------------------------------------------------*
  1497 01  VAL-VARIABLES.
  1498     03  W-CTA-BDCUE                 PIC 9(02) VALUE ZEROS.
  1499     03  SW-LOAD-TBL                 PIC 9(01) VALUE ZEROS.
  1500     03  T                           PIC 9(04) VALUE ZEROS.
  1501     03  TOPE-T                      PIC 9(04) VALUE ZEROS.
  1502     03  TABLA-VAL-TIP-CTA OCCURS 100 TIMES.
  1503         04 VEC-VALOR-BDACUE OCCURS 15 TIMES PIC 9.
  1504*----------------------------------------------------------------*
  1505*     VARIABLES ESTADISTICAS                                     *
  1506*----------------------------------------------------------------*
  1507 01  W-ACUMULADORES-ESTA.
  1508     03 W-ESTADO-INF          OCCURS  3 TIMES.
  1509        05 W-TABLA-TIPO-ID    OCCURS  5 TIMES.
  1510           07 W-ACUM-TIPO-ID    PIC  9(07) VALUE ZEROS.
  1511*------------------------------------------------------------*
  1512*    ACUMULACION VARIABLES DEMOGRAFICAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  27
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1513*------------------------------------------------------------*
  1514     03 W-EDAD-66           PIC  9(07) VALUE ZEROS.
  1515     03 W-EDAD-56-65        PIC  9(07) VALUE ZEROS.
  1516     03 W-EDAD-46-55        PIC  9(07) VALUE ZEROS.
  1517     03 W-EDAD-36-45        PIC  9(07) VALUE ZEROS.
  1518     03 W-EDAD-29-35        PIC  9(07) VALUE ZEROS.
  1519     03 W-EDAD-22-28        PIC  9(07) VALUE ZEROS.
  1520     03 W-EDAD-18-21        PIC  9(07) VALUE ZEROS.
  1521*------------------------------------------------------------*
  1522*    ACUMULACION ESTADO ACTUAL
  1523*------------------------------------------------------------*
  1524     03 W-TOT-CAR-CASTIGA      PIC  9(07) VALUE ZEROS.
  1525     03 W-TOT-DUD-RECAUDO      PIC  9(07) VALUE ZEROS.
  1526     03 W-TOT-CTES-EMBARGADAS  PIC  9(07) VALUE ZEROS.
  1527     03 W-TOT-MORAS-120-ACT    PIC  9(07) VALUE ZEROS.
  1528     03 W-TOT-MORAS-90-ACT     PIC  9(07) VALUE ZEROS.
  1529     03 W-TOT-MORAS-60-ACT     PIC  9(07) VALUE ZEROS.
  1530     03 W-TOT-MORAS-30-ACT     PIC  9(07) VALUE ZEROS.
  1531     03 W-TOT-W-ENDEUDA        PIC  9(07) VALUE ZEROS.
  1532     03 W-TOT-ALDIA            PIC  9(07) VALUE ZEROS.
  1533     03 W-TOT-SIN-CTAS         PIC  9(07) VALUE ZEROS.
  1534*------------------------------------------------------------*
  1535*    ACUMULACION ESTADO SECTOR
  1536*------------------------------------------------------------*
  1537     03 W-TOT-CC-DR-FINA       PIC  9(07) VALUE ZEROS.
  1538     03 W-TOT-MORAS-FINA       PIC  9(07) VALUE ZEROS.
  1539     03 W-TOT-ALDIA-FINA       PIC  9(07) VALUE ZEROS.
  1540     03 W-TOT-CC-DR-REAL       PIC  9(07) VALUE ZEROS.
  1541     03 W-TOT-MORAS-REAL       PIC  9(07) VALUE ZEROS.
  1542     03 W-TOT-ALDIA-REAL       PIC  9(07) VALUE ZEROS.
  1543     03 W-TOT-CC-DR-COOP       PIC  9(07) VALUE ZEROS.
  1544     03 W-TOT-MORAS-COOP       PIC  9(07) VALUE ZEROS.
  1545     03 W-TOT-ALDIA-COOP       PIC  9(07) VALUE ZEROS.
  1546     03 W-TOT-CC-DR-TELE       PIC  9(07) VALUE ZEROS.
  1547     03 W-TOT-MORAS-TELE       PIC  9(07) VALUE ZEROS.
  1548     03 W-TOT-ALDIA-TELE       PIC  9(07) VALUE ZEROS.
  1549*------------------------------------------------------------*
  1550*    ACUMULACION VALORES TOTALES
  1551*------------------------------------------------------------*
  1552     03 W-SALDOS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1553     03 W-CUOTAS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1554     03 W-MORAS-SEC-FINA       PIC  9(15) VALUE ZEROS.
  1555     03 W-SALDOS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1556     03 W-CUOTAS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1557     03 W-MORAS-SEC-REAL       PIC  9(15) VALUE ZEROS.
  1558     03 W-SALDOS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1559     03 W-CUOTAS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1560     03 W-MORAS-SEC-COOP       PIC  9(15) VALUE ZEROS.
  1561
  1562*---------------------------------------------------------*
  1563 01  W-PARAMETROS              PIC  X(94) VALUE SPACES.
  1564*---------------------------------------------------------*
  1565
  1566*----------------------------------------------------------------*
  1567* Estas son las variables para analizar los vectores de          *
  1568* comportamiento de moras HISTORICAS (estado-mes-abd07) y        *
  1569* (vector-2-abd07)                                               *
  1570*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  28
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1571 01  WS-ESTADO-MES-1                        PIC 9(12).
  1572 01  WS-ESTADO-MES-2                        PIC 9(12).
  1573 01  WS-ESTADO-MES                          PIC 9(12).
  1574 01  WS-ESTADO-MES-R REDEFINES WS-ESTADO-MES.
  1575     03  WS-MES                             PIC X OCCURS 12 TIMES.
  1576 01  ESTADO-MES-IMP.
  1577     03  E-MES-IMP                          PIC X OCCURS 12 TIMES.
  1578
  1579 01  ESTADO-ANUAL.
  1580     03  CHAR-H                             PIC X OCCURS 12 TIMES.
  1581 01  I                                      PIC 9(3)   VALUE ZERO.
  1582
  1583 01  E                                      PIC 9(3)   VALUE ZERO.
  1584 01  K                                      PIC 9(4)   VALUE 01.
  1585 01  N                                      PIC 9(3)   VALUE ZERO.
  1586 01  TIV                                    PIC 9(3)   VALUE ZERO.
  1587 01  TFV                                    PIC 9(3)   VALUE ZERO.
  1588 01  F-AUX-1                                PIC 9(4)   VALUE ZERO.
  1589 01  F-AUX                                  PIC 9(4)   VALUE ZERO.
  1590 01  F-UACT-2                               PIC 9(4)   VALUE ZERO.
  1591 01  F-APE-7                                PIC 9(4)   VALUE ZERO.
  1592 01  F-ING-2                                PIC 9(4)   VALUE ZERO.
  1593 01  F-NOV-7                                PIC 9(4)   VALUE ZERO.
  1594 01  F-VIEJ                                 PIC 9(4)   VALUE ZERO.
  1595 01  ENCONTRO                               PIC 9(1)   VALUE ZERO.
  1596*01  RELLENO                                PIC 9(1)   VALUE ZERO.
  1597 01  CINCO                                  PIC 9(2)   VALUE 5.
  1598 01  NUEVO                                  PIC 9      VALUE 0.
  1599 01  COD-SUSCRIP-AUX                        PIC 9(6)   VALUE ZERO.
  1600*------------------------------------------------------------*
  1601 01  VECTOR-S.
  1602     03 VECTOR-A-R1                        PIC X(24).
  1603     03 VECTOR-A-R2                        PIC X(24).
  1604 01  VECTOR-S-12.
  1605     03 VECTOR-N-R1                        PIC X(24).
  1606     03 VECTOR-N-R2                        PIC X(24).
  1607*------------------------------------------------------------*
  1608  01 V-NOR.
  1609     02 V-NOR1                     PIC 9(12).
  1610     02 V-NOR2                     PIC 9(12).
  1611     02 V-NOR3                     PIC 9(12).
  1612     02 V-NOR4                     PIC 9(12).
  1613  01 V-NOR-AUX     PIC X(47) VALUE SPACES.
  1614
  1615  01 VECTORES-W.
  1616    02 VECTOR-MORA.
  1617       03 FILLER PIC X(25) VALUE "5PMPPPPPPPPP5555123411212".
  1618       03 FILLER PIC X(25) VALUE "3234123412341234999CRD999".
  1619    02 FILLER REDEFINES VECTOR-MORA.
  1620       03 V-MORA OCCURS 50 TIMES PIC X.
  1621*------------------------------------------------------------*
  1622 01  SALIDA-48.
  1623     05 S48-EST                     PIC X(15).
  1624     05 S48-SUS                     PIC X(14).
  1625     05 S48-FEC                     PIC 9(6).
  1626     05 S48-FECALPHA REDEFINES S48-FEC    PIC X(6).
  1627     05 S48-AVA                     PIC X(9).
  1628     05 S48-VEC                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  29
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1629     05 S48-VEC-12                  PIC X(12).
  1630*------------------------------------------------------------*
  1631 01  F-APE-07                      PIC 9999.
  1632 01  F-APE-07-R                    REDEFINES F-APE-07.
  1633     03  M-APE-07                  PIC 99.
  1634     03  A-APE-07                  PIC 99.
  1635*------------------------------------------------------------*
  1636 01  F-ING-02                      PIC 9999.
  1637 01  F-ING-02-R                    REDEFINES F-ING-02.
  1638     03  M-ING-02                  PIC 99.
  1639     03  A-ING-02                  PIC 99.
  1640 01  F-NOV-07                      PIC 9999.
  1641 01  F-NOV-07-R                    REDEFINES F-NOV-07.
  1642     03  M-NOV-07                  PIC 99.
  1643     03  A-NOV-07                  PIC 99.
  1644*---------------------------------------------------------------*
  1645 01  W-FECHA-APE.
  1646     03  W-ANIO-APE                PIC 9(04).
  1647     03  W-MES-APE                 PIC 9(02).
  1648*---------------------------------------------------------------*
  1649 01  W-FECHA-HOY                   PIC X(08).
  1650 01  W-FECHA-HOY-R                 REDEFINES W-FECHA-HOY.
  1651     03  W-ANO-HOY                 PIC 9(04).
  1652     03  W-MES-HOY                 PIC 9(02).
  1653     03  W-DIA-HOY                 PIC 9(02).
  1654 01  CAL-NRO-MESES                 PIC S9(05).
  1655*---------------------------------------------------------------*
  1656 01  F-UACT-02                     PIC 9999.
  1657 01  F-UACT-02-R                   REDEFINES F-UACT-02.
  1658     03  M-UACT-02                 PIC 99.
  1659     03  A-UACT-02                 PIC 99.
  1660 01  WS-EST-MES.
  1661     03  WS-MES-NUEV               PIC 9.
  1662     03  WS-MESES-VIEJ             PIC 9(12).
  1663 01  WS-EST-MES-R REDEFINES WS-EST-MES.
  1664     03  WS-MESES-NUEV             PIC 9(12).
  1665     03  WS-MES-VIEJ               PIC 9.
  1666 01  FN.
  1667     03  FEC-NOV-S                 PIC 9(4)   VALUE ZERO.
  1668     03  FEC-NOV-RED-S REDEFINES FEC-NOV-S
  1669                                   PIC X(04).
  1670 01 ANO-2000                       PIC 99  VALUE 0.
  1671 01  SCREEN-HEADER.
  1672     03  FILLER                    PIC X(30) VALUE SPACES.
  1673     03  FILLER                    PIC X(20) VALUE
  1674         "=== DATA CREDITO ===" .
  1675     03  FILLER                    PIC X(30) VALUE SPACES.
  1676 01  SCREEN-TITLE REDEFINES SCREEN-HEADER PIC X(80).
  1677 01  MULT-TABLA OCCURS 200 TIMES.
  1678     03 MULT-CODIGO                PIC 9(6).
  1679     03 MULT-CLAVE                 PIC X(5).
  1680     03 MULT-TERMINAL              PIC 9(4).
  1681     03 MULT-PRODUCTO              PIC 9(2).
  1682     03 MULT-MODALIDAD             PIC 9(2).
  1683     03 MULT-ESTADO                PIC 9.
  1684     03 MULT-TTY                   PIC X(8).
  1685     03 MULT-SESION                PIC X(4) COMP-5.
  1686     03 MULT-PRIV-CLAVE            PIC 9(1).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  30
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1687     03 MULT-PRO-EXCLU             PIC 9(1).
  1688     03 MULT-NOM-SUS               PIC X(14).
  1689     03 MULT-NIT                   PIC 9(11) COMP-3.
  1690 01  NOM-COR-AUX             PIC X(14) VALUE SPACES.
  1691 01  FILLER REDEFINES NOM-COR-AUX.
  1692      02 NOM-COR-AUXN        PIC 9(6).
  1693      02 FILLER              PIC X(8).
  1694 01  NOM-COR-AUX2            PIC X(14) VALUE SPACES.
  1695 01  MENSAJE-CS.
  1696     02 HEADER.
  1697       03 HEADER-USUARIO           PIC X(10).
  1698       03 HEADER-TIPO-MENSAJE      PIC 9.
  1699       03 HEADER-LSN               PIC 9(4).
  1700       03 HEADER-LONGITUD          PIC 9(4).
  1701       03 HEADER-TERMINAL          PIC X(8).
  1702       03 HEADER-NOMB-PROG         PIC X(6).
  1703       03 HEADER-FILA              PIC 99.
  1704       03 HEADER-COLUMNA           PIC 99.
  1705       03 HEADER-CARACT-INICIO     PIC 9.
  1706       03 HEADER-CARACT-FIN        PIC 9.
  1707       03 HEADER-TIPO-TERMINAL     PIC X(6).
  1708       03 HEADER-FILLER            PIC X(5).
  1709    02 TEXTO                       PIC X(2000).
  1710    02 TEXTO-INPUT REDEFINES TEXTO.
  1711       03 AREA-INPUT               PIC X(80).
  1712       03 FILLER                   PIC X(1920).
  1713*-----------------------------------------------------------*
  1714 01  TABLA-HISTORICA-MORAS.
  1715     03 w-moras-historicas-v       pic X(48) value zeros.
  1716     03 w-moras-historicas-v-r redefines w-moras-historicas-v.
  1717        05 w-moras-historicas occurs 48 times pic X(01).
  1718 01  ARRASTRE                      PIC 9 VALUE ZEROS.
  1719*------------------------------------------------------------*
* 1720 COPY ICFILE.WS.
  1721* ICFILE-WS.v.0043.
  1722* COPY PARA DIRECCIONAR LOS ARCHIVOS.
  1723*****************************************************************
  1724* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS
  1725*R.MARTINEZ   * UNIVERSAL.
  1726******************************************************************
  1727* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *
  1728* VICTOR HUGO *                                                  *
  1729* FORERO      *                                                  *
  1730* DIC.01/2000 *                                                  *
  1731******************************************************************
  1732* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *
  1733* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *
  1734* FORERO      * NOMREG - REGISTRADURIA                           *
  1735* SEP.10/2001 * NOMDAS - DAS                                     *
  1736*             * NMDIAN - DIAN                                    *
  1737******************************************************************
  1738* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *
  1739* VICTOR HUGO * BYINGTON                                         *
  1740* FORERO      *                                                  *
  1741* FEB.18/2002 *                                                  *
  1742******************************************************************
  1743* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *
  1744* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  31
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1745* SEP.04/2002 *                                                  *
  1746* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*
  1747* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *
  1748* OCT.29/2002 *                                                  *
  1749******************************************************************
  1750* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *
  1751* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *
  1752* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *
  1753* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*
  1754*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *
  1755*             *          ENTRADA-ENTIDAD                         *
  1756*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *
  1757* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *
  1758*             *          CIONES Y TELEFONOS                      *
  1759*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1760*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1761*             *          RRIENTES CON RECLAMOS VIGENTES          *
  1762******************************************************************
  1763* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1764* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1765* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*
  1766*             *          NOMBRE                                  *
  1767******************************************************************
  1768* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *
  1769* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *
  1770* FEB.14/2003 *                                                  *
  1771******************************************************************
  1772* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1773* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *
  1774* MAR.03/2003 *          CON NUEVOS DISENOS.                     *
  1775******************************************************************
  1776* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *
  1777* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *
  1778* JUN.05/2003 *                                                  *
  1779* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *
  1780* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *
  1781* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *
  1782******************************************************************
  1783* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1784* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *
  1785* JUL.09/2003 *          en $TRABAJO/logs                        *
  1786******************************************************************
  1787* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*
  1788* G.JIMENEZ  .*                                                  *
  1789* SEP.11/2003 *                                                  *
  1790******************************************************************
  1791* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *
  1792* G.JIMENEZ  .*                                                  *
  1793* OCT.14/2004 *                                                  *
  1794******************************************************************
  1795* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1796* G.JIMENEZ   *          PRODUCTOS                               *
  1797* ABR/2005    *                                                  *
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1800* F.CUADROS   *          FRAINQ.DAT                              *
  1801* JUN.23/2005 *                                                  *
  1802******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *
  1804* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *
  1805* SEP.02/2005 *                                                  *
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *
  1808* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *          TIPO 8                                  *
  1810*             *                                                  *
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *
  1814* OCT.17/2006 *                                                  *
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *
  1817* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *
  1818* SEP.11/2007 *                                                  *
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *
  1821* F.LOZANO T. *          SCORES MENSUALES.                       *
  1822* OCT.31/2007 *                                                  *
  1823******************************************************************
  1824* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1825* C.VELASCO   *          DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1826* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP        *
  1827******************************************************************
  1828* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1829* E.ALVAREZ   *          PARA PROCESAR 48 MESES DEL ARCHIVO      *
  1830* JUN.19/2009 *                                                  *
  1831******************************************************************
  1832* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES        *
  1833* R.GALVIS    *          MAES-DIRECTORY ARCHIVOS ICMVLR          *
  1834* JUL.09/2009 *          DE 17 A 16 POSICIONES                   *
  1835*             * CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1836*             *          CHEQUES                                 *
  1837******************************************************************
  1838* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1839* V.FORERO    *          CLIENTES                                *
  1840* SEP.28/2009 *                                                  *
  1841******************************************************************
  1842* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1843* C.VELASCO   *          MARCAS PRIVADAS PARA TARJETAS           *
  1844* OCT.09/2009 *                                                  *
  1845******************************************************************
  1846* RGH0032       * MOD032 - INCLUIR ARCHIVOS DE RECONOCER +       *
  1847* R. GALVIS H.  *          BDLDIRACE                             *
  1848* ENE. 01/2010  *          BDLMAIEXC                             *
  1849* INTERSCHEMES. *          BDLTELEXC                             *
  1850******************************************************************
  1851* LAG0033       * SCOPRE - INCLUIR ARCHIVO SCOREPREC             *
  1852* AGO. 02/2010  *          BDLMAIEXC                             *
  1853* G.DESARROLLO  *          BDLTELEXC                             *
  1854* GJC0033       * FRZMYR - SE INCLUYE MANEJO DE ARCHIVO DE DES-  *
  1855* G.JIMENEZ     *          PLAZADOS Y SECUESTRADOS - FUERZA MA-  *
  1856* OCT./2010     *          YOR                                   *
  1857******************************************************************
  1858* GJC0034       * BDANOM - SE INCLUYE MANEJO DE ARCHIVO DE POR-  *
  1859* G.JIMENEZ     *          CENTAJE DE NOMBRES Y APELLIDOS BDANOM *
  1860* FEB./2011     *                                                *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  33
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1861******************************************************************
  1862* CAV0035       * AJDANE - SE INCLUYE MANEJO DE ARCHIVO DANE DE  *
  1863* C.VELASCO     *          CIUDADES,DEPARTEAMENTOS Y CABECERAS O *
  1864* ABR./2011     *          CENTROS POBLADOS (DVPDANE)            *
  1865******************************************************************
  1866* CAV0036       * CARIND - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1867* C.VELASCO     *          CARACTERISTICAS USA PRECALCULADAS     *
  1868* MAY./2011     *          TITLE-CARACT-IND                      *
  1869******************************************************************
  1870* FARF037       * FRABDU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1871* F.RODRIGUEZ   *          DE DATOS UNIVERSAL DE PREGUNTAS       *
  1872* JUN.22/2011   *                                                *
  1873******************************************************************
  1874* CAV0038       * AJCIIU - SE INCLUYE MANEJO DE ARCHIVO DE BASE  *
  1875* C.VELASCO.    *          HISTORICA DE CODIGOS CIIU Y ACTIVIDAD *
  1876* SEP.21/2011   *          ECONOMICA                             *
  1877******************************************************************
  1878* CAV0039       * MCREHI - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1879* C.VELASCO     *          ICMCREH QUE CONTIENE EL HISTORICO     *
  1880* JUN./2011     *          DE REGISTRO CERRADOS > 5 AÑOS         *
  1881******************************************************************
  1882* CAV0040       * NUECMP - SE INCLUYE EL NOMBRE DEL ARCHIVO  DE  *
  1883* C.VELASCO     *          ICMCONTTRJ  CONTIENE LA RELACION DE   *
  1884* 09/ABR./2013  *          CONTRATO-TARJETA PARA TIPO CTA = 02.  *
  1885******************************************************************
  1886* GJC0041       * VALOR1 - REQUERIMIENTO 15452 CREACION PRODUCTO *
  1887* G.JIMENEZ     *          VALORA. DEFINICION DE ARCHIVO QUE MA- *
  1888* 20/SEP./2013  *          NEJA LOS COBROS EN 2 MOMENTOS, UN     *
  1889*               *          QUE COBRA Y LOS OTROS NO
  1890******************************************************************
  1891* GLB0042       * EVID03 - MEJORAS SISTEMA EVIDENTE              *
  1892* GLOBANT       *          PROD00006585                          *
  1893* NOV-2013      * SPRINT3                                        *
  1894******************************************************************
  1895* JJM0043       * SCORPJ - SE INCLUYE UN NUEVO TITLE PARA EL     *
  1896* J. MELGAREJO  *          SCORE PJ.                             *
  1897* MAR-2014      * SCOSTB - SE INCLUYE UN NUEVO TITLE PARA EL     *
  1898*               *          SCORE STABILITY  (BDSCOREHIS)
  1899******************************************************************
  1900*
  1901 01  FILE-TITLES.
  1902     05  BDUUNI-TITLE        PIC X(80) VALUE "$BDU/BDUUNI".       RMB0008
  1903     05  NOMB-APEL-TITLE     PIC X(80) VALUE "$DATABASE/ICBNAP".
  1904     05  CLAVE-TITLE         PIC X(80) VALUE "$DATABASE/ICBCLA".
  1905     05  TERM-TITLE          PIC X(80) VALUE "$DATABASE/ICBTER".
  1906     05  MAES-PERSON-TITLE   PIC X(80) VALUE "$DATABASE/ICMPER".
  1907     05  MAES-CHECK-TITLE    PIC X(80) VALUE "$DATABASE/ICMCHK".
  1908     05  MAES-CREDIT-TITLE   PIC X(80) VALUE "$DATABASE/ICMCRE".
  1909     05  MAES-MICROC-TITLE   PIC X(80) VALUE "$DATABASE/ICMMCR".  DLM0001
  1910     05  MAES-ICMCHQ-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQ".  GJC0029
  1911     05  INDEXADO-TITLE      PIC X(80) VALUE "$DATABASE/ICBCON".
  1912     05  SECUENCIAL-TITLE    PIC X(80) VALUE "$DATABASE/ICBTCO".
  1913     05  SUSCRIPTOR-TITLE    PIC X(80) VALUE "$DATABASE/ICBSUS".
  1914     05  ARCHNITS-TITLE      PIC X(80) VALUE "ICDIAN".
  1915     05  ARCHIVO-CLIENTE     PIC X(80) VALUE "$DATABASE/ICMCLI".
  1916     05  MAES-ICMCLN-TITLE   PIC X(80) VALUE "$DATABASE/ICMCLN".  VHF0030
  1917     05  ARCHIVO-PREPAGOS    PIC X(80) VALUE "$DATABASE/ICMPRE".
  1918     05  ARCHIVO-USUARIOS    PIC X(80) VALUE "$DATABASE/ICMUSU".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  34
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1919     05  TITLE-SCODTB        PIC X(80) VALUE "$DATABASE/SCODTB".
  1920     05  TITLE-BDIRMAE1      PIC X(80) VALUE "$DATABASE/BDIRMAE1".
  1921     05  TITLE-BDIRMAE2      PIC X(80) VALUE "$DATABASE/BDIRMAE2".
  1922     05  TITLE-BDIRMAE3      PIC X(80) VALUE "$DATABASE/BDIRMAE3".
  1923     05  TITLE-BDIRMAE4      PIC X(80) VALUE "$DATABASE/BDIRMAE4".
  1924     05  TITLE-BDIRCTR       PIC X(80) VALUE "$DATABASE/BDIRCTR".
  1925     05  TITLE-BDIMHIS       PIC X(80) VALUE "$DATABASE/BDIMHIS". FAC0023
  1926     05  BDAPRVTR-TITLE      PIC X(80) VALUE "$DATABASE/BDAPRVTR".CAV0031
  1927     05  TITLE-DTCABD.
  1928         07 FILLER           PIC X(13) VALUE "$DATOS/DTCABD".     GJC0014
  1929         07 ANOMESDIA-DTCABD PIC 9(08) VALUE ZEROS.               GJC0014
  1930     05  BDLCLI-TITLE        PIC X(80) VALUE "$DATABASE/BDLCLI".  GJC0013
  1931     05  SCOREPREC-TITLE     PIC X(80) VALUE "$DATOS/SCOREPREC".  LAG0033
  1932     05  ARCHIVO-LOGS        PIC X(80) VALUE
  1933         "/ic/datacred/desarrollo/logs/ICL325".
  1934     05  ARCHIVO-TEMPORAL    PIC X(80) VALUE
  1935                                 "$TEMPORALES/TEMPORAL".
  1936     05  ESTAD-CADUC         PIC X(80) VALUE
  1937                                 "$TEMPORALES/ESTCAD.DAT".
  1938     05  MATRIZ-CADUC        PIC X(80) VALUE
  1939                                 "$DATABASE/ICTCAD".
  1940     05  ETQ-CIN             PIC X(80) VALUE
  1941                                 "$TEMPORALES/ICINCO.DAT".
  1942     05  RECLACOM-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCM".
  1943     05  RECLAMOS-TITLE      PIC X(80) VALUE "$DATABASE/ICMRCL".
  1944     05 MAESTRO-FACUCLI      PIC X(80) VALUE "$DATABASE/FACUCLI".
  1945     05 TITLE-FACUCLP        PIC X(80) VALUE "$DATABASE/FACUCLP".
  1946     05 TITLE-FACUAUT        PIC X(80) VALUE "$DATABASE/FACUAUT".
  1947     05 TITLE-FACULOG        PIC X(80) VALUE "$DATABASE/FACULOG".
  1948     05 TITLE-FACUPAR        PIC X(80) VALUE
  1949                                 "$DATABASE/FACUPAR.DAT".
  1950     05 MAES-ICMCREH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCREH". CAV0039
  1951     05 MAES-ICMCHKH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHKH". CAV0039
  1952     05 MAES-ICMCHQH-TITLE   PIC X(80) VALUE "$DATABASE/ICMCHQH". CAV0039
  1953
  1954     05 TITLE-CIIU          PIC X(80) VALUE "$DATABASE/ICTCIIU".  VHF0009
  1955     05 TITLE-BDINCCB       PIC X(80) VALUE "$ICREGIS/BDINCCB".   VHF0010
  1956     05 TITLE-BDINREG       PIC X(80) VALUE "$ICREGIS/BDINREG".   VHF0010
  1957     05 TITLE-BDINDAS       PIC X(80) VALUE "$ICREGIS/BDINDAS".   VHF0010
  1958     05 TITLE-BDINDIAN      PIC X(80) VALUE "$ICREGIS/BDINDIAN".  VHF0010
  1959     05 TITLE-CONRAZ        PIC X(80)                             GJC0019
  1960                            VALUE "$DATABASE/CONRAZ.DAT".         GJC0019
  1961     05 TITLE-FRALOG        PIC x(80) VALUE "$DATABASE/FRALOG".   GJC0020
  1962     05 TITLE-FRAINQ        PIC X(80) VALUE                       FAC0022
  1963                            "$DATABASE/FRAINQ.DAT".               FAC0022
  1964     05 TITLE-FRAINQGR      PIC X(80) VALUE                       CAV0025
  1965                            "$DATABASE/FRAINQGR.DAT".             CAV0025
  1966     05 TITLE-BDSCORES.                                           FLT0026
  1967        07 FILLER           PIC X(15) VALUE "$SCORES/BDSCORE".    FLT0026
  1968        07 T-FECHA-PROC     PIC 9(04).                            FLT0026
  1969     05 TITLE-ICBPRO        PIC x(80) VALUE "$DATABASE/ICBPRO".   GJC0021
  1970     05 TITLE-DTRLLA        PIC x(80) VALUE "$DATABASE/DTRLLA".
  1971     05 TITLE-DTCLOG        PIC X(80) VALUE "$DATABASE/DTCLOG".   GJC0012
  1972     05 TITLE-DTCCOM        PIC X(80) VALUE "$DATABASE/DTCCOM".   GJC0017
  1973     05 TITLE-DTCING        PIC X(80) VALUE "$DATABASE/DTCING".   VHF0013
  1974     05 TITLE-DTCFAL        PIC X(80) VALUE "$DATABASE/DTCFAL".   VHF0013
  1975     05 TITLE-DTCMDF        PIC X(80) VALUE "$DATABASE/DTCMDF".   VHF0013
  1976     05 TITLE-DTCTRA        PIC X(80) VALUE "$DATABASE/DTCTRA".   VHF0013
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  35
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1977     05 TITLE-BDINBYN       PIC X(80) VALUE "$ICREGIS/BDINBYN".   VHF0011
  1978     05 SI-BDIEMSUP         PIC X(80) VALUE "$DBSUPER/BDIEMSUP".  FAC0012
  1979     05 TITLE-BDIEMSUP      PIC X(80) VALUE "$DBSUPER/BDIESU".    FAC0023
  1980     05 TITLE-UTLESTACT     PIC X(80) VALUE "$DATABASE/UTLESTACT".GLB0042
  1981     05 SI-BDIEENTI         PIC X(80) VALUE "$DBSUPER/BDIEENTI".  FAC0012
  1982     05 SI-BDIEMPER         PIC X(80) VALUE "$DBSUPER/BDIEMPER".  FAC0012
  1983     05 SI-BDIETEMA         PIC X(80) VALUE "$DBSUPER/BDIETEMA".  FAC0012
  1984     05 SI-BDIEAPER         PIC X(80) VALUE "$DBSUPER/BDIEAPER".  FAC0012
  1985     05 SI-BDIEMENT         PIC X(80) VALUE "$DBSUPER/BDIEMENT".  FAC0012
  1986     05 SI-BDIEMOVI         PIC X(80) VALUE "$DBSUPER/BDIEMOVI".  FAC0012
  1987     05 SI-BDIEHSUP         PIC X(80) VALUE "$DBSUPER/BDIEHSUP".  FAC0012
  1988     05 SI-BDIERECL         PIC X(80) VALUE "$DBSUPER/BDIERECL".  FAC0012
  1989     05 SI-BDIEMTOT         PIC X(80) VALUE "$DBSUPER/BDIEMTOT".  FAC0012
  1990     05 NOMBRE-WEB-SAL.                                           FAC0015
  1991        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/WEB-SAL.".     FAC0015
  1992        07 FECHA-WEB-SAL   PIC 9(8).                              FAC0015
  1993     05 NOMBRE-RAS-SAL.                                           FAC0015
  1994        07 NOM-DUE-WEB-SAL PIC X(15) VALUE "$DATOS/RAS-SAL.".     FAC0015
  1995        07 FECHA-RAS-SAL   PIC 9(8).                              FAC0015
  1996     05 NOMBRE-CLAVE-WEB.                                         FAC0015
  1997        07 NOMBRE-WEB-W    PIC X(80) VALUE "$DATABASE/ARCH-WEB".  FAC0015
  1998     05 NOMBRE-RAS-LOG.                                           FAC0015
  1999        07 NOM-RAS-LOG     PIC X(19) VALUE                        FAC0015
  2000                           "$DATOS/WEB-RAS.LOG.".                 FAC0015
  2001        07 FECHA-RAS-LOG   PIC 9(8).                              FAC0015
  2002     05 TITLE-BDIIDIAN     PIC X(80)  VALUE "$DATABASE/BDIIDIAN". FAC0016
  2003     05 TITLE-BDIIREGI     PIC X(80)  VALUE "$ICREGIS/BDIIRE".    FAC0016
  2004     05 TITLE-BDIIDAS      PIC X(80)  VALUE "$DATABASE/BDIIDAS".  FAC0016
  2005     05 TITLE-DTCNHAB      PIC X(80)  VALUE "$DATABASE/DTCNHAB".  VHF0017
  2006     05 TITLE-ICDACT       PIC X(80)  VALUE                       VHF0017
  2007                           "$TEMPORALES/ICDACT.DAT".              VHF0017
  2008     05 NOMBRE-ACTALOG     PIC X(80)  VALUE                       FAC0018
  2009                           "$TRABAJO/logs/ACTALOG".               FAC0018
  2010     05 NOMBRE-VALVEST     PIC X(80)  VALUE                       FAC0018
  2011                           "$TRABAJO/logs/VALVEST.DAT".           FAC0018
  2012     05 NOMBRE-CALIDLOG.                                          CAV0027
  2013        07 NOM-CALIDLOG    PIC X(23)  VALUE                       CAV0027
  2014                           "$TRABAJO/logs/CALIDLOG-".             CAV0027
  2015        07 FCH-CALIDLOG    PIC 9(8).                              CAV0027
  2016     05 NOMBRE-CALIDDRP.                                          CAV0027
  2017        07 NOM-CALIDDRP    PIC X(24) VALUE                        CAV0027
  2018                           "$TEMPORALES/CALIDAD-DRP.".            CAV0027
  2019        07 FCH-CALIDDRP    PIC 9(8).                              CAV0027
  2020     05  MAES-ICMVLR-TITLE.                                       EAL0028
  2021         07 MAES-DIRECTORY1          PIC X(16) VALUE              RGH0029
  2022                                              "$VALORES/ICMVLR-". EAL0028
  2023         07 MAES-FILE1               PIC X(63).                   EAL0028
  2024                                                                  EAL0028
  2025     05  MAES-ICMVLR-TITLE2.                                      EAL0028
  2026         07 MAES-DIRECTORY2          PIC X(16) VALUE              RGH0029
  2027                                              "$VALORES/ICMVLR-". EAL0028
  2028         07 MAES-FILE2               PIC X(63).                   EAL0028
  2029                                                                  EAL0028
  2030     05  MAES-ICMVLR-TITLE3.                                      EAL0028
  2031         07 MAES-DIRECTORY3          PIC X(16) VALUE              RGH0029
  2032                                              "$VALORES/ICMVLR-". EAL0028
  2033         07 MAES-FILE3               PIC X(63).                   EAL0028
  2034                                                                  EAL0028
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  36
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  2035     05  MAES-ICMVLR-TITLE4.                                      EAL0028
  2036         07 MAES-DIRECTORY4          PIC X(16) VALUE              RGH0029
  2037                                              "$VALORES/ICMVLR-". EAL0028
  2038         07 MAES-FILE4               PIC X(63).                   EAL0028
  2039                                                                  EAL0028
  2040     05  MAES-ICMVLR-TITLE5.                                      EAL0028
  2041         07 MAES-DIRECTORY5          PIC X(16) VALUE              RGH0029
  2042                                              "$VALORES/ICMVLR-". EAL0028
  2043         07 MAES-FILE5               PIC X(63).                   EAL0028
  2044                                                                  EAL0028
  2045     05  MAES-ICMVLR-TITLE6.                                      EAL0028
  2046         07 MAES-DIRECTORY6          PIC X(16) VALUE              RGH0029
  2047                                              "$VALORES/ICMVLR-". EAL0028
  2048         07 MAES-FILE6               PIC X(63).                   EAL0028
  2049     05 TITLE-BDLDIRACE  PIC X(80) VALUE "$DATABASE/BDLDIRACE".   RGH0032
  2050     05 TITLE-BDLMAIEXC  PIC X(80) VALUE "$DATABASE/BDLMAIEXC".   RGH0032
  2051     05 TITLE-BDLTELEXC  PIC X(80) VALUE "$DATABASE/BDLTELEXC".   RGH0032
  2052     05 TITLE-BDANOM     PIC X(80) VALUE "$DATABASE/BDANOM".      GJC0034
  2053     05 TITLE-FRZMYR     PIC X(80) VALUE "$DATABASE/FRZMYR".      GJC0033
  2054     05 TITLE-DVPDANE    PIC X(80) VALUE "$DATABASE/DVPDANE.DAT". CAV0035
  2055     05 TITLE-CARACT-IND PIC X(80) VALUE                          CAV0036
  2056                                   "$DATABASE/CARACTUSA-INDCL".   CAV0036
  2057     05 FRABDU-TITLE     PIC X(25) VALUE                          FARF037
  2058                                 "$VALORES/frabduact/FRABDU".     FARF037
  2059     05 FRABDV-TITLE     PIC X(29) VALUE                          FARF037
  2060                                 "$VALORES/frabduact/FRABDU.NEW". FARF037
  2061     05 MAES-ICMHCIIU-TITLE PIC X(80) VALUE "$DATABASE/ICMHCIIU". CAV0038
  2062     05 MAES-ICMCONTTRJ-TITLE PIC X(80) VALUE                     CAV0040
  2063                                    "$DATABASE/ICMCONTTRJ".       CAV0040
  2064     05 TITLE-ICBCOB     PIC X(16) VALUE "$DATABASE/ICBCOB".      GJC0041
  2065     05 TITLE-SCODAPJA   PIC X(37) VALUE "$DATABASE/SCODAPJA".    JJM0043
  2066 01 TITLE-BDSCOREHIS.                                             JJM0043
  2067    02 FILLER          PIC X(21) VALUE "$DATABASE/BDSCOREHIS.".   JJM0043
  2068    02 ANO-ANT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2013.            JJM0043
  2069    02 FILLER                    PIC X(01) VALUE "-".             JJM0043
  2070    02 ANO-ACT-TITLE-BDSCOREHIS  PIC 9(04) VALUE 2014.            JJM0043
* 2071 COPY UTLBIT.WS.
  2076 01 VARIABLES-UTLBIT.
  2077    03 I-UTLBIT             PIC 9(5).
  2078    03 POSCAR-UTLBIT        PIC 9(5).
  2079    03 POSFLA-UTLBIT        PIC 9(5).
  2080    03 INPUT-STR-UTLBIT     PIC X(100).
  2081    03 INPUT-LEN-UTLBIT     PIC 9(03).
  2082    03 INPUT-FLA-UTLBIT     PIC 9(03).
  2083    03 INPUT-VAL-UTLBIT     PIC 9(01).
  2084    03 OUTPUT-ERR-UTLBIT    PIC 9(01).
  2085    03 OUTPUT-VAL-UTLBIT    PIC 9(01).
  2086    03 VALOR-UTLBIT         PIC 9(05).
  2087    03 ASCII-UTLBIT         PIC 9(05).
  2088    03 ASCXX-UTLBIT         PIC 9(05).
  2089    03 CAR-UTLBIT           PIC X(01).
  2090 01 CARACTERES-UTLBIT.
  2091    03 FILLER PIC X(16) VALUE X'000102030405060708090A0B0C0D0E0F'.
  2092    03 FILLER PIC X(16) VALUE X'101112131415161718191A1B1C1D1E1F'.
  2093    03 FILLER PIC X(16) VALUE X'202122232425262728292A2B2C2D2E2F'.
  2094    03 FILLER PIC X(16) VALUE X'303132333435363738393A3B3C3D3E3F'.
  2095    03 FILLER PIC X(16) VALUE X'404142434445464748494A4B4C4D4E4F'.
  2096    03 FILLER PIC X(16) VALUE X'505152535455565758595A5B5C5D5E5F'.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  37
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/UTLB
  2097    03 FILLER PIC X(16) VALUE X'606162636465666768696A6B6C6D6E6F'.
  2098    03 FILLER PIC X(16) VALUE X'707172737475767778797A7B7C7D7E7F'.
  2099    03 FILLER PIC X(16) VALUE X'808182838485868788898A8B8C8D8E8F'.
  2100    03 FILLER PIC X(16) VALUE X'909192939495969798999A9B9C9D9E9F'.
  2101    03 FILLER PIC X(16) VALUE X'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF'.
  2102    03 FILLER PIC X(16) VALUE X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'.
  2103    03 FILLER PIC X(16) VALUE X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'.
  2104    03 FILLER PIC X(16) VALUE X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'.
  2105    03 FILLER PIC X(16) VALUE X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'.
  2106    03 FILLER PIC X(16) VALUE X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'.
  2107 01 FILLER REDEFINES CARACTERES-UTLBIT.
  2108    03 V-UTLBIT OCCURS 256 TIMES PIC X.
* 2109 COPY VALVLR.WS.
  2110* VALVLR-WS.0003
  2111*************************************************************************
  2112* CONTIENE LAS VARIABLES NECESARIAS PARA EL COPY VALCRE.PROC
  2113*************************************************************************
  2114* FAC0002     * SE ADICIONA VARIABLE FLAG-VALVLR PARA MANEJO DE MAPA    *
  2115* FLOR ANGELA * DE BITS                                                 *
  2116* CUADROS     *                                                         *
  2117* MAY.28/2002 *                                                         *
  2118*************************************************************************
  2119* RMB0003     * COLP02- SE ACTIVA LA OCURRENCIA 16 DEL MAPA DE BITS PARA*
  2120* R.MARTINEZ  *         MANEJO DEL CUPO INICIAL COMO USO EXCLUSIVO DEL  *
  2121* JUN.15/2006 *         CLIENTE                                         *
  2122*************************************************************************
  2123 01  FECHA-SITUACION-AUX-VALVLR     PIC 9(06).
  2124 01  FECHA-SITUACION-AUX-R-VALVLR   REDEFINES
  2125                                    FECHA-SITUACION-AUX-VALVLR.
  2126     03 ANO-SITUACION-AUX-VALVLR    PIC 9(04).
  2127     03 MES-SITUACION-AUX-VALVLR    PIC 9(02).
  2128 01  F-ULT-ACT-AUX-VALVLR           PIC 9(06).
  2129 01  F-ULT-ACT-AUX-R-VALVLR         REDEFINES
  2130                                    F-ULT-ACT-AUX-VALVLR.
  2131     03 ANO-ULT-ACT-AUX-VALVLR      PIC 9(04).
  2132     03 MES-ULT-ACT-AUX-VALVLR      PIC 9(02).
  2133 01  FEC-NOVEDAD-AUX-VALVLR         PIC 9(06).
  2134 01  FEC-NOVEDAD-AUX-R-VALVLR REDEFINES FEC-NOVEDAD-AUX-VALVLR.
  2135     03 ANO-NOVEDAD-AUX-VALVLR      PIC 9(04).
  2136     03 MES-NOVEDAD-AUX-VALVLR      PIC 9(02).
  2137 01  FECHA-ACT-VALOR-AUX-VALVLR     PIC 9(06).
  2138 01  FECHA-ACT-VALOR-AUX-R-VALVLR
  2139     REDEFINES               FECHA-ACT-VALOR-AUX-VALVLR.
  2140     03 ANO-ACT-VALOR-AUX-VALVLR    PIC 9(04).
  2141     03 MES-ACT-VALOR-AUX-VALVLR    PIC 9(02).
  2142 01  FEC-4-MA-VALVLR                PIC 9(04).
  2143 01  FEC-4-MA-R-VALVLR       REDEFINES FEC-4-MA-VALVLR.
  2144     03 MES-4-MA-VALVLR             PIC 9(02).
  2145     03 ANO-4-MA-VALVLR             PIC 9(02).
  2146 01  FEC-6-MA-VALVLR                PIC 9(06).
  2147 01  FEC-6-MA-R-VALVLR            REDEFINES FEC-6-MA-VALVLR.
  2148     03 MES-6-MA-VALVLR             PIC 9(02).
  2149     03 ANO-6-MA-VALVLR .
  2150        04 SIG-6-MA-VALVLR          PIC 9(02).
  2151        04 ANO2-6-MA-VALVLR         PIC 9(02).
  2152 01  FEC-6-AM-VALVLR                PIC 9(06).
  2153 01  FEC-6-AM-R-VALVLR            REDEFINES FEC-6-AM-VALVLR.
  2154     03 SIG-6-AM-VALVLR             PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  38
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  2155     03 ANO-6-AM-VALVLR             PIC 9(02).
  2156     03 MES-6-AM-VALVLR             PIC 9(02).
  2157 01  IND-VALORES-VALVLR             PIC 9(01) VALUE 0.
  2158 01  FLAG-VALVLR                    PIC 9(02) VALUE 0.            FAC0002
  2159 01  VECTOR-VALORES-VALVLR.
  2160     03 VEC-VALOR-VALVLR            PIC 9(01) OCCURS 16 TIMES.    RMB0003
  2161 01  VECTOR-ACTIVADO-VALVLR         PIC X(16) VALUE               RMB0003
  2162                                             "1111111111111110".  RMB0003
  2163*------------------------------------------------------------*
* 2164  COPY PE-TIME.WS.
  2165*PE-TIME.WS.v.01.0001.
  2166*----------------------------------------------------------------*
  2167*
  2168*    COPY  WORKING  PROCESOS ESPECIALES VERSION OCT/2004
  2169*
  2170*----------------------------------------------------------------*
  2171*    COPY AREA DE LOG PARA CONTROL DE TIEMPOS
  2172*----------------------------------------------------------------*
  2173
  2174*-----------------------------------------------------------*
  2175*      VARIABLES DE   LOG  DE EJECUCION
  2176*-----------------------------------------------------------*
  2177 01  W-RETORNO-LOG.
  2178     03 W-STATUS-LOG            PIC  9(02) VALUE ZEROS.
  2179     03 W-ARCHIVO-LOG.
  2180        05 W-ENTIDAD-LOG        PIC  X(03) VALUE SPACES.
  2181        05 W-FILLER-LOG         PIC  X(27) VALUE SPACES.
  2182     03 W-PROGRAMA              PIC  X(20) VALUE SPACES.
  2183     03 W-FECHA-HORA-INI.
  2184        05 W-FECHA-INI          PIC  X(10) VALUE SPACES.
  2185        05 W-HORA-INI           PIC  X(08) VALUE SPACES.
  2186     03 W-FECHA-HORA-FIN.
  2187        05 W-FECHA-FIN          PIC  X(10) VALUE SPACES.
  2188        05 W-HORA-FIN           PIC  X(08) VALUE SPACES.
  2189     03 W-USER-UNIX             PIC  9(06) VALUE ZEROS.
  2190*-----------------------------------------------------------*
  2191*      VARIABLES DE TIEMPO DE EJECUCION
  2192*-----------------------------------------------------------*
  2193 01  FECHAS-LOG.
  2194     03  HORA-SIS               PIC  9(08).
  2195     03  HORA-SIS-R  REDEFINES  HORA-SIS.
  2196         05  HORA-S             PIC  9(02).
  2197         05  MINU-S             PIC  9(02).
  2198         05  SEGU-S             PIC  9(02).
  2199         05  DESE-S             PIC  9(02).
  2200     03  FECHA-S                PIC  9(08).
  2201     03  FECHA-CURRENT-DATE  REDEFINES  FECHA-S.
  2202         05  FECHA-SISTEMA      PIC  X(8).
  2203     03  FECHA-S-R           REDEFINES  FECHA-S.
  2204         05 ANIO-S             PIC  9(04).
  2205         05 ANIO-S-R         REDEFINES  ANIO-S.
  2206            07  ANIO-SIG1      PIC  9(02).
  2207            07  ANIO-SIG2      PIC  9(02).
  2208         05 MESE-S             PIC  9(02).
  2209         05 DIAS-S             PIC  9(02).
  2210     03 FECHA-PG.
  2211        05 ANIO-P              PIC  9(04)     VALUE ZEROS.
  2212        05 SLASH-1             PIC  X(01)     VALUE "/".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  39
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/PE-T
  2213        05 MESE-P              PIC  9(02)     VALUE ZEROS.
  2214        05 SLASH-2             PIC  X(01)     VALUE "/".
  2215        05 DIAS-P              PIC  9(02)     VALUE ZEROS.
  2216     03 HORA-PG.
  2217        05 HORA-P              PIC  9(02)     VALUE ZERO.
  2218        05 DOSPUNTO-1          PIC  X(01)     VALUE ":".
  2219        05 MINU-P              PIC  9(02)     VALUE ZERO.
  2220        05 DOSPUNTO-2          PIC  X(01)     VALUE ":".
  2221        05 SEGU-P              PIC  9(02)     VALUE ZEROS.
  2222*------------------------------------------------------------*
  2223 01  w-msup-ind-bloq-n           PIC 9(01) VALUE zeros.
  2224 01  w-msup-ind-bloq-x redefines w-msup-ind-bloq-n
  2225                                 PIC x(01).
  2226*------------------------------------------------------------*
  2227 01  ARCHIVOS.
  2228     03 ARCHIVO-ENTRADA.
  2229        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2230        05 ARCH-ENTRADA       PIC X(30) VALUE  SPACES.
  2231     03 ARCHIVO-INCONC.
  2232        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2233        05 ARCH-INCONC        PIC X(30) VALUE  SPACES.
  2234     03 ARCHIVO-SALIDA.
  2235        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2236        05 ARCH-SALIDA        PIC X(30) VALUE  SPACES.
  2237     03 ARCHIVO-ESTADIS.
  2238        05 FILLER             PIC X(12) VALUE  "$TEMPORALES/".
  2239        05 ARCH-ESTADIS       PIC X(30) VALUE  SPACES.
  2240*------------------------------------------------------------*
  2241 01  TABLAS-EVALUACION.
  2242     03  TABLA-NOVEDADES-CARTERA.
  2243         05  FILLER  PIC X(23) VALUE  "0101NORMAL.-.AL.DIA1   ".
  2244         05  FILLER  PIC X(23) VALUE  "0202TARJ. NO.RECLAM1   ".
  2245         05  FILLER  PIC X(23) VALUE  "0803CANCEL.MAL.MANE1   ".
  2246         05  FILLER  PIC X(23) VALUE  "0404TARJETA.ROBADA 1   ".
  2247         05  FILLER  PIC X(23) VALUE  "0505CANCEL.VOLUNTAR1   ".
  2248         05  FILLER  PIC X(23) VALUE  "0606CANCEL.MMX<60  1   ".
  2249         05  FILLER  PIC X(23) VALUE  "0707TARJ.EXTRAV.   1   ".
  2250         05  FILLER  PIC X(23) VALUE  "0308PAGO VOLUNT.SAT1   ".
  2251         05  FILLER  PIC X(23) VALUE  "0309PAGO.MMX.A.30  1   ".
  2252         05  FILLER  PIC X(23) VALUE  "0310PAGO.MMX.A.60  1   ".
  2253         05  FILLER  PIC X(23) VALUE  "0311PAGO.MORA.90   1   ".
  2254         05  FILLER  PIC X(23) VALUE  "0312PAGO.VOL.MOR1201   ".
  2255         05  FILLER  PIC X(23) VALUE  "0113MORA.30.AL.DIA 1   ".
  2256         05  FILLER  PIC X(23) VALUE  "0114MORA.60.AL.DIA 1   ".
  2257         05  FILLER  PIC X(23) VALUE  "0115MORA.90.AL.DIA 1   ".
  2258         05  FILLER  PIC X(23) VALUE  "0116MORA.120.AL.DIA1   ".
  2259         05  FILLER  PIC X(23) VALUE  "1217ESTA.MORA.30   1   ".
  2260         05  FILLER  PIC X(23) VALUE  "1318ESTA.MORA.60   1   ".
  2261         05  FILLER  PIC X(23) VALUE  "1419ESTA.MORA.90   1   ".
  2262         05  FILLER  PIC X(23) VALUE  "1520ESTA.MORA.120  1   ".
  2263         05  FILLER  PIC X(23) VALUE  "1221FU.60.Y.ESTA.301   ".
  2264         05  FILLER  PIC X(23) VALUE  "1222FU.90.Y.ESTA.301   ".
  2265         05  FILLER  PIC X(23) VALUE  "1323FU.90.Y.ESTA.601   ".
  2266         05  FILLER  PIC X(23) VALUE  "1224FU.120.ESTA.30 1   ".
  2267         05  FILLER  PIC X(23) VALUE  "1325FU.120.ESTA.60 1   ".
  2268         05  FILLER  PIC X(23) VALUE  "1426FU.120.ESTA.90 1   ".
  2269         05  FILLER  PIC X(23) VALUE  "1327RE.30.ESTA.60  1   ".
  2270         05  FILLER  PIC X(23) VALUE  "1428RE.30.Y.ESTA.901   ".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  40
* S))D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-T
  2271         05  FILLER  PIC X(23) VALUE  "1529RE.30.ESTA.120 1   ".
  2272         05  FILLER  PIC X(23) VALUE  "1230RE.60.Y.ESTA.301   ".
  2273         05  FILLER  PIC X(23) VALUE  "1331RE.60.Y.ESTA.601   ".
  2274         05  FILLER  PIC X(23) VALUE  "1432RE.60.Y.ESTA.901   ".
  2275         05  FILLER  PIC X(23) VALUE  "1533RE.60.ESTA.120 1   ".
  2276         05  FILLER  PIC X(23) VALUE  "1234RE.90.Y.ESTA.301   ".
  2277         05  FILLER  PIC X(23) VALUE  "1335RE.90.Y.ESTA.601   ".
  2278         05  FILLER  PIC X(23) VALUE  "1436RE.90.Y.ESTA.901   ".
  2279         05  FILLER  PIC X(23) VALUE  "1537RE.90.ESTA.120 1   ".
  2280         05  FILLER  PIC X(23) VALUE  "1238RE.120.ESTA.30 1   ".
  2281         05  FILLER  PIC X(23) VALUE  "1339RE.120.ESTA.60 1   ".
  2282         05  FILLER  PIC X(23) VALUE  "1440RE.120.ESTA.90 1   ".
  2283         05  FILLER  PIC X(23) VALUE  "1541RE.120.ESTA.1201   ".
  2284         05  FILLER  PIC X(23) VALUE  "2042ADJ.NO.LOCALIZA1   ".
  2285         05  FILLER  PIC X(23) VALUE  "2143ADJ.CTA.COBRADO1   ".
  2286         05  FILLER  PIC X(23) VALUE  "2244FALLECIDO      0   ".
  2287         05  FILLER  PIC X(23) VALUE  "0945CARTERA.CASTIGA1   ".
  2288         05  FILLER  PIC X(23) VALUE  "1046CARTERA.RECUPER1   ".
  2289         05  FILLER  PIC X(23) VALUE  "1147DUDOSO.RECAUDO 1   ".
  2290         05  FILLER  PIC X(23) VALUE  "2348CONSULTA       0   ".
  2291         05  FILLER  PIC X(23) VALUE  "4949NO RENOVADA    1   ".
  2292         05  FILLER  PIC X(23) VALUE  "50                 0   ".
  2293     03  TABLA-NOVEDADES-CARTERA-R  REDEFINES
  2294         TABLA-NOVEDADES-CARTERA.
  2295         05  TAB-NOVEDADES-CARTERA  OCCURS  50  TIMES.
  2296             07  TAB-NOV-CART-CODINT PIC 9(02).
  2297             07  TAB-NOV-CART-COD    PIC 9(02).
  2298             07  TAB-NOV-CART-NOM    PIC X(15).
  2299             07  TAB-NOV-CART-CAL    PIC 9(01).
  2300             07  TAB-NOV-CART-RAN    PIC 9(02).
  2301             07  TAB-NOV-CART-CAL2   PIC 9(01).
  2302
  2303     03  TABLA-NOVEDADES-CTA-CTE.
  2304         05 FILLER  PIC X(23) VALUE  "3001NORMAL.-.AL.DIA1   ".
  2305         05 FILLER  PIC X(23) VALUE  "3102CANCEL.MAL.MANE1   ".
  2306         05 FILLER  PIC X(23) VALUE  "0003               0   ".
  2307         05 FILLER  PIC X(23) VALUE  "0004               0   ".
  2308         05 FILLER  PIC X(23) VALUE  "3205SALDADA        1   ".
  2309         05 FILLER  PIC X(23) VALUE  "3306EMBARGADA      1   ".
  2310         05 FILLER  PIC X(23) VALUE  "3507EMBARGADA.NORMA1   ".
  2311         05 FILLER  PIC X(23) VALUE  "0008               0   ".
  2312         05 FILLER  PIC X(23) VALUE  "3409INACTIVA       1   ".
  2313     03  TABLA-NOVEDADES-CTA-CTE-R  REDEFINES
  2314         TABLA-NOVEDADES-CTA-CTE.
  2315         05  TAB-NOVEDADES-CTA-CTE  OCCURS   9  TIMES.
  2316             07  TAB-NOV-CTAC-CODINT PIC 9(02).
  2317             07  TAB-NOV-CTAC-COD    PIC 9(02).
  2318             07  TAB-NOV-CTAC-NOM    PIC X(15).
  2319             07  TAB-NOV-CTAC-CAL    PIC 9(01).
  2320             07  TAB-NOV-CTAC-RAN    PIC 9(02).
  2321             07  TAB-NOV-CTAC-CAL2   PIC 9(01).
  2322
  2323     03  TABLA-ENDEUDAMIENTO.
  2324         05  FILLER  PIC X(23) VALUE  "24A NORMAL         1   ".
  2325         05  FILLER  PIC X(23) VALUE  "25B SUB-NORMAL     1   ".
  2326         05  FILLER  PIC X(23) VALUE  "26C DEFICIENTE     1   ".
  2327         05  FILLER  PIC X(23) VALUE  "27D DIFICIL-COBRO  1   ".
  2328         05  FILLER  PIC X(23) VALUE  "28E IRRECUPERABLE  1   ".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  41
* S))D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-T
  2329         05  FILLER  PIC X(23) VALUE  "29+ CONTINGENCIA   0   ".
  2330         05  FILLER  PIC X(23) VALUE  "00T                0   ".
  2331         05  FILLER  PIC X(23) VALUE  "00R                0   ".
  2332     03  TABLA-ENDEUDAMIENTO-R      REDEFINES
  2333         TABLA-ENDEUDAMIENTO.
  2334         05  TAB-ENDEUDAMIENTO      OCCURS   8  TIMES.
  2335             07  TAB-END-CODINT     PIC 9(02).
  2336             07  TAB-END-COD        PIC X(01).
  2337             07  TAB-END-NOM        PIC X(16).
  2338             07  TAB-END-CAL        PIC 9(01).
  2339             07  TAB-END-RAN        PIC 9(02).
  2340             07  TAB-END-CAL2       PIC 9(01).
  2341*------------------------------------------------------------*
  2342 01 TABLA-VIGENTES.
  2343     03  tabla-vigentes-cartera.
  2344         05 filler        PIC x(10)   VALUE  "1000000000".
  2345         05 filler        PIC x(10)   VALUE  "0011111111".
  2346         05 filler        PIC x(10)   VALUE  "1111111111".
  2347         05 filler        PIC x(10)   VALUE  "1111111111".
  2348         05 filler        PIC x(10)   VALUE  "1111101101".
  2349     03  tabla-vigentes-cartera-r redefines
  2350         tabla-vigentes-cartera.
  2351         05 tab-vigentes-cartera   occurs 50 times  PIC 9(01).
  2352*------------------------------------------------------------*
  2353 01 TABLA-TIPO-CARTERA.
  2354     03 W-TIPO-CARTERA.
  2355        05 FILLER  PIC 9(07) VALUE 0101000.
  2356        05 FILLER  PIC 9(07) VALUE 0201000.
  2357        05 FILLER  PIC 9(07) VALUE 0301000.
  2358        05 FILLER  PIC 9(07) VALUE 0402000.
  2359        05 FILLER  PIC 9(07) VALUE 0501000.
  2360        05 FILLER  PIC 9(07) VALUE 0603000.
  2361        05 FILLER  PIC 9(07) VALUE 0701000.
  2362        05 FILLER  PIC 9(07) VALUE 0802000.
  2363        05 FILLER  PIC 9(07) VALUE 0902000.
  2364        05 FILLER  PIC 9(07) VALUE 1002000.
  2365        05 FILLER  PIC 9(07) VALUE 1102000.
  2366        05 FILLER  PIC 9(07) VALUE 1202000.
  2367        05 FILLER  PIC 9(07) VALUE 1301000.
  2368        05 FILLER  PIC 9(07) VALUE 1401000.
  2369        05 FILLER  PIC 9(07) VALUE 1502000.
  2370        05 FILLER  PIC 9(07) VALUE 1602000.
  2371        05 FILLER  PIC 9(07) VALUE 1701000.
  2372        05 FILLER  PIC 9(07) VALUE 1801000.
  2373        05 FILLER  PIC 9(07) VALUE 1902000.
  2374        05 FILLER  PIC 9(07) VALUE 2001000.
  2375        05 FILLER  PIC 9(07) VALUE 2102000.
  2376        05 FILLER  PIC 9(07) VALUE 2202000.
  2377        05 FILLER  PIC 9(07) VALUE 2304000.
  2378        05 FILLER  PIC 9(07) VALUE 2402000.
  2379        05 FILLER  PIC 9(07) VALUE 2501000.
  2380        05 FILLER  PIC 9(07) VALUE 2602000.
  2381        05 FILLER  PIC 9(07) VALUE 2703000.
  2382        05 FILLER  PIC 9(07) VALUE 2802000.
  2383        05 FILLER  PIC 9(07) VALUE 2902000.
  2384     03 W-TIPO-CARTERA-R REDEFINES W-TIPO-CARTERA.
  2385        05 W-TIPO-CART OCCURS 29 TIMES.
  2386           07 W-CART-CONSEC          PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  42
* S))D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-T
  2387           07 W-CART-TIPO            PIC 9(02).
  2388           07 W-FLAG-EVALUA-SN       PIC 9(01).
  2389           07 W-FLAG-MESES-CONTEM    PIC 9(02).
  2390
  2391*---------------------------------------------------- *
* 2392 COPY  LEEMAESTROS.WS.                                            GDT0001
  2393*LEEMAESTROS.WS.v.0003.
  2394********************************************************************
  2395* COPY QUE CONTIENE LAS VARIABLES NECESARIAS PARA EL MANEJO DE LA
  2396* REGIS (BDAMATCH.WS) Y LAS VARIABLES PARA EL MENEJO DE LA
  2397* AMNISTIA (AMNISTIA21.WS).
  2398********************************************************************
  2399* GJC0002    * LEY001 - CAMPO PARA INICIALIZADO EN 1 PARA QUE SIEMPRE*
  2400* G.JIMENEZ  *          ENTREGUE LA NOVEDAT QUE LEYÓ (EN 48). SI UN  *
  2401* MAY 18/2009*                                                       *
  2402**********************************************************************
  2403* GJC0003    * BBVA01 - SE CREA FLAG PARA ELIMINAR O DEJAR CUENTAS DE*
  2404* G.JIMENEZ  *          BBVA SEGUN SOLICITUD DE LA ENTIDAD EN ICGCON *
  2405* AGO 25/2009*          NO SE DEBEN MOSTRAR Y TODO LO DEMAS (SCORES, *
  2406*            *          PES,ETC) SI LAS DEBEN TENER EN CUENTA        *
  2407**********************************************************************
* 2408 COPY BDAMATCH.WS.
  2409*BDAMATCH-WS.v.0003.
  2410********************************************************************
  2411* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
  2412* PORTAFOLI Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LOS
  2413* ARCHIVO BDACSV, ICBDIR ICMCRE E ICMCHK.
  2414********************************************************************
  2415* RMB0002 *VIGE01: SE CONTRARAN LAS CUENTAS CON ADEJETIVOS DE
  2416*         *MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL MEJOR PORTAFOLIO
  2417********************************************************************
  2418* RMB0003     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO     *
  2419* R-MARTINEZ. *          DEL PORTAFOLIO .                          *
  2420* 5-SEP-2011  * FUEN01 - NCLUIR  FUENTES EXTERNAS                  *
  2421*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH          *
  2422*             * NOMB01 - MAQUILLAR EL MEJOR NOMBRE EN PRESENTACION *
  2423********************************************************************
  2424 01 VARIABLES-MAQ.                                                RMB0003
  2425     03 I-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
  2426     03 J-MAQ                    PIC 9(03)  VALUE 0.              RMB0003
  2427     03 SW-BORRAR-MAQ            PIC 9(03)  VALUE 0.              RMB0003
  2428     03 NOMBRE-INPMAQ-ORI        PIC X(45)  VALUE SPACES.         RMB0003
  2429     03 NOMBRE-OUTMAQ-OK         PIC X(45)  VALUE SPACES.         RMB0003
  2430     03 NOMBRE-INPMAQ-X.                                          RMB0003
  2431        04 FILLER                PIC X(02)  VALUE "A ".           RMB0003
  2432        04 NOMBRE-INPMAQ         PIC X(45)  VALUE SPACES.         RMB0003
  2433     03 PARTICULAS-INPMAQ.                                        RMB0003
  2434        04 BASURA-INPMAQ            PIC X(45).                    RMB0003
  2435        04 P1-INPMAQ                PIC X(45).                    RMB0003
  2436        04 P2-INPMAQ                PIC X(45).                    RMB0003
  2437        04 P3-INPMAQ                PIC X(45).                    RMB0003
  2438        04 P4-INPMAQ                PIC X(45).                    RMB0003
  2439        04 P5-INPMAQ                PIC X(45).                    RMB0003
  2440        04 P6-INPMAQ                PIC X(45).                    RMB0003
  2441        04 P7-INPMAQ                PIC X(45).                    RMB0003
  2442        04 P8-INPMAQ                PIC X(45).                    RMB0003
  2443        04 P9-INPMAQ                PIC X(45).                    RMB0003
  2444        04 P10-INPMAQ               PIC X(45).                    RMB0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  43
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2445 01  SIG-MAQ                     PIC X(1).                        RMB0003
  2446     88 SIG-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
  2447 01  ANT-MAQ                     PIC X(1).                        RMB0003
  2448     88 ANT-VOCAL-MAQ    VALUE "A" "E" "I" "O" "U".               RMB0003
  2449 01  ACTUAL-MAQ                  PIC X(1).                        RMB0003
  2450     88 TILDE-MAQ   VALUE "Á" "É" "Í" "Ó" "Ú" "á" "é" "í" "ó" "ú".RMB0003
  2451     88 QUITAR-MAQ  VALUE  "'" "´"  "`" '"' .                     RMB0003
  2452     88 BORRAR-MAQ  VALUE "-" "." "1" "2" "3" "4"                 RMB0003
  2453                          "5" "6" "7" "8" "9" '0' ")" "," .       RMB0003
  2454     88 ELIMINAR-MAQ VALUE "(" .                                  RMB0003
  2455     88 VALIDO-MAQ   VALUE "A" "B" "C" "D" "E" "F" "G" "H" "I" "J"RMB0003
  2456                           "K" "L" "M" "N" "O" "P" "Q" "R" "S"    RMB0003
  2457                           "T" "U" "V" "W" "X" "Y" "Z" " ".       RMB0003
  2458 01 LLAVE-AUX11-BDAMATCH.
  2459    02  TIPO-ID-AUX11-BDAMATCH    PIC 9(01).
  2460    02  NUM-ID-AUX11-BDAMATCH     PIC 9(11).
  2461    02  COD-SUS-AUX11-BDAMATCH    PIC 9(06).
  2462    02  COD-CTA-AUX11-BDAMATCH    PIC 9(02).
  2463    02  NUM-CTA-AUX11-BDAMATCH    PIC X(18).
  2464 01 LLAVE-AUX13-BDAMATCH.
  2465    02  TIPO-ID-AUX13-BDAMATCH    PIC 9(01).
  2466    02  NUM-ID-AUX13-BDAMATCH     PIC 9(13).
  2467    02  COD-SUS-AUX13-BDAMATCH    PIC 9(06).
  2468    02  COD-CTA-AUX13-BDAMATCH    PIC 9(02).
  2469    02  NUM-CTA-AUX13-BDAMATCH    PIC X(18).
  2470 01 VARIABLES-BDAMATCH.
  2471    02 I2-BDAMATCH                PIC 9(2).                       RMB0003
  2472    02 TIPCTA-BDAMATCH.                                           RMB0003
  2473*******2=CK,1=CR,2=BS,3=CC,4=OT,9=INVALIDO                        RMB0003
  2474       03 FILLER PIC X(30) VALUE "211422244444224442444433442444".RMB0003
  2475       03 FILLER PIC X(30) VALUE "444444444444444444442999999999".RMB0003
  2476       03 FILLER PIC X(30) VALUE "999999999999999999999999999999".RMB0003
  2477       03 FILLER PIC X(10) VALUE "9999999999".                    RMB0003
  2478    02 FILLER REDEFINES TIPCTA-BDAMATCH.                          RMB0003
  2479       03 V-TIPCTA-BDAMATCH  OCCURS 100 TIMES PIC 9.              RMB0003
  2480    02 APELLIDO-INPUT-BDAMATCH    PIC X(60) VALUE SPACES.         RMB0003
  2481    02 ENT-FIN-PORT-BDAMATCH      PIC 9(3)  VALUE 0.              RMB0003
  2482    02 ENT-UNICAS-PORT-BDAMATCH   PIC 9(3)  VALUE 0.              RMB0003
  2483    02 ENT-FIN-MEJ-PORT-BDAMATCH  PIC 9(3)  VALUE 0.              RMB0003
  2484    02 FALLECIDO-BDAMATCH         PIC 9(01) VALUE 0.              RMB0002
  2485    02 IDE-TIPO-BDAMATCH          PIC 9(01) VALUE 0.
  2486    02 ABIERTO-BDAMATCH           PIC 9(01) VALUE 0.
  2487    02 PROCESAR-BDAMATCH          PIC 9(01) VALUE 0.
  2488    02 FIN-BDAMATCH               PIC 9(01) VALUE 0.
  2489    02 NUM-IDE-INPUT-BDAMATCH     PIC 9(11).
  2490    02 TIP-IDE-INPUT-BDAMATCH     PIC 9(01).
  2491    02 I-GRU-BDAMATCH             PIC 9(5) VALUE 0.
  2492    02 GRU-NOM-BDAMATCH           PIC 9(5) VALUE 0.
  2493    02 MOVIDO-BDAMATCH            PIC 9(1) VALUE 0.
  2494    02 BUSCADO-D-BDAMATCH.
  2495       03 BUSCADO-BDAMATCH        PIC 9(3) VALUE 0.
  2496       03 FILLER                  PIC X(1) VALUE " ".
  2497    02 PORINSERTAR-D-BDAMATCH.
  2498       03 PORINSERTAR-BDAMATCH    PIC 9(03) VALUE 0.
  2499       03 FILLER                  PIC X(1) VALUE " ".
  2500    02 EXISTE-BDAMATCH            PIC 9(05) VALUE 0.
  2501    02 MEJOR-PORTAFOLIO-BDAMATCH  PIC 9(05) VALUE 0.
  2502    02 GRU-ANT-BDAMATCH           PIC 9(05) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  44
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2503    02 MAX-CUENTAS-BDAMATCH       PIC 9(05) VALUE 5.
  2504    02 MAX-REL-BDAMATCH           PIC 9(05) VALUE 5.
  2505    02 MAXREL-PER-BDAMATCH        PIC 9(05) VALUE 0.
  2506    02 FIN-FUENTE-BDAMATCH        PIC 9(05) VALUE 0.
  2507    02 FIL-BUS-BDAMATCH           PIC 9(05) VALUE 0.
  2508    02 COL-BUS-BDAMATCH           PIC 9(05) VALUE 0.
  2509    02 FIN-BUSCADO-BDAMATCH       PIC 9(05) VALUE 0.
  2510    02 LIBRE-BUSCADO-BDAMATCH     PIC 9(05) VALUE 0.
  2511    02 FIL-FUE-BDAMATCH           PIC 9(05) VALUE 0.
  2512    02 COL-FUE-BDAMATCH           PIC 9(05) VALUE 0.
  2513    02 I-BDAMATCH                 PIC 9(08) VALUE 0.
  2514    02 J-BDAMATCH                 PIC 9(08) VALUE 0.
  2515    02 I-DIR-BDAMATCH             PIC 9(05) VALUE 0.
  2516    02 I-TEL-BDAMATCH             PIC 9(05) VALUE 0.
  2517    02 I-NOM-BDAMATCH             PIC 9(05) VALUE 0.
  2518    02 I-CTA-BDAMATCH             PIC 9(05) VALUE 0.
  2519    02 NUM-DIR-ANT-BDAMATCH       PIC X(50).
  2520    02 NUM-TEL-ANT-BDAMATCH       PIC 9(15).
  2521    02 CTA-DIR-ANT-BDAMATCH       PIC 9(05).
  2522    02 CTA-TEL-ANT-BDAMATCH       PIC 9(05).
  2523    02 CTA-NOM-ANT-BDAMATCH       PIC 9(05).
  2524    02 GRU-NOM-ANT-BDAMATCH       PIC 9(05).
  2525    02 TABLA-DIR-BDAMATCH.
  2526       03 T-DIR-BDAMATCH OCCURS 501 TIMES.
  2527          04 CTA-DIR-BDAMATCH     PIC 9(03).
  2528          04 NUM-DIR-BDAMATCH     PIC X(50).
  2529          04 NUM-CTAS-DIR-BDAMATCH PIC 9(03).
  2530          04 SUS-DIR-BDAMATCH     PIC 9(06).
  2531          04 LNG-DIR-BDAMATCH     PIC 9(03).
  2532    02 TABLA-TEL-BDAMATCH.
  2533       03 T-TEL-BDAMATCH   OCCURS 501 TIMES.
  2534          04 CTA-TEL-BDAMATCH     PIC 9(03).
  2535          04 NUM-TEL-BDAMATCH     PIC 9(15).
  2536          04 NUM-CTAS-TEL-BDAMATCH PIC 9(03).
  2537          04 SUS-TEL-BDAMATCH     PIC 9(06).
  2538    02 TABLA-NOM-BDAMATCH.
  2539       03 T-NOM-BDAMATCH OCCURS 501 TIMES.
  2540          04 CTA-NOM-BDAMATCH     PIC 9(03).
  2541          04 NOM-NOM-BDAMATCH     PIC X(60).
  2542          04 SUS-NOM-BDAMATCH     PIC 9(06).
  2543          04 GRU-NOMS-BDAMATCH     PIC 9(03).
  2544          04 LNG-NOM-BDAMATCH     PIC 9(02).
  2545    02 TABLA-CUENTAS-BDAMATCH.
  2546       03 T-CUENTAS-BDAMATCH OCCURS 501 TIMES.
  2547          04 CTA-CUENTAS-BDAMATCH PIC X(38).
  2548          04 CTA-FALLECIDO-BDAMATCH   PIC 9(1).                   RMB0002
  2549          04 FUEEXT-CUENTAS-BDAMATCH   PIC 9(1).                  RMB0003
  2550    02 TABLA-GRUNOM-BDAMATCH.
  2551       03 T-GRUNOM-BDAMATCH OCCURS 501 TIMES.
  2552          04 GRUPO-GRUNOM-BDAMATCH PIC 9(03).
  2553          04 NOM-GRUNOM-BDAMATCH   PIC X(60).
  2554          04 NUM-CTAS-GRUNOM-BDAMATCH PIC 9(03).
  2555          04 LNG-GRUNOM-BDAMATCH   PIC 9(02).
  2556          04 APE-GRUNOM-BDAMATCH   PIC 9(03).                     RMB0003
  2557    02  WS-PESOS-CUENTAS-BDAMATCH.
  2558      03  ESTA-CTA-BDAMATCH        PIC  9(01)  VALUE  ZEROS.
  2559      03  INV-BDAMATCH             PIC 9(04) VALUE ZEROS.
  2560      03  SUSC-CTAS-BDAMATCH       PIC 9(06) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  45
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2561      03  SUSC-GRUPO-BDAMATCH.
  2562        05  SUSC-GRUP-SUS-BDAMATCH PIC  9(06)  VALUE  ZEROS.
  2563        05  SUSC-GRUP-GRU-BDAMATCH PIC  9(03)  VALUE  ZEROS.
  2564      03  PESO-CTAS-TOT-BDAMATCH   PIC 9(12) VALUE ZEROS.
  2565      03  PESOS-CTRL-BDAMATCH      PIC 9(12) VALUE ZEROS.
  2566      03  NOM-LIMPI-BDAMATCH       PIC X(60) VALUE SPACES.
  2567      03  CTA-A-BUSCAR-BDAMATCH    PIC 9(03) VALUE ZEROS.
  2568      03  PESO-TEL-BDAMATCH        PIC 9(02) VALUE 1.
  2569      03  PESO-DIR-BDAMATCH        PIC 9(02) VALUE 3.
  2570      03  PESO-NOM-BDAMATCH        PIC 9(02) VALUE 9.
  2571      03  POSIC-TEL-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2572      03  POSIC-DIR-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2573      03  POSIC-NOM-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2574      03  POSIC-GRU-BDAMATCH       PIC 9(02) VALUE ZEROS.
  2575      03  NRO-VECES-1-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2576      03  NRO-VECES-2-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2577      03  NRO-VECES-3-BDAMATCH     PIC 9(03) VALUE ZEROS.
  2578      03  POSIC-SUMA-BDAMATCH      PIC 9(03) VALUE ZEROS.
  2579      03  POSIC-SUSC-BDAMATCH      PIC 9(03) VALUE ZEROS.
  2580      03  POSIC-SUS-GRU-BDAMATCH   PIC 9(03) VALUE ZEROS.
  2581 01 V-INTERRELAC-BDAMATCH.
  2582    02 CARAC-REL-BDAMATCH  OCCURS 501 TIMES PIC X(03).
  2583    02 FILA-REL-BDAMATCH OCCURS 501 TIMES.
  2584       03 COLUMNA-REL-BDAMATCH OCCURS 501 TIMES.
  2585          04 CAJA-BDAMATCH         PIC 9(03).
  2586          04 DELIMITADOR-BDAMATCH  PIC X(01).
  2587 01 VARIABLES-NOMBRES-BDAMATCH.
  2588    03 LIM-BDAMATCH                PIC  9(03) VALUE 500.
  2589    03 DIR-INPUT-BDAMATCH          PIC  X(60).
  2590    03 DIR-OUTPUT-BDAMATCH         PIC  X(60).
  2591    03 CTA-INPUT-BDAMATCH          PIC  X(38).
  2592    03 TEL-INPUT-BDAMATCH          PIC  9(15).
  2593    03 TEL-OUTPUT-BDAMATCH         PIC  9(15).
  2594    03 NOM-INPUT-BDAMATCH          PIC  X(60).
  2595    03 NOM-OUTPUT-BDAMATCH         PIC  X(60).
  2596    03 NUM-MUERTOS-OUTPUT-BDAMATCH PIC  9(03).                    RMB0002
  2597    03 NUM-CTAS-OUTPUT-BDAMATCH    PIC  9(03).                    RMB0002
  2598    03 VALCTA-OUTPUT-BDAMATCH      PIC  9(01).
  2599    03 CAR-ANT-BDAMATCH            PIC  X(01).
  2600    03 CAR-ACT-BDAMATCH            PIC  9(01).
  2601    03 T-CARDIR-BDAMATCH.
  2602       04 V-CARDIR-BDAMATCH       OCCURS 60 TIMES PIC X(01).
  2603    03 T-CARTOT-BDAMATCH.
  2604       04 V-CARTOT-BDAMATCH       OCCURS 10 TIMES PIC 9(05).
  2605 01  TABLA-SUSC-DIR-BDAMATCH.
  2606   03  REG-SUSC-DIR-BDAMATCH   OCCURS 501 TIMES
  2607       ASCENDING KEY IS COD-SUSC-DIR-BDAMATCH  INDEXED BY
  2608                                               IND-DIR-BDAMATCH.
  2609     05  COD-SUSC-DIR-BDAMATCH     PIC 9(06).
  2610     05  FLAG-YA-CTA-BDAMATCH      PIC 9(01).
  2611     05  FLAG-YA-DIR-BDAMATCH      PIC 9(01).
  2612     05  FLAG-YA-TEL-BDAMATCH      PIC 9(01).
  2613     05  FLAG-YA-NOM-BDAMATCH      PIC 9(01).
  2614 01  TABLA-SUSC-NOMBRE-BDAMATCH.
  2615   03  REG-SUSC-NOM-BDAMATCH        OCCURS 501 TIMES
  2616       ASCENDING  KEY  IS  KEY-SUSC-NOM-BDAMATCH  INDEXED
  2617                           BY IND-NOM-BDAMATCH.
  2618     05  KEY-SUSC-NOM-BDAMATCH.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  46
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  2619       07  COD-SUSC-NOM-BDAMATCH   PIC 9(06).
  2620       07  GRUPO-SUS-NOM-BDAMATCH  PIC 9(03).
* 2621 COPY AMNISTIA21.WS.
  2622* AMNISTIA21.v.0004
  2623*******************************************************************
  2624* VARIABLES DEFINIDAS PARA APLICACION DE LEYES, AMNISTIA, PARA
  2625* CLEENTES SEGUN FECHA DE PROMULGACION DE LA LEY
  2626*******************************************************************
  2627* JGR  FECHA:20/08/2007 06:19:07 p.m.
  2628* CAV  FECHA:16/01/2008
  2629******************************************************************
  2630* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*
  2631* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *
  2632* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *
  2633******************************************************************
  2634* GJC0003    | LEY002 - DEFINICIONES PARA APLICACION DE LEY DEFINI*
  2635* G. JIMENEZ |  TIVO. DOBLE EL TIEMPODE LA MORA                   *
  2636* 23-ENE-2009|                                                    *
  2637*******************************************************************
  2638* GJC0004    | CADUC1 - SE DEFINEN LAS VARIABLES NECESARIAS PARA  *
  2639* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE  *
  2640* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13         *
  2641*******************************************************************
  2642 01  ABD07-AMNIST21             PIC  X(220) VALUE SPACES.
  2643 01  MESES-FALTAN-AMNIST21      PIC  9(03)  VALUE 999.
  2644 01  FECHA-INI-AMNIST21         PIC 9(06) VALUE ZEROS.
  2645 01  FECHA-INI-AMNIST21-R REDEFINES FECHA-INI-AMNIST21.
  2646     03 ANO-INI-AMNIST21        PIC 9(04).
  2647     03 MES-INI-AMNIST21        PIC 9(02).
  2648 01  VERSION-AMNIST21           PIC 9      VALUE ZEROS.
  2649 01  MESES-GRACIA-AMNIST21      PIC 9(02)  VALUE 06.
  2650 01  MESES-CANCELAC-AMNIST21    PIC 9(02)  VALUE 12.
  2651
  2652 01  WORK-CLIENTE-AMNIST21.
  2653     03 CTAS-MEN12-AMNIST21     PIC  9(01) VALUE ZEROS.
  2654     03 CTAS-MAY12-AMNIST21     PIC  9(01) VALUE ZEROS.
  2655     03 MESES-NOV-AMNIST21      PIC  9(04) VALUE ZEROS.
  2656     03 MESES-VEC-AMNIST21      PIC  9(04) VALUE ZEROS.
  2657     03 MESES-GRC-AMNIST21      PIC  9(04) VALUE ZEROS.
  2658     03 MORAS-ACTUAL-AMNIST21   PIC  9(05) VALUE ZEROS.
  2659     03 TIPO-ID-MAES-AMNIST21   PIC  9(01) VALUE ZEROS.
  2660     03 NUM-ID-MAES-AMNIST21    PIC  9(11) VALUE ZEROS.
  2661     03 K-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2662     03 L-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2663     03 M-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2664     03 X-AMNIST21              PIC  9(03) VALUE ZEROS.           GJC0003
  2665     03 Z-AMNIST21              PIC  9(03)  VALUE ZEROS.          GJC0003
  2666     03 IND-APLICO-CAD-AMNIST21 PIC  9(01) VALUE ZEROS.           GJC0004
  2667     03 FEC-NOVEDAD-AMNIST21.
  2668        05 ANO-NOV-AMNIST21     PIC  9(04) VALUE ZEROS.
  2669        05 MES-NOV-AMNIST21     PIC  9(02) VALUE ZEROS.
  2670     03 FECHA-AUX-AMNIST21      PIC  9(04).
  2671     03 FECHA-AUX-AMNIST21-R REDEFINES FECHA-AUX-AMNIST21.
  2672        05 MES-AUX-AMNIST21     PIC  9(02).
  2673        05 ANO-AUX-AMNIST21     PIC  9(02).
  2674*---------------------------------------------------------------*
  2675 01  LLAVE-INI-AMNIST21.
  2676     03 TIPO-ID-AMNIST21        PIC  9.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  47
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2677     03 NUM-ID-AMNIST21         PIC  9(11).
  2678     03 COD-SUS-AMNIST21        PIC  9(6).
  2679     03 COD-CTA-AMNIST21        PIC  99.
  2680     03 NUM-CTA-AMNIST21        PIC  X(18).
  2681*---------------------------------------------------------------*
  2682 01  REG-SUSCRIPTOR-AMNISTIA21  PIC X(220).
  2683*01  SW-CANDIDATO-AMNIST21      PIC 9(01) VALUE ZEROS.            GJC0003
  2684*---------------------------------------------------------------*
  2685 01  MUMERO-ID-AMNIST21.
  2686     03 SW-AMNIST21             PIC  9(01) VALUE ZEROS.
  2687     03 SW-SALIR-VECT           PIC  9(01) VALUE ZEROS.
  2688     03 TIPO-ID-INI-AMNIST21    PIC  9(01) VALUE ZEROS.
  2689     03 NUME-ID-INI-AMNIST21    PIC  9(11) VALUE ZEROS.
  2690*---------------------------------------------------------------*
  2691 01  FECHA-MILENIO-AMNIST21.
  2692     03 FMILENIO-SIGLO-AMNIST21 PIC  9(02).
  2693     03 FMILENIO-ANIO-AMNIST21  PIC  9(02).
  2694     03 FMILENIO-MES-AMNIST21   PIC  9(02).
  2695*---------------------------------------------------------------*
  2696*   PRUEBAS  FECHA 200608                                       *
  2697*---------------------------------------------------------------*
  2698 01  FECHA-HOY-AMNIST21         PIC X(08).
  2699 01  FECHA-HOY-AMNIST21-R  REDEFINES FECHA-HOY-AMNIST21.
  2700     03 FECHA-SYS-AMNIST21.
  2701        05 ANO-HOY-AMNIST21     PIC 9(04).
  2702        05 MES-HOY-AMNIST21     PIC 9(02).
  2703     03 DIA-HOY-AMNIST21        PIC 9(02).
  2704*---------------------------------------------------------------*
  2705 01  FECHA-GRACIA-AMNIST21.
  2706     05 ANO-GRACIA-AMNIST21     PIC  9(04) VALUE ZEROS.
  2707     05 MES-GRACIA-AMNIST21     PIC  9(02) VALUE ZEROS.
  2708*---------------------------------------------------------------
  2709 01  VECTOR-AMNISTA21.
  2710     03 VECTOR1-AMNIST21        PIC 9(12) VALUE ZEROS.
  2711     03 VECTOR2-AMNIST21        PIC 9(12) VALUE ZEROS.
  2712     03 VECTOR3-AMNIST21        PIC 9(12) VALUE ZEROS.
  2713     03 VECTOR4-AMNIST21        PIC 9(12) VALUE ZEROS.
  2714*---------------------------------------------------------------
  2715 01  VECT-AMNIST21.
  2716     03 VECT1-AMNIST21          PIC 9(12).
  2717     03 VECT2-AMNIST21          PIC 9(12).
  2718     03 VECT3-AMNIST21          PIC 9(12).
  2719     03 VECT4-AMNIST21          PIC 9(12).
  2720     03 HISTORIA-TOTAL-AMNIST21.
  2721        05 VECTOR-TOT-AMNIST21  PIC X(48).
  2722     03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.
  2723        05 V-VEC-AMNIST21  OCCURS 48 TIMES PIC X.
  2724*---------------------------------------------------------------
  2725*TABLA QUE IDENTIFICA EL ESTADO DEL REGISTRO POR LA NOVEDAD
  2726* 0-OBLIGACION CANCELADA
  2727* 1-OBLIGACIONES ABIERTAS
  2728*---------------------------------------------------------------
  2729 01  TAB-VIGENTES-AMNIST21.
  2730     03 TABLA-VIGENTES-AMNIST21.
  2731        05 FILLER        PIC X(10)   VALUE  "1000000000".
  2732        05 FILLER        PIC X(10)   VALUE  "0011111111".
  2733        05 FILLER        PIC X(10)   VALUE  "1111111111".
  2734        05 FILLER        PIC X(10)   VALUE  "1111111111".
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  48
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2735        05 FILLER        PIC X(10)   VALUE  "1111101101".
  2736     03 TABLA-VIGENTES-AMNIST21-R REDEFINES
  2737        TABLA-VIGENTES-AMNIST21.
  2738        05 TAB-VIG-CART-AMNIST21   OCCURS 50 TIMES  PIC 9(01).
  2739*---------------------------------------------------------------*
  2740 01  TABLAS-CR-AMNIST21.
  2741     03 TABLA-NOV-CAR-AMNIST21.                                   GJC0003
  2742        05  FILLER  PIC X(35) VALUE                               GJC0003
  2743            "01 01 5 AL DIA         1718192001 5".                GJC0003
  2744        05  FILLER  PIC X(35) VALUE                               GJC0003
  2745            "02 02 5 TDC NO RECLAMAD0000000000 0".                GJC0003
  2746        05  FILLER  PIC X(35) VALUE                               GJC0003
  2747            "08 03 5 TDC CANC.MALMAN0000000000 0".                GJC0003
  2748        05  FILLER  PIC X(35) VALUE                               GJC0003
  2749            "04 04 5 TDC ROBADA     0000000000 0".                GJC0003
  2750        05  FILLER  PIC X(35) VALUE                               GJC0003
  2751            "05 05 5 CANCEL.VOLUNTAR0000000000 0".                GJC0003
  2752        05  FILLER  PIC X(35) VALUE                               GJC0003
  2753            "06 06 5 CANCEL.MMX<60  0000000000 0".                GJC0003
  2754        05  FILLER  PIC X(35) VALUE                               GJC0003
  2755            "07 07 5 TDC EXTRAVIADA 0000000000 0".                GJC0003
  2756        05  FILLER  PIC X(35) VALUE                               GJC0003
  2757            "03 08 5 PAGO VOLUNT.SAT0000000000 0".                GJC0003
  2758        05  FILLER  PIC X(35) VALUE                               GJC0003
  2759            "03 09 5 PAGO.MMX.A.30  09EEEEEE08 0".                GJC0003
  2760        05  FILLER  PIC X(35) VALUE                               GJC0003
  2761            "03 10 5 PAGO.MMX.A.60  0910EEEE08 0".                GJC0003
  2762        05  FILLER  PIC X(35) VALUE                               GJC0003
  2763            "03 11 5 PAGO.MORA.90   091011EE08 0".                GJC0003
  2764        05  FILLER  PIC X(35) VALUE                               GJC0003
  2765            "03 12 5 PAGO.VOL.MOR1200910111208 0".                GJC0003
  2766        05  FILLER  PIC X(35) VALUE                               GJC0003
  2767            "01 13 5 MORA.30.AL.DIA 1727282913 1".                GJC0003
  2768        05  FILLER  PIC X(35) VALUE                               GJC0003
  2769            "01 14 5 MORA.60.AL.DIA 3031323314 2".                GJC0003
  2770        05  FILLER  PIC X(35) VALUE                               GJC0003
  2771            "01 15 5 MORA.90.AL.DIA 3435363715 3".                GJC0003
  2772        05  FILLER  PIC X(35) VALUE                               GJC0003
  2773            "01 16 5 MORA.120.AL.DIA3839404116 4".                GJC0003
  2774        05  FILLER  PIC X(35) VALUE                               GJC0003
  2775            "12 17 1 ESTA.MORA.30   1718192013 1".                GJC0003
  2776        05  FILLER  PIC X(35) VALUE                               GJC0003
  2777            "13 18 2 ESTA.MORA.60   2118192014 2".                GJC0003
  2778        05  FILLER  PIC X(35) VALUE                               GJC0003
  2779            "14 19 3 ESTA.MORA.90   2223192015 3".                GJC0003
  2780        05  FILLER  PIC X(35) VALUE                               GJC0003
  2781            "15 20 4 ESTA.MORA.120  2425262016 4".                GJC0003
  2782        05  FILLER  PIC X(35) VALUE                               GJC0003
  2783            "12 21 1 FU.60.Y.ESTA.302118192014 2".                GJC0003
  2784        05  FILLER  PIC X(35) VALUE                               GJC0003
  2785            "12 22 1 FU.90.Y.ESTA.302223192015 3".                GJC0003
  2786        05  FILLER  PIC X(35) VALUE                               GJC0003
  2787            "13 23 2 FU.90.Y.ESTA.602223192015 3".                GJC0003
  2788        05  FILLER  PIC X(35) VALUE                               GJC0003
  2789            "12 24 1 FU.120.ESTA.30 2425262016 4".                GJC0003
  2790        05  FILLER  PIC X(35) VALUE                               GJC0003
  2791            "13 25 2 FU.120.ESTA.60 2425262016 4".                GJC0003
  2792        05  FILLER  PIC X(35) VALUE                               GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  49
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2793            "14 26 3 FU.120.ESTA.90 2425262016 4".                GJC0003
  2794        05  FILLER  PIC X(35) VALUE                               GJC0003
  2795            "13 27 2 RE.30.ESTA.60  2127282914 2".                GJC0003
  2796        05  FILLER  PIC X(35) VALUE                               GJC0003
  2797            "14 28 3 RE.30.Y.ESTA.902223282915 3".                GJC0003
  2798        05  FILLER  PIC X(35) VALUE                               GJC0003
  2799            "15 29 4 RE.30.ESTA.120 2425262916 4".                GJC0003
  2800        05  FILLER  PIC X(35) VALUE                               GJC0003
  2801            "12 30 1 RE.60.Y.ESTA.303031323314 2".                GJC0003
  2802        05  FILLER  PIC X(35) VALUE                               GJC0003
  2803            "13 31 2 RE.60.Y.ESTA.602131323314 2".                GJC0003
  2804        05  FILLER  PIC X(35) VALUE                               GJC0003
  2805            "14 32 3 RE.60.Y.ESTA.902223323315 3".                GJC0003
  2806        05  FILLER  PIC X(35) VALUE                               GJC0003
  2807            "15 33 4 RE.60.ESTA.120 2425263316 4".                GJC0003
  2808        05  FILLER  PIC X(35) VALUE                               GJC0003
  2809            "12 34 1 RE.90.Y.ESTA.303435363715 3".                GJC0003
  2810        05  FILLER  PIC X(35) VALUE                               GJC0003
  2811            "13 35 2 RE.90.Y.ESTA.603435363715 3".                GJC0003
  2812        05  FILLER  PIC X(35) VALUE                               GJC0003
  2813            "14 36 3 RE.90.Y.ESTA.902223363715 3".                GJC0003
  2814        05  FILLER  PIC X(35) VALUE                               GJC0003
  2815            "15 37 4 RE.90.ESTA.120 2425263716 4".                GJC0003
  2816        05  FILLER  PIC X(35) VALUE                               GJC0003
  2817            "12 38 1 RE.120.ESTA.30 3839404116 4".                GJC0003
  2818        05  FILLER  PIC X(35) VALUE                               GJC0003
  2819            "13 39 2 RE.120.ESTA.60 3839404116 4".                GJC0003
  2820        05  FILLER  PIC X(35) VALUE                               GJC0003
  2821            "14 40 3 RE.120.ESTA.90 3839404116 4".                GJC0003
  2822        05  FILLER  PIC X(35) VALUE                               GJC0003
  2823            "15 41 4 RE.120.ESTA.1202425264116 4".                GJC0003
  2824        05  FILLER  PIC X(35) VALUE                               GJC0003
  2825            "20 42   ADJ.NO.LOCALIZA0000000000 0".                GJC0003
  2826        05  FILLER  PIC X(35) VALUE                               GJC0003
  2827            "21 43   ADJ.CTA.COBRADO0000000000 0".                GJC0003
  2828        05  FILLER  PIC X(35) VALUE                               GJC0003
  2829            "22 44   FALLECIDO      0000000000 0".                GJC0003
  2830        05  FILLER  PIC X(35) VALUE                               GJC0003
  2831            "09 45 4 CARTERA.CASTIGA0000000000 4".                GJC0003
  2832        05  FILLER  PIC X(35) VALUE                               GJC0003
  2833            "10 46 5 CARTERA.RECUPER0000000000 5".                GJC0003
  2834        05  FILLER  PIC X(35) VALUE                               GJC0003
  2835            "11 47 4 DUDOSO.RECAUDO 0000000000 4".                GJC0003
  2836        05  FILLER  PIC X(35) VALUE                               GJC0003
  2837            "23 48   CONSULTA       0000000000 0".                GJC0003
  2838        05  FILLER  PIC X(35) VALUE                               GJC0003
  2839            "49 49 5 NO RENOVADA    0000000000 0".                GJC0003
  2840        05  FILLER  PIC X(35) VALUE                               GJC0003
  2841            "50                     0000000000 0".                GJC0003
  2842     03  TABLA-NOV-CAR-AMNIST21-R  REDEFINES
  2843                                     TABLA-NOV-CAR-AMNIST21.
  2844         05  TAB-NOV-CARTERA-AMNIST21   OCCURS  50  TIMES.
  2845             07 NOV-CART-CODINT-AMNIST21 PIC 9(02).
  2846             07 FILLER                   PIC X.                   GJC0003
  2847             07 NOV-CART-COD-AMNIST21    PIC 9(02).
  2848             07 FILLER                   PIC X.                   GJC0003
  2849             07 NOV-CART-MORA-AMNIST21   PIC 9(01).               GJC0003
  2850             07 FILLER                   PIC X.                   GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  50
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2851             07 NOV-CART-NOM-AMNIST21    PIC X(15).
  2852             07 NOV-CRUCES-AMNIST21   OCCURS 5 TIMES PIC X(2).    GJC0003
  2853             07 FILLER                   PIC X.                   GJC0003
  2854             07 NOV-CART-MORMAX-AMNIST21 PIC 9(01).               GJC0003
  2855*---------------------------------------------------------------*
  2856* DEFINICION DE VARIABLES DE AMBIENTE
  2857*---------------------------------------------------------------*
  2858  01 VAR-AMBIENTE-AMNIST21          PIC X(10) VALUE "FECHA_AMNI".
  2859  01 VAR-AMB-HOY-AMNIST21           PIC X(10) VALUE "FECHA_HOY ". GJC0003
  2860  01 VAR-FEC-AMB-AMNIST21.                                        GJC0003
  2861     03 ANO-VAR-FEC-AMB-AMNIST21    PIC 9(04).                    GJC0003
  2862     03 MES-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003
  2863     03 DIA-VAR-FEC-AMB-AMNIST21    PIC 9(02).                    GJC0003
  2864* 01  WS-FECHA-HISTORICA         PIC  9(08) VALUE  ZEROS.         GJC0003
  2865* 01                       REDEFINES  WS-FECHA-HISTORICA.         GJC0003
  2866*   03  WS-FECHA-HIST-ANNO       PIC  9(04).                      GJC0003
  2867*   03  WS-FECHA-HIST-MES        PIC  9(02).                      GJC0003
  2868*   03  WS-FECHA-HIST-DIA        PIC  9(02).                      GJC0003
  2869
  2870*----------------------------------------------------------------*
  2871*DEFINICION DE LAS VALIABLES QUE SE UTILIZAN PARA EL CALCULO DE  *
  2872*LEY ARTICULO 13 DOBLE DEL TIEMPO DE LA MORA
  2873*----------------------------------------------------------------*
  2874  01 VAR-LEY-DOBLE-DE-MORA-AMNIST21.                              GJC0003
  2875     03 SW-ART13-AMNIST21   PIC 9 VALUE 1. *> APLICAR SIEMPRE LEY GJC0003
  2876     03 VECTORES-13-AMNIST21.                                     GJC0003
  2877* VECTOR DE MORAS DE LA PERSONA                                   GJC0003
  2878        05 VECTOR-MORAS-IDE-13-AMNIST21 PIC X(100) VALUE ALL "5". GJC0003
  2879        05 VEC-MOR-IDE-13-AMNIST21 REDEFINES                      GJC0003
  2880           VECTOR-MORAS-IDE-13-AMNIST21 PIC 9 OCCURS 100 TIMES.   GJC0003
  2881* VECTOR DE LA CUENTA REAL                                        GJC0003
  2882        05 VECTOR-TOT-CTA-AMNIST21.                               GJC0003
  2883           07  VECTOR-4-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2884           07  VECTOR4-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2885               VECTOR-4-CTA-AMNIST21  PIC X(12).                  GJC0003
  2886           07  VECTOR-3-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2887           07  VECTOR3A-CTA-AMNIST21 REDEFINES                    GJC0003
  2888               VECTOR-3-CTA-AMNIST21  PIC X(12).                  GJC0003
  2889           07  VECTOR-2-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2890           07  VECTOR2-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2891               VECTOR-2-CTA-AMNIST21  PIC X(12).                  GJC0003
  2892           07  VECTOR-1-CTA-AMNIST21  PIC 9(12) VALUE 0.          GJC0003
  2893           07  VECTOR1-A-CTA-AMNIST21 REDEFINES                   GJC0003
  2894               VECTOR-1-CTA-AMNIST21  PIC X(12).                  GJC0003
  2895           07  MOR-EST-CTA-AMNIST21   PIC 9     VALUE 0.          GJC0003
  2896        05 VEC-TOT-CTA-AMNIST21 REDEFINES                         GJC0003
  2897              VECTOR-TOT-CTA-AMNIST21 OCCURS 49 TIMES PIC 9.      GJC0003
  2898* VECTOR DE LA CUENTA SOBRE EL QUE SE BUSCA SI SE PERDONA         GJC0003
  2899       05 VECTOR-TOT-CTA2-AMNIST21.                               GJC0003
  2900           07  VECTOR-4-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2901           07  VECTOR4-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2902               VECTOR-4-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2903           07  VECTOR-3-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2904           07  VECTOR3A-CTA2-AMNIST21 REDEFINES                   GJC0003
  2905               VECTOR-3-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2906           07  VECTOR-2-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2907           07  VECTOR2-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2908               VECTOR-2-CTA2-AMNIST21  PIC X(12).                 GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  51
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2909           07  VECTOR-1-CTA2-AMNIST21  PIC 9(12) VALUE 0.         GJC0003
  2910           07  VECTOR1-A-CTA2-AMNIST21 REDEFINES                  GJC0003
  2911               VECTOR-1-CTA2-AMNIST21  PIC X(12).                 GJC0003
  2912           07  MOR-EST-CTA2-AMNIST21   PIC 9     VALUE 0.         GJC0003
  2913           07  MOR-MORA-CTA2-AMNIST21  PIC 9     VALUE 1.         GJC0003
  2914        05 VEC-TOT-CTA2-AMNIST21 REDEFINES                        GJC0003
  2915              VECTOR-TOT-CTA2-AMNIST21 OCCURS 50 TIMES PIC 9.     GJC0003
  2916* VECTOR DE CUENTA EN 100 POSICIONES NORMALIZADO                  GJC0003
  2917        05 VECTOR-100-CTA-AMNIST21     PIC X(101).                GJC0003
  2918        05 VEC-100-CTA-AMNIST21 REDEFINES                         GJC0003
  2919           VECTOR-100-CTA-AMNIST21 pic 9 OCCURS 101 TIMES.        GJC0003
  2920* VECTOR DE LAPSOS DE MORAS                                       GJC0003
  2921        05 VECTOR-LAPSOS OCCURS 30 TIMES.                         GJC0003
  2922           07 PERDON-GRUPO-AMNIST21  PIC 9(01).                   GJC0003
  2923           07 INI-GRUPO-AMNIST21     PIC 9(02).                   GJC0003
  2924           07 LONG-GRUPO-AMNIST21    PIC 9(02).                   GJC0003
  2925                                                                  GJC0003
  2926     03 VARIALES-MORAS-13-AMNIST21.                               GJC0003
  2927        05 LONG-LAPSO-13-AMNIST21 PIC 9(02) VALUE 0.              GJC0003
  2928        05 MAX-LONG-LAPSO-13-AMNIST21 PIC 9(02).                  GJC0003
  2929     03  OTRAS-VAR-13-AMNIS21.                                    GJC0003
  2930        05 CINCOS-AMNIST21        PIC X(100) VALUE ALL "5".       GJC0003
  2931        05 UNOS-AMNIST21          PIC X(100) VALUE ALL "1".       GJC0003
  2932        05 MAYOR-LAPSO-AMNIST21   PIC 9(02).                      GJC0003
  2933        05 SALIR-AMNIST21         PIC 9.                          GJC0003
  2934        05 CTA-PERDONADA-AMNIST21 PIC 9.                          GJC0003
  2935        05 LAPSO-AMNIST21         PIC 9(02).                      GJC0003
  2936        05 MESES-MORAS-AMNIST21   PIC 9(02).                      GJC0003
  2937        05 ESTOY-MOROSO-AMNIST21  PIC 9.                          GJC0003
  2938        05 MESES-AMNIST21         PIC 9(3).                       GJC0003
  2939        05 FEC-NOV-AUX-AMNIST21 PIC 9(4).                         GJC0003
  2940        05 FEC-NOV-AUX1-AMNIST21 PIC 9(4).                        GJC0003
  2941        05 FEC-SIT-45Y47-AMNIST21 PIC 9(6).                       GJC0003
  2942        05 FEC-SIT-45Y47-R-AMNIST21 REDEFINES                     GJC0003
  2943           FEC-SIT-45Y47-AMNIST21.                                GJC0003
  2944           07 MES-SIT-AMNIST21     PIC 9(02).                     GJC0003
  2945           07 ANO-SIT-AMNIST21     PIC 9(04).                     GJC0003
  2946*DEFINICION DE VARIABLES PARA HACER RECALCULO DE ESTADO Y OTROS CAGJC0003
  2947 01 VARIABLES-RECALCULO.                                          GJC0003
  2948    03 HISTORIA-TOTAL-AMNIST21.                                   GJC0003
  2949       05 VECTOR-1-AMNIST21        PIC X(12).                     GJC0003
  2950       05 VECTOR-2-AMNIST21        PIC X(12).                     GJC0003
  2951       05 VECTOR-3-AMNIST21        PIC X(12).                     GJC0003
  2952       05 VECTOR-4-AMNIST21        PIC X(12).                     GJC0003
  2953       05 EST-HIST-AMNIST21        PIC X(1).                      GJC0003
  2954    03 FILLER REDEFINES HISTORIA-TOTAL-AMNIST21.                  GJC0003
  2955       05 V-VECTOR-AMNIST21   OCCURS 49 TIMES PIC X.              GJC0003
  2956    03 FIN-AMNIST21                 PIC 9 VALUE 0.                GJC0003
  2957    03 FIN-MATRIZ-AMNIST21          PIC 99 VALUE 0.               GJC0003
  2958    03 ESTADO-AMNIST21              PIC 99.                       GJC0003
  2959    03 ESTADO-INI-AMNIST21          PIC 99.                       GJC0003
  2960    03 ESTADO-FIN-AMNIST21          PIC 99.                       GJC0003
  2961    03 ESTADO-INI48-AMNIST21          PIC 99.                     GJC0003
  2962    03 ESTADO-FIN48-AMNIST21          PIC 99.                     GJC0003
  2963    03 FECHA-AMNIST21.                                            GJC0003
  2964       05 ANO-T-AMNIST21            PIC 9(4).                     GJC0003
  2965       05 FILLER REDEFINES ANO-T-AMNIST21.                        GJC0003
  2966          07 SIGLO-AMNIST21         PIC 99.                       GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  52
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  2967          07 ANO-AMNIST21           PIC 9(2).                     GJC0003
  2968       05 MES-AMNIST21              PIC 9(2).                     GJC0003
  2969    03 FECHA-1-AMNIST21.                                          GJC0003
  2970       05 ANO-T-1-AMNIST21          PIC 9(4).                     GJC0003
  2971       05 FILLER REDEFINES ANO-T-1-AMNIST21.                      GJC0003
  2972          07 SIGLO-1-AMNIST21       PIC 99.                       GJC0003
  2973          07 ANO-1-AMNIST21         PIC 9(2).                     GJC0003
  2974       05 MES-1-AMNIST21            PIC 9(2).                     GJC0003
  2975    03 FEC-INI-MOR-AMNIST21         PIC 9(6).                     GJC0003
  2976    03 MES-MORA-MAX-AMNIST21        PIC 9(2).                     GJC0003
  2977    03 MES-MORA-MAX-48-AMNIST21        PIC 9(2).                  GJC0003
  2978    03 FEC-MM-AA-AMNIST21           PIC 9(4).                     GJC0003
  2979    03 FEC-MM-AAAA-AMNIST21         PIC 9(6).                     GJC0003
  2980    03 NOV-ENT-AMNIST21             PIC 9(02).                    GJC0003
  2981    03 FEC-NOV-AMNIST21             PIC 9(04).                    GJC0003
  2982    03 FEC-MORMAX-AMNIST21          PIC 9(06).                    GJC0003
  2983    03 FEC-MORMAX-48-AMNIST21       PIC 9(06).                    GJC0003
  2984    03 MORMAX-AMNIST21              PIC 9(01).                    GJC0003
  2985    03 MORMAX48-AMNIST21            PIC 9(01).                    GJC0003
  2986    03 NUM-MOR30-AMNIST21           PIC 9(02).                    GJC0003
  2987    03 NUM-MOR30-48-AMNIST21        PIC 9(02).                    GJC0003
  2988    03 NOV-SAL-AMNIST21             PIC 9(02).                    GJC0003
  2989    03 FEC-NOV-48-AMNIST21          PIC 9(04).                    GJC0003
  2990    03 NOV-SAL-48-AMNIST21          PIC 9(02).                    GJC0003
  2991    03 POSICION-INI-AMNIST21        PIC 9(03).                    GJC0003
  2992
  2993
* 2994 COPY VALNOM.WS.
  2999* GJC0002    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION
  3000* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES
  3001* MARZO/2003 *
  3002*************************************************************************
  3003  01 VARIABLES-VALNOM.
  3004     03 VECTOR-INPUT-VALNOM.
  3005       04 VM-INPUT-VALNOM     OCCURS 20 TIMES .
  3006          05 VMM-INPUT-VALNOM OCCURS 15 TIMES PIC X.
  3007     03 VECTOR-OK-VALNOM.
  3008       04 VM-OK-VALNOM         OCCURS 20 TIMES.
  3009          05 VMM-OK-VALNOM    OCCURS 15 TIMES PIC X.
  3010     03 BLOQOK-AUX-VALNOM           PIC 9(2).
  3011     03 CADENA-VALNOM.
  3012        04 FILLER                   PIC X(2) VALUE "A ".
  3013        04 NOMBRE-AUX-VALNOM        PIC X(65).
  3014        04 FILLER REDEFINES NOMBRE-AUX-VALNOM.
  3015           05 VNOM-AUX-VALNOM OCCURS 65 TIMES PIC X.
  3016     03 BASURA-VALNOM               PIC X(10).
  3017     03 BLOQUES-INPUT-VALNOM        PIC 9(2).
  3018     03 NOMBRE-INPUT-VALNOM         PIC X(65).
  3019     03 FILLER REDEFINES NOMBRE-INPUT-VALNOM.
  3020        05 V-NOMBRE-VALNOM          PIC X OCCURS 65 TIMES.
  3021     03 NOMBOK-INPUT-VALNOM         PIC X(65).
  3022     03 FILLER REDEFINES NOMBOK-INPUT-VALNOM.
  3023        05 V-NOMBOK-VALNOM          PIC X OCCURS 65 TIMES.
  3024     03 TIP-ID-INPUT-VALNOM         PIC 9(02).
  3025     03 MATCH-OK-OUT-VALNOM         PIC 9(01).
  3026     03 A-VALNOM                    PIC 9(05).
  3027     03 I-VALNOM                    PIC 9(05).                    GJC0002
  3028     03 J-VALNOM                    PIC 9(05).                    GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  53
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  3029     03 K-VALNOM                    PIC 9(05).                    GJC0002
  3030     03 L-VALNOM                    PIC 9(05).                    GJC0002
  3031     03 M-VALNOM                    PIC 9(05).                    GJC0002
  3032     03 INI-VALNOM                  PIC 9(02).
  3033     03 LON-VALNOM                  PIC 9(02).
  3034     03 LETRAS-OK-VALNOM            PIC 9(02).
  3035     03 LETRAS-OK2-VALNOM           PIC 9(02).
  3036     03 TOTLET-OK-VALNOM            PIC 9(02).
  3037     03 TOTLET-INP-VALNOM           PIC 9(02).
  3038     03 PEDAZO-VALNOM               PIC X(15).
  3039     03 POR-TOT-VALNOM              PIC 9(05).
  3040     03 POR-INP-VALNOM              PIC 9(05).
  3041     03 APROX-TOT-VALNOM            PIC 9(05).
  3042     03 APROX-INP-VALNOM            PIC 9(05).
  3043     03 VECTORES-VALNOM.                                          GJC0002
  3044        04 FILLER                   OCCURS 256 TIMES.             GJC0002
  3045           05 CONT-LET-INPUT-VALNOM PIC 9(2).                     GJC0002
  3046           05 CONT-LET-OK-VALNOM    PIC 9(2).                     GJC0002
  3047     03 VAL-APELLIDO-VALNOM         PIC 9.                        GJC0002
* 3048 COPY DIRECC.WS.
  3053* VHF0004     * SE ADICIONAN NOMBRES DE ARCHIVOS DE              *
  3054* VICTOR HUGO * ESTANDARIZACION DE DIRECCIONES                  *
  3055* FORERO      *                                                  *
  3056* JUL.08/2002 *                                                  *
  3057******************************************************************
  3058* FAC0005     * HDIR01 * INCLUSION RUTA PARA MAESTRO HISTORICO DE*
  3059* F.CUADROS C.* DIRECCIONES                                      *
  3060* MAR.04/2003 *                                                  *
  3062* FAC0006     * BDLLOC * AMPLIACION DE LAS OCURRENCIAS DEL VECTOR*
  3063* F.CUADROS C.* T-LOCALIZACION PARA NUEVOS CAMPOS DE MAESTROS DEL*
  3064* DIC.11/2003 * CLUB BDLCLI
  3066* FAC0007     * AMPDIR * AMPLIACIÓN DE LA ESTRUCTURA DE ARCHIVOS*
  3067* F.CUADROS C.* ICBDIR Y BDUHDIR. SE AMPLIAN LOS TAMAÑOS DE LOS *
  3068* FEB.14/2006 * CAMPOS: TELÉFONOS, DIRECCIONES, CIUDADES, DPTOS.*
  3070* VHF0008     * RCNCER - SE INCLUYE TITULO DE ARCHIVO DE        *
  3071* VICTOR HUGO *          ACEPCIONES DE CIUDADES PARA OPTIMIZAR  *
  3072* FORERO      *          PRODUCTO RECONOCER.                    *
  3073* JUL.06/2006 *                                                 *
  3074* FAC0008     *          SE INCLUYEN CONTROLES EN HISTÓRICO PARA*
  3075* JUL.18/2006 *          GEORREFERENCIACIÓN                     *
  3076*****************************************************************
  3077* CAV0009      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI  *
  3078* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA  *
  3079* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION            *
  3080*****************************************************************
  3081* VHF0010      * FASEII - SE ADICIONAN NUEVAS VARIABLES PARA EL  *
  3082* VICTOR HUGO  *          ACTUALIZADOR                           *
  3083* FORERO       *                                                 *
  3084* JUL.25/2008  *                                                 *
  3085******************************************************************
  3086 01 CONTADORES-DIRECC.
  3087    03 TOTAL-DIRECC            PIC 9(8) VALUE 0.
  3088    03 CAMBIOS-DIRECC          PIC 9(8) VALUE 0.
  3089    03 SINCAMBIOS-DIRECC       PIC 9(8) VALUE 0.
  3090    03 CREACIONES-DIRECC       PIC 9(8) VALUE 0.
  3091    03 ERRORES-DIRECC          PIC 9(8) VALUE 0.
  3092    03 CAMPOSVACIOS-DIRECC     PIC 9(8) VALUE 0.
  3093    03 MENOSACTUAL-DIRECC      PIC 9(8) VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  54
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/DIRE
  3094    03 ERRLLAVE-DIRECC         PIC 9(8) VALUE 0.
  3095 01 VARIABLES-DIRECC.
  3096    03 IND-DIRECC              PIC 9 VALUE 0.
  3097    03 FECHA6-DIRECC           PIC 9(06).
  3098    03 ERROR-DIRECC            PIC 9 VALUE 0.
  3099    03 CAMBIO-DIRECC           PIC 9 VALUE 0.
  3100    03 REG-CSV-DIRECC          PIC 9(1).                          CAV0009
  3101    03 MAES-DIRECC-TITLE PIC X(50) VALUE "$DIRECCIONES/ICBDIR".
  3102    03 TITLE-DIREST            PIC X(40) VALUE                    VHF0004
  3103       "$DIRECCIONES/DIREST".                                     VHF0004
  3104    03 TITLE-DIRCON            PIC X(40) VALUE                    VHF0004
  3105       "$DIRECCIONES/DIRCON".                                     VHF0004
  3106    03 VALLOC-DIRECC.
  3107       04 T-LOCALIZACION OCCURS 15 TIMES PIC 9.                   FAC0006
  3108    03 MAES-BDUHDIR-TITLE PIC X(20) VALUE "$DIRECCIONES/BDUHDIR". FAC0005
  3109    03 TITLE-BDLSTDCIU    PIC X(80)  VALUE "$DATABASE/BDLSTDCIU". VHF0008
  3110 01 VARIABLES-TRAB-DIRECC.                                        FAC0003
  3111    03 TEL-W1                  PIC X(12).                         FAC0007
  3112    03 TEL-W2                  PIC X(12).                         FAC0007
  3113    03 TEL-WW2                 PIC X(12).                         FAC0007
  3114    03 CAR-W                   PIC 9(1).                          FAC0003
  3115    03 CAR-WW                  PIC 9(2).                          FAC0003
  3116    03 NUM-CAR-W               PIC 9(2).                          FAC0003
  3117 01 VARIABLES-NEW-DIRECC.                                         VHF0010
  3118    03 SW-HACER-CAMBIO         PIC 9.                             VHF0010
  3119    03 DIR-ACTUAL              PIC X(60).                         VHF0010
  3120    03 DIR-NUEVA               PIC X(60).                         VHF0010
  3121 01 REG-BDUHDIR-WS.                                               FAC0005
  3122    03  LLAVE-BDUHDIR-WS.                                         FAC0005
  3123        05  LLAVE-PRI-BDUHDIR-WS.                                 FAC0005
  3124            07  TIPO-ID-BDUHDIR-WS    PIC 9(01).                  FAC0005
  3125            07  NUM-ID-BDUHDIR-WS     PIC 9(13).                  FAC0007
  3126        05  LLAVE-ALT-BDUHDIR-WS.                                 FAC0005
  3127            07  COD-SUS-BDUHDIR-WS    PIC 9(06).                  FAC0005
  3128            07  COD-CTA-BDUHDIR-WS    PIC 9(02).                  FAC0005
  3129            07  NUM-CTA-BDUHDIR-WS    PIC X(18).                  FAC0005
  3130        05  LLAVE-CONSEC-BDUHDIR-WS.                              FAC0005
  3131            07  NUM-CONSEC-BDUHDIR-WS PIC 9(3).                   FAC0005
  3132     03  FECAPE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3133     03  FECCRE-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3134     03  FECACT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3135     03  CIURES-BDUHDIR-WS            PIC X(20).                  FAC0007
  3136     03  DPTRES-BDUHDIR-WS            PIC X(20).                  FAC0007
  3137     03  DIRRES-BDUHDIR-WS            PIC X(60).                  FAC0007
  3138     03  TELRES-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  3139*    03  FECRES-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3140     03  FECDRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3141     03  CIULAB-BDUHDIR-WS            PIC X(20).                  FAC0007
  3142     03  DPTLAB-BDUHDIR-WS            PIC X(20).                  FAC0007
  3143     03  DIRLAB-BDUHDIR-WS            PIC X(60).                  FAC0007
  3144     03  TELLAB-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  3145*    03  FECLAB-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3146     03  FECDLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3147     03  CIUCOR-BDUHDIR-WS            PIC X(20).                  FAC0007
  3148     03  DPTCOR-BDUHDIR-WS            PIC X(20).                  FAC0007
  3149     03  DIRCOR-BDUHDIR-WS            PIC X(60).                  FAC0007
  3150*    03  FECCOR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3151     03  FECDCOR-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  55
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/DIRE
  3152     03  E-MAIL-BDUHDIR-WS            PIC X(40).                  FAC0007
  3153     03  TELCEL-BDUHDIR-WS            PIC 9(12) COMP-3.           FAC0007
  3154*    03  FECOTR-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3155     03  FECCEL-BDUHDIR-WS            PIC 9(06) COMP-3.           VHF0010
  3156     03  FECSIS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3157     03  FECSUS-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3158     03  FECULT-BDUHDIR-WS            PIC 9(06) COMP-3.           FAC0007
  3159     03  CERRES-BDUHDIR-WS            PIC 9(01).                  FAC0008
  3160     03  ADIRES-BDUHDIR-WS            PIC 9(02).                  FAC0008
  3161     03  CERLAB-BDUHDIR-WS            PIC 9(01).                  FAC0008
  3162     03  ADILAB-BDUHDIR-WS            PIC 9(02).                  FAC0008
  3163     03  CERCOR-BDUHDIR-WS            PIC 9(01).                  FAC0008
  3164     03  ADICOR-BDUHDIR-WS            PIC 9(02).                  FAC0008
  3165     03  INDCSV-BDUHDIR-WS            PIC 9(01).                  CAV0009
  3166     03  FECTRES-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3167     03  FECTLAB-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3168     03  FECMAIL-BDUHDIR-WS           PIC 9(06) COMP-3.           VHF0010
  3169*    03  FILLER-BDUHDIR-WS            PIC X(40).                  VHF0010
  3170     03  FILLER-BDUHDIR-WS            PIC X(28).                  VHF0010
  3171
  3172
  3173********************************************************************
  3174* VARIABLES PARA EL MANEJO DIMANICO DE MATCH Y AMNISTIA PARA CADA
  3175* PROGRAMA. POR DEFAULT SIEMPRE LO EJECUTA.
  3176 01  HACERMATCH-LEEMSTRS        PIC 9(01)  VALUE 1.
  3177 01  AMNISTIA21-LEEMSTRS        PIC 9(01)  VALUE 1.
  3178********************************************************************
  3179 01  SW-LECTURA-MAESTROS        PIC 9(01)  VALUE ZEROS.
  3180 01  TIP-IDE-ANT-LEEMSTRS       PIC 9(01)  VALUE ZEROS.
  3181 01  NUM-IDE-ANT-LEEMSTRS       PIC 9(11)  VALUE ZEROS.
  3182 01  REG-ICMCRE-LEEMSTRS        PIC X(220) VALUE SPACES.
  3183 01  REG-ICMCHK-LEEMSTRS        PIC X(94)  VALUE SPACES.
  3184 01  REG-ICBSUS-LEEMSTRS        PIC X(200) VALUE SPACES.
  3185 01  REG-ICBDIR-LEEMSTRS        PIC X(483) VALUE SPACES.
  3186 01  TIPO-ID-LEEMSTRS           PIC 9(01)  VALUE ZEROS.
  3187 01  NRO-ID-LEEMSTRS            PIC 9(11)  VALUE ZEROS.
  3188 01  SW-FCHGRACIA-LEEMSTRS      PIC 9(01)  VALUE ZEROS.
  3189 01  SW-NOV-48-LEEMSTRS         PIC 9(01)  VALUE 1.               GJC0002
  3190 01  SW-ELIMINA-BBVA-LEEMSTRS   PIC 9(01)  VALUE 0. *> 0-NO 1-SI  GJC0003
  3191$SET CONSTANT HACERMATCH"SI"                                      GDT0001
  3192$SET CONSTANT AMNISTIA21"SI"                                      GDT0001
  3193 PROCEDURE DIVISION.
  3194*---------------------------------------------------- *
  3195 0010-PROGRAMA-PRINCIPAL.
  3196     DISPLAY "       "
  3197     DISPLAY " ** Datacredito*   MAYOR INFORMACION STANDARD  **"
  3198     DISPLAY "       "
  3199     DISPLAY "PROGRAMA:icestd81.int           VERSION:NOV/2006 "
  3200     DISPLAY "       "
  3201     DISPLAY "       "
  3202     ACCEPT   W-PARAMETROS   FROM COMMAND-LINE
  3203     UNSTRING W-PARAMETROS  DELIMITED BY SPACES INTO
  3204              ARCH-ENTRADA
  3205              ARCH-INCONC
  3206     END-UNSTRING
  3207     OPEN INPUT INCONSIS
  3208     IF W-STATUS-INC = 35
  3209        DISPLAY "!! Archivo inconsistencias no existe.!!"
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  56
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  3210        STOP RUN
  3211     END-IF
  3212     OPEN INPUT ENTRADA
  3213     IF W-STATUS-ENT = 35
  3214        DISPLAY "!! Archivo no existe..Proceso termina.!!"
  3215        STOP RUN
  3216     ELSE
  3217        STRING  ARCH-ENTRADA DELIMITED BY "."
  3218                ".DATINF"    DELIMITED BY SIZE
  3219                INTO         ARCH-SALIDA
  3220        END-STRING
  3221        STRING  ARCH-ENTRADA DELIMITED BY "."
  3222                ".ESTADI"    DELIMITED BY SIZE
  3223                INTO         ARCH-ESTADIS
  3224        END-STRING
  3225        CLOSE   ENTRADA
  3226
  3227        PERFORM 0015-CARGUE-TABLA-BDACUE
  3228
  3229        PERFORM 0020-APERTURA-ARCHIVOS
  3230
  3231        PERFORM 0030-EVALUA-CTAS
  3232
  3233        PERFORM 0450-READ-INCONSISTENCIAS
  3234
  3235        PERFORM 9800-GRABAR-ESTADISTICA
  3236
  3237        PERFORM 9900-RESUMEN-PROCESO
  3238        STOP RUN
  3239     END-IF.
  3240
  3241*-----------------------------*
* 3242 COPY UTLBIT.PROC.
  3243* UTLBIT.PROC.v.0001
  3244* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
  3245* BITS EN STRINGS COMO FLAGS SI/NO UTILES PARA AHORRO DE ESPACIO
  3246* AL LLAMAR CUALQUIER RUTINA SE MANEJA UN CODIGO DE ERROR QUE DEBE
  3247* SER CHEQUEADO PARA ASEGURAR QUE TODO ESTA OK
  3248*
  3249 0001-VALOR-FLAG-UTLBIT.
  3250******************************************************************
  3251*0001-VALOR-FLAG-UTLBIT.
  3252* ESTA RUTINA BUSCA EN EL STRING DADOS EL VALOR DEL FLAG BUSCADO
  3253* RETORNANDO 1 O 0 DE ACUERDO AL VALOR DEL BIT CORRESPONDIENTE
  3254*      ALINEACION :
  3255*         0        1        2
  3256*      12345678 90123456 78901234 ..........NUMERACION DE FLAGS
  3257*      11011010 11011101 00010010 ..........FLAGS O BITS
  3258*      CARACTE1 CARACTE2 CARACTE3 ..........STRING
  3259*      PARAMETROS DE ENTRADA:
  3260*         STRING MAX 100 A FLAGEAR     INPUT-STR-UTLBIT
  3261*         LONGITUD  DEL STRING        INPUT-LEN-UTLBIT
  3262*         FLAG BUSCADO                INPUT-FLA-UTLBIT
  3263*      DATOS DE SALIDA:
  3264*         VALOR DEL FLAG              OUTPUT-VAL-UTLBIT
  3265*         ERROR EN DATOS(0,1)         OUTPUT-ERR-UTLBIT
  3266*      OBSERVACION: ESTA RUTINA NO DEBE SER USADO EN ARCHIVOS
  3267*                   LINE SEQUENTIAL
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  57
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/UTLB
  3268******************************************************************
  3269     MOVE 0 TO OUTPUT-ERR-UTLBIT
  3270     COMPUTE POSCAR-UTLBIT = ((INPUT-FLA-UTLBIT - 1 )  / 8) + 1
  3271     COMPUTE POSFLA-UTLBIT = INPUT-FLA-UTLBIT -
  3272                             (POSCAR-UTLBIT - 1 ) * 8
  3273     IF POSCAR-UTLBIT > INPUT-LEN-UTLBIT OR
  3274        INPUT-LEN-UTLBIT > 100
  3275        MOVE 1 TO OUTPUT-ERR-UTLBIT
  3276     ELSE
  3277        MOVE INPUT-STR-UTLBIT(POSCAR-UTLBIT:1) TO CAR-UTLBIT
  3278        MOVE FUNCTION ORD(CAR-UTLBIT) TO ASCII-UTLBIT
  3279        SUBTRACT 1 FROM ASCII-UTLBIT
  3280        MOVE ASCII-UTLBIT TO ASCXX-UTLBIT
  3281        MOVE 0 TO OUTPUT-VAL-UTLBIT
  3282        MOVE 1 TO I-UTLBIT
  3283        MOVE 128 TO VALOR-UTLBIT
  3284        PERFORM UNTIL I-UTLBIT > 8 OR OUTPUT-VAL-UTLBIT = 1
  3285          IF ASCXX-UTLBIT >= VALOR-UTLBIT
  3286             COMPUTE ASCXX-UTLBIT = ASCXX-UTLBIT - VALOR-UTLBIT
  3287             IF I-UTLBIT = POSFLA-UTLBIT
  3288                MOVE 1 TO OUTPUT-VAL-UTLBIT
  3289             END-IF
  3290          END-IF
  3291          COMPUTE VALOR-UTLBIT = VALOR-UTLBIT / 2
  3292          ADD 1 TO I-UTLBIT
  3293        END-PERFORM.
  3294 0002-UPDATE-FLAG-UTLBIT.
  3295******************************************************************
  3296*0002-UPDATE-FLAG-UTLBIT.
  3297******************************************************************
  3298* ESTA RUTINA ACTUALIZA EN EL STRING DADO EL VALOR DEL FLAG DADO
  3299* RETORNANDO EL STRING ACTUALIZADO
  3300*      ALINEACION :
  3301*         0        1        2
  3302*      12345678 90123456 78901234 ..........NUMERACION DE FLAGS
  3303*      11011010 11011101 00010010 ..........FLAGS O BITS
  3304*      CARACTE1 CARACTE2 CARACTE3 ..........STRING
  3305*      PARAMETROS DE ENTRADA:
  3306*         STRING MAX 100 A FLAGEAR    INPUT-STR-UTLBIT
  3307*         LONGITUD  DEL STRING        INPUT-LEN-UTLBIT
  3308*         FLAG BUSCADO                INPUT-FLA-UTLBIT
  3309*         NUEVO VALOR DEL FLAG        INPUT-VAL-UTLBIT
  3310*      DATOS DE SALIDA:
  3311*         STRING CON EL BIT ACTUALIZ. INPUT-STR-UTLBIT
  3312*         ERROR EN DATOS(0,1,2)       OUTPUT-ERR-UTLBIT
  3313*      OBSERVACION: ESTA RUTINA NO DEBE SER USADO EN ARCHIVOS
  3314*                   LINE SEQUENTIAL
  3315******************************************************************
  3316       MOVE 0 TO OUTPUT-ERR-UTLBIT.
  3317       IF INPUT-VAL-UTLBIT = 1 OR 0
  3318          PERFORM 0001-VALOR-FLAG-UTLBIT
  3319       ELSE
  3320          MOVE 1 TO OUTPUT-ERR-UTLBIT
  3321       END-IF.
  3322       IF OUTPUT-ERR-UTLBIT = 0
  3323          IF INPUT-VAL-UTLBIT NOT = OUTPUT-VAL-UTLBIT
  3324             IF INPUT-VAL-UTLBIT = 1
  3325                COMPUTE ASCII-UTLBIT = ASCII-UTLBIT +
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  58
* OS.WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/UTLB
  3326                        2 ** (8 - POSFLA-UTLBIT) + 1
  3327             ELSE
  3328                COMPUTE ASCII-UTLBIT = ASCII-UTLBIT -
  3329                        2 ** (8 - POSFLA-UTLBIT) + 1
  3330
  3331             END-IF
  3332             IF ASCII-UTLBIT > 0 AND < 257
  3333                MOVE V-UTLBIT(ASCII-UTLBIT) TO
  3334                     INPUT-STR-UTLBIT(POSCAR-UTLBIT:1)
  3335             ELSE
  3336                DISPLAY "ERROR INTERNO RUTINA DE BITS"
  3337                MOVE 2 TO OUTPUT-ERR-UTLBIT
  3338             END-IF
  3339          END-IF
  3340       END-IF.
* 3341 COPY VALVLR.PROC.
  3342* VALVLR-PROC.0004
  3343*****************************************************************
  3344* ESTE COPY CONTIENE LAS RUTINAS PARA DETERMINAR SI LOS VALORES *
  3345* SE DEBEN O NO PRESENTAR COMO REPORTADOS                       *
  3346*****************************************************************
  3347* FAC0002     * MAPBIT - SE ADICIONA MANEJO DE MAPA DE BITS     *
  3348* FLOR ANGELA *                                                 *
  3349* CUADROS     *                                                 *
  3350* VHF0002     * VLNORE - SE VERIFICA QUE EXISTAN LOS CUATRO     *
  3351* VICTOR HUGO *          VALORES DESPLEGABLES EN EL REPORTE DE  *
  3352* FORERO      *          LO CONTRARIO SE TRATA LA CUENTA COMO   *
  3353* MAY.28/2002 *          SIN VALORES REPORTADOS. SI LOS VALORES *
  3354*             *          SON ANTES DEL MAPA DE BITS Y NO        *
  3355*             *          CORRESPONDEN A LAS FECHAS VALIDAS, SE  *
  3356*             *          VERIFICA EL VALOR INICIAL SI ES > 0 SE *
  3357*             *          DESPLIEGA DE LO CONTRARIO NINGUNO      *
  3358*****************************************************************
  3359* RMB0003     * COLP02 - SE MANEJAN LAS 16 OCURRENCIAS DEL      *
  3360* R. MARTINEZ.*          MAPA DE BITS                           *
  3361* JUN.15/06   *                                                 *
  3362*****************************************************************
  3363* ABB0004     * CPYVLR - SE LEE MAPA DE BITS PARA CUENTAS NO    *
  3364* ALBEIRO B.  *          ACTIVAS                                *
  3365* SEP.21/11   *                                                 *
  3366* VHF0004     * NOVEXT - SE DUPLICA LA RUTINA PARA USO DE       *
  3367* VICTOR HUGO *          NOVEDAT EXTENDIDO                      *
  3368* FORERO      *                                                 *
  3369* ENE.27/2012 *                                                 *
  3370*****************************************************************
  3371
  3372 32000-PROCESAR-VALORES.
  3373*****************************************************************
  3374*32000-PROCESAR-VALORES.                                        *
  3375*    ESTA RUTINA SE ENCARGA DE DETERMINAR SI SE DEBEN MOSTRAR   *
  3376*    VALORES Y SI ESTOS ESTAN ACTUALIZADOS O NO                 *
  3377*****************************************************************
  3378     INITIALIZE VECTOR-VALORES-VALVLR IND-VALORES-VALVLR.         FAC0002
  3379     IF (NOV-REPORT-ABD07 = 01 OR 45 OR 47 OR
  3380        (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 42 )) AND
  3381        IND-AMPLIACION-ABD02 = 5 AND
  3382        FECHA-ACTUALIZ-VALOR-ABD07 > 0
  3383        MOVE 1 TO IND-VALORES-VALVLR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  59
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3384        MOVE FEC-NOVEDAD-ABD07 TO FEC-4-MA-VALVLR
  3385        IF ANO-4-MA-VALVLR > 60
  3386           MOVE 19 TO SIG-6-AM-VALVLR
  3387        ELSE
  3388           MOVE 20 TO SIG-6-AM-VALVLR
  3389        END-IF
  3390        MOVE ANO-4-MA-VALVLR TO ANO-6-AM-VALVLR
  3391        MOVE MES-4-MA-VALVLR TO MES-6-AM-VALVLR
  3392        MOVE FEC-6-AM-VALVLR TO FEC-NOVEDAD-AUX-VALVLR
  3393        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO FEC-6-MA-VALVLR
  3394        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR
  3395        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR
  3396        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR
  3397        MOVE FEC-6-AM-VALVLR  TO FECHA-ACT-VALOR-AUX-VALVLR
  3398        MOVE F-ULT-ACT-ABD02 TO FEC-4-MA-VALVLR
  3399        IF ANO-4-MA-VALVLR > 60
  3400           MOVE 19       TO SIG-6-AM-VALVLR
  3401        ELSE
  3402           MOVE 20       TO SIG-6-AM-VALVLR
  3403        END-IF
  3404        MOVE ANO-4-MA-VALVLR    TO ANO-6-AM-VALVLR
  3405        MOVE MES-4-MA-VALVLR    TO MES-6-AM-VALVLR
  3406        MOVE FEC-6-AM-VALVLR  TO F-ULT-ACT-AUX-VALVLR
  3407        MOVE FECHA-SITUACION-ABD07 TO FEC-6-MA-VALVLR
  3408        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR
  3409        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR
  3410        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR
  3411        MOVE FEC-6-AM-VALVLR  TO FECHA-SITUACION-AUX-VALVLR
  3412        IF IND-MAPA-BITS-VLR-ABD07 <> 9                           FAC0002
  3413           IF NOV-REPORT-ABD07 = 01 OR
  3414              (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 17)
  3415              IF (FEC-NOVEDAD-AUX-VALVLR <  200108 AND
  3416                  FEC-NOVEDAD-AUX-VALVLR <=
  3417                  FECHA-ACT-VALOR-AUX-VALVLR) OR
  3418                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND
  3419                  FEC-NOVEDAD-AUX-VALVLR >=
  3420                  FECHA-ACT-VALOR-AUX-VALVLR)
  3421                  MOVE VECTOR-ACTIVADO-VALVLR TO
  3422                       VECTOR-VALORES-VALVLR
  3423              ELSE
  3424                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0002
  3425                    VALOR-INICIAL-ABD07 > 0                       VHF0002
  3426                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0002
  3427                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0002
  3428                 ELSE                                             VHF0002
  3429                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0002
  3430                 END-IF                                           VHF0002
  3431              END-IF
  3432           END-IF
  3433           IF (NOV-REPORT-ABD07 > 16 AND NOV-REPORT-ABD07 < 42)
  3434              IF (FEC-NOVEDAD-AUX-VALVLR < 200108 AND
  3435                  FEC-NOVEDAD-AUX-VALVLR =
  3436                  FECHA-ACT-VALOR-AUX-VALVLR) OR
  3437                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND
  3438                  FEC-NOVEDAD-AUX-VALVLR >=
  3439                  FECHA-ACT-VALOR-AUX-VALVLR)
  3440                  MOVE VECTOR-ACTIVADO-VALVLR TO
  3441                       VECTOR-VALORES-VALVLR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  60
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3442              ELSE
  3443                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0002
  3444                    VALOR-INICIAL-ABD07 > 0                       VHF0002
  3445                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0002
  3446                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0002
  3447                 ELSE                                             VHF0002
  3448                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0002
  3449                 END-IF                                           VHF0002
  3450              END-IF
  3451           END-IF
  3452           IF NOV-REPORT-ABD07 = 45 OR 47
  3453              IF FEC-NOVEDAD-AUX-VALVLR <=
  3454                 FECHA-ACT-VALOR-AUX-VALVLR OR
  3455                 F-ULT-ACT-AUX-VALVLR =
  3456                 FECHA-SITUACION-AUX-VALVLR
  3457                 MOVE VECTOR-ACTIVADO-VALVLR TO
  3458                      VECTOR-VALORES-VALVLR
  3459              ELSE
  3460                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0002
  3461                    VALOR-INICIAL-ABD07 > 0                       VHF0002
  3462                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0002
  3463                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0002
  3464                 ELSE                                             VHF0002
  3465                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0002
  3466                 END-IF                                           VHF0002
  3467              END-IF
  3468           END-IF
  3469        ELSE
  3470           PERFORM 33000-LEER-BITMAP-VALORES
  3471        END-IF
  3472     END-IF
  3473     IF IND-VALORES-VALVLR = 1                                    VHF0002
  3474***     SE VERIFICA QUE POR LO MENOS UNO DE LOS CUATRO VALORES QUE
  3475***     SE DESPLIEGAN EN EL REPORTE HAYA SIDO REPORTADO DE LO
  3476***     CONTRARIO NO SE MUESTRAN VALORES PARA LA CUENTA
  3477        IF VEC-VALOR-VALVLR (01) = 0 AND                          VHF0002
  3478           VEC-VALOR-VALVLR (02) = 0 AND                          VHF0002
  3479           VEC-VALOR-VALVLR (03) = 0 AND                          VHF0002
  3480           VEC-VALOR-VALVLR (05) = 0                              VHF0002
  3481           MOVE 0 TO IND-VALORES-VALVLR                           VHF0002
  3482        END-IF                                                    VHF0002
  3483     END-IF.                                                      VHF0002
  3484
  3485 32500-PROCESAR-VALORES-EXT.                                      VHF0004
  3486***************************************************************** VHF0004
  3487*32500-PROCESAR-VALORES-EXT.                                    * VHF0004
  3488*    ESTA RUTINA SE ENCARGA DE DETERMINAR SI SE DEBEN MOSTRAR   * VHF0004
  3489*    VALORES Y SI ESTOS ESTAN ACTUALIZADOS O NO PARA NOVEDAT    * VHF0004
  3490*    EXTENDIDO                                                  * VHF0004
  3491***************************************************************** VHF0004
  3492     INITIALIZE VECTOR-VALORES-VALVLR IND-VALORES-VALVLR.         VHF0004
  3493     IF (NOV-REPORT-ABD07 = 01 OR 45 OR 47 OR                     VHF0004
  3494        (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 42 )) AND   VHF0004
  3495        IND-AMPLIACION-ABD02 = 5 AND                              VHF0004
  3496        FECHA-ACTUALIZ-VALOR-ABD07 > 0                            VHF0004
  3497        MOVE 1 TO IND-VALORES-VALVLR                              VHF0004
  3498        MOVE FEC-NOVEDAD-ABD07 TO FEC-4-MA-VALVLR                 VHF0004
  3499        IF ANO-4-MA-VALVLR > 60                                   VHF0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  61
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3500           MOVE 19 TO SIG-6-AM-VALVLR                             VHF0004
  3501        ELSE                                                      VHF0004
  3502           MOVE 20 TO SIG-6-AM-VALVLR                             VHF0004
  3503        END-IF                                                    VHF0004
  3504        MOVE ANO-4-MA-VALVLR TO ANO-6-AM-VALVLR                   VHF0004
  3505        MOVE MES-4-MA-VALVLR TO MES-6-AM-VALVLR                   VHF0004
  3506        MOVE FEC-6-AM-VALVLR TO FEC-NOVEDAD-AUX-VALVLR            VHF0004
  3507        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO FEC-6-MA-VALVLR        VHF0004
  3508        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR                  VHF0004
  3509        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR                 VHF0004
  3510        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR                  VHF0004
  3511        MOVE FEC-6-AM-VALVLR  TO FECHA-ACT-VALOR-AUX-VALVLR       VHF0004
  3512        MOVE F-ULT-ACT-ABD02 TO FEC-4-MA-VALVLR                   VHF0004
  3513        IF ANO-4-MA-VALVLR > 60                                   VHF0004
  3514           MOVE 19       TO SIG-6-AM-VALVLR                       VHF0004
  3515        ELSE                                                      VHF0004
  3516           MOVE 20       TO SIG-6-AM-VALVLR                       VHF0004
  3517        END-IF                                                    VHF0004
  3518        MOVE ANO-4-MA-VALVLR    TO ANO-6-AM-VALVLR                VHF0004
  3519        MOVE MES-4-MA-VALVLR    TO MES-6-AM-VALVLR                VHF0004
  3520        MOVE FEC-6-AM-VALVLR  TO F-ULT-ACT-AUX-VALVLR             VHF0004
  3521        MOVE FECHA-SITUACION-ABD07 TO FEC-6-MA-VALVLR             VHF0004
  3522        MOVE SIG-6-MA-VALVLR  TO SIG-6-AM-VALVLR                  VHF0004
  3523        MOVE ANO2-6-MA-VALVLR  TO ANO-6-AM-VALVLR                 VHF0004
  3524        MOVE MES-6-MA-VALVLR  TO MES-6-AM-VALVLR                  VHF0004
  3525        MOVE FEC-6-AM-VALVLR  TO FECHA-SITUACION-AUX-VALVLR       VHF0004
  3526        IF IND-MAPA-BITS-VLR-ABD07 <> 9                           VHF0004
  3527           IF NOV-REPORT-ABD07 = 01 OR                            VHF0004
  3528              (NOV-REPORT-ABD07 > 12 AND NOV-REPORT-ABD07 < 17)   VHF0004
  3529              IF (FEC-NOVEDAD-AUX-VALVLR <  200108 AND            VHF0004
  3530                  FEC-NOVEDAD-AUX-VALVLR <=                       VHF0004
  3531                  FECHA-ACT-VALOR-AUX-VALVLR) OR                  VHF0004
  3532                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND            VHF0004
  3533                  FEC-NOVEDAD-AUX-VALVLR >=                       VHF0004
  3534                  FECHA-ACT-VALOR-AUX-VALVLR)                     VHF0004
  3535                  MOVE VECTOR-ACTIVADO-VALVLR TO                  VHF0004
  3536                       VECTOR-VALORES-VALVLR                      VHF0004
  3537              ELSE                                                VHF0004
  3538                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0004
  3539                    VALOR-INICIAL-ABD07 > 0                       VHF0004
  3540                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0004
  3541                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0004
  3542                 ELSE                                             VHF0004
  3543                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0004
  3544                 END-IF                                           VHF0004
  3545              END-IF                                              VHF0004
  3546           END-IF                                                 VHF0004
  3547           IF (NOV-REPORT-ABD07 > 16 AND NOV-REPORT-ABD07 < 42)   VHF0004
  3548              IF (FEC-NOVEDAD-AUX-VALVLR < 200108 AND             VHF0004
  3549                  FEC-NOVEDAD-AUX-VALVLR =                        VHF0004
  3550                  FECHA-ACT-VALOR-AUX-VALVLR) OR                  VHF0004
  3551                 (FEC-NOVEDAD-AUX-VALVLR >= 200108 AND            VHF0004
  3552                  FEC-NOVEDAD-AUX-VALVLR >=                       VHF0004
  3553                  FECHA-ACT-VALOR-AUX-VALVLR)                     VHF0004
  3554                  MOVE VECTOR-ACTIVADO-VALVLR TO                  VHF0004
  3555                       VECTOR-VALORES-VALVLR                      VHF0004
  3556              ELSE                                                VHF0004
  3557                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  62
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALV
  3558                    VALOR-INICIAL-ABD07 > 0                       VHF0004
  3559                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0004
  3560                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0004
  3561                 ELSE                                             VHF0004
  3562                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0004
  3563                 END-IF                                           VHF0004
  3564              END-IF                                              VHF0004
  3565           END-IF                                                 VHF0004
  3566           IF NOV-REPORT-ABD07 = 45 OR 47                         VHF0004
  3567              IF FEC-NOVEDAD-AUX-VALVLR <=                        VHF0004
  3568                 FECHA-ACT-VALOR-AUX-VALVLR OR                    VHF0004
  3569                 F-ULT-ACT-AUX-VALVLR =                           VHF0004
  3570                 FECHA-SITUACION-AUX-VALVLR                       VHF0004
  3571                 MOVE VECTOR-ACTIVADO-VALVLR TO                   VHF0004
  3572                      VECTOR-VALORES-VALVLR                       VHF0004
  3573              ELSE                                                VHF0004
  3574                 IF VALOR-INICIAL-ABD07 NUMERIC AND               VHF0004
  3575                    VALOR-INICIAL-ABD07 > 0                       VHF0004
  3576                    INITIALIZE VECTOR-VALORES-VALVLR              VHF0004
  3577                    MOVE 1 TO VEC-VALOR-VALVLR (02)               VHF0004
  3578                 ELSE                                             VHF0004
  3579                    MOVE 0 TO IND-VALORES-VALVLR                  VHF0004
  3580                 END-IF                                           VHF0004
  3581              END-IF                                              VHF0004
  3582           END-IF                                                 VHF0004
  3583        ELSE                                                      VHF0004
  3584           PERFORM 33000-LEER-BITMAP-VALORES                      VHF0004
  3585        END-IF                                                    VHF0004
  3586     ELSE                                                         ABB0004
  3587        PERFORM 33000-LEER-BITMAP-VALORES                         ABB0004
  3588     END-IF                                                       VHF0004
  3589     IF IND-VALORES-VALVLR = 1                                    VHF0004
  3590***     SE VERIFICA QUE POR LO MENOS UNO DE LOS CUATRO VALORES QUEVHF0004
  3591***     SE DESPLIEGAN EN EL REPORTE HAYA SIDO REPORTADO DE LO     VHF0004
  3592***     CONTRARIO NO SE MUESTRAN VALORES PARA LA CUENTA           VHF0004
  3593        IF VEC-VALOR-VALVLR (01) = 0 AND                          VHF0004
  3594           VEC-VALOR-VALVLR (02) = 0 AND                          VHF0004
  3595           VEC-VALOR-VALVLR (03) = 0 AND                          VHF0004
  3596           VEC-VALOR-VALVLR (05) = 0                              VHF0004
  3597           MOVE 0 TO IND-VALORES-VALVLR                           VHF0004
  3598        END-IF                                                    VHF0004
  3599     END-IF.                                                      VHF0004
  3600
  3601 33000-LEER-BITMAP-VALORES.                                       FAC0002
  3602******************************************************************
  3603*33000-LEER-BITMAP-VALORES.                                      *
  3604*   RUTINA QUE TOMA LA VARIABLE MAPA-BITS-VLR-ABD07 Y LA PASA AL *
  3605*   VECTOR DE VALORES PARA PODER PROCESAR EL BIT DE CADA VALOR   *
  3606******************************************************************
  3607    INITIALIZE VARIABLES-UTLBIT VECTOR-VALORES-VALVLR             FAC0002
  3608    MOVE MAPA-BITS-VLR-ABD07 TO INPUT-STR-UTLBIT                  FAC0002
  3609    MOVE 2 TO INPUT-LEN-UTLBIT                                    FAC0002
  3610    PERFORM VARYING FLAG-VALVLR FROM 1 BY 1 UNTIL                 FAC0002
  3611            FLAG-VALVLR > 16                                      RMB0003
  3612       INITIALIZE OUTPUT-ERR-UTLBIT OUTPUT-VAL-UTLBIT             FAC0002
  3613                  INPUT-VAL-UTLBIT                                FAC0002
  3614       MOVE FLAG-VALVLR TO INPUT-FLA-UTLBIT                       FAC0002
  3615       PERFORM 0001-VALOR-FLAG-UTLBIT                             FAC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  63
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/VALV
  3616       MOVE OUTPUT-VAL-UTLBIT TO VEC-VALOR-VALVLR(FLAG-VALVLR)    FAC0002
  3617    END-PERFORM.                                                  FAC0002
  3618*-----------------------------*
  3619
  3620*-----------------------------------------------------------------*
  3621* Rutina para manejar VALORES                                     *
  3622*-----------------------------------------------------------------*
  3623 0015-CARGUE-TABLA-BDACUE.
* 3624      COPY PE-VALORES.PROC.
  3625*PE-VALORES.PROC.v.01.0001.
  3626*------------------------------------------------*
  3627*
  3628*   COPY  VERSION  SEPTIMBRE 2004
  3629*
  3630*------------------------------------------------*
  3631* COPY Verifica valores para mostrar en informe  *
  3632*------------------------------------------------*
  3633
  3634     INITIALIZE  VAL-VARIABLES
  3635     MOVE    1   TO   T
  3636     OPEN INPUT  BDACUE
  3637     PERFORM  UNTIL SW-LOAD-TBL = 9
  3638              READ BDACUE
  3639                   AT  END
  3640                       MOVE   9 TO SW-LOAD-TBL
  3641                   NOT AT END
  3642                       IF T > 100
  3643                          MOVE   9 TO SW-LOAD-TBL
  3644                       ELSE
  3645                          MOVE  TAB-IND-VAL-BDACUE  TO
  3646                                TABLA-VAL-TIP-CTA (T)
  3647                          ADD   1   TO   T
  3648                       END-IF
  3649              END-READ
  3650     END-PERFORM
  3651     CLOSE BDACUE
  3652     COMPUTE TOPE-T = T - 1.
  3653*    DISPLAY " Cuentas cargadas (BDACUE) : "   TOPE-T.
  3654
  3655*----------------------------------------------------------------*
  3656 33000-PROCESAR-BDACUE.
  3657*----------------------------------------------------------------*
  3658*  --->    VALOR INICIAL
  3659*----------------------------------------------------------------*
  3660     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,2) = 0
  3661        MOVE  ZEROS  TO  VEC-VALOR-VALVLR (2)
  3662     END-IF
  3663
  3664*----------------------------------------------------------------*
  3665*  --->    VALOR SALDO
  3666*----------------------------------------------------------------*
  3667     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,3) = 0
  3668        MOVE  ZEROS  TO  VEC-VALOR-VALVLR (3)
  3669     END-IF
  3670
  3671*----------------------------------------------------------------*
  3672*  --->    VALOR MORA
  3673*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  64
* OC)WS))l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/PE-V
  3674     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,5) = 0
  3675        MOVE  ZEROS TO   VEC-VALOR-VALVLR (5)
  3676     END-IF
  3677*----------------------------------------------------------------*
  3678*  --->    VALOR CUOTA
  3679*----------------------------------------------------------------*
  3680     IF VEC-VALOR-BDACUE (W-CTA-BDCUE,1) = 0
  3681        MOVE  ZEROS TO   VEC-VALOR-VALVLR (1)
  3682     END-IF.
  3683
  3684
  3685*-----------------------------------------------------------------*
  3686* Se abren los archivos de trabajo, se realiza la primera lectura *
  3687* del archivo de entrada para validar c¢digo y clave y se verIFica*
  3688* los suscriptores que esten bloqueados.                          *
  3689*-----------------------------------------------------------------*
  3690 0020-APERTURA-ARCHIVOS.
  3691     OPEN INPUT  ENTRADA
  3692     OPEN INPUT  MAESTRO-CHECK
  3693     OPEN  INPUT  MAESTRO-DIRECC                                  GDT0001
  3694     OPEN  INPUT  NOAMNISTIA21                                    GDT0001
  3695*                                                                 GDT0001
  3696     OPEN INPUT  MAESTRO-CREDIT
  3697     OPEN INPUT  SUSCRIPTOR
  3698     OPEN INPUT  BDIEMSUP
  3699     OPEN INPUT  BDIEENTI
  3700     OPEN INPUT  INDEXADO
  3701     OPEN OUTPUT SALIDA
  3702     OPEN OUTPUT ESTADIS
  3703     MOVE  FUNCTION CURRENT-DATE TO W-FECHA-HOY.
  3704
  3705*-----------------------------------------------------------------*
  3706* Se verifica si el cliente posee informaci¢n crediticia y de ser *
  3707* as¡ se llaman las rutinas para evaluar ctasctes y cartera       *
  3708*-----------------------------------------------------------------*
  3709 0030-EVALUA-CTAS.
  3710     PERFORM  UNTIL CONT-LECTURA = 999
  3711              READ ENTRADA   AT  END
  3712                       MOVE 999 TO CONT-LECTURA
  3713                   NOT AT END
  3714                       INITIALIZE W-VARIABLES
  3715                       MOVE W-VECTOR-L TO LL
  3716                       COMPUTE II = 49 - LL
  3717*
  3718                       INITIALIZE REG-SALIDA
  3719                       PERFORM 0031-FILLERS
  3720                       MOVE  999999 TO  W-FEC-MENOR-TDC
  3721                       ADD     1    TO  LEIDOS
  3722
  3723                       PERFORM 0100-EVALUA-CTASCTES
  3724
  3725                       PERFORM 0200-EVALUA-CARTERA
  3726
  3727                       PERFORM 0300-EVALUA-ENDEUDAMIENTO
  3728
  3729                       PERFORM 0400-EVALUA-CONSULTAS
  3730
  3731                       PERFORM 0500-GRABAR-SALIDA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  65
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3732
  3733              END-READ
  3734     END-PERFORM.
  3735
  3736 0031-FILLERS.
  3737     MOVE ";" TO FILLER01 FILLER02 FILLER03 FILLER04 FILLER05
  3738        FILLER06 FILLER07 FILLER08 FILLER09 FILLER10 FILLER11
  3739        FILLER12 FILLER13 FILLER14 FILLER15 FILLER16 FILLER17
  3740        FILLER18 FILLER19 FILLER20 FILLER21 FILLER22 FILLER23
  3741        FILLER24 FILLER25 FILLER26 FILLER27 FILLER28 FILLER29
  3742        FILLER30 FILLER31 FILLER32 FILLER33 FILLER34 FILLER35
  3743        FILLER36 FILLER37 FILLER38 FILLER39 FILLER40 FILLER41
  3744        FILLER42 FILLER43 FILLER44 FILLER45 FILLER46 FILLER47
  3745        FILLER48 FILLER49 FILLER50 FILLER51 FILLER52 FILLER53
  3746        FILLER54 FILLER55 FILLER56 FILLER57 FILLER58 FILLER59
  3747        FILLER60 FILLER61 FILLER62 FILLER63 FILLER64 FILLER65
  3748        FILLER66 FILLER67 FILLER68 FILLER69 FILLER70 FILLER71
  3749        FILLER72 FILLER73 FILLER74 FILLER75 FILLER76 FILLER77
  3750        FILLER78 FILLER79.
  3751
  3752*------------------------------------------------------------------*
  3753* Verifica las novedades de ctasctes y califica                    *
  3754*------------------------------------------------------------------*
  3755 0100-EVALUA-CTASCTES.
  3756     INITIALIZE     LLAVE-MAES-CHECK
  3757     MOVE  ENT-TIPO-ID  TO  TIPO-ID-ABD06
  3758     MOVE  ENT-NUME-ID  TO  NUM-ID-ABD06
  3759     PERFORM  0600-ASIGNA-ID-ICMCHK-START                         GDT0001
  3760     START MAESTRO-CHECK KEY NOT < LLAVE-MAES-CHECK
  3761           INVALID KEY
  3762                   MOVE 9 TO TIPO-ID-ABD06
  3763           NOT INVALID KEY
  3764*                   READ MAESTRO-CHECK NEXT                       GDT0001
  3765*                        AT END                                   GDT0001
  3766*                           MOVE 9 TO TIPO-ID-ABD06               GDT0001
  3767*                   END-READ                                      GDT0001
  3768     PERFORM  3000-LEE-ICMCHK-SECUENCIAL                          GDT0001
  3769     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3770                                                                  GDT0001
  3771                                                                  GDT0001
  3772                             MOVE 9 TO TIPO-ID-ABD06              GDT0001
  3773                                                                  GDT0001
  3774     END-IF                                                       GDT0001
  3775     END-START
  3776     PERFORM UNTIL  TIPO-ID-ABD06 NOT = ENT-TIPO-ID  OR
  3777                    NUM-ID-ABD06  NOT = ENT-NUME-ID
  3778           MOVE COD-SUS-ABD06  TO  COD-SUSCRIP-ABD02
  3779           MOVE COD-SUS-ABD06  TO  W-SUSCRIPTOR
  3780           READ SUSCRIPTOR  IGNORE LOCK
  3781                INVALID KEY
  3782                        MOVE 0 TO ESTADO-ABD02
  3783           END-READ
  3784           IF nov-report-abd06 > 0 AND nov-report-abd06  < 10
  3785              IF ESTADO-ABD02 = 1  AND IND-BLOQUEO-ABD06 =  0
  3786                 move tab-nov-ctac-cal (nov-report-abd06)
  3787                                    to  evalua-cta-cte
  3788
  3789                 PERFORM 0120-EVALUA-CUENTAS-BANCARIAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  66
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3790
  3791                 IF EVALUA-FINAL < evalua-cta-cte
  3792                    move evalua-cta-cte to EVALUA-FINAL
  3793                 END-IF
  3794              END-IF
  3795           END-IF
  3796*          READ MAESTRO-CHECK NEXT                                GDT0001
  3797*               AT END                                            GDT0001
  3798*                  MOVE 9 TO TIPO-ID-ABD06                        GDT0001
  3799*          END-READ                                               GDT0001
  3800     PERFORM  3000-LEE-ICMCHK-SECUENCIAL                          GDT0001
  3801     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3802                                                                  GDT0001
  3803                                                                  GDT0001
  3804                    MOVE 9 TO TIPO-ID-ABD06                       GDT0001
  3805                                                                  GDT0001
  3806     END-IF                                                       GDT0001
  3807     END-PERFORM.
  3808
  3809*-----------------------------------------------*
  3810 0120-EVALUA-CUENTAS-BANCARIAS.
  3811*-----------------------------------------------*
  3812     IF W-CODIGO-TIPOCTA = 01
  3813        EVALUATE TAB-NOV-CTAC-CODINT(NOV-REPORT-ABD06)
  3814              WHEN 30
  3815                   ADD  1  TO  W-CTES-CORRIENTES
  3816              WHEN 31
  3817                   ADD  1  TO  W-CTES-MAL-MANEJO
  3818              WHEN 32
  3819                   ADD  1  TO  W-CTES-SALDADAS
  3820              WHEN 33
  3821                   ADD  1  TO  W-CTES-EMBARGADAS
  3822              WHEN 35
  3823                   ADD  1  TO  W-CTES-CORRIENTES
  3824        END-EVALUATE
  3825     ELSE
  3826        IF TAB-NOV-CTAC-CODINT(NOV-REPORT-ABD06) = 30 OR 35
  3827           ADD   1   TO   W-CTAS-AHORROS
  3828        END-IF
  3829     END-IF.
  3830
  3831*-------------------------------------------------------*
  3832* Verifica las novedades de cartera y califica          *
  3833*-------------------------------------------------------*
  3834 0200-EVALUA-CARTERA.
  3835     INITIALIZE        LLAVE-MAES-CREDIT
  3836     MOVE   ZEROS      TO  W-SUSCRIPTOR
  3837     MOVE  ENT-TIPO-ID TO  TIPO-ID-ABD07
  3838     MOVE  ENT-NUME-ID TO  NUM-ID-ABD07
  3839     PERFORM  0500-ASIGNA-ID-ICMCRE-START                         GDT0001
  3840     START MAESTRO-CREDIT  KEY NOT < LLAVE-MAES-CREDIT
  3841           INVALID KEY
  3842                   MOVE 9 TO TIPO-ID-ABD07
  3843           NOT INVALID KEY
  3844*                  READ MAESTRO-CREDIT NEXT                       GDT0001
  3845*                           AT  END                               GDT0001
  3846*                               MOVE 9 TO TIPO-ID-ABD07           GDT0001
  3847*                        NOT AT END                               GDT0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  67
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3848*                            MOVE COD-CTA-ABD07 TO W-CTA-BDCUE    GDT0001
  3849*                            IF COD-CTA-ABD07 > 29                GDT0001
  3850*                               MOVE 11 TO COD-CTA-ABD07          GDT0001
  3851*                            END-IF                               GDT0001
  3852*                  END-READ                                       GDT0001
  3853     PERFORM  1000-LEE-ICMCRE-SECUENCIAL                          GDT0001
  3854     IF  SW-LECTURA-MAESTROS  =  0                                GDT0001
  3855                                                                  GDT0001
  3856                              MOVE COD-CTA-ABD07 TO W-CTA-BDCUE   GDT0001
  3857                              IF COD-CTA-ABD07 > 29               GDT0001
  3858                                 MOVE 11 TO COD-CTA-ABD07         GDT0001
  3859                              END-IF                              GDT0001
  3860                                                                  GDT0001
  3861     END-IF                                                       GDT0001
  3862     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3863                                                                  GDT0001
  3864                                                                  GDT0001
  3865                                 MOVE 9 TO TIPO-ID-ABD07          GDT0001
  3866     END-IF                                                       GDT0001
  3867     END-START
  3868     PERFORM UNTIL TIPO-ID-ABD07 NOT = ENT-TIPO-ID  OR
  3869                   NUM-ID-ABD07  NOT = ENT-NUME-ID
  3870           MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  3871           READ SUSCRIPTOR  IGNORE LOCK
  3872                INVALID KEY
  3873                        MOVE 0 TO ESTADO-ABD02
  3874           END-READ
  3875           IF NOV-REPORT-ABD07 > 0 AND NOV-REPORT-ABD07 < 51
  3876              IF ESTADO-ABD02  = 1 AND IND-BLOQUEO-ABD07 = 0
  3877                 move tab-nov-cart-cal (nov-report-abd07)
  3878                                   to   evalua-credito
  3879                 IF COD-CTA-ABD07 = 02 OR
  3880                    COD-SUS-ABD07 = 240033 OR 080001
  3881                    PERFORM 5000-EVALUAR-PRODUCTO
  3882                 END-IF
  3883                 IF COD-SUS-ABD07 = 020151 OR 020167 OR 020370
  3884                    MOVE   11  TO  COD-CTA-ABD07
  3885                 END-IF
  3886                 IF COD-SUS-ABD07 = 020055 OR 020007
  3887                    MOVE   03  TO  COD-CTA-ABD07
  3888                 END-IF
  3889
  3890                 INITIALIZE  W-REG-SALIDA
  3891                 PERFORM  5900-EVALUA-FECHAS
  3892                 PERFORM  1900-EVALUAR-CODEUDOR
  3893                 PERFORM  2000-EVALUAR-CLASE-CARTERA
  3894                 PERFORM  6000-CUENTA-MORAS-ACTUAL-ESTADO
  3895*                PERFORM  7500-ANALIZA-VECTOR-HISTORICO
  3896
  3897                 MOVE V-NOR(II:LL) TO  W-VECTOR-1
  3898                 MOVE W-VECTOR-1   TO  VECTOR-S
  3899                 MOVE VECTOR-S     TO  W-MORAS-HISTORICAS-V
  3900                 DISPLAY "VECTOR ; " ENT-TIPO-ID ";" ENT-NUME-ID
  3901                 ";" ENT-NOMBRE ";" NUM-CTA-ABD07 ";" W-VECTOR-1
  3902                 PERFORM  5900-CUENTA-MORAS-HISTORICAS
  3903*                 PERFORM  5800-CUENTA-MORAS-HISTORICAS
  3904                 PERFORM  6200-MORA-MAXIMA-CUENTAS
  3905                 IF EVALUA-CREDITO >  EVALUA-FINAL
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  68
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3906                    MOVE EVALUA-CREDITO TO EVALUA-FINAL
  3907                 END-IF
  3908              END-IF
  3909           END-IF
  3910*          READ MAESTRO-CREDIT NEXT                               GDT0001
  3911*               AT  END                                           GDT0001
  3912*                   MOVE 9 TO TIPO-ID-ABD07                       GDT0001
  3913*               NOT AT END                                        GDT0001
  3914*                   MOVE COD-CTA-ABD07 TO W-CTA-BDCUE             GDT0001
  3915*                   IF COD-CTA-ABD07 > 29                         GDT0001
  3916*                      MOVE 11         TO COD-CTA-ABD07           GDT0001
  3917*                   END-IF                                        GDT0001
  3918*          END-READ                                               GDT0001
  3919     PERFORM  1000-LEE-ICMCRE-SECUENCIAL                          GDT0001
  3920     IF  SW-LECTURA-MAESTROS  =  0                                GDT0001
  3921                                                                  GDT0001
  3922                     MOVE COD-CTA-ABD07 TO W-CTA-BDCUE            GDT0001
  3923                     IF COD-CTA-ABD07 > 29                        GDT0001
  3924                        MOVE 11         TO COD-CTA-ABD07          GDT0001
  3925                     END-IF                                       GDT0001
  3926                                                                  GDT0001
  3927     END-IF                                                       GDT0001
  3928     IF  SW-LECTURA-MAESTROS  =  1                                GDT0001
  3929                                                                  GDT0001
  3930                                                                  GDT0001
  3931                     MOVE 9 TO TIPO-ID-ABD07                      GDT0001
  3932     END-IF                                                       GDT0001
  3933     END-PERFORM.
  3934
  3935*------------------------------------------------------------------*
  3936* VerIFica el endeudamiento y calIFica                             *
  3937*------------------------------------------------------------------*
  3938 0300-EVALUA-ENDEUDAMIENTO.
  3939     move zeros       to  salir-end
  3940     MOVE    1        TO  E
  3941     move ent-tipo-id to BDIEMSUP-tip-id
  3942     move ent-nume-id to BDIEMSUP-num-id
  3943     start BDIEMSUP key >= BDIEMSUP-llave
  3944            invalid key
  3945                    move 1 to salir-end
  3946     end-start
  3947     IF salir-end  =  0
  3948        PERFORM  0330-READ-NEXT-ENDEUDA
  3949     END-IF.
  3950
  3951*----------------------------------------------------------------*
  3952* READ INDEXD ENDEUDAMIENTO                                      *
  3953*----------------------------------------------------------------*
  3954 0330-READ-NEXT-ENDEUDA.
  3955     READ BDIEMSUP next record
  3956          at end
  3957          move 9 to BDIEMSUP-tip-id
  3958     END-READ
  3959     PERFORM UNTIL BDIEMSUP-tip-id not = ent-tipo-id or
  3960                   BDIEMSUP-num-id not = ent-nume-id
  3961          IF BDIEMSUP-ind-bloq is not numeric
  3962             move 0 to BDIEMSUP-ind-bloq
  3963          END-IF
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  69
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  3964          IF BDIEMSUP-ind-bloq not = 1
  3965             IF BDIEMSUP-fecha > zeros
  3966                PERFORM varying IND-E from 1 by 1
  3967                                      until IND-E > 8
  3968                     IF BDIEMSUP-CALIFICA = tab-end-cod(IND-E)
  3969                        MOVE TAB-END-CAL(IND-E)
  3970                                      TO evalua-endeuda
  3971                        MOVE TAB-END-COD(IND-E)  TO W-ENDEUDA
  3972
  3973                        PERFORM 0360-TRIMESTRE-ENDEUDA
  3974
  3975                        IF EVALUA-FINAL < evalua-endeuda
  3976                           MOVE evalua-endeuda to EVALUA-FINAL
  3977                           MOVE TAB-END-COD(IND-E) TO W-ENDEUDA
  3978                        END-IF
  3979                        ADD 7 TO IND-E
  3980                     END-IF
  3981                END-PERFORM
  3982             END-IF
  3983          END-IF
  3984          read BDIEMSUP next record
  3985               at end
  3986                  move 9 to BDIEMSUP-tip-id
  3987          end-read
  3988     END-PERFORM.
  3989
  3990*----------------------------------------------------------------*
  3991* VALORES ENDEUDAMIENTO                                          *
  3992*----------------------------------------------------------------*
  3993 0360-TRIMESTRE-ENDEUDA.
  3994      IF BDIEMSUP-CALIFICA NOT = "T"
  3995         IF SW-END = ZEROS
  3996            MOVE     1               TO  SW-END
  3997            MOVE  BDIEMSUP-CALIFICA  TO  W-MAYOR-END (E)
  3998            MOVE  BDIEMSUP-FECHA     TO  W-FECHA-END (E)
  3999         END-IF
  4000         IF BDIEMSUP-FECHA = W-FECHA-END (E)
  4001            IF BDIEMSUP-CALIFICA > W-MAYOR-END (E)
  4002               MOVE  BDIEMSUP-CALIFICA  TO  W-MAYOR-END (E)
  4003            END-IF
  4004         ELSE
  4005            ADD   1   TO   E
  4006            IF E > 3
  4007               MOVE  3  TO   E
  4008               MOVE W-MAYOR-END (E)  TO  W-MAYOR-END (2)
  4009               MOVE W-FECHA-END (E)  TO  W-FECHA-END (2)
  4010            END-IF
  4011            MOVE BDIEMSUP-FECHA      TO  W-FECHA-END (E)
  4012            MOVE BDIEMSUP-CALIFICA   TO  W-MAYOR-END (E)
  4013         END-IF
  4014      END-IF.
  4015*----------------------------------------------------------------*
  4016* Rutina que establece el numero de consultas que se hicieron por*
  4017* parte de entidades financieras solamente                       *
  4018*----------------------------------------------------------------*
  4019 0400-EVALUA-CONSULTAS.
  4020*----------------------*
  4021      INITIALIZE           LLAVE-INDEX
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  70
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4022      MOVE ENT-TIPO-ID TO  TIP-ID-IND
  4023      MOVE ENT-NUME-ID TO  NUM-ID-IND
  4024      START INDEXADO KEY NOT < LLAVE-INDEX
  4025            INVALID KEY
  4026              MOVE 9 TO TIP-ID-IND
  4027            NOT INVALID KEY
  4028                READ INDEXADO NEXT
  4029                AT END
  4030                   MOVE 9 TO TIP-ID-IND
  4031                END-READ
  4032      END-START
  4033      PERFORM UNTIL  TIP-ID-IND NOT = ENT-TIPO-ID  OR
  4034                     NUM-ID-IND NOT = ENT-NUME-ID
  4035            IF COD-SUSCRIP-IND < 800000
  4036               ADD  1  TO  W-TOTAL-CONSULTAS
  4037            END-IF
  4038            READ INDEXADO NEXT
  4039                 AT END
  4040                 MOVE 9 TO TIP-ID-IND
  4041            END-READ
  4042      END-PERFORM.
  4043
  4044*----------------------------------------------------------------*
  4045* Lee el total de inconsistencias para estadisticas              *
  4046*----------------------------------------------------------------*
  4047 0450-READ-INCONSISTENCIAS.
  4048     PERFORM  UNTIL SW-READ-INC = 9
  4049              READ INCONSIS  AT  END
  4050                   MOVE  9  TO SW-READ-INC
  4051              NOT AT END
  4052                  ADD   1   TO  W-INCONSISTENCIAS
  4053                  ADD   1   TO  W-ACUM-TIPO-ID (3, 1)
  4054              END-READ
  4055     END-PERFORM.
  4056
  4057*-----------------------------------------------------------------*
  4058* Evalua el estado final de la variable de calIFicaci¢n y arma el *
  4059* registro de salida.                                             *
  4060*-----------------------------------------------------------------*
  4061 0500-GRABAR-SALIDA.
  4062      IF EVALUA-FINAL = 1
  4063         MOVE "1" TO SLD-CALIFICACION
  4064         MOVE  1  TO F
  4065         ADD   1  TO W-CON-INFORMACION
  4066      ELSE
  4067         IF EVALUA-FINAL = 0
  4068            MOVE "5" TO SLD-CALIFICACION
  4069            MOVE  2  TO F
  4070            ADD   1  TO W-SIN-INFORMACION
  4071         END-IF
  4072      END-IF
  4073      MOVE    ENT-TIPO-ID       TO  SLD-TIPO-ID
  4074      MOVE    ENT-NUME-ID       TO  SLD-NUME-ID
  4075      MOVE    ENT-NOMBRE        TO  SLD-NOMBRE
  4076      MOVE    ENT-CIUDAD-EXP    TO  SLD-CIUDAD-EXPED
  4077      IF ENT-TIPO-ID = 1
  4078         MOVE  ENT-GENERO-VAL   TO  SLD-GENERO
  4079         MOVE  ENT-EDAD-RANGO   TO  SLD-RANGO-EDAD
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  71
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4080      END-IF
  4081      MOVE  W-CREDITOS-ACTV     TO  SLD-CREDITOS-ACTV
  4082*------------------------------------------------------*
  4083*     INFORMACION SECTOR FINANCIERO
  4084*------------------------------------------------------*
  4085      MOVE  W-NUM-OBLIG-CAB  TO  SLD-NUM-OBLIG-CAB
  4086      COMPUTE SLD-TOT-INICIAL-CAB = W-TOT-INICIAL-CAB * 1000
  4087      COMPUTE SLD-TOT-SALDOS-CAB  = W-TOT-SALDOS-CAB  * 1000
  4088      COMPUTE SLD-TOT-CUOTAS-CAB  = W-TOT-CUOTAS-CAB  * 1000
  4089      COMPUTE SLD-TOT-MORA-CAB    = W-TOT-MORA-CAB    * 1000
  4090
  4091      MOVE  W-NUM-OBLIG-CAV  TO  SLD-NUM-OBLIG-CAV
  4092      COMPUTE SLD-TOT-INICIAL-CAV = W-TOT-INICIAL-CAV * 1000
  4093      COMPUTE SLD-TOT-SALDOS-CAV  = W-TOT-SALDOS-CAV  * 1000
  4094      COMPUTE SLD-TOT-CUOTAS-CAV  = W-TOT-CUOTAS-CAV  * 1000
  4095      COMPUTE SLD-TOT-MORA-CAV    = W-TOT-MORA-CAV    * 1000
  4096
  4097      MOVE  W-NUM-OBLIG-OTR    TO  SLD-NUM-OBLIG-OTR
  4098      COMPUTE SLD-TOT-INICIAL-OTR = W-TOT-INICIAL-OTR * 1000
  4099      COMPUTE SLD-TOT-SALDOS-OTR  = W-TOT-SALDOS-OTR  * 1000
  4100      COMPUTE SLD-TOT-CUOTAS-OTR  = W-TOT-CUOTAS-OTR  * 1000
  4101      COMPUTE SLD-TOT-MORA-OTR    = W-TOT-MORA-OTR    * 1000
  4102*------------------------------------------------------*
  4103*     RANGOS DE TARJETAS ACTIVAS
  4104*------------------------------------------------------*
  4105      MOVE  W-TOT-NUM-TDC   TO  SLD-TOT-NUM-TDC
  4106      COMPUTE SLD-TOT-CUPOS-TDC = W-TOT-CUPOS-TDC * 1000
  4107      COMPUTE SLD-TOT-SALDO-TDC = W-TOT-SALDO-TDC * 1000
  4108      IF W-TOT-CUPOS-TDC > 0
  4109         COMPUTE W-UTLIZACION-TDC =
  4110         (W-SAL-CUPOS-TDC * 1000) / (W-TOT-CUPOS-TDC * 1000)
  4111         IF W-UTLIZACION-TDC > ZEROS
  4112            MOVE W-UTLIZACION-TDC  TO SLD-POR-UTILIZ-TDC
  4113         END-IF
  4114      END-IF
  4115      COMPUTE SLD-TOT-CUOTAS-TDC = W-TOT-CUOTAS-TDC * 1000
  4116      COMPUTE SLD-TOT-MORA-TDC   = W-TOT-MORA-TDC   * 1000
  4117      MOVE  W-NRO-RANGO-0     TO   SLD-NRO-RANGO-0
  4118      MOVE  W-NRO-RANGO-1     TO   SLD-NRO-RANGO-1
  4119      MOVE  W-NRO-RANGO-2     TO   SLD-NRO-RANGO-2
  4120      MOVE  W-NRO-RANGO-3     TO   SLD-NRO-RANGO-3
  4121      MOVE  W-NRO-RANGO-4     TO   SLD-NRO-RANGO-4
  4122      MOVE  W-NRO-RANGO-5     TO   SLD-NRO-RANGO-5
  4123      MOVE  W-NRO-RANGO-6     TO   SLD-NRO-RANGO-6
  4124      IF W-FEC-MENOR-TDC < 999999
  4125         MOVE W-FEC-MENOR-TDC TO   SLD-FECHA-TDC
  4126      END-IF
  4127*------------------------------------------------------*
  4128*     INFORMACION SECTOR REAL
  4129*------------------------------------------------------*
  4130      MOVE  W-NUM-OBLIG-REAL TO  SLD-NUM-OBLIG-REAL
  4131      COMPUTE SLD-TOT-INICIAL-REAL = W-TOT-INICIAL-REAL * 1000
  4132      COMPUTE SLD-TOT-SALDOS-REAL = W-TOT-SALDOS-REAL * 1000
  4133      COMPUTE SLD-TOT-CUOTAS-REAL = W-TOT-CUOTAS-REAL * 1000
  4134      COMPUTE SLD-TOT-MORA-REAL   = W-TOT-MORA-REAL   * 1000
  4135*------------------------------------------------------*
  4136*     INFORMACION SECTOR TELCOS
  4137*------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  72
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4138     MOVE W-NUM-OBLIG-TELE   TO   SLD-NUM-OBLIG-TELE
  4139     COMPUTE  SLD-TOT-CUOTAS-TELE = W-TOT-CUOTAS-TELE * 1000
  4140     COMPUTE  SLD-TOT-MORA-TELE   = W-TOT-MORA-TELE * 1000
  4141*------------------------------------------------------*
  4142*     INFORMACION SECTOR COOPERATIVO
  4143*------------------------------------------------------*
  4144      MOVE  W-NUM-OBLIG-COOP TO  SLD-NUM-OBLIG-COOP
  4145      COMPUTE SLD-TOT-INICIAL-COOP = W-TOT-INICIAL-COOP * 1000
  4146      COMPUTE SLD-TOT-SALDOS-COOP = W-TOT-SALDOS-COOP * 1000
  4147      COMPUTE SLD-TOT-CUOTAS-COOP = W-TOT-CUOTAS-COOP * 1000
  4148      COMPUTE SLD-TOT-MORA-COOP   = W-TOT-MORA-COOP   * 1000
  4149*------------------------------------------------------*
  4150*     INFORMACION CODEUDORES
  4151*------------------------------------------------------*
  4152      MOVE W-NUM-OBLIG-CODEU  TO  SLD-NUM-OBLIG-CODEU
  4153      COMPUTE SLD-TOT-SALDOS-CODEU = W-TOT-SALDOS-CODEU * 1000
  4154      COMPUTE SLD-TOT-CUOTAS-CODEU = W-TOT-CUOTAS-CODEU * 1000
  4155      COMPUTE SLD-TOT-MORA-CODEU   = W-TOT-MORA-CODEU   * 1000
  4156*------------------------------------------------------*
  4157*     MORAS  ACTUALES
  4158*------------------------------------------------------*
  4159      MOVE   W-CREDITOS-ALDIA    TO   SLD-CREDITOS-ALDIA
  4160      MOVE   W-MORAS-30-ACT      TO   SLD-MORA-30
  4161      MOVE   W-MORAS-60-ACT      TO   SLD-MORA-60
  4162      MOVE   W-MORAS-90-ACT      TO   SLD-MORA-90
  4163      MOVE   W-MORAS-120-ACT     TO   SLD-MORA-120
  4164      MOVE   W-CAR-CASTIGA       TO   SLD-CAR-CASTIGA
  4165      MOVE   W-DUD-RECAUDO       TO   SLD-DUD-RECAUDO
  4166      MOVE   W-CUENTAS-COBRADOR  TO   SLD-CUENTAS-COBRADOR
  4167*------------------------------------------------------*
  4168*     MORAS  HISTORICAS
  4169*------------------------------------------------------*
  4170      MOVE  W-MORAS-30-HIS       TO   SLD-MORA-30-HIS
  4171      MOVE  W-MORAS-60-HIS       TO   SLD-MORA-60-HIS
  4172      MOVE  W-MORAS-90-HIS       TO   SLD-MORA-90-HIS
  4173      MOVE  W-MORAS-120-HIS      TO   SLD-MORA-120-HIS
  4174      MOVE  W-CANC-MMANEJO       TO   SLD-CANC-MMANEJO
  4175      MOVE  W-CAR-RECUPERADA     TO   SLD-CAR-RECUPERADA
  4176*------------------------------------------------------*
  4177*     MORAS  MAXIMAS POR SECTOR
  4178*------------------------------------------------------*
  4179      MOVE  W-MORA-MAX-TDC      TO   SLD-MORA-MAX-TDC
  4180      MOVE  W-MORA-MAX-CAB      TO   SLD-MORA-MAX-CAB
  4181      MOVE  W-MORA-MAX-COOP     TO   SLD-MORA-MAX-COOP
  4182      MOVE  W-MORA-MAX-CAV      TO   SLD-MORA-MAX-CAV
  4183*------------------------------------------------------*
  4184*     ENDEUDAMIENTO
  4185*------------------------------------------------------*
  4186      IF E = 3
  4187         MOVE  W-MAYOR-END (3) TO SLD-END-CALIF-1-TRIM
  4188         MOVE  W-MAYOR-END (2) TO SLD-END-CALIF-2-TRIM
  4189      ELSE
  4190         IF E = 2
  4191            MOVE W-MAYOR-END (2) TO SLD-END-CALIF-1-TRIM
  4192            MOVE W-MAYOR-END (1) TO SLD-END-CALIF-2-TRIM
  4193         ELSE
  4194            MOVE W-MAYOR-END (1) TO SLD-END-CALIF-1-TRIM
  4195            MOVE SPACES          TO SLD-END-CALIF-2-TRIM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  73
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4196         END-IF
  4197      END-IF
  4198*------------------------------------------------------*
  4199*     CUENTA CORRIENTE
  4200*------------------------------------------------------*
  4201      MOVE  W-CTAS-AHORROS        TO  SLD-CTAS-AHORRO
  4202      MOVE  W-CTES-CORRIENTES     TO  SLD-CTES-CORRIENTES
  4203      MOVE  W-CTES-EMBARGADAS     TO  SLD-CTES-EMBARGADAS
  4204      MOVE  W-CTES-MAL-MANEJO     TO  SLD-CTES-MAL-MANEJO
  4205      MOVE  W-CTES-SALDADAS       TO  SLD-CTES-SALDADAS
  4206      MOVE  W-TOTAL-CONSULTAS     TO  SLD-TOTAL-CONSULTAS
  4207      PERFORM 1000-ACUMULAR-ESTADISTICO
  4208      WRITE REG-SALIDA
  4209      ADD    1    TO  GRABADOS.
  4210
  4211*----------------------------------------*
  4212* Rutina manejo valores estadisticos     *
  4213*----------------------------------------*
  4214 1000-ACUMULAR-ESTADISTICO.
  4215     IF ENT-TIPO-ID = 1
  4216        EVALUATE ENT-EDAD-RANGO
  4217              WHEN "66+  "
  4218                   ADD  1  TO  W-EDAD-66
  4219              WHEN "56-65"
  4220                   ADD  1  TO  W-EDAD-56-65
  4221              WHEN "46-55"
  4222                   ADD  1  TO  W-EDAD-46-55
  4223              WHEN "36-45"
  4224                   ADD  1  TO  W-EDAD-36-45
  4225              WHEN "29-35"
  4226                   ADD  1  TO  W-EDAD-29-35
  4227              WHEN "22-28"
  4228                   ADD  1  TO  W-EDAD-22-28
  4229              WHEN "18-21"
  4230                   ADD  1  TO  W-EDAD-18-21
  4231        END-EVALUATE
  4232     END-IF
  4233     PERFORM  1100-ACUMULAR-ESTADO.
  4234
  4235*------------------------------------------------------------*
  4236*    ACUMULACION PARA CLIENTES POR ESTADO
  4237*------------------------------------------------------------*
  4238 1100-ACUMULAR-ESTADO.
  4239     ADD   1   TO  W-ACUM-TIPO-ID (F, 1)
  4240     IF ENT-TIPO-ID = 1
  4241        IF ENT-GENERO-VAL = "M"
  4242           ADD  1  TO  W-ACUM-TIPO-ID (F, 2)
  4243        ELSE
  4244           IF ENT-GENERO-VAL = "F"
  4245              ADD  1  TO  W-ACUM-TIPO-ID (F, 3)
  4246           ELSE
  4247              ADD  1  TO  W-ACUM-TIPO-ID (F, 2)
  4248           END-IF
  4249        END-IF
  4250     ELSE
  4251        IF ENT-TIPO-ID = 4
  4252           ADD  1  TO  W-ACUM-TIPO-ID (F, 4)
  4253        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  74
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4254           ADD  1  TO  W-ACUM-TIPO-ID (F, 5)
  4255        END-IF
  4256     END-IF
  4257     IF F = 1
  4258        PERFORM  1200-SELECT-PEOR-ESTADO
  4259        PERFORM  1400-SELECT-SECTOR
  4260     END-IF.
  4261
  4262*------------------------------------------------------------*
  4263*    PEOR ESTADO ACTUAL INFORME GENERAL
  4264*------------------------------------------------------------*
  4265 1200-SELECT-PEOR-ESTADO.
  4266     IF W-CAR-CASTIGA > ZEROS
  4267        ADD 1 TO W-TOT-CAR-CASTIGA
  4268     ELSE
  4269        IF W-DUD-RECAUDO > ZEROS
  4270           ADD 1 TO W-TOT-DUD-RECAUDO
  4271        ELSE
  4272           IF W-CTES-EMBARGADAS > ZEROS
  4273              ADD 1 TO W-TOT-CTES-EMBARGADAS
  4274           ELSE
  4275              IF W-MORAS-120-ACT  > ZEROS
  4276                 ADD 1 TO W-TOT-MORAS-120-ACT
  4277              ELSE
  4278                 IF W-MORAS-90-ACT  > ZEROS
  4279                    ADD 1 TO W-TOT-MORAS-90-ACT
  4280                 ELSE
  4281                    IF W-MORAS-60-ACT > ZEROS
  4282                       ADD 1 TO W-TOT-MORAS-60-ACT
  4283                    ELSE
  4284                       IF W-MORAS-30-ACT  > ZEROS
  4285                          ADD 1 TO W-TOT-MORAS-30-ACT
  4286                       ELSE
  4287                          IF W-ENDEUDA = "B" OR "C" OR
  4288                                         "D" OR "E"
  4289                             ADD 1 TO W-TOT-W-ENDEUDA
  4290                          ELSE
  4291                             IF W-CREDITOS-ALDIA > ZEROS OR
  4292                                W-ENDEUDA = "A"
  4293                                ADD 1 TO W-TOT-ALDIA
  4294                             ELSE
  4295                                ADD 1 TO W-TOT-SIN-CTAS
  4296                             END-IF
  4297                          END-IF
  4298                       END-IF
  4299                    END-IF
  4300                 END-IF
  4301              END-IF
  4302           END-IF
  4303        END-IF
  4304     END-IF.
  4305
  4306*------------------------------------------------------------*
  4307*    PEOR ESTADO ACTUAL SECTORES
  4308*------------------------------------------------------------*
  4309 1400-SELECT-SECTOR.
  4310      IF W-CC-DR-FINA > ZEROS
  4311         ADD 1 TO W-TOT-CC-DR-FINA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  75
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4312      ELSE
  4313         IF W-MORAS-FINA > ZEROS
  4314            ADD 1 TO W-TOT-MORAS-FINA
  4315         ELSE
  4316            IF W-ALDIA-FINA > ZEROS
  4317               ADD 1 TO W-TOT-ALDIA-FINA
  4318            END-IF
  4319         END-IF
  4320      END-IF
  4321      IF W-CC-DR-REAL > ZEROS
  4322         ADD 1 TO W-TOT-CC-DR-REAL
  4323      ELSE
  4324         IF W-MORAS-REAL > ZEROS
  4325            ADD 1 TO W-TOT-MORAS-REAL
  4326         ELSE
  4327            IF W-ALDIA-REAL > ZEROS
  4328               ADD 1 TO W-TOT-ALDIA-REAL
  4329            END-IF
  4330         END-IF
  4331      END-IF
  4332      IF W-CC-DR-COOP > ZEROS
  4333         ADD 1 TO W-TOT-CC-DR-COOP
  4334      ELSE
  4335         IF W-MORAS-COOP > ZEROS
  4336            ADD 1 TO W-TOT-MORAS-COOP
  4337         ELSE
  4338            IF W-ALDIA-COOP > ZEROS
  4339               ADD 1 TO W-TOT-ALDIA-COOP
  4340            END-IF
  4341         END-IF
  4342      END-IF
  4343      IF W-CC-DR-TELE > ZEROS
  4344         ADD 1 TO W-TOT-CC-DR-TELE
  4345      ELSE
  4346         IF W-MORAS-TELE > ZEROS
  4347            ADD 1 TO W-TOT-MORAS-TELE
  4348         ELSE
  4349            IF W-ALDIA-TELE > ZEROS
  4350               ADD 1 TO W-TOT-ALDIA-TELE
  4351            END-IF
  4352         END-IF
  4353      END-IF.
  4354*-------------------------------------*
  4355* REVISA CODEUDOR                     *
  4356*-------------------------------------*
  4357 1900-EVALUAR-CODEUDOR.
  4358      MOVE  ZEROS        TO SW-CODEUDOR
  4359      MOVE NUM-CTA-ABD07 TO TEM-NRO-CTA
  4360      IF TEM-NRO-CTA-C17 = "C" OR "c"
  4361         MOVE  1 TO  SW-CODEUDOR
  4362      ELSE
  4363         IF GARANTE-ABD07 > ZEROS AND GARANTE-ABD07 < 8 AND
  4364           (IND-AMPLIACION-ABD02 = 5 OR 2)
  4365            MOVE  1  TO  SW-CODEUDOR
  4366         END-IF
  4367      END-IF.
  4368
  4369*-------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  76
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4370* EVALUA TODA CLASE DE CARTERA PARA INFORMES
  4371*-------------------------------------------------*
  4372 2000-EVALUAR-CLASE-CARTERA.
  4373     IF TAB-VIGENTES-CARTERA (NOV-REPORT-ABD07) = 1
  4374        PERFORM 32000-PROCESAR-VALORES
  4375        PERFORM 33000-PROCESAR-BDACUE
  4376        ADD   1   TO   W-CREDITOS-ACTV
  4377        IF SW-CODEUDOR = ZEROS
  4378           IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4379              PERFORM 2200-SECTOR-FINANCIERO
  4380           ELSE
  4381              IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4382                 PERFORM 4200-SECTOR-REAL
  4383              ELSE
  4384                 IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4385                    PERFORM 4400-SECTOR-COOPERATIVO
  4386                 ELSE
  4387                    IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4388                       PERFORM 4000-SECTOR-TELCOS
  4389                    END-IF
  4390                 END-IF
  4391              END-IF
  4392           END-IF
  4393        ELSE
  4394           PERFORM  4600-VALORES-CODEUDORES
  4395        END-IF
  4396     END-IF.
  4397
  4398*----------------------------------------------------------------*
  4399* EVALUA VALORES SECTOR FINANCIERO
  4400*----------------------------------------------------------------*
  4401 2200-SECTOR-FINANCIERO.
  4402      IF COD-CTA-ABD07 = 02
  4403         PERFORM 3000-EVALUA-TDC-ACTIVA
  4404      ELSE
  4405         IF COD-CTA-ABD07 = 13
  4406            PERFORM 2300-ACUM-VLRES-CAV
  4407         ELSE
  4408            IF COD-CTA-ABD07 = 05 OR 03
  4409               IF TIPO-OBLIGACION-ABD07 = 3
  4410                  PERFORM 2300-ACUM-VLRES-CAV
  4411               ELSE
  4412                  PERFORM 2400-ACUM-VLRES-CAB
  4413               END-IF
  4414            ELSE
  4415               PERFORM 2500-ACUM-VLRES-OTROS
  4416            END-IF
  4417         END-IF
  4418      END-IF.
  4419
  4420*----------------------------------------------------------------*
  4421* VALORES CARTERA  CAV
  4422*----------------------------------------------------------------*
  4423 2300-ACUM-VLRES-CAV.
  4424      ADD  1  TO  W-NUM-OBLIG-CAV
  4425      IF IND-VALORES-VALVLR = 1
  4426         IF VEC-VALOR-VALVLR (2) = 1
  4427            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-CAV
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  77
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4428         END-IF
  4429         IF VEC-VALOR-VALVLR (3) = 1
  4430            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-CAV
  4431                                            W-SALDOS-SEC-FINA
  4432         END-IF
  4433         IF VEC-VALOR-VALVLR (1) = 1
  4434            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-CAV
  4435                                            W-CUOTAS-SEC-FINA
  4436         END-IF
  4437         IF VEC-VALOR-VALVLR (5) = 1
  4438            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4439               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4440            END-IF
  4441            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-CAV
  4442                                            W-MORAS-SEC-FINA
  4443         END-IF
  4444      END-IF.
  4445
  4446*----------------------------------------------------------------*
  4447* VALORES CARTERA  CAB
  4448*----------------------------------------------------------------*
  4449 2400-ACUM-VLRES-CAB.
  4450      ADD  1  TO  W-NUM-OBLIG-CAB
  4451      IF IND-VALORES-VALVLR = 1
  4452         IF VEC-VALOR-VALVLR (2) = 1
  4453            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-CAB
  4454         END-IF
  4455         IF VEC-VALOR-VALVLR (3) = 1
  4456            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-CAB
  4457                                            W-SALDOS-SEC-FINA
  4458         END-IF
  4459         IF VEC-VALOR-VALVLR (1) = 1
  4460            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-CAB
  4461                                            W-CUOTAS-SEC-FINA
  4462         END-IF
  4463         IF VEC-VALOR-VALVLR (5) = 1
  4464            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4465               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4466            END-IF
  4467            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-CAB
  4468                                            W-MORAS-SEC-FINA
  4469         END-IF
  4470      END-IF.
  4471
  4472*----------------------------------------------------------------*
  4473* VALORES CARTERA  OTRAS CUENTAS SECTOR FINANCIERO
  4474*----------------------------------------------------------------*
  4475 2500-ACUM-VLRES-OTROS.
  4476      ADD  1  TO  W-NUM-OBLIG-OTR
  4477      IF IND-VALORES-VALVLR = 1
  4478         IF VEC-VALOR-VALVLR (2) = 1
  4479            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-OTR
  4480         END-IF
  4481         IF VEC-VALOR-VALVLR (3) = 1
  4482            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-OTR
  4483                                            W-SALDOS-SEC-FINA
  4484         END-IF
  4485         IF VEC-VALOR-VALVLR (1) = 1
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  78
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4486            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-OTR
  4487                                            W-CUOTAS-SEC-FINA
  4488         END-IF
  4489         IF VEC-VALOR-VALVLR (5) = 1
  4490            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4491               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4492            END-IF
  4493            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-OTR
  4494                                            W-MORAS-SEC-FINA
  4495         END-IF
  4496      END-IF.
  4497
  4498*----------------------------------------------------------------*
  4499* EVALUAR VALORES DE TARJETA DE CREDITO                          *
  4500*----------------------------------------------------------------*
  4501 3000-EVALUA-TDC-ACTIVA.
  4502      ADD   1    TO    W-TOT-NUM-TDC
  4503      IF IND-VALORES-VALVLR = 1
  4504         IF VEC-VALOR-VALVLR (2) = 1
  4505            IF VALOR-INICIAL-ABD07 > ZEROS
  4506               ADD VALOR-INICIAL-ABD07  TO W-TOT-CUPOS-TDC
  4507               IF VEC-VALOR-VALVLR (3) = 1
  4508                  ADD VALOR-SALDO-DEUDAM-ABD07
  4509                                        TO W-SAL-CUPOS-TDC
  4510               END-IF
  4511            END-IF
  4512         END-IF
  4513         IF VEC-VALOR-VALVLR (3) = 1
  4514            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDO-TDC
  4515                                            W-SALDOS-SEC-FINA
  4516         END-IF
  4517         IF VEC-VALOR-VALVLR (1) = 1
  4518            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-TDC
  4519                                            W-CUOTAS-SEC-FINA
  4520         END-IF
  4521         IF VEC-VALOR-VALVLR (5) = 1
  4522            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4523               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4524            END-IF
  4525            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-TDC
  4526                                            W-MORAS-SEC-FINA
  4527         END-IF
  4528      END-IF
  4529      IF IND-VALORES-VALVLR = 1
  4530         IF VEC-VALOR-VALVLR (2) = 1
  4531            IF VALOR-INICIAL-ABD07 = ZEROS
  4532               ADD   1   TO   W-NRO-RANGO-0
  4533            ELSE
  4534               IF VALOR-INICIAL-ABD07 <= 1000
  4535                  ADD   1   TO   W-NRO-RANGO-1
  4536               ELSE
  4537                  IF VALOR-INICIAL-ABD07 <= 2000
  4538                     ADD   1   TO   W-NRO-RANGO-2
  4539                  ELSE
  4540                     IF VALOR-INICIAL-ABD07 <= 4000
  4541                        ADD   1   TO   W-NRO-RANGO-3
  4542                     ELSE
  4543                        IF VALOR-INICIAL-ABD07 <= 8000
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  79
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4544                           ADD   1   TO   W-NRO-RANGO-4
  4545                        ELSE
  4546                           IF VALOR-INICIAL-ABD07 <= 12000
  4547                              ADD   1   TO   W-NRO-RANGO-5
  4548                           ELSE
  4549                              ADD   1   TO   W-NRO-RANGO-6
  4550                           END-IF
  4551                        END-IF
  4552                     END-IF
  4553                  END-IF
  4554               END-IF
  4555            END-IF
  4556         ELSE
  4557            ADD   1   TO   W-NRO-RANGO-0
  4558         END-IF
  4559      ELSE
  4560         ADD   1   TO   W-NRO-RANGO-0
  4561      END-IF
  4562      MOVE  ZEROS             TO  W-FECHA-AUX
  4563      MOVE FECHA-APERT-ABD07  TO  W-FECHA-AUX
  4564      MOVE  W-MES-AUX         TO  W-FMILENIO-MES
  4565      MOVE  W-ANO-AUX         TO  W-FMILENIO-ANIO
  4566      IF W-ANO-AUX   > 60
  4567         MOVE 19              TO  W-FMILENIO-SIGLO
  4568      ELSE
  4569         MOVE 20              TO  W-FMILENIO-SIGLO
  4570      END-IF
  4571      MOVE  W-FECHA-MILENIO   TO  W-FEC-APERTURA
  4572      IF W-FEC-APERTURA < W-FEC-MENOR-TDC
  4573         MOVE W-FEC-APERTURA  TO  W-FEC-MENOR-TDC
  4574      END-IF.
  4575
  4576*----------------------------------------------------------------*
  4577* VALORES SECTOR TELCOS
  4578*----------------------------------------------------------------*
  4579 4000-SECTOR-TELCOS.
  4580      ADD  1  TO  W-NUM-OBLIG-TELE
  4581      IF IND-VALORES-VALVLR = 1
  4582         IF VEC-VALOR-VALVLR (1) = 1
  4583            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-TELE
  4584         END-IF
  4585         IF VEC-VALOR-VALVLR (5) = 1
  4586            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4587               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4588            END-IF
  4589            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-TELE
  4590         END-IF
  4591      END-IF.
  4592
  4593*----------------------------------------------------------------*
  4594* VALORES CARTERA  SECTOR REAL
  4595*----------------------------------------------------------------*
  4596 4200-SECTOR-REAL.
  4597      ADD  1  TO  W-NUM-OBLIG-REAL
  4598      IF IND-VALORES-VALVLR = 1
  4599         IF VEC-VALOR-VALVLR (2) = 1
  4600            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-REAL
  4601         END-IF
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  80
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4602         IF VEC-VALOR-VALVLR (3) = 1
  4603            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-REAL
  4604                                            W-SALDOS-SEC-REAL
  4605         END-IF
  4606         IF VEC-VALOR-VALVLR (1) = 1
  4607            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-REAL
  4608                                            W-CUOTAS-SEC-REAL
  4609         END-IF
  4610         IF VEC-VALOR-VALVLR (5) = 1
  4611            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4612               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4613            END-IF
  4614            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-REAL
  4615                                            W-MORAS-SEC-REAL
  4616         END-IF
  4617      END-IF.
  4618
  4619*----------------------------------------------------------------*
  4620* VALORES CARTERA  SECTOR COOPERATIVO
  4621*----------------------------------------------------------------*
  4622 4400-SECTOR-COOPERATIVO.
  4623      ADD  1  TO  W-NUM-OBLIG-COOP
  4624      IF IND-VALORES-VALVLR = 1
  4625         IF VEC-VALOR-VALVLR (2) = 1
  4626            ADD VALOR-INICIAL-ABD07      TO W-TOT-INICIAL-COOP
  4627         END-IF
  4628         IF VEC-VALOR-VALVLR (3) = 1
  4629            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-COOP
  4630                                            W-SALDOS-SEC-COOP
  4631         END-IF
  4632         IF VEC-VALOR-VALVLR (1) = 1
  4633            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-COOP
  4634                                            W-CUOTAS-SEC-COOP
  4635         END-IF
  4636         IF VEC-VALOR-VALVLR (5) = 1
  4637            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4638               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
  4639            END-IF
  4640            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-COOP
  4641                                            W-MORAS-SEC-COOP
  4642         END-IF
  4643      END-IF.
  4644
  4645*--------------------------------------------------*
  4646* REVISA VALORES DE CODEUDORES
  4647*--------------------------------------------------*
  4648 4600-VALORES-CODEUDORES.
  4649      ADD  1  TO  W-NUM-OBLIG-CODEU
  4650      IF IND-VALORES-VALVLR = 1
  4651         IF VEC-VALOR-VALVLR (3) = 1
  4652            ADD VALOR-SALDO-DEUDAM-ABD07 TO W-TOT-SALDOS-CODEU
  4653         END-IF
  4654         IF VEC-VALOR-VALVLR (1) = 1
  4655            ADD CUANTIA-ABD07            TO W-TOT-CUOTAS-CODEU
  4656         END-IF
  4657         IF VEC-VALOR-VALVLR (5) = 1
  4658            IF NOV-REPORT-ABD07  = 01 OR 13 OR 14 OR 15 OR 16
  4659               MOVE ZEROS TO VALOR-SALDO-MORAM-ABD07
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  81
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4660            END-IF
  4661            ADD VALOR-SALDO-MORAM-ABD07  TO W-TOT-MORA-CODEU
  4662         END-IF
  4663      END-IF.
  4664
  4665*----------------------------------------------------------------*
  4666* RECATEGORIZA EL PRODUCTO DEPENDIENDO DEL SUSCRIPTOR            *
  4667*----------------------------------------------------------------*
  4668 5000-EVALUAR-PRODUCTO.
  4669*---------------------*
  4670     IF COD-SUS-ABD07 = 080001
  4671        IF TAB-VIGENTES-CARTERA (NOV-REPORT-ABD07) = 1
  4672           PERFORM 32000-PROCESAR-VALORES
  4673           PERFORM 33000-PROCESAR-BDACUE
  4674           IF IND-VALORES-VALVLR    = 1 AND
  4675              VEC-VALOR-VALVLR (11) = 1
  4676              IF TOTAL-CUOTAS-ABD07 > 60
  4677                 MOVE  13  TO  COD-CTA-ABD07
  4678              END-IF
  4679           END-IF
  4680        END-IF
  4681     ELSE
  4682        IF COD-SUS-ABD07 = 020151 OR 020167 OR 020370
  4683           MOVE   11  TO  COD-CTA-ABD07
  4684        ELSE
  4685           IF COD-SUS-ABD07 = 020055 OR 020007
  4686              MOVE   03  TO  COD-CTA-ABD07
  4687           ELSE
  4688              IF COD-SUS-ABD07 = 240033
  4689                 MOVE   23  TO  COD-CTA-ABD07
  4690              END-IF
  4691           END-IF
  4692        END-IF
  4693     END-IF.
  4694
  4695*----------------------------------------------------------------*
  4696* CUENTA MORAS ACTUALES Y ESTADOS ESPECIALES                     *
  4697*----------------------------------------------------------------*
  4698 6000-CUENTA-MORAS-ACTUAL-ESTADO.
  4699      EVALUATE TAB-NOV-CART-CODINT(NOV-REPORT-ABD07)
  4700           WHEN 01
  4701                ADD  1  TO  W-CREDITOS-ALDIA
  4702           WHEN 12
  4703                ADD  1  TO  W-MORAS-30-ACT
  4704           WHEN 13
  4705                ADD  1  TO  W-MORAS-60-ACT
  4706           WHEN 14
  4707                ADD  1  TO  W-MORAS-90-ACT
  4708           WHEN 15
  4709                ADD  1  TO  W-MORAS-120-ACT
  4710           WHEN 09
  4711                ADD  1  TO  W-CAR-CASTIGA
  4712           WHEN 11
  4713                ADD  1  TO  W-DUD-RECAUDO
  4714           WHEN 08
  4715                ADD  1  TO  W-CANC-MMANEJO
  4716           WHEN 10
  4717                ADD  1  TO  W-CAR-RECUPERADA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  82
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4718      END-EVALUATE
  4719      IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 01
  4720         IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4721            ADD  1  TO  W-ALDIA-FINA
  4722         ELSE
  4723            IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4724               ADD  1  TO  W-ALDIA-REAL
  4725            ELSE
  4726               IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4727                  ADD  1  TO  W-ALDIA-COOP
  4728               ELSE
  4729                  IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4730                     ADD  1  TO  W-ALDIA-TELE
  4731                  END-IF
  4732               END-IF
  4733            END-IF
  4734         END-IF
  4735      ELSE
  4736         IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 12 OR 13
  4737                                                OR  14 OR 15
  4738            IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4739               ADD  1  TO  W-MORAS-FINA
  4740            ELSE
  4741               IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4742                  ADD  1  TO  W-MORAS-REAL
  4743               ELSE
  4744                  IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4745                     ADD  1  TO  W-MORAS-COOP
  4746                  ELSE
  4747                     IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4748                        ADD  1  TO  W-MORAS-TELE
  4749                     END-IF
  4750                  END-IF
  4751               END-IF
  4752            END-IF
  4753         ELSE
  4754            IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 09 OR 11
  4755               IF W-CART-TIPO(COD-CTA-ABD07) = 01
  4756                  ADD  1  TO  W-CC-DR-FINA
  4757               ELSE
  4758                  IF W-CART-TIPO(COD-CTA-ABD07) = 02
  4759                     ADD  1  TO  W-CC-DR-REAL
  4760                  ELSE
  4761                     IF W-CART-TIPO(COD-CTA-ABD07) = 03
  4762                        ADD  1  TO  W-CC-DR-COOP
  4763                     ELSE
  4764                        IF W-CART-TIPO(COD-CTA-ABD07) = 04
  4765                           ADD  1  TO  W-CC-DR-TELE
  4766                        END-IF
  4767                     END-IF
  4768                  END-IF
  4769               END-IF
  4770            END-IF
  4771         END-IF
  4772      END-IF.
  4773
  4774*-------------------------------------------*
  4775*    DETERMINACION DE LA MORA MAXIMA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  83
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4776*-------------------------------------------*
  4777 6200-MORA-MAXIMA-CUENTAS.
  4778     IF COD-CTA-ABD07 = 03 OR 05
  4779        IF TIPO-OBLIGACION-ABD07 = 3
  4780           IF MORA-MAXIMA-ABD07 > W-MORA-MAX-CAV
  4781              MOVE  MORA-MAXIMA-ABD07 TO W-MORA-MAX-CAV
  4782           END-IF
  4783        ELSE
  4784           IF MORA-MAXIMA-ABD07 > W-MORA-MAX-CAB
  4785              MOVE  MORA-MAXIMA-ABD07  TO  W-MORA-MAX-CAB
  4786           END-IF
  4787        END-IF
  4788     ELSE
  4789        IF COD-CTA-ABD07 = 02
  4790           IF MORA-MAXIMA-ABD07 > W-MORA-MAX-TDC
  4791              MOVE  MORA-MAXIMA-ABD07  TO  W-MORA-MAX-TDC
  4792           END-IF
  4793        ELSE
  4794           IF COD-CTA-ABD07 = 13
  4795              IF MORA-MAXIMA-ABD07 > W-MORA-MAX-CAV
  4796                 MOVE  MORA-MAXIMA-ABD07 TO W-MORA-MAX-CAV
  4797              END-IF
  4798           ELSE
  4799              IF COD-CTA-ABD07 = 06 OR 27
  4800                 IF MORA-MAXIMA-ABD07 > W-MORA-MAX-COOP
  4801                    MOVE  MORA-MAXIMA-ABD07 TO  W-MORA-MAX-COOP
  4802                 END-IF
  4803              END-IF
  4804           END-IF
  4805        END-IF
  4806     END-IF
  4807     IF ADJETIVO1-ABD07 = 2  OR
  4808        ADJETIVO2-ABD07 = 2  OR
  4809        ADJETIVO3-ABD07 = 2
  4810        ADD  1 TO W-CUENTAS-COBRADOR
  4811     END-IF.
  4812
  4813*----------------------------------------------------------------*
  4814* EVALUA  SI EN EL ULTIMO AÑO TUVO ALGUN TIPO DE MORA            *
  4815*----------------------------------------------------------------*
  4816 5800-CUENTA-MORAS-HISTORICAS.
  4817      MOVE    ZEROS     TO     TOPE-V
  4818      IF TAB-VIGENTES-CARTERA (NOV-REPORT-ABD07) = 1
  4819         MOVE     12       TO  TOPE-V
  4820         PERFORM  5900-CUENTA-MORAS-HIST-12MESES
  4821      ELSE
  4822         MOVE  ZEROS              TO  W-FECHA-AUX
  4823         MOVE  FEC-NOVEDAD-ABD07  TO  W-FECHA-AUX
  4824         MOVE  W-MES-AUX          TO  W-FMILENIO-MES
  4825         MOVE  W-ANO-AUX          TO  W-FMILENIO-ANIO
  4826         IF W-ANO-AUX   > 60
  4827            MOVE 19               TO  W-FMILENIO-SIGLO
  4828         ELSE
  4829            MOVE 20               TO  W-FMILENIO-SIGLO
  4830         END-IF
  4831         MOVE  W-FECHA-MILENIO    TO  W-FEC-NOVEDAD
  4832         MOVE    ZEROS            TO  W-MESES-NOV
  4833         COMPUTE W-MESES-NOV =
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  84
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4834                (W-ANO-HOY * 12 + W-MES-HOY) -
  4835                (W-ANO-NOV * 12 + W-MES-NOV)
  4836         IF W-MESES-NOV < 13
  4837            COMPUTE  TOPE-V = 12 - W-MESES-NOV
  4838            PERFORM  5900-CUENTA-MORAS-HIST-12MESES
  4839         END-IF
  4840      END-IF.
  4841
  4842*----------------------------------------------------------------*
  4843* EVALUA  SI EN LOS ULTIMOS 12 meses TUVO ALGUN TIPO DE MORA     *
  4844*----------------------------------------------------------------*
  4845 5900-CUENTA-MORAS-HIST-12MESES.
  4846      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "5" BY "N"
  4847      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "9" BY "-"
  4848      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "6" BY "-"
  4849      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "7" BY "-"
  4850      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "8" BY "N"
  4851      INSPECT W-MORAS-HISTORICAS-V REPLACING  ALL "0" BY " "
  4852      PERFORM VARYING W-IND FROM 1 BY 1 UNTIL W-IND > TOPE-V
  4853            IF W-MORAS-HISTORICAS (W-IND) = "1"
  4854               ADD 1 TO W-MORAS-30-HIS
  4855            ELSE
  4856               IF W-MORAS-HISTORICAS (W-IND) = "2"
  4857                  ADD 1 TO W-MORAS-60-HIS
  4858               ELSE
  4859                  IF W-MORAS-HISTORICAS (W-IND) = "3"
  4860                     ADD 1 TO W-MORAS-90-HIS
  4861                  ELSE
  4862                     IF W-MORAS-HISTORICAS (W-IND) = "4"
  4863                        ADD 1 TO W-MORAS-120-HIS
  4864                     END-IF
  4865                  END-IF
  4866               END-IF
  4867            END-IF
  4868      END-PERFORM.
  4869
  4870*----------------------------------------------------------------*
  4871* EVALUA SI EN LOS ULTIMOS meses TUVO ALGUN TIPO DE MORA         *
  4872*----------------------------------------------------------------*
  4873 5900-CUENTA-MORAS-HISTORICAS.
  4874      PERFORM VARYING W-IND FROM 1 BY 1 UNTIL W-IND > W-VECTOR-L
  4875            IF W-MORAS-HISTORICAS (W-IND) = "1"
  4876               ADD 1 TO W-MORAS-30-HIS
  4877            ELSE
  4878               IF W-MORAS-HISTORICAS (W-IND) = "2"
  4879                  ADD 1 TO W-MORAS-60-HIS
  4880               ELSE
  4881                  IF W-MORAS-HISTORICAS (W-IND) = "3"
  4882                     ADD 1 TO W-MORAS-90-HIS
  4883                  ELSE
  4884                     IF W-MORAS-HISTORICAS (W-IND) = "4"
  4885                        ADD 1 TO W-MORAS-120-HIS
  4886                     END-IF
  4887                  END-IF
  4888               END-IF
  4889            END-IF
  4890*
  4891      END-PERFORM.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  85
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4892
  4893
  4894*------------------------------------------------------------*
  4895*    ESTADISTICO  POR TIPO DE IDENTIFICACION
  4896*------------------------------------------------------------*
  4897 9800-GRABAR-ESTADISTICA.
  4898     PERFORM VARYING  F FROM 1 BY 1 UNTIL F > 3
  4899           INITIALIZE  REG-ESTADIS
  4900           IF F = 1
  4901              MOVE "Clientes con informacion"  TO SLD-DETALLE
  4902           ELSE
  4903              IF F = 2
  4904                 MOVE "Clientes sin informacion" TO SLD-DETALLE
  4905              ELSE
  4906                 MOVE "Inconsistencias         " TO SLD-DETALLE
  4907              END-IF
  4908           END-IF
  4909           MOVE  W-ACUM-TIPO-ID (F, 1) TO SLD-ESTADIS-VALOR-1
  4910           MOVE  W-ACUM-TIPO-ID (F, 2) TO SLD-ESTADIS-VALOR-2
  4911           MOVE  W-ACUM-TIPO-ID (F, 3) TO SLD-ESTADIS-VALOR-3
  4912           MOVE  W-ACUM-TIPO-ID (F, 4) TO SLD-ESTADIS-VALOR-4
  4913           MOVE  W-ACUM-TIPO-ID (F, 5) TO SLD-ESTADIS-VALOR-5
  4914           WRITE  REG-ESTADIS
  4915     END-PERFORM
  4916     INITIALIZE  REG-ESTADIS
  4917     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  4918     WRITE  REG-ESTADIS
  4919     WRITE  REG-ESTADIS
  4920*------------------------------------------------------------*
  4921*    ESTADISTICO POR RANGO DE EDAD
  4922*------------------------------------------------------------*
  4923     INITIALIZE  REG-ESTADIS
  4924     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  4925     INITIALIZE  REG-ESTADIS
  4926     MOVE "18 a 21 años"    TO   SLD-DETALLE
  4927     MOVE W-EDAD-18-21      TO   SLD-ESTADIS-VALOR-1
  4928     WRITE  REG-ESTADIS
  4929     INITIALIZE  REG-ESTADIS
  4930     MOVE "22 a 28 años"    TO   SLD-DETALLE
  4931     MOVE W-EDAD-22-28      TO   SLD-ESTADIS-VALOR-1
  4932     WRITE  REG-ESTADIS
  4933     INITIALIZE  REG-ESTADIS
  4934     MOVE "29 a 35 años"    TO   SLD-DETALLE
  4935     MOVE W-EDAD-29-35      TO   SLD-ESTADIS-VALOR-1
  4936     WRITE  REG-ESTADIS
  4937     INITIALIZE  REG-ESTADIS
  4938     MOVE "36 a 45 años"    TO   SLD-DETALLE
  4939     MOVE W-EDAD-36-45      TO   SLD-ESTADIS-VALOR-1
  4940     WRITE  REG-ESTADIS
  4941     INITIALIZE  REG-ESTADIS
  4942     MOVE "46 a 55 años"    TO   SLD-DETALLE
  4943     MOVE W-EDAD-46-55      TO   SLD-ESTADIS-VALOR-1
  4944     WRITE  REG-ESTADIS
  4945     INITIALIZE  REG-ESTADIS
  4946     MOVE "56 a 65 años"    TO   SLD-DETALLE
  4947     MOVE W-EDAD-56-65      TO   SLD-ESTADIS-VALOR-1
  4948     WRITE  REG-ESTADIS
  4949     INITIALIZE  REG-ESTADIS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  86
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  4950     MOVE "más de 66 años"  TO   SLD-DETALLE
  4951     MOVE W-EDAD-66         TO   SLD-ESTADIS-VALOR-1
  4952     WRITE  REG-ESTADIS
  4953     INITIALIZE  REG-ESTADIS
  4954     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  4955     WRITE  REG-ESTADIS
  4956     WRITE  REG-ESTADIS
  4957*------------------------------------------------------------*
  4958*    ESTADISTICO ESTADO ACTUAL
  4959*------------------------------------------------------------*
  4960     INITIALIZE  REG-ESTADIS
  4961     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  4962     INITIALIZE  REG-ESTADIS
  4963     MOVE "Al día        "  TO   SLD-DETALLE
  4964     MOVE W-TOT-ALDIA       TO   SLD-ESTADIS-VALOR-1
  4965     WRITE  REG-ESTADIS
  4966     INITIALIZE  REG-ESTADIS
  4967     MOVE "Mora 30       "    TO  SLD-DETALLE
  4968     MOVE W-TOT-MORAS-30-ACT  TO  SLD-ESTADIS-VALOR-1
  4969     WRITE  REG-ESTADIS
  4970     INITIALIZE  REG-ESTADIS
  4971     MOVE "Mora 60       "    TO  SLD-DETALLE
  4972     MOVE W-TOT-MORAS-60-ACT  TO  SLD-ESTADIS-VALOR-1
  4973     WRITE  REG-ESTADIS
  4974     INITIALIZE  REG-ESTADIS
  4975     MOVE "Mora 90       "    TO  SLD-DETALLE
  4976     MOVE W-TOT-MORAS-90-ACT  TO  SLD-ESTADIS-VALOR-1
  4977     WRITE  REG-ESTADIS
  4978     INITIALIZE  REG-ESTADIS
  4979     MOVE "Mora 120      "    TO  SLD-DETALLE
  4980     MOVE W-TOT-MORAS-120-ACT TO  SLD-ESTADIS-VALOR-1
  4981     WRITE  REG-ESTADIS
  4982     INITIALIZE  REG-ESTADIS
  4983     MOVE "Cartera castigada" TO  SLD-DETALLE
  4984     MOVE W-TOT-CAR-CASTIGA   TO  SLD-ESTADIS-VALOR-1
  4985     WRITE  REG-ESTADIS
  4986     INITIALIZE  REG-ESTADIS
  4987     MOVE "Dudoso recaudo   " TO  SLD-DETALLE
  4988     MOVE W-TOT-DUD-RECAUDO   TO  SLD-ESTADIS-VALOR-1
  4989     WRITE  REG-ESTADIS
  4990     INITIALIZE  REG-ESTADIS
  4991     MOVE "Endeudamiento    " TO  SLD-DETALLE
  4992     MOVE W-TOT-W-ENDEUDA     TO  SLD-ESTADIS-VALOR-1
  4993     WRITE  REG-ESTADIS
  4994     INITIALIZE  REG-ESTADIS
  4995     MOVE "Cuenta corriente Embargada" TO  SLD-DETALLE
  4996     MOVE W-TOT-CTES-EMBARGADAS TO SLD-ESTADIS-VALOR-1
  4997     WRITE  REG-ESTADIS
  4998     INITIALIZE  REG-ESTADIS
  4999     MOVE "Sin cuentas activas" TO  SLD-DETALLE
  5000     MOVE W-TOT-SIN-CTAS        TO  SLD-ESTADIS-VALOR-1
  5001     WRITE  REG-ESTADIS
  5002     INITIALIZE  REG-ESTADIS
  5003     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  5004     WRITE  REG-ESTADIS
  5005     WRITE  REG-ESTADIS
  5006*------------------------------------------------------------*
  5007*    ESTADISTICO ESTADO ACTUAL POR SECTOR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  87
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5008*------------------------------------------------------------*
  5009     INITIALIZE  REG-ESTADIS
  5010     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  5011     INITIALIZE  REG-ESTADIS
  5012     MOVE "Al día        "  TO  SLD-DETALLE
  5013     MOVE W-TOT-ALDIA-FINA  TO  SLD-ESTADIS-VALOR-1
  5014     MOVE W-TOT-ALDIA-REAL  TO  SLD-ESTADIS-VALOR-2
  5015     MOVE W-TOT-ALDIA-COOP  TO  SLD-ESTADIS-VALOR-3
  5016     MOVE W-TOT-ALDIA-TELE  TO  SLD-ESTADIS-VALOR-4
  5017     WRITE  REG-ESTADIS
  5018     INITIALIZE  REG-ESTADIS
  5019     MOVE "Mora 30 - 120 "  TO  SLD-DETALLE
  5020     MOVE W-TOT-MORAS-FINA  TO  SLD-ESTADIS-VALOR-1
  5021     MOVE W-TOT-MORAS-REAL  TO  SLD-ESTADIS-VALOR-2
  5022     MOVE W-TOT-MORAS-COOP  TO  SLD-ESTADIS-VALOR-3
  5023     MOVE W-TOT-MORAS-TELE  TO  SLD-ESTADIS-VALOR-4
  5024     WRITE  REG-ESTADIS
  5025     INITIALIZE  REG-ESTADIS
  5026     MOVE "Cart.Castig -  Dud.Recaud"  TO  SLD-DETALLE
  5027     MOVE W-TOT-CC-DR-FINA  TO  SLD-ESTADIS-VALOR-1
  5028     MOVE W-TOT-CC-DR-REAL  TO  SLD-ESTADIS-VALOR-2
  5029     MOVE W-TOT-CC-DR-COOP  TO  SLD-ESTADIS-VALOR-3
  5030     MOVE W-TOT-CC-DR-TELE  TO  SLD-ESTADIS-VALOR-4
  5031     WRITE  REG-ESTADIS
  5032     INITIALIZE  REG-ESTADIS
  5033     INSPECT REG-ESTADIS REPLACING  ALL ";" BY " "
  5034     WRITE  REG-ESTADIS
  5035     WRITE  REG-ESTADIS
  5036*------------------------------------------------------------*
  5037*    ESTADISTICO VALORES POR SECTOR
  5038*------------------------------------------------------------*
  5039     INITIALIZE  REG-ESTADIS
  5040     INSPECT REG-ESTADIS REPLACING  ALL " " BY ";"
  5041     INITIALIZE  REG-ESTADIS
  5042     MOVE "Sector Financiero  " TO  SLD-DETALLE
  5043     MOVE W-SALDOS-SEC-FINA     TO  SLD-ESTADIS-VALOR-1
  5044     MOVE W-CUOTAS-SEC-FINA     TO  SLD-ESTADIS-VALOR-2
  5045     MOVE W-MORAS-SEC-FINA      TO  SLD-ESTADIS-VALOR-3
  5046     WRITE  REG-ESTADIS
  5047     INITIALIZE  REG-ESTADIS
  5048     MOVE "Sector Real        " TO  SLD-DETALLE
  5049     MOVE W-SALDOS-SEC-REAL     TO  SLD-ESTADIS-VALOR-1
  5050     MOVE W-CUOTAS-SEC-REAL     TO  SLD-ESTADIS-VALOR-2
  5051     MOVE W-MORAS-SEC-REAL      TO  SLD-ESTADIS-VALOR-3
  5052     WRITE  REG-ESTADIS
  5053     INITIALIZE  REG-ESTADIS
  5054     MOVE "Sector Cooperativo " TO  SLD-DETALLE
  5055     MOVE W-SALDOS-SEC-COOP     TO  SLD-ESTADIS-VALOR-1
  5056     MOVE W-CUOTAS-SEC-COOP     TO  SLD-ESTADIS-VALOR-2
  5057     MOVE W-MORAS-SEC-COOP      TO  SLD-ESTADIS-VALOR-3
  5058     WRITE  REG-ESTADIS.
  5059
  5060
  5061*------------------------------*
  5062 9900-RESUMEN-PROCESO.
  5063*------------------------------*
  5064     DISPLAY "       "
  5065     DISPLAY "REG. LEIDOS   => " LEIDOS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  88
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5066     DISPLAY "REG. GRABADOS => " GRABADOS
  5067     DISPLAY "       "
  5068     DISPLAY "                "
  5069     MOVE   W-CON-INFORMACION   TO  W-EDITOR-CON
  5070     MOVE   W-SIN-INFORMACION   TO  W-EDITOR-SIN
  5071     MOVE   W-INCONSISTENCIAS   TO  W-EDITOR-INC
  5072     MOVE   LEIDOS              TO  W-EDITOR-TOT
  5073     DISPLAY "+------------------------------------------"
  5074             "---------+"
  5075     DISPLAY "|      *** RESULTADOS DEL INFORME       ***"
  5076             "         |"
  5077     DISPLAY "+----------------------------------+-------"
  5078             "---------+"
  5079     DISPLAY "|     DETALLE CALIFICACION         | CALF |"
  5080             "  # REG. |"
  5081     DISPLAY "+----------------------------------+------+"
  5082             "---------+"
  5083     DISPLAY "| - Registros con informacion      | O.K  |"
  5084                                            W-EDITOR-CON
  5085     DISPLAY "| - Registros sin informacion      | SIN  |"
  5086                                            W-EDITOR-SIN
  5087     DISPLAY "| - Registros inconsistencias      | INC  |"
  5088                                            W-EDITOR-INC
  5089     DISPLAY "+----------------------------------+------+"
  5090             "---------+"
  5091     DISPLAY "| - Total Registro procesados             |"
  5092                                            W-EDITOR-TOT
  5093     DISPLAY "+----------------------------------+------+"
  5094             "---------+"
  5095     CLOSE ENTRADA
  5096     CLOSE MAESTRO-CHECK
  5097     CLOSE  MAESTRO-DIRECC                                        GDT0001
  5098     CLOSE  NOAMNISTIA21                                          GDT0001
  5099*                                                                 GDT0001
  5100     CLOSE MAESTRO-CREDIT
  5101     CLOSE SUSCRIPTOR
  5102     CLOSE BDIEMSUP
  5103     CLOSE BDIEENTI
  5104     CLOSE INDEXADO
  5105     CLOSE SALIDA.
  5106
  5107
  5108******************************************************************
  5109*  INTERCAMBIA EL VECTOR DEL ESTADO-MES Y COMPLETA EL VECTOR SI  *
  5110*  LA FECHA DE ACTUALIZACION ES MAYOR QUE LA FECHA DE LA ULTIMA  *
  5111*  NOVEDAD DE LA CUENTA                                          *
  5112******************************************************************
  5113 7500-ANALIZA-VECTOR-HISTORICO.
  5114     MOVE ZEROS            TO WS-ESTADO-MES.
  5115     MOVE ESTADO-MES-ABD07 TO WS-ESTADO-MES.
  5116     MOVE ZEROS            TO ESTADO-MES-IMP.
  5117     PERFORM 7600-MESES VARYING I FROM 1 BY 1 UNTIL I = 13.
  5118     MOVE ESTADO-MES-IMP   TO WS-ESTADO-MES-1.
  5119     MOVE ZEROS            TO WS-ESTADO-MES.
  5120     MOVE VECTOR-2-ABD07   TO WS-ESTADO-MES.
  5121     MOVE ZEROS  TO ESTADO-MES-IMP.
  5122     PERFORM 7600-MESES VARYING I FROM 1 BY 1 UNTIL I = 13.
  5123     MOVE ESTADO-MES-IMP   TO WS-ESTADO-MES-2.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  89
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5124     MOVE COD-SUS-ABD07    TO COD-SUSCRIP-AUX.
  5125     PERFORM 7700-BUS-SUSCR.
  5126     MOVE WS-ESTADO-MES-1 TO ESTADO-MES-IMP.
  5127     MOVE ESTADO-MES-IMP  TO VECTOR-S
  5128     INSPECT ESTADO-MES-IMP REPLACING ALL "0" BY SPACES.
  5129     INSPECT ESTADO-MES-IMP REPLACING ALL "5" BY "N".
  5130     INSPECT ESTADO-MES-IMP REPLACING ALL "9" BY "-".
  5131     IF NUEVO = 1
  5132        INSPECT ESTADO-MES-IMP REPLACING ALL "6" BY "-"
  5133        INSPECT ESTADO-MES-IMP REPLACING ALL "7" BY "-"
  5134        INSPECT ESTADO-MES-IMP REPLACING ALL "8" BY "n"
  5135     ELSE
  5136        INSPECT ESTADO-MES-IMP REPLACING ALL "6" BY "-"
  5137        INSPECT ESTADO-MES-IMP REPLACING ALL "7" BY "-"
  5138        INSPECT ESTADO-MES-IMP REPLACING ALL "8" BY "n"
  5139     END-IF.
  5140     MOVE ESTADO-MES-IMP  TO VECTOR-S-12
  5141     MOVE WS-ESTADO-MES-2 TO ESTADO-MES-IMP.
  5142     MOVE ESTADO-MES-IMP  TO S48-VEC
  5143     INSPECT ESTADO-MES-IMP REPLACING ALL "0" BY SPACES.
  5144     INSPECT ESTADO-MES-IMP REPLACING ALL "5" BY "N".
  5145     INSPECT ESTADO-MES-IMP REPLACING ALL "9" BY "-".
  5146     INSPECT ESTADO-MES-IMP REPLACING ALL "6" BY "-".
  5147     INSPECT ESTADO-MES-IMP REPLACING ALL "7" BY "-".
  5148     INSPECT ESTADO-MES-IMP REPLACING ALL "8" BY "n".
  5149     MOVE ESTADO-MES-IMP  TO S48-VEC-12
  5150     MOVE VECTOR-S        TO W-MORAS-HISTORICAS-V.
  5151
  5152 7600-MESES.
  5153******************************************************************
  5154*7600-MESES.
  5155* SE RECORRE EL VECTOR DE COMPORTAMIENTO MOVIENDO LOS CAMPOS DE  *
  5156* ACUERDO AL REPORTE DERECHA A IZQUIERDA.                        *
  5157******************************************************************
  5158     SUBTRACT I FROM 13 GIVING J.
  5159     MOVE WS-MES ( I ) TO E-MES-IMP ( J ).
  5160 7700-BUS-SUSCR.
  5161******************************************************************
  5162*7700-BUS-SUSCR.
  5163* SE BUSCA LA FECHA DE ULTIMA ACTUALIZACION DEL SUSCRIPTOR Y SE  *
  5164* PROCEDE A REALIZAR CORRIMIENTOS EN CASO DE ESTAR AL DIA        *
  5165******************************************************************
  5166     PERFORM 6600-LECT-SUSCR.
  5167     IF ENCONTRO = 0
  5168        MOVE 1 TO IND-BLOQUEO-ABD07
  5169     ELSE
  5170         PERFORM 7800-COMP-VEC.
  5171 7800-COMP-VEC.
  5172*****************************************************************
  5173*7800-COMP-VEC.
  5174*  SE COMPARAN LAS FECHAS DE ULTIMA NOVEDAD E INGRESO DEL SUSCR.*
  5175*  DANDO ASI EL NUMERO DE POSICIONES DEL VECTOR. EN CASO DE QUE *
  5176*  LA ULTIMA NOVEDAD SEA 01 O 13 O 14 O 15 O 16 SE LE AUMENTAN
  5177*  LAS POSICIONES DE NORMALIDAD QUE FALTAN HASTA LA FECHA DE LA *
  5178*  ULTIMA ACTUALIZACION DEL SUSCRIPTOR.                         *
  5179*****************************************************************
  5180     MOVE 1 TO FIN-CHECK
  5181     IF F-UACT-2 = 0
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  90
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5182        MOVE F-ING-2 TO F-UACT-2.
  5183     IF FIN-CHECK = 1
  5184        MOVE FECHA-APERT-ABD07 TO F-APE-07
  5185     ELSE
  5186        MOVE FECHA-APERT-ABD06 TO F-APE-07.
  5187     IF FIN-CHECK = 1
  5188        MOVE FEC-NOVEDAD-ABD07 TO F-NOV-07
  5189     ELSE
  5190        MOVE FEC-NOVEDAD-ABD06 TO F-NOV-07.
  5191     MOVE A-APE-07             TO ANO-2000                        ANO2000
  5192     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5193     MOVE ANO-2000             TO A-APE-07                        ANO2000
  5194     MOVE A-NOV-07             TO ANO-2000                        ANO2000
  5195     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5196     MOVE ANO-2000             TO A-NOV-07                        ANO2000
  5197     MOVE A-ING-02             TO ANO-2000                        ANO2000
  5198     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5199     MOVE ANO-2000             TO A-ING-02                        ANO2000
  5200     MOVE A-UACT-02            TO ANO-2000                        ANO2000
  5201     PERFORM 7800-CONVERSION-INPUT-2000                           ANO2000
  5202     MOVE ANO-2000             TO A-UACT-02                       ANO2000
  5203     COMPUTE  F-APE-7 = A-APE-07 * 12 + M-APE-07.
  5204     COMPUTE  F-NOV-7 = A-NOV-07 * 12 + M-NOV-07.
  5205     COMPUTE  F-ING-2 = A-ING-02 * 12 + M-ING-02.
  5206     COMPUTE  F-UACT-2 = A-UACT-02 * 12 + M-UACT-02.
  5207     IF F-APE-7 < F-ING-2
  5208        MOVE  F-ING-2 TO F-VIEJ
  5209     ELSE
  5210        MOVE F-APE-7 TO F-VIEJ.
  5211     IF (F-NOV-7 > F-VIEJ)
  5212     OR (F-NOV-7 = F-VIEJ)
  5213        COMPUTE TIV = F-NOV-7 - F-VIEJ
  5214     ELSE
  5215        MOVE 0 TO TIV.
  5216* OJO LO SIGUIENTE ARREGLA CUANDO DA NEGATIVA LA RESTA !!!!!!
  5217* ES UNA INCONSISTENCIA EN LA BD POR FEC-NOVEDAD < FEC-INGRESO
  5218     ADD 1 to tiv giving n
  5219     perform varying i from n by 1 until i > 24
  5220       IF i < 13
  5221         MOVE "0" TO WS-ESTADO-MES-1(I:1)
  5222       ELSE
  5223         COMPUTE J = I - 12
  5224         MOVE "0" TO WS-ESTADO-MES-2(J:1)
  5225       END-IF
  5226     end-perform
  5227     IF (F-UACT-2 > F-VIEJ)
  5228     OR (F-UACT-2 = F-VIEJ)
  5229        COMPUTE TFV = F-UACT-2 - F-VIEJ + 1
  5230     ELSE
  5231        MOVE 0 TO TFV.
  5232     IF TFV > TIV
  5233        COMPUTE N = TFV - TIV - 1
  5234     ELSE
  5235        MOVE 0 TO N.
  5236     MOVE A-APE-07             TO ANO-2000                        ANO2000
  5237     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5238     MOVE ANO-2000             TO A-APE-07                        ANO2000
  5239     MOVE A-NOV-07             TO ANO-2000                        ANO2000
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  91
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5240     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5241     MOVE ANO-2000             TO A-NOV-07                        ANO2000
  5242     MOVE A-ING-02             TO ANO-2000                        ANO2000
  5243     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5244     MOVE ANO-2000             TO A-ING-02                        ANO2000
  5245     MOVE A-UACT-02            TO ANO-2000                        ANO2000
  5246     PERFORM 7900-CONVERSION-OUTPUT-2000                          ANO2000
  5247     MOVE ANO-2000             TO A-UACT-02                       ANO2000
  5248     IF (NOV-REPORT-ABD07 = 01 OR 13 OR 14 OR 16 OR 15) AND
  5249        (ARRASTRE = 1)
  5250        MOVE CINCO TO RELLENO
  5251        MOVE F-UACT-02 TO F-AUX
  5252        MOVE F-AUX TO FEC-NOV-S
  5253        IF N > 24
  5254           MOVE 25 TO N
  5255        END-IF
  5256        PERFORM  7900-ADICION N TIMES
  5257     END-IF.
  5258*
  5259 7900-ADICION.
  5260*****************************************************************
  5261*7900-ADICION.
  5262*  SE ADICIONA UNA N (NORMAL) AL VECTOR POR CADA VEZ QUE SE     *
  5263*  LLAMA ESTA RUTINA.                                           *
  5264*                                                               *
  5265*****************************************************************
  5266     MOVE ZEROS           TO WS-EST-MES.
  5267     MOVE WS-ESTADO-MES-1 TO WS-MESES-VIEJ.
  5268     MOVE RELLENO         TO WS-MES-NUEV.
  5269     MOVE WS-MESES-NUEV   TO WS-ESTADO-MES-1.
  5270     MOVE WS-MES-VIEJ     TO WS-MES-NUEV.
  5271     MOVE WS-ESTADO-MES-2 TO WS-MESES-VIEJ.
  5272     MOVE WS-MESES-NUEV   TO WS-ESTADO-MES-2.
  5273 6600-LECT-SUSCR.
  5274*****************************************************************
  5275*6600-LECT-SUSCR.
  5276*  SE LEE LA TABLA DE SUSCRIPTORES Y SE ASIGNAN LAS FECHAS DE   *
  5277*  INGRESO Y ULTIMA ACTUALIZACION DEL SUSCRIPTOR.               *
  5278*                                                               *
  5279*****************************************************************
  5280     MOVE COD-SUSCRIP-AUX TO COD-SUSCRIP-ABD02.
  5281     MOVE 1 TO ENCONTRO.
  5282     READ SUSCRIPTOR IGNORE LOCK INVALID KEY
  5283          MOVE 0 TO ENCONTRO
  5284          MOVE 0 TO IND-COR-ABD02.
  5285     IF ENCONTRO NOT = 0
  5286        IF IND-COR-ABD02 = 1 OR 2
  5287           MOVE NOM-COR1-ABD02 TO NOM-COR-AUX
  5288           MOVE NOM-COR2-ABD02 TO NOM-COR-AUX2
  5289        ELSE
  5290           MOVE SPACES TO NOM-COR-AUX
  5291           MOVE COD-SUSCRIP-ABD02 TO NOM-COR-AUXN
  5292        END-IF
  5293        MOVE FECHA-ING-ABD02 TO F-ING-02
  5294        MOVE F-ULT-ACT-ABD02 TO F-UACT-02.
  5295
  5296 7900-CONVERSION-OUTPUT-2000.                                     ANO2000
  5297******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  92
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/PE-V
  5298*7900-CONVERSION-OUTPUT-2000.                                     ANO2000
  5299* RUTINA ESTANDAR PARA Y2K, METODO WINDOW ANO 61. CONVERSION DESPUES
  5300* DE LA OPERACION ENTRE FECHAS.                                  *
  5301******************************************************************
  5302     IF ANO-2000                  <  39                           ANO2000
  5303        ADD 61                    TO   ANO-2000                   ANO2000
  5304     ELSE
  5305        SUBTRACT 39               FROM ANO-2000.                  ANO2000
  5306
  5307 7800-CONVERSION-INPUT-2000.                                      ANO2000
  5308******************************************************************
  5309*7800-CONVERSION-INPUT-2000.                                      ANO2000
  5310* RUTINA ESTANDAR PARA Y2K, METODO WINDOW ANO 61. CONVERSION ANTES
  5311* DE LA OPERACION ENTRE FECHAS.                                  *
  5312******************************************************************
  5313     IF ANO-2000                  >  61                           ANO2000
  5314        SUBTRACT 61               FROM ANO-2000                   ANO2000
  5315     ELSE                                                         ANO2000
  5316        ADD 39                    TO   ANO-2000.                  ANO2000
  5317
* 5318  COPY  LEEMAESTROS.PROC.                                         GDT0001
  5319* LEEMAESTROS.PROC.v.0004
  5320* ESTE COPY CONTIENE CADA UNA DE LAS RUTINAS PROPIAS DEL MANEJO DE
  5321* DE LECTURA DE ICMCRE E ICMCHK PARA EL MANEJO DE REGIS Y DE LA
  5322* AMNISTIA DE ACUERDO A LA LEY DE HABEAS DATA.
  5323******************************************************************
  5324* GJC0002   * LEY002 SE INCLUYE APLICACION DE ARTICULO 13, PERDON*
  5325* G. JIMENEZ* AL DOBLE DEL TIEMPO DE LA MORA, SE APLICA ANTES DE *
  5326* EN 29/2009* AMNISTIA, A LA CUAL YA PUEDE ENTRAR PERDONADO EL RE*
  5327*           * GISTRO                                             *
  5328*           * NOV048 SE RECALCULA LA NOVEDAD EN 24 SI ASI LO SOLI*
  5329*           *        CITA EL PROGRAMA, EL DEFAULT ES 48
  5330******************************************************************
  5331* GJC0003   * BBVA01 SE INCLUYE LOGICA QUE BLOQUEA LAS CUETAS DE *
  5332* G. JIMENEZ*        BBVA SI EL SW DE ELIMINAR ESTA EN 1. ESTO   *
  5333* AGOST/2009*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *
  5334*           *        CARTERA                                     *
  5335******************************************************************
  5336* GJC0004   * NEWBL1 PARA CUENTA SIN VALIDAR SE INCLUYE EL TIPO  *
  5337* G. JIMENEZ*        DE BLOQUEO 7 Y 8                            *
  5338* OCTUB/2011*        TANTO PARA CUENTAS CORRIENTES COMO PARA     *
  5339*           *        EL MAESTRO DE CARTERA                       *
  5340******************************************************************
  5341$SET CONSTANT HACERMATCH"NO"
  5342$SET CONSTANT AMNISTIA21"NO"
  5343
  5344$IF HACERMATCH = "SI"
  5345$DISPLAY "........COMPILANDO LEEMAESTROS CON MATCH **********
  5346$ELSE
  5347$DISPLAY "........COMPILANDO LEEMAESTROS SIN MATCH **********
  5348$END
  5349
  5350$IF AMNISTIA21 = "SI"
  5351$DISPLAY "........COMPILANDO LEEMAESTROS CON AMNISTIA *******
  5352$ELSE
  5353$DISPLAY "...... .COMPILANDO LEEMAESTROS SIN AMNISTIA *******
  5354$END
  5355
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  93
* S.PROC)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
* 5356 COPY BDAMATCH.PROC.
  5358* BDAMATCH.PROC.v.0005
  5359******************************************************************
  5360* ESTE COPY CONTIENE CADA UNA DE LAS RUTINA QUE ACCEDER AL MATCH
  5361* DE NOMBRES USANDO LAS ESTRUCTURAS ESTANDARES DE DATACREDITO
  5362* COPY QUE CONTIENE LA VARIABLES NECESARIAS PARA ELECCION DE MEJOR
  5363* PORTAFOLIO Y MATCH DE NOMBRES A PARTIR DE LA INFORMACION DE LAS
  5364* ESTRUCTURAS ESTANDAR DE DATACREDITO BDACSV, ICBDIR ICMCRE E ICMCHK.
  5365********************************************************************
  5366* CAV0002     * CARTOT - CONTROLAR QUE EL INDICE QUE MANEJA      *
  5367* C. VELASCO. * 2008-02  LA TABLA V-CARTOT-BDAMATCH NO EXCEDA LAS*
  5368* R.MARTINEZ  *          10 POSICIONES DE LAS MISMA.             *
  5369******************************************************************
  5370* RMB0003     *VIGE01: SE CONTARAN LAS CUENTAS CON ADJETIVOS DE
  5371* R.MARTINEZ  *        MUERTOS Y EL NUMERO TOTAL DE CUENTAS DEL
  5372*             *        MEJOR PORTAFOLIO
  5373* 25-MARZ-2010*        SALIDAS:  NUM-MUERTOS-OUTPUT-BDAMATCH
  5374*             *                  NUM-CTAS-OUTPUT-BDAMATCH
  5375*             *SINBLQ: TRABAJAR SOLO CON LOS REGISTROS DE CSV SIN
  5376*             *        BLOQUEO (9 CONSECUTIVO 5) O CON BLOQUE
  5377*             *        DE FRENADAS
  5378*****************************************************************
  5379* RMB0004     * PESO01 - OPTIMIZAR MANEJO DEL CALCULO DEL PESO  *
  5380* R-MARTINEZ. *          DEL PORTAFOLIO .                       *
  5381* 5-SEP-2001  * MEJO01 - DESEMPATAR PORTAFOLIOS EN CASO DE IGUL *
  5382*             * BLOQ01 - MANEJAR BLOQUEO EN REGISTROS CSV       *
  5383*             * FUEN01 - NCLUIR  FUENTES EXTERNAS               *
  5384*             * APEL01 - INCLUIR PRIMER APELLIDO EN MATCH       *
  5385*             * LIMT01 - MANEJAR LIMITES > 500 COMO TIPO 7      *
  5386*             * NOMB01 - MAQUILLAR EL NOMBRE                    *
  5387*             * VLNIT1 - SE ENVIA A LA RUTINA VALNOM LA VALIDA- *
  5388*             *         CION DE LOS NITS CON 1 PARTICULA Y TIPO2*
  5389*****************************************************************
  5390* RMB0005     * AJUS01 - SE AJUSTA EL SOFTWARE PARA UE NO TOME  *
  5391* R-MARTINEZ. *          EL TIPO DE CUENTA DE LAS 2 PRIMERAS PO-*
  5392* 14-DIC 2011 *          SICIONES DEL SUSCRIPTOR SINO DEL TIPO  *
  5393*             *          DECUENTA DE LA MISMA CUENTA            *
  5394*****************************************************************
  5395
  5396 1000-U-RECORRER-CSV-BDAMATCH.
  5397******************************************************************
  5398*1000-U-RECORRER-CSV-BDAMATCH.
  5399* SE RECORRE TODA LA ESTRUCTURA BDACSV PARA LA IDENTIFICACION
  5400* BUSCADA. EN CASO DE HALLAR REGISTROS SE PROCEDE A REALIZAR EL
  5401* MATCH
  5402******************************************************************
  5403     MOVE 0 TO IDE-TIPO-BDAMATCH
  5404     MOVE 0 TO  NUM-MUERTOS-OUTPUT-BDAMATCH .                     RMB0003
  5405     MOVE 0 TO  NUM-CTAS-OUTPUT-BDAMATCH.                         RMB0003
  5406     MOVE 0 TO MAX-CUENTAS-BDAMATCH.
  5407     IF ABIERTO-BDAMATCH  = 0
  5408        OPEN INPUT  BDACSV
  5409        MOVE 1 TO ABIERTO-BDAMATCH
  5410     END-IF.
  5411     INITIALIZE LLAVE-BDACSV.
  5412     MOVE TIP-IDE-INPUT-BDAMATCH  TO TIPO-ID-BDACSV .
  5413     MOVE NUM-IDE-INPUT-BDAMATCH  TO NUM-ID-BDACSV .
  5414     MOVE 0 TO FIN-BDAMATCH .
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  94
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5415     MOVE 0 TO PROCESAR-BDAMATCH .
  5416     START BDACSV  KEY > LLAVE-BDACSV
  5417           INVALID KEY
  5418              MOVE 1 TO FIN-BDAMATCH
  5419           NOT INVALID KEY
  5420              READ BDACSV IGNORE LOCK NEXT RECORD
  5421                 AT END
  5422                    MOVE 1 TO FIN-BDAMATCH
  5423              END-READ
  5424     END-START.
  5425     PERFORM UNTIL FIN-BDAMATCH  = 1 OR NUM-ID-BDACSV  NOT =
  5426                                      NUM-IDE-INPUT-BDAMATCH  OR
  5427                                      TIPO-ID-BDACSV  NOT =
  5428                                      TIP-IDE-INPUT-BDAMATCH
  5429        MOVE COD-SUS-BDACSV TO COD-SUSCRIP-ABD02
  5430        READ SUSCRIPTOR IGNORE LOCK
  5431           INVALID KEY
  5432              MOVE 0 TO PROCESAR-BDAMATCH
  5433           NOT INVALID KEY
  5434              MOVE 1 TO PROCESAR-BDAMATCH                         RMB0004
  5435        END-READ
  5436        IF PROCESAR-BDAMATCH = 1                                  RMB0004
  5437           IF ESTADO-ABD02 = 1                                    RMB0004
  5438              IF IND-BLOQUEO-BDACSV <> "B"                        RMB0004
  5439                 MOVE 1 TO PROCESAR-BDAMATCH                      RMB0004
  5440                 IF FUENTE-REG-BDACSV <= 01                       RMB0004
  5441                    PERFORM 1100-UBICAR-CHKCRE-CSV-BDAMATCH       RMB0004
  5442                 ELSE                                             RMB0004
  5443                    PERFORM 1100-LLENAR-AUX-BDAMATCH              RMB0004
  5444                 END-IF                                           RMB0004
  5445              ELSE                                                RMB0004
  5446                 MOVE 0 TO PROCESAR-BDAMATCH                      RMB0004
  5447              END-IF                                              RMB0004
  5448           ELSE                                                   RMB0004
  5449              MOVE 0 TO PROCESAR-BDAMATCH                         RMB0004
  5450           END-IF                                                 RMB0004
  5451        END-IF                                                    RMB0004
  5452        IF PROCESAR-BDAMATCH = 1
  5453           PERFORM 1200-PROC-REG-CSV-BDAMATCH
  5454        END-IF
  5455        READ BDACSV IGNORE LOCK   NEXT RECORD
  5456        AT END
  5457           MOVE 1 TO FIN-BDAMATCH
  5458        END-READ
  5459        IF MAX-CUENTAS-BDAMATCH >= LIM-BDAMATCH *> TABLA LLENA    RMB0004
  5460           MOVE 1 TO FIN-BDAMATCH               *> SE ABLIGA A TIPRMB0004
  5461           MOVE 0 TO MAX-CUENTAS-BDAMATCH       *> EFICIENCIA Y   RMB0004
  5462           MOVE SPACES TO NOM-OUTPUT-BDAMATCH   *> CONSISTENCIA   RMB0004
  5463        END-IF                                                    RMB0004
  5464     END-PERFORM.
  5465     IF MAX-CUENTAS-BDAMATCH > 0
  5466        IF APELLIDO-INPUT-BDAMATCH <> SPACES AND                  RMB0004
  5467           MAX-CUENTAS-BDAMATCH > 1                               RMB0004
  5468           PERFORM 1100-LLENAR-CSV-APE-BDAMATCH                   RMB0004
  5469           PERFORM 1100-LLENAR-AUX-BDAMATCH                       RMB0004
  5470           PERFORM 1200-PROC-REG-CSV-BDAMATCH                     RMB0004
  5471        END-IF                                                    RMB0004
  5472        PERFORM 9000-U-REALIZAR-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  95
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5473        IF NOM-OUTPUT-BDAMATCH <> SPACES AND                      RMB0004
  5474           (TIP-IDE-INPUT-BDAMATCH = 1 OR 4)                      RMB0004
  5475           MOVE NOM-OUTPUT-BDAMATCH TO NOMBRE-INPMAQ              RMB0004
  5476           PERFORM 1100-MAQUILLAR-NOMBRE-MAQ                      RMB0004
  5477           MOVE NOMBRE-OUTMAQ-OK TO NOM-OUTPUT-BDAMATCH           RMB0004
  5478        END-IF                                                    RMB0004
  5479        IF NOM-OUTPUT-BDAMATCH <> SPACES
  5480           MOVE 1 TO IDE-TIPO-BDAMATCH
  5481        END-IF
  5482     END-IF.
  5483 1100-MAQUILLAR-NOMBRE-MAQ.                                       RMB0004
  5484     MOVE FUNCTION UPPER-CASE(NOMBRE-INPMAQ) TO NOMBRE-INPMAQ     RMB0004
  5485     MOVE 0 TO I-MAQ                                              RMB0004
  5486     INSPECT NOMBRE-INPMAQ TALLYING I-MAQ FOR CHARACTERS BEFORE   RMB0004
  5487             INITIAL "Y/O"                                        RMB0004
  5488             OR      "Y\O"                                        RMB0004
  5489             OR      " Y/OTRO "                                   RMB0004
  5490             OR      " Y/OTRA "                                   RMB0004
  5491             OR      " Y\OTRO "                                   RMB0004
  5492             OR      " Y\OTRA "                                   RMB0004
  5493             OR      " Y OTRO "                                   RMB0004
  5494             OR      " Y OTRA "                                   RMB0004
  5495     IF I-MAQ < 45 AND I-MAQ > 2                                  RMB0004
  5496        ADD 1 TO I-MAQ                                            RMB0004
  5497        MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:)                      RMB0004
  5498     ELSE                                                         RMB0004
  5499        IF I-MAQ < 45                                             RMB0004
  5500           ADD 1 TO I-MAQ                                         RMB0004
  5501           MOVE SPACES TO NOMBRE-INPMAQ(I-MAQ:3)                  RMB0004
  5502        END-IF                                                    RMB0004
  5503     END-IF                                                       RMB0004
  5504     MOVE 0 TO SW-BORRAR-MAQ                                      RMB0004
  5505     MOVE 1 TO I-MAQ.                                             RMB0004
  5506     PERFORM UNTIL I-MAQ > 45                                     RMB0004
  5507       MOVE NOMBRE-INPMAQ(I-MAQ:1) TO ACTUAL-MAQ                  RMB0004
  5508       IF TILDE-MAQ                                               RMB0004
  5509          PERFORM 1000-CAMBIAR-TILDE-MAQ                          RMB0004
  5510          MOVE ACTUAL-MAQ TO NOMBRE-INPMAQ(I-MAQ:1)               RMB0004
  5511       END-IF                                                     RMB0004
  5512       IF FUNCTION ORD(ACTUAL-MAQ) < 31                           RMB0004
  5513          MOVE "." TO ACTUAL-MAQ                                  RMB0004
  5514       END-IF                                                     RMB0004
  5515       MOVE " " TO ANT-MAQ                                        RMB0004
  5516       IF I-MAQ > 1                                               RMB0004
  5517          COMPUTE J-MAQ = I-MAQ - 1                               RMB0004
  5518          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO ANT-MAQ                  RMB0004
  5519       END-IF                                                     RMB0004
  5520       MOVE " " TO SIG-MAQ                                        RMB0004
  5521       IF I-MAQ < 45                                              RMB0004
  5522          COMPUTE J-MAQ = I-MAQ + 1                               RMB0004
  5523          MOVE NOMBRE-INPMAQ(J-MAQ:1) TO SIG-MAQ                  RMB0004
  5524       END-IF                                                     RMB0004
  5525       IF ACTUAL-MAQ = ")"                                        RMB0004
  5526          MOVE 0 TO SW-BORRAR-MAQ                                 RMB0004
  5527       END-IF                                                     RMB0004
  5528       IF SW-BORRAR-MAQ = 0                                       RMB0004
  5529          IF ELIMINAR-MAQ                                         RMB0004
  5530             MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                  RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  96
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5531             IF I-MAQ > 1                                         RMB0004
  5532                MOVE 1 TO SW-BORRAR-MAQ                           RMB0004
  5533             END-IF                                               RMB0004
  5534          ELSE                                                    RMB0004
  5535             IF BORRAR-MAQ                                        RMB0004
  5536                MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)               RMB0004
  5537             ELSE                                                 RMB0004
  5538                IF QUITAR-MAQ                                     RMB0004
  5539                   COMPUTE J-MAQ = I-MAQ + 1                      RMB0004
  5540                   MOVE NOMBRE-INPMAQ(J-MAQ:) TO                  RMB0004
  5541                        NOMBRE-INPMAQ(I-MAQ:)                     RMB0004
  5542                   COMPUTE I-MAQ = I-MAQ - 1                      RMB0004
  5543                ELSE                                              RMB0004
  5544                   IF VALIDO-MAQ                                  RMB0004
  5545                      CONTINUE                                    RMB0004
  5546                   ELSE                                           RMB0004
  5547                      IF ANT-MAQ = "N" AND SIG-VOCAL-MAQ          RMB0004
  5548                         COMPUTE J-MAQ = I-MAQ + 1                RMB0004
  5549                         MOVE NOMBRE-INPMAQ(J-MAQ:) TO            RMB0004
  5550                              NOMBRE-INPMAQ(I-MAQ:)               RMB0004
  5551                         COMPUTE I-MAQ = I-MAQ - 1                RMB0004
  5552                      ELSE                                        RMB0004
  5553                         IF (ANT-VOCAL-MAQ AND SIG-VOCAL-MAQ) OR  RMB0004
  5554                            (ANT-VOCAL-MAQ AND SIG-MAQ = "N")     RMB0004
  5555                            IF (ANT-VOCAL-MAQ AND SIG-MAQ = "N")  RMB0004
  5556                               COMPUTE J-MAQ = I-MAQ + 1          RMB0004
  5557                               MOVE NOMBRE-INPMAQ(J-MAQ:) TO      RMB0004
  5558                                    NOMBRE-INPMAQ(I-MAQ:)         RMB0004
  5559                            ELSE                                  RMB0004
  5560                               MOVE "N" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5561                            END-IF                                RMB0004
  5562                         ELSE                                     RMB0004
  5563                            IF NOT ANT-VOCAL-MAQ AND              RMB0004
  5564                                   SIG-VOCAL-MAQ                  RMB0004
  5565                               MOVE "I" TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5566                            ELSE                                  RMB0004
  5567                               MOVE " " TO NOMBRE-INPMAQ(I-MAQ:1) RMB0004
  5568                            END-IF                                RMB0004
  5569                         END-IF                                   RMB0004
  5570                      END-IF                                      RMB0004
  5571                   END-IF                                         RMB0004
  5572                END-IF                                            RMB0004
  5573             END-IF                                               RMB0004
  5574          END-IF                                                  RMB0004
  5575       ELSE                                                       RMB0004
  5576          MOVE " " TO NOMBRE-INPMAQ (I-MAQ:1)                     RMB0004
  5577       END-IF                                                     RMB0004
  5578       ADD 1 TO I-MAQ                                             RMB0004
  5579     END-PERFORM.                                                 RMB0004
  5580     INITIALIZE PARTICULAS-INPMAQ                                 RMB0004
  5581     UNSTRING NOMBRE-INPMAQ-X DELIMITED BY ALL " "                RMB0004
  5582       INTO BASURA-INPMAQ P1-INPMAQ P2-INPMAQ P3-INPMAQ P4-INPMAQ RMB0004
  5583            P5-INPMAQ P6-INPMAQ P7-INPMAQ P8-INPMAQ P9-INPMAQ     RMB0004
  5584            P10-INPMAQ                                            RMB0004
  5585     MOVE SPACES TO NOMBRE-OUTMAQ-OK                              RMB0004
  5586     STRING P1-INPMAQ DELIMITED BY " "                            RMB0004
  5587            " " DELIMITED BY SIZE                                 RMB0004
  5588            P2-INPMAQ DELIMITED BY " "                            RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  97
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5589            " " DELIMITED BY SIZE                                 RMB0004
  5590            P3-INPMAQ DELIMITED BY " "                            RMB0004
  5591            " " DELIMITED BY SIZE                                 RMB0004
  5592            P4-INPMAQ DELIMITED BY " "                            RMB0004
  5593            " " DELIMITED BY SIZE                                 RMB0004
  5594            P5-INPMAQ DELIMITED BY " "                            RMB0004
  5595            " " DELIMITED BY SIZE                                 RMB0004
  5596            P6-INPMAQ DELIMITED BY " "                            RMB0004
  5597            " " DELIMITED BY SIZE                                 RMB0004
  5598            P7-INPMAQ DELIMITED BY " "                            RMB0004
  5599            " " DELIMITED BY SIZE                                 RMB0004
  5600            P8-INPMAQ DELIMITED BY " "                            RMB0004
  5601            " " DELIMITED BY SIZE                                 RMB0004
  5602            P9-INPMAQ DELIMITED BY " "                            RMB0004
  5603            " " DELIMITED BY SIZE                                 RMB0004
  5604            P10-INPMAQ DELIMITED BY " "                           RMB0004
  5605            " " DELIMITED BY SIZE                                 RMB0004
  5606       INTO NOMBRE-OUTMAQ-OK.                                     RMB0004
  5607       INSPECT NOMBRE-OUTMAQ-OK                                   RMB0004
  5608         REPLACING ALL  " PE A " BY " PENA ".                     RMB0004
  5609  1000-CAMBIAR-TILDE-MAQ.                                         RMB0004
  5610       EVALUATE ACTUAL-MAQ                                        RMB0004
  5611          WHEN "Á"                                                RMB0004
  5612            MOVE "A" TO ACTUAL-MAQ                                RMB0004
  5613          WHEN "É"                                                RMB0004
  5614            MOVE "E" TO ACTUAL-MAQ                                RMB0004
  5615          WHEN "Í"                                                RMB0004
  5616            MOVE "I" TO ACTUAL-MAQ                                RMB0004
  5617          WHEN "Ó"                                                RMB0004
  5618            MOVE "O" TO ACTUAL-MAQ                                RMB0004
  5619          WHEN "Ú"                                                RMB0004
  5620            MOVE "U" TO ACTUAL-MAQ                                RMB0004
  5621          WHEN "á"                                                RMB0004
  5622            MOVE "A" TO ACTUAL-MAQ                                RMB0004
  5623          WHEN "é"                                                RMB0004
  5624            MOVE "E" TO ACTUAL-MAQ                                RMB0004
  5625          WHEN "í"                                                RMB0004
  5626            MOVE "I" TO ACTUAL-MAQ                                RMB0004
  5627          WHEN "ó"                                                RMB0004
  5628            MOVE "O" TO ACTUAL-MAQ                                RMB0004
  5629          WHEN "Ú"                                                RMB0004
  5630            MOVE "U" TO ACTUAL-MAQ                                RMB0004
  5631        END-EVALUATE.                                             RMB0004
  5632 1100-LLENAR-CSV-APE-BDAMATCH.                                    RMB0004
  5633     INITIALIZE REG-BDACSV                                        RMB0004
  5634     MOVE TIP-IDE-INPUT-BDAMATCH TO  TIPO-ID-BDACSV               RMB0004
  5635     MOVE NUM-IDE-INPUT-BDAMATCH TO  NUM-ID-BDACSV                RMB0004
  5636     MOVE 980001         TO  COD-SUS-BDACSV COD-SUSCRIP-ABD02     RMB0004
  5637     MOVE 02             TO  COD-CTA-BDACSV                       RMB0004
  5638     MOVE "APELLID-01"   TO  NUM-CTA-BDACSV                       RMB0004
  5639     MOVE APELLIDO-INPUT-BDAMATCH TO  NOMBRE-BDACSV               RMB0004
  5640     MOVE ".-,"                   TO  NOMBRE-BDACSV(43:3)         RMB0004
  5641     MOVE 20110801       TO  FECHA-CREA-BDACSV                    RMB0004
  5642     MOVE 0              TO  NUM-PORTAF-BDACSV                    RMB0004
  5643     MOVE 0              TO  IND-NOMBRE-BDACSV                    RMB0004
  5644     MOVE 0              TO  MEJOR-PORTAF-BDACSV                  RMB0004
  5645     MOVE 0              TO  IND-ACTUALIZ-BDACSV                  RMB0004
  5646     MOVE 01             TO  FUENTE-REG-BDACSV.                   RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  98
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5647 1100-LLENAR-AUX-BDAMATCH.                                        RMB0004
  5648***********************************************************************
  5649*1100-LLENAR-AUX-BDAMATCH.
  5650* SE LLENAN LOS CAMPOS DEL CSV EN AREAS AUXILIARES DE CONVERSION DE
  5651* TAMAÑO
  5652***********************************************************************
  5653     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .          RMB0004
  5654     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .          RMB0004
  5655     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .          RMB0004
  5656     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .          RMB0004
  5657     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .          RMB0004
  5658     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .          RMB0004
  5659     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .          RMB0004
  5660     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .          RMB0004
  5661     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .          RMB0004
  5662     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .          RMB0004
  5663     MOVE 0 TO FALLECIDO-BDAMATCH.                                RMB0004
  5664 1100-UBICAR-CHKCRE-CSV-BDAMATCH.
  5665***********************************************************************
  5666*1100-UBICAR-CHKCRE-CSV-BDAMATCH.
  5667* DE ACUERDO AL TIPO DE CUENTA SE PROCEDE A VALIDAR QUE ESTAS EXISTAN
  5668* EN CUYO CASO SE INSERTA LA INFORMACION EN LAS ESTRUCTURAS DEL MATCH
  5669***********************************************************************
  5670     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX11-BDAMATCH  .
  5671     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX11-BDAMATCH   .
  5672     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX11-BDAMATCH  .
  5673     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX11-BDAMATCH  .
  5674     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX11-BDAMATCH  .
  5675     MOVE TIPO-ID-BDACSV    TO TIPO-ID-AUX13-BDAMATCH  .
  5676     MOVE NUM-ID-BDACSV     TO NUM-ID-AUX13-BDAMATCH   .
  5677     MOVE COD-SUS-BDACSV    TO COD-SUS-AUX13-BDAMATCH  .
  5678     MOVE COD-CTA-BDACSV    TO COD-CTA-AUX13-BDAMATCH  .
  5679     MOVE NUM-CTA-BDACSV    TO NUM-CTA-AUX13-BDAMATCH  .
  5680     MOVE 0 TO FALLECIDO-BDAMATCH                                 RMB0003
  5681     IF COD-CTA-BDACSV = 01 OR 51
  5682        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CHECK
  5683        READ MAESTRO-CHECK IGNORE LOCK INVALID KEY
  5684             MOVE 0 TO PROCESAR-BDAMATCH
  5685        NOT INVALID KEY                                           RMB0003
  5686            IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)                  RMB0004
  5687                AND CONSECUTIVO-ABD06 = 1
  5688               IF ADJETIVO-ABD06 = 1                              RMB0003
  5689                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
  5690               END-IF                                             RMB0003
  5691            ELSE                                                  RMB0003
  5692               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
  5693            END-IF                                                RMB0003
  5694        END-READ
  5695     ELSE
  5696        MOVE LLAVE-AUX11-BDAMATCH  TO LLAVE-MAES-CREDIT
  5697        READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY
  5698             MOVE 0 TO PROCESAR-BDAMATCH
  5699        NOT INVALID KEY                                           RMB0003
  5700            IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)                  RMB0004
  5701               AND CONSECUTIVO-ABD07 = 1
  5702               IF ADJETIVO1-ABD07 = 1 OR                          RMB0003
  5703                  ADJETIVO2-ABD07 = 1 OR                          RMB0003
  5704                  ADJETIVO3-ABD07 = 1                             RMB0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  99
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5705                  MOVE 1 TO FALLECIDO-BDAMATCH                    RMB0003
  5706               END-IF                                             RMB0003
  5707            ELSE                                                  RMB0003
  5708               MOVE 0 TO PROCESAR-BDAMATCH                        RMB0003
  5709            END-IF                                                RMB0003
  5710        END-READ
  5711     END-IF.
  5712
  5713 1200-PROC-REG-CSV-BDAMATCH.
  5714***********************************************************************
  5715*1200-PROC-REG-CSV-BDAMATCH.
  5716* SE INSERTA LA CUENTA,EL NOMBRE Y SE UBICA EL REGISTRO DE DIRECCIONES
  5717* SI LO HAY
  5718***********************************************************************
  5719     IF MAX-CUENTAS-BDAMATCH = 0
  5720        PERFORM 1000-U-INICIALIZAR-BDAMATCH
  5721     END-IF.
  5722     MOVE LLAVE-AUX11-BDAMATCH   TO CTA-INPUT-BDAMATCH.
  5723     MOVE  COD-SUSCRIP-ABD02     TO  SUSC-CTAS-BDAMATCH.    *>DLMDLM
  5724     PERFORM 2000-U-INSERTAR-CTA-BDAMATCH.
  5725     MOVE NOMBRE-BDACSV  TO NOM-INPUT-BDAMATCH.
  5726     PERFORM 2000-U-INSERTAR-NOM-BDAMATCH.
  5727     MOVE LLAVE-AUX13-BDAMATCH TO LLAVE-DIRECC.
  5728     READ MAESTRO-DIRECC IGNORE LOCK
  5729*         NOT INVALID KEY                                         RMB0004
  5730*             PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                 RMB0004
  5731          INVALID KEY                                             RMB0004
  5732              MOVE SPACES TO LLAVE-DIRECC                         RMB0004
  5733     END-READ.
  5734     IF LLAVE-DIRECC <> SPACES                                    RMB0004
  5735        PERFORM 1210-DIRTEL-BDACSV-BDAMATCH                       RMB0004
  5736     END-IF.                                                      RMB0004
  5737
  5738 1210-DIRTEL-BDACSV-BDAMATCH.
  5739***********************************************************************
  5740*1210-DIRTEL-BDACSV-BDAMATCH.
  5741* SE INSERTAN LAS DIRECCIONES Y LOS TELEFONOS DEL REGISTRO ESTANDAR DE
  5742* DE DIRECCIONES DENTRO DE LAS ESTRUCTURAS DEL MATCH.
  5743***********************************************************************
  5744     IF CIURES-DIRECC NOT = SPACES
  5745        IF DIRRES-DIRECC NOT = SPACES
  5746           MOVE DIRRES-DIRECC TO DIR-INPUT-BDAMATCH
  5747           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5748        END-IF
  5749        IF TELRES-DIRECC > 0 AND
  5750           TELRES-DIRECC < 9999999999
  5751           MOVE TELRES-DIRECC TO TEL-INPUT-BDAMATCH
  5752           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH
  5753        END-IF
  5754     END-IF.
  5755     IF CIULAB-DIRECC NOT = SPACES
  5756        IF DIRLAB-DIRECC NOT = SPACES
  5757           MOVE DIRLAB-DIRECC TO DIR-INPUT-BDAMATCH
  5758           PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5759        END-IF
  5760        IF TELLAB-DIRECC > 0 AND
  5761           TELLAB-DIRECC < 9999999999
  5762           MOVE TELLAB-DIRECC TO TEL-INPUT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 100
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5763           PERFORM 2000-U-INSERTAR-TEL-BDAMATCH
  5764        END-IF
  5765     END-IF.
  5766     IF CIUCOR-DIRECC NOT = SPACES AND
  5767        DIRCOR-DIRECC NOT = SPACES
  5768        MOVE DIRCOR-DIRECC TO DIR-INPUT-BDAMATCH
  5769        PERFORM 2000-U-INSERTAR-DIR-BDAMATCH
  5770     END-IF.
  5771
  5772 8000-U-VER-CTAABD07-BDAMATCH.
  5773***********************************************************************
  5774*8000-U-VER-CTAABD07-BDAMATCH.
  5775*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
  5776*  LA CUENTA DEL ICMCRE ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
  5777*  DE BLOQUEO A 0
  5778***********************************************************************
  5779     IF IDE-TIPO-BDAMATCH = 1
  5780        MOVE LLAVE-MAES-CREDIT TO CTA-INPUT-BDAMATCH
  5781        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH
  5782        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD07 = 9
  5783           MOVE 0 TO IND-BLOQUEO-ABD07
  5784        END-IF
  5785     END-IF.
  5786
  5787 8000-U-VER-CTAABD06-BDAMATCH.
  5788***********************************************************************
  5789*8000-U-VER-CTAABD06-BDAMATCH.
  5790*  SE BUSCA EN LA TABLA DE CUENTAS DEL MEJOR PORTAFOLIO SI LA LLAVE DE
  5791*  LA CUENTA DEL ICMCHK ES VALIDA. EN ESTE CASO SE CAMBIA EL INDICADOR
  5792*  DE BLOQUEO A 0
  5793***********************************************************************
  5794     IF IDE-TIPO-BDAMATCH = 1
  5795        MOVE LLAVE-MAES-CHECK  TO CTA-INPUT-BDAMATCH
  5796        PERFORM 5000-U-VALIDAR-CUENTA-BDAMATCH
  5797        IF VALCTA-OUTPUT-BDAMATCH = 1 AND IND-BLOQUEO-ABD06 = 9
  5798           MOVE 0 TO IND-BLOQUEO-ABD06
  5799        END-IF
  5800     END-IF.
  5801
  5802*======================================================================
  5803 1000-U-INICIALIZAR-BDAMATCH.
  5804********************************************************************
  5805*1000-U-INICIALIZAR-BDAMATCH.
  5806* INPUT = VACIO
  5807* OUTPUT= VACIO
  5808* SE INICIALIZAN TODAS LAS ESTRUCTURAS UTILIZADAS EN LA REALIZACION
  5809* DEl MATCH.
  5810********************************************************************
  5811     MOVE 1 TO I-DIR-BDAMATCH I-TEL-BDAMATCH I-NOM-BDAMATCH.
  5812     MOVE 0 TO I-CTA-BDAMATCH.
  5813     INITIALIZE TABLA-CUENTAS-BDAMATCH.                           RMB0004
  5814     INITIALIZE TABLA-DIR-BDAMATCH.
  5815     INITIALIZE TABLA-TEL-BDAMATCH.
  5816     INITIALIZE TABLA-NOM-BDAMATCH.
  5817     INITIALIZE TABLA-GRUNOM-BDAMATCH.
  5818     INITIALIZE V-INTERRELAC-BDAMATCH.
  5819     MOVE ZEROS   TO POSIC-SUSC-BDAMATCH
  5820                      POSIC-SUS-GRU-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 101
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5821     MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH
  5822     MOVE ALL "9" TO TABLA-SUSC-NOMBRE-BDAMATCH.
  5823
  5824 2000-U-INSERTAR-DIR-BDAMATCH.
  5825********************************************************************
  5826*2000-U-INSERTAR-DIR-BDAMATCH.
  5827* INPUT = DIR-INPUT-BDAMATCH
  5828* OUTPUT= VACIO
  5829* SE INSERTA EN LA TABLA DE DIRECCIONES LOS NUMEROS DE LA DIRECCION
  5830* PASADA EN EL PARAMETRO ORDENADOS DE MAYOR A MENOR . SIEMPRE QUE
  5831* LA DIRECCION CONTENGA ALGUN NUMERO
  5832********************************************************************
  5833     MOVE DIR-INPUT-BDAMATCH  TO T-CARDIR-BDAMATCH.
  5834     MOVE 1 TO I-BDAMATCH
  5835     MOVE 0 TO J-BDAMATCH
  5836     MOVE " " TO CAR-ANT-BDAMATCH
  5837     INITIALIZE T-CARTOT-BDAMATCH
  5838     PERFORM UNTIL I-BDAMATCH > 60 OR J-BDAMATCH >= 10            CAV0002
  5839       IF V-CARDIR-BDAMATCH  (I-BDAMATCH) NUMERIC
  5840          MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ACT-BDAMATCH
  5841          IF CAR-ANT-BDAMATCH   NUMERIC
  5842             COMPUTE V-CARTOT-BDAMATCH (J-BDAMATCH)
  5843                     = V-CARTOT-BDAMATCH  (J-BDAMATCH)
  5844                     * 10 + CAR-ACT-BDAMATCH
  5845          ELSE
  5846             ADD 1 TO J-BDAMATCH
  5847             MOVE V-CARDIR-BDAMATCH  (I-BDAMATCH)
  5848                  TO V-CARTOT-BDAMATCH  (J-BDAMATCH)
  5849          END-IF
  5850       END-IF
  5851       MOVE V-CARDIR-BDAMATCH (I-BDAMATCH) TO CAR-ANT-BDAMATCH
  5852       ADD 1 TO I-BDAMATCH
  5853     END-PERFORM.
  5854     SORT V-CARTOT-BDAMATCH   DESCENDING.
  5855     IF T-CARTOT-BDAMATCH   NOT = ZEROS AND
  5856        I-DIR-BDAMATCH < LIM-BDAMATCH
  5857        MOVE T-CARTOT-BDAMATCH TO
  5858             NUM-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5859        MOVE SUSC-CTAS-BDAMATCH TO
  5860             SUS-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5861        MOVE I-CTA-BDAMATCH TO CTA-DIR-BDAMATCH(I-DIR-BDAMATCH)
  5862        PERFORM  VARYING POSIC-SUMA-BDAMATCH FROM 1 BY 1
  5863                 UNTIL  POSIC-SUMA-BDAMATCH  >  10 OR
  5864                 V-CARTOT-BDAMATCH(POSIC-SUMA-BDAMATCH)  =  ZERO
  5865           ADD   1  TO   LNG-DIR-BDAMATCH (I-DIR-BDAMATCH)
  5866        END-PERFORM
  5867        ADD 1 TO I-DIR-BDAMATCH
  5868     END-IF.
  5869
  5870 2000-U-INSERTAR-TEL-BDAMATCH.
  5871********************************************************************
  5872*2000-U-INSERTAR-TEL-BDAMATCH.
  5873* INPUT = TEL-INPUT-BDAMATCH
  5874* OUTPUT= VACIO
  5875* SE INSERTA EN LA TABLA DE TELEFONOS EL NUMERO DEL TELEFONO
  5876* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA MAYOR A CERO
  5877********************************************************************
  5878     IF I-TEL-BDAMATCH < LIM-BDAMATCH AND TEL-INPUT-BDAMATCH > 0
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 102
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5879        MOVE TEL-INPUT-BDAMATCH TO
  5880                                NUM-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5881        MOVE SUSC-CTAS-BDAMATCH TO
  5882                                SUS-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5883        MOVE I-CTA-BDAMATCH     TO
  5884                                CTA-TEL-BDAMATCH(I-TEL-BDAMATCH)
  5885        ADD 1 TO I-TEL-BDAMATCH
  5886     END-IF.
  5887
  5888 2000-U-INSERTAR-NOM-BDAMATCH.
  5889********************************************************************
  5890*2000-U-INSERTAR-NOM-BDAMATCH.
  5891* INPUT = NOM-INPUT-BDAMATCH
  5892* OUTPUT= VACIO
  5893* SE INSERTA EN LA TABLA DE NOMBRES   EL NOMBRE
  5894* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
  5895********************************************************************
  5896     IF I-NOM-BDAMATCH < LIM-BDAMATCH AND
  5897        NOM-INPUT-BDAMATCH <> SPACES
  5898        MOVE NOM-INPUT-BDAMATCH  TO
  5899             NOM-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5900                                   NOM-LIMPI-BDAMATCH
  5901        MOVE I-CTA-BDAMATCH TO CTA-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5902        MOVE ZEROS TO PESO-CTAS-TOT-BDAMATCH  NRO-VECES-1-BDAMATCH
  5903                            NRO-VECES-2-BDAMATCH
  5904        PERFORM VARYING NRO-VECES-1-BDAMATCH FROM 1 BY 1
  5905          UNTIL  NRO-VECES-1-BDAMATCH  >  60
  5906          IF NRO-VECES-1-BDAMATCH  >  1 AND
  5907           NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH - 1:1) = " "
  5908             SUBTRACT  1 FROM  NRO-VECES-1-BDAMATCH
  5909          END-IF
  5910          IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:1) = " "
  5911            COMPUTE  NRO-VECES-2-BDAMATCH =
  5912                     60 - NRO-VECES-1-BDAMATCH
  5913            MOVE  NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +
  5914                  1:NRO-VECES-2-BDAMATCH)
  5915                TO   NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH:)
  5916            IF NOM-LIMPI-BDAMATCH(NRO-VECES-1-BDAMATCH +
  5917               1:NRO-VECES-2-BDAMATCH) = SPACES
  5918               MOVE  85           TO  NRO-VECES-1-BDAMATCH
  5919            END-IF
  5920          END-IF
  5921        END-PERFORM
  5922        INSPECT NOM-LIMPI-BDAMATCH
  5923                TALLYING       PESO-CTAS-TOT-BDAMATCH
  5924                FOR CHARACTERS BEFORE INITIAL " "
  5925        MOVE  PESO-CTAS-TOT-BDAMATCH TO
  5926              LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5927        IF FUENTE-REG-BDACSV >= 02                                RMB0004
  5928           MOVE 99 TO LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)            RMB0004
  5929        END-IF                                                    RMB0004
  5930        MOVE  SUSC-CTAS-BDAMATCH TO
  5931              SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  5932        ADD 1 TO I-NOM-BDAMATCH
  5933     END-IF.
  5934
  5935 2000-U-INSERTAR-CTA-BDAMATCH.
  5936********************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 103
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5937*2000-U-INSERTAR-CTA-BDAMATCH.
  5938* INPUT = CTA-INPUT-BDAMATCH
  5939* OUTPUT= VACIO
  5940* SE INSERTA EN LA TABLA DE CUENTAS EL VALOR DE LA CUENTA
  5941* PASADO EN EL PARAMETRO  SIEMPRE QUE SEA DIFERENTE DE ESPACIOS
  5942********************************************************************
  5943     IF I-CTA-BDAMATCH < LIM-BDAMATCH AND
  5944        CTA-INPUT-BDAMATCH <> SPACES
  5945        ADD 1 TO I-CTA-BDAMATCH
  5946        MOVE CTA-INPUT-BDAMATCH TO
  5947             CTA-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)
  5948        MOVE I-CTA-BDAMATCH     TO MAX-CUENTAS-BDAMATCH
  5949        MOVE FALLECIDO-BDAMATCH TO                                RMB0003
  5950             CTA-FALLECIDO-BDAMATCH(I-CTA-BDAMATCH)               RMB0003
  5951        IF FUENTE-REG-BDACSV >= 2                                 RMB0004
  5952           MOVE 1 TO FUEEXT-CUENTAS-BDAMATCH(I-CTA-BDAMATCH)      RMB0004
  5953        END-IF                                                    RMB0004
  5954     END-IF.
  5955 3000-U-ORDENAR-DIR-BDAMATCH.
  5956********************************************************************
  5957*3000-U-ORDENAR-DIR-BDAMATCH.
  5958* INPUT = TABLA DE DIRECCIONES LLENA
  5959* OUTPUT= TABLA DE RELACIONES LLENADA CON DIRECCIONES
  5960* SE ORDENA LA TABLA DE DIRECCIONES EN SUBPORTAFOLIOS QUE SON
  5961* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  5962********************************************************************
  5963     SORT T-DIR-BDAMATCH
  5964          DESCENDING NUM-DIR-BDAMATCH
  5965          ASCENDING  CTA-DIR-BDAMATCH.
  5966     MOVE 1 TO I-CTA-BDAMATCH.
  5967     MOVE 0 TO FIL-FUE-BDAMATCH
  5968     MOVE 1 TO COL-FUE-BDAMATCH
  5969     MOVE 999                TO CTA-DIR-ANT-BDAMATCH
  5970     MOVE ALL "9"            TO NUM-DIR-ANT-BDAMATCH
  5971     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH OR
  5972                         CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) = 0
  5973       IF NUM-DIR-ANT-BDAMATCH <>
  5974                                 NUM-DIR-BDAMATCH(I-CTA-BDAMATCH)
  5975          ADD  1 TO FIL-FUE-BDAMATCH
  5976          MOVE 1 TO COL-FUE-BDAMATCH
  5977          MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5978               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  5979          MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  5980          ADD 1 TO NUM-CTAS-DIR-BDAMATCH(I-CTA-BDAMATCH)
  5981          MOVE  I-CTA-BDAMATCH       TO  POSIC-SUMA-BDAMATCH
  5982          ADD 1 TO COL-FUE-BDAMATCH
  5983       ELSE
  5984          IF CTA-DIR-ANT-BDAMATCH <>
  5985             CTA-DIR-BDAMATCH(I-CTA-BDAMATCH)
  5986             MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5987               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  5988             MOVE "DIR" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  5989             ADD 1 TO COL-FUE-BDAMATCH
  5990          END-IF
  5991            ADD 1 TO NUM-CTAS-DIR-BDAMATCH(POSIC-SUMA-BDAMATCH)
  5992       END-IF
  5993       MOVE CTA-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5994                                          CTA-DIR-ANT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 104
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  5995       MOVE NUM-DIR-BDAMATCH(I-CTA-BDAMATCH) TO
  5996                                           NUM-DIR-ANT-BDAMATCH
  5997       ADD 1 TO I-CTA-BDAMATCH
  5998     END-PERFORM.
  5999     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6000
  6001 3000-U-ORDENAR-TEL-BDAMATCH.
  6002********************************************************************
  6003*3000-U-ORDENAR-TEL-BDAMATCH.
  6004* INPUT = TABLA DE TELEFONOS   LLENA
  6005* OUTPUT= TABLA DE RELACIONES LLENADA CON TELEFONOS
  6006* SE ORDENA LA TABLA DE TELEFONOS EN SUBPORTAFOLIOS QUE SON
  6007* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6008********************************************************************
  6009     SORT T-TEL-BDAMATCH
  6010          DESCENDING NUM-TEL-BDAMATCH
  6011          ASCENDING  CTA-TEL-BDAMATCH .
  6012     MOVE 1 TO I-CTA-BDAMATCH.
  6013     MOVE 1 TO COL-FUE-BDAMATCH
  6014     MOVE 999      TO CTA-TEL-ANT-BDAMATCH
  6015     MOVE ALL "9"  TO NUM-TEL-ANT-BDAMATCH
  6016     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH
  6017             OR  CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) = 0
  6018             OR  FIL-FUE-BDAMATCH > LIM-BDAMATCH
  6019             OR  COL-FUE-BDAMATCH > LIM-BDAMATCH
  6020       IF NUM-TEL-ANT-BDAMATCH <>
  6021          NUM-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6022          ADD  1 TO FIL-FUE-BDAMATCH
  6023          MOVE 1 TO COL-FUE-BDAMATCH
  6024          MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6025               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6026          MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6027          ADD  1 TO  NUM-CTAS-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6028          MOVE I-CTA-BDAMATCH TO POSIC-SUMA-BDAMATCH
  6029          ADD 1 TO COL-FUE-BDAMATCH
  6030       ELSE
  6031          IF CTA-TEL-ANT-BDAMATCH <>
  6032             CTA-TEL-BDAMATCH(I-CTA-BDAMATCH)
  6033             MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6034                 CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6035             MOVE "TEL" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6036             ADD 1 TO COL-FUE-BDAMATCH
  6037          END-IF
  6038            ADD   1 TO NUM-CTAS-TEL-BDAMATCH(POSIC-SUMA-BDAMATCH)
  6039       END-IF
  6040       MOVE CTA-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6041                                           CTA-TEL-ANT-BDAMATCH
  6042       MOVE NUM-TEL-BDAMATCH(I-CTA-BDAMATCH) TO
  6043                                           NUM-TEL-ANT-BDAMATCH
  6044       ADD 1 TO I-CTA-BDAMATCH
  6045     END-PERFORM.
  6046     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6047
  6048 3000-U-ORDENAR-NOM-BDAMATCH.
  6049********************************************************************
  6050*3000-U-ORDENAR-NOM-BDAMATCH.
  6051* INPUT = TABLA DE NOMBRES     LLENA
  6052* OUTPUT= TABLA DE RELACIONES LLENADA CON NOMBRES
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 105
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6053* SE ORDENA LA TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
  6054* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6055********************************************************************
  6056     SORT T-NOM-BDAMATCH
  6057          DESCENDING NOM-NOM-BDAMATCH
  6058          DESCENDING LNG-NOM-BDAMATCH
  6059          ASCENDING  CTA-NOM-BDAMATCH .
  6060     MOVE 1 TO I-NOM-BDAMATCH.
  6061     MOVE 1 TO GRU-NOM-BDAMATCH.
  6062     MOVE GRU-NOM-BDAMATCH TO
  6063          GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH).
  6064     MOVE GRU-NOM-BDAMATCH TO
  6065          GRUPO-GRUNOM-BDAMATCH(I-NOM-BDAMATCH).
  6066     MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6067          NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH).
  6068     MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6069          SUSC-GRUP-SUS-BDAMATCH
  6070     MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH) TO
  6071          SUSC-GRUP-GRU-BDAMATCH
  6072     PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6073     IF  INV-BDAMATCH  =  1
  6074       ADD   1        TO
  6075       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6076     END-IF
  6077     MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6078          LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6079     ADD 1 TO I-NOM-BDAMATCH.
  6080     PERFORM UNTIL I-NOM-BDAMATCH > LIM-BDAMATCH
  6081             OR CTA-NOM-BDAMATCH(I-NOM-BDAMATCH) = 0
  6082       MOVE 1 TO I-GRU-BDAMATCH
  6083       MOVE 0 TO MATCH-OK-OUT-VALNOM
  6084       PERFORM UNTIL NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) =
  6085               SPACES OR I-GRU-BDAMATCH > LIM-BDAMATCH
  6086               OR MATCH-OK-OUT-VALNOM = 1
  6087         MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6088              NOMBRE-INPUT-VALNOM
  6089         MOVE NOM-GRUNOM-BDAMATCH(I-GRU-BDAMATCH) TO
  6090              NOMBOK-INPUT-VALNOM
  6091         IF  TIP-IDE-INPUT-BDAMATCH = 2 OR 3                      RMB0004
  6092            IF NUM-IDE-INPUT-BDAMATCH >= 600000000 AND            RMB0004
  6093               NUM-IDE-INPUT-BDAMATCH <= 999999999                RMB0004
  6094               MOVE 2 TO TIP-ID-INPUT-VALNOM                      RMB0004
  6095               MOVE 1 TO BLOQUES-INPUT-VALNOM                     RMB0004
  6096            ELSE                                                  RMB0004
  6097               MOVE 1 TO TIP-ID-INPUT-VALNOM                      RMB0004
  6098               MOVE 2 TO BLOQUES-INPUT-VALNOM                     RMB0004
  6099            END-IF                                                RMB0004
  6100         ELSE                                                     RMB0004
  6101            MOVE 1 TO TIP-ID-INPUT-VALNOM                         RMB0004
  6102            MOVE 2 TO BLOQUES-INPUT-VALNOM                        RMB0004
  6103         END-IF                                                   RMB0004
  6104         IF NOMBRE-INPUT-VALNOM(43:3) = ".-," OR                  RMB0004
  6105            NOMBOK-INPUT-VALNOM(43:3) = ".-,"                     RMB0004
  6106            MOVE 1 TO BLOQUES-INPUT-VALNOM                        RMB0004
  6107         END-IF                                                   RMB0004
  6108         PERFORM 10000-MATCH-NOMBRES-VALNOM
  6109         IF MATCH-OK-OUT-VALNOM = 1
  6110            MOVE I-GRU-BDAMATCH TO
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 106
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6111                 GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)
  6112            MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  6113                                 TO  SUSC-GRUP-SUS-BDAMATCH
  6114            MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6115                                 TO  SUSC-GRUP-GRU-BDAMATCH
  6116            IF BLOQUES-INPUT-VALNOM = 1   *> ES UN APELLIDO       RMB0004
  6117               MOVE 1 TO APE-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)    RMB0004
  6118            END-IF                                                RMB0004
  6119            PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6120            IF  INV-BDAMATCH  =  1
  6121              ADD   1  TO
  6122       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6123            END-IF
  6124            IF  LNG-NOM-BDAMATCH(I-NOM-BDAMATCH)  >
  6125                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6126              MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6127                LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6128              MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO            RMB0004
  6129                NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)             RMB0004
  6130            END-IF
  6131         END-IF
  6132         ADD 1 TO I-GRU-BDAMATCH
  6133       END-PERFORM
  6134       IF MATCH-OK-OUT-VALNOM = 0  *> NUEVO GRUPO
  6135          ADD 1 TO GRU-NOM-BDAMATCH
  6136          MOVE NOM-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6137               NOM-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6138          MOVE GRU-NOM-BDAMATCH  TO
  6139               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)
  6140          MOVE GRU-NOM-BDAMATCH  TO
  6141               GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)*> DLM
  6142          MOVE SUS-NOM-BDAMATCH(I-NOM-BDAMATCH)
  6143                             TO  SUSC-GRUP-SUS-BDAMATCH
  6144          MOVE GRUPO-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6145                             TO  SUSC-GRUP-GRU-BDAMATCH
  6146          PERFORM  400-BUSCAR-SUSC-GRUPO-BDAMATCH
  6147          IF  INV-BDAMATCH  =  1
  6148            ADD   1   TO
  6149       NUM-CTAS-GRUNOM-BDAMATCH(GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH))
  6150          END-IF
  6151          MOVE LNG-NOM-BDAMATCH(I-NOM-BDAMATCH) TO
  6152               LNG-GRUNOM-BDAMATCH(GRU-NOM-BDAMATCH)
  6153       ELSE                                                    *>
  6154          MOVE GRU-NOM-BDAMATCH TO
  6155               GRU-NOMS-BDAMATCH(I-NOM-BDAMATCH)   *> DLM
  6156       END-IF
  6157       ADD 1 TO I-NOM-BDAMATCH
  6158     END-PERFORM.
  6159     SORT T-NOM-BDAMATCH
  6160          DESCENDING NOM-NOM-BDAMATCH
  6161          DESCENDING GRU-NOMS-BDAMATCH
  6162          DESCENDING LNG-NOM-BDAMATCH
  6163          ASCENDING  CTA-NOM-BDAMATCH .
  6164     MOVE 1 TO I-CTA-BDAMATCH.
  6165     MOVE 1 TO COL-FUE-BDAMATCH
  6166     MOVE 999                TO CTA-NOM-ANT-BDAMATCH
  6167     MOVE ALL "9"            TO GRU-NOM-ANT-BDAMATCH
  6168     PERFORM UNTIL I-CTA-BDAMATCH > LIM-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 107
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6169             OR CTA-NOM-BDAMATCH (I-CTA-BDAMATCH) = 0
  6170             OR FIL-FUE-BDAMATCH > LIM-BDAMATCH
  6171             OR COL-FUE-BDAMATCH > LIM-BDAMATCH
  6172       IF GRU-NOM-ANT-BDAMATCH <>
  6173          GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH)
  6174          ADD  1 TO FIL-FUE-BDAMATCH
  6175          MOVE 1 TO COL-FUE-BDAMATCH
  6176          MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6177               CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6178          MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6179          ADD 1 TO COL-FUE-BDAMATCH
  6180       ELSE
  6181          IF CTA-NOM-ANT-BDAMATCH <>
  6182             CTA-NOM-BDAMATCH(I-CTA-BDAMATCH)
  6183             MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6184                  CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH)
  6185             MOVE "NOM" TO CARAC-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6186             ADD 1 TO COL-FUE-BDAMATCH
  6187          END-IF
  6188       END-IF
  6189       MOVE CTA-NOM-BDAMATCH(I-CTA-BDAMATCH) TO
  6190            CTA-NOM-ANT-BDAMATCH
  6191       MOVE GRU-NOMS-BDAMATCH(I-CTA-BDAMATCH) TO
  6192            GRU-NOM-ANT-BDAMATCH
  6193       ADD 1 TO I-CTA-BDAMATCH
  6194     END-PERFORM.
  6195     MOVE FIL-FUE-BDAMATCH TO MAX-REL-BDAMATCH.
  6196
  6197 4000-U-INTERELACIONAR-BDAMATCH.
  6198********************************************************************
  6199*4000-U-INTERELACIONAR-BDAMATCH.
  6200* INPUT = TABLA DE RELACIONES LLENA CON NOMBRES,DIRECCIONES,TELEFONOS
  6201* OUTPUT= TABLA DE RELACIONES CON LOS PORTAFOLIOS DETERMINADOS
  6202* SE REALIZAN  TABLA DE NOMBRES   EN SUBPORTAFOLIOS QUE SON
  6203* INSERTADOS EN LA TABLA DE RELACIONAMIENTO
  6204********************************************************************
  6205*    PERFORM 1110-MOSTRAR-MATRIZ1                                 RMB0004
  6206     MOVE 1 TO MOVIDO-BDAMATCH    .
  6207     PERFORM UNTIL MOVIDO-BDAMATCH = 0
  6208        MOVE 0 TO MOVIDO-BDAMATCH
  6209        MOVE 1 TO FIL-BUS-BDAMATCH
  6210        PERFORM UNTIL FIL-BUS-BDAMATCH > MAX-REL-BDAMATCH
  6211          MOVE 1 TO COL-BUS-BDAMATCH
  6212          PERFORM UNTIL COL-BUS-BDAMATCH > MAX-CUENTAS-BDAMATCH
  6213            IF CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)
  6214               > 0
  6215            MOVE CAJA-BDAMATCH(FIL-BUS-BDAMATCH,COL-BUS-BDAMATCH)
  6216                 TO BUSCADO-BDAMATCH
  6217               PERFORM 4100-BUSCAR-RELACION-BDAMATCH
  6218            ELSE
  6219               MOVE MAX-CUENTAS-BDAMATCH TO COL-BUS-BDAMATCH
  6220            END-IF
  6221            ADD 1 TO COL-BUS-BDAMATCH
  6222          END-PERFORM
  6223          ADD 1 TO FIL-BUS-BDAMATCH
  6224        END-PERFORM
  6225     END-PERFORM.
  6226
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 108
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6227 4100-BUSCAR-RELACION-BDAMATCH.
  6228********************************************************************
  6229*4100-BUSCAR-RELACION-BDAMATCH.
  6230* SE BUSCA LA RELACION DE UNA CUENTA CON LAS CUENTAS DE UNA FILA
  6231********************************************************************
  6232     MOVE 1 TO FIL-FUE-BDAMATCH.
  6233     PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH
  6234        IF FIL-FUE-BDAMATCH <> FIL-BUS-BDAMATCH
  6235           MOVE 0 TO EXISTE-BDAMATCH
  6236           INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6237              TALLYING EXISTE-BDAMATCH
  6238              FOR CHARACTERS BEFORE INITIAL BUSCADO-D-BDAMATCH
  6239            ADD 1 TO EXISTE-BDAMATCH
  6240            IF EXISTE-BDAMATCH <= 2000
  6241                PERFORM 4110-MOVER-RELACIONES-BDAMATCH
  6242           END-IF
  6243        END-IF
  6244        ADD 1 TO FIL-FUE-BDAMATCH
  6245     END-PERFORM.
  6246
  6247 4110-MOVER-RELACIONES-BDAMATCH.
  6248********************************************************************
  6249*4110-MOVER-RELACIONES-BDAMATCH.
  6250* ENCONTRADA LA RELACION SE PROCEDE A MOVER TODAS LAS RELACIONES
  6251* QUe NO EXISTAN A LA FILA FUENTE DE LA BUSQUEDA
  6252********************************************************************
  6253       MOVE 0 TO FIN-FUENTE-BDAMATCH.
  6254       INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6255               TALLYING FIN-FUENTE-BDAMATCH
  6256               FOR CHARACTERS BEFORE INITIAL "000 "
  6257       COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH / 4
  6258       MOVE 0 TO LIBRE-BUSCADO-BDAMATCH.
  6259       INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)
  6260               TALLYING LIBRE-BUSCADO-BDAMATCH
  6261               FOR CHARACTERS BEFORE INITIAL "000 "
  6262       COMPUTE LIBRE-BUSCADO-BDAMATCH = LIBRE-BUSCADO-BDAMATCH / 4
  6263       ADD 1 TO LIBRE-BUSCADO-BDAMATCH.
  6264       MOVE 1 TO COL-FUE-BDAMATCH.
  6265       PERFORM UNTIL COL-FUE-BDAMATCH > FIN-FUENTE-BDAMATCH
  6266          MOVE CAJA-BDAMATCH(FIL-FUE-BDAMATCH,COL-FUE-BDAMATCH) TO
  6267                         PORINSERTAR-BDAMATCH
  6268          MOVE 0 TO EXISTE-BDAMATCH
  6269          INSPECT FILA-REL-BDAMATCH(FIL-BUS-BDAMATCH)
  6270               TALLYING EXISTE-BDAMATCH
  6271              FOR CHARACTERS BEFORE INITIAL PORINSERTAR-D-BDAMATCH
  6272          ADD 1 TO EXISTE-BDAMATCH
  6273          IF EXISTE-BDAMATCH > 2000
  6274            MOVE PORINSERTAR-BDAMATCH TO
  6275            CAJA-BDAMATCH(FIL-BUS-BDAMATCH,LIBRE-BUSCADO-BDAMATCH)
  6276            ADD 1 TO LIBRE-BUSCADO-BDAMATCH
  6277            MOVE 1 TO MOVIDO-BDAMATCH
  6278          END-IF
  6279          ADD 1 TO COL-FUE-BDAMATCH
  6280       END-PERFORM.
  6281       INITIALIZE
  6282            FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH). *> SE BORRA LO TR
  6283
  6284 5000-U-MEJOR-PORTAFOL-BDAMATCH.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 109
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6285********************************************************************
  6286*5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6287* SE DETERMINA LA FILA QUE DA LAS MEJORES CARACTERISTICAS PARA EL
  6288* PORTAFOLIO QUE TIENE MAS CUENTAS
  6289********************************************************************
  6290      MOVE 0 TO MEJOR-PORTAFOLIO-BDAMATCH.
  6291      MOVE 0 TO MAXREL-PER-BDAMATCH
  6292      MOVE 0 TO FIN-FUENTE-BDAMATCH.
  6293      MOVE 1 TO FIL-FUE-BDAMATCH.
  6294      MOVE 0 TO  PESOS-CTRL-BDAMATCH
  6295      PERFORM UNTIL FIL-FUE-BDAMATCH > MAX-REL-BDAMATCH
  6296        INSPECT FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)
  6297               TALLYING FIN-FUENTE-BDAMATCH
  6298               FOR CHARACTERS BEFORE INITIAL "000 "
  6299        COMPUTE FIN-FUENTE-BDAMATCH = FIN-FUENTE-BDAMATCH    / 4
  6300        MOVE 0 TO PESO-CTAS-TOT-BDAMATCH
  6301        MOVE 1 TO POSIC-SUMA-BDAMATCH
  6302        MOVE ALL "9" TO TABLA-SUSC-DIR-BDAMATCH                   RMB0004
  6303        MOVE 0 TO  POSIC-SUSC-BDAMATCH                            RMB0004
  6304        MOVE 0 TO ENT-FIN-PORT-BDAMATCH                           RMB0004
  6305        MOVE 0 TO ENT-UNICAS-PORT-BDAMATCH                        RMB0004
  6306        PERFORM  VARYING  NRO-VECES-1-BDAMATCH  FROM  1  BY  1
  6307           UNTIL  NRO-VECES-1-BDAMATCH  >  FIN-FUENTE-BDAMATCH
  6308           MOVE
  6309        FILA-REL-BDAMATCH(FIL-FUE-BDAMATCH)(POSIC-SUMA-BDAMATCH:3)
  6310                TO  CTA-A-BUSCAR-BDAMATCH
  6311           IF CTA-A-BUSCAR-BDAMATCH > 0                           RMB0004
  6312            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(13:6)RMB0004
  6313                 TO SUSC-CTAS-BDAMATCH                            RMB0004
  6314            MOVE CTA-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH)(19:2)RMB0005
  6315                 TO I2-BDAMATCH                                   RMB0005
  6316            PERFORM 5100-CALCULAR-PESO-DIR-BDAMATCH               RMB0004
  6317            PERFORM 5200-CALCULAR-PESO-TEL-BDAMATCH               RMB0004
  6318            PERFORM 5300-CALCULAR-PESO-CTA-BDAMATCH               RMB0004
  6319           END-IF                                                 RMB0004
  6320           ADD 4 TO  POSIC-SUMA-BDAMATCH
  6321        END-PERFORM
  6322        PERFORM 5400-DEDUCIR-MEJ-PORT-BDAMATCH                    RMB0004
  6323        ADD 1 TO FIL-FUE-BDAMATCH
  6324      END-PERFORM.
  6325 5100-CALCULAR-PESO-DIR-BDAMATCH.                                 RMB0004
  6326     PERFORM  VARYING  NRO-VECES-2-BDAMATCH  FROM  1  BY  1       RMB0004
  6327        UNTIL  NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH OR           RMB0004
  6328        CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) =  ZEROS           RMB0004
  6329        IF CTA-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH)                 RMB0004
  6330                                     =  CTA-A-BUSCAR-BDAMATCH     RMB0004
  6331          COMPUTE PESO-CTAS-TOT-BDAMATCH  =                       RMB0004
  6332                   PESO-CTAS-TOT-BDAMATCH +                       RMB0004
  6333          (NUM-CTAS-DIR-BDAMATCH(NRO-VECES-2-BDAMATCH) *          RMB0004
  6334                  PESO-DIR-BDAMATCH )                             RMB0004
  6335        END-IF                                                    RMB0004
  6336     END-PERFORM.                                                 RMB0004
  6337 5200-CALCULAR-PESO-TEL-BDAMATCH.                                 RMB0004
  6338     PERFORM VARYING NRO-VECES-2-BDAMATCH FROM 1 BY 1             RMB0004
  6339        UNTIL NRO-VECES-2-BDAMATCH > LIM-BDAMATCH OR              RMB0004
  6340        CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) = ZEROS            RMB0004
  6341        IF  CTA-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH)                RMB0004
  6342                                      =  CTA-A-BUSCAR-BDAMATCH    RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 110
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6343          COMPUTE  PESO-CTAS-TOT-BDAMATCH  =                      RMB0004
  6344             PESO-CTAS-TOT-BDAMATCH +                             RMB0004
  6345           (NUM-CTAS-TEL-BDAMATCH(NRO-VECES-2-BDAMATCH) *         RMB0004
  6346             PESO-TEL-BDAMATCH )                                  RMB0004
  6347        END-IF                                                    RMB0004
  6348     END-PERFORM.                                                 RMB0004
  6349 5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
  6350******************************************************************
  6351*5300-CALCULAR-PESO-CTA-BDAMATCH.                                 RMB0004
  6352* SE BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y SE CUENTAN SOLO
  6353* LAS ENTIDADES UNICAS Y LAS FINANCIERAS
  6354******************************************************************
  6355     SET IND-DIR-BDAMATCH TO 1.                                   RMB0004
  6356     SEARCH ALL REG-SUSC-DIR-BDAMATCH AT END                      RMB0004
  6357         MOVE 1 TO  INV-BDAMATCH                                  RMB0004
  6358       WHEN COD-SUSC-DIR-BDAMATCH(IND-DIR-BDAMATCH) =             RMB0004
  6359            SUSC-CTAS-BDAMATCH                                    RMB0004
  6360         MOVE 0 TO  INV-BDAMATCH                                  RMB0004
  6361     END-SEARCH.                                                  RMB0004
  6362     IF INV-BDAMATCH  =  1                                        RMB0004
  6363        AND POSIC-SUSC-BDAMATCH  <  LIM-BDAMATCH                  RMB0004
  6364        COMPUTE PESO-CTAS-TOT-BDAMATCH = PESO-CTAS-TOT-BDAMATCH   RMB0004
  6365                                       + PESO-NOM-BDAMATCH        RMB0004
  6366        ADD   1                TO  POSIC-SUSC-BDAMATCH            RMB0004
  6367        MOVE SUSC-CTAS-BDAMATCH  TO                               RMB0004
  6368             COD-SUSC-DIR-BDAMATCH(POSIC-SUSC-BDAMATCH)           RMB0004
  6369*       MOVE  SUSC-CTAS-BDAMATCH(1:2)  TO I2-BDAMATCH             RMB0005
  6370        IF I2-BDAMATCH > 0 AND I2-BDAMATCH <= 100                 RMB0005
  6371           IF V-TIPCTA-BDAMATCH(I2-BDAMATCH) = 1 OR 2             RMB0005
  6372              ADD 1 TO ENT-FIN-PORT-BDAMATCH                      RMB0005
  6373           END-IF                                                 RMB0005
  6374        END-IF                                                    RMB0005
  6375        ADD 1 TO ENT-UNICAS-PORT-BDAMATCH                         RMB0004
  6376     END-IF.                                                      RMB0004
  6377     IF FUEEXT-CUENTAS-BDAMATCH(CTA-A-BUSCAR-BDAMATCH) = 1        RMB0004
  6378        ADD 1000 TO PESO-CTAS-TOT-BDAMATCH                        RMB0004
  6379     END-IF.                                                      RMB0004
  6380 5400-DEDUCIR-MEJ-PORT-BDAMATCH.                                  RMB0004
  6381     IF FIN-FUENTE-BDAMATCH > MAXREL-PER-BDAMATCH                 RMB0004
  6382        MOVE  FIN-FUENTE-BDAMATCH  TO  MAXREL-PER-BDAMATCH        RMB0004
  6383     END-IF                                                       RMB0004
  6384     IF PESO-CTAS-TOT-BDAMATCH  >  PESOS-CTRL-BDAMATCH            RMB0004
  6385        MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
  6386        MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
  6387        MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH   RMB0004
  6388     ELSE                                                         RMB0004
  6389        IF PESO-CTAS-TOT-BDAMATCH  =  PESOS-CTRL-BDAMATCH         RMB0004
  6390           PERFORM 5410-DESEMPATAR-BDAMATCH                       RMB0004
  6391        END-IF                                                    RMB0004
  6392     END-IF.                                                      RMB0004
  6393 5410-DESEMPATAR-BDAMATCH.                                        RMB0004
  6394      IF ENT-FIN-PORT-BDAMATCH > ENT-FIN-MEJ-PORT-BDAMATCH        RMB0004
  6395         MOVE PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCH       RMB0004
  6396         MOVE FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCH       RMB0004
  6397         MOVE ENT-FIN-PORT-BDAMATCH TO ENT-FIN-MEJ-PORT-BDAMATCH  RMB0004
  6398      ELSE                                                        RMB0004
  6399         IF ENT-FIN-PORT-BDAMATCH = ENT-FIN-MEJ-PORT-BDAMATCH     RMB0004
  6400            IF APE-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) = 1 AND      RMB0004
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 111
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6401               NOM-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH)(43:3) <>     RMB0004
  6402                                                             ".-,"RMB0004
  6403               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
  6404               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
  6405               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
  6406                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
  6407            ELSE                                                  RMB0004
  6408              IF LNG-GRUNOM-BDAMATCH(FIL-FUE-BDAMATCH) >          RMB0004
  6409                 LNG-GRUNOM-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH)   RMB0004
  6410               MOVE  PESO-CTAS-TOT-BDAMATCH TO PESOS-CTRL-BDAMATCHRMB0004
  6411               MOVE  FIL-FUE-BDAMATCH TO MEJOR-PORTAFOLIO-BDAMATCHRMB0004
  6412               MOVE ENT-FIN-PORT-BDAMATCH TO                      RMB0004
  6413                                         ENT-FIN-MEJ-PORT-BDAMATCHRMB0004
  6414            END-IF                                                RMB0004
  6415         END-IF                                                   RMB0004
  6416      END-IF.                                                     RMB0004
  6417 5000-U-VALIDAR-CUENTA-BDAMATCH.
  6418*********************************************************************
  6419*5000-U-VALIDAR-CUENTA-BDAMATCH.
  6420* SE VALIDA SI LA LLAVE DE LA CUENTA "CTA-INPUT-BDAMATCH" ESTA DENTRO
  6421* EL MEJOR PORTAFOLIO UBICADO. RETORNA VALCTA-OUTPUT-BDAMATCH
  6422*********************************************************************
  6423     MOVE 0 TO VALCTA-OUTPUT-BDAMATCH
  6424     MOVE 1 TO I-BDAMATCH.
  6425     IF MEJOR-PORTAFOLIO-BDAMATCH > 0
  6426        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR
  6427          VALCTA-OUTPUT-BDAMATCH = 1 OR
  6428          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0
  6429          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)
  6430               TO J-BDAMATCH
  6431          IF CTA-CUENTAS-BDAMATCH(J-BDAMATCH) = CTA-INPUT-BDAMATCH
  6432             MOVE 1 TO VALCTA-OUTPUT-BDAMATCH
  6433          END-IF
  6434          ADD 1 TO I-BDAMATCH
  6435        END-PERFORM
  6436     END-IF.
  6437*
  6438 6000-U-MEJOR-DIR-BDAMATCH.
  6439*********************************************************************
  6440*6000-U-MEJOR-DIR-BDAMATCH.
  6441*   SALIDA DIRECCION-OUTPUT-BDAMATCH .......... MEJOR DIRECCION
  6442*********************************************************************
  6443     SORT T-DIR-BDAMATCH
  6444          DESCENDING  NUM-CTAS-DIR-BDAMATCH
  6445          DESCENDING       LNG-DIR-BDAMATCH
  6446          DESCENDING       NUM-DIR-BDAMATCH
  6447          DESCENDING       CTA-DIR-BDAMATCH.
  6448    MOVE  NUM-DIR-BDAMATCH(01) TO  DIR-OUTPUT-BDAMATCH.
  6449
  6450 6000-U-MEJOR-TEL-BDAMATCH.
  6451*********************************************************************
  6452*6000-U-MEJOR-TEL-BDAMATCH.
  6453*   SALIDA TELEFONO-OUTPUT-BDAMATCH .......... MEJOR TELEFONO
  6454*********************************************************************
  6455     SORT T-TEL-BDAMATCH
  6456          DESCENDING  NUM-CTAS-TEL-BDAMATCH
  6457          DESCENDING       NUM-TEL-BDAMATCH
  6458          DESCENDING       CTA-TEL-BDAMATCH.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 112
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6459    MOVE  NUM-TEL-BDAMATCH(01) TO  TEL-OUTPUT-BDAMATCH.
  6460*
  6461 6000-U-MEJOR-NOM-BDAMATCH.
  6462*********************************************************************
  6463*6000-U-MEJOR-NOM-BDAMATCH.
  6464*   SALIDA NOMBRE-OUTPUT-BDAMATCH .......... MEJOR NOMBRE
  6465*********************************************************************
  6466     SORT T-GRUNOM-BDAMATCH
  6467          DESCENDING  NUM-CTAS-GRUNOM-BDAMATCH
  6468          DESCENDING  LNG-GRUNOM-BDAMATCH
  6469          DESCENDING  NOM-GRUNOM-BDAMATCH.
  6470     MOVE  ZEROS TO  ESTA-CTA-BDAMATCH.
  6471     PERFORM VARYING NRO-VECES-3-BDAMATCH  FROM  1 BY  1
  6472       UNTIL NRO-VECES-3-BDAMATCH  >  LIM-BDAMATCH
  6473          OR GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =  ZEROS
  6474          OR ESTA-CTA-BDAMATCH  =  1
  6475      PERFORM VARYING NRO-VECES-2-BDAMATCH  FROM  1 BY  1
  6476       UNTIL NRO-VECES-2-BDAMATCH  >  LIM-BDAMATCH
  6477          OR CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =  ZEROS
  6478          OR ESTA-CTA-BDAMATCH  =  1
  6479        IF  GRUPO-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH)  =
  6480            GRU-NOMS-BDAMATCH (NRO-VECES-2-BDAMATCH)
  6481         PERFORM VARYING NRO-VECES-1-BDAMATCH  FROM  1 BY  1
  6482          UNTIL NRO-VECES-1-BDAMATCH  >  LIM-BDAMATCH
  6483           OR CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
  6484              NRO-VECES-1-BDAMATCH) = 0
  6485           OR ESTA-CTA-BDAMATCH  =  1
  6486           IF  CTA-NOM-BDAMATCH(NRO-VECES-2-BDAMATCH)  =
  6487               CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,
  6488                             NRO-VECES-1-BDAMATCH)
  6489             MOVE GRU-NOMS-BDAMATCH(NRO-VECES-2-BDAMATCH) TO
  6490                  POSIC-SUS-GRU-BDAMATCH
  6491             MOVE NOM-GRUNOM-BDAMATCH(NRO-VECES-3-BDAMATCH) TO
  6492                  NOM-OUTPUT-BDAMATCH
  6493             MOVE 1 TO  ESTA-CTA-BDAMATCH
  6494           END-IF
  6495         END-PERFORM
  6496        END-IF
  6497      END-PERFORM
  6498     END-PERFORM.
  6499*
  6500 9000-U-REALIZAR-BDAMATCH.
  6501******************************************************************
  6502*9000-U-REALIZAR-BDAMATCH.
  6503* HACE EL LLAMADO DE LAS RUTINAS PARA ENCONTRAR DINALMENTE EL
  6504* MEJOR NOMBRE
  6505******************************************************************
  6506     MOVE  ZEROS                 TO  POSIC-SUSC-BDAMATCH
  6507     MOVE  ALL "9"               TO  TABLA-SUSC-DIR-BDAMATCH
  6508     PERFORM 3000-U-ORDENAR-DIR-BDAMATCH
  6509     PERFORM 3000-U-ORDENAR-TEL-BDAMATCH
  6510     PERFORM 3000-U-ORDENAR-NOM-BDAMATCH
  6511     PERFORM 4000-U-INTERELACIONAR-BDAMATCH
  6512     PERFORM 6000-U-MEJOR-DIR-BDAMATCH.
  6513     PERFORM 6000-U-MEJOR-TEL-BDAMATCH.
  6514     PERFORM 5000-U-MEJOR-PORTAFOL-BDAMATCH.
  6515     PERFORM 6000-U-MEJOR-NOM-BDAMATCH.
  6516*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 113
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAM
  6517 9010-U-VER-FALLECIDO-BDAMATCH.
  6518*********************************************************************
  6519*9010-U-VER-FALLECIDO-BDAMATCH.
  6520* SE EXAMINAN TODAS LAS CUENTAS DEL MEJOR PORTAFOLIO, SE CUENTAN EL
  6521* NUMERO TOTAL DE CUENTAS Y DE CUENTAS CON FALLECIDO.
  6522*********************************************************************
  6523     MOVE 1 TO I-BDAMATCH.                                        RMB0003
  6524     IF MEJOR-PORTAFOLIO-BDAMATCH > 0                             RMB0003
  6525        PERFORM UNTIL I-BDAMATCH > LIM-BDAMATCH OR                RMB0003
  6526          VALCTA-OUTPUT-BDAMATCH = 1 OR                           RMB0003
  6527          CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH) = 0 RMB0003
  6528          MOVE CAJA-BDAMATCH(MEJOR-PORTAFOLIO-BDAMATCH,I-BDAMATCH)RMB0003
  6529               TO J-BDAMATCH                                      RMB0003
  6530          ADD 1 TO NUM-CTAS-OUTPUT-BDAMATCH                       RMB0003
  6531          IF CTA-FALLECIDO-BDAMATCH(J-BDAMATCH) = 1               RMB0003
  6532             ADD 1 TO NUM-MUERTOS-OUTPUT-BDAMATCH                 RMB0003
  6533          END-IF                                                  RMB0003
  6534          ADD 1 TO I-BDAMATCH                                     RMB0003
  6535        END-PERFORM                                               RMB0003
  6536     END-IF.                                                      RMB0003
  6537*                                                                 RMB0003
  6538 400-BUSCAR-SUSC-GRUPO-BDAMATCH.
  6539******************************************************************
  6540*400-BUSCAR-SUSC-GRUPO-BDAMATCH.
  6541* BUSCA EN TABLA DE MEMORIA DE SUSCRIPTORES Y GRUPOS.
  6542******************************************************************
  6543     SET IND-NOM-BDAMATCH TO 1.
  6544     SEARCH ALL REG-SUSC-NOM-BDAMATCH AT END
  6545         MOVE 1 TO  INV-BDAMATCH
  6546         WHEN KEY-SUSC-NOM-BDAMATCH(IND-NOM-BDAMATCH) =
  6547              SUSC-GRUPO-BDAMATCH
  6548         MOVE 0 TO  INV-BDAMATCH
  6549     END-SEARCH.
  6550     IF  INV-BDAMATCH = 1
  6551     AND POSIC-SUS-GRU-BDAMATCH <  LIM-BDAMATCH
  6552       ADD 1 TO  POSIC-SUS-GRU-BDAMATCH
  6553       MOVE SUSC-GRUP-SUS-BDAMATCH TO
  6554            COD-SUSC-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)
  6555       MOVE SUSC-GRUP-GRU-BDAMATCH TO
  6556            GRUPO-SUS-NOM-BDAMATCH(POSIC-SUS-GRU-BDAMATCH)
  6557     END-IF.
* 6558 COPY AMNISTIA21.PROC.
  6559*AMNISTIA21.PROC.v.0013
  6560* OJO CAMBIO PARA QUE APLIQUE CON 2n y no 2n+1 y solo hasta que
  6561* FISICAMENTE SE HAYA RECIBIDO LA INFORMACIÓN
  6562****************************************************************
  6563
  6564* 21/01/2009
  6565******************************************************************
  6566*  Interpretación técnica de la Aplicación la ley de habeas data
  6567*  para Datacredito según la discusión del documento
  6568*  "Amnistía - temas por definir" y la aplicación de las
  6569*  definiciones dadas.
  6570*
  6571*  La aplicación de la amnistía a cuentas para un individuo
  6572*  se otorgará solo bajo las siguiente condiciones:
  6573*
  6574*  Para cualquier fecha de consulta al individuo después de
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 114
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6575*  la aprobación o vigencia de la ley
  6576*
  6577* -> Sí el individuo está al día en todas sus obligaciones
  6578*   (sin importar fecha de actualización)
  6579*
  6580* ->      Sí el individuo tiene cuentas canceladas que hayan
  6581*    tenido mora y llevan un año o más de cancelación
  6582*
  6583* -> Sí la fecha de la consulta está dentro del
  6584*    periodo de gracia
  6585*
  6586*    = Se deben amnistiar dichas cuentas canceladas
  6587*
  6588* -> Sí la fecha de la consulta es posterior al
  6589*    periodo de gracia
  6590*
  6591*    -> Sí no existe ninguna mora después del
  6592*       periodo de gracia
  6593*
  6594*       = Se deben amnistiar dichas cuentas canceladas
  6595******************************************************************
  6596*  Colorarios:
  6597*
  6598* - Solo se amnistían las cuentas canceladas que tuvieron mora
  6599*
  6600* - El derecho a la amnistía de obligaciones se pierde si incurre
  6601*   en mora el individuo después del periodo de gracia
  6602*
  6603* - Solo se tiene el derecho a la amnistía de cuentas si el
  6604*   individuo está con todas sus obligaciones al día
  6605*
  6606******************************************************************
  6607* DLM0002    | HISTOR - PERMITIR EJECUCION HISTORICA DE LA AMNIS-*
  6608* 29-JUL-2008|    TIA. LA VARIABLE WS-FECHA-HISTORICA DESDE EL   *
  6609* DARIO LASSO|    PROGRAMA DEBE COLOCARSE CON LA FECHA DESEADA.  *
  6610*            | AJUST1 - AJUSTES A LAS RUTINA DE CALCULO DE AMNIS-*
  6611*            |          TIA CON 48 POSICIONES                    *
  6612******************************************************************
  6613* CAV0003    | MORVEC - NO ASUMIR EL ESTADO DEL VECTOR PARA EL   *
  6614* 19-DIC-2008|    MES EN QUE SE HACE LA CONSULTA. SE CAMBIA LA   *
  6615* C. VELASCO |    CONDICION DE PRIMERA MORA DEL VECTOR DE MENOR  *
  6616*            |    A 12 MESES PARA NO AMNISTIAR A MENOR IGUAL A 12*
  6617******************************************************************
  6618* GJC0004    | LEY002 - POR SOLICITUD DE JURIDICO SE DEBE APLICAR*
  6619* 21-ENE-2009|    AMNISTIA A CARTERAS RECUPERADAS Y CANCELADAS   *
  6620* G. JIMENEZ |    POR MAL MANEJO AUNQUE NO TENGAN MORA MAXIMA >  *
  6621*            |    QUE 0. O VECTOR SIN HISTORIA                   *
  6622******************************************************************
  6623* GJC0005    | LEY003 - SE DEJA EL PERDON DE LAS CARTERAS RECUPE-*
  6624* 19-MAR-2009|    RADAS Y CANCELADAS POR MAL MANEJO CON IGUAL    *
  6625* G. JIMENEZ |    MANEJO QUE CUALQUIER OTRA CUENTA QUE HAYA TENI-*
  6626*            |    DO MORA.                                       *
  6627******************************************************************
  6628* GJC0006    | LEY004 - APLICACION DE ARTICULO 13 DE LA LEY 1266 *
  6629* 28-ENE-2009|    CORRESPONDIENTE A LA APLICACION DE CADUCIDADES *
  6630* G. JIMENEZ |    EN UN TIEMPO CORRESPONDIENTE AL DOBLE DE LA    *
  6631*            |    MORA                                           *
  6632******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 115
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6633* GJC0007    | LEY005 - AJUSTE A RECALCULO DE NOVEDAD PARA QUE SI*
  6634* 05-JUN-2009|    HAY CARTERA RECUPERADA O CANCELADA POR MAL MANE*
  6635* G. JIMENEZ |    JO SIN MORAS SOLO SE PERDONE EL ESTADO SI LA   *
  6636*            |    CUENTA TUVO PERDON DE OTRA FORMA NO            *
  6637******************************************************************
  6638* GJC0008    | LEY006 - AJUSTE PARA QUE CUANDO EN EL MES QUE SE  *
  6639* 09-JUN-2009|   CUMPLE EL TIEMPO DEL PERDON HAY MORA PARA LA    *
  6640* G. JIMENEZ |   IDENTIFICACION Y HAY QUE HACER DESPLAZAMIENTO SE*
  6641*            |   APLIQUE EL PERDON ADECUADAMENTE                 *
  6642*            |   SE TOMA LA FECHA DEL CURRENT DATE POR CADA TRAN-*
  6643*            |   SACCION QUE ENTRA A LA RUTINA
  6644******************************************************************
  6645* GJC0009    | LEY007 - SE CAMBIA LA APLICACION DE ARTICULO 13 DE*
  6646* 26-JUN-2009|   POR PERSONA A POR CUENTA                        *
  6647* G. JIMENEZ |                                                   *
  6648******************************************************************
  6649* GJC0010    | BBVA01 - SE CREA LOGICA PARA QUE EN LA REVISION DE*
  6650* AGOSTO-2009|   LA AMNISTIA CUANDO SE MIRA AL CLIENTE SE ELIMINE*
  6651* G. JIMENEZ |   LA REVISION DE CUENTAS DEL BBVA                 *
  6652******************************************************************
  6653* GJC0011    | DBLMOR - SE CONTEMPLA EL CASO EN QUE EL TIEMPO EN *
  6654* AGOSTO-2011|   MORA HAYA SIDO MAYOR DE 24 MESES Y EL DOBLE DE  *
  6655* G. JIMENEZ |   ESTAS MORAS SIEMPRE DEBE SER 48                 *
  6656*            | PRSCRP - CUANDO UNA CUENTA TIENE PRESCIPCION NO SE*
  6657*            |   PUEDE APLICAR ARTÍCULO 21 PORQUE FINALMENTE NO  *
  6658*            |   PAGO Y SIEMPRE SE APLICA ARTICULO 13 A MENOS QUE*
  6659*            |   EL VECTOR SOLO TENGA MORAS DE 120 Y CEROS       *
  6660******************************************************************
  6661* GJC0012    | CADUC1 - SE HACEN LOS CAMBIOS NECESARIOS PARA     *
  6662* G. JIMENEZ |          HACER CADUCIDAD SOBRE EL VECTOR ANTES DE *
  6663* 23-ENE-2009|          INICIAR APLICACION DE ARTICULO 13        *
  6664*            | ESTA48 - SI SE APLICÓ ARTICULO 13 O CADUCIDAD
  6665******************************************************************
  6666* GJC0013    | LEY008 - SE HACE EL CAMBIO PARA NO EXAMINAR SI LA *
  6667* G. JIMENEZ |          PERSONA TIENE DERECHO A LA AMNISTIA, YA  *
  6668* 23-ENE-2014|          NO APLICA, SOLO ARTICULO 13. (C.VELASCO) *
  6669******************************************************************
  6670
  6671
  6672*200700-AMNISTIA-CLIENTES.                                       *
  6673* RUTINA QUE LEE EL ARCHIVO DE CARTERA PARA                      *
  6674* DETERMINAR SI EL CLIENTE ES OBJETO DE BENEFICIO DE AMNISTIA    *
  6675******************************************************************
  6676 200700-AMNISTIA-CLIENTES.
  6677*    PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009
  6678     IF SW-FCHGRACIA-LEEMSTRS = ZEROS
  6679        IF FECHA-INI-AMNIST21 = ZEROS
  6680           PERFORM 200710-VALIDAR-FECHA-INI-AMNI
  6681        END-IF
  6682        COMPUTE MES-GRACIA-AMNIST21 = MES-INI-AMNIST21 +
  6683                                 MESES-GRACIA-AMNIST21
  6684        MOVE  ANO-INI-AMNIST21  TO  ANO-GRACIA-AMNIST21
  6685        IF MES-GRACIA-AMNIST21 > 12
  6686           COMPUTE MES-GRACIA-AMNIST21 = MES-GRACIA-AMNIST21 - 12
  6687           ADD   1         TO  ANO-GRACIA-AMNIST21
  6688        END-IF
  6689        MOVE 1 TO SW-FCHGRACIA-LEEMSTRS
  6690     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 116
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6691     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0009
  6692     IF FECHA-SYS-AMNIST21 >= FECHA-INI-AMNIST21
  6693        AND ANO-HOY-AMNIST21 < 2014                               GJC0013
  6694        IF TIPO-ID-ABD07 <> TIPO-ID-INI-AMNIST21  OR
  6695           NUM-ID-ABD07  <> NUME-ID-INI-AMNIST21
  6696           MOVE TIPO-ID-ABD07 TO TIPO-ID-INI-AMNIST21
  6697           MOVE NUM-ID-ABD07  TO NUME-ID-INI-AMNIST21
  6698           PERFORM 5000-EXAMINAR-AMINISTIA-PERSONA
  6699        END-IF
  6700     END-IF.
  6701
  6702******************************************************************
  6703 200710-VALIDAR-FECHA-INI-AMNI.
  6704******************************************************************
  6705     DISPLAY VAR-AMBIENTE-AMNIST21 UPON ENVIRONMENT-NAME
  6706     ACCEPT VAR-AMBIENTE-AMNIST21 FROM ENVIRONMENT-VALUE
  6707     IF VAR-AMBIENTE-AMNIST21 = "FECHA_AMNI"
  6708        DISPLAY
  6709         "NO SE HA FIJADO LA VARIABLE DE AMBIENTE DE AMNISTIA"
  6710        STOP RUN
  6711     ELSE
  6712        IF VAR-AMBIENTE-AMNIST21 = SPACES
  6713           MOVE 208001 TO FECHA-INI-AMNIST21
  6714           MOVE 1 TO VERSION-AMNIST21
  6715           DISPLAY "EJECUCION SIN TOMAR AMNISTIA "
  6716                    FECHA-INI-AMNIST21
  6717        ELSE
  6718           MOVE VAR-AMBIENTE-AMNIST21(1:6) TO FECHA-INI-AMNIST21
  6719           IF ANO-INI-AMNIST21 > 2007 AND < 2030 AND
  6720              MES-INI-AMNIST21 > 0 AND < 13
  6721              DISPLAY
  6722              "EJECUCION DE PROG CON AMNISTIA INICIADO EN "
  6723               FECHA-INI-AMNIST21
  6724              MOVE VAR-AMBIENTE-AMNIST21(7:1) TO VERSION-AMNIST21
  6725              IF VERSION-AMNIST21 > 0 AND < 3
  6726                 DISPLAY
  6727                "EJECUCION DE PROG CON AMNISTIA CON RUTINA  "
  6728                 VERSION-AMNIST21
  6729              ELSE
  6730                 DISPLAY
  6731                "LA VERSION DE RUTINA DE AMNISTIA ES INVALIDA "
  6732                 VERSION-AMNIST21
  6733                 STOP RUN
  6734              END-IF
  6735           ELSE
  6736              DISPLAY
  6737              "FECHA DE EJECUCION DE AMNISTIA INVALIDA "
  6738               FECHA-INI-AMNIST21
  6739              STOP RUN
  6740           END-IF
  6741        END-IF
  6742     END-IF.
  6743     PERFORM 200711-CALCULE-FECHA-HOY.                            GJC0008
  6744 200711-CALCULE-FECHA-HOY.                                        GJC0009
  6745******************************************************************
  6746* 200711-CALCULE-FECHA-HOY.
  6747* SE ASIGNA LA FECHA DEL DÍA PARA PODER REALIZAR EL MANEJO DE PROCESOS
  6748* HISTORICOS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 117
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6749******************************************************************
  6750        MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21        GJC0009
  6751        DISPLAY VAR-AMB-HOY-AMNIST21 UPON ENVIRONMENT-NAME        GJC0009
  6752        ACCEPT VAR-AMB-HOY-AMNIST21 FROM ENVIRONMENT-VALUE        GJC0009
  6753        IF VAR-AMB-HOY-AMNIST21(1:9) = "FECHA_HOY"                GJC0009
  6754           MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21     GJC0009
  6755        ELSE                                                      GJC0009
  6756           IF VAR-AMB-HOY-AMNIST21 = SPACES                       GJC0009
  6757              MOVE  FUNCTION CURRENT-DATE TO  FECHA-HOY-AMNIST21  GJC0009
  6758           ELSE                                                   GJC0009
  6759              MOVE VAR-AMB-HOY-AMNIST21 TO VAR-FEC-AMB-AMNIST21   GJC0009
  6760              IF (ANO-VAR-FEC-AMB-AMNIST21 < 2000 OR > 2030) OR   GJC0009
  6761                 (MES-VAR-FEC-AMB-AMNIST21 < 1 AND > 12) OR       GJC0009
  6762                 (DIA-VAR-FEC-AMB-AMNIST21 < 1 AND > 31)          GJC0009
  6763                 DISPLAY "FECHA DE VARIABLE DE AMBIENTE FECHA-HOY"GJC0009
  6764                 DISPLAY "ES INVALIDA, SE TOMA FECHA DEL DIA DE"  GJC0009
  6765                 DISPLAY "HOY"                                    GJC0009
  6766              ELSE                                                GJC0009
  6767                 MOVE VAR-FEC-AMB-AMNIST21 TO FECHA-HOY-AMNIST21  GJC0009
  6768              END-IF                                              GJC0009
  6769           END-IF                                                 GJC0009
  6770        END-IF                                                    GJC0009
  6771     IF SW-FCHGRACIA-LEEMSTRS = 0                                 GJC0009
  6772     DISPLAY                                                      GJC0009
  6773     "PARA APLICACION DE ARTICULO 13 SE TOMA COMO FECHA DEL DIA " GJC0009
  6774     FECHA-HOY-AMNIST21                                           GJC0009
  6775     END-IF.                                                      GJC0009
  6776
  6777******************************************************************
  6778 5000-EXAMINAR-AMINISTIA-PERSONA.
  6779******************************************************************
  6780     MOVE  0     TO SW-AMNIST21
  6781     INITIALIZE   WORK-CLIENTE-AMNIST21                           CAV0002
  6782     MOVE  LLAVE-MAES-CREDIT TO  LLAVE-INI-AMNIST21               GJC0006
  6783     MOVE  TIPO-ID-ABD07     TO  TIPO-ID-MAES-AMNIST21            GJC0006
  6784     MOVE  NUM-ID-ABD07      TO  NUM-ID-MAES-AMNIST21             GJC0006
  6785     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006
  6786     INITIALIZE VECTOR-MORAS-IDE-13-AMNIST21 REPLACING            GJC0006
  6787             ALPHANUMERIC DATA BY CINCOS-AMNIST21                 GJC0006
  6788     MOVE   0   TO  SW-AMNIST21                                   GJC0006
  6789     MOVE 999 TO MESES-FALTAN-AMNIST21                            GJC0006
  6790     PERFORM 200710-READ-ICMCRE-AMNISTIA                          GJC0006
  6791     IF MORAS-ACTUAL-AMNIST21 = ZEROS                             GJC0006
  6792        IF VERSION-AMNIST21 = 1                                   GJC0006
  6793           IF CTAS-MAY12-AMNIST21 = 1                             GJC0006
  6794              MOVE 1 TO SW-AMNIST21                               GJC0006
  6795           END-IF                                                 GJC0006
  6796        ELSE                                                      GJC0006
  6797           IF CTAS-MAY12-AMNIST21 = 1 AND                         GJC0006
  6798              CTAS-MEN12-AMNIST21 = 0                             GJC0006
  6799              MOVE 1 TO SW-AMNIST21                               GJC0006
  6800           END-IF                                                 GJC0006
  6801        END-IF                                                    GJC0006
  6802     END-IF                                                       GJC0006
  6803     PERFORM 200800-RESTAURAR-REGISTROS.                          GJC0006
  6804*    END-IF.                                                      GJC0006
  6805
  6806******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 118
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6807*200710-READ-ICMCRE-AMNISTIA.                                    *
  6808* RUTINA ENCARGADA DE LEER EL MAESTRO DE CARTERA  ICMCRE         *
  6809******************************************************************
  6810 200710-READ-ICMCRE-AMNISTIA.
  6811     INITIALIZE        LLAVE-MAES-CREDIT
  6812     MOVE  TIPO-ID-MAES-AMNIST21  TO  TIPO-ID-ABD07
  6813     MOVE  NUM-ID-MAES-AMNIST21   TO  NUM-ID-ABD07
  6814     START MAESTRO-CREDIT  KEY NOT < LLAVE-MAES-CREDIT
  6815           INVALID KEY
  6816                   MOVE 9 TO TIPO-ID-ABD07
  6817           NOT INVALID KEY
  6818                   READ MAESTRO-CREDIT NEXT
  6819                            AT  END
  6820                                MOVE 9 TO TIPO-ID-ABD07
  6821                   END-READ
  6822     END-START
  6823     PERFORM UNTIL TIPO-ID-ABD07 NOT = TIPO-ID-MAES-AMNIST21 OR
  6824                   NUM-ID-ABD07  NOT = NUM-ID-MAES-AMNIST21       GJC0006
  6825*                         MORAS-ACTUAL-AMNIST21 > ZEROS           GJC0006
  6826           IF COD-SUS-ABD07 = 020050 OR 030050 OR 050050 OR       GJC0010
  6827                              130050                              GJC0010
  6828              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0010
  6829           END-IF                                                 GJC0010
  6830           IF NOV-REPORT-ABD07 > 0 AND NOV-REPORT-ABD07 < 51
  6831              PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  6832              IF IND-BLOQUEO-ABD07 = 0
  6833                 MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  6834                 READ SUSCRIPTOR  IGNORE LOCK
  6835                   INVALID KEY MOVE 0 TO ESTADO-ABD02
  6836                 END-READ
  6837                 IF ESTADO-ABD02 = 1
  6838                    IF MORAS-ACTUAL-AMNIST21 = 0                  GJC0006
  6839                       PERFORM 200720-AMNIST-OBLIGACIONES         GJC0006
  6840                    END-IF                                        GJC0006
  6841* SE DEBE HABILITAR ESTE LLAMADO SI SE QUIERE PERDON POR PERSONA  GJC0009
  6842* Y NO POR CUENTA                                                 GJC0009
  6843*PER                PERFORM 200760-LLENAR-VEC-MORAS-PERS          GJC0009
  6844                 END-IF
  6845              END-IF
  6846           END-IF
  6847           READ MAESTRO-CREDIT NEXT
  6848                AT  END
  6849                    MOVE 9 TO TIPO-ID-ABD07
  6850           END-READ
  6851     END-PERFORM.
  6852
  6853******************************************************************
  6854*200720-AMNIST-OBLIGACIONES.                                     *
  6855* DETERMINA SI EXISTEN MORAS ACTUALES Y LOS REGISTROS CON MORA   *
  6856* CANCELADOS QUE CULPLIERON EL TIEMPO ESTIPULA EN LA LEY (1 AÑO) *
  6857******************************************************************
  6858 200720-AMNIST-OBLIGACIONES.
  6859     IF NOV-CART-CODINT-AMNIST21(NOV-REPORT-ABD07) = 12 OR 13
  6860                                                     OR 14 OR 15
  6861                                                     OR 09 OR 11
  6862        ADD 1 TO MORAS-ACTUAL-AMNIST21
  6863     END-IF
  6864     IF ESTADO-OBLIG-ABD07 = 10                                   GJC0011
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 119
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6865        ADD 1 TO MORAS-ACTUAL-AMNIST21                            GJC0011
  6866     END-IF                                                       GJC0011
  6867     IF MORAS-ACTUAL-AMNIST21 = ZEROS AND
  6868       ((MORA-MAXIMA-ABD07 > ZEROS OR MORA-MAXIMA-R-ABD07 > ZEROS)GJC0004
  6869        OR (NOV-REPORT-ABD07 = 03 OR 46))                         GJC0004
  6870        PERFORM 200740-VER-ANTIGUEDAD-MORAS
  6871     END-IF.
  6872
  6873******************************************************************
  6874*200740-VER-ANTIGUEDAD-MORAS.                                    *
  6875* DETERMINA SI HAY MORAS MAYORES O MENORES A UN AÑO              *
  6876******************************************************************
  6877 200740-VER-ANTIGUEDAD-MORAS.
  6878     MOVE ZEROS TO MESES-VEC-AMNIST21 VECT1-AMNIST21
  6879                   VECTOR-TOT-AMNIST21 MESES-GRC-AMNIST21
  6880                   VECT2-AMNIST21 VECT3-AMNIST21 VECT4-AMNIST21
  6881     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006
  6882     IF MESES-NOV-AMNIST21 >= 12
  6883        MOVE ZEROS TO MESES-VEC-AMNIST21
  6884     ELSE
  6885        COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -
  6886                MESES-NOV-AMNIST21
  6887     END-IF
  6888     IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21
  6889        COMPUTE MESES-GRC-AMNIST21 =
  6890             (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -
  6891             (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)
  6892     ELSE
  6893        MOVE ZEROS TO MESES-GRC-AMNIST21
  6894     END-IF
  6895        MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21
  6896        MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21
  6897        MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21
  6898        MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21
  6899        MOVE  1 TO K-AMNIST21
  6900        MOVE 12 TO L-AMNIST21
  6901        PERFORM UNTIL L-AMNIST21 = 0
  6902          MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO
  6903               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6904          ADD 1 TO K-AMNIST21
  6905          SUBTRACT 1 FROM L-AMNIST21
  6906        END-PERFORM
  6907        MOVE 12 TO L-AMNIST21
  6908        PERFORM UNTIL L-AMNIST21 = 0
  6909          MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO
  6910               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6911          ADD 1 TO K-AMNIST21
  6912          SUBTRACT 1 FROM L-AMNIST21
  6913        END-PERFORM
  6914        MOVE 12 TO L-AMNIST21
  6915        PERFORM UNTIL L-AMNIST21 = 0
  6916          MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO
  6917               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6918          ADD 1 TO K-AMNIST21
  6919          SUBTRACT 1 FROM L-AMNIST21
  6920        END-PERFORM
  6921        MOVE 12 TO L-AMNIST21
  6922        PERFORM UNTIL L-AMNIST21 = 0
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 120
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6923          MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO
  6924               VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  6925          ADD 1 TO K-AMNIST21
  6926          SUBTRACT 1 FROM L-AMNIST21
  6927        END-PERFORM
  6928        MOVE ZEROS TO SW-SALIR-VECT
  6929        PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL
  6930                X-AMNIST21 >  48 OR
  6931                MORAS-ACTUAL-AMNIST21 > ZEROS OR
  6932                SW-SALIR-VECT > ZEROS
  6933         IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR "3" OR "4"
  6934             IF FECHA-SYS-AMNIST21 > FECHA-GRACIA-AMNIST21
  6935                IF X-AMNIST21 < MESES-GRC-AMNIST21
  6936                   ADD  1  TO  MORAS-ACTUAL-AMNIST21
  6937                END-IF
  6938             END-IF
  6939             IF MORAS-ACTUAL-AMNIST21 = ZEROS
  6940                IF  X-AMNIST21 <= MESES-VEC-AMNIST21              CAV0003
  6941                    MOVE 1 TO CTAS-MEN12-AMNIST21
  6942                    MOVE 1 TO SW-SALIR-VECT
  6943                ELSE
  6944                    MOVE 1 TO CTAS-MAY12-AMNIST21
  6945                    MOVE 1 TO SW-SALIR-VECT
  6946                END-IF
  6947             END-IF
  6948         END-IF
  6949        END-PERFORM
  6950        IF X-AMNIST21 > 48 *> CASOS DE NO HAY MORA EN EL VECTOR
  6951           MOVE 1 TO CTAS-MAY12-AMNIST21
  6952        END-IF.                                                   GJC0005
  6953*****************************************************************
  6954*200745-CALCULAR-MESES-A-HOY.                             *
  6955*SE REALIZA EL CALCULO PARA DETERMINAR CUANTOS MESES DE DESACTUA-*
  6956*LIZACION O CIERRE TIENE LA CUENTA RESPECTO AL DIA DE HOY        *
  6957******************************************************************
  6958 200745-CALCULAR-MESES-A-HOY.                                     GJC0006
  6959     MOVE ZEROS              TO  FECHA-AUX-AMNIST21               GJC0006
  6960     MOVE FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21               GJC0006
  6961     PERFORM 200950-CONVIERTE-FECHA                               GJC0006
  6962     MOVE    ZEROS           TO  MESES-NOV-AMNIST21               GJC0006
  6963     COMPUTE MESES-NOV-AMNIST21 =                                 GJC0006
  6964          (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -            GJC0006
  6965          (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21).             GJC0006
  6966*****************************************************************
  6967*200760-LLENAR-VEC-MORAS-PERS.                             *
  6968*DE CADA CUENTA QUE SE VA LEYENDO SE TOMAN LAS MORAS Y SE VA LLE-*
  6969* NANDO EL VECTOR DE MORAS DE TODA LA PERSONA                    *
  6970******************************************************************
  6971 200760-LLENAR-VEC-MORAS-PERS.                                    GJC0006
  6972     MOVE 0 TO K-AMNIST21                                         GJC0006
  6973     IF MORA-MAXIMA-ABD07 > 0 OR MORA-MAXIMA-R-ABD07 > 0          GJC0006
  6974        MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21          GJC0006
  6975        MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21          GJC0006
  6976        MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21          GJC0006
  6977        MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21          GJC0006
  6978        MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO          GJC0006
  6979             MOR-EST-CTA-AMNIST21                                 GJC0006
  6980        PERFORM 200745-CALCULAR-MESES-A-HOY                       GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 121
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  6981        IF MESES-NOV-AMNIST21 < 100                               GJC0006
  6982           COMPUTE K-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006
  6983        ELSE                                                      GJC0006
  6984           MOVE 0 TO K-AMNIST21                                   GJC0006
  6985        END-IF                                                    GJC0006
  6986        MOVE 49 TO L-AMNIST21                                     GJC0006
  6987        PERFORM UNTIL K-AMNIST21 = 0 OR L-AMNIST21 = 0            GJC0006
  6988          IF VEC-MOR-IDE-13-AMNIST21(K-AMNIST21) = 5              GJC0006
  6989             IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5      GJC0006
  6990                MOVE  1 TO VEC-MOR-IDE-13-AMNIST21(K-AMNIST21)    GJC0006
  6991             END-IF                                               GJC0006
  6992          END-IF                                                  GJC0006
  6993          COMPUTE K-AMNIST21 = K-AMNIST21 - 1                     GJC0006
  6994          COMPUTE L-AMNIST21 = L-AMNIST21 - 1                     GJC0006
  6995        END-PERFORM                                               GJC0006
  6996        IF MOR-EST-CTA-AMNIST21 <> 5                              GJC0006
  6997           MOVE 100 TO L-AMNIST21                                 GJC0006
  6998           PERFORM VARYING K-AMNIST21 FROM 1 BY 1 UNTIL           GJC0006
  6999               K-AMNIST21 > MESES-NOV-AMNIST21 OR L-AMNIST21 = 0  GJC0006
  7000              MOVE 1 TO VEC-MOR-IDE-13-AMNIST21(L-AMNIST21)       GJC0006
  7001              COMPUTE L-AMNIST21 = L-AMNIST21 - 1                 GJC0006
  7002           END-PERFORM                                            GJC0006
  7003        END-IF                                                    GJC0006
  7004     END-IF.                                                      GJC0006
  7005******************************************************************
  7006*200800-RESTAURAR-REGISTROS.                                      *
  7007* RUTINA ENCARGADA DE LEER EL REGISTRO ORIGINAL PARA AMNISTIAR   *
  7008******************************************************************
  7009 200800-RESTAURAR-REGISTROS.
  7010     MOVE LLAVE-INI-AMNIST21 TO LLAVE-MAES-CREDIT
  7011     READ MAESTRO-CREDIT INVALID KEY
  7012           DISPLAY " ERROR READ ICMCRE "
  7013     END-READ
  7014     IF REG-SUSCRIPTOR-AMNISTIA21 <> REG-SUSCRIPTOR
  7015        MOVE REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR
  7016     END-IF.
  7017
  7018 200850-AMNISTIA-REGISTROS.
  7019******************************************************************
  7020*200850-AMNISTIA-REGISTROS.                                      *
  7021* RUTINA ENCARGADA DE VALIDAR SI APLICA O NO AMNISTIA AL RESGISTR*
  7022******************************************************************
  7023       MOVE ZEROS TO MESES-VEC-AMNIST21 MESES-GRC-AMNIST21
  7024                     VECT1-AMNIST21 VECT2-AMNIST21 VECT3-AMNIST21
  7025                     VECT4-AMNIST21 VECTOR-TOT-AMNIST21
  7026       MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21
  7027       MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02
  7028       READ SUSCRIPTOR  IGNORE LOCK
  7029            INVALID KEY MOVE 0 TO ESTADO-ABD02
  7030       END-READ
  7031       IF ESTADO-ABD02 = 1
  7032        IF TAB-VIG-CART-AMNIST21(NOV-REPORT-ABD07) = 0 OR
  7033           ((NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16) OR          CAV0002
  7034            (NOV-REPORT-R-ABD07 = 13 OR 14 OR 15 OR 16))          CAV0002
  7035          IF ((MORA-MAXIMA-ABD07 > ZEROS OR                       GJC0004
  7036              MORA-MAXIMA-R-ABD07 > ZEROS) OR                     GJC0004
  7037               (NOV-REPORT-ABD07 = 03 OR 46)) AND                 GJC0004
  7038              IND-BLOQUEO-ABD07 = 0                               CAV0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 122
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7039           MOVE  ZEROS              TO  FECHA-AUX-AMNIST21
  7040           MOVE  FEC-NOVEDAD-ABD07  TO  FECHA-AUX-AMNIST21
  7041           PERFORM 200950-CONVIERTE-FECHA
  7042           MOVE    ZEROS            TO  MESES-NOV-AMNIST21
  7043           COMPUTE MESES-NOV-AMNIST21 =
  7044                   (ANO-HOY-AMNIST21 * 12 + MES-HOY-AMNIST21) -
  7045                   (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21)
  7046           IF MESES-NOV-AMNIST21 >= 12
  7047              MOVE ZEROS TO MESES-VEC-AMNIST21
  7048           ELSE
  7049           COMPUTE MESES-VEC-AMNIST21 = MESES-CANCELAC-AMNIST21 -
  7050                   MESES-NOV-AMNIST21
  7051           END-IF
  7052           IF FEC-NOVEDAD-AMNIST21 > FECHA-GRACIA-AMNIST21
  7053              COMPUTE MESES-GRC-AMNIST21 =
  7054                 (ANO-NOV-AMNIST21 * 12 + MES-NOV-AMNIST21) -
  7055                 (ANO-GRACIA-AMNIST21 * 12 + MES-GRACIA-AMNIST21)
  7056           ELSE
  7057              MOVE ZEROS TO MESES-GRC-AMNIST21
  7058           END-IF
  7059           MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21
  7060           MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21
  7061           MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21
  7062           MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21
  7063           MOVE  1 TO K-AMNIST21
  7064           MOVE 12 TO L-AMNIST21
  7065           PERFORM UNTIL L-AMNIST21 = 0
  7066             MOVE VECT1-AMNIST21 (L-AMNIST21:1) TO
  7067                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7068             ADD 1 TO K-AMNIST21
  7069             SUBTRACT 1 FROM L-AMNIST21
  7070           END-PERFORM
  7071           MOVE 12 TO L-AMNIST21
  7072           PERFORM UNTIL L-AMNIST21 = 0
  7073             MOVE VECT2-AMNIST21 (L-AMNIST21:1) TO
  7074                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7075             ADD 1 TO K-AMNIST21
  7076             SUBTRACT 1 FROM L-AMNIST21
  7077           END-PERFORM
  7078           MOVE 12 TO L-AMNIST21
  7079           PERFORM UNTIL L-AMNIST21 = 0
  7080             MOVE VECT3-AMNIST21 (L-AMNIST21:1) TO
  7081                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7082             ADD 1 TO K-AMNIST21
  7083             SUBTRACT 1 FROM L-AMNIST21
  7084           END-PERFORM
  7085           MOVE 12 TO L-AMNIST21
  7086           PERFORM UNTIL L-AMNIST21 = 0
  7087             MOVE VECT4-AMNIST21 (L-AMNIST21:1) TO
  7088                  VECTOR-TOT-AMNIST21 (K-AMNIST21:1)
  7089             ADD 1 TO K-AMNIST21
  7090             SUBTRACT 1 FROM L-AMNIST21
  7091           END-PERFORM
  7092           MOVE ZEROS TO SW-SALIR-VECT
  7093           PERFORM VARYING X-AMNIST21 FROM 1 BY 1 UNTIL
  7094                   X-AMNIST21 >  48 OR
  7095                   SW-SALIR-VECT > ZEROS
  7096             IF V-VEC-AMNIST21(X-AMNIST21) = "1" OR "2" OR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 123
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7097                                             "3" OR "4"
  7098                   IF X-AMNIST21 <= MESES-VEC-AMNIST21            CAV0003
  7099                      MOVE 1 TO SW-SALIR-VECT
  7100                   ELSE
  7101                        PERFORM 200870-APLICA-AMNISTIA            GJC0006
  7102                        MOVE 1 TO SW-SALIR-VECT                   GJC0004
  7103                   END-IF
  7104             END-IF
  7105           END-PERFORM
  7106           IF X-AMNIST21 > 48    *> CASOS EN QUE NO HAY MORA EN
  7107              PERFORM 200870-APLICA-AMNISTIA *>  EL VECTOR        GJC0006
  7108           END-IF
  7109          END-IF
  7110        END-IF
  7111       END-IF
  7112       MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.
  7113
  7114******************************************************************
  7115*200870-APLICA-AMNISTIA.                                         *
  7116* RUTINA ENCARGADA DE APLICAR LA AMNISTIA AL REGISTRO            *
  7117******************************************************************
  7118 200870-APLICA-AMNISTIA.                                          GJC0006
  7119     INITIALIZE VECTOR1-AMNIST21 VECTOR2-AMNIST21
  7120     MOVE 0 TO NUM-MORAS30-ABD07
  7121     MOVE 0 TO MORA-MAXIMA-ABD07
  7122     MOVE 0 TO FECHA-MORA-MAXIMA-ABD07
  7123     IF ADJETIVO1-ABD07 > 1
  7124        MOVE 0        TO ADJETIVO1-ABD07
  7125     END-IF
  7126     IF ADJETIVO2-ABD07 > 1
  7127            MOVE 0        TO ADJETIVO2-ABD07
  7128     END-IF
  7129     IF ADJETIVO3-ABD07 > 1
  7130            MOVE 0        TO ADJETIVO3-ABD07
  7131     END-IF
  7132     IF NOV-REPORT-ABD07 = 46
  7133        IF COD-CTA-ABD07 = 02
  7134           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7135        ELSE
  7136           MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7137        END-IF
  7138     ELSE
  7139        IF NOV-REPORT-ABD07 = 03
  7140           MOVE 06 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7141        ELSE
  7142           IF NOV-REPORT-ABD07 = 09 OR 10 OR 11 OR 12
  7143              MOVE 08 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7144           ELSE
  7145              IF NOV-REPORT-ABD07 = 13 OR 14 OR 15 OR 16
  7146                 MOVE 01 TO NOV-REPORT-ABD07 NOV-REPORT-R-ABD07
  7147              END-IF
  7148           END-IF
  7149        END-IF
  7150     END-IF
  7151     MOVE ESTADO-MES-ABD07   TO VECTOR1-AMNIST21
  7152     MOVE VECTOR-2-ABD07     TO VECTOR2-AMNIST21
  7153     MOVE VECTOR-HIS-3-ABD07 TO VECTOR3-AMNIST21
  7154     MOVE VECTOR-HIS-4-ABD07 TO VECTOR4-AMNIST21
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 124
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7155     INSPECT VECTOR1-AMNIST21 REPLACING ALL "1" BY "8"
  7156     INSPECT VECTOR1-AMNIST21 REPLACING ALL "2" BY "8"
  7157     INSPECT VECTOR1-AMNIST21 REPLACING ALL "3" BY "8"
  7158     INSPECT VECTOR1-AMNIST21 REPLACING ALL "4" BY "8"
  7159     INSPECT VECTOR2-AMNIST21 REPLACING ALL "1" BY "8"
  7160     INSPECT VECTOR2-AMNIST21 REPLACING ALL "2" BY "8"
  7161     INSPECT VECTOR2-AMNIST21 REPLACING ALL "3" BY "8"
  7162     INSPECT VECTOR2-AMNIST21 REPLACING ALL "4" BY "8"
  7163     INSPECT VECTOR3-AMNIST21 REPLACING ALL "1" BY "8"
  7164     INSPECT VECTOR3-AMNIST21 REPLACING ALL "2" BY "8"
  7165     INSPECT VECTOR3-AMNIST21 REPLACING ALL "3" BY "8"
  7166     INSPECT VECTOR3-AMNIST21 REPLACING ALL "4" BY "8"
  7167     INSPECT VECTOR4-AMNIST21 REPLACING ALL "1" BY "8"
  7168     INSPECT VECTOR4-AMNIST21 REPLACING ALL "2" BY "8"
  7169     INSPECT VECTOR4-AMNIST21 REPLACING ALL "3" BY "8"
  7170     INSPECT VECTOR4-AMNIST21 REPLACING ALL "4" BY "8"
  7171     MOVE VECTOR1-AMNIST21 TO ESTADO-MES-ABD07
  7172     MOVE VECTOR2-AMNIST21 TO VECTOR-2-ABD07.
  7173     MOVE VECTOR3-AMNIST21 TO VECTOR-HIS-3-ABD07
  7174     MOVE VECTOR4-AMNIST21 TO VECTOR-HIS-4-ABD07.
  7175*****************************************************************
  7176*200900-APLICAR-ART13-REGISTRO.                                         *
  7177* RUTINA ENCARGADA DE APLICAR PERDON CON 8 AL DOBLE DEL TIEMPO DE*
  7178* LA MORA (ARTICULO 13 DE LA LEY). PARA PERDONAR SE APOYA EN EL
  7179* VECTOR DE MORAS DE TODA LA PERSONA
  7180******************************************************************
  7181 200900-APLICAR-ART13-REGISTRO.                                   GJC0006
  7182     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006
  7183     MOVE  REG-SUSCRIPTOR    TO  REG-SUSCRIPTOR-AMNISTIA21        GJC0006
  7184     MOVE COD-SUS-ABD07 TO COD-SUSCRIP-ABD02                      GJC0006
  7185     IF IND-BLOQUEO-ABD07 = 0                                     GJC0006
  7186        READ SUSCRIPTOR  IGNORE LOCK                              GJC0006
  7187           INVALID KEY MOVE 0 TO ESTADO-ABD02                     GJC0006
  7188       END-READ                                                   GJC0006
  7189       IF ESTADO-ABD02 = 1                                        GJC0006
  7190* PRIMERO SE REVISA SI ES DUDOSO RECAUDO O CAN MM CON MORA EN 0   GJC0006
  7191* SE CAMBIA EL ESTADO SIN MÁS ANALISIS                            GJC0006
  7192          IF (NOV-REPORT-ABD07 = 46 OR NOV-REPORT-ABD07 = 03) AND GJC0006
  7193             (MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0)  GJC0006
  7194            IF NOV-REPORT-ABD07 = 03                              GJC0006
  7195               MOVE 06 TO NOV-REPORT-ABD07                        GJC0006
  7196                         NOV-REPORT-R-ABD07                       GJC0006
  7197            ELSE                                                  GJC0006
  7198              IF COD-CTA-ABD07 = 02                               GJC0006
  7199                 MOVE 06 TO NOV-REPORT-ABD07                      GJC0006
  7200                            NOV-REPORT-R-ABD07                    GJC0006
  7201              ELSE                                                GJC0006
  7202                 MOVE 08 TO NOV-REPORT-ABD07                      GJC0006
  7203                            NOV-REPORT-R-ABD07                    GJC0006
  7204              END-IF                                              GJC0006
  7205          ELSE                                                    GJC0006
  7206             IF MORA-MAXIMA-ABD07 = 0 AND MORA-MAXIMA-R-ABD07 = 0 GJC0006
  7207                MOVE 1 TO X-AMNIST21                              GJC0006
  7208             ELSE                                                 GJC0006
  7209                IF ESTADO-OBLIG-ABD07 <> 10                       GJC0011
  7210                   PERFORM 200930-ART13-CTA-CON-MORA              GJC0011
  7211                ELSE                                              GJC0011
  7212                   MOVE VECTOR-HIS-1-ABD07  TO VECT1-AMNIST21     GJC0011
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 125
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7213                   MOVE VECTOR-HIS-2-ABD07  TO VECT2-AMNIST21     GJC0011
  7214                   MOVE VECTOR-HIS-3-ABD07  TO VECT3-AMNIST21     GJC0011
  7215                   MOVE VECTOR-HIS-4-ABD07  TO VECT4-AMNIST21     GJC0011
  7216                   PERFORM VARYING L-AMNIST21 FROM 1 BY 1         GJC0011
  7217                        UNTIL L-AMNIST21 >12                      GJC0011
  7218                     IF (VECT1-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7219                                               4 AND <> 0) OR     GJC0011
  7220                        (VECT2-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7221                                               4 AND <> 0) OR     GJC0011
  7222                        (VECT3-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7223                                               4 AND <> 0) OR     GJC0011
  7224                        (VECT4-AMNIST21(L-AMNIST21:1) <>          GJC0011
  7225                                               4 AND <> 0)        GJC0011
  7226                        MOVE 100 TO L-AMNIST21                    GJC0011
  7227                    END-IF                                        GJC0011
  7228                   END-PERFORM                                    GJC0011
  7229                   IF L-AMNIST21 >= 100                           GJC0011
  7230                      PERFORM 200930-ART13-CTA-CON-MORA           GJC0011
  7231                   END-IF                                         GJC0011
  7232                END-IF                                            GJC0011
  7233             END-IF                                               GJC0006
  7234          END-IF                                                  GJC0006
  7235     END-IF                                                       GJC0006
  7236* SE RECUPERA EL REGISTRO DE SUSCRIPTOR QUE ESTABA LEIDO          GJC0006
  7237     MOVE  REG-SUSCRIPTOR-AMNISTIA21 TO REG-SUSCRIPTOR.           GJC0006
  7238*****************************************************************
  7239*200930-APLICAR-ART13-CTA-CON-MORA.                               *
  7240* A ESTA RUTINA SOLO LLEGAN CUENTAS QUE HAYAN TENIDO MORA.SU OBJE-*
  7241* TIVO ES VERIFICAR QUE LAPSOS DE MORA SE PUEDEN PERDONAR Y QUE   *
  7242* LAPSOS NO
  7243******************************************************************
  7244 200930-ART13-CTA-CON-MORA.                                       GJC0006
  7245     MOVE 0 TO CTA-PERDONADA-AMNIST21                             GJC0006
  7246     INITIALIZE K-AMNIST21 L-AMNIST21 Z-AMNIST21 X-AMNIST21       GJC0006
  7247                 M-AMNIST21                                       GJC0006
  7248                 IND-APLICO-CAD-AMNIST21                          GJC0012
  7250     INITIALIZE VECTOR-100-CTA-AMNIST21 REPLACING                 GJC0006
  7251             ALPHANUMERIC DATA BY CINCOS-AMNIST21(1:100)          GJC0006
  7252     PERFORM 200745-CALCULAR-MESES-A-HOY                          GJC0006
  7253     MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21             GJC0006
  7254     MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21             GJC0006
  7255     MOVE VECTOR-HIS-3-ABD07 TO VECTOR-3-CTA-AMNIST21             GJC0006
  7256     MOVE VECTOR-HIS-4-ABD07 TO VECTOR-4-CTA-AMNIST21             GJC0006
  7257     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0006
  7258          MOR-EST-CTA-AMNIST21                                    GJC0006
  7259*    PRIMERO SE LLENA EL VECTOR DE LA CUENTA EN 100 POSICIONES    GJC0006
  7260     IF MESES-NOV-AMNIST21 < 52                                   GJC0006
  7261        COMPUTE POSICION-INI-AMNIST21 = 52 - MESES-NOV-AMNIST21   GJC0006
  7262        MOVE POSICION-INI-AMNIST21 TO K-AMNIST21                  GJC0006
  7263        MOVE VECTOR-TOT-CTA-AMNIST21 TO                           GJC0006
  7264             VECTOR-100-CTA-AMNIST21(K-AMNIST21:49)               GJC0006
  7265             COMPUTE Z-AMNIST21 = K-AMNIST21 + 49                 GJC0006
  7266     ELSE                                                         GJC0006
  7267        PERFORM 200933-CADUCAR-MORAS                              GJC0012
  7268        MOVE  1 TO POSICION-INI-AMNIST21                          GJC0006
  7269        IF MESES-NOV-AMNIST21 <  100    *> <=                     GJC0006
  7270           COMPUTE L-AMNIST21 = 100 - MESES-NOV-AMNIST21          GJC0006
  7271              COMPUTE K-AMNIST21 = 50 - L-AMNIST21    *>49        GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 126
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7272            MOVE VECTOR-TOT-CTA-AMNIST21(K-AMNIST21:L-AMNIST21) TOGJC0006
  7273                VECTOR-100-CTA-AMNIST21(1:L-AMNIST21)             GJC0006
  7274              COMPUTE Z-AMNIST21 = L-AMNIST21 + 1                 GJC0006
  7275        ELSE                                                      GJC0006
  7276           MOVE 1 TO Z-AMNIST21 K-AMNIST21                        GJC0006
  7277        END-IF                                                    GJC0006
  7278     END-IF                                                       GJC0006
  7279* SI EL ESTADO ACTUAL DE LA CUENTA ES MOROSO SE RELLENA DE MORAS  GJC0009
  7280* HASTA LA POSICION 100                                           GJC0009
  7281     IF (NOV-REPORT-ABD07 > 12 AND < 46) OR                       GJC0009
  7282        NOV-REPORT-ABD07 = 47                                     GJC0009
  7283        PERFORM UNTIL Z-AMNIST21 > 100                            GJC0006
  7284           IF NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) <> 5       GJC0008
  7285              MOVE 1 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)          GJC0009
  7286           ELSE                                                   GJC0008
  7287             MOVE 2 TO VEC-100-CTA-AMNIST21(Z-AMNIST21)           GJC0008
  7288           END-IF                                                 GJC0008
  7289          ADD 1 TO Z-AMNIST21                                     GJC0006
  7290        END-PERFORM                                               GJC0006
  7291     ELSE
  7292        MOVE 1 TO  VEC-100-CTA-AMNIST21(100)
  7293     END-IF                                                       GJC0006
  7294* SE REEEMPLAZAN EN EL VECTOR LAS POSICONES QUE NO SON MORA POR   GJC0009
  7295* AL DIA                                                          GJC0009
  7296     MOVE 1 TO VEC-100-CTA-AMNIST21(101)                          GJC0006
  7297     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "0" BY "5"    GJC0006
  7298     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "6" BY "5"    GJC0006
  7299     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "7" BY "5"    GJC0006
  7300     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "8" BY "5"    GJC0006
  7301     INSPECT VECTOR-100-CTA-AMNIST21 REPLACING  ALL "9" BY "5"    GJC0006
  7302* SE INICIA EL RECORRIDO PARA HALLAR LOS LAPOS DE MORA Y LA MORA  GJC0006
  7303* CORRIDA                                                         GJC0006
  7304     MOVE 0 TO LAPSO-AMNIST21                                     GJC0006
  7305     MOVE 0 TO MAYOR-LAPSO-AMNIST21 SALIR-AMNIST21                GJC0006
  7306               ESTOY-MOROSO-AMNIST21 MESES-MORAS-AMNIST21         GJC0006
  7307     PERFORM VARYING Z-AMNIST21 FROM 1 BY 1 UNTIL Z-AMNIST21 > 30 GJC0006
  7308             MOVE ZEROS TO VECTOR-LAPSOS(Z-AMNIST21)              GJC0006
  7309     END-PERFORM                                                  GJC0006
  7310     PERFORM UNTIL K-AMNIST21 > 101 OR SALIR-AMNIST21 = 1         GJC0006
  7311        IF ESTOY-MOROSO-AMNIST21 = 1                              GJC0006
  7312           IF VEC-100-CTA-AMNIST21(K-AMNIST21) <> 5               GJC0006
  7313              ADD 1 TO MESES-MORAS-AMNIST21                       GJC0006
  7314           ELSE                                                   GJC0006
  7315              MOVE 0 TO ESTOY-MOROSO-AMNIST21                     GJC0006
  7316             MOVE K-AMNIST21 TO L-AMNIST21                        GJC0006
  7317           END-IF                                                 GJC0006
  7318        ELSE                                                      GJC0006
  7319           IF VEC-100-CTA-AMNIST21(K-AMNIST21) > 0 AND < 5        GJC0006
  7320              IF MESES-MORAS-AMNIST21 > 0                         GJC0006
  7321                 MOVE MESES-MORAS-AMNIST21 TO                     GJC0006
  7322                 LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)              GJC0006
  7323                 PERFORM 200935-VER-SI-DOBLE-MORA                 GJC0006
  7324              END-IF                                              GJC0006
  7325              ADD 1 TO LAPSO-AMNIST21                             GJC0006
  7326              MOVE 1 TO MESES-MORAS-AMNIST21                      GJC0006
  7327              MOVE 1 TO ESTOY-MOROSO-AMNIST21                     GJC0006
  7328              MOVE K-AMNIST21 TO                                  GJC0006
  7329                   INI-GRUPO-AMNIST21(LAPSO-AMNIST21)             GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 127
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7330              MOVE 0 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006
  7331           END-IF                                                 GJC0006
  7332        END-IF                                                    GJC0006
  7333        ADD 1 TO K-AMNIST21                                       GJC0006
  7334     END-PERFORM                                                  GJC0006
  7335     COMPUTE L-AMNIST21 = LAPSO-AMNIST21 + 1                      GJC0006
  7336     IF CTA-PERDONADA-AMNIST21 = 1 OR IND-APLICO-CAD-AMNIST21 = 1 GJC0012
  7337        PERFORM 200940-PERDONAR-VECTOR-CTA                        GJC0006
  7338        MOVE VECTOR-4-CTA-AMNIST21 TO VECTOR-HIS-4-ABD07          GJC0006
  7339        MOVE VECTOR-3-CTA-AMNIST21 TO VECTOR-HIS-3-ABD07          GJC0006
  7340        MOVE VECTOR-2-CTA-AMNIST21 TO VECTOR-HIS-2-ABD07          GJC0006
  7341        MOVE VECTOR-1-CTA-AMNIST21 TO VECTOR-HIS-1-ABD07          GJC0006
  7342        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0006
  7343        PERFORM 555000-MANEJO-RECUP-Y-MM                          GJC0007
  7344     END-IF.                                                      GJC0006
  7345
  7346******************************************************************
  7347*200933-CADUCAR-MORAS                                            *
  7348* A LAS CUENTAS CUYO VECTOR DE COMPORTAMIENTO NO CABE EN LAS 100
  7349* POSICIONES DEL VECTOR EN QUE SE CALCULA LA APLICACION DEL AR-  *
  7350* TICULO 13 SE APLICA LA CADUCIDAD SOBRE LO QUE LLEVA MAS DE
  7351* 48 MESES
  7352******************************************************************
  7353 200933-CADUCAR-MORAS.                                            GJC0012
  7354     IF NOV-REPORT-ABD07 < 13 OR  = 46                            GJC0012
  7355      PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 48GJC0012
  7356       IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5            GJC0012
  7357          MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)              GJC0012
  7358          IF IND-APLICO-CAD-AMNIST21 = 0                          GJC0012
  7359             MOVE 1 TO IND-APLICO-CAD-AMNIST21                    GJC0012
  7360          END-IF                                                  GJC0012
  7361       END-IF                                                     GJC0012
  7362      END-PERFORM                                                 GJC0012
  7363     END-IF.                                                      GJC0012
  7364
  7365******************************************************************
  7366*200935-VER-SI-DOBLE-MORA                                          *
  7367* VALIDA SI SE PUEDE PERDONAR O NO EL PERIODO DE GRACIA QUE SE
  7368*ESTÁ ANALIZANDO*
  7369******************************************************************
  7370 200935-VER-SI-DOBLE-MORA.                                        GJC0006
  7371     IF MESES-MORAS-AMNIST21 >  MAYOR-LAPSO-AMNIST21              GJC0006
  7372        COMPUTE X-AMNIST21 = (MESES-MORAS-AMNIST21 * 2) *> OJO + 1GJC0006
  7373     ELSE                                                         GJC0006
  7374        COMPUTE X-AMNIST21 = (MAYOR-LAPSO-AMNIST21 * 2) *> OJO + 1GJC0006
  7375     END-IF                                                       GJC0006
  7376     IF X-AMNIST21 > 48                                           GJC0011
  7377       MOVE 48 TO X-AMNIST21                                      GJC0011
  7378     END-IF                                                       GJC0011
  7379     IF X-AMNIST21 <= 101 - L-AMNIST21                            GJC0006
  7380        MOVE 0 TO M-AMNIST21                                      GJC0006
  7381        INSPECT VECTOR-100-CTA-AMNIST21(L-AMNIST21:X-AMNIST21)    GJC0006
  7382             TALLYING M-AMNIST21 FOR ALL                          GJC0006
  7383                      CINCOS-AMNIST21(1:X-AMNIST21)               GJC0006
  7384        IF M-AMNIST21 > 0                                         GJC0006
  7385* LAS 2 SIGUIENTES INSTRUCCIONES Y EL ELSE DEL IF SE DEBEN DESCO- GJC0009
  7386* MENTAREAR SI SE DECIDE APLICAR ARTICULO 13 POR PERSONA CUENTA   GJC0009
  7387*PER       COMPUTE MESES-AMNIST21 = L-AMNIST21 + X-AMNIST21 - 1   GJC0009
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 128
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7388*PER       IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21) = 5         GJC0009
  7389              MOVE 1 TO PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)     GJC0006
  7390              MOVE 1 TO CTA-PERDONADA-AMNIST21                    GJC0006
  7391              IF LAPSO-AMNIST21 > 1                               GJC0006
  7392                 COMPUTE Z-AMNIST21 = LAPSO-AMNIST21 - 1          GJC0006
  7393                 PERFORM UNTIL Z-AMNIST21 = 0                     GJC0006
  7394                    IF PERDON-GRUPO-AMNIST21(Z-AMNIST21) = 0      GJC0006
  7395                       MOVE 1 TO                                  GJC0006
  7396                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)        GJC0006
  7397                       COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1        GJC0006
  7398                    ELSE                                          GJC0006
  7399                       MOVE 0 TO Z-AMNIST21                       GJC0006
  7400                    END-IF                                        GJC0006
  7401                 END-PERFORM                                      GJC0006
  7402                 MOVE 0 TO MAYOR-LAPSO-AMNIST21                   GJC0006
  7403              END-IF                                              GJC0006
  7404*PER       ELSE                                                   GJC0009
  7405*PER          COMPUTE X-AMNIST21 =  X-AMNIST21 + L-AMNIST21       GJC0009
  7406*PER          ADD 1 TO  MESES-AMNIST21                            GJC0009
  7407*PER          PERFORM UNTIL X-AMNIST21 > 100 OR                   GJC0009
  7408*PER               PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)= 1       GJC0009
  7409*PER             IF VEC-100-CTA-AMNIST21(X-AMNIST21) = "5" OR "2" GJC0009
  7410*PER                IF VEC-MOR-IDE-13-AMNIST21(MESES-AMNIST21)    GJC0009
  7411*PER                      = "5"                                   GJC0009
  7412*PER                   MOVE 1 TO                                  GJC0009
  7413*PER                         PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21)GJC0009
  7414*PER                   MOVE 1 TO CTA-PERDONADA-AMNIST21           GJC0009
  7415*PER                   IF LAPSO-AMNIST21 > 1                      GJC0009
  7416*PER                      MOVE LAPSO-AMNIST21 TO Z-AMNIST21       GJC0009
  7417*PER                      PERFORM UNTIL Z-AMNIST21 = 0            GJC0009
  7418*PER                         MOVE 1 TO                            GJC0009
  7419*PER                         PERDON-GRUPO-AMNIST21(Z-AMNIST21)    GJC0009
  7420*PER                         COMPUTE Z-AMNIST21 = Z-AMNIST21 - 1  GJC0009
  7421*PER                      END-PERFORM                             GJC0009
  7422*PER                      MOVE 0 TO MAYOR-LAPSO-AMNIST21          GJC0009
  7423*PER                   END-IF                                     GJC0009
  7424*PER                END-IF                                        GJC0009
  7425*PER             ELSE                                             GJC0009
  7426*PER               MOVE 105 TO X-AMNIST21                         GJC0009
  7427*PER             END-IF                                           GJC0009
  7428*PER             ADD 1 TO X-AMNIST21                              GJC0009
  7429*PER             ADD 1 TO MESES-AMNIST21                          GJC0009
  7430*PER          END-PERFORM                                         GJC0009
  7431*PER       END-IF                                                 GJC0009
  7432        ELSE                                                      GJC0006
  7433          IF MAYOR-LAPSO-AMNIST21 <                               GJC0006
  7434             LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)                  GJC0006
  7435              MOVE LONG-GRUPO-AMNIST21(LAPSO-AMNIST21) TO         GJC0006
  7436                                    MAYOR-LAPSO-AMNIST21          GJC0006
  7437          END-IF                                                  GJC0006
  7438        END-IF                                                    GJC0006
  7439     ELSE
  7440        MOVE 1 TO SALIR-AMNIST21                                  GJC0006
  7441     END-IF.                                                      GJC0006
  7442
  7443******************************************************************
  7444*200940-PERDONAR-VECTOR-CTA.                                     *
  7445* SE HACE EL PERDOS SOBRE CADA UNO DE LOS LAPSOS DE MORA SOBRE   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 129
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7446* LOS QUE LA CUENTA TIENE DERECHO A PERDON
  7447******************************************************************
  7448 200940-PERDONAR-VECTOR-CTA.                                      GJC0006
  7449     PERFORM VARYING LAPSO-AMNIST21 FROM 1 BY 1 UNTIL             GJC0006
  7450        LAPSO-AMNIST21 > 30                                       GJC0006
  7451       IF PERDON-GRUPO-AMNIST21(LAPSO-AMNIST21) = 1               GJC0006
  7452          COMPUTE Z-AMNIST21 = INI-GRUPO-AMNIST21(LAPSO-AMNIST21) GJC0006
  7453                             - POSICION-INI-AMNIST21 + 1          GJC0006
  7454          MOVE 0 TO K-AMNIST21                                    GJC0006
  7455          PERFORM VARYING L-AMNIST21 FROM                         GJC0006
  7456            Z-AMNIST21 BY 1 UNTIL                                 GJC0006
  7457                K-AMNIST21 = LONG-GRUPO-AMNIST21(LAPSO-AMNIST21)  GJC0006
  7458            IF VEC-TOT-CTA-AMNIST21(L-AMNIST21) > 0 AND < 5       GJC0006
  7459               MOVE 8 TO VEC-TOT-CTA-AMNIST21(L-AMNIST21)         GJC0006
  7460            END-IF                                                GJC0006
  7461            ADD 1 TO K-AMNIST21                                   GJC0006
  7462          END-PERFORM                                             GJC0006
  7463       ELSE                                                       GJC0006
  7464          MOVE 51 TO LAPSO-AMNIST21                               GJC0006
  7465       END-IF                                                     GJC0006
  7466     END-PERFORM.                                                 GJC0006
  7467
  7468******************************************************************
  7469*50000-RECONSTRUCCION-HISTORIA.
  7470*VOLTEA LOS VECTORES Y LLAMA A LAS RUTINAS QUE RECALCULAN EL ESTADO
  7471*DEJANDO FINALMENTE LOS VECTORES COMO DEBEN QUEDAR
  7472******************************************************************
  7473 500000-RECONSTRUCCION-HISTORIA.                                  GJC0006
  7474     MOVE 0 TO MES-MORA-MAX-AMNIST21  MES-MORA-MAX-48-AMNIST21.   GJC0006
  7475     INITIALIZE FEC-MORMAX-AMNIST21 FEC-MORMAX-48-AMNIST21.       GJC0006
  7476     MOVE NOV-REPORT-ABD07 TO ESTADO-AMNIST21 ESTADO-FIN-AMNIST21 GJC0006
  7477     MOVE FEC-NOVEDAD-ABD07 TO  FEC-MM-AA-AMNIST21                GJC0006
  7478     IF FEC-MM-AA-AMNIST21 (3:2) > 60                             GJC0006
  7479        MOVE 19 TO SIGLO-AMNIST21                                 GJC0006
  7480     ELSE                                                         GJC0006
  7481        MOVE 20 TO SIGLO-AMNIST21                                 GJC0006
  7482     END-IF                                                       GJC0006
  7483     MOVE FEC-MM-AA-AMNIST21 (1:2)  TO MES-AMNIST21               GJC0006
  7484     MOVE FEC-MM-AA-AMNIST21 (3:2)  TO ANO-AMNIST21               GJC0006
  7485     MOVE FECHA-AMNIST21  TO FEC-INI-MOR-AMNIST21.                GJC0006
  7486     PERFORM 500500-NUEVA-NOVEDAD                                 GJC0006
  7487     PERFORM 500600-CALCULO-FECHAMX                               GJC0006
  7488*    IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007
  7489*       (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007
  7490*       IF ESTADO-FIN-AMNIST21 = 03                               GJC0007
  7491*          MOVE 06 TO NOV-REPORT-ABD07                            GJC0007
  7492*                     NOV-REPORT-R-ABD07                          GJC0007
  7493*       ELSE                                                      GJC0007
  7494*          IF COD-CTA-ABD07 = 02                                  GJC0007
  7495*             MOVE 06 TO NOV-REPORT-ABD07                         GJC0007
  7496*                     NOV-REPORT-R-ABD07                          GJC0007
  7497*          ELSE                                                   GJC0007
  7498*             MOVE 08 TO NOV-REPORT-ABD07                         GJC0007
  7499*                        NOV-REPORT-R-ABD07                       GJC0007
  7500*          END-IF                                                 GJC0007
  7501*     ELSE *> LINEAS CONVERTIDAS EN RUT 555000-MANEJO-RECUP-Y-MM  GJC0007
  7502*       MOVE ESTADO-FIN-AMNIST21 TO NOV-REPORT-ABD07              GJC0012
  7503        MOVE ESTADO-FIN48-AMNIST21 TO NOV-REPORT-R-ABD07          GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 130
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7504                                      NOV-REPORT-ABD07            GJC0012
  7505*     END-IF                                                      GJC0007
  7506*    MOVE FEC-MORMAX-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07          GJC0006
  7507*    MOVE NUM-MOR30-AMNIST21 TO NUM-MORAS30-ABD07                 GJC0006
  7508     MOVE FEC-MORMAX-48-AMNIST21 TO FECHA-MORA-MAXIMA-ABD07       GJC0006
  7509*    MOVE MORMAX-AMNIST21 TO MORA-MAXIMA-ABD07.                   GJC0006
  7510     MOVE MORMAX48-AMNIST21 TO MORA-MAXIMA-R-ABD07                GJC0006
  7511                               MORA-MAXIMA-ABD07.                 GJC0006
  7512     MOVE NUM-MOR30-48-AMNIST21 TO NUM-MORAS30-ABD07.             GJC0006
  7513  500500-NUEVA-NOVEDAD.
  7514******************************************************************
  7515* 50500-NUEVA-NOVEDAD.
  7516* CON EL VECTOR DE COMPORTAMIENTO PERDONADO Y SEGÚN LA NOVEDAD
  7517* ACTUAL, CALCULA CON LA MATRIZ DE RECONSTRUCCIÓN HISTÓRICA
  7518* LA NUEVA NOVEDAD DE LA OBLIGACIÓN
  7519******************************************************************
  7520     MOVE 0 TO NUM-MOR30-AMNIST21  NUM-MOR30-48-AMNIST21          GJC0006
  7521     MOVE 0 TO MORMAX-AMNIST21 MORMAX48-AMNIST21                  GJC0006
  7522     MOVE 0 TO FEC-MORMAX-AMNIST21   FEC-MORMAX-48-AMNIST21       GJC0006
  7523     MOVE 01 TO ESTADO-INI-AMNIST21 ESTADO-INI48-AMNIST21         GJC0006
  7524     PERFORM VARYING L-AMNIST21 FROM 1 BY 1 UNTIL L-AMNIST21 > 49 GJC0006
  7525      MOVE VEC-TOT-CTA-AMNIST21(L-AMNIST21) TO K-AMNIST21         GJC0006
  7526      IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX48-AMNIST21        GJC0006
  7527      COMPUTE MES-MORA-MAX-48-AMNIST21 = (49 - L-AMNIST21) + 1    GJC0006
  7528         MOVE K-AMNIST21 TO MORMAX48-AMNIST21                     GJC0006
  7529      END-IF                                                      GJC0006
  7530      IF K-AMNIST21 = 1                                           GJC0006
  7531         ADD 1 TO NUM-MOR30-48-AMNIST21                           GJC0006
  7532      END-IF                                                      GJC0006
  7533      IF L-AMNIST21 > 24                                          GJC0006
  7534       IF K-AMNIST21 = 1                                          GJC0006
  7535          ADD 1 TO NUM-MOR30-AMNIST21                             GJC0006
  7536       END-IF                                                     GJC0006
  7537       IF K-AMNIST21 < 5 AND K-AMNIST21 > MORMAX-AMNIST21         GJC0006
  7538          COMPUTE  MES-MORA-MAX-AMNIST21 = (49 - L-AMNIST21) + 1  GJC0006
  7539          MOVE K-AMNIST21 TO MORMAX-AMNIST21                      GJC0006
  7540       END-IF                                                     GJC0006
  7541      END-IF                                                      GJC0006
  7542       IF L-AMNIST21 = 49                                         GJC0006
  7543          IF (ESTADO-AMNIST21 > 12 AND < 42) OR                   GJC0006
  7544             ESTADO-AMNIST21 = 01                                 GJC0006
  7545             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006
  7546             ESTADO-FIN-AMNIST21                                  GJC0006
  7547             MOVE                                                 GJC0006
  7548             NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,             GJC0006
  7549                             ESTADO-FIN-AMNIST21)                 GJC0006
  7550                           TO ESTADO-FIN-AMNIST21                 GJC0006
  7551             MOVE NOV-CART-MORA-AMNIST21(ESTADO-AMNIST21) TO      GJC0006
  7552                  ESTADO-FIN48-AMNIST21                           GJC0006
  7553             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,      GJC0006
  7554                  ESTADO-FIN48-AMNIST21) TO ESTADO-FIN48-AMNIST21 GJC0006
  7555          ELSE                                                    GJC0006
  7556             IF ESTADO-AMNIST21 > 07 AND < 13                     GJC0006
  7557                COMPUTE ESTADO-FIN-AMNIST21 =                     GJC0006
  7558                        08 + MORMAX-AMNIST21                      GJC0006
  7559                COMPUTE ESTADO-FIN48-AMNIST21 =                   GJC0006
  7560                        08 + MORMAX48-AMNIST21                    GJC0006
  7561             ELSE                                                 GJC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 131
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7562                MOVE ESTADO-AMNIST21 TO ESTADO-FIN-AMNIST21       GJC0006
  7563                MOVE ESTADO-AMNIST21 TO ESTADO-FIN48-AMNIST21     GJC0006
  7564             END-IF                                               GJC0006
  7565          END-IF                                                  GJC0006
  7566       ELSE                                                       GJC0006
  7567         IF K-AMNIST21 = 7 OR 8                                   GJC0006
  7568            MOVE 5 TO K-AMNIST21                                  GJC0006
  7569         END-IF                                                   GJC0006
  7570         IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                     GJC0006
  7571            MOVE NOV-CRUCES-AMNIST21(ESTADO-INI48-AMNIST21,       GJC0006
  7572                                       K-AMNIST21) TO             GJC0006
  7573                 ESTADO-INI48-AMNIST21                            GJC0006
  7574         END-IF                                                   GJC0006
  7575         IF L-AMNIST21 > 24                                       GJC0006
  7576          IF K-AMNIST21 > 0 AND K-AMNIST21 < 6                    GJC0006
  7577             MOVE NOV-CRUCES-AMNIST21(ESTADO-INI-AMNIST21,        GJC0006
  7578                 K-AMNIST21) TO ESTADO-INI-AMNIST21               GJC0006
  7579          END-IF                                                  GJC0006
  7580         END-IF                                                   GJC0006
  7581       END-IF                                                     GJC0006
  7582     END-PERFORM.                                                 GJC0006
  7583
  7584******************************************************************
  7585*500600-CALCULO-FECHAMX.
  7586* CON EL VECTOR YA PERDONADO, CALCULA LA NUEVA FECHA DE MORA
  7587* MÁXIMA
  7588******************************************************************
  7589 500600-CALCULO-FECHAMX.                                          GJC0006
  7590     IF MES-MORA-MAX-AMNIST21 > 0                                 GJC0006
  7591        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0006
  7592        MOVE 1 TO L-AMNIST21                                      GJC0006
  7593        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21=                GJC0006
  7594                MES-MORA-MAX-AMNIST21                             GJC0006
  7595**SE DEBE CONTROLAR SI L-AMNIST21SE PASA de 25  ******************GJC0006
  7596        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006
  7597        MOVE MES-AMNIST21   TO FEC-MM-AAAA-AMNIST21 (1:2)         GJC0006
  7598        MOVE FEC-MM-AAAA-AMNIST21  TO FEC-MORMAX-AMNIST21         GJC0006
  7599     END-IF.                                                      GJC0006
  7600     IF MES-MORA-MAX-48-AMNIST21 > 0                              GJC0006
  7601        MOVE FEC-INI-MOR-AMNIST21 TO FECHA-AMNIST21               GJC0010
  7602        MOVE 1 TO L-AMNIST21                                      GJC0006
  7603        PERFORM 510000-ADDUNOTOI UNTIL L-AMNIST21 =               GJC0006
  7604                                          MES-MORA-MAX-48-AMNIST21GJC0006
  7605        MOVE ANO-T-AMNIST21 TO FEC-MM-AAAA-AMNIST21 (3:4)         GJC0006
  7606        MOVE MES-AMNIST21  TO FEC-MM-AAAA-AMNIST21 (1:2)          GJC0006
  7607        MOVE FEC-MM-AAAA-AMNIST21 TO FEC-MORMAX-48-AMNIST21       GJC0006
  7608     END-IF.                                                      GJC0006
  7609 555000-MANEJO-RECUP-Y-MM.                                        GJC0007
  7610******************************************************************
  7611*555000-MANEJO-RECUP-Y-MM
  7612* SOLO SE DEBE INVOCAR CUANDO UNA CUANTA ES PERDONADA Y SIRVE PARA
  7613* DEJAR UNA CUENTA QUE FUE RECUPERADA O CANCELADA POR MAL MANEJO
  7614* EN PAGO VOLUNTARIO O CANCELADA VOL SI NO QUEDARON MORAS
  7615******************************************************************
  7616     IF (ESTADO-FIN-AMNIST21 = 46 OR ESTADO-FIN-AMNIST21 = 03) ANDGJC0007
  7617        (MORMAX-AMNIST21 = 0 AND MORMAX48-AMNIST21 = 0)           GJC0007
  7618        IF ESTADO-FIN-AMNIST21 = 03                               GJC0007
  7619           MOVE 06 TO NOV-REPORT-ABD07                            GJC0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 132
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/AMNI
  7620                      NOV-REPORT-R-ABD07                          GJC0007
  7621        ELSE                                                      GJC0007
  7622           IF COD-CTA-ABD07 = 02                                  GJC0007
  7623              MOVE 06 TO NOV-REPORT-ABD07                         GJC0007
  7624                      NOV-REPORT-R-ABD07                          GJC0007
  7625           ELSE                                                   GJC0007
  7626              MOVE 08 TO NOV-REPORT-ABD07                         GJC0007
  7627                         NOV-REPORT-R-ABD07                       GJC0007
  7628           END-IF                                                 GJC0007
  7629        END-IF                                                    GJC0007
  7630     END-IF.                                                      GJC0007
  7631********************************************************************
  7632*510000-ADDUNOTOI.
  7633* RETROCEDE UN MES EN EL TIEMPO TENIENDO EN CUENTA EL CAMBIO DE AÑO
  7634* Y SI LA INFORMACIÓN VALIDA DEL VECTOR HA TERMINADO, FINALIZA LA
  7635* REVISIÓN DE CADUCIDAD SOBRE EL VECTOR
  7636********************************************************************
  7637 510000-ADDUNOTOI.                                                GJC0006
  7638     ADD 1 TO L-AMNIST21                                          GJC0006
  7639     SUBTRACT 1 FROM MES-AMNIST21                                 GJC0006
  7640     IF MES-AMNIST21 = 0                                          GJC0006
  7641        MOVE 12 TO MES-AMNIST21                                   GJC0006
  7642        SUBTRACT 1 FROM ANO-T-AMNIST21                            GJC0006
  7643     END-IF.                                                      GJC0006
  7644
  7645******************************************************************
  7646*200950-CONVIERTE-FECHA                                          *
  7647* CONVIERTE FECHA DE FORMATO MMYY A YYYYMM                       *
  7648******************************************************************
  7649 200950-CONVIERTE-FECHA.
  7650     MOVE  MES-AUX-AMNIST21   TO  FMILENIO-MES-AMNIST21
  7651     MOVE  ANO-AUX-AMNIST21   TO  FMILENIO-ANIO-AMNIST21
  7652     IF ANO-AUX-AMNIST21   > 60
  7653        MOVE 19               TO  FMILENIO-SIGLO-AMNIST21
  7654     ELSE
  7655        MOVE 20               TO  FMILENIO-SIGLO-AMNIST21
  7656     END-IF
  7657     MOVE  FECHA-MILENIO-AMNIST21  TO  FEC-NOVEDAD-AMNIST21.
* 7658 COPY VALNOM.PROC.
  7659*VALNOM-PROC.v.0005
  7660******************************************************************
  7661* RUTINA CREADA PARA HACER LA VALIDACION DE NOMBRES CONTRA LOS
  7662* ARCHIVOS DE LA REGISTRADURIA, DIAN Y DAS, DEPENDIENDO DEL TIPO
  7663* DE IDENTIFICACION RECIBIDA.
  7664*    PARAMETROS
  7665*        BLOQUES-INPUT-VALNOM - NUMERO DE BLOQUES A VALIDAR
  7666*        NOMBRE-INPUT-VALNOM  - NOMBRE A VALIDAR
  7667*        NOMBOK-INPUT-VALNOM  - NOMBRE CORRECTO CON EL QUE SE
  7668*                               DEBE COMPARAR NOMBRE-INPUT-VALNOM
  7669*        TIP-ID-INPUT-VALNOM  - TIPO DE IDENTIFICACION A VALIDAR
  7670*    SALIDAS:
  7671*        MATCH-OK-OUT-VALNOM  - 0-NO HUBO       1-HUBO
  7672*******************************************************************
  7673* RMB0002   * VAL001: SE MEJORA LA VALIDACION DE NOMBRES EN PERSONAS
  7674* R.MARTINEZ* JURIDICAS
  7675* DIC.2002  *
  7676*******************************************************************
  7677* GJC0003    * VALMEJ :SE CREAN ANUEVOS CAMPOS PARA MEJORAR LA VALIDACION
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 133
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7678* G.JIMENEZ  * DE NIT. PARA MEJORA TAMBIEN SE AMPLIA TAMANO DE VARIABLES
  7679* MARZO/2003 * PARA CEDULAS, EL COMODIN QUE USUALMENTE CORRESPONDE A LA N
  7680*            * SOLO SE COMPARA CONTRA N O CONTRA BLANCOS
  7681*************************************************************************
  7682* GJC0004    * VALME1 :CON EL FIN DE AFINAR AUN MAS EL PROCESO DE VALIDA-
  7683* R.MARTINEZ * CION DE NOMBRES, EN EL MATCH A PROXIMADO DE PERSONAS NATU-
  7684* G.JIMENEZ  * RALES SE CAMBIA EL CALCULO FINAL PARA DETERMINAR SI UN BLO-
  7685* MARZO/2003 * QUE ES O NO VALIDO. PARA QUE UN NOMBRE QUE VENGA NUMERICO
  7686*            * NO SE CONVIERTA EN COMODIN, EN LAS SUSTITUCIONES POR *
  7687*            * SE VALIDA QUE EL CONTENIDO NO SEA NUMERICO.
  7688*************************************************************************
  7689* GJC0005    * VLNM01: LOS PROGRAMAS ABORTAN CUANDO ALGUNO DE LOS
  7690* G.JIMENEZ  *         PARAMETROS DE UN SUBSTRING QUEDA EN 0 O EN
  7691* NOV/2005   *         UN NUMERO MENOR QUE 0. EJ: NOMBRE(I:J) DONDE I O
  7692*            *         J ES 0.
  7693*************************************************************************
  7694 10000-MATCH-NOMBRES-VALNOM.
  7695******************************************************************
  7696*10000-MATCH-NOMBRE-VALNOM.
  7697* SE BUSCA DETERMINAR SI EL NOMBRE DE LA PERSONA CONSULTADA HACE
  7698*       CON EL NOMBRE ENVIADO EN LA CONSULTA.
  7699******************************************************************
  7700     MOVE 0 TO MATCH-OK-OUT-VALNOM.
  7701     MOVE NOMBRE-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  7702     IF TIP-ID-INPUT-VALNOM  = 2
  7703         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  7704           " S.A. " BY "      ",                                  RMB0002
  7705           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7706           " LIMITADA " BY "          ",                          RMB0002
  7707           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7708           " INVERSIONES " BY "             ",                    RMB0002
  7709           " EMPRESA " BY "         ",                            RMB0002
  7710           " CORPORACION " BY "             ",                    RMB0002
  7711           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7712           " S " BY "   ", " A " BY "   "                         RMB0002
  7713           " Y " BY "   "                                         GJC0003
  7714         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7715           " S.A. " BY "      ",                                  RMB0002
  7716           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7717           " LIMITADA " BY "          ",                          RMB0002
  7718           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7719           " INVERSIONES " BY "             ",                    RMB0002
  7720           " EMPRESA " BY "         ",                            RMB0002
  7721           " CORPORACION " BY "             ",                    RMB0002
  7722           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7723           " S " BY "   ", " A " BY "   "                         RMB0002
  7724           " Y " BY "   "                                         GJC0003
  7725         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
  7726                "." BY " ","-" BY " ",                            GJC0003
  7727                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7728                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7729         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  GJC0003
  7730                "." BY " ","-" BY " ",                            GJC0003
  7731                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7732                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7733         MOVE NOMBRE-AUX-VALNOM TO NOMBRE-INPUT-VALNOM
  7734     ELSE
  7735        INSPECT CADENA-VALNOM    REPLACING ALL
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 134
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7736                 "." BY " ","-" BY " ", "," BY " ",
  7737                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  7738                "Y" BY "G","H" BY "G","I" BY "G",
  7739                " DE " BY "    "," LA " BY "    ",
  7740                " DEL " BY "     "
  7741        INSPECT CADENA-VALNOM    REPLACING ALL                    RMB0002
  7742                 "." BY " ","-" BY " ", "," BY " ",
  7743                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      RMB0002
  7744                "Y" BY "G","H" BY "G","I" BY "G",                 RMB0002
  7745                " DE " BY "    "," LA " BY "    ",                RMB0002
  7746                " DEL " BY "     "                                RMB0002
  7747                PERFORM VARYING I-VALNOM FROM 1 BY 1
  7748                        UNTIL I-VALNOM >= 66
  7749                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  7750                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  7751                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  7752                  END-IF
  7753                END-PERFORM
  7754     END-IF.
  7755     MOVE SPACES TO VECTOR-INPUT-VALNOM.
  7756     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
  7757                  BASURA-VALNOM
  7758      VM-INPUT-VALNOM(1) VM-INPUT-VALNOM(2) VM-INPUT-VALNOM(3)
  7759      VM-INPUT-VALNOM(4) VM-INPUT-VALNOM(5)
  7760      VM-INPUT-VALNOM(6) VM-INPUT-VALNOM(7) VM-INPUT-VALNOM(8)
  7761      VM-INPUT-VALNOM(9) VM-INPUT-VALNOM(10)
  7762      VM-INPUT-VALNOM(11) VM-INPUT-VALNOM(12) VM-INPUT-VALNOM(13)
  7763      VM-INPUT-VALNOM(14)
  7764      VM-INPUT-VALNOM(15)
  7765      VM-INPUT-VALNOM(16) VM-INPUT-VALNOM(17) VM-INPUT-VALNOM(18)
  7766      VM-INPUT-VALNOM(19)
  7767      VM-INPUT-VALNOM(20)
  7768******************PREPARA EL NOMBRE CORRECTO DEL ARCHIVO *********
  7769     MOVE NOMBOK-INPUT-VALNOM TO NOMBRE-AUX-VALNOM.
  7770     IF TIP-ID-INPUT-VALNOM  NOT = 2
  7771        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL
  7772                 "." BY " ","-" BY " ","," BY " ",
  7773                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",
  7774                "Y" BY "G","H" BY "G","I" BY "G"
  7775                PERFORM VARYING I-VALNOM FROM 1 BY 1
  7776                        UNTIL I-VALNOM >= 66
  7777                  IF VNOM-AUX-VALNOM(I-VALNOM) NOT ALPHABETIC
  7778                      AND VNOM-AUX-VALNOM(I-VALNOM) NOT NUMERIC
  7779                     MOVE "*" TO VNOM-AUX-VALNOM(I-VALNOM)
  7780                  END-IF
  7781                END-PERFORM
  7782     ELSE
  7783         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7784           " S.A. " BY "      ",                                  RMB0002
  7785           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7786           " LIMITADA " BY "          ",                          RMB0002
  7787           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7788           " INVERSIONES " BY "             ",                    RMB0002
  7789           " EMPRESA " BY "         ",                            RMB0002
  7790           " CORPORACION " BY "             ",                    RMB0002
  7791           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7792           " S " BY "   ", " A " BY "   "                         RMB0002
  7793           " Y " BY "   "                                         GJC0003
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 135
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7794         INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                  RMB0002
  7795           " S.A. " BY "      ",                                  RMB0002
  7796           "." BY " ", " LTDA " BY "      ",                      RMB0002
  7797           " LIMITADA " BY "          ",                          RMB0002
  7798           " CIA " BY "     ", " COMPA/IA " BY "          ",      RMB0002
  7799           " INVERSIONES " BY "             ",                    RMB0002
  7800           " EMPRESA " BY "         ",                            RMB0002
  7801           " CORPORACION " BY "             ",                    RMB0002
  7802           " DE " BY "    ", " LA " BY "    ", " DEL " BY "     ",RMB0002
  7803           " S " BY "   ", " A " BY "   "                         RMB0002
  7804           " Y " BY "   "                                         GJC0003
  7805        INSPECT NOMBRE-AUX-VALNOM REPLACING ALL                   GJC0003
  7806                "." BY " ","-" BY " ",                            GJC0003
  7807                "C" BY "S","Z" BY "S","J" BY "G","V" BY "B",      GJC0003
  7808                "Y" BY "G","H" BY "G","I" BY "G"                  GJC0003
  7809         MOVE NOMBRE-AUX-VALNOM TO NOMBOK-INPUT-VALNOM
  7810     END-IF.
  7811     MOVE SPACES TO VECTOR-OK-VALNOM.
  7812     UNSTRING CADENA-VALNOM      DELIMITED BY ALL " " INTO
  7813                  BASURA-VALNOM
  7814      VM-OK-VALNOM(1) VM-OK-VALNOM(2) VM-OK-VALNOM(3)
  7815      VM-OK-VALNOM(4) VM-OK-VALNOM(5)
  7816      VM-OK-VALNOM(6) VM-OK-VALNOM(7) VM-OK-VALNOM(8)
  7817      VM-OK-VALNOM(9) VM-OK-VALNOM(10)
  7818      VM-OK-VALNOM(11) VM-OK-VALNOM(12) VM-OK-VALNOM(13)
  7819      VM-OK-VALNOM(14) VM-OK-VALNOM(15)
  7820      VM-OK-VALNOM(16) VM-OK-VALNOM(17) VM-OK-VALNOM(18)
  7821      VM-OK-VALNOM(19) VM-OK-VALNOM(20).
  7822***********HACE LA VALIDACION BLOQUE A BLOQUE********************
  7823     MOVE 1 TO I-VALNOM.
  7824     MOVE 0 TO BLOQOK-AUX-VALNOM.
  7825     PERFORM UNTIL VM-INPUT-VALNOM(I-VALNOM) = SPACES
  7826       MOVE 1 TO J-VALNOM
  7827       PERFORM UNTIL J-VALNOM > 20
  7828         IF VM-INPUT-VALNOM(I-VALNOM) = VM-OK-VALNOM(J-VALNOM)
  7829            ADD 1 TO BLOQOK-AUX-VALNOM
  7830            MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7831                           VM-INPUT-VALNOM(I-VALNOM)
  7832            MOVE 21 TO J-VALNOM
  7833         ELSE
  7834            MOVE 0 TO M-VALNOM
  7835            INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
  7836                    FOR CHARACTERS BEFORE INITIAL "*"
  7837            IF M-VALNOM >= 15
  7838               MOVE 0 TO M-VALNOM
  7839               INSPECT VM-OK-VALNOM(J-VALNOM) TALLYING M-VALNOM
  7840                    FOR CHARACTERS BEFORE INITIAL "N"
  7841            END-IF
  7842            IF M-VALNOM > 0 AND < 15 AND I-VALNOM < 20
  7843               AND (14 - M-VALNOM > 0)                            GJC0005
  7844               COMPUTE INI-VALNOM = M-VALNOM + 2
  7845               COMPUTE LON-VALNOM = 14 - M-VALNOM
  7846               MOVE VM-OK-VALNOM(J-VALNOM) TO PEDAZO-VALNOM
  7847               IF PEDAZO-VALNOM(INI-VALNOM:LON-VALNOM) =
  7848                  VM-INPUT-VALNOM(I-VALNOM + 1 ) AND
  7849                  PEDAZO-VALNOM(1:M-VALNOM) =
  7850                  VM-INPUT-VALNOM(I-VALNOM)
  7851                  ADD 1 TO BLOQOK-AUX-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 136
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7852                  MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7853                           VM-INPUT-VALNOM(I-VALNOM)
  7854                  MOVE 21 TO J-VALNOM
  7855                  ADD 1 TO I-VALNOM
  7856                  MOVE SPACES TO VM-INPUT-VALNOM(I-VALNOM)
  7857               END-IF
  7858            END-IF
  7859         END-IF
  7860         ADD 1 TO J-VALNOM
  7861       END-PERFORM
  7862       ADD 1 TO I-VALNOM
  7863       IF I-VALNOM = 21
  7864          NEXT SENTENCE
  7865       END-IF
  7866     END-PERFORM.
  7867     IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
  7868        MOVE 1 TO MATCH-OK-OUT-VALNOM
  7869     ELSE
  7870        IF TIP-ID-INPUT-VALNOM <> 2
  7871           PERFORM 10100-MATCH-APROXIMADO
  7872        ELSE
  7873           PERFORM 10100-MATCH-APROX-EMPRESAS
  7874        END-IF
  7875        IF BLOQOK-AUX-VALNOM >= BLOQUES-INPUT-VALNOM
  7876           MOVE 1 TO MATCH-OK-OUT-VALNOM
  7877        END-IF
  7878     END-IF.
  7879**********************************************************************
  7880*10100-MATCH-APROXIMADO.
  7881*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS
  7882*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON
  7883*     LOS TIPOS DE IDENTIFICACION 1, 3 Y 4.
  7884**********************************************************************
  7885 10100-MATCH-APROXIMADO.
  7886     IF BLOQOK-AUX-VALNOM > 0
  7887        MOVE 65 TO APROX-TOT-VALNOM APROX-INP-VALNOM
  7888     ELSE
  7889        MOVE 70 TO APROX-TOT-VALNOM APROX-INP-VALNOM
  7890     END-IF
  7891     MOVE 1 TO I-VALNOM.
  7892     PERFORM UNTIL I-VALNOM > 10
  7893       MOVE 1 TO J-VALNOM
  7894       PERFORM UNTIL J-VALNOM > 10
  7895         MOVE 0 TO LETRAS-OK-VALNOM LETRAS-OK2-VALNOM
  7896         MOVE 1 TO K-VALNOM
  7897         MOVE 1 TO L-VALNOM
  7898         IF VM-INPUT-VALNOM(I-VALNOM) NOT = SPACES AND
  7899            VM-OK-VALNOM   (J-VALNOM) NOT = SPACES
  7900            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
  7901              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7902                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)
  7903                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003
  7904                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003
  7905                      OR = "N"))                                  GJC0003
  7906                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT= SPACES
  7907                    ADD 1 TO LETRAS-OK-VALNOM
  7908                    ADD 1 TO K-VALNOM
  7909                    ADD 1 TO L-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 137
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7910                 ELSE
  7911                    MOVE 19 TO K-VALNOM
  7912                 END-IF
  7913              ELSE
  7914                 ADD 1   TO K-VALNOM
  7915                 IF K-VALNOM <= 15 AND L-VALNOM < 15
  7916                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM + 1) =
  7917                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM )
  7918                       ADD 1 TO L-VALNOM
  7919                    END-IF
  7920                 END-IF
  7921              END-IF
  7922            END-PERFORM
  7923            MOVE 1 TO K-VALNOM
  7924            MOVE 1 TO L-VALNOM
  7925            PERFORM UNTIL K-VALNOM > 15 OR L-VALNOM > 15
  7926              IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7927                 VMM-OK-VALNOM  (J-VALNOM,K-VALNOM)
  7928                 OR ((VMM-OK-VALNOM(J-VALNOM, K-VALNOM)) = "*"    GJC0003
  7929                 AND (VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) = " "   GJC0003
  7930                      OR = "N"))                                  GJC0003
  7931                 IF VMM-OK-VALNOM (J-VALNOM,K-VALNOM) NOT = SPACES
  7932                    ADD 1 TO LETRAS-OK2-VALNOM
  7933                    ADD 1 TO K-VALNOM
  7934                    ADD 1 TO L-VALNOM
  7935                 ELSE
  7936                    MOVE 19 TO K-VALNOM
  7937                 END-IF
  7938              ELSE
  7939                 ADD 1   TO L-VALNOM
  7940                 IF L-VALNOM <= 15 AND K-VALNOM < 15
  7941                    IF VMM-INPUT-VALNOM(I-VALNOM,L-VALNOM) =
  7942                       VMM-OK-VALNOM(J-VALNOM,K-VALNOM + 1)
  7943                       ADD 1 TO K-VALNOM
  7944                    END-IF
  7945                 END-IF
  7946              END-IF
  7947            END-PERFORM
  7948         END-IF
  7949         IF LETRAS-OK2-VALNOM > LETRAS-OK-VALNOM
  7950            MOVE LETRAS-OK2-VALNOM TO LETRAS-OK-VALNOM
  7951         END-IF
  7952         IF LETRAS-OK-VALNOM > 0
  7953            MOVE 0 TO TOTLET-INP-VALNOM TOTLET-OK-VALNOM
  7954            INSPECT VM-INPUT-VALNOM(I-VALNOM) TALLYING
  7955                    TOTLET-INP-VALNOM
  7956                    FOR CHARACTERS BEFORE INITIAL " "
  7957            INSPECT VM-OK-VALNOM   (J-VALNOM) TALLYING
  7958                    TOTLET-OK-VALNOM
  7959                    FOR CHARACTERS BEFORE INITIAL " "
  7960            MOVE 0 TO POR-TOT-VALNOM  POR-INP-VALNOM
  7961            IF TOTLET-OK-VALNOM >= 3
  7962               COMPUTE POR-TOT-VALNOM = LETRAS-OK-VALNOM * 100 /
  7963                                       TOTLET-OK-VALNOM
  7964            END-IF
  7965            IF TOTLET-INP-VALNOM >= 3
  7966               COMPUTE POR-INP-VALNOM = LETRAS-OK-VALNOM * 100 /
  7967                                       TOTLET-INP-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 138
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  7968            END-IF
  7969            IF TOTLET-OK-VALNOM > TOTLET-INP-VALNOM
  7970               COMPUTE A-VALNOM = TOTLET-INP-VALNOM * 100 /
  7971                                 TOTLET-OK-VALNOM
  7972            ELSE
  7973               COMPUTE A-VALNOM = TOTLET-OK-VALNOM  * 100 /
  7974                                 TOTLET-INP-VALNOM
  7975            END-IF
  7976            IF ((POR-TOT-VALNOM + POR-INP-VALNOM)/2 >=
  7977                                  APROX-TOT-VALNOM) AND
  7978                 A-VALNOM >= 63
  7979****   display "%TOT=",POR-TOT-VALNOM, " %INP=", POR-INP-VALNOM,
  7980****           "A-VALNOM=", A-VALNOM
  7981*****       IF (POR-TOT-VALNOM >= APROX-TOT-VALNOM AND
  7982*****           POR-INP-VALNOM >= APROX-INP-VALNOM ) OR
  7983*****          ((POR-TOT-VALNOM >= APROX-TOT-VALNOM OR
  7984*****            POR-INP-VALNOM >= APROX-INP-VALNOM ) AND
  7985*****            A-VALNOM >= 70)
  7986               ADD 1 TO BLOQOK-AUX-VALNOM
  7987               MOVE SPACES TO VM-OK-VALNOM(J-VALNOM)
  7988                           VM-INPUT-VALNOM(I-VALNOM)
  7989            END-IF
  7990         END-IF
  7991         ADD 1 TO J-VALNOM
  7992       END-PERFORM
  7993       ADD 1 TO I-VALNOM
  7994     END-PERFORM.
  7995**********************************************************************
  7996*10100-MATCH-APROX-EMPRESAS
  7997*     EN ESTA RUTINA SE VALIDAN LOS BLOQUES QUE NO PASARON COMPLETOS
  7998*     CON UNA APROXIMACION. ESTA RUTINA FUNCIONA CORRECTAMENTE CON
  7999*     LOS TIPOS DE IDENTIFICACION 2.
  8000**********************************************************************
  8001 10100-MATCH-APROX-EMPRESAS.
  8002   MOVE ZEROS TO TOTLET-INP-VALNOM
  8003   MOVE ZEROS TO LETRAS-OK2-VALNOM
  8004    MOVE ZEROS TO A-VALNOM                                        GJC0003
  8005   MOVE 1 TO K-VALNOM
  8006   PERFORM UNTIL K-VALNOM > 65
  8007     MOVE K-VALNOM  TO I-VALNOM
  8008     MOVE 1       TO J-VALNOM
  8009     MOVE ZEROS TO LETRAS-OK-VALNOM
  8010     PERFORM UNTIL J-VALNOM > 65 OR I-VALNOM > 65
  8011        IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
  8012           V-NOMBRE-VALNOM(I-VALNOM) <> "."
  8013           IF V-NOMBRE-VALNOM(I-VALNOM) =
  8014              V-NOMBOK-VALNOM(J-VALNOM)
  8015              ADD 1 TO LETRAS-OK-VALNOM
  8016              ADD 1 TO I-VALNOM
  8017              ADD 1 TO J-VALNOM
  8018           ELSE
  8019              ADD 1 TO J-VALNOM
  8020           END-IF
  8021        ELSE
  8022           ADD 1 TO I-VALNOM
  8023        END-IF
  8024     END-PERFORM
  8025     IF LETRAS-OK-VALNOM > LETRAS-OK2-VALNOM
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 139
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/VALN
  8026        MOVE LETRAS-OK-VALNOM TO LETRAS-OK2-VALNOM
  8027     END-IF
  8028     ADD 1 TO K-VALNOM
  8029   END-PERFORM.
  8030   MOVE 1 TO I-VALNOM
  8031   PERFORM UNTIL I-VALNOM > 65
  8032     IF V-NOMBRE-VALNOM(I-VALNOM) <> SPACES AND
  8033        V-NOMBRE-VALNOM(I-VALNOM) <> "."
  8034        ADD 1 TO TOTLET-INP-VALNOM
  8035     END-IF
  8036     ADD 1 TO I-VALNOM
  8037   END-PERFORM.
  8038   COMPUTE A-VALNOM = LETRAS-OK2-VALNOM * 100 /
  8039                     TOTLET-INP-VALNOM.
  8040   IF A-VALNOM >= 75
  8041       ADD 1 TO BLOQOK-AUX-VALNOM
  8042   END-IF.
  8043    MOVE 0 TO K-VALNOM                                            GJC0003
  8044   IF BLOQOK-AUX-VALNOM < BLOQUES-INPUT-VALNOM                    GJC0003
  8045      INITIALIZE A-VALNOM VECTORES-VALNOM L-VALNOM                GJC0003
  8046      PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 65    GJC0003
  8047               IF V-NOMBRE-VALNOM(J-VALNOM) <> " "                GJC0003
  8048                 MOVE FUNCTION ORD(V-NOMBRE-VALNOM(J-VALNOM))     GJC0003
  8049                   TO I-VALNOM                                    GJC0003
  8050                 ADD 1 TO CONT-LET-INPUT-VALNOM(I-VALNOM)         GJC0003
  8051              END-IF                                              GJC0003
  8052               IF V-NOMBOK-VALNOM(J-VALNOM) <> " "                GJC0003
  8053                 MOVE FUNCTION ORD(V-NOMBOK-VALNOM(J-VALNOM))     GJC0003
  8054                    TO I-VALNOM                                   GJC0003
  8055                 ADD 1 TO CONT-LET-OK-VALNOM(I-VALNOM)            GJC0003
  8056              END-IF                                              GJC0003
  8057      END-PERFORM                                                 GJC0003
  8058      MOVE 0 TO I-VALNOM                                          GJC0003
  8059       PERFORM VARYING J-VALNOM FROM 1 BY 1 UNTIL J-VALNOM > 256  GJC0003
  8060         IF CONT-LET-OK-VALNOM(J-VALNOM)  > 0                     GJC0003
  8061            ADD 1 TO I-VALNOM                                     GJC0003
  8062            IF CONT-LET-OK-VALNOM(J-VALNOM) <                     GJC0003
  8063               CONT-LET-INPUT-VALNOM(J-VALNOM)                    GJC0003
  8064               COMPUTE L-VALNOM = L-VALNOM + 100                  GJC0003
  8065            ELSE                                                  GJC0003
  8066               COMPUTE L-VALNOM = L-VALNOM +                      GJC0003
  8067                                  (CONT-LET-INPUT-VALNOM(J-VALNOM)GJC0003
  8068                           *  100 /CONT-LET-OK-VALNOM(J-VALNOM))  GJC0003
  8069            END-IF                                                GJC0003
  8070         END-IF                                                   GJC0003
  8071      END-PERFORM                                                 GJC0003
  8072      COMPUTE K-VALNOM = L-VALNOM/I-VALNOM                        GJC0003
  8073       IF (A-VALNOM >= 40 AND K-VALNOM > 80) OR                   GJC0003
  8074         ((A-VALNOM >= 35 AND A-VALNOM < 40) AND K-VALNOM > 85) ORGJC0003
  8075         ((A-VALNOM >= 25 AND A-VALNOM < 35) AND K-VALNOM = 100)  GJC0003
  8076         ADD 1 TO BLOQOK-AUX-VALNOM                               GJC0003
  8077       END-IF                                                     GJC0003
  8078   END-IF.                                                        GJC0003
  8079
  8080 0500-ASIGNA-ID-ICMCRE-START.
  8081******************************************************************
  8082*0500-ASIGNA-ID-ICMCRE-START.
  8083******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 140
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8084        MOVE TIPO-ID-ABD07 TO TIPO-ID-LEEMSTRS
  8085        MOVE NUM-ID-ABD07  TO NRO-ID-LEEMSTRS.
  8086
  8087 0600-ASIGNA-ID-ICMCHK-START.
  8088******************************************************************
  8089*0600-ASIGNA-ID-ICMCHK-START.
  8090******************************************************************
  8091        MOVE TIPO-ID-ABD06 TO TIPO-ID-LEEMSTRS
  8092        MOVE NUM-ID-ABD06  TO NRO-ID-LEEMSTRS.
  8093
  8094 1000-LEE-ICMCRE-SECUENCIAL.
  8095******************************************************************
  8096*1000-LEE-ICMCRE-SECUENCIAL.
  8097*    LEEE MAESTRO ICMCRE EN FORMA SECUENCIAL Y VALIDA EL FIN DE
  8098*    ARCHIVO:
  8099*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8100*                         1: LECTURA CON ERROR O FIN ARCHIVO
  8101* OJO LA INSTRUCCION (ADD 0 TO SW-LECTURA-MAESTROS) SE REALIZA
  8102* PARA EVITAR ERROR DE COMPILACION POR EL END-IF DESPUES DE $END
  8103******************************************************************
  8104     MOVE 0 TO SW-LECTURA-MAESTROS
  8105     READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK AT END
  8106          MOVE 1 TO SW-LECTURA-MAESTROS
  8107     END-READ
  8108     IF SW-LECTURA-MAESTROS = 0
  8109      IF (TIPO-ID-ABD07 = TIPO-ID-LEEMSTRS AND
  8110          NUM-ID-ABD07  = NRO-ID-LEEMSTRS) OR
  8111          (TIPO-ID-LEEMSTRS = ZEROS AND
  8112           NRO-ID-LEEMSTRS  = ZEROS)
  8113$       IF HACERMATCH = "SI"
  8114          IF HACERMATCH-LEEMSTRS = 1
  8115           IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR
  8116              NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS
  8117              MOVE 0 TO IDE-TIPO-BDAMATCH
  8118              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8119              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8120              IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004
  8121                                 CONSECUTIVO-ABD07 = 01           GJC0004
  8122                 PERFORM 7000-GUARDAR-REG-INICIALES
  8123                 MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH
  8124                 MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH
  8125                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8126                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8127                 MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS
  8128                 MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS
  8129              END-IF
  8130           END-IF
  8131          END-IF
  8132$       END
  8133        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8134           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003
  8135                              050050 OR 130050                    GJC0003
  8136              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003
  8137           END-IF                                                 GJC0003
  8138        END-IF                                                    GJC0003
  8139$       IF AMNISTIA21 = "SI"
  8140           IF AMNISTIA21-LEEMSTRS = 1
  8141              PERFORM 200700-AMNISTIA-CLIENTES
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 141
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8142* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
  8143* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
  8144              IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003
  8145                 IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003
  8146                                    050050 OR 130050              GJC0003
  8147                    MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003
  8148                 END-IF                                           GJC0003
  8149              END-IF                                              GJC0003
  8150           END-IF
  8151           IF SW-ART13-AMNIST21 = 1                               GJC0002
  8152              IF IDE-TIPO-BDAMATCH = 1                            GJC0002
  8153                 IF HACERMATCH-LEEMSTRS = 1                       GJC0002
  8154                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002
  8155                 END-IF                                           GJC0002
  8156              END-IF                                              GJC0002
  8157              PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002
  8158           END-IF                                                 GJC0002
  8159$       END
  8160        IF SW-AMNIST21 = 1
  8161           IF IDE-TIPO-BDAMATCH = 1                               GJC0002
  8162              IF HACERMATCH-LEEMSTRS = 1                          GJC0002
  8163                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002
  8164              END-IF                                              GJC0002
  8165           END-IF                                                 GJC0002
  8166           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002
  8167              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002
  8168*             ELSE                                                GJC0002
  8169*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002
  8170*             END-IF                                              GJC0002
  8171           END-IF
  8172        ELSE
  8173           IF IDE-TIPO-BDAMATCH = 1
  8174              IF HACERMATCH-LEEMSTRS = 1
  8175                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  8176              END-IF
  8177           END-IF
  8178        END-IF
  8179
  8180      END-IF
  8181      IF SW-NOV-48-LEEMSTRS = 0  *>                               GJC0002
  8182         MOVE ZEROS TO VECTOR-HIS-3-ABD07                         GJC0002
  8183                       VECTOR-HIS-4-ABD07                         GJC0002
  8184           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002
  8185           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002
  8186           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002
  8187           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002
  8188     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002
  8189          MOR-EST-CTA-AMNIST21                                    GJC0002
  8190        PERFORM 500000-RECONSTRUCCION-HISTORIA                    GJC0002
  8191      END-IF                                                      GJC0002
  8192     END-IF.
  8193     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8194
  8195 2000-LEE-ICMCRE-DINAMICO.
  8196******************************************************************
  8197*2000-LEE-ICMCRE-DINAMICO.
  8198*    LEEE MAESTRO ICMCRE EN FORMA DIMANICA Y VALIDA EL INVALID KEY
  8199*    DEL ARCHIVO:
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 142
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8200*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8201*                         1: LECTURA CON ERROR
  8202******************************************************************
  8203     MOVE 0 TO SW-LECTURA-MAESTROS
  8204     READ MAESTRO-CREDIT IGNORE LOCK INVALID KEY
  8205          MOVE 1 TO SW-LECTURA-MAESTROS
  8206     END-READ
  8207     IF SW-LECTURA-MAESTROS = 0
  8208$       IF HACERMATCH = "SI"
  8209          IF HACERMATCH-LEEMSTRS = 1
  8210           IF TIPO-ID-ABD07 <> TIP-IDE-ANT-LEEMSTRS OR
  8211              NUM-ID-ABD07  <> NUM-IDE-ANT-LEEMSTRS
  8212              MOVE 0 TO IDE-TIPO-BDAMATCH
  8213              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8214              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8215              IF (IND-BLOQUEO-ABD07 = 7 OR 8 OR 9)  AND           GJC0004
  8216                                 CONSECUTIVO-ABD07 = 01           GJC0004
  8217                 PERFORM 7000-GUARDAR-REG-INICIALES
  8218                 MOVE TIPO-ID-ABD07 TO TIP-IDE-INPUT-BDAMATCH
  8219                 MOVE NUM-ID-ABD07  TO NUM-IDE-INPUT-BDAMATCH
  8220                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8221                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8222                 MOVE TIPO-ID-ABD07 TO TIP-IDE-ANT-LEEMSTRS
  8223                 MOVE NUM-ID-ABD07  TO NUM-IDE-ANT-LEEMSTRS
  8224              END-IF
  8225           END-IF
  8226         END-IF
  8227$       END
  8228        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8229           IF COD-SUS-ABD07 = 020050 OR 030050 OR                 GJC0003
  8230                              050050 OR 130050                    GJC0003
  8231              MOVE 4 TO IND-BLOQUEO-ABD07                         GJC0003
  8232           END-IF                                                 GJC0003
  8233        END-IF                                                    GJC0003
  8234$       IF AMNISTIA21 = "SI"
  8235           IF AMNISTIA21-LEEMSTRS = 1
  8236              PERFORM 200700-AMNISTIA-CLIENTES
  8237* SE REPITE LOGICA DE BBVA POR LO QUE AL FINAL DE AMNISTIA-CLIENES
  8238* VUELVE A LEER EL ICMCRE PARA VOLVER A POSICIONARSE EN LA CUENTA LEIDA
  8239              IF SW-ELIMINA-BBVA-LEEMSTRS = 1                     GJC0003
  8240                 IF COD-SUS-ABD07 = 020050 OR 030050 OR           GJC0003
  8241                                    050050 OR 130050              GJC0003
  8242                    MOVE 4 TO IND-BLOQUEO-ABD07                   GJC0003
  8243                 END-IF                                           GJC0003
  8244              END-IF                                              GJC0003
  8245           END-IF
  8246           IF SW-ART13-AMNIST21 = 1                               GJC0002
  8247              IF IDE-TIPO-BDAMATCH = 1                            GJC0002
  8248                 IF HACERMATCH-LEEMSTRS = 1                       GJC0002
  8249                    PERFORM 8000-U-VER-CTAABD07-BDAMATCH          GJC0002
  8250                 END-IF                                           GJC0002
  8251              END-IF                                              GJC0002
  8252              PERFORM 200900-APLICAR-ART13-REGISTRO               GJC0002
  8253           END-IF                                                 GJC0002
  8254$       END
  8255        IF SW-AMNIST21 = 1
  8256           IF IDE-TIPO-BDAMATCH = 1                               GJC0002
  8257              IF HACERMATCH-LEEMSTRS = 1                          GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 143
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8258                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH             GJC0002
  8259              END-IF                                              GJC0002
  8260           END-IF                                                 GJC0002
  8261           IF AMNISTIA21-LEEMSTRS = 1                             GJC0002
  8262              PERFORM 200850-AMNISTIA-REGISTROS                   GJC0002
  8263*             ELSE                                                GJC0002
  8264*                PERFORM 200850-AMNISTIA-REGISTROS                GJC0002
  8265*             END-IF                                              GJC0002
  8266           END-IF
  8267        ELSE
  8268           IF IDE-TIPO-BDAMATCH = 1
  8269              IF HACERMATCH-LEEMSTRS = 1
  8270                 PERFORM 8000-U-VER-CTAABD07-BDAMATCH
  8271              END-IF
  8272           END-IF
  8273        END-IF
  8274        IF SW-NOV-48-LEEMSTRS = 0                                 GJC0002
  8275           MOVE ZEROS TO VECTOR-HIS-3-ABD07                       GJC0002
  8276                       VECTOR-HIS-4-ABD07                         GJC0002
  8277           MOVE VECTOR-HIS-1-ABD07 TO VECTOR-1-CTA-AMNIST21       GJC0002
  8278           MOVE VECTOR-HIS-2-ABD07 TO VECTOR-2-CTA-AMNIST21       GJC0002
  8279           MOVE ZEROS TO VECTOR-3-CTA-AMNIST21                    GJC0002
  8280           MOVE ZEROS TO VECTOR-4-CTA-AMNIST21                    GJC0002
  8281     MOVE NOV-CART-MORA-AMNIST21(NOV-REPORT-ABD07) TO             GJC0002
  8282          MOR-EST-CTA-AMNIST21                                    GJC0002
  8283          PERFORM 500000-RECONSTRUCCION-HISTORIA                  GJC0002
  8284        END-IF                                                    GJC0002
  8285     END-IF.
  8286     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8287
  8288 3000-LEE-ICMCHK-SECUENCIAL.
  8289******************************************************************
  8290*3000-LEE-ICMCHK-SECUENCIAL.
  8291*    LEEE MAESTRO ICMCHK EN FORMA SECUENCIAL Y VALIDA EL FIN DE
  8292*    ARCHIVO:
  8293*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8294*                         1: LECTURA CON ERROR O FIN ARCHIVO
  8295******************************************************************
  8296     MOVE 0 TO SW-LECTURA-MAESTROS
  8297     READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK AT END
  8298          MOVE 1 TO SW-LECTURA-MAESTROS
  8299     END-READ
  8300     IF SW-LECTURA-MAESTROS = 0
  8301      IF (TIPO-ID-ABD06 = TIPO-ID-LEEMSTRS AND
  8302          NUM-ID-ABD06  = NRO-ID-LEEMSTRS) OR
  8303          (TIPO-ID-LEEMSTRS = ZEROS AND
  8304           NRO-ID-LEEMSTRS  = ZEROS)
  8305$       IF HACERMATCH = "SI"
  8306          IF HACERMATCH-LEEMSTRS = 1
  8307           IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR
  8308              NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS
  8309              MOVE 0 TO IDE-TIPO-BDAMATCH
  8310              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8311              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8312              IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004
  8313                                 CONSECUTIVO-ABD06 = 01           GJC0004
  8314                 PERFORM 7000-GUARDAR-REG-INICIALES
  8315                 MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 144
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8316                 MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH
  8317                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8318                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8319                 MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS
  8320                 MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS
  8321              END-IF
  8322           END-IF
  8323           IF IDE-TIPO-BDAMATCH = 1
  8324              IF HACERMATCH-LEEMSTRS = 1
  8325                 PERFORM 8000-U-VER-CTAABD06-BDAMATCH
  8326              END-IF
  8327           END-IF
  8328          END-IF
  8329$       END
  8330        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8331           IF COD-SUS-ABD06 = 010050                              GJC0003
  8332              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003
  8333           END-IF                                                 GJC0003
  8334        END-IF                                                    GJC0003
  8335        ADD 0 TO SW-LECTURA-MAESTROS
  8336      END-IF
  8337     END-IF.
  8338     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8339
  8340 4000-LEE-ICMCHK-DINAMICO.
  8341******************************************************************
  8342*4000-LEE-ICMCHK-DINAMICO.
  8343*    LEEE MAESTRO ICMCHK EN FORMA DIMANICA Y VALIDA EL INVALID KEY
  8344*    DEL ARCHIVO:
  8345*    SW-LECTURA-MAESTROS  0: LECTURA OK
  8346*                         1: LECTURA CON ERROR
  8347******************************************************************
  8348     MOVE 0 TO SW-LECTURA-MAESTROS
  8349     READ MAESTRO-CHECK IGNORE LOCK INVALID KEY
  8350          MOVE 1 TO SW-LECTURA-MAESTROS
  8351     END-READ
  8352     IF SW-LECTURA-MAESTROS = 0
  8353$       IF HACERMATCH = "SI"
  8354          IF HACERMATCH-LEEMSTRS = 1
  8355           IF TIPO-ID-ABD06 <> TIP-IDE-ANT-LEEMSTRS OR
  8356              NUM-ID-ABD06  <> NUM-IDE-ANT-LEEMSTRS
  8357              MOVE 0 TO TIP-IDE-ANT-LEEMSTRS
  8358              MOVE 0 TO NUM-IDE-ANT-LEEMSTRS
  8359              MOVE 0 TO IDE-TIPO-BDAMATCH
  8360              IF (IND-BLOQUEO-ABD06 = 7 OR 8 OR 9)  AND           GJC0004
  8361                                 CONSECUTIVO-ABD06 = 01           GJC0004
  8362                 PERFORM 7000-GUARDAR-REG-INICIALES
  8363                 MOVE TIPO-ID-ABD06 TO TIP-IDE-INPUT-BDAMATCH
  8364                 MOVE NUM-ID-ABD06  TO NUM-IDE-INPUT-BDAMATCH
  8365                 PERFORM 1000-U-RECORRER-CSV-BDAMATCH
  8366                 PERFORM 8000-RECUPERAR-REG-INICIALES
  8367                 MOVE TIPO-ID-ABD06 TO TIP-IDE-ANT-LEEMSTRS
  8368                 MOVE NUM-ID-ABD06  TO NUM-IDE-ANT-LEEMSTRS
  8369              END-IF
  8370           END-IF
  8371           IF IDE-TIPO-BDAMATCH = 1
  8372              IF HACERMATCH-LEEMSTRS = 1
  8373                 PERFORM 8000-U-VER-CTAABD06-BDAMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 145
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8374              END-IF
  8375           END-IF
  8376          END-IF
  8377$       END
  8378        ADD 0 TO SW-LECTURA-MAESTROS
  8379        IF SW-ELIMINA-BBVA-LEEMSTRS = 1                           GJC0003
  8380           IF COD-SUS-ABD06 = 010050                              GJC0003
  8381              MOVE 4 TO IND-BLOQUEO-ABD06                         GJC0003
  8382           END-IF                                                 GJC0003
  8383        END-IF                                                    GJC0003
  8384     END-IF.
  8385     MOVE 0 TO SW-ELIMINA-BBVA-LEEMSTRS.                          GJC0003
  8386
  8387 7000-GUARDAR-REG-INICIALES.
  8388******************************************************************
  8389*7000-GUARDAR-REGISTROS-INICIALES.
  8390*    GUARDA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES DE
  8391*    EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
  8392******************************************************************
  8393      MOVE SPACES TO REG-ICMCRE-LEEMSTRS REG-ICMCHK-LEEMSTRS
  8394                     REG-ICBSUS-LEEMSTRS REG-ICBDIR-LEEMSTRS
  8395      MOVE COMPLETO-ABD07  TO REG-ICMCRE-LEEMSTRS
  8396      MOVE COMPLETO-ABD06  TO REG-ICMCHK-LEEMSTRS
  8397      MOVE REG-SUSCRIPTOR  TO REG-ICBSUS-LEEMSTRS
  8398      MOVE REG-DIRECC      TO REG-ICBDIR-LEEMSTRS.
  8399
  8400 8000-RECUPERAR-REG-INICIALES.
  8401******************************************************************
  8402*8000-RECUPERA-REGISTROS-INICIALES.
  8403*    RECUPERA LOS REGISTROS QUE TENIA LEIDOS CADA PROGRAMA ANTES
  8404*    DE EJECUTAR LA RUTINA DE CUENTAS SIN VALIDAR
  8405******************************************************************
  8406      IF COMPLETO-ABD07  <> REG-ICMCRE-LEEMSTRS AND
  8407         REG-ICMCRE-LEEMSTRS <> SPACES
  8408         MOVE REG-ICMCRE-LEEMSTRS TO COMPLETO-ABD07
  8409         START MAESTRO-CREDIT KEY = LLAVE-MAES-CREDIT
  8410               NOT INVALID KEY
  8411               READ MAESTRO-CREDIT NEXT RECORD IGNORE LOCK
  8412               END-READ
  8413         END-START
  8414      END-IF
  8415      IF COMPLETO-ABD06  <> REG-ICMCHK-LEEMSTRS AND
  8416         REG-ICMCHK-LEEMSTRS <> SPACES
  8417         MOVE REG-ICMCHK-LEEMSTRS TO COMPLETO-ABD06
  8418         START MAESTRO-CHECK  KEY = LLAVE-MAES-CHECK
  8419               NOT INVALID KEY
  8420               READ MAESTRO-CHECK NEXT RECORD IGNORE LOCK
  8421               END-READ
  8422         END-START
  8423      END-IF
  8424      IF REG-SUSCRIPTOR  <> REG-ICBSUS-LEEMSTRS AND
  8425         REG-ICBSUS-LEEMSTRS <> SPACES
  8426         MOVE REG-ICBSUS-LEEMSTRS TO REG-SUSCRIPTOR
  8427         START SUSCRIPTOR KEY = LLAVE-SUSCRIP
  8428               NOT INVALID KEY
  8429               READ SUSCRIPTOR NEXT RECORD IGNORE LOCK
  8430               END-READ
  8431         END-START
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 146
* OC)PROC)/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/LEEM
  8432      END-IF
  8433      IF REG-DIRECC      <> REG-ICBDIR-LEEMSTRS AND
  8434         REG-ICBDIR-LEEMSTRS <> SPACES
  8435         MOVE REG-ICBDIR-LEEMSTRS TO REG-DIRECC
  8436         START MAESTRO-DIRECC KEY = LLAVE-DIRECC
  8437               NOT INVALID KEY
  8438               READ MAESTRO-DIRECC NEXT RECORD IGNORE LOCK
  8439               END-READ
  8440         END-START
  8441      END-IF.
  8442
  8443*------------------------------------------------------*
  8444* EVALUAR FECHAS APERTURA Y NOVEDAD                    *
  8445*------------------------------------------------------*
  8446 5900-EVALUA-FECHAS.
  8447     MOVE FECHA-APERT-ABD07  TO  W-FECHA-AUX
  8448     IF W-ANO-AUX > 50
  8449        MOVE 19 TO W-SGL-OK    SIG-APE
  8450     ELSE
  8451        MOVE 20 TO W-SGL-OK    SIG-APE
  8452     END-IF
  8453     MOVE W-ANO-AUX   TO  W-ANO-OK     ANO-APE
  8454     MOVE W-MES-AUX   TO  W-MES-OK     MES-APE
  8455     MOVE W-FECHA-OK  TO  W-FECHA-INICIAL
  8456     MOVE FEC-NOVEDAD-ABD07  TO  W-FECHA-AUX
  8457     IF W-ANO-AUX > 50
  8458        MOVE 19 TO W-SGL-OK
  8459     ELSE
  8460        MOVE 20 TO W-SGL-OK
  8461     END-IF
  8462     MOVE W-ANO-AUX   TO  W-ANO-OK
  8463     MOVE W-MES-AUX   TO  W-MES-OK
  8464     MOVE W-FECHA-OK  TO  W-FECHA-NOVEDAD
  8466     MOVE 0  TO J
  8467     MOVE FECHA-VENC-ABD07 TO FECHA-AUX
  8468     MOVE FECHA-AUX(1:2) TO MES-VEN
  8469     MOVE FECHA-AUX(3:2) TO ANO-VEN
  8470     IF ANO-VEN < 50
  8471            MOVE 20 TO SIG-VEN
  8472     ELSE
  8473            MOVE 19 TO SIG-VEN
  8474     END-IF
  8475     MOVE W-ANO-AUX   TO  W-ANO-OK
  8476     MOVE W-MES-AUX   TO  W-MES-OK
  8477
  8478     MOVE FECHA-VENCIMIENTO07  TO  W-FECHA-VENCIM
  8479     IF FECHA-VENCIMIENTO07 > FECHA-APERTURA07
  8480            COMPUTE J = ( SIG-ANO-VEN * 12 + MES-VEN ) -
  8481                        ( SIG-ANO-APE * 12 + MES-APE )
  8482     END-IF
  8483     PERFORM 030-NORMALIZAR-VECTOR
  8485     PERFORM 32000-PROCESAR-VALORES
  8486     PERFORM 8000-EXAMINA-VALORES.
  8487
  8488 8000-EXAMINA-VALORES.
  8489*---------------------------------------------------*
  8490     IF COD-SUS-ABD07 = 020008 OR 029908
  8491        MOVE 1 TO IND-VALORES-VALVLR
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 147
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  8492        MOVE 1 TO VEC-VALOR-VALVLR (2)
  8493        MOVE 1 TO VEC-VALOR-VALVLR (3)
  8494     END-IF
  8495     IF IND-VALORES-VALVLR = 1
  8496        IF VEC-VALOR-VALVLR (2) = 1
  8497           MOVE VALOR-INICIAL-ABD07    TO W-VALOR-INI
  8498        END-IF
  8499        IF VEC-VALOR-VALVLR (1) = 1
  8500           MOVE CUANTIA-ABD07          TO W-VALOR-CUOTA
  8501        END-IF
  8502        IF VEC-VALOR-VALVLR (3) = 1
  8503           MOVE VALOR-SALDO-DEUDAM-ABD07 TO W-SALDO-CARTERA
  8504        END-IF
  8505        IF VEC-VALOR-VALVLR (5) = 1
  8506           MOVE VALOR-SALDO-MORAM-ABD07 TO W-SALDO-MORA
  8507           IF TAB-NOV-CART-CODINT(NOV-REPORT-ABD07) = 01
  8508              MOVE ZERO                 TO W-SALDO-MORA
  8509           END-IF
  8510        END-IF
  8511     END-IF.
  8512
  8513
  8514 030-NORMALIZAR-VECTOR.
  8515*===============================================================
  8516*030-NORMALIZAR-VECTOR.
  8517* Se dejan todas las fechas en formato ANO(4).MES(2)          *
  8518*===============================================================
  8519     MOVE FEC-NOVEDAD-ABD07 TO FECHA-AUX.
  8520     MOVE FECHA-AUX(1:2) TO MES-NOV.
  8521     MOVE FECHA-AUX(3:2) TO ANO-NOV.
  8522     IF ANO-NOV < 50
  8523        MOVE 20          TO SIG-NOV
  8524     ELSE
  8525        MOVE 19          TO SIG-NOV
  8526     END-IF.
  8527     MOVE FECHA-ING-ABD02      TO FECHA-AUX.
  8528     MOVE FECHA-AUX(1:2) TO MES-ING.
  8529     MOVE FECHA-AUX(3:2) TO ANO-ING.
  8530     IF ANO-ING < 50
  8531        MOVE 20          TO SIG-ING
  8532     ELSE
  8533        MOVE 19          TO SIG-ING
  8534     END-IF.
  8535***************************************************************
  8536* Se calcula si es necesario borrar información inválida      *
  8537***************************************************************
  8538     MOVE ESTADO-MES-ABD07 TO V-NOR4.
  8539     MOVE VECTOR-2-ABD07   TO V-NOR3.
  8540     MOVE ESTADO-MES-R-ABD07 TO V-NOR2.
  8541     MOVE VECTOR-2-R-ABD07   TO V-NOR1.
  8542     IF FECHA-APERTURA07 > FECHA-INGRESO
  8543        MOVE FECHA-APERTURA07 TO FECHA-INGRESO
  8544     END-IF
  8545     IF FECHA-NOVEDAD07 > FECHA-INGRESO
  8546        COMPUTE J = ( SIG-ANO-NOV * 12 + MES-NOV ) -
  8547                    ( SIG-ANO-ING * 12 + MES-ING )
  8548     ELSE
  8549        MOVE 0 TO J
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 148
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  8550     END-IF
  8551     IF J < 48
  8552        COMPUTE J = 48 - J
  8553     ELSE
  8554        MOVE 0 TO J
  8555     END-IF
  8556     PERFORM UNTIL J = 0
  8557        MOVE "0" TO V-NOR(J:1)
  8558        SUBTRACT 1 FROM J
  8559     END-PERFORM
  8560*    CASTIGADAS Y DUDOSO RECAUDO
  8561     IF NOV-REPORT-ABD07 = 45 OR 47
  8562        IF NOV-REPORT-ABD07 = 47
  8563           MOVE ALL "D" TO RELLENO
  8564        ELSE
  8565           MOVE ALL "C" TO RELLENO
  8566        END-IF
  8567        MOVE FECHA-SITUACION-ABD07 TO FECHA-SITMMAAAA-ORI
  8568        MOVE FECHA-SITAAAA-ORI     TO FECHA-SITAAAA
  8569        MOVE FECHA-SITMM-ORI       TO FECHA-SITMM
  8570        MOVE FECHA-ACTUALIZ-VALOR-ABD07 TO FECHA-SITMMAAAA-ORI
  8571        MOVE FECHA-SITAAAA-ORI     TO FECHA-VALAAAA
  8572        MOVE FECHA-SITMM-ORI       TO FECHA-VALMM
  8573        IF FECHA-VALAAAAMM > FECHA-SITAAAAMM
  8574           MOVE FECHA-VALAAAAMM TO FECHA-SITAAAAMM
  8575        END-IF
  8576        IF FECHA-SITAAAAMM  > FECHA-NOVEDAD07
  8577           COMPUTE J = ( FECHA-SITAAAA * 12 + FECHA-SITMM ) -
  8578                       ( SIG-ANO-NOV   * 12 + MES-NOV     )
  8579           IF J < 48
  8580              PERFORM UNTIL J = 0
  8581                 MOVE V-NOR(2:47) TO V-NOR(1:47)
  8582                 MOVE RELLENO(1:1) TO V-NOR(48:1)
  8583                 SUBTRACT 1 FROM J
  8584              END-PERFORM
  8585           ELSE
  8586              MOVE RELLENO TO V-NOR(1:48)
  8587           END-IF
  8588           MOVE  FECHA-SITAAAAMM  TO  FECHA-NOVEDAD07
  8589        END-IF
  8590     END-IF.
  8591*    ADICIONAR NOVEDAD
  8592     MOVE V-NOR(2:47) TO V-NOR(1:47)
  8593     MOVE V-MORA(NOV-REPORT-ABD07) TO V-NOR(48:1)
  8594*    NORMALIZAR
  8595     IF FECHA-TAG >= FECHA-NOVEDAD07
  8596        COMPUTE J = ( SIG-ANO-TAG * 12 + MES-TAG ) -
  8597                    ( SIG-ANO-NOV * 12 + MES-NOV )
  8598        IF J < 48
  8599           PERFORM UNTIL J = 0
  8600             MOVE V-NOR(2:47) TO V-NOR(1:47)
  8601             MOVE "0"         TO V-NOR(48:1)
  8602             SUBTRACT 1 FROM J
  8603           END-PERFORM
  8604        ELSE
  8605           MOVE ALL "0"        TO V-NOR
  8606        END-IF
  8607     ELSE                           *> NO SE CONSIDERA
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page 149
* OS.PROC)/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/LEEM
  8608             INITIALIZE V-NOR-AUX
  8609             MOVE V-NOR       TO V-NOR-AUX
  8610             MOVE V-NOR-AUX   TO V-NOR(2:47)
  8611             MOVE "0"         TO V-NOR(1:1)
  8612     END-IF.
  8613*    REEMPLAZOS
  8614     INSPECT V-NOR REPLACING ALL "0" BY "."
  8615     INSPECT V-NOR REPLACING ALL "5" BY "0"   *> AL DIA
  8616     INSPECT V-NOR REPLACING ALL "P" BY "0"   *> PAGO TOTAL
  8617     INSPECT V-NOR REPLACING ALL "7" BY "."
  8618     INSPECT V-NOR REPLACING ALL "8" BY "."
  8619     INSPECT V-NOR REPLACING ALL "9" BY "."
  8620     INSPECT V-NOR REPLACING ALL "M" BY "5"   *> CANCELADA MM
  8621     INSPECT V-NOR REPLACING ALL "D" BY "6"   *> DUDOSO RECAUDO
  8622     INSPECT V-NOR REPLACING ALL "C" BY "7"   *> CASTIGADA
  8623     INSPECT V-NOR REPLACING ALL "R" BY "8".  *> RECUPERADA
  8624*===============================================================
  8625
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-015065005AF
* Total Messages:     0
* Data:     1201560     Code:       74854
/d/iccol/desarrollo/fuentes/cobol>fg
vi icestd81.lst
  1797* ABR/2005    **
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE*
  1800* F.CUADROS   *FRAINQ.DAT*
  1801* JUN.23/2005 **
  1802******************************************************************
^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO*
  1804* F.CUADROS   *HISTORICO PARA MICROCREDITO*
  1805* SEP.02/2005 **
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE*
  1808* F.CUADROS   *LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *TIPO 8*
  1810***
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *PARA PROCESOS DEL AREA DE CALIDAD.*
  1814* OCT.17/2006 **
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE*
  1817* F.CUADROS   *PREGUNTAS GRUPALES PARA FRAINQGR*
  1818* SEP.11/2007 **
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE*
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~:w"icestd81.lst" 1880 lines, 115320 characters [1] + Stopped (SIGTSTP)        vi icestd81.lst
/d/iccol/desarrollo/fuentes/cobol>^[  /d/iccol/desarrollo/fuentes/cobol>fgcat icestd81.lst
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*          list("icestd81.lst")
     1*icestd81.cbl.v.01.0002
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.    icestd81-DATACREDITO.
     4 AUTHOR.        DATACREDITO-JAGR.
     5 DATE-WRITTEN.  OCT/2006.
     6 DATE-COMPILED. 21-May-14 10:39.
     7******************************************************************
     8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *
     9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.        *
    10* GER.DESARR.|                                                   *
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.                                *
    15* GER.DESARR.|                                                   *
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
    23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
    25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
    27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
    29*   sh-datainforme
    30*
    31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.                                              GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
    41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43            ASSIGN TO DISK MAES-DIRECC-TITLE
    44            ORGANIZATION IS INDEXED
    45            ACCESS MODE IS DYNAMIC
    46            RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51X           FILE STATUS IS EST-ICBDIR
    52$END
    53            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    54 $SET IDXFORMAT"0"
*   55     COPY BDACSV.FS.                                              GDT0001
    56* BDACSV-FS.V.0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   2
* )d/iccol/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
    57* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
    58* DATOS OFICIALES DE REGIS, DIAN Y DAS
    59     SELECT BDACSV
    60            ASSIGN TO DISK "$DATABASE/BDACSV"
    61            ORGANIZATION IS INDEXED
    62            ACCESS MODE IS DYNAMIC
    63            RECORD KEY IS LLAVE-BDACSV
    64            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*   65     COPY NOAMNISTIA21.FS.                                        GDT0001
    66* NOAMNISTIA21-FS.V.0001
    67* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
    68* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
    69     SELECT NOAMNISTIA21
    70            ASSIGN TO DISK "$DATABASE/NOAMNISTIA21"
    71            ORGANIZATION IS INDEXED
    72            ACCESS MODE IS DYNAMIC
    73            RECORD KEY IS LLAVE-NOAMNISTIA21
    74            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    75*                                                                 GDT0001
*   76     COPY ICBSUS.FS.
    78$SET CONSTANT SW-STATUS-ICBSUS"NO"
    79     SELECT SUSCRIPTOR
    80            ASSIGN TO DISK SUSCRIPTOR-TITLE
    81            ORGANIZATION IS INDEXED
    82            ACCESS MODE IS DYNAMIC
    83            RECORD KEY IS LLAVE-SUSCRIP
    84$IF SW-STATUS-ICBSUS = "NO"
    85$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."
    86$ELSE
    87$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."
    88X           FILE STATUS IS COD-RETORNO-ICBSUS
    89$END
    90            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    91
*   92     COPY ICBCON.FS.
    93* EST005.v.02.002
    94* ARCHIVO QIE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
    95* TIPO 5
    96     SELECT INDEXADO
    97            ASSIGN TO DISK INDEXADO-TITLE
    98            ORGANIZATION IS INDEXED
    99            ACCESS MODE IS DYNAMIC
   100            RECORD KEY IS LLAVE-INDEX
   101            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   102*    COPY  ICBCHK.FS.                                             GDT0002
*  103     COPY  ICBCHK0001.FS.                                         GDT0002
   104*ICBCHK0001.FS.v.01.0001
   105******************************************************************
   106* EST027.v.02.002                                                *
   107* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO*
   108* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                     *
   109******************************************************************
   110 $SET IDXFORMAT"8"
   111
   112     SELECT  MAESTRO-CHECK  ASSIGN TO  MAES-CHECK-TITLE
   113             ORGANIZATION          IS  INDEXED
   114             ACCESS         MODE   IS  DYNAMIC
   115             RECORD         KEY    IS  LLAVE-MAES-CHECK
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   3
* )21.FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   116             LOCK           MODE   IS  MANUAL WITH LOCK ON RECORD.
   117
   118 $SET IDXFORMAT"0"
*  119     COPY ICBCRE.FS.
   120* EST029.v.02.003
   121* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS
   122* POR LOS DIFERENTES SUSCRIPTORES
   123 $SET IDXFORMAT"8"
   124
   125     SELECT MAESTRO-CREDIT
   126            ASSIGN TO DISK MAES-CREDIT-TITLE
   127            ORGANIZATION IS INDEXED
   128            ACCESS MODE IS DYNAMIC
   129            RECORD KEY IS LLAVE-MAES-CREDIT
   130*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT
   131            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   132
   133 $SET IDXFORMAT"0"
*  134     COPY BDIEMSUP0001.FS.
   135* BDIEMSUP-FS.v.0001
   136**********************************************************
   137*MAESTRO DE INFORMACION SUPERINTENDENCIA FORMATO TIPO 8  *
   138**********************************************************
   139 $SET IDXFORMAT"8"
   140     SELECT BDIEMSUP ASSIGN TO DISK TITLE-BDIEMSUP
   141            ORGANIZATION IS INDEXED
   142            ACCESS MODE IS DYNAMIC
   143            RECORD KEY IS BDIEMSUP-LLAVE
   144            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   145 $SET IDXFORMAT"0"
   146
*  147     COPY BDIEENTI.FS.
   148* BDIEENTI-FS.v.0002
   149*******************************************
   150*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
   151*******************************************
   152
   153     SELECT BDIEENTI ASSIGN TO DISK SI-BDIEENTI
   154            ORGANIZATION IS INDEXED
   155            ACCESS IS DYNAMIC
   156            RECORD KEY IS BDIEENTI-LLAVE
   157            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   158
*  159     COPY BDACUE.FS.
   161*****************************************************************
   162* ARCHIVO DE TIPOS DE CUENTA DE DATACREDITO
   163*****************************************************************
   164$SET CONSTANT SW-STATUS-BDACUE"NO"
   165     SELECT BDACUE    ASSIGN TO DISK "$DATABASE/BDACUE"
   166           ORGANIZATION IS LINE SEQUENTIAL
   167           ACCESS MODE IS SEQUENTIAL
   168$IF SW-STATUS-BDACUE = "NO"
   169$DISPLAY ".............COMPILANDO BDACUE SIN STATUS.........."
   170$ELSE
   171$DISPLAY ".............COMPILANDO BDACUE CON STATUS.........."
   172X           FILE STATUS IS COD-RETORNO-BDACUE
   173$END
   174            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   4
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   175     SELECT ENTRADA  ASSIGN TO DISK ARCHIVO-ENTRADA
   176            ORGANIZATION   IS LINE SEQUENTIAL
   177            ACCESS MODE    IS SEQUENTIAL
   178            FILE STATUS    IS W-STATUS-ENT.
   179
   180     SELECT INCONSIS ASSIGN TO DISK ARCHIVO-INCONC
   181            ORGANIZATION   IS LINE SEQUENTIAL
   182            ACCESS MODE    IS SEQUENTIAL
   183            FILE STATUS    IS W-STATUS-INC.
   184
   185     SELECT SALIDA   ASSIGN  TO DISK ARCHIVO-SALIDA
   186            ORGANIZATION   IS LINE SEQUENTIAL
   187            ACCESS MODE    IS SEQUENTIAL.
   188
   189     SELECT ESTADIS  ASSIGN  TO DISK ARCHIVO-ESTADIS
   190            ORGANIZATION   IS LINE SEQUENTIAL
   191            ACCESS MODE    IS SEQUENTIAL.
   192
   193
   194 DATA DIVISION.
   195 FILE SECTION.
*  196 COPY ICBDIR0001.FD.                                              GDT0001
   197* ICBDIR0001-FD.V01.007.
   198* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS
   199* POR LOS DIFERENTES SUSCRIPTORES
   200******************************************************************
   201* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL
   202* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE
   203* FEB.15/2006  * DATACLIENTES.
   204******************************************************************
   205* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *
   206* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *
   207* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *
   208* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *
   209*              *          DIRECCION FUE GEOREFERENCIADA.         *
   210******************************************************************
   211* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *
   212* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *
   213* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *
   214******************************************************************
   215* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *
   216* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*
   217* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *
   218* JUL.25/2008  *                                                 *
   219******************************************************************
   220* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*
   221* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*
   222* SEP/07/2011  *          CIA.                                   *
   223******************************************************************
   224* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *
   225* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *
   226* OCT/25/2012  *          ACTUALIZO.                             *
   227******************************************************************
   228 FD  MAESTRO-DIRECC.
   229 01  REG-DIRECC.
   230     03  LLAVE-DIRECC.
   231         05  LLAVE-PRI-DIRECC.
   232             07  TIPO-ID-DIRECC    PIC 9(01).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   5
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   233             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002
   234         05  LLAVE-ALT-DIRECC.
   235             07  COD-SUS-DIRECC    PIC 9(06).
   236             07  COD-CTA-DIRECC    PIC 9(02).
   237             07  NUM-CTA-DIRECC    PIC X(18).
   238     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   239     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   240     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   241     03  CIURES-DIRECC             PIC X(20).                     FAC0002
   242     03  DPTRES-DIRECC             PIC X(20).                     FAC0002
   243     03  DIRRES-DIRECC             PIC X(60).                     FAC0002
   244     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002
   245     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002
   246     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005
   247     03  CIULAB-DIRECC             PIC X(20).                     FAC0002
   248     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002
   249     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002
   250     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002
   251     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002
   252     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005
   253     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002
   254     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002
   255     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002
   256     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   257     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005
   258     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002
   259     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002
   260     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   261     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005
   262     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   263***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003
   264***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003
   265***  COR-CORRESPONDENCIA)                                         VHF0003
   266***     CER???-DIRECC:                                            VHF0003
   267***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003
   268***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003
   269***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003
   270***     ADI???-DIRECC:                                            VHF0003
   271***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003
   272***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003
   273***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003
   274     03  CERRES-DIRECC             PIC 9(01).                     VHF0003
   275     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003
   276     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003
   277     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003
   278     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003
   279     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003
   280     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004
   281     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005
   282     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005
   283     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005
   284*    03  FILLER-DIRECC             PIC X(40).                     VHF0005
   285*    03  FILLER-DIRECC             PIC X(28).                     RMB0006
   286     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006
   287     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006
   288     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006
   289     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007
   290     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   6
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   291     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007
   292     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007
   293     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007
   294     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007
   295     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007
   296*    03  FILLER-DIRECC             PIC X(13).                     CAV0007
   297     03  FILLER-DIRECC             PIC X(06).                     CAV0007
*  298 COPY BDACSV.FD.                                                  GDT0001
   299* BDACSV-FD.v.0003
   300* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   301* DATOS OFICIALES DE REGIS, DIAN Y DAS
   302******************************************************************
   303* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
   304* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
   305* R.MARTINEZ *          POR T7
   306******************************************************************
   307* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
   308* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE
   309* LUIS GOMEZ *          CONFIABLE
   310******************************************************************
   311 FD  BDACSV.
   312 01  REG-BDACSV.
   313     03 LLAVE-BDACSV.
   314        05  TIPO-ID-BDACSV    PIC 9(01).
   315        05  NUM-ID-BDACSV     PIC 9(15).
   316        05  COD-SUS-BDACSV    PIC 9(06).
   317        05  COD-CTA-BDACSV    PIC 9(02).
   318        05  NUM-CTA-BDACSV    PIC X(25).
   319     03  NOMBRE-BDACSV        PIC X(45).
   320     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003
   321        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003
   322        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003
   323        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003
   324     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
   325     03  FECHA-CREA-BDACSV       PIC 9(08).
   326     03  NUM-PORTAF-BDACSV    PIC 9(02).
   327     03  IND-NOMBRE-BDACSV    PIC 9(02).
   328     03  MEJOR-PORTAF-BDACSV  PIC 9(02).
   329     03  IND-ACTUALIZ-BDACSV  PIC 9(02).
   330     03  FUENTE-REG-BDACSV    PIC 9(02).
   331     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002
   332     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002
   333*    03  FILLER               PIC X(50).                          STT0003
   334     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003
   335         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003
   336         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003
   337         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003
   338         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003
   339         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003
   340         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003
   341         05  IND-SEXO-BDACSV       PIC X.                         STT0003
   342         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003
   343         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003
   344         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003
   345     03  FILLER                    PIC X(07).                     STT0003
   346*    03  FILLER               PIC X(48).
   347
   348
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   7
* ).FD)S)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   349
*  350 COPY NOAMNISTIA21.FD.                                            GDT0001
   351* NOAMNISTIA21-FD.v.0001
   352* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
   353* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
   354******************************************************************
   355******************************************************************
   356 FD  NOAMNISTIA21.
   357 01  REG-NOAMNISTIA21.
   358     03 LLAVE-NOAMNISTIA21.
   359        05  TIPO-ID-NOAMNISTIA21      PIC 9(01).
   360        05  NUM-ID-NOAMNISTIA21       PIC 9(11).
   361     03  FECHA-CREA-NOAMNISTIA21      PIC 9(08).
   362     03  FILLER                       PIC X(10).
   363*                                                                 GDT0001
   364 FD  ENTRADA.
   365 01  REG-ENTRADA.
   366     03 ENT-TIPO-ID               PIC 9(01).
   367     03 ENT-NUME-ID               PIC 9(11).
   368     03 ENT-NOMBRE                PIC X(45).
   369     03 ENT-FEC-EXPED             PIC 9(08).
   370     03 ENT-CIUDAD-EXP            PIC X(15).
   371     03 ENT-DEP-EXP-VAL           PIC X(15).
   372     03 ENT-VIG-VAL               PIC X(02).
   373     03 ENT-GENERO-VAL            PIC X(01).
   374     03 ENT-EDAD                  PIC X(03).
   375     03 ENT-EDAD-RANGO            PIC X(05).
   376     03 FILLER                    PIC X(51).
   377
   378 FD  INCONSIS.
   379 01  REG-INCONSIS.
   380     03 TIP-INC                   PIC 9.
   381     03 CED-INC                   PIC 9(11).
   382     03 NOM1-INC                  PIC X(45).
   383     03 NOM2-INC                  PIC X(45).
   384     03 FEC-EXP-INC               PIC 9(08).
   385     03 MUN-EXP-INC               PIC X(15).
   386     03 DEP-EXP-INC               PIC X(15).
   387     03 VIG-INC                   PIC X(02).
   388     03 CODERR-INC                PIC 9(02).
   389     03 FILLER-2-INC              PIC X(60).
   390
   391
   392 FD  SALIDA.
   393 01  REG-SALIDA.
   394     03 SLD-TIPO-ID                    PIC 9(01).
   395     03 FILLER01                       PIC X(01) VALUE ";".
   396     03 SLD-NUME-ID                    PIC 9(11).
   397     03 FILLER02                       PIC X(01) VALUE ";".
   398     03 SLD-NOMBRE                     PIC X(45).
   399     03 FILLER03                       PIC X(01) VALUE ";".
   400     03 SLD-RANGO-EDAD                 PIC X(05).
   401     03 FILLER04                       PIC X(01) VALUE ";".
   402     03 SLD-GENERO                     PIC X(01).
   403     03 FILLER05                       PIC X(01) VALUE ";".
   404     03 SLD-CIUDAD-EXPED               PIC X(15).
   405     03 FILLER06                       PIC X(01) VALUE ";".
   406     03 SLD-CREDITOS-ACTV              PIC 9(04).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   8
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   407     03 FILLER07                       PIC X(01) VALUE ";".
   408     03 SLD-NUM-OBLIG-CAB              PIC 9(04).
   409     03 FILLER08                       PIC X(01) VALUE ";".
   410     03 SLD-TOT-INICIAL-CAB            PIC 9(15).
   411     03 FILLER09                       PIC X(01) VALUE ";".
   412     03 SLD-TOT-SALDOS-CAB             PIC 9(15).
   413     03 FILLER10                       PIC X(01) VALUE ";".
   414     03 SLD-TOT-CUOTAS-CAB             PIC 9(11).
   415     03 FILLER11                       PIC X(01) VALUE ";".
   416     03 SLD-TOT-MORA-CAB               PIC 9(11).
   417     03 FILLER12                       PIC X(01) VALUE ";".
   418     03 SLD-NUM-OBLIG-CAV              PIC 9(04).
   419     03 FILLER13                       PIC X(01) VALUE ";".
   420     03 SLD-TOT-INICIAL-CAV            PIC 9(15).
   421     03 FILLER14                       PIC X(01) VALUE ";".
   422     03 SLD-TOT-SALDOS-CAV             PIC 9(15).
   423     03 FILLER15                       PIC X(01) VALUE ";".
   424     03 SLD-TOT-CUOTAS-CAV             PIC 9(11).
   425     03 FILLER16                       PIC X(01) VALUE ";".
   426     03 SLD-TOT-MORA-CAV               PIC 9(11).
   427     03 FILLER17                       PIC X(01) VALUE ";".
   428     03 SLD-NUM-OBLIG-OTR              PIC 9(04).
   429     03 FILLER18                       PIC X(01) VALUE ";".
   430     03 SLD-TOT-INICIAL-OTR            PIC 9(15).
   431     03 FILLER19                       PIC X(01) VALUE ";".
   432     03 SLD-TOT-SALDOS-OTR             PIC 9(15).
   433     03 FILLER20                       PIC X(01) VALUE ";".
   434     03 SLD-TOT-CUOTAS-OTR             PIC 9(11).
   435     03 FILLER21                       PIC X(01) VALUE ";".
   436     03 SLD-TOT-MORA-OTR               PIC 9(11).
   437     03 FILLER22                       PIC X(01) VALUE ";".
   438     03 SLD-TOT-NUM-TDC                PIC 9(04).
   439     03 FILLER23                       PIC X(01) VALUE ";".
   440     03 SLD-TOT-CUPOS-TDC              PIC 9(15).
   441     03 FILLER24                       PIC X(01) VALUE ";".
   442     03 SLD-TOT-SALDO-TDC              PIC 9(15).
   443     03 FILLER25                       PIC X(01) VALUE ";".
   444     03 SLD-POR-UTILIZ-TDC             PIC Z.ZZZZZ.
   445     03 FILLER26                       PIC X(01) VALUE ";".
   446     03 SLD-TOT-CUOTAS-TDC             PIC 9(11).
   447     03 FILLER27                       PIC X(01) VALUE ";".
   448     03 SLD-TOT-MORA-TDC               PIC 9(11).
   449     03 FILLER28                       PIC X(01) VALUE ";".
   450     03 SLD-NRO-RANGO-0                PIC 9(03).
   451     03 FILLER29                       PIC X(01) VALUE ";".
   452     03 SLD-NRO-RANGO-1                PIC 9(03).
   453     03 FILLER30                       PIC X(01) VALUE ";".
   454     03 SLD-NRO-RANGO-2                PIC 9(03).
   455     03 FILLER31                       PIC X(01) VALUE ";".
   456     03 SLD-NRO-RANGO-3                PIC 9(03).
   457     03 FILLER32                       PIC X(01) VALUE ";".
   458     03 SLD-NRO-RANGO-4                PIC 9(03).
   459     03 FILLER33                       PIC X(01) VALUE ";".
   460     03 SLD-NRO-RANGO-5                PIC 9(03).
   461     03 FILLER34                       PIC X(01) VALUE ";".
   462     03 SLD-NRO-RANGO-6                PIC 9(03).
   463     03 FILLER35                       PIC X(01) VALUE ";".
   464     03 SLD-FECHA-TDC                  PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   9
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   465     03 FILLER36                       PIC X(01) VALUE ";".
   466     03 SLD-NUM-OBLIG-REAL             PIC 9(04).
   467     03 FILLER37                       PIC X(01) VALUE ";".
   468     03 SLD-TOT-INICIAL-REAL           PIC 9(15).
   469     03 FILLER38                       PIC X(01) VALUE ";".
   470     03 SLD-TOT-SALDOS-REAL            PIC 9(15).
   471     03 FILLER39                       PIC X(01) VALUE ";".
   472     03 SLD-TOT-CUOTAS-REAL            PIC 9(11).
   473     03 FILLER40                       PIC X(01) VALUE ";".
   474     03 SLD-TOT-MORA-REAL              PIC 9(11).
   475     03 FILLER41                       PIC X(01) VALUE ";".
   476     03 SLD-NUM-OBLIG-TELE             PIC 9(04).
   477     03 FILLER42                       PIC X(01) VALUE ";".
   478     03 SLD-TOT-CUOTAS-TELE            PIC 9(11).
   479     03 FILLER43                       PIC X(01) VALUE ";".
   480     03 SLD-TOT-MORA-TELE              PIC 9(11).
   481     03 FILLER44                       PIC X(01) VALUE ";".
   482     03 SLD-NUM-OBLIG-COOP             PIC 9(04).
   483     03 FILLER45                       PIC X(01) VALUE ";".
   484     03 SLD-TOT-INICIAL-COOP           PIC 9(15).
   485     03 FILLER46                       PIC X(01) VALUE ";".
   486     03 SLD-TOT-SALDOS-COOP            PIC 9(15).
   487     03 FILLER47                       PIC X(01) VALUE ";".
   488     03 SLD-TOT-CUOTAS-COOP            PIC 9(11).
   489     03 FILLER48                       PIC X(01) VALUE ";".
   490     03 SLD-TOT-MORA-COOP              PIC 9(11).
   491     03 FILLER49                       PIC X(01) VALUE ";".
   492     03 SLD-NUM-OBLIG-CODEU            PIC 9(04).
   493     03 FILLER50                       PIC X(01) VALUE ";".
   494     03 SLD-TOT-SALDOS-CODEU           PIC 9(15).
   495     03 FILLER51                       PIC X(01) VALUE ";".
   496     03 SLD-TOT-CUOTAS-CODEU           PIC 9(11).
   497     03 FILLER52                       PIC X(01) VALUE ";".
   498     03 SLD-TOT-MORA-CODEU             PIC 9(11).
   499     03 FILLER53                       PIC X(01) VALUE ";".
   500     03 SLD-CREDITOS-ALDIA             PIC 9(03).
   501     03 FILLER54                       PIC X(01) VALUE ";".
   502     03 SLD-MORA-30                    PIC 9(03).
   503     03 FILLER55                       PIC X(01) VALUE ";".
   504     03 SLD-MORA-60                    PIC 9(03).
   505     03 FILLER56                       PIC X(01) VALUE ";".
   506     03 SLD-MORA-90                    PIC 9(03).
   507     03 FILLER57                       PIC X(01) VALUE ";".
   508     03 SLD-MORA-120                   PIC 9(03).
   509     03 FILLER58                       PIC X(01) VALUE ";".
   510     03 SLD-CAR-CASTIGA                PIC 9(03).
   511     03 FILLER59                       PIC X(01) VALUE ";".
   512     03 SLD-DUD-RECAUDO                PIC 9(03).
   513     03 FILLER60                       PIC X(01) VALUE ";".
   514     03 SLD-CUENTAS-COBRADOR           PIC 9(03).
   515     03 FILLER61                       PIC X(01) VALUE ";".
   516     03 SLD-MORA-30-HIS                PIC 9(03).
   517     03 FILLER62                       PIC X(01) VALUE ";".
   518     03 SLD-MORA-60-HIS                PIC 9(03).
   519     03 FILLER63                       PIC X(01) VALUE ";".
   520     03 SLD-MORA-90-HIS                PIC 9(03).
   521     03 FILLER64                       PIC X(01) VALUE ";".
   522     03 SLD-MORA-120-HIS               PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  10
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   523     03 FILLER65                       PIC X(01) VALUE ";".
   524     03 SLD-CANC-MMANEJO               PIC 9(03).
   525     03 FILLER66                       PIC X(01) VALUE ";".
   526     03 SLD-CAR-RECUPERADA             PIC 9(03).
   527     03 FILLER67                       PIC X(01) VALUE ";".
   528     03 SLD-MORA-MAX-TDC               PIC 9(03).
   529     03 FILLER68                       PIC X(01) VALUE ";".
   530     03 SLD-MORA-MAX-CAB               PIC 9(03).
   531     03 FILLER69                       PIC X(01) VALUE ";".
   532     03 SLD-MORA-MAX-COOP              PIC 9(03).
   533     03 FILLER70                       PIC X(01) VALUE ";".
   534     03 SLD-MORA-MAX-CAV               PIC 9(03).
   535     03 FILLER71                       PIC X(01) VALUE ";".
   536     03 SLD-END-CALIF-1-TRIM           PIC X(01).
   537     03 FILLER72                       PIC X(01) VALUE ";".
   538     03 SLD-END-CALIF-2-TRIM           PIC X(01).
   539     03 FILLER73                       PIC X(01) VALUE ";".
   540     03 SLD-CTAS-AHORRO                PIC 9(03).
   541     03 FILLER74                       PIC X(01) VALUE ";".
   542     03 SLD-CTES-CORRIENTES            PIC 9(03).
   543     03 FILLER75                       PIC X(01) VALUE ";".
   544     03 SLD-CTES-EMBARGADAS            PIC 9(03).
   545     03 FILLER76                       PIC X(01) VALUE ";".
   546     03 SLD-CTES-MAL-MANEJO            PIC 9(03).
   547     03 FILLER77                       PIC X(01) VALUE ";".
   548     03 SLD-CTES-SALDADAS              PIC 9(03).
   549     03 FILLER78                       PIC X(01) VALUE ";".
   550     03 SLD-TOTAL-CONSULTAS            PIC 9(03).
   551     03 FILLER79                       PIC X(01) VALUE ";".
   552     03 SLD-CALIFICACION               PIC X(01).
   553*-----------------------------------------------------------*
   554 FD  ESTADIS.
   555 01  REG-ESTADIS.
   556     03 SLD-DETALLE                    PIC X(30).
   557     03 FILLER                         PIC X(01) VALUE ";".
   558     03 SLD-ESTADIS-VALOR-1            PIC Z(11).
   559     03 FILLER                         PIC X(01) VALUE ";".
   560     03 SLD-ESTADIS-VALOR-2            PIC Z(11).
   561     03 FILLER                         PIC X(01) VALUE ";".
   562     03 SLD-ESTADIS-VALOR-3            PIC Z(11).
   563     03 FILLER                         PIC X(01) VALUE ";".
   564     03 SLD-ESTADIS-VALOR-4            PIC Z(11).
   565     03 FILLER                         PIC X(01) VALUE ";".
   566     03 SLD-ESTADIS-VALOR-5            PIC Z(07).
   567
*  568 COPY ICBSUS.FD.
   571*******************************************************************
   572* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR
   573* F.CUADROS *         DATAHOST
   574* FEB.2003  *
   575*******************************************************************
   576* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES
   577* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.
   578* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES
   579******************************************************************
   580* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL
   581* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR
   582* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  11
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   583******************************************************************
   584* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE
   585* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL
   586* ENE. 07/2004 * HABITO DE PAGO.
   587******************************************************************
   588* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE
   589* F.CUADROS C. * FRAUDE
   590* JUN. 04/2004 *
   591******************************************************************
   592* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES
   593* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.
   594* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL
   595*              * A SUI, 2-PASO AUTOMATICO A SUI.
   596******************************************************************
   597* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE
   598* F.CUADROS C. * ENDEUDAMIENTO GLOBAL
   599* MAR. 14/2005 *
   600******************************************************************
   601* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO
   602* R.MARTINEZ   * A TRAVES DE DATA WEB
   603* ABR. 21/2005 *
   604******************************************************************
   605* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS
   606* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-
   607* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO
   608******************************************************************
   609* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *
   610* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *
   611* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *
   612******************************************************************
   613* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *
   614* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *
   615* NOV. 01/2005 *                                                 *
   616******************************************************************
   617* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *
   618* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *
   619* MAR.17/2006  *
   620******************************************************************
   621* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*
   622* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *
   623* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *
   624******************************************************************
   625* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIÓN DE *
   626* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *
   627* JUL.05/2006  *                                                 *
   628******************************************************************
   629* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*
   630* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *
   631* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *
   632******************************************************************
   633* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *
   634* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*
   635* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *
   636******************************************************************
   637* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*
   638* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*
   639* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *
   640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  12
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   641* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *
   642* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *
   643* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *
   644*              * S- SI -DEFAULT
   645******************************************************************
   646* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *
   647* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*
   648* JULIO /2009  *         LIZADOR O NO.                           *
   649******************************************************************
   650* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *
   651* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *
   652* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO ASÍ: 0-NO CERTI*
   653*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *
   654*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*
   655*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *
   656*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *
   657*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *
   658******************************************************************
   659* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS
   660* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *
   661* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*
   662*              *         PRODUCTO) = 0
   663*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO
   664*              *          = 1
   665*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*
   666*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *
   667*              *         CONSULTA DATAHOST O WEBSERVICE          *
   668******************************************************************
   669* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*
   670* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*
   671* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*
   672*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *
   673******************************************************************
   674* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *
   675* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *
   676* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *
   677******************************************************************
   678* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *
   679* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *
   680* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *
   681*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *
   682******************************************************************
   683* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *
   684* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *
   685* FEBRERO/2013 *         DE SUSCRIPTOR.                          *
   686*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *
   687*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*
   688*              *         NUMERO DE TARJETA.                      *
   689*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *
   690******************************************************************
   691 FD  SUSCRIPTOR.
   692 01  REG-SUSCRIPTOR.
   693     03  COD-SUSCRIP-ABD02       PIC 9(6).
   694     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02
   695                                 PIC X(6).
   696     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.
   697     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012
   698     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  13
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   699     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.
   700*        04 FILLER               PIC X(16).                       FAC0012
   701         04 NOM-COR1-ABD02       PIC X(14).
   702         04 NOM-COR2-ABD02       PIC X(14).
   703         04 IND-COR-ABD02        PIC 9.
   704     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009
   705     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.
   706     03  IND-REGIST-ABD02        PIC 99    COMP-3.
   707     03  ESTADO-ABD02            PIC 9     COMP-3.
   708     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.
   709     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.
   710     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.
   711     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.
   712     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5
   713     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1
   714     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1
   715     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017
   716     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015
   717     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008
   718     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008
   719     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008
   720     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009
   721     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009
   722     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009
   723     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009
   724     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009
   725     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010
   726     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011
   727     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013
   728     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014
   729     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016
   730     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018
   731     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019
   732     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020
   733     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021
   734     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022
   735     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023
   736     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024
   737     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025
   738     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026
   739     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027
   740     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028
   741     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029
   742     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029
   743     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030
   744     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030
   745     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031
   746     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031
   747     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032
   748     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033
   749     03  DIRRES-ABD02            PIC X(01).                       RMB0034
   750     03  TELRES-ABD02            PIC X(01).                       RMB0034
   751     03  DIRLAB-ABD02            PIC X(01).                       RMB0034
   752     03  TELLAB-ABD02            PIC X(01).                       RMB0034
   753     03  DIRCOR-ABD02            PIC X(01).                       RMB0034
   754     03  TELCEL-ABD02            PIC X(01).                       RMB0034
   755     03  E-MAIL-ABD02            PIC X(01).                       RMB0034
   756     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  14
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   757     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036
   758     03  FILLER-ABD02-2          PIC X(05).                       CAV0036
   759*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036
   760*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034
   761*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033
*  762 COPY ICBCON.001.FD.
   763* ICBCON-FD.0004
   764* ARCHIVO QUE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
   765* TIPO 5
   766*******************************************************************
   767* RMB003       * FENA001: PARA LAS CONSULTAS REPETIDAS (MISMO DIA *
   768* R.MARTINEZ.  * SUSCRIPTOR, CLAVE) SE DEJA UN SOLA CONSULTA Y LA *
   769* JULIO 30/2001* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   770*              * NUM-CONS-IND.                                    *
   771*----------------------------------------------------------------**
   772* RMB003       * SCR002: PARA MANEJO DE PREFILTRO SE REDEFINEN    *
   773* R.MARTINEZ.  * CAMPOS.                                          *
   774* AGOS. 30/2002* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   775*----------------------------------------------------------------**
   776* GJC0004      * AMPLI1: AMPLIACION DEL ARCHIVO DE CONSULTA DE    *
   777* G.JIMENEZ.   * 50 A 123 POSICIONES, SE AMPLIA CON FILLER DE 50  *
   778* ENE.03/2003  * CARACTERES.                                      *
   779* FAC0004      * INCLUSION DE NUEVOS CAMPOS                       *
   780* ENE.22/2003  *                                                  *
   781*----------------------------------------------------------------**
   782 FD  INDEXADO.
   783*    FILE OF SUCCESSFUL INQUIRIES, FOR BILLING AND SUSPICIOUS
   784*    NUMBER OF CREDIT INQUIRIES
   785 01  REG-INDEX.
   786     03  COD-SUSCRIP-IND         PIC 9(6).
   787     03  FEC-CONSUL-IND          PIC 9(6).
   788     03  LLAVE-INDEX.
   789         05  TIP-ID-IND          PIC 9.
   790         05  NUM-ID-IND          PIC 9(11).
   791         05  CONSECUTIVO-IND     PIC 9(2).
   792*    SCORES 0=score10,1-9= SCORE1-9
   793     03  SCO-PRE-INDEX           PIC 9.
   794     03  CIUDAD-CONS-IND         PIC 9(2).
   795     03  OFICINA-CONS-IND        PIC X(15).
   796     03  NUM-CONS-IND            PIC 99.                           RMB003
   797     03  FILLER-INDEX.
   798         05 PRE-SCORE-INDEX      PIC X VALUE SPACES.
   799         05 PUN-SCORE-INDEX      PIC S9(05) COMP-3.
   800     03  RAZCON-IND              PIC 99.                          GJC0004
   801     03  TIP-SCORE-IND           PIC 9(3).                        FAC0004
   802     03  CLASIFICA-IND           PIC X(2).                        FAC0004
   803     03  CALIFICA-IND            PIC S9(3)V99.                    FAC0004
   804     03  CLAVE-IND               PIC X(5).                        FAC0004
   805     03  CONTADOR-IND            PIC 9(3).                        FAC0004
   806     03  FILLER-1-INDEX          PIC X(50).                       GJC0004
*  807 COPY ICBCHK.FD.
   808* ICBCHK.-FD.v.0009
   809* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO
   810* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES
   811*----------------------------------------------------------------*
   812******************************************************************
   813* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   814* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  15
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   815* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   816* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   817* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   818*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   819*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   820*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   821*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   822******************************************************************
   823* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*
   824* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *
   825*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   826* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *
   827*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   828******************************************************************
   829* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   830* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   831* 04/MAY/2009 *          CREDITO.                                *
   832******************************************************************
   833* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *
   834* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *
   835* 04/ENE/2010 *                                                  *
   836******************************************************************
   837* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   838* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   839* OCTUBRE/2010*          SON MÁS DE 10                           *
   840******************************************************************
   841
   842 FD  MAESTRO-CHECK.
   843*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2
   844 01  COMPLETO-ABD06.
   845     03  LLAVE-MAES-CHECK.
   846         05  LLAVE-MAES-CHECK-PRI.
   847             07  TIPO-ID-ABD06     PIC 9.
   848             07  NUM-ID-ABD06      PIC 9(11).
   849         05  LLAVE-MAES-CHECK-ALT.
   850             07  COD-SUS-ABD06     PIC 9(6).
   851             07  COD-CTA-ABD06     PIC 99.
   852             07  NUM-CTA-ABD06     PIC X(18).
   853     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.
   854     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.
   855     03  CALIFIC-ABD06             PIC 9     COMP-3.
   856     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.
   857     03  NOV-REPORT-ABD06          PIC 99    COMP-3.
   858     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.
   859     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.
   860     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.
   861     03  ADJETIVO-ABD06            PIC 9     COMP-3.
   862     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.
   863     03  ART15-ABD06               PIC 9     COMP-3.
   864     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005
   865         REDEFINES                 ART15-ABD06.                   VHF0005
   866     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.
   867     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005
   868                                   PIC 9(3).                      FAC0005
   869     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005
   870         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005
   871         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006
   872         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  16
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   873
   874     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH
   875*    03  FILLER-ABD06              PIC X(8).                      AMPLIA
   876     03  OFICINA-ABD06             PIC X(15).                     AMPINF5
   877     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5
   879     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004
   880     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008
   881         REDEFINES FEC-NOVANT-ABD06.                              CAV0008
   882     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004
   883*    03  FILLER-ABD06              PIC X(4).                      CAV0007
   884     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007
   885     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007
   886     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007
   887     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009
*  888 COPY ICBCRE.FD.
   889* ICBCRE-FD.v.02.0013
   890* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS
   891* POR LOS DIFERENTES SUSCRIPTORES
   892*----------------------------------------------------------------*
   893******************************************************************
   894* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   895* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   896* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   897* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   898* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   899*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   900*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   901*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   902*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   903******************************************************************
   904* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*
   905* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *
   906*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   907* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *
   908*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   909******************************************************************
   910* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *
   911* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *
   912*             *          CUARTO AÑO DE HISTORIA CREDITICIA       *
   913* 09/AGO/2007 *                                                  *
   914******************************************************************
   915* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   916* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   917* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *
   918*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *
   919*             *          ENDEUDAMIENTO                           *
   920******************************************************************
   921* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   922* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   923* OCTUBRE/2010*          SON MÁS DE 10                           *
   924******************************************************************
   925* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *
   926* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *
   927* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *
   928******************************************************************
   929 FD  MAESTRO-CREDIT.
   930 01  COMPLETO-ABD07.
   931     03  LLAVE-MAES-CREDIT.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  17
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   932         05  LLAVE-MAES-CREDIT-PRI.
   933             07  TIPO-ID-ABD07     PIC 9.
   934             07  NUM-ID-ABD07      PIC 9(11).
   935         05  LLAVE-MAES-CREDIT-ALT.
   936             07  COD-SUS-ABD07     PIC 9(6).
   937             07  COD-CTA-ABD07     PIC 99.
   938             07  NUM-CTA-ABD07     PIC X(18).
   939             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA
   940                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA
   941                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA
   942     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.
   943     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.
   944     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.
   945     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.
   946     03  CALIFIC-ABD07             PIC 9     COMP-3.
   947     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.
   948     03  NOV-REPORT-ABD07          PIC 99    COMP-3.
   949     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.
   950     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.
   951     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.
   952     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AÑO 1   JGR0010
   953         REDEFINES                 ESTADO-MES-ABD07.               JGR0010
   954     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.
   955     03  ADJETIVO1-ABD07           PIC 9     COMP-3.
   956     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.
   957     03  ADJETIVO2-ABD07           PIC 9     COMP-3.
   958     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.
   959     03  ADJETIVO3-ABD07           PIC 9     COMP-3.
   960     03  ART15-ABD07               PIC 9     COMP-3.
   961     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008
   962         REDEFINES                 ART15-ABD07.                   VHF0008
   963     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.
   964     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008
   965                                   PIC 9(3).                      FAC0008
   966     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008
   967         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008
   968         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009
   969         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009
   970         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011
   971            FILLER-RECLAMO-ABD07.                                 GJC0011
   972         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011
   973            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011
   974         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011
   975            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011
   976*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013
   977     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013
   978     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013
   979         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013
   980     03  CALIFIC-R-ABD07           PIC 9     COMP-3.
   981     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.
   982     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007
   983                                   PIC 9     COMP-3.
   984     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.
   985     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.
   986     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.
   987     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007
   988                                   PIC X(02).                     FAC0007
   989     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  18
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   990     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AÑO 3   JGR0010
   991         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010
   992     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.
   993     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA
   994*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011
   995*                              *> CAMPOS                          GJC0011
   996*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011
   997*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011
   998*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011
   999*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011
  1000*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011
  1001*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011
  1002*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011
  1003*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011
  1004     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011
  1005* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011
  1006        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011
  1007        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011
  1008        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1009        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011
  1010        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1011* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011
  1012         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011
  1013         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011
  1014         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011
  1015         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011
  1016         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011
  1017         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011
  1018             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1019         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011
  1020             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1021         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011
  1022         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011
  1023         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011
  1024*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012
  1025         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012
  1026* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011
  1027     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA
  1028     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1029     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1030     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA
  1031     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA
  1032     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA
  1033     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA
  1034     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA
  1035     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA
  1036     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA
  1037     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA
  1038     03  SITUACION-ABD07            PIC X.                         AMPLIA
  1039     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA
  1040     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011
  1041         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011
  1042         05  CAMPOS-TARJETA-ABD07.                                GJC0011
  1043             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011
  1044             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011
  1045                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011
  1046         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012
  1047     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  19
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
  1048     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA
  1049     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1050*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1051     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7
  1052     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA
  1053     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010
  1054         REDEFINES                  VECTOR-2-ABD07.     *> AÑO 2   JGR0010
  1055     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5
  1056     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5
  1057     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5
  1058     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5
  1059     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7
  1060     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002
  1061     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AÑO 4   JGR0010
  1062         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010
  1063
* 1064 COPY BDIEMSUP.FD.
  1065* BDIEMSUP-FD.v.0005
  1066*-------------------------------------------
  1067*  MAESTRO CON INFORMACION SUPERINTENDENCIA
  1068*-------------------------------------------
  1069******************************************************************
  1070* GJC0002   * MICROC: SE ADICIONA VARIABLE DE SUBTIPO DE DEUDA QUE
  1071* G.JIMENEZ * PERMITE IDENTIFICAR LOS MICROCREDITOS Y LAS
  1072* JUN./2003 * FIDUCIAS.
  1073******************************************************************
  1074* RMB0003   * DRP001: SE ADICIONA CAMPO PARA CALCULAR CAMBIO EN
  1075* R.MARTINEZ* EL REGISTRO Y ACTUALIZAR EL DRP
  1076* DIC./2007 *
  1077******************************************************************
  1078* VHF0004     * GARANT - SE MODIFICA FILLER PARA GUARDAR         *
  1079* VICTOR HUGO *          INFORMACION DE GARANTIAS                *
  1080* FORERO      *                                                  *
  1081* SEP.24/2009 *                                                  *
  1082******************************************************************
  1083* LAG0005     * TIPGAR - BDIEMSUP-TIPGAR SE DEJA ALFANUMERICO    *
  1084* VICTOR HUGO *          PARA DEJAR "A" CUANDO VEGA 10, "B"      *
  1085* FORERO      *          CUANDA VENGA 11 Y "C" CUANDO VENGA 12   *
  1086* SEP.24/2009 *                                                  *
  1087******************************************************************
  1088 FD BDIEMSUP.
  1089 01 BDIEMSUP-REGISTRO.
  1090    03 BDIEMSUP-LLAVE.
  1091       05 BDIEMSUP-TIP-ID           PIC 9(1).
  1092       05 BDIEMSUP-NUM-ID           PIC 9(11).
  1093       05 BDIEMSUP-FECHA            PIC 9(8).
  1094       05 BDIEMSUP-TIP-ENTID        PIC 9(2).
  1095       05 BDIEMSUP-COD-ENTID        PIC 9(6).
  1096       05 BDIEMSUP-MONEDA           PIC X(1).
  1097       05 BDIEMSUP-TIP-DEUDA        PIC X(1).
  1098       05 BDIEMSUP-CALIFICA         PIC X(1).
  1099       05 BDIEMSUP-GARANTIA         PIC X(1).
  1100    03 BDIEMSUP-ENCABEZADO.
  1101       05 BDIEMSUP-DESCRIP          PIC X(45).
  1102       05 BDIEMSUP-CIIU             PIC 9(4).
  1103       05 BDIEMSUP-FEC-APERT        PIC 9(8).
  1104       05 BDIEMSUP-SUBTIPO-DEUDA    PIC X.                        GJC0002
  1105       05 FILLER                    PIC X(6).                     GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  20
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDIE
  1106    03 BDIEMSUP-ITEMS REDEFINES BDIEMSUP-ENCABEZADO.
  1107       05 BDIEMSUP-VALOR            PIC S9(14)  COMP-3.
  1108       05 BDIEMSUP-INTERES          PIC S9(14)  COMP-3.
  1109       05 BDIEMSUP-CONTING          PIC S9(14)  COMP-3.
  1110       05 BDIEMSUP-CANTIDAD         PIC 9(3)    COMP-3.
  1111       05 BDIEMSUP-IND-BLOQ         PIC 9(1)    COMP-3.
  1112       05 BDIEMSUP-ART-15           PIC 9(2)    COMP-3.
  1113       05 BDIEMSUP-FEC-ART-15       PIC 9(8)    COMP-3.
  1114       05 BDIEMSUP-FEC-ACTUALIZ     PIC 9(8)    COMP-3.
  1115       05 BDIEMSUP-ART-15-CTI       PIC 9(2)    COMP-3.
  1116       05 BDIEMSUP-FEC-ART-15-CTI   PIC 9(8)    COMP-3.
  1117       05 BDIEMSUP-NUM-RECLAMO      PIC 9(5)    COMP-3.
  1118       05 FILLER-X                  PIC X(14).                    VHF0004
  1119       05 BDIEMSUP-GAR              REDEFINES FILLER-X.           VHF0004
  1120          07 BDIEMSUP-VLRGAR        PIC S9(14)  COMP-3.           VHF0004
  1121          07 BDIEMSUP-TIPGAR        PIC X(1).                     LAG0005
  1122          07 BDIEMSUP-FECGAR        PIC S9(8)   COMP-3.           VHF0004
  1123       05 BDIEMSUP-DRP              PIC X(01).                    VHF0004
* 1124 COPY BDIEENTI.FD.
  1125* BDIEENTI-FD.v.0002
  1126******************************************************************
  1127* JGR0002     * NITENT - SE COMPARTE EL CAMPO NOMBRE DE LA       *
  1128* JAIRO GOMEZ.*          ENTIDAD, PARA PORDER GRABAR EL NUMERO   *
  1129*             *          DE NIT DE LA ENTIDAD REPORTANTE         *
  1130* 09/ENE/2008 *                                                  *
  1131******************************************************************
  1132********************************************
  1133*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
  1134********************************************
  1135
  1136 FD BDIEENTI.
  1137 01 BDIEENTI-REGISTRO.
  1138    03 BDIEENTI-LLAVE.
  1139       05 BDIEENTI-TIP-ENTID        PIC 9(2).
  1140       05 BDIEENTI-COD-ENTID        PIC 9(6).
  1141    03 BDIEENTI-NOM-ENTID.
  1142       05 BDIEENTI-NOMBRE           PIC X(29).                     JGR0002
  1143       05 BDIEENTI-NIT-ENTID        PIC 9(11).                     JGR0002
* 1144 COPY BDACUE.FD.
  1146* BDACUE.v.01.001
  1147*ARCHIVO TIPOS DE CUENTA VS. NOVEDADES Y ADJETIVOS VALIDOS
  1148*----------------------------------------------------------------*
  1149*-TABLA CON 10 OCURRENCIAS QUE CORRESPONDEN A CAMPOS DEL MAESTRO
  1150* RESUMIDO CON RANGO DE VALORES INICIAL Y FINAL PARA VALIDACION
  1151* TAB-RANGOS: EL ORDEN DE LOS CAMPOS ALMACENADOS ES CUOTA-MES,
  1152* VALOR-INICIAL, SALDO-DEUDA, SALDO-MORA, VALOR-DISPONIBLE, CUOTAS-
  1153* CANCELADAS, CUOTAS-EN-MORA, 3 OCURRENCIAS PARA USO FUTURO
  1154* IND-SECTOR-BDACUE: F-FINANCIERO, C-COOPERATIVO, R-REAL
  1155*-TABLA CON 15 INDICADORES DE LOS CAMPOS CONTENIDOS EN EL MAPA DE
  1156* BITS; VALOR=0 SI NO APLICA VALOR=1 SI APLICA AL TIPO DE CUENTA.
  1157*-CAMPOS CONTROL0X USADOS COMO DELIMITADORES.
  1158*----------------------------------------------------------------*
  1159* GJC0002    * NEWACT- PARA NUEVA ACTUALIZACION LOS ADJETIVOS
  1160* G JIMENEZ  *         VAN DE 1 A 9. SE DEFINE NUEVA TABLA DE
  1161* 21-07-2009 *         ADJETIVOS VALIDOS
  1162*****************************************************************
  1163 FD  BDACUE.
  1164 01  REG-BDACUE.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  21
* FD)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
  1165     03  TIP-CTA-BDACUE               PIC 9(2).
  1166     03  DES-CORTA-BDACUE             PIC X(3).
  1167     03  DES-LARGA-BDACUE             PIC X(21).
  1168     03  DES-COMPLETA-BDACUE          PIC X(30).
  1169     03  CONTROL01-BDACUE             PIC X(01).
  1170     03  IND-NOV-BDACUE OCCURS 35     PIC 9(1).
  1171     03  CONTROL02-BDACUE             PIC X(01).
  1172     03  IND-ADJ-BDACUE OCCURS 31     PIC 9(2).
  1173     03  CONTROL03-BDACUE             PIC X(01).
  1174     03  IND-SECTOR-BDACUE            PIC X(1).
  1175     03  CONTROL04-BDACUE             PIC X(01).
  1176     03  TAB-RANGOS-BDACUE OCCURS 10.
  1177         04 VAL-INI-BDACUE            PIC 9(10).
  1178         04 VAL-FIN-BDACUE            PIC 9(10).
  1179     03  CONTROL05-BDACUE             PIC X(01).
  1180     03  TAB-IND-VAL-BDACUE.
  1181         04 VEC-IND-VAL-BDACUE OCCURS 15 TIMES PIC 9.
  1182     03  CONTROL06-BDACUE             PIC X(01).
  1183     03  IND-ADJ-NWACT-BDACUE OCCURS 9 TIMES                      GJC0002
  1184                                      PIC 9.                      GJC0002
  1185     03  CONTROL07-BDACUE             PIC X(1).                   GJC0002
  1186     03  FILLER-BDACUE                PIC X(40).                  GJC0002
  1187
  1188*----------------------------------*
  1189 WORKING-STORAGE SECTION.
  1190*----------------------------------*
  1191 01  W-REG-SALIDA.
  1192     03 W-TIPO-ID                    PIC 9(01).
  1193     03 FILLER                       PIC X(01) VALUE ";".
  1194     03 W-NUME-ID                    PIC 9(11).
  1195     03 FILLER                       PIC X(01) VALUE ";".
  1196     03 W-NOMCLI                     PIC X(45).
  1197     03 FILLER                       PIC X(01) VALUE ";".
  1198     03 W-CALENDPERANT               PIC X(02).
  1199     03 FILLER                       PIC X(01) VALUE ";".
  1200     03 W-CALENDPERACT               PIC X(02).
  1201     03 FILLER                       PIC X(01) VALUE ";".
  1202     03 W-ACIERTA                    PIC 9(05).
  1203     03 FILLER                       PIC X(01) VALUE ";".
  1204     03 W-NUM-CTA                    PIC X(18).
  1205     03 FILLER                       PIC X(01) VALUE ";".
  1206     03 W-DESPRODU                   PIC X(35).
  1207     03 FILLER                       PIC X(01) VALUE ";".
  1208     03 W-SUSCRIPTOTOR               PIC X(40).
  1209     03 FILLER                       PIC X(01) VALUE ";".
  1210     03 W-FECHA-INICIAL              PIC X(06).
  1211     03 FILLER                       PIC X(01) VALUE ";".
  1212     03 W-FECHA-NOVEDAD              PIC X(06).
  1213     03 FILLER                       PIC X(01) VALUE ";".
  1214     03 W-NOVEDAD                    PIC X(10).
  1215     03 FILLER                       PIC X(01) VALUE ";".
  1216     03 W-VECTOR-1                   PIC X(48).
  1217     03 FILLER                       PIC X(01) VALUE ";".
  1218     03 W-VALOR-INI                  PIC 9(07).
  1219     03 FILLER                       PIC X(01) VALUE ";".
  1220     03 W-SALDO-CARTERA              PIC 9(07).
  1221     03 FILLER                       PIC X(01) VALUE ";".
  1222     03 W-SALDO-MORA                 PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  22
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1223     03 FILLER                       PIC X(01) VALUE ";".
  1224     03 W-VALOR-CUOTA                PIC 9(07).
  1225     03 FILLER                       PIC X(01) VALUE ";".
  1226     03 W-TIPOCLI                    PIC X(01).
  1227     03 FILLER                       PIC X(01) VALUE ";".
  1228     03 W-FECHA-VENCIM               PIC X(06).
  1229
  1230 01  W-VARIABLES.
  1231     03 W-VEC-APROBACI.
  1232        05 W-CC-SN            PIC X VALUE SPACES.                      **>
  1233        05 W-DR-SN            PIC X VALUE SPACES.
  1234        05 W-COBRA-SN         PIC X VALUE SPACES.
  1235        05 W-CALI-SN          PIC X VALUE SPACES.
  1236     03 FILLER  REDEFINES W-VEC-APROBACI.
  1237        05 W-VEC-APROBACI-X   PIC X(04).
  1238*
  1239     03 RELLENO                     PIC X(48).
  1240     03 FECHA-AUX                   PIC 9(04).
  1241     03 II                          PIC 9(04).
  1242     03 LL                          PIC 9(04).
  1243     03 TOPE-V                      PIC S9999     VALUE  ZEROS.
  1244     03 W-MESES-NOV                 PIC 9(04)     VALUE  ZEROS.
  1245     03 W-CREDITOS-ACTV             PIC 9(04)     VALUE  ZEROS.
  1246     03 W-NUM-OBLIG-CAB             PIC 9(04)     VALUE  ZEROS.
  1247     03 W-TOT-INICIAL-CAB           PIC 9(15)     VALUE  ZEROS.
  1248     03 W-TOT-SALDOS-CAB            PIC 9(15)     VALUE  ZEROS.
  1249     03 W-TOT-CUOTAS-CAB            PIC 9(11)     VALUE  ZEROS.
  1250     03 W-TOT-MORA-CAB              PIC 9(11)     VALUE  ZEROS.
  1251     03 W-NUM-OBLIG-CAV             PIC 9(04)     VALUE  ZEROS.
  1252     03 W-TOT-INICIAL-CAV           PIC 9(15)     VALUE  ZEROS.
  1253     03 W-TOT-SALDOS-CAV            PIC 9(15)     VALUE  ZEROS.
  1254     03 W-TOT-CUOTAS-CAV            PIC 9(11)     VALUE  ZEROS.
  1255     03 W-TOT-MORA-CAV              PIC 9(11)     VALUE  ZEROS.
  1256     03 W-NUM-OBLIG-OTR             PIC 9(04)     VALUE  ZEROS.
  1257     03 W-TOT-INICIAL-OTR           PIC 9(15)     VALUE  ZEROS.
  1258     03 W-TOT-SALDOS-OTR            PIC 9(15)     VALUE  ZEROS.
  1259     03 W-TOT-CUOTAS-OTR            PIC 9(11)     VALUE  ZEROS.
  1260     03 W-TOT-MORA-OTR              PIC 9(11)     VALUE  ZEROS.
  1261     03 W-TOT-NUM-TDC               PIC 9(04)     VALUE  ZEROS.
  1262     03 W-TOT-CUPOS-TDC             PIC 9(15)     VALUE  ZEROS.
  1263     03 W-TOT-SALDO-TDC             PIC 9(15)     VALUE  ZEROS.
  1264     03 W-SAL-CUPOS-TDC             PIC 9(11)     VALUE  ZEROS.
  1265     03 W-UTLIZACION-TDC            PIC 9(3)V9999 VALUE  ZEROS.
  1266     03 W-TOT-CUOTAS-TDC            PIC 9(11)     VALUE  ZEROS.
  1267     03 W-TOT-MORA-TDC              PIC 9(11)     VALUE  ZEROS.
  1268     03 W-NRO-RANGO-0               PIC 9(03)     VALUE  ZEROS.
  1269     03 W-NRO-RANGO-1               PIC 9(03)     VALUE  ZEROS.
  1270     03 W-NRO-RANGO-2               PIC 9(03)     VALUE  ZEROS.
  1271     03 W-NRO-RANGO-3               PIC 9(03)     VALUE  ZEROS.
  1272     03 W-NRO-RANGO-4               PIC 9(03)     VALUE  ZEROS.
  1273     03 W-NRO-RANGO-5               PIC 9(03)     VALUE  ZEROS.
  1274     03 W-NRO-RANGO-6               PIC 9(03)     VALUE  ZEROS.
  1275     03 W-FEC-MENOR-TDC.
  1276        05 W-ANO-MEN-TDC            PIC 9(04)     VALUE  ZEROS.
  1277        05 W-MES-MEN-TDC            PIC 9(02)     VALUE  ZEROS.
  1278     03 W-FEC-APERTURA.
  1279        05 W-ANO-APERTURA           PIC 9(04)     VALUE  ZEROS.
  1280        05 W-MES-APERTURA           PIC 9(02)     VALUE  ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  23
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1281     03 W-FEC-NOVEDAD.
  1282        05 W-ANO-NOV                PIC 9(04)     VALUE  ZEROS.
  1283        05 W-MES-NOV                PIC 9(02)     VALUE  ZEROS.
  1284     03 W-NUM-OBLIG-REAL            PIC 9(04)     VALUE  ZEROS.
  1285     03 W-TOT-INICIAL-REAL          PIC 9(15)     VALUE  ZEROS.
  1286     03 W-TOT-SALDOS-REAL           PIC 9(15)     VALUE  ZEROS.
  1287     03 W-TOT-CUOTAS-REAL           PIC 9(11)     VALUE  ZEROS.
  1288     03 W-TOT-MORA-REAL             PIC 9(11)     VALUE  ZEROS.
  1289     03 W-NUM-OBLIG-TELE            PIC 9(04)     VALUE  ZEROS.
  1290     03 W-TOT-CUOTAS-TELE           PIC 9(11)     VALUE  ZEROS.
  1291     03 W-TOT-MORA-TELE             PIC 9(11)     VALUE  ZEROS.
  1292     03 W-NUM-OBLIG-COOP            PIC 9(04)     VALUE  ZEROS.
  1293     03 W-TOT-INICIAL-COOP          PIC 9(15)     VALUE  ZEROS.
  1294     03 W-TOT-SALDOS-COOP           PIC 9(15)     VALUE  ZEROS.
  1295     03 W-TOT-CUOTAS-COOP           PIC 9(11)     VALUE  ZEROS.
  1296     03 W-TOT-MORA-COOP             PIC 9(11)     VALUE  ZEROS.
  1297     03 W-NUM-OBLIG-CODEU           PIC 9(04)     VALUE  ZEROS.
  1298     03 W-TOT-SALDOS-CODEU          PIC 9(15)     VALUE  ZEROS.
  1299     03 W-TOT-CUOTAS-CODEU          PIC 9(11)     VALUE  ZEROS.
  1300     03 W-TOT-MORA-CODEU            PIC 9(11)     VALUE  ZEROS.
  1301     03 W-CREDITOS-ALDIA            PIC 9(03)     VALUE  ZEROS.
  1302     03 W-MORAS-30-ACT              PIC 9(03)     VALUE  ZEROS.
  1303     03 W-MORAS-60-ACT              PIC 9(03)     VALUE  ZEROS.
  1304     03 W-MORAS-90-ACT              PIC 9(03)     VALUE  ZEROS.
  1305     03 W-MORAS-120-ACT             PIC 9(03) VALUE ZEROS.
  1306     03 W-CAR-CASTIGA               PIC 9(03) VALUE ZEROS.
  1307     03 W-DUD-RECAUDO               PIC 9(03) VALUE ZEROS.
  1308     03 W-CUENTAS-COBRADOR          PIC 9(03) VALUE ZEROS.
  1309     03 W-MORAS-30-HIS              PIC 9(03) VALUE ZEROS.
  1310     03 W-MORAS-60-HIS              PIC 9(03) VALUE ZEROS.
  1311     03 W-MORAS-90-HIS              PIC 9(03) VALUE ZEROS.
  1312     03 W-MORAS-120-HIS             PIC 9(03) VALUE ZEROS.
  1313     03 W-CANC-MMANEJO              PIC 9(03) VALUE ZEROS.
  1314     03 W-CAR-RECUPERADA            PIC 9(03) VALUE ZEROS.
  1315     03 W-MORA-MAX-TDC              PIC 9(03) VALUE ZEROS.
  1316     03 W-MORA-MAX-CAB              PIC 9(03) VALUE ZEROS.
  1317     03 W-MORA-MAX-COOP             PIC 9(03) VALUE ZEROS.
  1318     03 W-MORA-MAX-CAV              PIC 9(03) VALUE ZEROS.
  1319     03 W-CTAS-AHORROS              PIC 9(03) VALUE ZEROS.
  1320     03 W-CTES-CORRIENTES           PIC 9(03) VALUE ZEROS.
  1321     03 W-CTES-EMBARGADAS           PIC 9(03) VALUE ZEROS.
  1322     03 W-CTES-MAL-MANEJO           PIC 9(03) VALUE ZEROS.
  1323     03 W-CTES-SALDADAS             PIC 9(03) VALUE ZEROS.
  1324     03 W-TOTAL-CONSULTAS           PIC 9(03) VALUE ZEROS.
  1325     03 W-ALDIA-FINA                PIC 9(03) VALUE ZEROS.
  1326     03 W-ALDIA-REAL                PIC 9(03) VALUE ZEROS.
  1327     03 W-ALDIA-COOP                PIC 9(03) VALUE ZEROS.
  1328     03 W-ALDIA-TELE                PIC 9(03) VALUE ZEROS.
  1329     03 W-MORAS-FINA                PIC 9(03) VALUE ZEROS.
  1330     03 W-MORAS-REAL                PIC 9(03) VALUE ZEROS.
  1331     03 W-MORAS-COOP                PIC 9(03) VALUE ZEROS.
  1332     03 W-MORAS-TELE                PIC 9(03) VALUE ZEROS.
  1333     03 W-CC-DR-FINA                PIC 9(03) VALUE ZEROS.
  1334     03 W-CC-DR-REAL                PIC 9(03) VALUE ZEROS.
  1335     03 W-CC-DR-COOP                PIC 9(03) VALUE ZEROS.
  1336     03 W-CC-DR-TELE                PIC 9(03) VALUE ZEROS.
  1337     03 W-EDAD                      PIC 9(03) VALUE ZEROS.
  1338     03 FIN-CHECK                   PIC 9(01) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  24
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1339     03 SALIR-END                   PIC 9(01) VALUE ZEROS.
  1340     03 IND-E                       PIC 9(03) VALUE ZEROS.
  1341     03 F                           PIC 9(01) VALUE ZEROS.
  1342     03 J                           PIC 9(04) VALUE ZEROS.
  1343
  1344     03 W-ENDEUDA                   PIC X(01) VALUE SPACES.
  1345     03 IND-J                       PIC 9(02) VALUE ZEROS.
  1346     03 SW-CODEUDOR                 PIC 9(01) VALUE ZEROS.
  1347     03 TOPE-IND                    PIC 9(03) VALUE ZEROS.
  1348     03 SW-FECHA-LOW                PIC 9(01) VALUE ZEROS.
  1349     03 SW-END                      PIC 9(01) VALUE ZEROS.
  1350     03 FEC-MENOR-TDC               PIC 9(06) VALUE ZEROS.
  1351     03 EVALUA-FINAL                PIC 9(01) VALUE ZEROS.
  1352     03 CONT-LECTURA                PIC 9(03) VALUE ZEROS.
  1353     03 EVALUA-CREDITO              PIC 9(01) VALUE ZEROS.
  1354     03 EVALUA-ENDEUDA              PIC 9(01) VALUE ZEROS.
  1355     03 EVALUA-CTA-CTE              PIC 9(01) VALUE ZEROS.
  1356     03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.
  1357     03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.
  1358     03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.
  1359        05 W-ANO-EXPE               PIC 9(04).
  1360        05 W-MES-EXPE               PIC 9(02).
  1361        05 W-DIA-EXPE               PIC 9(02).
  1362     03 W-ACU-MMAX-TDC              PIC 9(03) VALUE ZEROS.
  1363     03 W-ACU-MMAX-CAB              PIC 9(03) VALUE ZEROS.
  1364     03 W-ACU-MMAX-COOP             PIC 9(03) VALUE ZEROS.
  1365     03 W-ACU-MMAX-CAV              PIC 9(03) VALUE ZEROS.
  1366     03 TEM-NRO-CTA.
  1367        05 TEM-NRO-CTA-C16          PIC X(16) VALUE ZEROS.
  1368        05 TEM-NRO-CTA-C17          PIC X(01) VALUE ZEROS.
  1369        05 TEM-NRO-CTA-C18          PIC X(01) VALUE ZEROS.
  1370     03 W-SUSCRIPTOR.
  1371        05 W-CODIGO-TIPOCTA         PIC 9(02).
  1372        05 W-CODIGO-RESTCTA         PIC 9(04).
  1373     03 W-TABLA-END-MAYOR.
  1374        05 W-TRIMESTRE-END  OCCURS   3 TIMES.
  1375           07 W-FECHA-END           PIC 9(08).
  1376           07 W-MAYOR-END           PIC X(01).
  1377     03 W-TABLA-SUS-CONSU.
  1378        05 W-SUS-CONSU      OCCURS  50 TIMES PIC 9(06).
  1379     03 W-FECHA-AUX                 PIC  9(04).
  1380     03 W-FECHA-AUX-R REDEFINES W-FECHA-AUX.
  1381        05 W-MES-AUX                PIC  9(02).
  1382        05 W-ANO-AUX                PIC  9(02).
  1383     03 W-FECHA-AUX1              PIC 9(06) VALUE ZEROS.
  1384     03 W-FECHA-AUX1-R REDEFINES W-FECHA-AUX1.
  1385        05 W-MES-AUX1             PIC 9(02).
  1386        05 W-ANO-AUX1             PIC 9(04).
  1387     03 W-FECHA-OK                PIC 9(06) VALUE ZEROS.
  1388     03 W-FECHA-OK-R REDEFINES W-FECHA-OK.
  1389        05 W-SLGANO-OK            PIC 9(04).
  1390        05 W-SLGANO-OK-R REDEFINES W-SLGANO-OK.
  1391           07 W-SGL-OK            PIC 9(02).
  1392           07 W-ANO-OK            PIC 9(02).
  1393        05 W-MES-OK               PIC 9(02).
  1394     03 W-FECHA-FINAL             PIC 9(06) VALUE ZEROS.
  1395     03 W-FECHA-APERTURA          PIC 9(06) VALUE ZEROS.
  1396
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  25
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1397*-------------------------------------------------------------*
  1398  01 FECHAS-AAAAMM.
  1399    02 FECHA-TAG                   PIC 9(6).
  1400    02 FILLER REDEFINES FECHA-TAG.
  1401       03 SIG-ANO-TAG              PIC 9(4).
  1402       03 FILLER REDEFINES SIG-ANO-TAG.
  1403          04 SIG-TAG               PIC 9(2).
  1404          04 ANO-TAG               PIC 9(2).
  1405       03 MES-TAG                  PIC 9(2).
  1406    02 FECHA-NOVEDAD07             PIC 9(6).
  1407    02 FILLER REDEFINES FECHA-NOVEDAD07.
  1408       03 SIG-ANO-NOV              PIC 9(4).
  1409       03 FILLER REDEFINES SIG-ANO-NOV.
  1410          04 SIG-NOV               PIC 9(2).
  1411          04 ANO-NOV               PIC 9(2).
  1412       03 MES-NOV                  PIC 9(2).
  1413    02 FECHA-APERTURA07            PIC 9(6).
  1414    02 FILLER REDEFINES FECHA-APERTURA07.
  1415       03 SIG-ANO-APE              PIC 9(4).
  1416       03 FILLER REDEFINES SIG-ANO-APE.
  1417          04 SIG-APE               PIC 9(2).
  1418          04 ANO-APE               PIC 9(2).
  1419       03 MES-APE                  PIC 9(2).
  1420    02 FECHA-VENCIMIENTO07         PIC 9(6).
  1421    02 FILLER REDEFINES FECHA-VENCIMIENTO07.
  1422       03 SIG-ANO-VEN              PIC 9(4).
  1423       03 FILLER REDEFINES SIG-ANO-VEN.
  1424          04 SIG-VEN               PIC 9(2).
  1425          04 ANO-VEN               PIC 9(2).
  1426       03 MES-VEN                  PIC 9(2).
  1427   02 FECHA-INGRESO               PIC 9(6).
  1428    02 FILLER REDEFINES FECHA-INGRESO.
  1429       03 SIG-ANO-ING              PIC 9(4).
  1430       03 FILLER REDEFINES SIG-ANO-ING.
  1431          04 SIG-ING               PIC 9(2).
  1432          04 ANO-ING               PIC 9(2).
  1433       03 MES-ING                  PIC 9(2).
  1434 01  FECHA-SITMMAAAA-ORI     PIC 9(6).
  1435 01  FILLER REDEFINES FECHA-SITMMAAAA-ORI.
  1436     03 FECHA-SITMM-ORI      PIC 9(2).
  1437     03 FECHA-SITAAAA-ORI    PIC 9(4).
  1438 01  FECHA-SITAAAAMM         PIC 9(6).
  1439 01  FILLER REDEFINES FECHA-SITAAAAMM.
  1440     03 FECHA-SITAAAA        PIC 9(4).
  1441     03 FECHA-SITMM          PIC 9(2).
  1442 01  FECHA-VALAAAAMM         PIC 9(6).
  1443 01  FILLER REDEFINES FECHA-VALAAAAMM.
  1444     03 FECHA-VALAAAA        PIC 9(4).
  1445     03 FECHA-VALMM          PIC 9(2).
  1446*---------------------------------------------------------------*
  1447 01  W-FECHA-MILENIO.
  1448     03 W-FMILENIO-SIGLO            PIC  9(02).
  1449     03 W-FMILENIO-ANIO             PIC  9(02).
  1450     03 W-FMILENIO-MES              PIC  9(02).
  1451*----------------------------------------------------------------*
  1452 01  W-CONSTANTES.
  1453     03 SW-READ-INC                 PIC 9(01) VALUE ZEROS.
  1454     03 W-IND                       PIC 9(02) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  26
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1455     03 LEIDOS                      PIC 9(08) VALUE ZEROS.
  1456     03 GRABADOS                    PIC 9(08) VALUE ZEROS.
  1457     03 END-RUN                     PIC X(01) VALUE " ".
  1458     03 W-STATUS-ENT                PIC 9(02) VALUE ZEROS.
  1459     03 W-STATUS-INC                PIC 9(02) VALUE ZEROS.
  1460*
  1461     03 W-RESET-LEIDOS              PIC 9(09) VALUE 9.
  1462     03 W-LEIDOS                    PIC 9(09) VALUE ZEROS.
  1463     03 W-LEIDOS-RED REDEFINES W-LEIDOS.
  1464        05 FILLER                   PIC 9(06).
  1465        05 CEROS                    PIC 9(03).
  1466     03 W-GRABADOS                  PIC 9(09) VALUE ZEROS.
  1467     03 W-SOLO-CODEUDORES           PIC 9(09) VALUE ZEROS.
  1468     03 W-SOLO-COOPERATIVAS         PIC 9(09) VALUE ZEROS.
  1469     03 W-SOLO-CERRADOS             PIC 9(09) VALUE ZEROS.
  1470     03 W-MORA-TOT-SEC-FINA         PIC 9(09) VALUE ZEROS.
  1471     03 W-MORA-TOT-SEC-REAL         PIC 9(09) VALUE ZEROS.
  1472     03 W-MORA-TOT-REAL-FINA        PIC 9(09) VALUE ZEROS.
  1473
  1474     03 W-FECHA-BASE                PIC 9(06) VALUE ZEROS.
  1475     03 W-OPCION                    PIC X(01) VALUE SPACES.
  1476     03 W-VECTOR-L                  PIC 9(02) VALUE 12.
  1477     03 END-RUN                     PIC X(01) VALUE SPACES.
  1478     03 W-CC                        PIC 9(05) VALUE ZEROS.
  1479     03 W-DR                        PIC 9(05) VALUE ZEROS.
  1480     03 W-COBRA                     PIC 9(05) VALUE ZEROS.
  1481     03 W-CALI                      PIC X(01) VALUE ZEROS.
  1482
  1483*------------------------------------------------------------*
  1484*     AREA WORK ACUMULADORES
  1485*------------------------------------------------------------*
  1486 01  W-ACUMULADORES-ESTA.
  1487     03 W-EDITOR-CON                PIC Z,ZZZ,ZZ9.
  1488     03 W-EDITOR-SIN                PIC Z,ZZZ,ZZ9.
  1489     03 W-EDITOR-INC                PIC Z,ZZZ,ZZ9.
  1490     03 W-EDITOR-TOT                PIC Z,ZZZ,ZZ9.
  1491     03 W-CON-INFORMACION           PIC 9(07) VALUE ZEROS.
  1492     03 W-SIN-INFORMACION           PIC 9(07) VALUE ZEROS.
  1493     03 W-INCONSISTENCIAS           PIC 9(07) VALUE ZEROS.
  1494*----------------------------------------------------------------*
  1495*     VARIABLES DEL MANEJO DE BDACUE                             *
  1496*----------------------------------------------------------------*
  1497 01  VAL-VARIABLES.
  1498     03  W-CTA-BDCUE                 PIC 9(02) VALUE ZEROS.
  1499     03  SW-LOAD-TBL                 PIC 9(01) VALUE ZEROS.
  1500     03  T                           PIC 9(04) VALUE ZEROS.
  1501     03  TOPE-T                      PIC 9(04) VALUE ZEROS.
  1502     03  TABLA-VAL-TIP-CTA OCCURS 100 TIMES.
  1503         04 VEC-VALOR-BDACUE OCCURS 15 TIMES PIC 9.
  1504*----------------------------------------------------------------*
  1505*     VARIABLES ESTADISTICAS                                     *
  1506*----------------------------------------------------------------*
  1507 01  W-ACUMULADORES-ESTA.
  1508     03 W-ESTADO-INF          OCCURS  3 TIMES.
  1509        05 W-TABLA-TIPO-ID    OCCURS  5 TIMES.
  1510           07 W-ACUM-TIPO-ID    PIC  9(07) VALUE ZEROS.
  1511*------------------------------------------------------------*
  1512*    ACUMULACION VARIABLES DEMOGRAFICAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  27
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1513*------------------------------------------------------------*
  1514     03 W-EDAD-66           PIC  9(07) VALUE ZEROS.
  1515     03 W-EDAD-56-65        PIC  9(07) VALUE ZEROS.
  1516     03 W-EDAD-46-55        PIC  9(07) VALUE ZEROS.
  1517     03 W-EDAD-36-45        PIC  9(07) VALUE ZEROS.
  1518     03 W-EDAD-29-35        PIC  9(07) VALUE ZEROS.
  1519     03 W-EDAD-22-28        PIC  9(07) VALUE ZEROS.
  1520     03 W-EDAD-18-21        PIC  9(07) VALUE ZEROS.
  1521*------------------------------------------------------------*
  1522*    ACUMULACION ESTADO ACTUAL
  1523*------------------------------------------------------------*
  1524     03 W-TOT-CAR-CASTIGA      PIC  9(07) VALUE ZEROS.
  1525     03 W-TOT-DUD-RECAUDO      PIC  9(07) VALUE ZEROS.
  1526     03 W-TOT-CTES-EMBARGADAS  PIC  9(07) VALUE ZEROS.
  1527     03 W-TOT-MORAS-120-ACT    PIC  9(07) VALUE ZEROS.
  1528     03 W-TOT-MORAS-90-ACT     PIC  9(07) VALUE ZEROS.
  1529     03 W-TOT-MORAS-60-ACT     PIC  9(07) VALUE ZEROS.
  1530     03 W-TOT-MORAS-30-ACT     PIC  9(07) VALUE ZEROS.
  1531     03 W-TOT-W-ENDEUDA        PIC  9(07) VALUE ZEROS.
  1532     03 W-TOT-ALDIA            PIC  9(07) VALUE ZEROS.
  1533     03 W-TOT-SIN-CTAS         PIC  9(07) VALUE ZEROS.
  1534*------------------------------------------------------------*
  1535*    ACUMULACION ESTADO SECTOR
  1536*------------------------------------------------------------*
  1537     03 W-TOT-CC-DR-FINA       PIC  9(07) VALUE ZEROS.
  1538     03 W-TOT-MORAS-FINA       PIC  9(07) VALUE ZEROS.
  1539     03 W-TOT-ALDIA-FINA       PIC  9(07) VALUE ZEROS.
  1540     03 W-TOT-CC-DR-REAL       PIC  9(07) VALUE ZEROS.
  1541     03 W-TOT-MORAS-REAL       PIC  9(07) VALUE ZEROS.
  1542     03 W-TOT-ALDIA-REAL       PIC  9(07) VALUE ZEROS.
  1543     03 W-TOT-CC-DR-COOP       PIC  9(07) VALUE ZEROS.
  1544     03 W-TOT-MORAS-COOP       PIC  9(07) VALUE ZEROS.
  1545     03 W-TOT-ALDIA-COOP       PIC  9(07) VALUE ZEROS.
  1546     03 W-TOT-CC-DR-TELE       PIC  9(07) VALUE ZEROS.
  1547     03 W-TOT-MORAS-TELE       PIC  9(07) VALUE ZEROS.
  1548     03 W-TOT-ALDIA-TELE       PIC  9(07) VALUE ZEROS.
  1549*------------------------------------------------------------*
  1550*    ACUMULACION VALORES TOTALES
  1551*------------------------------------------------------------*
  1552     03 W-SALDOS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1553     03 W-CUOTAS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1554     03 W-MORAS-SEC-FINA       PIC  9(15) VALUE ZEROS.
  1555     03 W-SALDOS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1556     03 W-CUOTAS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1557     03 W-MORAS-SEC-REAL       PIC  9(15) VALUE ZEROS.
  1558     03 W-SALDOS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1559     03 W-CUOTAS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1560     03 W-MORAS-SEC-COOP       PIC  9(15) VALUE ZEROS.
  1561
  1562*---------------------------------------------------------*
  1563 01  W-PARAMETROS              PIC  X(94) VALUE SPACES.
  1564*---------------------------------------------------------*
  1565
  1566*----------------------------------------------------------------*
  1567* Estas son las variables para analizar los vectores de          *
  1568* comportamiento de moras HISTORICAS (estado-mes-abd07) y        *
  1569* (vector-2-abd07)                                               *
  1570*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  28
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1571 01  WS-ESTADO-MES-1                        PIC 9(12).
  1572 01  WS-ESTADO-MES-2                        PIC 9(12).
  1573 01  WS-ESTADO-MES                          PIC 9(12).
  1574 01  WS-ESTADO-MES-R REDEFINES WS-ESTADO-MES.
  1575     03  WS-MES                             PIC X OCCURS 12 TIMES.
  1576 01  ESTADO-MES-IMP.
  1577     03  E-MES-IMP                          PIC X OCCURS 12 TIMES.
  1578
  1579 01  ESTADO-ANUAL.
  1580     03  CHAR-H                             PIC X OCCURS 12 TIMES.
  1581 01  I                                      PIC 9(3)   VALUE ZERO.
  1582
  1583 01  E                                      PIC 9(3)   VALUE ZERO.
  1584 01  K                                      PIC 9(4)   VALUE 01.
  1585 01  N                                      PIC 9(3)   VALUE ZERO.
  1586 01  TIV                                    PIC 9(3)   VALUE ZERO.
  1587 01  TFV                                    PIC 9(3)   VALUE ZERO.
  1588 01  F-AUX-1                                PIC 9(4)   VALUE ZERO.
  1589 01  F-AUX                                  PIC 9(4)   VALUE ZERO.
  1590 01  F-UACT-2                               PIC 9(4)   VALUE ZERO.
  1591 01  F-APE-7                                PIC 9(4)   VALUE ZERO.
  1592 01  F-ING-2                                PIC 9(4)   VALUE ZERO.
  1593 01  F-NOV-7                                PIC 9(4)   VALUE ZERO.
  1594 01  F-VIEJ                                 PIC 9(4)   VALUE ZERO.
  1595 01  ENCONTRO                               PIC 9(1)   VALUE ZERO.
  1596*01  RELLENO                                PIC 9(1)   VALUE ZERO.
  1597 01  CINCO                                  PIC 9(2)   VALUE 5.
  1598 01  NUEVO                                  PIC 9      VALUE 0.
  1599 01  COD-SUSCRIP-AUX                        PIC 9(6)   VALUE ZERO.
  1600*------------------------------------------------------------*
  1601 01  VECTOR-S.
  1602     03 VECTOR-A-R1                        PIC X(24).
  1603     03 VECTOR-A-R2                        PIC X(24).
  1604 01  VECTOR-S-12.
  1605     03 VECTOR-N-R1                        PIC X(24).
  1606     03 VECTOR-N-R2                        PIC X(24).
  1607*------------------------------------------------------------*
  1608  01 V-NOR.
  1609     02 V-NOR1                     PIC 9(12).
  1610     02 V-NOR2                     PIC 9(12).
  1611     02 V-NOR3                     PIC 9(12).
  1612     02 V-NOR4                     PIC 9(12).
  1613  01 V-NOR-AUX     PIC X(47) VALUE SPACES.
  1614
  1615  01 VECTORES-W.
  1616    02 VECTOR-MORA.
  1617       03 FILLER PIC X(25) VALUE "5PMPPPPPPPPP5555123411212".
  1618       03 FILLER PIC X(25) VALUE "3234123412341234999CRD999".
  1619    02 FILLER REDEFINES VECTOR-MORA.
  1620       03 V-MORA OCCURS 50 TIMES PIC X.
  1621*------------------------------------------------------------*
  1622 01  SALIDA-48.
  1623     05 S48-EST                     PIC X(15).
  1624     05 S48-SUS                     PIC X(14).
  1625     05 S48-FEC                     PIC 9(6).
  1626     05 S48-FECALPHA REDEFINES S48-FEC    PIC X(6).
  1627     05 S48-AVA                     PIC X(9).
  1628     05 S48-VEC                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  29
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1629     05 S48-VEC-12                  PIC X(12).
  1630*------------------------------------------------------------*
  1631 01  F-APE-07                      PIC 9999.
  1632 01  F-APE-07-R                    REDEFINES F-APE-07.
  1633     03  M-APE-07                  PIC 99.
  1634     03  A-APE-07                  PIC 99.
  1635*------------------------------------------------------------*
  1636 01  F-ING-02                      PIC 9999.
  1637 01  F-ING-02-R                    REDEFINES F-ING-02.
  1638     03  M-ING-02                  PIC 99.
  1639     03  A-ING-02                  PIC 99.
  1640 01  F-NOV-07                      PIC 9999.
  1641 01  F-NOV-07-R                    REDEFINES F-NOV-07.
  1642     03  M-NOV-07                  PIC 99.
  1643     03  A-NOV-07                  PIC 99.
  1644*---------------------------------------------------------------*
  1645 01  W-FECHA-APE.
  1646     03  W-ANIO-APE                PIC 9(04).
  1647     03  W-MES-APE                 PIC 9(02).
  1648*---------------------------------------------------------------*
  1649 01  W-FECHA-HOY                   PIC X(08).
  1650 01  W-FECHA-HOY-R                 REDEFINES W-FECHA-HOY.
  1651     03  W-ANO-HOY                 PIC 9(04).
  1652     03  W-MES-HOY                 PIC 9(02).
  1653     03  W-DIA-HOY                 PIC 9(02).
  1654 01  CAL-NRO-MESES                 PIC S9(05).
  1655*---------------------------------------------------------------*
  1656 01  F-UACT-02                     PIC 9999.
  1657 01  F-UACT-02-R                   REDEFINES F-UACT-02.
  1658     03  M-UACT-02                 PIC 99.
  1659     03  A-UACT-02                 PIC 99.
  1660 01  WS-EST-MES.
  1661     03  WS-MES-NUEV               PIC 9.
  1662     03  WS-MESES-VIEJ             PIC 9(12).
  1663 01  WS-EST-MES-R REDEFINES WS-EST-MES.
  1664     03  WS-MESES-NUEV             PIC 9(12).
  1665     03  WS-MES-VIEJ               PIC 9.
  1666 01  FN.
  1667     03  FEC-NOV-S                 PIC 9(4)   VALUE ZERO.
  1668     03  FEC-NOV-RED-S REDEFINES FEC-NOV-S
  1669                                   PIC X(04).
  1670 01 ANO-2000                       PIC 99  VALUE 0.
  1671 01  SCREEN-HEADER.
  1672     03  FILLER                    PIC X(30) VALUE SPACES.
  1673     03  FILLER                    PIC X(20) VALUE
  1674         "=== DATA CREDITO ===" .
  1675     03  FILLER                    PIC X(30) VALUE SPACES.
  1676 01  SCREEN-TITLE REDEFINES SCREEN-HEADER PIC X(80).
  1677 01  MULT-TABLA OCCURS 200 TIMES.
  1678     03 MULT-CODIGO                PIC 9(6).
  1679     03 MULT-CLAVE                 PIC X(5).
  1680     03 MULT-TERMINAL              PIC 9(4).
  1681     03 MULT-PRODUCTO              PIC 9(2).
  1682     03 MULT-MODALIDAD             PIC 9(2).
  1683     03 MULT-ESTADO                PIC 9.
  1684     03 MULT-TTY                   PIC X(8).
  1685     03 MULT-SESION                PIC X(4) COMP-5.
  1686     03 MULT-PRIV-CLAVE            PIC 9(1).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  30
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1687     03 MULT-PRO-EXCLU             PIC 9(1).
  1688     03 MULT-NOM-SUS               PIC X(14).
  1689     03 MULT-NIT                   PIC 9(11) COMP-3.
  1690 01  NOM-COR-AUX             PIC X(14) VALUE SPACES.
  1691 01  FILLER REDEFINES NOM-COR-AUX.
  1692      02 NOM-COR-AUXN        PIC 9(6).
  1693      02 FILLER              PIC X(8).
  1694 01  NOM-COR-AUX2            PIC X(14) VALUE SPACES.
  1695 01  MENSAJE-CS.
  1696     02 HEADER.
  1697       03 HEADER-USUARIO           PIC X(10).
  1698       03 HEADER-TIPO-MENSAJE      PIC 9.
  1699       03 HEADER-LSN               PIC 9(4).
  1700       03 HEADER-LONGITUD          PIC 9(4).
  1701       03 HEADER-TERMINAL          PIC X(8).
  1702       03 HEADER-NOMB-PROG         PIC X(6).
  1703       03 HEADER-FILA              PIC 99.
  1704       03 HEADER-COLUMNA           PIC 99.
  1705       03 HEADER-CARACT-INICIO     PIC 9.
  1706       03 HEADER-CARACT-FIN        PIC 9.
  1707       03 HEADER-TIPO-TERMINAL     PIC X(6).
  1708       03 HEADER-FILLER            PIC X(5).
  1709    02 TEXTO                       PIC X(2000).
  1710    02 TEXTO-INPUT REDEFINES TEXTO.
  1711       03 AREA-INPUT               PIC X(80).
  1712       03 FILLER                   PIC X(1920).
  1713*-----------------------------------------------------------*
  1714 01  TABLA-HISTORICA-MORAS.
  1715     03 w-moras-historicas-v       pic X(48) value zeros.
  1716     03 w-moras-historicas-v-r redefines w-moras-historicas-v.
  1717        05 w-moras-historicas occurs 48 times pic X(01).
  1718 01  ARRASTRE                      PIC 9 VALUE ZEROS.
  1719*------------------------------------------------------------*
* 1720 COPY ICFILE.WS.
  1721* ICFILE-WS.v.0043.
  1722* COPY PARA DIRECCIONAR LOS ARCHIVOS.
  1723*****************************************************************
  1724* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS
  1725*R.MARTINEZ   * UNIVERSAL.
  1726******************************************************************
  1727* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *
  1728* VICTOR HUGO *                                                  *
  1729* FORERO      *                                                  *
  1730* DIC.01/2000 *                                                  *
  1731******************************************************************
  1732* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *
  1733* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *
  1734* FORERO      * NOMREG - REGISTRADURIA                           *
  1735* SEP.10/2001 * NOMDAS - DAS                                     *
  1736*             * NMDIAN - DIAN                                    *
  1737******************************************************************
  1738* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *
  1739* VICTOR HUGO * BYINGTON                                         *
  1740* FORERO      *                                                  *
  1741* FEB.18/2002 *                                                  *
  1742******************************************************************
  1743* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *
  1744* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  31
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1745* SEP.04/2002 *                                                  *
  1746* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*
  1747* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *
  1748* OCT.29/2002 *                                                  *
  1749******************************************************************
  1750* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *
  1751* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *
  1752* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *
  1753* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*
  1754*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *
  1755*             *          ENTRADA-ENTIDAD                         *
  1756*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *
  1757* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *
  1758*             *          CIONES Y TELEFONOS                      *
  1759*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1760*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1761*             *          RRIENTES CON RECLAMOS VIGENTES          *
  1762******************************************************************
  1763* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1764* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1765* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*
  1766*             *          NOMBRE                                  *
  1767******************************************************************
  1768* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *
  1769* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *
  1770* FEB.14/2003 *                                                  *
  1771******************************************************************
  1772* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1773* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *
  1774* MAR.03/2003 *          CON NUEVOS DISENOS.                     *
  1775******************************************************************
  1776* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *
  1777* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *
  1778* JUN.05/2003 *                                                  *
  1779* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *
  1780* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *
  1781* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *
  1782******************************************************************
  1783* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1784* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *
  1785* JUL.09/2003 *          en $TRABAJO/logs                        *
  1786******************************************************************
  1787* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*
  1788* G.JIMENEZ  .*                                                  *
  1789* SEP.11/2003 *                                                  *
  1790******************************************************************
  1791* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *
  1792* G.JIMENEZ  .*                                                  *
  1793* OCT.14/2004 *                                                  *
  1794******************************************************************
  1795* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1796* G.JIMENEZ   *          PRODUCTOS                               *
  1797* ABR/2005    *                                                  *
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1800* F.CUADROS   *          FRAINQ.DAT                              *
  1801* JUN.23/2005 *                                                  *
  1802******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *
  1804* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *
  1805* SEP.02/2005 *                                                  *
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *
  1808* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *          TIPO 8                                  *
  1810*             *                                                  *
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *
  1814* OCT.17/2006 *                                                  *
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *
  1817* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *
  1818* SEP.11/2007 *                                                  *
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *
/d/iccol/desarrollo/fuentes/cobol>fg^?    ^[  /d/iccol/desarrollo/fuentes/cobol>cat icestd81.lst
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*          list("icestd81.lst")
     1*icestd81.cbl.v.01.0002
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.    icestd81-DATACREDITO.
     4 AUTHOR.        DATACREDITO-JAGR.
     5 DATE-WRITTEN.  OCT/2006.
     6 DATE-COMPILED. 21-May-14 10:39.
     7******************************************************************
     8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *
     9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.        *
    10* GER.DESARR.|                                                   *
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.                                *
    15* GER.DESARR.|                                                   *
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
    23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
    25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
    27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
    29*   sh-datainforme
    30*
    31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.                                              GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
    41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43            ASSIGN TO DISK MAES-DIRECC-TITLE
    44            ORGANIZATION IS INDEXED
    45            ACCESS MODE IS DYNAMIC
    46            RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51X           FILE STATUS IS EST-ICBDIR
    52$END
    53            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    54 $SET IDXFORMAT"0"
*   55     COPY BDACSV.FS.                                              GDT0001
    56* BDACSV-FS.V.0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   2
* )d/iccol/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
    57* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
    58* DATOS OFICIALES DE REGIS, DIAN Y DAS
    59     SELECT BDACSV
    60            ASSIGN TO DISK "$DATABASE/BDACSV"
    61            ORGANIZATION IS INDEXED
    62            ACCESS MODE IS DYNAMIC
    63            RECORD KEY IS LLAVE-BDACSV
    64            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*   65     COPY NOAMNISTIA21.FS.                                        GDT0001
    66* NOAMNISTIA21-FS.V.0001
    67* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
    68* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
    69     SELECT NOAMNISTIA21
    70            ASSIGN TO DISK "$DATABASE/NOAMNISTIA21"
    71            ORGANIZATION IS INDEXED
    72            ACCESS MODE IS DYNAMIC
    73            RECORD KEY IS LLAVE-NOAMNISTIA21
    74            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    75*                                                                 GDT0001
*   76     COPY ICBSUS.FS.
    78$SET CONSTANT SW-STATUS-ICBSUS"NO"
    79     SELECT SUSCRIPTOR
    80            ASSIGN TO DISK SUSCRIPTOR-TITLE
    81            ORGANIZATION IS INDEXED
    82            ACCESS MODE IS DYNAMIC
    83            RECORD KEY IS LLAVE-SUSCRIP
    84$IF SW-STATUS-ICBSUS = "NO"
    85$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."
    86$ELSE
    87$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."
    88X           FILE STATUS IS COD-RETORNO-ICBSUS
    89$END
    90            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    91
*   92     COPY ICBCON.FS.
    93* EST005.v.02.002
    94* ARCHIVO QIE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
    95* TIPO 5
    96     SELECT INDEXADO
    97            ASSIGN TO DISK INDEXADO-TITLE
    98            ORGANIZATION IS INDEXED
    99            ACCESS MODE IS DYNAMIC
   100            RECORD KEY IS LLAVE-INDEX
   101            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   102*    COPY  ICBCHK.FS.                                             GDT0002
*  103     COPY  ICBCHK0001.FS.                                         GDT0002
   104*ICBCHK0001.FS.v.01.0001
   105******************************************************************
   106* EST027.v.02.002                                                *
   107* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO*
   108* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                     *
   109******************************************************************
   110 $SET IDXFORMAT"8"
   111
   112     SELECT  MAESTRO-CHECK  ASSIGN TO  MAES-CHECK-TITLE
   113             ORGANIZATION          IS  INDEXED
   114             ACCESS         MODE   IS  DYNAMIC
   115             RECORD         KEY    IS  LLAVE-MAES-CHECK
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   3
* )21.FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   116             LOCK           MODE   IS  MANUAL WITH LOCK ON RECORD.
   117
   118 $SET IDXFORMAT"0"
*  119     COPY ICBCRE.FS.
   120* EST029.v.02.003
   121* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS
   122* POR LOS DIFERENTES SUSCRIPTORES
   123 $SET IDXFORMAT"8"
   124
   125     SELECT MAESTRO-CREDIT
   126            ASSIGN TO DISK MAES-CREDIT-TITLE
   127            ORGANIZATION IS INDEXED
   128            ACCESS MODE IS DYNAMIC
   129            RECORD KEY IS LLAVE-MAES-CREDIT
   130*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT
   131            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   132
   133 $SET IDXFORMAT"0"
*  134     COPY BDIEMSUP0001.FS.
   135* BDIEMSUP-FS.v.0001
   136**********************************************************
   137*MAESTRO DE INFORMACION SUPERINTENDENCIA FORMATO TIPO 8  *
   138**********************************************************
   139 $SET IDXFORMAT"8"
   140     SELECT BDIEMSUP ASSIGN TO DISK TITLE-BDIEMSUP
   141            ORGANIZATION IS INDEXED
   142            ACCESS MODE IS DYNAMIC
   143            RECORD KEY IS BDIEMSUP-LLAVE
   144            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   145 $SET IDXFORMAT"0"
   146
*  147     COPY BDIEENTI.FS.
   148* BDIEENTI-FS.v.0002
   149*******************************************
   150*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
   151*******************************************
   152
   153     SELECT BDIEENTI ASSIGN TO DISK SI-BDIEENTI
   154            ORGANIZATION IS INDEXED
   155            ACCESS IS DYNAMIC
   156            RECORD KEY IS BDIEENTI-LLAVE
   157            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   158
*  159     COPY BDACUE.FS.
   161*****************************************************************
   162* ARCHIVO DE TIPOS DE CUENTA DE DATACREDITO
   163*****************************************************************
   164$SET CONSTANT SW-STATUS-BDACUE"NO"
   165     SELECT BDACUE    ASSIGN TO DISK "$DATABASE/BDACUE"
   166           ORGANIZATION IS LINE SEQUENTIAL
   167           ACCESS MODE IS SEQUENTIAL
   168$IF SW-STATUS-BDACUE = "NO"
   169$DISPLAY ".............COMPILANDO BDACUE SIN STATUS.........."
   170$ELSE
   171$DISPLAY ".............COMPILANDO BDACUE CON STATUS.........."
   172X           FILE STATUS IS COD-RETORNO-BDACUE
   173$END
   174            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   4
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   175     SELECT ENTRADA  ASSIGN TO DISK ARCHIVO-ENTRADA
   176            ORGANIZATION   IS LINE SEQUENTIAL
   177            ACCESS MODE    IS SEQUENTIAL
   178            FILE STATUS    IS W-STATUS-ENT.
   179
   180     SELECT INCONSIS ASSIGN TO DISK ARCHIVO-INCONC
   181            ORGANIZATION   IS LINE SEQUENTIAL
   182            ACCESS MODE    IS SEQUENTIAL
   183            FILE STATUS    IS W-STATUS-INC.
   184
   185     SELECT SALIDA   ASSIGN  TO DISK ARCHIVO-SALIDA
   186            ORGANIZATION   IS LINE SEQUENTIAL
   187            ACCESS MODE    IS SEQUENTIAL.
   188
   189     SELECT ESTADIS  ASSIGN  TO DISK ARCHIVO-ESTADIS
   190            ORGANIZATION   IS LINE SEQUENTIAL
   191            ACCESS MODE    IS SEQUENTIAL.
   192
   193
   194 DATA DIVISION.
   195 FILE SECTION.
*  196 COPY ICBDIR0001.FD.                                              GDT0001
   197* ICBDIR0001-FD.V01.007.
   198* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS
   199* POR LOS DIFERENTES SUSCRIPTORES
   200******************************************************************
   201* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL
   202* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE
   203* FEB.15/2006  * DATACLIENTES.
   204******************************************************************
   205* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *
   206* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *
   207* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *
   208* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *
   209*              *          DIRECCION FUE GEOREFERENCIADA.         *
   210******************************************************************
   211* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *
   212* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *
   213* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *
   214******************************************************************
   215* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *
   216* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*
   217* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *
   218* JUL.25/2008  *                                                 *
   219******************************************************************
   220* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*
   221* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*
   222* SEP/07/2011  *          CIA.                                   *
   223******************************************************************
   224* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *
   225* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *
   226* OCT/25/2012  *          ACTUALIZO.                             *
   227******************************************************************
   228 FD  MAESTRO-DIRECC.
   229 01  REG-DIRECC.
   230     03  LLAVE-DIRECC.
   231         05  LLAVE-PRI-DIRECC.
   232             07  TIPO-ID-DIRECC    PIC 9(01).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   5
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   233             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002
   234         05  LLAVE-ALT-DIRECC.
   235             07  COD-SUS-DIRECC    PIC 9(06).
   236             07  COD-CTA-DIRECC    PIC 9(02).
   237             07  NUM-CTA-DIRECC    PIC X(18).
   238     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   239     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   240     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   241     03  CIURES-DIRECC             PIC X(20).                     FAC0002
   242     03  DPTRES-DIRECC             PIC X(20).                     FAC0002
   243     03  DIRRES-DIRECC             PIC X(60).                     FAC0002
   244     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002
   245     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002
   246     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005
   247     03  CIULAB-DIRECC             PIC X(20).                     FAC0002
   248     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002
   249     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002
   250     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002
   251     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002
   252     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005
   253     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002
   254     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002
   255     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002
   256     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   257     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005
   258     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002
   259     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002
   260     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   261     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005
   262     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   263***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003
   264***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003
   265***  COR-CORRESPONDENCIA)                                         VHF0003
   266***     CER???-DIRECC:                                            VHF0003
   267***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003
   268***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003
   269***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003
   270***     ADI???-DIRECC:                                            VHF0003
   271***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003
   272***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003
   273***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003
   274     03  CERRES-DIRECC             PIC 9(01).                     VHF0003
   275     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003
   276     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003
   277     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003
   278     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003
   279     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003
   280     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004
   281     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005
   282     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005
   283     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005
   284*    03  FILLER-DIRECC             PIC X(40).                     VHF0005
   285*    03  FILLER-DIRECC             PIC X(28).                     RMB0006
   286     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006
   287     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006
   288     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006
   289     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007
   290     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   6
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   291     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007
   292     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007
   293     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007
   294     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007
   295     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007
   296*    03  FILLER-DIRECC             PIC X(13).                     CAV0007
   297     03  FILLER-DIRECC             PIC X(06).                     CAV0007
*  298 COPY BDACSV.FD.                                                  GDT0001
   299* BDACSV-FD.v.0003
   300* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   301* DATOS OFICIALES DE REGIS, DIAN Y DAS
   302******************************************************************
   303* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
   304* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
   305* R.MARTINEZ *          POR T7
   306******************************************************************
   307* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
   308* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE
   309* LUIS GOMEZ *          CONFIABLE
   310******************************************************************
   311 FD  BDACSV.
   312 01  REG-BDACSV.
   313     03 LLAVE-BDACSV.
   314        05  TIPO-ID-BDACSV    PIC 9(01).
   315        05  NUM-ID-BDACSV     PIC 9(15).
   316        05  COD-SUS-BDACSV    PIC 9(06).
   317        05  COD-CTA-BDACSV    PIC 9(02).
   318        05  NUM-CTA-BDACSV    PIC X(25).
   319     03  NOMBRE-BDACSV        PIC X(45).
   320     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003
   321        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003
   322        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003
   323        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003
   324     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
   325     03  FECHA-CREA-BDACSV       PIC 9(08).
   326     03  NUM-PORTAF-BDACSV    PIC 9(02).
   327     03  IND-NOMBRE-BDACSV    PIC 9(02).
   328     03  MEJOR-PORTAF-BDACSV  PIC 9(02).
   329     03  IND-ACTUALIZ-BDACSV  PIC 9(02).
   330     03  FUENTE-REG-BDACSV    PIC 9(02).
   331     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002
   332     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002
   333*    03  FILLER               PIC X(50).                          STT0003
   334     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003
   335         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003
   336         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003
   337         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003
   338         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003
   339         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003
   340         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003
   341         05  IND-SEXO-BDACSV       PIC X.                         STT0003
   342         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003
   343         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003
   344         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003
   345     03  FILLER                    PIC X(07).                     STT0003
   346*    03  FILLER               PIC X(48).
   347
   348
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   7
* ).FD)S)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   349
*  350 COPY NOAMNISTIA21.FD.                                            GDT0001
   351* NOAMNISTIA21-FD.v.0001
   352* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
   353* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
   354******************************************************************
   355******************************************************************
   356 FD  NOAMNISTIA21.
   357 01  REG-NOAMNISTIA21.
   358     03 LLAVE-NOAMNISTIA21.
   359        05  TIPO-ID-NOAMNISTIA21      PIC 9(01).
   360        05  NUM-ID-NOAMNISTIA21       PIC 9(11).
   361     03  FECHA-CREA-NOAMNISTIA21      PIC 9(08).
   362     03  FILLER                       PIC X(10).
   363*                                                                 GDT0001
   364 FD  ENTRADA.
   365 01  REG-ENTRADA.
   366     03 ENT-TIPO-ID               PIC 9(01).
   367     03 ENT-NUME-ID               PIC 9(11).
   368     03 ENT-NOMBRE                PIC X(45).
   369     03 ENT-FEC-EXPED             PIC 9(08).
   370     03 ENT-CIUDAD-EXP            PIC X(15).
   371     03 ENT-DEP-EXP-VAL           PIC X(15).
   372     03 ENT-VIG-VAL               PIC X(02).
   373     03 ENT-GENERO-VAL            PIC X(01).
   374     03 ENT-EDAD                  PIC X(03).
   375     03 ENT-EDAD-RANGO            PIC X(05).
   376     03 FILLER                    PIC X(51).
   377
   378 FD  INCONSIS.
   379 01  REG-INCONSIS.
   380     03 TIP-INC                   PIC 9.
   381     03 CED-INC                   PIC 9(11).
   382     03 NOM1-INC                  PIC X(45).
   383     03 NOM2-INC                  PIC X(45).
   384     03 FEC-EXP-INC               PIC 9(08).
   385     03 MUN-EXP-INC               PIC X(15).
   386     03 DEP-EXP-INC               PIC X(15).
   387     03 VIG-INC                   PIC X(02).
   388     03 CODERR-INC                PIC 9(02).
   389     03 FILLER-2-INC              PIC X(60).
   390
   391
   392 FD  SALIDA.
   393 01  REG-SALIDA.
   394     03 SLD-TIPO-ID                    PIC 9(01).
   395     03 FILLER01                       PIC X(01) VALUE ";".
   396     03 SLD-NUME-ID                    PIC 9(11).
   397     03 FILLER02                       PIC X(01) VALUE ";".
   398     03 SLD-NOMBRE                     PIC X(45).
   399     03 FILLER03                       PIC X(01) VALUE ";".
   400     03 SLD-RANGO-EDAD                 PIC X(05).
   401     03 FILLER04                       PIC X(01) VALUE ";".
   402     03 SLD-GENERO                     PIC X(01).
   403     03 FILLER05                       PIC X(01) VALUE ";".
   404     03 SLD-CIUDAD-EXPED               PIC X(15).
   405     03 FILLER06                       PIC X(01) VALUE ";".
   406     03 SLD-CREDITOS-ACTV              PIC 9(04).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   8
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   407     03 FILLER07                       PIC X(01) VALUE ";".
   408     03 SLD-NUM-OBLIG-CAB              PIC 9(04).
   409     03 FILLER08                       PIC X(01) VALUE ";".
   410     03 SLD-TOT-INICIAL-CAB            PIC 9(15).
   411     03 FILLER09                       PIC X(01) VALUE ";".
   412     03 SLD-TOT-SALDOS-CAB             PIC 9(15).
   413     03 FILLER10                       PIC X(01) VALUE ";".
   414     03 SLD-TOT-CUOTAS-CAB             PIC 9(11).
   415     03 FILLER11                       PIC X(01) VALUE ";".
   416     03 SLD-TOT-MORA-CAB               PIC 9(11).
   417     03 FILLER12                       PIC X(01) VALUE ";".
   418     03 SLD-NUM-OBLIG-CAV              PIC 9(04).
   419     03 FILLER13                       PIC X(01) VALUE ";".
   420     03 SLD-TOT-INICIAL-CAV            PIC 9(15).
   421     03 FILLER14                       PIC X(01) VALUE ";".
   422     03 SLD-TOT-SALDOS-CAV             PIC 9(15).
   423     03 FILLER15                       PIC X(01) VALUE ";".
   424     03 SLD-TOT-CUOTAS-CAV             PIC 9(11).
   425     03 FILLER16                       PIC X(01) VALUE ";".
   426     03 SLD-TOT-MORA-CAV               PIC 9(11).
   427     03 FILLER17                       PIC X(01) VALUE ";".
   428     03 SLD-NUM-OBLIG-OTR              PIC 9(04).
   429     03 FILLER18                       PIC X(01) VALUE ";".
   430     03 SLD-TOT-INICIAL-OTR            PIC 9(15).
   431     03 FILLER19                       PIC X(01) VALUE ";".
   432     03 SLD-TOT-SALDOS-OTR             PIC 9(15).
   433     03 FILLER20                       PIC X(01) VALUE ";".
   434     03 SLD-TOT-CUOTAS-OTR             PIC 9(11).
   435     03 FILLER21                       PIC X(01) VALUE ";".
   436     03 SLD-TOT-MORA-OTR               PIC 9(11).
   437     03 FILLER22                       PIC X(01) VALUE ";".
   438     03 SLD-TOT-NUM-TDC                PIC 9(04).
   439     03 FILLER23                       PIC X(01) VALUE ";".
   440     03 SLD-TOT-CUPOS-TDC              PIC 9(15).
   441     03 FILLER24                       PIC X(01) VALUE ";".
   442     03 SLD-TOT-SALDO-TDC              PIC 9(15).
   443     03 FILLER25                       PIC X(01) VALUE ";".
   444     03 SLD-POR-UTILIZ-TDC             PIC Z.ZZZZZ.
   445     03 FILLER26                       PIC X(01) VALUE ";".
   446     03 SLD-TOT-CUOTAS-TDC             PIC 9(11).
   447     03 FILLER27                       PIC X(01) VALUE ";".
   448     03 SLD-TOT-MORA-TDC               PIC 9(11).
   449     03 FILLER28                       PIC X(01) VALUE ";".
   450     03 SLD-NRO-RANGO-0                PIC 9(03).
   451     03 FILLER29                       PIC X(01) VALUE ";".
   452     03 SLD-NRO-RANGO-1                PIC 9(03).
   453     03 FILLER30                       PIC X(01) VALUE ";".
   454     03 SLD-NRO-RANGO-2                PIC 9(03).
   455     03 FILLER31                       PIC X(01) VALUE ";".
   456     03 SLD-NRO-RANGO-3                PIC 9(03).
   457     03 FILLER32                       PIC X(01) VALUE ";".
   458     03 SLD-NRO-RANGO-4                PIC 9(03).
   459     03 FILLER33                       PIC X(01) VALUE ";".
   460     03 SLD-NRO-RANGO-5                PIC 9(03).
   461     03 FILLER34                       PIC X(01) VALUE ";".
   462     03 SLD-NRO-RANGO-6                PIC 9(03).
   463     03 FILLER35                       PIC X(01) VALUE ";".
   464     03 SLD-FECHA-TDC                  PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   9
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   465     03 FILLER36                       PIC X(01) VALUE ";".
   466     03 SLD-NUM-OBLIG-REAL             PIC 9(04).
   467     03 FILLER37                       PIC X(01) VALUE ";".
   468     03 SLD-TOT-INICIAL-REAL           PIC 9(15).
   469     03 FILLER38                       PIC X(01) VALUE ";".
   470     03 SLD-TOT-SALDOS-REAL            PIC 9(15).
   471     03 FILLER39                       PIC X(01) VALUE ";".
   472     03 SLD-TOT-CUOTAS-REAL            PIC 9(11).
   473     03 FILLER40                       PIC X(01) VALUE ";".
   474     03 SLD-TOT-MORA-REAL              PIC 9(11).
   475     03 FILLER41                       PIC X(01) VALUE ";".
   476     03 SLD-NUM-OBLIG-TELE             PIC 9(04).
   477     03 FILLER42                       PIC X(01) VALUE ";".
   478     03 SLD-TOT-CUOTAS-TELE            PIC 9(11).
   479     03 FILLER43                       PIC X(01) VALUE ";".
   480     03 SLD-TOT-MORA-TELE              PIC 9(11).
   481     03 FILLER44                       PIC X(01) VALUE ";".
   482     03 SLD-NUM-OBLIG-COOP             PIC 9(04).
   483     03 FILLER45                       PIC X(01) VALUE ";".
   484     03 SLD-TOT-INICIAL-COOP           PIC 9(15).
   485     03 FILLER46                       PIC X(01) VALUE ";".
   486     03 SLD-TOT-SALDOS-COOP            PIC 9(15).
   487     03 FILLER47                       PIC X(01) VALUE ";".
   488     03 SLD-TOT-CUOTAS-COOP            PIC 9(11).
   489     03 FILLER48                       PIC X(01) VALUE ";".
   490     03 SLD-TOT-MORA-COOP              PIC 9(11).
   491     03 FILLER49                       PIC X(01) VALUE ";".
   492     03 SLD-NUM-OBLIG-CODEU            PIC 9(04).
   493     03 FILLER50                       PIC X(01) VALUE ";".
   494     03 SLD-TOT-SALDOS-CODEU           PIC 9(15).
   495     03 FILLER51                       PIC X(01) VALUE ";".
   496     03 SLD-TOT-CUOTAS-CODEU           PIC 9(11).
   497     03 FILLER52                       PIC X(01) VALUE ";".
   498     03 SLD-TOT-MORA-CODEU             PIC 9(11).
   499     03 FILLER53                       PIC X(01) VALUE ";".
   500     03 SLD-CREDITOS-ALDIA             PIC 9(03).
   501     03 FILLER54                       PIC X(01) VALUE ";".
   502     03 SLD-MORA-30                    PIC 9(03).
   503     03 FILLER55                       PIC X(01) VALUE ";".
   504     03 SLD-MORA-60                    PIC 9(03).
   505     03 FILLER56                       PIC X(01) VALUE ";".
   506     03 SLD-MORA-90                    PIC 9(03).
   507     03 FILLER57                       PIC X(01) VALUE ";".
   508     03 SLD-MORA-120                   PIC 9(03).
   509     03 FILLER58                       PIC X(01) VALUE ";".
   510     03 SLD-CAR-CASTIGA                PIC 9(03).
   511     03 FILLER59                       PIC X(01) VALUE ";".
   512     03 SLD-DUD-RECAUDO                PIC 9(03).
   513     03 FILLER60                       PIC X(01) VALUE ";".
   514     03 SLD-CUENTAS-COBRADOR           PIC 9(03).
   515     03 FILLER61                       PIC X(01) VALUE ";".
   516     03 SLD-MORA-30-HIS                PIC 9(03).
   517     03 FILLER62                       PIC X(01) VALUE ";".
   518     03 SLD-MORA-60-HIS                PIC 9(03).
   519     03 FILLER63                       PIC X(01) VALUE ";".
   520     03 SLD-MORA-90-HIS                PIC 9(03).
   521     03 FILLER64                       PIC X(01) VALUE ";".
   522     03 SLD-MORA-120-HIS               PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  10
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   523     03 FILLER65                       PIC X(01) VALUE ";".
   524     03 SLD-CANC-MMANEJO               PIC 9(03).
   525     03 FILLER66                       PIC X(01) VALUE ";".
   526     03 SLD-CAR-RECUPERADA             PIC 9(03).
   527     03 FILLER67                       PIC X(01) VALUE ";".
   528     03 SLD-MORA-MAX-TDC               PIC 9(03).
   529     03 FILLER68                       PIC X(01) VALUE ";".
   530     03 SLD-MORA-MAX-CAB               PIC 9(03).
   531     03 FILLER69                       PIC X(01) VALUE ";".
   532     03 SLD-MORA-MAX-COOP              PIC 9(03).
   533     03 FILLER70                       PIC X(01) VALUE ";".
   534     03 SLD-MORA-MAX-CAV               PIC 9(03).
   535     03 FILLER71                       PIC X(01) VALUE ";".
   536     03 SLD-END-CALIF-1-TRIM           PIC X(01).
   537     03 FILLER72                       PIC X(01) VALUE ";".
   538     03 SLD-END-CALIF-2-TRIM           PIC X(01).
   539     03 FILLER73                       PIC X(01) VALUE ";".
   540     03 SLD-CTAS-AHORRO                PIC 9(03).
   541     03 FILLER74                       PIC X(01) VALUE ";".
   542     03 SLD-CTES-CORRIENTES            PIC 9(03).
   543     03 FILLER75                       PIC X(01) VALUE ";".
   544     03 SLD-CTES-EMBARGADAS            PIC 9(03).
   545     03 FILLER76                       PIC X(01) VALUE ";".
   546     03 SLD-CTES-MAL-MANEJO            PIC 9(03).
   547     03 FILLER77                       PIC X(01) VALUE ";".
   548     03 SLD-CTES-SALDADAS              PIC 9(03).
   549     03 FILLER78                       PIC X(01) VALUE ";".
   550     03 SLD-TOTAL-CONSULTAS            PIC 9(03).
   551     03 FILLER79                       PIC X(01) VALUE ";".
   552     03 SLD-CALIFICACION               PIC X(01).
   553*-----------------------------------------------------------*
   554 FD  ESTADIS.
   555 01  REG-ESTADIS.
   556     03 SLD-DETALLE                    PIC X(30).
   557     03 FILLER                         PIC X(01) VALUE ";".
   558     03 SLD-ESTADIS-VALOR-1            PIC Z(11).
   559     03 FILLER                         PIC X(01) VALUE ";".
   560     03 SLD-ESTADIS-VALOR-2            PIC Z(11).
   561     03 FILLER                         PIC X(01) VALUE ";".
   562     03 SLD-ESTADIS-VALOR-3            PIC Z(11).
   563     03 FILLER                         PIC X(01) VALUE ";".
   564     03 SLD-ESTADIS-VALOR-4            PIC Z(11).
   565     03 FILLER                         PIC X(01) VALUE ";".
   566     03 SLD-ESTADIS-VALOR-5            PIC Z(07).
   567
*  568 COPY ICBSUS.FD.
   571*******************************************************************
   572* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR
   573* F.CUADROS *         DATAHOST
   574* FEB.2003  *
   575*******************************************************************
   576* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES
   577* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.
   578* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES
   579******************************************************************
   580* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL
   581* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR
   582* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  11
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   583******************************************************************
   584* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE
   585* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL
   586* ENE. 07/2004 * HABITO DE PAGO.
   587******************************************************************
   588* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE
   589* F.CUADROS C. * FRAUDE
   590* JUN. 04/2004 *
   591******************************************************************
   592* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES
   593* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.
   594* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL
   595*              * A SUI, 2-PASO AUTOMATICO A SUI.
   596******************************************************************
   597* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE
   598* F.CUADROS C. * ENDEUDAMIENTO GLOBAL
   599* MAR. 14/2005 *
   600******************************************************************
   601* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO
   602* R.MARTINEZ   * A TRAVES DE DATA WEB
   603* ABR. 21/2005 *
   604******************************************************************
   605* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS
   606* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-
   607* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO
   608******************************************************************
   609* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *
   610* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *
   611* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *
   612******************************************************************
   613* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *
   614* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *
   615* NOV. 01/2005 *                                                 *
   616******************************************************************
   617* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *
   618* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *
   619* MAR.17/2006  *
   620******************************************************************
   621* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*
   622* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *
   623* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *
   624******************************************************************
   625* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIÓN DE *
   626* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *
   627* JUL.05/2006  *                                                 *
   628******************************************************************
   629* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*
   630* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *
   631* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *
   632******************************************************************
   633* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *
   634* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*
   635* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *
   636******************************************************************
   637* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*
   638* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*
   639* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *
   640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  12
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   641* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *
   642* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *
   643* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *
   644*              * S- SI -DEFAULT
   645******************************************************************
   646* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *
   647* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*
   648* JULIO /2009  *         LIZADOR O NO.                           *
   649******************************************************************
   650* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *
   651* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *
   652* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO ASÍ: 0-NO CERTI*
   653*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *
   654*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*
   655*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *
   656*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *
   657*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *
   658******************************************************************
   659* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS
   660* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *
   661* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*
   662*              *         PRODUCTO) = 0
   663*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO
   664*              *          = 1
   665*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*
   666*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *
   667*              *         CONSULTA DATAHOST O WEBSERVICE          *
   668******************************************************************
   669* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*
   670* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*
   671* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*
   672*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *
   673******************************************************************
   674* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *
   675* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *
   676* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *
   677******************************************************************
   678* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *
   679* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *
   680* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *
   681*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *
   682******************************************************************
   683* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *
   684* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *
   685* FEBRERO/2013 *         DE SUSCRIPTOR.                          *
   686*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *
   687*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*
   688*              *         NUMERO DE TARJETA.                      *
   689*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *
   690******************************************************************
   691 FD  SUSCRIPTOR.
   692 01  REG-SUSCRIPTOR.
   693     03  COD-SUSCRIP-ABD02       PIC 9(6).
   694     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02
   695                                 PIC X(6).
   696     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.
   697     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012
   698     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  13
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   699     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.
   700*        04 FILLER               PIC X(16).                       FAC0012
   701         04 NOM-COR1-ABD02       PIC X(14).
   702         04 NOM-COR2-ABD02       PIC X(14).
   703         04 IND-COR-ABD02        PIC 9.
   704     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009
   705     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.
   706     03  IND-REGIST-ABD02        PIC 99    COMP-3.
   707     03  ESTADO-ABD02            PIC 9     COMP-3.
   708     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.
   709     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.
   710     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.
   711     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.
   712     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5
   713     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1
   714     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1
   715     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017
   716     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015
   717     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008
   718     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008
   719     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008
   720     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009
   721     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009
   722     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009
   723     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009
   724     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009
   725     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010
   726     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011
   727     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013
   728     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014
   729     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016
   730     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018
   731     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019
   732     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020
   733     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021
   734     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022
   735     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023
   736     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024
   737     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025
   738     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026
   739     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027
   740     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028
   741     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029
   742     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029
   743     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030
   744     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030
   745     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031
   746     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031
   747     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032
   748     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033
   749     03  DIRRES-ABD02            PIC X(01).                       RMB0034
   750     03  TELRES-ABD02            PIC X(01).                       RMB0034
   751     03  DIRLAB-ABD02            PIC X(01).                       RMB0034
   752     03  TELLAB-ABD02            PIC X(01).                       RMB0034
   753     03  DIRCOR-ABD02            PIC X(01).                       RMB0034
   754     03  TELCEL-ABD02            PIC X(01).                       RMB0034
   755     03  E-MAIL-ABD02            PIC X(01).                       RMB0034
   756     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  14
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   757     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036
   758     03  FILLER-ABD02-2          PIC X(05).                       CAV0036
   759*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036
   760*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034
   761*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033
*  762 COPY ICBCON.001.FD.
   763* ICBCON-FD.0004
   764* ARCHIVO QUE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
   765* TIPO 5
   766*******************************************************************
   767* RMB003       * FENA001: PARA LAS CONSULTAS REPETIDAS (MISMO DIA *
   768* R.MARTINEZ.  * SUSCRIPTOR, CLAVE) SE DEJA UN SOLA CONSULTA Y LA *
   769* JULIO 30/2001* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   770*              * NUM-CONS-IND.                                    *
   771*----------------------------------------------------------------**
   772* RMB003       * SCR002: PARA MANEJO DE PREFILTRO SE REDEFINEN    *
   773* R.MARTINEZ.  * CAMPOS.                                          *
   774* AGOS. 30/2002* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   775*----------------------------------------------------------------**
   776* GJC0004      * AMPLI1: AMPLIACION DEL ARCHIVO DE CONSULTA DE    *
   777* G.JIMENEZ.   * 50 A 123 POSICIONES, SE AMPLIA CON FILLER DE 50  *
   778* ENE.03/2003  * CARACTERES.                                      *
   779* FAC0004      * INCLUSION DE NUEVOS CAMPOS                       *
   780* ENE.22/2003  *                                                  *
   781*----------------------------------------------------------------**
   782 FD  INDEXADO.
   783*    FILE OF SUCCESSFUL INQUIRIES, FOR BILLING AND SUSPICIOUS
   784*    NUMBER OF CREDIT INQUIRIES
   785 01  REG-INDEX.
   786     03  COD-SUSCRIP-IND         PIC 9(6).
   787     03  FEC-CONSUL-IND          PIC 9(6).
   788     03  LLAVE-INDEX.
   789         05  TIP-ID-IND          PIC 9.
   790         05  NUM-ID-IND          PIC 9(11).
   791         05  CONSECUTIVO-IND     PIC 9(2).
   792*    SCORES 0=score10,1-9= SCORE1-9
   793     03  SCO-PRE-INDEX           PIC 9.
   794     03  CIUDAD-CONS-IND         PIC 9(2).
   795     03  OFICINA-CONS-IND        PIC X(15).
   796     03  NUM-CONS-IND            PIC 99.                           RMB003
   797     03  FILLER-INDEX.
   798         05 PRE-SCORE-INDEX      PIC X VALUE SPACES.
   799         05 PUN-SCORE-INDEX      PIC S9(05) COMP-3.
   800     03  RAZCON-IND              PIC 99.                          GJC0004
   801     03  TIP-SCORE-IND           PIC 9(3).                        FAC0004
   802     03  CLASIFICA-IND           PIC X(2).                        FAC0004
   803     03  CALIFICA-IND            PIC S9(3)V99.                    FAC0004
   804     03  CLAVE-IND               PIC X(5).                        FAC0004
   805     03  CONTADOR-IND            PIC 9(3).                        FAC0004
   806     03  FILLER-1-INDEX          PIC X(50).                       GJC0004
*  807 COPY ICBCHK.FD.
   808* ICBCHK.-FD.v.0009
   809* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO
   810* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES
   811*----------------------------------------------------------------*
   812******************************************************************
   813* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   814* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  15
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   815* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   816* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   817* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   818*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   819*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   820*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   821*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   822******************************************************************
   823* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*
   824* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *
   825*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   826* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *
   827*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   828******************************************************************
   829* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   830* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   831* 04/MAY/2009 *          CREDITO.                                *
   832******************************************************************
   833* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *
   834* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *
   835* 04/ENE/2010 *                                                  *
   836******************************************************************
   837* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   838* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   839* OCTUBRE/2010*          SON MÁS DE 10                           *
   840******************************************************************
   841
   842 FD  MAESTRO-CHECK.
   843*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2
   844 01  COMPLETO-ABD06.
   845     03  LLAVE-MAES-CHECK.
   846         05  LLAVE-MAES-CHECK-PRI.
   847             07  TIPO-ID-ABD06     PIC 9.
   848             07  NUM-ID-ABD06      PIC 9(11).
   849         05  LLAVE-MAES-CHECK-ALT.
   850             07  COD-SUS-ABD06     PIC 9(6).
   851             07  COD-CTA-ABD06     PIC 99.
   852             07  NUM-CTA-ABD06     PIC X(18).
   853     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.
   854     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.
   855     03  CALIFIC-ABD06             PIC 9     COMP-3.
   856     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.
   857     03  NOV-REPORT-ABD06          PIC 99    COMP-3.
   858     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.
   859     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.
   860     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.
   861     03  ADJETIVO-ABD06            PIC 9     COMP-3.
   862     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.
   863     03  ART15-ABD06               PIC 9     COMP-3.
   864     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005
   865         REDEFINES                 ART15-ABD06.                   VHF0005
   866     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.
   867     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005
   868                                   PIC 9(3).                      FAC0005
   869     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005
   870         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005
   871         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006
   872         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  16
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   873
   874     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH
   875*    03  FILLER-ABD06              PIC X(8).                      AMPLIA
   876     03  OFICINA-ABD06             PIC X(15).                     AMPINF5
   877     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5
   879     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004
   880     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008
   881         REDEFINES FEC-NOVANT-ABD06.                              CAV0008
   882     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004
   883*    03  FILLER-ABD06              PIC X(4).                      CAV0007
   884     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007
   885     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007
   886     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007
   887     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009
*  888 COPY ICBCRE.FD.
   889* ICBCRE-FD.v.02.0013
   890* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS
   891* POR LOS DIFERENTES SUSCRIPTORES
   892*----------------------------------------------------------------*
   893******************************************************************
   894* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   895* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   896* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   897* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   898* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   899*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   900*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   901*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   902*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   903******************************************************************
   904* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*
   905* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *
   906*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   907* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *
   908*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   909******************************************************************
   910* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *
   911* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *
   912*             *          CUARTO AÑO DE HISTORIA CREDITICIA       *
   913* 09/AGO/2007 *                                                  *
   914******************************************************************
   915* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   916* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   917* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *
   918*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *
   919*             *          ENDEUDAMIENTO                           *
   920******************************************************************
   921* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   922* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   923* OCTUBRE/2010*          SON MÁS DE 10                           *
   924******************************************************************
   925* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *
   926* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *
   927* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *
   928******************************************************************
   929 FD  MAESTRO-CREDIT.
   930 01  COMPLETO-ABD07.
   931     03  LLAVE-MAES-CREDIT.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  17
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   932         05  LLAVE-MAES-CREDIT-PRI.
   933             07  TIPO-ID-ABD07     PIC 9.
   934             07  NUM-ID-ABD07      PIC 9(11).
   935         05  LLAVE-MAES-CREDIT-ALT.
   936             07  COD-SUS-ABD07     PIC 9(6).
   937             07  COD-CTA-ABD07     PIC 99.
   938             07  NUM-CTA-ABD07     PIC X(18).
   939             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA
   940                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA
   941                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA
   942     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.
   943     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.
   944     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.
   945     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.
   946     03  CALIFIC-ABD07             PIC 9     COMP-3.
   947     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.
   948     03  NOV-REPORT-ABD07          PIC 99    COMP-3.
   949     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.
   950     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.
   951     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.
   952     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AÑO 1   JGR0010
   953         REDEFINES                 ESTADO-MES-ABD07.               JGR0010
   954     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.
   955     03  ADJETIVO1-ABD07           PIC 9     COMP-3.
   956     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.
   957     03  ADJETIVO2-ABD07           PIC 9     COMP-3.
   958     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.
   959     03  ADJETIVO3-ABD07           PIC 9     COMP-3.
   960     03  ART15-ABD07               PIC 9     COMP-3.
   961     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008
   962         REDEFINES                 ART15-ABD07.                   VHF0008
   963     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.
   964     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008
   965                                   PIC 9(3).                      FAC0008
   966     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008
   967         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008
   968         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009
   969         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009
   970         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011
   971            FILLER-RECLAMO-ABD07.                                 GJC0011
   972         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011
   973            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011
   974         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011
   975            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011
   976*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013
   977     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013
   978     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013
   979         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013
   980     03  CALIFIC-R-ABD07           PIC 9     COMP-3.
   981     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.
   982     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007
   983                                   PIC 9     COMP-3.
   984     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.
   985     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.
   986     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.
   987     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007
   988                                   PIC X(02).                     FAC0007
   989     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  18
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   990     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AÑO 3   JGR0010
   991         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010
   992     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.
   993     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA
   994*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011
   995*                              *> CAMPOS                          GJC0011
   996*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011
   997*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011
   998*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011
   999*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011
  1000*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011
  1001*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011
  1002*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011
  1003*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011
  1004     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011
  1005* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011
  1006        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011
  1007        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011
  1008        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1009        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011
  1010        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1011* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011
  1012         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011
  1013         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011
  1014         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011
  1015         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011
  1016         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011
  1017         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011
  1018             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1019         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011
  1020             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1021         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011
  1022         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011
  1023         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011
  1024*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012
  1025         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012
  1026* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011
  1027     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA
  1028     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1029     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1030     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA
  1031     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA
  1032     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA
  1033     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA
  1034     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA
  1035     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA
  1036     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA
  1037     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA
  1038     03  SITUACION-ABD07            PIC X.                         AMPLIA
  1039     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA
  1040     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011
  1041         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011
  1042         05  CAMPOS-TARJETA-ABD07.                                GJC0011
  1043             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011
  1044             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011
  1045                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011
  1046         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012
  1047     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  19
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
  1048     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA
  1049     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1050*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1051     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7
  1052     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA
  1053     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010
  1054         REDEFINES                  VECTOR-2-ABD07.     *> AÑO 2   JGR0010
  1055     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5
  1056     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5
  1057     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5
  1058     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5
  1059     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7
  1060     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002
  1061     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AÑO 4   JGR0010
  1062         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010
  1063
* 1064 COPY BDIEMSUP.FD.
  1065* BDIEMSUP-FD.v.0005
  1066*-------------------------------------------
  1067*  MAESTRO CON INFORMACION SUPERINTENDENCIA
  1068*-------------------------------------------
  1069******************************************************************
  1070* GJC0002   * MICROC: SE ADICIONA VARIABLE DE SUBTIPO DE DEUDA QUE
  1071* G.JIMENEZ * PERMITE IDENTIFICAR LOS MICROCREDITOS Y LAS
  1072* JUN./2003 * FIDUCIAS.
  1073******************************************************************
  1074* RMB0003   * DRP001: SE ADICIONA CAMPO PARA CALCULAR CAMBIO EN
  1075* R.MARTINEZ* EL REGISTRO Y ACTUALIZAR EL DRP
  1076* DIC./2007 *
  1077******************************************************************
  1078* VHF0004     * GARANT - SE MODIFICA FILLER PARA GUARDAR         *
  1079* VICTOR HUGO *          INFORMACION DE GARANTIAS                *
  1080* FORERO      *                                                  *
  1081* SEP.24/2009 *                                                  *
  1082******************************************************************
  1083* LAG0005     * TIPGAR - BDIEMSUP-TIPGAR SE DEJA ALFANUMERICO    *
  1084* VICTOR HUGO *          PARA DEJAR "A" CUANDO VEGA 10, "B"      *
  1085* FORERO      *          CUANDA VENGA 11 Y "C" CUANDO VENGA 12   *
  1086* SEP.24/2009 *                                                  *
  1087******************************************************************
  1088 FD BDIEMSUP.
  1089 01 BDIEMSUP-REGISTRO.
  1090    03 BDIEMSUP-LLAVE.
  1091       05 BDIEMSUP-TIP-ID           PIC 9(1).
  1092       05 BDIEMSUP-NUM-ID           PIC 9(11).
  1093       05 BDIEMSUP-FECHA            PIC 9(8).
  1094       05 BDIEMSUP-TIP-ENTID        PIC 9(2).
  1095       05 BDIEMSUP-COD-ENTID        PIC 9(6).
  1096       05 BDIEMSUP-MONEDA           PIC X(1).
  1097       05 BDIEMSUP-TIP-DEUDA        PIC X(1).
  1098       05 BDIEMSUP-CALIFICA         PIC X(1).
  1099       05 BDIEMSUP-GARANTIA         PIC X(1).
  1100    03 BDIEMSUP-ENCABEZADO.
  1101       05 BDIEMSUP-DESCRIP          PIC X(45).
  1102       05 BDIEMSUP-CIIU             PIC 9(4).
  1103       05 BDIEMSUP-FEC-APERT        PIC 9(8).
  1104       05 BDIEMSUP-SUBTIPO-DEUDA    PIC X.                        GJC0002
  1105       05 FILLER                    PIC X(6).                     GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  20
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDIE
  1106    03 BDIEMSUP-ITEMS REDEFINES BDIEMSUP-ENCABEZADO.
  1107       05 BDIEMSUP-VALOR            PIC S9(14)  COMP-3.
  1108       05 BDIEMSUP-INTERES          PIC S9(14)  COMP-3.
  1109       05 BDIEMSUP-CONTING          PIC S9(14)  COMP-3.
  1110       05 BDIEMSUP-CANTIDAD         PIC 9(3)    COMP-3.
  1111       05 BDIEMSUP-IND-BLOQ         PIC 9(1)    COMP-3.
  1112       05 BDIEMSUP-ART-15           PIC 9(2)    COMP-3.
  1113       05 BDIEMSUP-FEC-ART-15       PIC 9(8)    COMP-3.
  1114       05 BDIEMSUP-FEC-ACTUALIZ     PIC 9(8)    COMP-3.
  1115       05 BDIEMSUP-ART-15-CTI       PIC 9(2)    COMP-3.
  1116       05 BDIEMSUP-FEC-ART-15-CTI   PIC 9(8)    COMP-3.
  1117       05 BDIEMSUP-NUM-RECLAMO      PIC 9(5)    COMP-3.
  1118       05 FILLER-X                  PIC X(14).                    VHF0004
  1119       05 BDIEMSUP-GAR              REDEFINES FILLER-X.           VHF0004
  1120          07 BDIEMSUP-VLRGAR        PIC S9(14)  COMP-3.           VHF0004
  1121          07 BDIEMSUP-TIPGAR        PIC X(1).                     LAG0005
  1122          07 BDIEMSUP-FECGAR        PIC S9(8)   COMP-3.           VHF0004
  1123       05 BDIEMSUP-DRP              PIC X(01).                    VHF0004
* 1124 COPY BDIEENTI.FD.
  1125* BDIEENTI-FD.v.0002
  1126******************************************************************
  1127* JGR0002     * NITENT - SE COMPARTE EL CAMPO NOMBRE DE LA       *
  1128* JAIRO GOMEZ.*          ENTIDAD, PARA PORDER GRABAR EL NUMERO   *
  1129*             *          DE NIT DE LA ENTIDAD REPORTANTE         *
  1130* 09/ENE/2008 *                                                  *
  1131******************************************************************
  1132********************************************
  1133*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
  1134********************************************
  1135
  1136 FD BDIEENTI.
  1137 01 BDIEENTI-REGISTRO.
  1138    03 BDIEENTI-LLAVE.
  1139       05 BDIEENTI-TIP-ENTID        PIC 9(2).
  1140       05 BDIEENTI-COD-ENTID        PIC 9(6).
  1141    03 BDIEENTI-NOM-ENTID.
  1142       05 BDIEENTI-NOMBRE           PIC X(29).                     JGR0002
  1143       05 BDIEENTI-NIT-ENTID        PIC 9(11).                     JGR0002
* 1144 COPY BDACUE.FD.
  1146* BDACUE.v.01.001
  1147*ARCHIVO TIPOS DE CUENTA VS. NOVEDADES Y ADJETIVOS VALIDOS
  1148*----------------------------------------------------------------*
  1149*-TABLA CON 10 OCURRENCIAS QUE CORRESPONDEN A CAMPOS DEL MAESTRO
  1150* RESUMIDO CON RANGO DE VALORES INICIAL Y FINAL PARA VALIDACION
  1151* TAB-RANGOS: EL ORDEN DE LOS CAMPOS ALMACENADOS ES CUOTA-MES,
  1152* VALOR-INICIAL, SALDO-DEUDA, SALDO-MORA, VALOR-DISPONIBLE, CUOTAS-
  1153* CANCELADAS, CUOTAS-EN-MORA, 3 OCURRENCIAS PARA USO FUTURO
  1154* IND-SECTOR-BDACUE: F-FINANCIERO, C-COOPERATIVO, R-REAL
  1155*-TABLA CON 15 INDICADORES DE LOS CAMPOS CONTENIDOS EN EL MAPA DE
  1156* BITS; VALOR=0 SI NO APLICA VALOR=1 SI APLICA AL TIPO DE CUENTA.
  1157*-CAMPOS CONTROL0X USADOS COMO DELIMITADORES.
  1158*----------------------------------------------------------------*
  1159* GJC0002    * NEWACT- PARA NUEVA ACTUALIZACION LOS ADJETIVOS
  1160* G JIMENEZ  *         VAN DE 1 A 9. SE DEFINE NUEVA TABLA DE
  1161* 21-07-2009 *         ADJETIVOS VALIDOS
  1162*****************************************************************
  1163 FD  BDACUE.
  1164 01  REG-BDACUE.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  21
* FD)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
  1165     03  TIP-CTA-BDACUE               PIC 9(2).
  1166     03  DES-CORTA-BDACUE             PIC X(3).
  1167     03  DES-LARGA-BDACUE             PIC X(21).
  1168     03  DES-COMPLETA-BDACUE          PIC X(30).
  1169     03  CONTROL01-BDACUE             PIC X(01).
  1170     03  IND-NOV-BDACUE OCCURS 35     PIC 9(1).
  1171     03  CONTROL02-BDACUE             PIC X(01).
  1172     03  IND-ADJ-BDACUE OCCURS 31     PIC 9(2).
  1173     03  CONTROL03-BDACUE             PIC X(01).
  1174     03  IND-SECTOR-BDACUE            PIC X(1).
  1175     03  CONTROL04-BDACUE             PIC X(01).
  1176     03  TAB-RANGOS-BDACUE OCCURS 10.
  1177         04 VAL-INI-BDACUE            PIC 9(10).
  1178         04 VAL-FIN-BDACUE            PIC 9(10).
  1179     03  CONTROL05-BDACUE             PIC X(01).
  1180     03  TAB-IND-VAL-BDACUE.
  1181         04 VEC-IND-VAL-BDACUE OCCURS 15 TIMES PIC 9.
  1182     03  CONTROL06-BDACUE             PIC X(01).
  1183     03  IND-ADJ-NWACT-BDACUE OCCURS 9 TIMES                      GJC0002
  1184                                      PIC 9.                      GJC0002
  1185     03  CONTROL07-BDACUE             PIC X(1).                   GJC0002
  1186     03  FILLER-BDACUE                PIC X(40).                  GJC0002
  1187
  1188*----------------------------------*
  1189 WORKING-STORAGE SECTION.
  1190*----------------------------------*
  1191 01  W-REG-SALIDA.
  1192     03 W-TIPO-ID                    PIC 9(01).
  1193     03 FILLER                       PIC X(01) VALUE ";".
  1194     03 W-NUME-ID                    PIC 9(11).
  1195     03 FILLER                       PIC X(01) VALUE ";".
  1196     03 W-NOMCLI                     PIC X(45).
  1197     03 FILLER                       PIC X(01) VALUE ";".
  1198     03 W-CALENDPERANT               PIC X(02).
  1199     03 FILLER                       PIC X(01) VALUE ";".
  1200     03 W-CALENDPERACT               PIC X(02).
  1201     03 FILLER                       PIC X(01) VALUE ";".
  1202     03 W-ACIERTA                    PIC 9(05).
  1203     03 FILLER                       PIC X(01) VALUE ";".
  1204     03 W-NUM-CTA                    PIC X(18).
  1205     03 FILLER                       PIC X(01) VALUE ";".
  1206     03 W-DESPRODU                   PIC X(35).
  1207     03 FILLER                       PIC X(01) VALUE ";".
  1208     03 W-SUSCRIPTOTOR               PIC X(40).
  1209     03 FILLER                       PIC X(01) VALUE ";".
  1210     03 W-FECHA-INICIAL              PIC X(06).
  1211     03 FILLER                       PIC X(01) VALUE ";".
  1212     03 W-FECHA-NOVEDAD              PIC X(06).
  1213     03 FILLER                       PIC X(01) VALUE ";".
  1214     03 W-NOVEDAD                    PIC X(10).
  1215     03 FILLER                       PIC X(01) VALUE ";".
  1216     03 W-VECTOR-1                   PIC X(48).
  1217     03 FILLER                       PIC X(01) VALUE ";".
  1218     03 W-VALOR-INI                  PIC 9(07).
  1219     03 FILLER                       PIC X(01) VALUE ";".
  1220     03 W-SALDO-CARTERA              PIC 9(07).
  1221     03 FILLER                       PIC X(01) VALUE ";".
  1222     03 W-SALDO-MORA                 PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  22
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1223     03 FILLER                       PIC X(01) VALUE ";".
  1224     03 W-VALOR-CUOTA                PIC 9(07).
  1225     03 FILLER                       PIC X(01) VALUE ";".
  1226     03 W-TIPOCLI                    PIC X(01).
  1227     03 FILLER                       PIC X(01) VALUE ";".
  1228     03 W-FECHA-VENCIM               PIC X(06).
  1229
  1230 01  W-VARIABLES.
  1231     03 W-VEC-APROBACI.
  1232        05 W-CC-SN            PIC X VALUE SPACES.                      **>
  1233        05 W-DR-SN            PIC X VALUE SPACES.
  1234        05 W-COBRA-SN         PIC X VALUE SPACES.
  1235        05 W-CALI-SN          PIC X VALUE SPACES.
  1236     03 FILLER  REDEFINES W-VEC-APROBACI.
  1237        05 W-VEC-APROBACI-X   PIC X(04).
  1238*
  1239     03 RELLENO                     PIC X(48).
  1240     03 FECHA-AUX                   PIC 9(04).
  1241     03 II                          PIC 9(04).
  1242     03 LL                          PIC 9(04).
  1243     03 TOPE-V                      PIC S9999     VALUE  ZEROS.
  1244     03 W-MESES-NOV                 PIC 9(04)     VALUE  ZEROS.
  1245     03 W-CREDITOS-ACTV             PIC 9(04)     VALUE  ZEROS.
  1246     03 W-NUM-OBLIG-CAB             PIC 9(04)     VALUE  ZEROS.
  1247     03 W-TOT-INICIAL-CAB           PIC 9(15)     VALUE  ZEROS.
  1248     03 W-TOT-SALDOS-CAB            PIC 9(15)     VALUE  ZEROS.
  1249     03 W-TOT-CUOTAS-CAB            PIC 9(11)     VALUE  ZEROS.
  1250     03 W-TOT-MORA-CAB              PIC 9(11)     VALUE  ZEROS.
  1251     03 W-NUM-OBLIG-CAV             PIC 9(04)     VALUE  ZEROS.
  1252     03 W-TOT-INICIAL-CAV           PIC 9(15)     VALUE  ZEROS.
  1253     03 W-TOT-SALDOS-CAV            PIC 9(15)     VALUE  ZEROS.
  1254     03 W-TOT-CUOTAS-CAV            PIC 9(11)     VALUE  ZEROS.
  1255     03 W-TOT-MORA-CAV              PIC 9(11)     VALUE  ZEROS.
  1256     03 W-NUM-OBLIG-OTR             PIC 9(04)     VALUE  ZEROS.
  1257     03 W-TOT-INICIAL-OTR           PIC 9(15)     VALUE  ZEROS.
  1258     03 W-TOT-SALDOS-OTR            PIC 9(15)     VALUE  ZEROS.
  1259     03 W-TOT-CUOTAS-OTR            PIC 9(11)     VALUE  ZEROS.
  1260     03 W-TOT-MORA-OTR              PIC 9(11)     VALUE  ZEROS.
  1261     03 W-TOT-NUM-TDC               PIC 9(04)     VALUE  ZEROS.
  1262     03 W-TOT-CUPOS-TDC             PIC 9(15)     VALUE  ZEROS.
  1263     03 W-TOT-SALDO-TDC             PIC 9(15)     VALUE  ZEROS.
  1264     03 W-SAL-CUPOS-TDC             PIC 9(11)     VALUE  ZEROS.
  1265     03 W-UTLIZACION-TDC            PIC 9(3)V9999 VALUE  ZEROS.
  1266     03 W-TOT-CUOTAS-TDC            PIC 9(11)     VALUE  ZEROS.
  1267     03 W-TOT-MORA-TDC              PIC 9(11)     VALUE  ZEROS.
  1268     03 W-NRO-RANGO-0               PIC 9(03)     VALUE  ZEROS.
  1269     03 W-NRO-RANGO-1               PIC 9(03)     VALUE  ZEROS.
  1270     03 W-NRO-RANGO-2               PIC 9(03)     VALUE  ZEROS.
  1271     03 W-NRO-RANGO-3               PIC 9(03)     VALUE  ZEROS.
  1272     03 W-NRO-RANGO-4               PIC 9(03)     VALUE  ZEROS.
  1273     03 W-NRO-RANGO-5               PIC 9(03)     VALUE  ZEROS.
  1274     03 W-NRO-RANGO-6               PIC 9(03)     VALUE  ZEROS.
  1275     03 W-FEC-MENOR-TDC.
  1276        05 W-ANO-MEN-TDC            PIC 9(04)     VALUE  ZEROS.
  1277        05 W-MES-MEN-TDC            PIC 9(02)     VALUE  ZEROS.
  1278     03 W-FEC-APERTURA.
  1279        05 W-ANO-APERTURA           PIC 9(04)     VALUE  ZEROS.
  1280        05 W-MES-APERTURA           PIC 9(02)     VALUE  ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  23
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1281     03 W-FEC-NOVEDAD.
  1282        05 W-ANO-NOV                PIC 9(04)     VALUE  ZEROS.
  1283        05 W-MES-NOV                PIC 9(02)     VALUE  ZEROS.
  1284     03 W-NUM-OBLIG-REAL            PIC 9(04)     VALUE  ZEROS.
  1285     03 W-TOT-INICIAL-REAL          PIC 9(15)     VALUE  ZEROS.
  1286     03 W-TOT-SALDOS-REAL           PIC 9(15)     VALUE  ZEROS.
  1287     03 W-TOT-CUOTAS-REAL           PIC 9(11)     VALUE  ZEROS.
  1288     03 W-TOT-MORA-REAL             PIC 9(11)     VALUE  ZEROS.
  1289     03 W-NUM-OBLIG-TELE            PIC 9(04)     VALUE  ZEROS.
  1290     03 W-TOT-CUOTAS-TELE           PIC 9(11)     VALUE  ZEROS.
  1291     03 W-TOT-MORA-TELE             PIC 9(11)     VALUE  ZEROS.
  1292     03 W-NUM-OBLIG-COOP            PIC 9(04)     VALUE  ZEROS.
  1293     03 W-TOT-INICIAL-COOP          PIC 9(15)     VALUE  ZEROS.
  1294     03 W-TOT-SALDOS-COOP           PIC 9(15)     VALUE  ZEROS.
  1295     03 W-TOT-CUOTAS-COOP           PIC 9(11)     VALUE  ZEROS.
  1296     03 W-TOT-MORA-COOP             PIC 9(11)     VALUE  ZEROS.
  1297     03 W-NUM-OBLIG-CODEU           PIC 9(04)     VALUE  ZEROS.
  1298     03 W-TOT-SALDOS-CODEU          PIC 9(15)     VALUE  ZEROS.
  1299     03 W-TOT-CUOTAS-CODEU          PIC 9(11)     VALUE  ZEROS.
  1300     03 W-TOT-MORA-CODEU            PIC 9(11)     VALUE  ZEROS.
  1301     03 W-CREDITOS-ALDIA            PIC 9(03)     VALUE  ZEROS.
  1302     03 W-MORAS-30-ACT              PIC 9(03)     VALUE  ZEROS.
  1303     03 W-MORAS-60-ACT              PIC 9(03)     VALUE  ZEROS.
  1304     03 W-MORAS-90-ACT              PIC 9(03)     VALUE  ZEROS.
  1305     03 W-MORAS-120-ACT             PIC 9(03) VALUE ZEROS.
  1306     03 W-CAR-CASTIGA               PIC 9(03) VALUE ZEROS.
  1307     03 W-DUD-RECAUDO               PIC 9(03) VALUE ZEROS.
  1308     03 W-CUENTAS-COBRADOR          PIC 9(03) VALUE ZEROS.
  1309     03 W-MORAS-30-HIS              PIC 9(03) VALUE ZEROS.
  1310     03 W-MORAS-60-HIS              PIC 9(03) VALUE ZEROS.
  1311     03 W-MORAS-90-HIS              PIC 9(03) VALUE ZEROS.
  1312     03 W-MORAS-120-HIS             PIC 9(03) VALUE ZEROS.
  1313     03 W-CANC-MMANEJO              PIC 9(03) VALUE ZEROS.
  1314     03 W-CAR-RECUPERADA            PIC 9(03) VALUE ZEROS.
  1315     03 W-MORA-MAX-TDC              PIC 9(03) VALUE ZEROS.
  1316     03 W-MORA-MAX-CAB              PIC 9(03) VALUE ZEROS.
  1317     03 W-MORA-MAX-COOP             PIC 9(03) VALUE ZEROS.
  1318     03 W-MORA-MAX-CAV              PIC 9(03) VALUE ZEROS.
  1319     03 W-CTAS-AHORROS              PIC 9(03) VALUE ZEROS.
  1320     03 W-CTES-CORRIENTES           PIC 9(03) VALUE ZEROS.
  1321     03 W-CTES-EMBARGADAS           PIC 9(03) VALUE ZEROS.
  1322     03 W-CTES-MAL-MANEJO           PIC 9(03) VALUE ZEROS.
  1323     03 W-CTES-SALDADAS             PIC 9(03) VALUE ZEROS.
  1324     03 W-TOTAL-CONSULTAS           PIC 9(03) VALUE ZEROS.
  1325     03 W-ALDIA-FINA                PIC 9(03) VALUE ZEROS.
  1326     03 W-ALDIA-REAL                PIC 9(03) VALUE ZEROS.
  1327     03 W-ALDIA-COOP                PIC 9(03) VALUE ZEROS.
  1328     03 W-ALDIA-TELE                PIC 9(03) VALUE ZEROS.
  1329     03 W-MORAS-FINA                PIC 9(03) VALUE ZEROS.
  1330     03 W-MORAS-REAL                PIC 9(03) VALUE ZEROS.
  1331     03 W-MORAS-COOP                PIC 9(03) VALUE ZEROS.
  1332     03 W-MORAS-TELE                PIC 9(03) VALUE ZEROS.
  1333     03 W-CC-DR-FINA                PIC 9(03) VALUE ZEROS.
  1334     03 W-CC-DR-REAL                PIC 9(03) VALUE ZEROS.
  1335     03 W-CC-DR-COOP                PIC 9(03) VALUE ZEROS.
  1336     03 W-CC-DR-TELE                PIC 9(03) VALUE ZEROS.
  1337     03 W-EDAD                      PIC 9(03) VALUE ZEROS.
  1338     03 FIN-CHECK                   PIC 9(01) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  24
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1339     03 SALIR-END                   PIC 9(01) VALUE ZEROS.
  1340     03 IND-E                       PIC 9(03) VALUE ZEROS.
  1341     03 F                           PIC 9(01) VALUE ZEROS.
  1342     03 J                           PIC 9(04) VALUE ZEROS.
  1343
  1344     03 W-ENDEUDA                   PIC X(01) VALUE SPACES.
  1345     03 IND-J                       PIC 9(02) VALUE ZEROS.
  1346     03 SW-CODEUDOR                 PIC 9(01) VALUE ZEROS.
  1347     03 TOPE-IND                    PIC 9(03) VALUE ZEROS.
  1348     03 SW-FECHA-LOW                PIC 9(01) VALUE ZEROS.
  1349     03 SW-END                      PIC 9(01) VALUE ZEROS.
  1350     03 FEC-MENOR-TDC               PIC 9(06) VALUE ZEROS.
  1351     03 EVALUA-FINAL                PIC 9(01) VALUE ZEROS.
  1352     03 CONT-LECTURA                PIC 9(03) VALUE ZEROS.
  1353     03 EVALUA-CREDITO              PIC 9(01) VALUE ZEROS.
  1354     03 EVALUA-ENDEUDA              PIC 9(01) VALUE ZEROS.
  1355     03 EVALUA-CTA-CTE              PIC 9(01) VALUE ZEROS.
  1356     03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.
  1357     03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.
  1358     03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.
  1359        05 W-ANO-EXPE               PIC 9(04).
  1360        05 W-MES-EXPE               PIC 9(02).
  1361        05 W-DIA-EXPE               PIC 9(02).
  1362     03 W-ACU-MMAX-TDC              PIC 9(03) VALUE ZEROS.
  1363     03 W-ACU-MMAX-CAB              PIC 9(03) VALUE ZEROS.
  1364     03 W-ACU-MMAX-COOP             PIC 9(03) VALUE ZEROS.
  1365     03 W-ACU-MMAX-CAV              PIC 9(03) VALUE ZEROS.
  1366     03 TEM-NRO-CTA.
  1367        05 TEM-NRO-CTA-C16          PIC X(16) VALUE ZEROS.
  1368        05 TEM-NRO-CTA-C17          PIC X(01) VALUE ZEROS.
  1369        05 TEM-NRO-CTA-C18          PIC X(01) VALUE ZEROS.
  1370     03 W-SUSCRIPTOR.
  1371        05 W-CODIGO-TIPOCTA         PIC 9(02).
  1372        05 W-CODIGO-RESTCTA         PIC 9(04).
  1373     03 W-TABLA-END-MAYOR.
  1374        05 W-TRIMESTRE-END  OCCURS   3 TIMES.
  1375           07 W-FECHA-END           PIC 9(08).
  1376           07 W-MAYOR-END           PIC X(01).
  1377     03 W-TABLA-SUS-CONSU.
  1378        05 W-SUS-CONSU      OCCURS  50 TIMES PIC 9(06).
  1379     03 W-FECHA-AUX                 PIC  9(04).
  1380     03 W-FECHA-AUX-R REDEFINES W-FECHA-AUX.
  1381        05 W-MES-AUX                PIC  9(02).
  1382        05 W-ANO-AUX                PIC  9(02).
  1383     03 W-FECHA-AUX1              PIC 9(06) VALUE ZEROS.
  1384     03 W-FECHA-AUX1-R REDEFINES W-FECHA-AUX1.
  1385        05 W-MES-AUX1             PIC 9(02).
  1386        05 W-ANO-AUX1             PIC 9(04).
  1387     03 W-FECHA-OK                PIC 9(06) VALUE ZEROS.
  1388     03 W-FECHA-OK-R REDEFINES W-FECHA-OK.
  1389        05 W-SLGANO-OK            PIC 9(04).
  1390        05 W-SLGANO-OK-R REDEFINES W-SLGANO-OK.
  1391           07 W-SGL-OK            PIC 9(02).
  1392           07 W-ANO-OK            PIC 9(02).
  1393        05 W-MES-OK               PIC 9(02).
  1394     03 W-FECHA-FINAL             PIC 9(06) VALUE ZEROS.
  1395     03 W-FECHA-APERTURA          PIC 9(06) VALUE ZEROS.
  1396
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  25
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1397*-------------------------------------------------------------*
  1398  01 FECHAS-AAAAMM.
  1399    02 FECHA-TAG                   PIC 9(6).
  1400    02 FILLER REDEFINES FECHA-TAG.
  1401       03 SIG-ANO-TAG              PIC 9(4).
  1402       03 FILLER REDEFINES SIG-ANO-TAG.
  1403          04 SIG-TAG               PIC 9(2).
  1404          04 ANO-TAG               PIC 9(2).
  1405       03 MES-TAG                  PIC 9(2).
  1406    02 FECHA-NOVEDAD07             PIC 9(6).
  1407    02 FILLER REDEFINES FECHA-NOVEDAD07.
  1408       03 SIG-ANO-NOV              PIC 9(4).
  1409       03 FILLER REDEFINES SIG-ANO-NOV.
  1410          04 SIG-NOV               PIC 9(2).
  1411          04 ANO-NOV               PIC 9(2).
  1412       03 MES-NOV                  PIC 9(2).
  1413    02 FECHA-APERTURA07            PIC 9(6).
  1414    02 FILLER REDEFINES FECHA-APERTURA07.
  1415       03 SIG-ANO-APE              PIC 9(4).
  1416       03 FILLER REDEFINES SIG-ANO-APE.
  1417          04 SIG-APE               PIC 9(2).
  1418          04 ANO-APE               PIC 9(2).
  1419       03 MES-APE                  PIC 9(2).
  1420    02 FECHA-VENCIMIENTO07         PIC 9(6).
  1421    02 FILLER REDEFINES FECHA-VENCIMIENTO07.
  1422       03 SIG-ANO-VEN              PIC 9(4).
  1423       03 FILLER REDEFINES SIG-ANO-VEN.
  1424          04 SIG-VEN               PIC 9(2).
  1425          04 ANO-VEN               PIC 9(2).
  1426       03 MES-VEN                  PIC 9(2).
  1427   02 FECHA-INGRESO               PIC 9(6).
  1428    02 FILLER REDEFINES FECHA-INGRESO.
  1429       03 SIG-ANO-ING              PIC 9(4).
  1430       03 FILLER REDEFINES SIG-ANO-ING.
  1431          04 SIG-ING               PIC 9(2).
  1432          04 ANO-ING               PIC 9(2).
  1433       03 MES-ING                  PIC 9(2).
  1434 01  FECHA-SITMMAAAA-ORI     PIC 9(6).
  1435 01  FILLER REDEFINES FECHA-SITMMAAAA-ORI.
  1436     03 FECHA-SITMM-ORI      PIC 9(2).
  1437     03 FECHA-SITAAAA-ORI    PIC 9(4).
  1438 01  FECHA-SITAAAAMM         PIC 9(6).
  1439 01  FILLER REDEFINES FECHA-SITAAAAMM.
  1440     03 FECHA-SITAAAA        PIC 9(4).
  1441     03 FECHA-SITMM          PIC 9(2).
  1442 01  FECHA-VALAAAAMM         PIC 9(6).
  1443 01  FILLER REDEFINES FECHA-VALAAAAMM.
  1444     03 FECHA-VALAAAA        PIC 9(4).
  1445     03 FECHA-VALMM          PIC 9(2).
  1446*---------------------------------------------------------------*
  1447 01  W-FECHA-MILENIO.
  1448     03 W-FMILENIO-SIGLO            PIC  9(02).
  1449     03 W-FMILENIO-ANIO             PIC  9(02).
  1450     03 W-FMILENIO-MES              PIC  9(02).
  1451*----------------------------------------------------------------*
  1452 01  W-CONSTANTES.
  1453     03 SW-READ-INC                 PIC 9(01) VALUE ZEROS.
  1454     03 W-IND                       PIC 9(02) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  26
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1455     03 LEIDOS                      PIC 9(08) VALUE ZEROS.
  1456     03 GRABADOS                    PIC 9(08) VALUE ZEROS.
  1457     03 END-RUN                     PIC X(01) VALUE " ".
  1458     03 W-STATUS-ENT                PIC 9(02) VALUE ZEROS.
  1459     03 W-STATUS-INC                PIC 9(02) VALUE ZEROS.
  1460*
  1461     03 W-RESET-LEIDOS              PIC 9(09) VALUE 9.
  1462     03 W-LEIDOS                    PIC 9(09) VALUE ZEROS.
  1463     03 W-LEIDOS-RED REDEFINES W-LEIDOS.
  1464        05 FILLER                   PIC 9(06).
  1465        05 CEROS                    PIC 9(03).
  1466     03 W-GRABADOS                  PIC 9(09) VALUE ZEROS.
  1467     03 W-SOLO-CODEUDORES           PIC 9(09) VALUE ZEROS.
  1468     03 W-SOLO-COOPERATIVAS         PIC 9(09) VALUE ZEROS.
  1469     03 W-SOLO-CERRADOS             PIC 9(09) VALUE ZEROS.
  1470     03 W-MORA-TOT-SEC-FINA         PIC 9(09) VALUE ZEROS.
  1471     03 W-MORA-TOT-SEC-REAL         PIC 9(09) VALUE ZEROS.
  1472     03 W-MORA-TOT-REAL-FINA        PIC 9(09) VALUE ZEROS.
  1473
  1474     03 W-FECHA-BASE                PIC 9(06) VALUE ZEROS.
  1475     03 W-OPCION                    PIC X(01) VALUE SPACES.
  1476     03 W-VECTOR-L                  PIC 9(02) VALUE 12.
  1477     03 END-RUN                     PIC X(01) VALUE SPACES.
  1478     03 W-CC                        PIC 9(05) VALUE ZEROS.
  1479     03 W-DR                        PIC 9(05) VALUE ZEROS.
  1480     03 W-COBRA                     PIC 9(05) VALUE ZEROS.
  1481     03 W-CALI                      PIC X(01) VALUE ZEROS.
  1482
  1483*------------------------------------------------------------*
  1484*     AREA WORK ACUMULADORES
  1485*------------------------------------------------------------*
  1486 01  W-ACUMULADORES-ESTA.
  1487     03 W-EDITOR-CON                PIC Z,ZZZ,ZZ9.
  1488     03 W-EDITOR-SIN                PIC Z,ZZZ,ZZ9.
  1489     03 W-EDITOR-INC                PIC Z,ZZZ,ZZ9.
  1490     03 W-EDITOR-TOT                PIC Z,ZZZ,ZZ9.
  1491     03 W-CON-INFORMACION           PIC 9(07) VALUE ZEROS.
  1492     03 W-SIN-INFORMACION           PIC 9(07) VALUE ZEROS.
  1493     03 W-INCONSISTENCIAS           PIC 9(07) VALUE ZEROS.
  1494*----------------------------------------------------------------*
  1495*     VARIABLES DEL MANEJO DE BDACUE                             *
  1496*----------------------------------------------------------------*
  1497 01  VAL-VARIABLES.
  1498     03  W-CTA-BDCUE                 PIC 9(02) VALUE ZEROS.
  1499     03  SW-LOAD-TBL                 PIC 9(01) VALUE ZEROS.
  1500     03  T                           PIC 9(04) VALUE ZEROS.
  1501     03  TOPE-T                      PIC 9(04) VALUE ZEROS.
  1502     03  TABLA-VAL-TIP-CTA OCCURS 100 TIMES.
  1503         04 VEC-VALOR-BDACUE OCCURS 15 TIMES PIC 9.
  1504*----------------------------------------------------------------*
  1505*     VARIABLES ESTADISTICAS                                     *
  1506*----------------------------------------------------------------*
  1507 01  W-ACUMULADORES-ESTA.
  1508     03 W-ESTADO-INF          OCCURS  3 TIMES.
  1509        05 W-TABLA-TIPO-ID    OCCURS  5 TIMES.
  1510           07 W-ACUM-TIPO-ID    PIC  9(07) VALUE ZEROS.
  1511*------------------------------------------------------------*
  1512*    ACUMULACION VARIABLES DEMOGRAFICAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  27
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1513*------------------------------------------------------------*
  1514     03 W-EDAD-66           PIC  9(07) VALUE ZEROS.
  1515     03 W-EDAD-56-65        PIC  9(07) VALUE ZEROS.
  1516     03 W-EDAD-46-55        PIC  9(07) VALUE ZEROS.
  1517     03 W-EDAD-36-45        PIC  9(07) VALUE ZEROS.
  1518     03 W-EDAD-29-35        PIC  9(07) VALUE ZEROS.
  1519     03 W-EDAD-22-28        PIC  9(07) VALUE ZEROS.
  1520     03 W-EDAD-18-21        PIC  9(07) VALUE ZEROS.
  1521*------------------------------------------------------------*
  1522*    ACUMULACION ESTADO ACTUAL
  1523*------------------------------------------------------------*
  1524     03 W-TOT-CAR-CASTIGA      PIC  9(07) VALUE ZEROS.
  1525     03 W-TOT-DUD-RECAUDO      PIC  9(07) VALUE ZEROS.
  1526     03 W-TOT-CTES-EMBARGADAS  PIC  9(07) VALUE ZEROS.
  1527     03 W-TOT-MORAS-120-ACT    PIC  9(07) VALUE ZEROS.
  1528     03 W-TOT-MORAS-90-ACT     PIC  9(07) VALUE ZEROS.
  1529     03 W-TOT-MORAS-60-ACT     PIC  9(07) VALUE ZEROS.
  1530     03 W-TOT-MORAS-30-ACT     PIC  9(07) VALUE ZEROS.
  1531     03 W-TOT-W-ENDEUDA        PIC  9(07) VALUE ZEROS.
  1532     03 W-TOT-ALDIA            PIC  9(07) VALUE ZEROS.
  1533     03 W-TOT-SIN-CTAS         PIC  9(07) VALUE ZEROS.
  1534*------------------------------------------------------------*
  1535*    ACUMULACION ESTADO SECTOR
  1536*------------------------------------------------------------*
  1537     03 W-TOT-CC-DR-FINA       PIC  9(07) VALUE ZEROS.
  1538     03 W-TOT-MORAS-FINA       PIC  9(07) VALUE ZEROS.
  1539     03 W-TOT-ALDIA-FINA       PIC  9(07) VALUE ZEROS.
  1540     03 W-TOT-CC-DR-REAL       PIC  9(07) VALUE ZEROS.
  1541     03 W-TOT-MORAS-REAL       PIC  9(07) VALUE ZEROS.
  1542     03 W-TOT-ALDIA-REAL       PIC  9(07) VALUE ZEROS.
  1543     03 W-TOT-CC-DR-COOP       PIC  9(07) VALUE ZEROS.
  1544     03 W-TOT-MORAS-COOP       PIC  9(07) VALUE ZEROS.
  1545     03 W-TOT-ALDIA-COOP       PIC  9(07) VALUE ZEROS.
  1546     03 W-TOT-CC-DR-TELE       PIC  9(07) VALUE ZEROS.
  1547     03 W-TOT-MORAS-TELE       PIC  9(07) VALUE ZEROS.
  1548     03 W-TOT-ALDIA-TELE       PIC  9(07) VALUE ZEROS.
  1549*------------------------------------------------------------*
  1550*    ACUMULACION VALORES TOTALES
  1551*------------------------------------------------------------*
  1552     03 W-SALDOS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1553     03 W-CUOTAS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1554     03 W-MORAS-SEC-FINA       PIC  9(15) VALUE ZEROS.
  1555     03 W-SALDOS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1556     03 W-CUOTAS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1557     03 W-MORAS-SEC-REAL       PIC  9(15) VALUE ZEROS.
  1558     03 W-SALDOS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1559     03 W-CUOTAS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1560     03 W-MORAS-SEC-COOP       PIC  9(15) VALUE ZEROS.
  1561
  1562*---------------------------------------------------------*
  1563 01  W-PARAMETROS              PIC  X(94) VALUE SPACES.
  1564*---------------------------------------------------------*
  1565
  1566*----------------------------------------------------------------*
  1567* Estas son las variables para analizar los vectores de          *
  1568* comportamiento de moras HISTORICAS (estado-mes-abd07) y        *
  1569* (vector-2-abd07)                                               *
  1570*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  28
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1571 01  WS-ESTADO-MES-1                        PIC 9(12).
  1572 01  WS-ESTADO-MES-2                        PIC 9(12).
  1573 01  WS-ESTADO-MES                          PIC 9(12).
  1574 01  WS-ESTADO-MES-R REDEFINES WS-ESTADO-MES.
  1575     03  WS-MES                             PIC X OCCURS 12 TIMES.
  1576 01  ESTADO-MES-IMP.
  1577     03  E-MES-IMP                          PIC X OCCURS 12 TIMES.
  1578
  1579 01  ESTADO-ANUAL.
  1580     03  CHAR-H                             PIC X OCCURS 12 TIMES.
  1581 01  I                                      PIC 9(3)   VALUE ZERO.
  1582
  1583 01  E                                      PIC 9(3)   VALUE ZERO.
  1584 01  K                                      PIC 9(4)   VALUE 01.
  1585 01  N                                      PIC 9(3)   VALUE ZERO.
  1586 01  TIV                                    PIC 9(3)   VALUE ZERO.
  1587 01  TFV                                    PIC 9(3)   VALUE ZERO.
  1588 01  F-AUX-1                                PIC 9(4)   VALUE ZERO.
  1589 01  F-AUX                                  PIC 9(4)   VALUE ZERO.
  1590 01  F-UACT-2                               PIC 9(4)   VALUE ZERO.
  1591 01  F-APE-7                                PIC 9(4)   VALUE ZERO.
  1592 01  F-ING-2                                PIC 9(4)   VALUE ZERO.
  1593 01  F-NOV-7                                PIC 9(4)   VALUE ZERO.
  1594 01  F-VIEJ                                 PIC 9(4)   VALUE ZERO.
  1595 01  ENCONTRO                               PIC 9(1)   VALUE ZERO.
  1596*01  RELLENO                                PIC 9(1)   VALUE ZERO.
  1597 01  CINCO                                  PIC 9(2)   VALUE 5.
  1598 01  NUEVO                                  PIC 9      VALUE 0.
  1599 01  COD-SUSCRIP-AUX                        PIC 9(6)   VALUE ZERO.
  1600*------------------------------------------------------------*
  1601 01  VECTOR-S.
  1602     03 VECTOR-A-R1                        PIC X(24).
  1603     03 VECTOR-A-R2                        PIC X(24).
  1604 01  VECTOR-S-12.
  1605     03 VECTOR-N-R1                        PIC X(24).
  1606     03 VECTOR-N-R2                        PIC X(24).
  1607*------------------------------------------------------------*
  1608  01 V-NOR.
  1609     02 V-NOR1                     PIC 9(12).
  1610     02 V-NOR2                     PIC 9(12).
  1611     02 V-NOR3                     PIC 9(12).
  1612     02 V-NOR4                     PIC 9(12).
  1613  01 V-NOR-AUX     PIC X(47) VALUE SPACES.
  1614
  1615  01 VECTORES-W.
  1616    02 VECTOR-MORA.
  1617       03 FILLER PIC X(25) VALUE "5PMPPPPPPPPP5555123411212".
  1618       03 FILLER PIC X(25) VALUE "3234123412341234999CRD999".
  1619    02 FILLER REDEFINES VECTOR-MORA.
  1620       03 V-MORA OCCURS 50 TIMES PIC X.
  1621*------------------------------------------------------------*
  1622 01  SALIDA-48.
  1623     05 S48-EST                     PIC X(15).
  1624     05 S48-SUS                     PIC X(14).
  1625     05 S48-FEC                     PIC 9(6).
  1626     05 S48-FECALPHA REDEFINES S48-FEC    PIC X(6).
  1627     05 S48-AVA                     PIC X(9).
  1628     05 S48-VEC                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  29
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1629     05 S48-VEC-12                  PIC X(12).
  1630*------------------------------------------------------------*
  1631 01  F-APE-07                      PIC 9999.
  1632 01  F-APE-07-R                    REDEFINES F-APE-07.
  1633     03  M-APE-07                  PIC 99.
  1634     03  A-APE-07                  PIC 99.
  1635*------------------------------------------------------------*
  1636 01  F-ING-02                      PIC 9999.
  1637 01  F-ING-02-R                    REDEFINES F-ING-02.
  1638     03  M-ING-02                  PIC 99.
  1639     03  A-ING-02                  PIC 99.
  1640 01  F-NOV-07                      PIC 9999.
  1641 01  F-NOV-07-R                    REDEFINES F-NOV-07.
  1642     03  M-NOV-07                  PIC 99.
  1643     03  A-NOV-07                  PIC 99.
  1644*---------------------------------------------------------------*
  1645 01  W-FECHA-APE.
  1646     03  W-ANIO-APE                PIC 9(04).
  1647     03  W-MES-APE                 PIC 9(02).
  1648*---------------------------------------------------------------*
  1649 01  W-FECHA-HOY                   PIC X(08).
  1650 01  W-FECHA-HOY-R                 REDEFINES W-FECHA-HOY.
  1651     03  W-ANO-HOY                 PIC 9(04).
  1652     03  W-MES-HOY                 PIC 9(02).
  1653     03  W-DIA-HOY                 PIC 9(02).
  1654 01  CAL-NRO-MESES                 PIC S9(05).
  1655*---------------------------------------------------------------*
  1656 01  F-UACT-02                     PIC 9999.
  1657 01  F-UACT-02-R                   REDEFINES F-UACT-02.
  1658     03  M-UACT-02                 PIC 99.
  1659     03  A-UACT-02                 PIC 99.
  1660 01  WS-EST-MES.
  1661     03  WS-MES-NUEV               PIC 9.
  1662     03  WS-MESES-VIEJ             PIC 9(12).
  1663 01  WS-EST-MES-R REDEFINES WS-EST-MES.
  1664     03  WS-MESES-NUEV             PIC 9(12).
  1665     03  WS-MES-VIEJ               PIC 9.
  1666 01  FN.
  1667     03  FEC-NOV-S                 PIC 9(4)   VALUE ZERO.
  1668     03  FEC-NOV-RED-S REDEFINES FEC-NOV-S
  1669                                   PIC X(04).
  1670 01 ANO-2000                       PIC 99  VALUE 0.
  1671 01  SCREEN-HEADER.
  1672     03  FILLER                    PIC X(30) VALUE SPACES.
  1673     03  FILLER                    PIC X(20) VALUE
  1674         "=== DATA CREDITO ===" .
  1675     03  FILLER                    PIC X(30) VALUE SPACES.
  1676 01  SCREEN-TITLE REDEFINES SCREEN-HEADER PIC X(80).
  1677 01  MULT-TABLA OCCURS 200 TIMES.
  1678     03 MULT-CODIGO                PIC 9(6).
  1679     03 MULT-CLAVE                 PIC X(5).
  1680     03 MULT-TERMINAL              PIC 9(4).
  1681     03 MULT-PRODUCTO              PIC 9(2).
  1682     03 MULT-MODALIDAD             PIC 9(2).
  1683     03 MULT-ESTADO                PIC 9.
  1684     03 MULT-TTY                   PIC X(8).
  1685     03 MULT-SESION                PIC X(4) COMP-5.
  1686     03 MULT-PRIV-CLAVE            PIC 9(1).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  30
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1687     03 MULT-PRO-EXCLU             PIC 9(1).
  1688     03 MULT-NOM-SUS               PIC X(14).
  1689     03 MULT-NIT                   PIC 9(11) COMP-3.
  1690 01  NOM-COR-AUX             PIC X(14) VALUE SPACES.
  1691 01  FILLER REDEFINES NOM-COR-AUX.
  1692      02 NOM-COR-AUXN        PIC 9(6).
  1693      02 FILLER              PIC X(8).
  1694 01  NOM-COR-AUX2            PIC X(14) VALUE SPACES.
  1695 01  MENSAJE-CS.
  1696     02 HEADER.
  1697       03 HEADER-USUARIO           PIC X(10).
  1698       03 HEADER-TIPO-MENSAJE      PIC 9.
  1699       03 HEADER-LSN               PIC 9(4).
  1700       03 HEADER-LONGITUD          PIC 9(4).
  1701       03 HEADER-TERMINAL          PIC X(8).
  1702       03 HEADER-NOMB-PROG         PIC X(6).
  1703       03 HEADER-FILA              PIC 99.
  1704       03 HEADER-COLUMNA           PIC 99.
  1705       03 HEADER-CARACT-INICIO     PIC 9.
  1706       03 HEADER-CARACT-FIN        PIC 9.
  1707       03 HEADER-TIPO-TERMINAL     PIC X(6).
  1708       03 HEADER-FILLER            PIC X(5).
  1709    02 TEXTO                       PIC X(2000).
  1710    02 TEXTO-INPUT REDEFINES TEXTO.
  1711       03 AREA-INPUT               PIC X(80).
  1712       03 FILLER                   PIC X(1920).
  1713*-----------------------------------------------------------*
  1714 01  TABLA-HISTORICA-MORAS.
  1715     03 w-moras-historicas-v       pic X(48) value zeros.
  1716     03 w-moras-historicas-v-r redefines w-moras-historicas-v.
  1717        05 w-moras-historicas occurs 48 times pic X(01).
  1718 01  ARRASTRE                      PIC 9 VALUE ZEROS.
  1719*------------------------------------------------------------*
* 1720 COPY ICFILE.WS.
  1721* ICFILE-WS.v.0043.
  1722* COPY PARA DIRECCIONAR LOS ARCHIVOS.
  1723*****************************************************************
  1724* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS
  1725*R.MARTINEZ   * UNIVERSAL.
  1726******************************************************************
  1727* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *
  1728* VICTOR HUGO *                                                  *
  1729* FORERO      *                                                  *
  1730* DIC.01/2000 *                                                  *
  1731******************************************************************
  1732* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *
  1733* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *
  1734* FORERO      * NOMREG - REGISTRADURIA                           *
  1735* SEP.10/2001 * NOMDAS - DAS                                     *
  1736*             * NMDIAN - DIAN                                    *
  1737******************************************************************
  1738* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *
  1739* VICTOR HUGO * BYINGTON                                         *
  1740* FORERO      *                                                  *
  1741* FEB.18/2002 *                                                  *
  1742******************************************************************
  1743* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *
  1744* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  31
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1745* SEP.04/2002 *                                                  *
  1746* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*
  1747* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *
  1748* OCT.29/2002 *                                                  *
  1749******************************************************************
  1750* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *
  1751* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *
  1752* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *
  1753* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*
  1754*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *
  1755*             *          ENTRADA-ENTIDAD                         *
  1756*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *
  1757* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *
  1758*             *          CIONES Y TELEFONOS                      *
  1759*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1760*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1761*             *          RRIENTES CON RECLAMOS VIGENTES          *
  1762******************************************************************
  1763* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1764* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1765* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*
  1766*             *          NOMBRE                                  *
  1767******************************************************************
  1768* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *
  1769* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *
  1770* FEB.14/2003 *                                                  *
  1771******************************************************************
  1772* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1773* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *
  1774* MAR.03/2003 *          CON NUEVOS DISENOS.                     *
  1775******************************************************************
  1776* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *
  1777* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *
  1778* JUN.05/2003 *                                                  *
  1779* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *
  1780* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *
  1781* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *
  1782******************************************************************
  1783* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1784* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *
  1785* JUL.09/2003 *          en $TRABAJO/logs                        *
  1786******************************************************************
  1787* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*
  1788* G.JIMENEZ  .*                                                  *
  1789* SEP.11/2003 *                                                  *
  1790******************************************************************
  1791* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *
  1792* G.JIMENEZ  .*                                                  *
  1793* OCT.14/2004 *                                                  *
  1794******************************************************************
  1795* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1796* G.JIMENEZ   *          PRODUCTOS                               *
  1797* ABR/2005    *                                                  *
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1800* F.CUADROS   *          FRAINQ.DAT                              *
  1801* JUN.23/2005 *                                                  *
  1802******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *
  1804* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *
  1805* SEP.02/2005 *                                                  *
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *
  1808* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *          TIPO 8                                  *
  1810*             *                                                  *
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *
  1814* OCT.17/2006 *                                                  *
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *
  1817* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *
  1818* SEP.11/2007 *                                                  *
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *
/d/iccol/desarrollo/fuentes/cobol>clear
/d/iccol/desarrollo/fuentes/cobol>^[  /d/iccol/desarrollo/fuentes/cobol>clearcat icestd81.lst
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   1
* /d/iccol/desarrollo/fuentes/cobol/icestd81.cbl
* Options: int("icestd81.int") anim csi verbose nolist sourceasm endp
*          list("icestd81.lst")
     1*icestd81.cbl.v.01.0002
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID.    icestd81-DATACREDITO.
     4 AUTHOR.        DATACREDITO-JAGR.
     5 DATE-WRITTEN.  OCT/2006.
     6 DATE-COMPILED. 21-May-14 10:39.
     7******************************************************************
     8* GDT0001    | LEY001 - PROCESO DE AMNISTIA SEGUN ARTICULO 0021  *
     9* ENE.23/2008|    QUE INCLUYE EL VECTOR DE 48 POSICIONES.        *
    10* GER.DESARR.|                                                   *
    11******************************************************************
    12******************************************************************
    13* GDT0002    | CTAST8 - CAMBIO DEL ICMCHK (MAESTRO DE CUENTAS) A *
    14* FEB.09-2010|    FORMATO TIPO 8.                                *
    15* GER.DESARR.|                                                   *
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 SOURCE-COMPUTER. MICROFOCUS.
    20 OBJECT-COMPUTER. MICROFOCUS.
    21****************************************************************
    22*
    23*  GENERA STANDARD DE MAYOR INFORMACION DISPONIBLE  GENERAL
    24*
    25*  -SE CONTROLA FNA PARA QUE SEA CARTERA DE VIVIENDA SEGUN PLAZO
    26*
    27*  -SE CONTROLA QUE AVANTEL ENTRE A TELCOS  Y NO A REAL
    28*
    29*   sh-datainforme
    30*
    31*  VERSION ACTUAL  DIC/2006   07/12/2006 04:37:06 p.m.
    32****************************************************************
    33 INPUT-OUTPUT SECTION.
    34 FILE-CONTROL.
*   35     COPY ICBDIR.FS.                                              GDT0001
    36* ICBDIR-fs.v01.002
    37* MAESTRO DE DIRECCIONES POR CADA CUENTA QUE HA SIDO REPORTADA
    38* POR LOS DIFERENTES SUSCRIPTORES
    39 $SET IDXFORMAT"8"
    40
    41$SET CONSTANT SW-STATUS-ICBDIR"NO"
    42     SELECT MAESTRO-DIRECC
    43            ASSIGN TO DISK MAES-DIRECC-TITLE
    44            ORGANIZATION IS INDEXED
    45            ACCESS MODE IS DYNAMIC
    46            RECORD KEY IS LLAVE-DIRECC
    47$IF SW-STATUS-ICBDIR = "NO"
    48$DISPLAY ".............COMPILANDO ICBDIR SIN STATUS.........."
    49$ELSE
    50$DISPLAY ".............COMPILANDO ICBDIR CON STATUS.........."
    51X           FILE STATUS IS EST-ICBDIR
    52$END
    53            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    54 $SET IDXFORMAT"0"
*   55     COPY BDACSV.FS.                                              GDT0001
    56* BDACSV-FS.V.0001
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   2
* )d/iccol/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
    57* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
    58* DATOS OFICIALES DE REGIS, DIAN Y DAS
    59     SELECT BDACSV
    60            ASSIGN TO DISK "$DATABASE/BDACSV"
    61            ORGANIZATION IS INDEXED
    62            ACCESS MODE IS DYNAMIC
    63            RECORD KEY IS LLAVE-BDACSV
    64            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
*   65     COPY NOAMNISTIA21.FS.                                        GDT0001
    66* NOAMNISTIA21-FS.V.0001
    67* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
    68* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
    69     SELECT NOAMNISTIA21
    70            ASSIGN TO DISK "$DATABASE/NOAMNISTIA21"
    71            ORGANIZATION IS INDEXED
    72            ACCESS MODE IS DYNAMIC
    73            RECORD KEY IS LLAVE-NOAMNISTIA21
    74            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    75*                                                                 GDT0001
*   76     COPY ICBSUS.FS.
    78$SET CONSTANT SW-STATUS-ICBSUS"NO"
    79     SELECT SUSCRIPTOR
    80            ASSIGN TO DISK SUSCRIPTOR-TITLE
    81            ORGANIZATION IS INDEXED
    82            ACCESS MODE IS DYNAMIC
    83            RECORD KEY IS LLAVE-SUSCRIP
    84$IF SW-STATUS-ICBSUS = "NO"
    85$DISPLAY ".............COMPILANDO ICBSUS SIN STATUS.........."
    86$ELSE
    87$DISPLAY ".............COMPILANDO ICBSUS CON STATUS.........."
    88X           FILE STATUS IS COD-RETORNO-ICBSUS
    89$END
    90            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
    91
*   92     COPY ICBCON.FS.
    93* EST005.v.02.002
    94* ARCHIVO QIE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
    95* TIPO 5
    96     SELECT INDEXADO
    97            ASSIGN TO DISK INDEXADO-TITLE
    98            ORGANIZATION IS INDEXED
    99            ACCESS MODE IS DYNAMIC
   100            RECORD KEY IS LLAVE-INDEX
   101            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   102*    COPY  ICBCHK.FS.                                             GDT0002
*  103     COPY  ICBCHK0001.FS.                                         GDT0002
   104*ICBCHK0001.FS.v.01.0001
   105******************************************************************
   106* EST027.v.02.002                                                *
   107* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO*
   108* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES                     *
   109******************************************************************
   110 $SET IDXFORMAT"8"
   111
   112     SELECT  MAESTRO-CHECK  ASSIGN TO  MAES-CHECK-TITLE
   113             ORGANIZATION          IS  INDEXED
   114             ACCESS         MODE   IS  DYNAMIC
   115             RECORD         KEY    IS  LLAVE-MAES-CHECK
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   3
* )21.FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   116             LOCK           MODE   IS  MANUAL WITH LOCK ON RECORD.
   117
   118 $SET IDXFORMAT"0"
*  119     COPY ICBCRE.FS.
   120* EST029.v.02.003
   121* MAESTRO DE OBLIGACIONES DE CARTERA Y TARJETA DE CREDITO REPORTADAS
   122* POR LOS DIFERENTES SUSCRIPTORES
   123 $SET IDXFORMAT"8"
   124
   125     SELECT MAESTRO-CREDIT
   126            ASSIGN TO DISK MAES-CREDIT-TITLE
   127            ORGANIZATION IS INDEXED
   128            ACCESS MODE IS DYNAMIC
   129            RECORD KEY IS LLAVE-MAES-CREDIT
   130*           ALTERNATE RECORD KEY IS LLAVE-MAES-CREDIT-ALT
   131            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   132
   133 $SET IDXFORMAT"0"
*  134     COPY BDIEMSUP0001.FS.
   135* BDIEMSUP-FS.v.0001
   136**********************************************************
   137*MAESTRO DE INFORMACION SUPERINTENDENCIA FORMATO TIPO 8  *
   138**********************************************************
   139 $SET IDXFORMAT"8"
   140     SELECT BDIEMSUP ASSIGN TO DISK TITLE-BDIEMSUP
   141            ORGANIZATION IS INDEXED
   142            ACCESS MODE IS DYNAMIC
   143            RECORD KEY IS BDIEMSUP-LLAVE
   144            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   145 $SET IDXFORMAT"0"
   146
*  147     COPY BDIEENTI.FS.
   148* BDIEENTI-FS.v.0002
   149*******************************************
   150*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
   151*******************************************
   152
   153     SELECT BDIEENTI ASSIGN TO DISK SI-BDIEENTI
   154            ORGANIZATION IS INDEXED
   155            ACCESS IS DYNAMIC
   156            RECORD KEY IS BDIEENTI-LLAVE
   157            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
   158
*  159     COPY BDACUE.FS.
   161*****************************************************************
   162* ARCHIVO DE TIPOS DE CUENTA DE DATACREDITO
   163*****************************************************************
   164$SET CONSTANT SW-STATUS-BDACUE"NO"
   165     SELECT BDACUE    ASSIGN TO DISK "$DATABASE/BDACUE"
   166           ORGANIZATION IS LINE SEQUENTIAL
   167           ACCESS MODE IS SEQUENTIAL
   168$IF SW-STATUS-BDACUE = "NO"
   169$DISPLAY ".............COMPILANDO BDACUE SIN STATUS.........."
   170$ELSE
   171$DISPLAY ".............COMPILANDO BDACUE CON STATUS.........."
   172X           FILE STATUS IS COD-RETORNO-BDACUE
   173$END
   174            LOCK MODE IS MANUAL WITH LOCK ON RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   4
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   175     SELECT ENTRADA  ASSIGN TO DISK ARCHIVO-ENTRADA
   176            ORGANIZATION   IS LINE SEQUENTIAL
   177            ACCESS MODE    IS SEQUENTIAL
   178            FILE STATUS    IS W-STATUS-ENT.
   179
   180     SELECT INCONSIS ASSIGN TO DISK ARCHIVO-INCONC
   181            ORGANIZATION   IS LINE SEQUENTIAL
   182            ACCESS MODE    IS SEQUENTIAL
   183            FILE STATUS    IS W-STATUS-INC.
   184
   185     SELECT SALIDA   ASSIGN  TO DISK ARCHIVO-SALIDA
   186            ORGANIZATION   IS LINE SEQUENTIAL
   187            ACCESS MODE    IS SEQUENTIAL.
   188
   189     SELECT ESTADIS  ASSIGN  TO DISK ARCHIVO-ESTADIS
   190            ORGANIZATION   IS LINE SEQUENTIAL
   191            ACCESS MODE    IS SEQUENTIAL.
   192
   193
   194 DATA DIVISION.
   195 FILE SECTION.
*  196 COPY ICBDIR0001.FD.                                              GDT0001
   197* ICBDIR0001-FD.V01.007.
   198* MAESTRO DE DIRECCIONES POR CUENTA EXTRACTADO DE LAS REPORTADAS
   199* POR LOS DIFERENTES SUSCRIPTORES
   200******************************************************************
   201* FAC0002      * AMPDIR: SE REORGANIZA Y AMPLIA LA ESTRUCTURA DEL
   202* F.CUADROS C. * MAESTRO DE DIRECCIONES POR ENTRADA DE MAESTROS DE
   203* FEB.15/2006  * DATACLIENTES.
   204******************************************************************
   205* VHF0003      * RCNCER - SE CREAN FLAGS PARA INDICAR SI UNA     *
   206* VICTOR HUGO  *          DIRECCION ESTA CERTIFICADA POR LA      *
   207* FORERO       *          DIVISION DE DOCUMENTOS. TAMBIEN SE     *
   208* JUL.11/2006  *          CREARON CAMPOS QUE INDICAN SI LA       *
   209*              *          DIRECCION FUE GEOREFERENCIADA.         *
   210******************************************************************
   211* CAV0004      * BDACSV - INCLUIR INDICADOR PARA DETERMINAR SI   *
   212* C VELASCO    *          EL REGISTRO CORRESPONDE A UNA CUENTA   *
   213* AGO/27/2007  *          SIN VALIDAR IDENTIFICACION             *
   214******************************************************************
   215* VHF0005     * FASEII - DENTRO DE LA OPTIMIZACION DE RECONOCER *
   216* VICTOR HUGO  *          SE ADICIONAN FECHAS INDEPENDIENTES PARA*
   217* FORERO       *          CADA TIPO DE DATOS DE LOCALIZACION     *
   218* JUL.25/2008  *                                                 *
   219******************************************************************
   220* RMB0006      * DANE01 - INCLUIR LOS CODIGOS DANE EN LAS CIUDADE*
   221* R MARTINEZ   *          S DE RESICENCIA,LABORAL Y CORRESPONDENC*
   222* SEP/07/2011  *          CIA.                                   *
   223******************************************************************
   224* CAV0007      * FLAGCM - INCLUIR UN FLAG POR CADA CAMPO PARA    *
   225* C.VELASCO    *          IDENTIFICAR CUANDO ESTABA VACIO Y SE   *
   226* OCT/25/2012  *          ACTUALIZO.                             *
   227******************************************************************
   228 FD  MAESTRO-DIRECC.
   229 01  REG-DIRECC.
   230     03  LLAVE-DIRECC.
   231         05  LLAVE-PRI-DIRECC.
   232             07  TIPO-ID-DIRECC    PIC 9(01).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   5
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   233             07  NUM-ID-DIRECC     PIC 9(13).                     FAC0002
   234         05  LLAVE-ALT-DIRECC.
   235             07  COD-SUS-DIRECC    PIC 9(06).
   236             07  COD-CTA-DIRECC    PIC 9(02).
   237             07  NUM-CTA-DIRECC    PIC X(18).
   238     03  FECAPE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   239     03  FECCRE-DIRECC             PIC 9(06) COMP-3.              FAC0002
   240     03  FECACT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   241     03  CIURES-DIRECC             PIC X(20).                     FAC0002
   242     03  DPTRES-DIRECC             PIC X(20).                     FAC0002
   243     03  DIRRES-DIRECC             PIC X(60).                     FAC0002
   244     03  TELRES-DIRECC             PIC 9(12) COMP-3.              FAC0002
   245     03  FECRES-DIRECC             PIC 9(06) COMP-3.              FAC0002
   246     03  FECDRES-DIRECC REDEFINES FECRES-DIRECC PIC 9(06) COMP-3. VHF0005
   247     03  CIULAB-DIRECC             PIC X(20).                     FAC0002
   248     03  DPTLAB-DIRECC             PIC X(20).                     FAC0002
   249     03  DIRLAB-DIRECC             PIC X(60).                     FAC0002
   250     03  TELLAB-DIRECC             PIC 9(12) COMP-3.              FAC0002
   251     03  FECLAB-DIRECC             PIC 9(06) COMP-3.              FAC0002
   252     03  FECDLAB-DIRECC REDEFINES FECLAB-DIRECC PIC 9(06) COMP-3. VHF0005
   253     03  CIUCOR-DIRECC             PIC X(20).                     FAC0002
   254     03  DPTCOR-DIRECC             PIC X(20).                     FAC0002
   255     03  DIRCOR-DIRECC             PIC X(60).                     FAC0002
   256     03  FECCOR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   257     03  FECDCOR-DIRECC REDEFINES FECCOR-DIRECC PIC 9(06) COMP-3. VHF0005
   258     03  E-MAIL-DIRECC             PIC X(40).                     FAC0002
   259     03  TELCEL-DIRECC             PIC 9(12) COMP-3.              FAC0002
   260     03  FECOTR-DIRECC             PIC 9(06) COMP-3.              FAC0002
   261     03  FECCEL-DIRECC REDEFINES FECOTR-DIRECC PIC 9(06) COMP-3.  VHF0005
   262     03  FECULT-DIRECC             PIC 9(06) COMP-3.              FAC0002
   263***  LOS POSIBLES VALORES DE LOS SEIS SIGUIENTES CAMPOS SON       VHF0003
   264***  DE ACUERDO AL TIPO DE DIRECCION(RES-RESIDENCIAL, LAB-LABORAL,VHF0003
   265***  COR-CORRESPONDENCIA)                                         VHF0003
   266***     CER???-DIRECC:                                            VHF0003
   267***        0 - DIRECCION NO HA SIDO CERTIFICADA                   VHF0003
   268***        1 - DIRECCION FUE CERTIFICADA EXITOSAMENTE             VHF0003
   269***        2 - DIRECCION CERTIFICADA SIN EXITO                    VHF0003
   270***     ADI???-DIRECC:                                            VHF0003
   271***       00 - DIRECCION NO HA SIDO GEOREFERENCIADA               VHF0003
   272***       01 - DIRECCION FUE GEOREFERENCIADA EXITOSAMENTE         VHF0003
   273***       02 - DIRECCION GEOREFERENCIADA SIN EXITO                VHF0003
   274     03  CERRES-DIRECC             PIC 9(01).                     VHF0003
   275     03  ADIRES-DIRECC             PIC 9(02).                     VHF0003
   276     03  CERLAB-DIRECC             PIC 9(01).                     VHF0003
   277     03  ADILAB-DIRECC             PIC 9(02).                     VHF0003
   278     03  CERCOR-DIRECC             PIC 9(01).                     VHF0003
   279     03  ADICOR-DIRECC             PIC 9(02).                     VHF0003
   280     03  INDCSV-DIRECC             PIC 9(01).                     CAV0004
   281     03  FECTRES-DIRECC            PIC 9(06) COMP-3.              VHF0005
   282     03  FECTLAB-DIRECC            PIC 9(06) COMP-3.              VHF0005
   283     03  FECMAIL-DIRECC            PIC 9(06) COMP-3.              VHF0005
   284*    03  FILLER-DIRECC             PIC X(40).                     VHF0005
   285*    03  FILLER-DIRECC             PIC X(28).                     RMB0006
   286     03  CODDANE-RES-DIRECC        PIC 9(08) COMP-3.              RMB0006
   287     03  CODDANE-LAB-DIRECC        PIC 9(08) COMP-3.              RMB0006
   288     03  CODDANE-COR-DIRECC        PIC 9(08) COMP-3.              RMB0006
   289     03  FLAG-DIRRES-DIRECC        PIC X.                         CAV0007
   290     03  FLAG-TELRES-DIRECC        PIC X.                         CAV0007
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   6
* )S).FS)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBD
   291     03  FLAG-DIRLAB-DIRECC        PIC X.                         CAV0007
   292     03  FLAG-TELLAB-DIRECC        PIC X.                         CAV0007
   293     03  FLAG-DIRCOR-DIRECC        PIC X.                         CAV0007
   294     03  FLAG-CELULAR-DIRECC       PIC X.                         CAV0007
   295     03  FLAG-EMAIL-DIRECC         PIC X.                         CAV0007
   296*    03  FILLER-DIRECC             PIC X(13).                     CAV0007
   297     03  FILLER-DIRECC             PIC X(06).                     CAV0007
*  298 COPY BDACSV.FD.                                                  GDT0001
   299* BDACSV-FD.v.0003
   300* ARCHIVO DE IDENTIFICACIONES NO ENCONTRADAS EN LAS BASES DE
   301* DATOS OFICIALES DE REGIS, DIAN Y DAS
   302******************************************************************
   303* RMB0002    * BLOQ01 - CAMPOS PARA BLOQUEO DEL REGISTRO
   304* AGO-21-2011* TIP6Y7 - IDENTIFICA SI EL REGISTRO ENTRO POR T6 O
   305* R.MARTINEZ *          POR T7
   306******************************************************************
   307* STT0003    * INCLUS - INCLUSION IDENTIFICACIONES CON INFORMACION
   308* OCT-12-2012*          DE REGISTRADURIA INCOMPLETA DE FUENTE
   309* LUIS GOMEZ *          CONFIABLE
   310******************************************************************
   311 FD  BDACSV.
   312 01  REG-BDACSV.
   313     03 LLAVE-BDACSV.
   314        05  TIPO-ID-BDACSV    PIC 9(01).
   315        05  NUM-ID-BDACSV     PIC 9(15).
   316        05  COD-SUS-BDACSV    PIC 9(06).
   317        05  COD-CTA-BDACSV    PIC 9(02).
   318        05  NUM-CTA-BDACSV    PIC X(25).
   319     03  NOMBRE-BDACSV        PIC X(45).
   320     03  NOMBRE-R-BDACSV REDEFINES NOMBRE-BDACSV.                 STT0003
   321        05 APELLIDO1-BDACSV      PIC X(16).                       STT0003
   322        05 APELLIDO2-BDACSV      PIC X(16).                       STT0003
   323        05 DES-NOMBRE1-BDACSV    PIC X(12).                       STT0003
   324     05  IND-UNIFICADO-BDACSV    PIC 9(01).                       STT0003
   325     03  FECHA-CREA-BDACSV       PIC 9(08).
   326     03  NUM-PORTAF-BDACSV    PIC 9(02).
   327     03  IND-NOMBRE-BDACSV    PIC 9(02).
   328     03  MEJOR-PORTAF-BDACSV  PIC 9(02).
   329     03  IND-ACTUALIZ-BDACSV  PIC 9(02).
   330     03  FUENTE-REG-BDACSV    PIC 9(02).
   331     03  IND-BLOQUEO-BDACSV   PIC X(01). *> B=BLOQUEADO           RMB0002
   332     03  TIPO7-6-BDACSV       PIC X(01). *> 5=T6,1=T7             RMB0002
   333*    03  FILLER               PIC X(50).                          STT0003
   334     03  CAMPOS-REGISTRADURIA-BDACSV.                             STT0003
   335         05  DES-NOMBRE2-BDACSV    PIC X(12).                     STT0003
   336         05  FECHA-EXPEDI-BDACSV   PIC 9(8).                      STT0003
   337         05  DEP-EXP-BDACSV        PIC 9(02).                     STT0003
   338         05  MUNIC-EXP-BDACSV      PIC 9(03).                     STT0003
   339         05  ESTADO-VIG-BDACSV     PIC 9(02).                     STT0003
   340         05  FECHA-NACIMNTO-BDACSV PIC 9(08).                     STT0003
   341         05  IND-SEXO-BDACSV       PIC X.                         STT0003
   342         05  IND-ESTADO-BDACSV     PIC 9.                         STT0003
   343         05  IND-CONSULADO-BDACSV  PIC 9(1).                      STT0003
   344         05  COD-CONSULADO-BDACSV  PIC 9(3).                      STT0003
   345     03  FILLER                    PIC X(07).                     STT0003
   346*    03  FILLER               PIC X(48).
   347
   348
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   7
* ).FD)S)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
   349
*  350 COPY NOAMNISTIA21.FD.                                            GDT0001
   351* NOAMNISTIA21-FD.v.0001
   352* ARCHIVO DE IDENTIFICACIONES A LAS CUALES NO APLICA LA
   353* AMNISTIA POR QUE TODOS SUS REGISTROS SE ENCUENTRAN AL DIA
   354******************************************************************
   355******************************************************************
   356 FD  NOAMNISTIA21.
   357 01  REG-NOAMNISTIA21.
   358     03 LLAVE-NOAMNISTIA21.
   359        05  TIPO-ID-NOAMNISTIA21      PIC 9(01).
   360        05  NUM-ID-NOAMNISTIA21       PIC 9(11).
   361     03  FECHA-CREA-NOAMNISTIA21      PIC 9(08).
   362     03  FILLER                       PIC X(10).
   363*                                                                 GDT0001
   364 FD  ENTRADA.
   365 01  REG-ENTRADA.
   366     03 ENT-TIPO-ID               PIC 9(01).
   367     03 ENT-NUME-ID               PIC 9(11).
   368     03 ENT-NOMBRE                PIC X(45).
   369     03 ENT-FEC-EXPED             PIC 9(08).
   370     03 ENT-CIUDAD-EXP            PIC X(15).
   371     03 ENT-DEP-EXP-VAL           PIC X(15).
   372     03 ENT-VIG-VAL               PIC X(02).
   373     03 ENT-GENERO-VAL            PIC X(01).
   374     03 ENT-EDAD                  PIC X(03).
   375     03 ENT-EDAD-RANGO            PIC X(05).
   376     03 FILLER                    PIC X(51).
   377
   378 FD  INCONSIS.
   379 01  REG-INCONSIS.
   380     03 TIP-INC                   PIC 9.
   381     03 CED-INC                   PIC 9(11).
   382     03 NOM1-INC                  PIC X(45).
   383     03 NOM2-INC                  PIC X(45).
   384     03 FEC-EXP-INC               PIC 9(08).
   385     03 MUN-EXP-INC               PIC X(15).
   386     03 DEP-EXP-INC               PIC X(15).
   387     03 VIG-INC                   PIC X(02).
   388     03 CODERR-INC                PIC 9(02).
   389     03 FILLER-2-INC              PIC X(60).
   390
   391
   392 FD  SALIDA.
   393 01  REG-SALIDA.
   394     03 SLD-TIPO-ID                    PIC 9(01).
   395     03 FILLER01                       PIC X(01) VALUE ";".
   396     03 SLD-NUME-ID                    PIC 9(11).
   397     03 FILLER02                       PIC X(01) VALUE ";".
   398     03 SLD-NOMBRE                     PIC X(45).
   399     03 FILLER03                       PIC X(01) VALUE ";".
   400     03 SLD-RANGO-EDAD                 PIC X(05).
   401     03 FILLER04                       PIC X(01) VALUE ";".
   402     03 SLD-GENERO                     PIC X(01).
   403     03 FILLER05                       PIC X(01) VALUE ";".
   404     03 SLD-CIUDAD-EXPED               PIC X(15).
   405     03 FILLER06                       PIC X(01) VALUE ";".
   406     03 SLD-CREDITOS-ACTV              PIC 9(04).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   8
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   407     03 FILLER07                       PIC X(01) VALUE ";".
   408     03 SLD-NUM-OBLIG-CAB              PIC 9(04).
   409     03 FILLER08                       PIC X(01) VALUE ";".
   410     03 SLD-TOT-INICIAL-CAB            PIC 9(15).
   411     03 FILLER09                       PIC X(01) VALUE ";".
   412     03 SLD-TOT-SALDOS-CAB             PIC 9(15).
   413     03 FILLER10                       PIC X(01) VALUE ";".
   414     03 SLD-TOT-CUOTAS-CAB             PIC 9(11).
   415     03 FILLER11                       PIC X(01) VALUE ";".
   416     03 SLD-TOT-MORA-CAB               PIC 9(11).
   417     03 FILLER12                       PIC X(01) VALUE ";".
   418     03 SLD-NUM-OBLIG-CAV              PIC 9(04).
   419     03 FILLER13                       PIC X(01) VALUE ";".
   420     03 SLD-TOT-INICIAL-CAV            PIC 9(15).
   421     03 FILLER14                       PIC X(01) VALUE ";".
   422     03 SLD-TOT-SALDOS-CAV             PIC 9(15).
   423     03 FILLER15                       PIC X(01) VALUE ";".
   424     03 SLD-TOT-CUOTAS-CAV             PIC 9(11).
   425     03 FILLER16                       PIC X(01) VALUE ";".
   426     03 SLD-TOT-MORA-CAV               PIC 9(11).
   427     03 FILLER17                       PIC X(01) VALUE ";".
   428     03 SLD-NUM-OBLIG-OTR              PIC 9(04).
   429     03 FILLER18                       PIC X(01) VALUE ";".
   430     03 SLD-TOT-INICIAL-OTR            PIC 9(15).
   431     03 FILLER19                       PIC X(01) VALUE ";".
   432     03 SLD-TOT-SALDOS-OTR             PIC 9(15).
   433     03 FILLER20                       PIC X(01) VALUE ";".
   434     03 SLD-TOT-CUOTAS-OTR             PIC 9(11).
   435     03 FILLER21                       PIC X(01) VALUE ";".
   436     03 SLD-TOT-MORA-OTR               PIC 9(11).
   437     03 FILLER22                       PIC X(01) VALUE ";".
   438     03 SLD-TOT-NUM-TDC                PIC 9(04).
   439     03 FILLER23                       PIC X(01) VALUE ";".
   440     03 SLD-TOT-CUPOS-TDC              PIC 9(15).
   441     03 FILLER24                       PIC X(01) VALUE ";".
   442     03 SLD-TOT-SALDO-TDC              PIC 9(15).
   443     03 FILLER25                       PIC X(01) VALUE ";".
   444     03 SLD-POR-UTILIZ-TDC             PIC Z.ZZZZZ.
   445     03 FILLER26                       PIC X(01) VALUE ";".
   446     03 SLD-TOT-CUOTAS-TDC             PIC 9(11).
   447     03 FILLER27                       PIC X(01) VALUE ";".
   448     03 SLD-TOT-MORA-TDC               PIC 9(11).
   449     03 FILLER28                       PIC X(01) VALUE ";".
   450     03 SLD-NRO-RANGO-0                PIC 9(03).
   451     03 FILLER29                       PIC X(01) VALUE ";".
   452     03 SLD-NRO-RANGO-1                PIC 9(03).
   453     03 FILLER30                       PIC X(01) VALUE ";".
   454     03 SLD-NRO-RANGO-2                PIC 9(03).
   455     03 FILLER31                       PIC X(01) VALUE ";".
   456     03 SLD-NRO-RANGO-3                PIC 9(03).
   457     03 FILLER32                       PIC X(01) VALUE ";".
   458     03 SLD-NRO-RANGO-4                PIC 9(03).
   459     03 FILLER33                       PIC X(01) VALUE ";".
   460     03 SLD-NRO-RANGO-5                PIC 9(03).
   461     03 FILLER34                       PIC X(01) VALUE ";".
   462     03 SLD-NRO-RANGO-6                PIC 9(03).
   463     03 FILLER35                       PIC X(01) VALUE ";".
   464     03 SLD-FECHA-TDC                  PIC X(06).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page   9
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   465     03 FILLER36                       PIC X(01) VALUE ";".
   466     03 SLD-NUM-OBLIG-REAL             PIC 9(04).
   467     03 FILLER37                       PIC X(01) VALUE ";".
   468     03 SLD-TOT-INICIAL-REAL           PIC 9(15).
   469     03 FILLER38                       PIC X(01) VALUE ";".
   470     03 SLD-TOT-SALDOS-REAL            PIC 9(15).
   471     03 FILLER39                       PIC X(01) VALUE ";".
   472     03 SLD-TOT-CUOTAS-REAL            PIC 9(11).
   473     03 FILLER40                       PIC X(01) VALUE ";".
   474     03 SLD-TOT-MORA-REAL              PIC 9(11).
   475     03 FILLER41                       PIC X(01) VALUE ";".
   476     03 SLD-NUM-OBLIG-TELE             PIC 9(04).
   477     03 FILLER42                       PIC X(01) VALUE ";".
   478     03 SLD-TOT-CUOTAS-TELE            PIC 9(11).
   479     03 FILLER43                       PIC X(01) VALUE ";".
   480     03 SLD-TOT-MORA-TELE              PIC 9(11).
   481     03 FILLER44                       PIC X(01) VALUE ";".
   482     03 SLD-NUM-OBLIG-COOP             PIC 9(04).
   483     03 FILLER45                       PIC X(01) VALUE ";".
   484     03 SLD-TOT-INICIAL-COOP           PIC 9(15).
   485     03 FILLER46                       PIC X(01) VALUE ";".
   486     03 SLD-TOT-SALDOS-COOP            PIC 9(15).
   487     03 FILLER47                       PIC X(01) VALUE ";".
   488     03 SLD-TOT-CUOTAS-COOP            PIC 9(11).
   489     03 FILLER48                       PIC X(01) VALUE ";".
   490     03 SLD-TOT-MORA-COOP              PIC 9(11).
   491     03 FILLER49                       PIC X(01) VALUE ";".
   492     03 SLD-NUM-OBLIG-CODEU            PIC 9(04).
   493     03 FILLER50                       PIC X(01) VALUE ";".
   494     03 SLD-TOT-SALDOS-CODEU           PIC 9(15).
   495     03 FILLER51                       PIC X(01) VALUE ";".
   496     03 SLD-TOT-CUOTAS-CODEU           PIC 9(11).
   497     03 FILLER52                       PIC X(01) VALUE ";".
   498     03 SLD-TOT-MORA-CODEU             PIC 9(11).
   499     03 FILLER53                       PIC X(01) VALUE ";".
   500     03 SLD-CREDITOS-ALDIA             PIC 9(03).
   501     03 FILLER54                       PIC X(01) VALUE ";".
   502     03 SLD-MORA-30                    PIC 9(03).
   503     03 FILLER55                       PIC X(01) VALUE ";".
   504     03 SLD-MORA-60                    PIC 9(03).
   505     03 FILLER56                       PIC X(01) VALUE ";".
   506     03 SLD-MORA-90                    PIC 9(03).
   507     03 FILLER57                       PIC X(01) VALUE ";".
   508     03 SLD-MORA-120                   PIC 9(03).
   509     03 FILLER58                       PIC X(01) VALUE ";".
   510     03 SLD-CAR-CASTIGA                PIC 9(03).
   511     03 FILLER59                       PIC X(01) VALUE ";".
   512     03 SLD-DUD-RECAUDO                PIC 9(03).
   513     03 FILLER60                       PIC X(01) VALUE ";".
   514     03 SLD-CUENTAS-COBRADOR           PIC 9(03).
   515     03 FILLER61                       PIC X(01) VALUE ";".
   516     03 SLD-MORA-30-HIS                PIC 9(03).
   517     03 FILLER62                       PIC X(01) VALUE ";".
   518     03 SLD-MORA-60-HIS                PIC 9(03).
   519     03 FILLER63                       PIC X(01) VALUE ";".
   520     03 SLD-MORA-90-HIS                PIC 9(03).
   521     03 FILLER64                       PIC X(01) VALUE ";".
   522     03 SLD-MORA-120-HIS               PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  10
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/NOAM
   523     03 FILLER65                       PIC X(01) VALUE ";".
   524     03 SLD-CANC-MMANEJO               PIC 9(03).
   525     03 FILLER66                       PIC X(01) VALUE ";".
   526     03 SLD-CAR-RECUPERADA             PIC 9(03).
   527     03 FILLER67                       PIC X(01) VALUE ";".
   528     03 SLD-MORA-MAX-TDC               PIC 9(03).
   529     03 FILLER68                       PIC X(01) VALUE ";".
   530     03 SLD-MORA-MAX-CAB               PIC 9(03).
   531     03 FILLER69                       PIC X(01) VALUE ";".
   532     03 SLD-MORA-MAX-COOP              PIC 9(03).
   533     03 FILLER70                       PIC X(01) VALUE ";".
   534     03 SLD-MORA-MAX-CAV               PIC 9(03).
   535     03 FILLER71                       PIC X(01) VALUE ";".
   536     03 SLD-END-CALIF-1-TRIM           PIC X(01).
   537     03 FILLER72                       PIC X(01) VALUE ";".
   538     03 SLD-END-CALIF-2-TRIM           PIC X(01).
   539     03 FILLER73                       PIC X(01) VALUE ";".
   540     03 SLD-CTAS-AHORRO                PIC 9(03).
   541     03 FILLER74                       PIC X(01) VALUE ";".
   542     03 SLD-CTES-CORRIENTES            PIC 9(03).
   543     03 FILLER75                       PIC X(01) VALUE ";".
   544     03 SLD-CTES-EMBARGADAS            PIC 9(03).
   545     03 FILLER76                       PIC X(01) VALUE ";".
   546     03 SLD-CTES-MAL-MANEJO            PIC 9(03).
   547     03 FILLER77                       PIC X(01) VALUE ";".
   548     03 SLD-CTES-SALDADAS              PIC 9(03).
   549     03 FILLER78                       PIC X(01) VALUE ";".
   550     03 SLD-TOTAL-CONSULTAS            PIC 9(03).
   551     03 FILLER79                       PIC X(01) VALUE ";".
   552     03 SLD-CALIFICACION               PIC X(01).
   553*-----------------------------------------------------------*
   554 FD  ESTADIS.
   555 01  REG-ESTADIS.
   556     03 SLD-DETALLE                    PIC X(30).
   557     03 FILLER                         PIC X(01) VALUE ";".
   558     03 SLD-ESTADIS-VALOR-1            PIC Z(11).
   559     03 FILLER                         PIC X(01) VALUE ";".
   560     03 SLD-ESTADIS-VALOR-2            PIC Z(11).
   561     03 FILLER                         PIC X(01) VALUE ";".
   562     03 SLD-ESTADIS-VALOR-3            PIC Z(11).
   563     03 FILLER                         PIC X(01) VALUE ";".
   564     03 SLD-ESTADIS-VALOR-4            PIC Z(11).
   565     03 FILLER                         PIC X(01) VALUE ";".
   566     03 SLD-ESTADIS-VALOR-5            PIC Z(07).
   567
*  568 COPY ICBSUS.FD.
   571*******************************************************************
   572* FAC0011   * AMPLI2: SE CREA CAMPO CON SENAL USO DE M O P POR
   573* F.CUADROS *         DATAHOST
   574* FEB.2003  *
   575*******************************************************************
   576* FAC0012      * MOD012: SE AMPLIA EL CAMPO DE NOMBRE A 56 CARACTERES
   577* F.CUADROS    * Y EL CAMPO DIR-SUSCRIP PASA DE 45 A 29 CARACTERES.
   578* JUL.29/2003  * SE UTILIZA ASI EL FILLER QUE TENIA DE 16 POSICIONES
   579******************************************************************
   580* GJC0013      * REPETI: SE ADICIONA CAMPO QUE PERMITE QUE EL
   581* G.JIMENEZ    * PROGRAMA FACULIS IDENTIFIQUE SI SE DEBEN ELIMINAR
   582* SEP.15/2003  * LAS CONSULTAS REPETIDAS O NO.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  11
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   583******************************************************************
   584* GJC0014      * NEWCAM: CREACION DE NUEVO CAMPO INDICADOR DE SI SE
   585* G.JIMENEZ    * DEBE MOSTRAR EL ENDEUDAMIENTO GLOBAL A PARTIR DEL
   586* ENE. 07/2004 * HABITO DE PAGO.
   587******************************************************************
   588* FAC0015      * FRAU01: INCLUSION DE INDICADOR PARA PREGUNTAS DE
   589* F.CUADROS C. * FRAUDE
   590* JUN. 04/2004 *
   591******************************************************************
   592* FAC0016      * SISSSO: INCLUSION DE INDICADOR PARA SUSCRIPTORES
   593* F.CUADROS C. * COMO CLIENTES PILOTO SISTEMA SUI.
   594* DIC. 02/2004 * VALORES VALIDOS: 0-SISTEMA ACTUAL, 1-PASO MANUAL
   595*              * A SUI, 2-PASO AUTOMATICO A SUI.
   596******************************************************************
   597* FAC0017      * PAIS01: INCLUSION DE FECHA DE ACTUALIZACION DE
   598* F.CUADROS C. * ENDEUDAMIENTO GLOBAL
   599* MAR. 14/2005 *
   600******************************************************************
   601* RMB0018      * OUTV01: INDICADOR QUE OBLIGA A USAR CONSULTAS SOLO
   602* R.MARTINEZ   * A TRAVES DE DATA WEB
   603* ABR. 21/2005 *
   604******************************************************************
   605* GJC0019      * INFACT: SE INCLUYE FLAG PARA INDICAR SI EN LOS
   606* G.JIMENEZ    * INFORMES GENERADOS POR LA ACTUALIZACION SE GUAR-
   607* JUNIO/2005   * DAN TITULOS -0-SI  -1-NO
   608******************************************************************
   609* NDG0020      * SIRI01 : SE INCLUYE FLAG PARA EL MANEJO DE LA   *
   610* N.DUARTE     *          APLICACION EN FORMA DISTRIBUIDA EN LOS *
   611* 16/09/2005   *          BANCOS. 0 - EN DATACREDITO 1 - BANCOS. *
   612******************************************************************
   613* GJC0021      * BLQCNS : SE INCLUYE INDICADOR PARA MANEJO DE    *
   614* G.JIMENEZ    *          BLOQUEO PARA CONSULTAS                 *
   615* NOV. 01/2005 *                                                 *
   616******************************************************************
   617* FAC0022      * INDALI: SE INCLUYE INDICADOR PARA ALINEACION DE *
   618* F.CUADROS C. * CUENTAS DE HABITO DE PAGO 0-NO ALINEA 1-DERECHA *
   619* MAR.17/2006  *
   620******************************************************************
   621* FAC0023      * INDCUP: SE INCLUYE INDICADOR PARA CUPO EXCLUSIVO*
   622* F.CUADROS C. * DE UNA ENTIDAD SOLO PARA TDC.                   *
   623* JUN.13/2006  * VALORES IND-CUPO-EXCLSVO: 1(SI), 0(NO).         *
   624******************************************************************
   625* FAC0024      * RCNCER: SE INCLUYE LA FECHA DE ACTUALIZACIÓN DE *
   626* F.CUADROS C. * DIRECCIONES EN ARCHIVO ICBDIR.                  *
   627* JUL.05/2006  *                                                 *
   628******************************************************************
   629* GJC0025      * ASIGNA: SE CREA CAMPO PARA IDENTIFICAR EL NUMERO*
   630* G.JIMENEZ C. * DE CONSULTAS DE HISTORIA DE CREDITO PERMITIDAS  *
   631* JUL.27/2006  * ES PERMITIR N TRAMAS LARGAS POR UNA TRAMA CORTA *
   632******************************************************************
   633* GJC0026      * LOTPDF: CREACION DE INDICADOR QUE IDENTIFICA SI *
   634* G.JIMENEZ C. * LAS CONSULTAS EN LOTE SE DEBEN ENTREGAR EN FORMA*
   635* ABR.28/2008  * TO PDF O TECTO COMO SIEMPRE SE HA HECHO         *
   636******************************************************************
   637* GJC0027      * RAZON1: SE CREA CAMPO PARA INDICAR SI AL SUSCRIP*
   638* G.JIMENEZ C. * TOR SE LE DEBEN ENTREGAR O NO LAS RAZONES ADVER-*
   639* NOV.25/2008  * SAS DE LOS SCORES N- NO (DEFAULT) S-SI          *
   640******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  12
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   641* GJC0028      * ART-13: CREACION DE CAMPO QUE PERMITE AL ICGCON *
   642* G.JIMENEZ C. * IDENTIFICAR SI DEBE APLICAR O NO EL ARTICULO 13 *
   643* FEB.25/2009  * DE LA LEY. DOBLE DEL TIEMPO DE LA MORA N-NO     *
   644*              * S- SI -DEFAULT
   645******************************************************************
   646* GJC0029      * CBITMH: DEFINICION DE CAMPOS PARA SABER SI YA   *
   647* G.JIMENEZ C. *         SE ESTA ACTUALIZANDO CON EL NUEVO ACTUA-*
   648* JULIO /2009  *         LIZADOR O NO.                           *
   649******************************************************************
   650* GJC0030      * NWACT1: SE INCLUYE CAMPO PARA MANEJO DE CAMPO   *
   651* G.JIMENEZ C. *         QUE INDICA SI EL SUSCRIPTOR TIENE EL    *
   652* OCTUBRE/2009 *         MAESTRO CERTIFICADO O NO ASÍ: 0-NO CERTI*
   653*              *         FICADO, 1-CERTIFICADO CON DISENO DE 800 *
   654*              * RAYAS1: SE CREA INDICADOR PARA IDENTIFICAR SI SE*
   655*              *         DEBEN MOSTRAR GUIONES EN EL VECTOR DE   *
   656*              *         COMPORTAMIENTO O ESPACIOS EN POSICIONES *
   657*              *         ANTERIRORES A LA FECHA DE ENTRADA A DTC *
   658******************************************************************
   659* GJC0031      * PRJUR1: SE INCLUYE CAMPO PARA MANEJO DE COSNULTAS
   660* G.JIMENEZ C. *         DE PERSONAS JURIDICAS                   *
   661* FEB/2010     *         CONSULTA PER.NATURAL=PER JURIDICA (MISMO*
   662*              *         PRODUCTO) = 0
   663*              *         CONSULTA CON CODIGO DIFERENTE DE PRODUCTO
   664*              *          = 1
   665*              * CSVPAR: SE INCLUYE CAMPO PARA MANEJO PARAMETRICO*
   666*              *         DE LA INFORMACION DE CSV CUANDO SE HACE *
   667*              *         CONSULTA DATAHOST O WEBSERVICE          *
   668******************************************************************
   669* GJC0032      * SEPRES: SE INCLUYE INDICADOR PARA MANEJAR LA SE-*
   670* G.JIMENEZ C. *         PARACION DE ERRORES E INCONSISTENCIAS EN*
   671* SEP/2010     *         LA ACTUALIZACION: 1-CADA 65000 REGISTROS*
   672*              *         2-CADA 1400000 Y 3-SIN SEPARACION       *
   673******************************************************************
   674* GJC0033      * FECMOD: SE INCLUYE FECHA DE ULTIMA MODIFICACION *
   675* G.JIMENEZ C. *         DEL REGISTRO PARA PODER CONSERVAR LA    *
   676* AGOSTO/2012  *         HISTORIA DE LOS CAMBIOS                 *
   677******************************************************************
   678* RMB0035      * LOCAL1  SE ADICIONAN FLAGS PARA HABILITAR EL    *
   679* R.martinez   *         USO DE LOS DATOS DE LOCALIZACION EN EL  *
   680* Octubre/2012 *         MAESTRO DE DIRECCIONES ICBDIR           *
   681*              *         S=HABILTA EL CAMPO,N=INHIBE EL CAMPO    *
   682******************************************************************
   683* CAV0036      * ENTREG: SE INCLUYE EL CAMPO PARA IDENTIFICAR    *
   684* C.VELASCO.   *         LA ENTIDAD REGULADORA DE CADA CODIGO    *
   685* FEBRERO/2013 *         DE SUSCRIPTOR.                          *
   686*              * CONTRJ: SE INCLUYE EL CAMPO PARA IDENTIFICAR SI *
   687*              *         LA ENTIDAD ENVIA NUMERO DE OBLIGACION  Y*
   688*              *         NUMERO DE TARJETA.                      *
   689*              *         S - SI ENVIA TARJETA, OTRO VALOR - NO   *
   690******************************************************************
   691 FD  SUSCRIPTOR.
   692 01  REG-SUSCRIPTOR.
   693     03  COD-SUSCRIP-ABD02       PIC 9(6).
   694     03  LLAVE-SUSCRIP   REDEFINES COD-SUSCRIP-ABD02
   695                                 PIC X(6).
   696     03  COD-TIPCTA-ABD02        PIC 99    COMP-3.
   697     03  NOM-SUSCRIP-ABD02       PIC X(56).                       FAC0012
   698     03  DIR-SUSCRIP-ABD02       PIC X(29).                       FAC0012
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  13
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   699     03  FILLER REDEFINES DIR-SUSCRIP-ABD02.
   700*        04 FILLER               PIC X(16).                       FAC0012
   701         04 NOM-COR1-ABD02       PIC X(14).
   702         04 NOM-COR2-ABD02       PIC X(14).
   703         04 IND-COR-ABD02        PIC 9.
   704     03  FEC-NUEACT-ABD02        PIC 9(06) COMP-3.                VHF0009
   705     03  FACT-FIJA-ABD02         PIC 9(7)  COMP-3.
   706     03  IND-REGIST-ABD02        PIC 99    COMP-3.
   707     03  ESTADO-ABD02            PIC 9     COMP-3.
   708     03  FECHA-ING-ABD02         PIC 9(4)  COMP-3.
   709     03  FECHA-RET-ABD02         PIC 9(4)  COMP-3.
   710     03  F-ULT-ACT-ABD02         PIC 9(4)  COMP-3.
   711     03  NIT-SUSCRIP-S-ABD02     PIC 9(11) COMP-3.
   712     03  IND-AMPLIACION-ABD02    PIC 9.                           AMPINF5
   713     03  IND-PREPAGOS-ABD02      PIC 9.                           PREPAG1
   714     03  F-ACT-VAL-ABD02         PIC 9(6).                        AMPVAL1
   715     03  FEC-ACTEND-ABD02        PIC 9(06).                       FAC0017
   716     03  IND-PREG-FRAUDE-ABD02   PIC X(01).                       FAC0015
   717     03  FECHA-CREA-ABD02        PIC 9(06) COMP-3.                FAC0008
   718     03  IND-ENTREGA-INF-ABD02   PIC 9.                           FAC0008
   719     03  IND-RAZON-BLQ-ABD02     PIC 9.                           FAC0008
   720     03  F-ACT-SECREAL-ABD02     PIC 9(06) COMP-3.                VHF0009
   721     03  MES-1-SECREAL-ABD02     PIC 9(01).                       VHF0009
   722     03  MES-2-SECREAL-ABD02     PIC 9(01).                       VHF0009
   723     03  MES-3-SECREAL-ABD02     PIC 9(01).                       VHF0009
   724     03  MES-4-SECREAL-ABD02     PIC 9(01).                       VHF0009
   725     03  IND-CUOTA-AFIL-ABD02    PIC 9(01).                       FAC0010
   726     03  SENAL-DATAHOST-ABD02    PIC X(1).                        FAC0011
   727     03  IND-REPETIDAS-ABD02     PIC X(1).                        GJC013
   728     03  IND-ENDEUD-ABD02        PIC 9.                           GJC0014
   729     03  IND-PILOTO-ABD02        PIC 9.                           FAC0016
   730     03  IND-SOLOWEB-ABD02       PIC 9.                           RMB0018
   731     03  FLAG-INFOR-ACT          PIC 9.                           GJC0019
   732     03  IND-REMOTO-ABD02        PIC 9.                           NDG0020
   733     03  BLQ-CONS-ABD02          PIC 9.                           GJC0021
   734     03  IND-ALINEA-CTA-ABD02    PIC 9(01).                       FAC0022
   735     03  IND-CUPO-EXCLSVO-ABD02  PIC 9(01).                       FAC0023
   736     03  FEC-ACTDIR-ABD02        PIC 9(06) COMP-3.                FAC0024
   737     03  NRO-ASIGNAS-ABD02       PIC 9(02).                       GJC0025
   738     03  PDF-ABD02               PIC X(01).  *> S OR N            GJC0026
   739     03  ENTREGA-RAZONES-ABD02   PIC X(01).  *> S O N             GJC0027
   740     03  APLICA-ART13-ABD02      PIC X(01).  *> S o N             GJC0028
   741     03  FORM-NUEVO-ABD02        PIC X(01).  *> S o N             GJC0029
   742     03  FEC-NOV-FORM-NUEVO-ABD02 PIC 9(06) COMP-3.               GJC0029
   743     03  CERTIFICADO-ABD02       PIC 9(01).  *> 0-NO 1-SI DE 800  GJC0030
   744     03  RAYAS-ABD02             PIC X(01).  *> N-NO S-SI         GJC0030
   745     03  CSV-ABD02               PIC 9(01).  *> 0-NO 1-SI         GJC0031
   746     03  OTRO-PROD-JUR-ABD02     PIC X(01).  *> N-NO S-SI         GJC0031
   747     03  IND-SEPARA-RES-ABD02    PIC 9(01).                       GJC0032
   748     03  FEC-MOD-REG-ABD02       PIC 9(08).                       GJC0033
   749     03  DIRRES-ABD02            PIC X(01).                       RMB0034
   750     03  TELRES-ABD02            PIC X(01).                       RMB0034
   751     03  DIRLAB-ABD02            PIC X(01).                       RMB0034
   752     03  TELLAB-ABD02            PIC X(01).                       RMB0034
   753     03  DIRCOR-ABD02            PIC X(01).                       RMB0034
   754     03  TELCEL-ABD02            PIC X(01).                       RMB0034
   755     03  E-MAIL-ABD02            PIC X(01).                       RMB0034
   756     03  ENTID-REGULA-ABD02      PIC X(01).                       CAV0036
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  14
* A21.FD)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBS
   757     03  IND-CONTRAT-TARJ-ABD02  PIC X(01).                       CAV0036
   758     03  FILLER-ABD02-2          PIC X(05).                       CAV0036
   759*    03  FILLER-ABD02-2          PIC X(07).                       CAV0036
   760*    03  FILLER-ABD02-2          PIC X(14).                       RMB0034
   761*     03  FILLER-ABD02-2          PIC X(22).                      GJC0033
*  762 COPY ICBCON.001.FD.
   763* ICBCON-FD.0004
   764* ARCHIVO QUE CONTIENE LAS HUELLAS DE CONSULTA, ES DECIR TIPO 1 Y
   765* TIPO 5
   766*******************************************************************
   767* RMB003       * FENA001: PARA LAS CONSULTAS REPETIDAS (MISMO DIA *
   768* R.MARTINEZ.  * SUSCRIPTOR, CLAVE) SE DEJA UN SOLA CONSULTA Y LA *
   769* JULIO 30/2001* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   770*              * NUM-CONS-IND.                                    *
   771*----------------------------------------------------------------**
   772* RMB003       * SCR002: PARA MANEJO DE PREFILTRO SE REDEFINEN    *
   773* R.MARTINEZ.  * CAMPOS.                                          *
   774* AGOS. 30/2002* CANTIDAD SE ACUMULA EN NUEVO CAMPO CONTADOR      *
   775*----------------------------------------------------------------**
   776* GJC0004      * AMPLI1: AMPLIACION DEL ARCHIVO DE CONSULTA DE    *
   777* G.JIMENEZ.   * 50 A 123 POSICIONES, SE AMPLIA CON FILLER DE 50  *
   778* ENE.03/2003  * CARACTERES.                                      *
   779* FAC0004      * INCLUSION DE NUEVOS CAMPOS                       *
   780* ENE.22/2003  *                                                  *
   781*----------------------------------------------------------------**
   782 FD  INDEXADO.
   783*    FILE OF SUCCESSFUL INQUIRIES, FOR BILLING AND SUSPICIOUS
   784*    NUMBER OF CREDIT INQUIRIES
   785 01  REG-INDEX.
   786     03  COD-SUSCRIP-IND         PIC 9(6).
   787     03  FEC-CONSUL-IND          PIC 9(6).
   788     03  LLAVE-INDEX.
   789         05  TIP-ID-IND          PIC 9.
   790         05  NUM-ID-IND          PIC 9(11).
   791         05  CONSECUTIVO-IND     PIC 9(2).
   792*    SCORES 0=score10,1-9= SCORE1-9
   793     03  SCO-PRE-INDEX           PIC 9.
   794     03  CIUDAD-CONS-IND         PIC 9(2).
   795     03  OFICINA-CONS-IND        PIC X(15).
   796     03  NUM-CONS-IND            PIC 99.                           RMB003
   797     03  FILLER-INDEX.
   798         05 PRE-SCORE-INDEX      PIC X VALUE SPACES.
   799         05 PUN-SCORE-INDEX      PIC S9(05) COMP-3.
   800     03  RAZCON-IND              PIC 99.                          GJC0004
   801     03  TIP-SCORE-IND           PIC 9(3).                        FAC0004
   802     03  CLASIFICA-IND           PIC X(2).                        FAC0004
   803     03  CALIFICA-IND            PIC S9(3)V99.                    FAC0004
   804     03  CLAVE-IND               PIC X(5).                        FAC0004
   805     03  CONTADOR-IND            PIC 9(3).                        FAC0004
   806     03  FILLER-1-INDEX          PIC X(50).                       GJC0004
*  807 COPY ICBCHK.FD.
   808* ICBCHK.-FD.v.0009
   809* MAESTRO QUE ALMACENA LAS CUENTAS CORRIENTES Y CUENTAS DE AHORRO
   810* REPORTADAS POR LOS DIFERENTES SUSCRIPTORES
   811*----------------------------------------------------------------*
   812******************************************************************
   813* VHF0005     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   814* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  15
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   815* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   816* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   817* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   818*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   819*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   820*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   821*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   822******************************************************************
   823* FAC0006     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD06 EN*
   824* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD06 PARA INDICAR *
   825*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   826* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD06 QUE *
   827*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   828******************************************************************
   829* CAV0007     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   830* C. VELASCO  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   831* 04/MAY/2009 *          CREDITO.                                *
   832******************************************************************
   833* CAV0008     * NHC002 - SE CAMBIA FECHA DE NOVEDAD ANTERIOR POR *
   834* C. VELASCO  *          FECHA DE ACTUALIZACION DE VALORES       *
   835* 04/ENE/2010 *                                                  *
   836******************************************************************
   837* GJC0009     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   838* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   839* OCTUBRE/2010*          SON MÁS DE 10                           *
   840******************************************************************
   841
   842 FD  MAESTRO-CHECK.
   843*    MASTER FILE OF CHECKING ACCOUNTS, TYPE = 2
   844 01  COMPLETO-ABD06.
   845     03  LLAVE-MAES-CHECK.
   846         05  LLAVE-MAES-CHECK-PRI.
   847             07  TIPO-ID-ABD06     PIC 9.
   848             07  NUM-ID-ABD06      PIC 9(11).
   849         05  LLAVE-MAES-CHECK-ALT.
   850             07  COD-SUS-ABD06     PIC 9(6).
   851             07  COD-CTA-ABD06     PIC 99.
   852             07  NUM-CTA-ABD06     PIC X(18).
   853     03  IND-BLOQUEO-ABD06         PIC 9     COMP-3.
   854     03  FECHA-APERT-ABD06         PIC 9(4)  COMP-3.
   855     03  CALIFIC-ABD06             PIC 9     COMP-3.
   856     03  TIP-CALIFIC-ABD06         PIC 9     COMP-3.
   857     03  NOV-REPORT-ABD06          PIC 99    COMP-3.
   858     03  FEC-NOVEDAD-ABD06         PIC 9(4)  COMP-3.
   859     03  NUM-EMBARGO-ABD06         PIC 99    COMP-3.
   860     03  FEC-ULT-EMB-ABD06         PIC 9(4)  COMP-3.
   861     03  ADJETIVO-ABD06            PIC 9     COMP-3.
   862     03  FEC-ADJETIVO-ABD06        PIC 9(4)  COMP-3.
   863     03  ART15-ABD06               PIC 9     COMP-3.
   864     03  IND-MODIFICACION-ABD06    PIC 9     COMP-3               VHF0005
   865         REDEFINES                 ART15-ABD06.                   VHF0005
   866     03  RECLAMO-ABD06             PIC 9(5)  COMP-3.
   867     03  RECLAMO-ABD06-RR          REDEFINES RECLAMO-ABD06        FAC0005
   868                                   PIC 9(3).                      FAC0005
   869     03  RECLAMO-ABD06-R           REDEFINES RECLAMO-ABD06.       VHF0005
   870         05 IND-RECLAMO-ABD06      PIC 9(01).                     VHF0005
   871         05 REG-LOCK-ABD06         PIC 9(01).                     FAC0006
   872         05 FILLER-RECLAMO-ABD06   PIC 9(01).                     FAC0006
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  16
* 1.FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   873
   874     03  CONSECUTIVO-ABD06         PIC 99    COMP-3.              VMATCH
   875*    03  FILLER-ABD06              PIC X(8).                      AMPLIA
   876     03  OFICINA-ABD06             PIC X(15).                     AMPINF5
   877     03  CIUDAD-ABD06              PIC X(6).                      AMPINF5
   879     03  FEC-NOVANT-ABD06          PIC 9(4) COMP-3.               FAC0004
   880     03  FECHA-ACTUALIZ-VALOR-ABD06  PIC 9(4) COMP-3              CAV0008
   881         REDEFINES FEC-NOVANT-ABD06.                              CAV0008
   882     03  NOVANT-ABD06              PIC 9(2) COMP-3.               FAC0004
   883*    03  FILLER-ABD06              PIC X(4).                      CAV0007
   884     03  IND-SOBREGIRO-ABD06       PIC 9(1).                      CAV0007
   885     03  COD-EST-TITUL-ABD06       PIC 9(1).                      CAV0007
   886     03  CALIFICACION-ABD06        PIC 9(1).                      CAV0007
   887     03  RAZON-BLOQUEO-ABD06       PIC X(1).                      GJC0009
*  888 COPY ICBCRE.FD.
   889* ICBCRE-FD.v.02.0013
   890* MAESTRO OBLIGACIONES DE CARTERA Y TARJETAS DE CREDITO REPORTADAS
   891* POR LOS DIFERENTES SUSCRIPTORES
   892*----------------------------------------------------------------*
   893******************************************************************
   894* VHF0008     * DATCIU - SE REDEFINE  EL CAMPO ART15 CON EL      *
   895* VICTOR HUGO *          NOMBRE IND-MODIFICACION YA QUE SERA     *
   896* FORERO      *          UTILIZADO PARA INDICAR EL ESTADO DE UNA *
   897* MAY.26/2003 *          MODIFICACION A LA CUENTA. TAMBIEN SE    *
   898* F.CUADROS C.*          REDEFINE EL CAMPO RECLAMO PARA UTILIZAR *
   899*             *          SU PRIMER DIGITO IND-RECLAMO COMO       *
   900*             *          INDICADOR DEL ESTADO DE UN RECLAMO A LA *
   901*             *          CUENTA. EL ESPACIO RESTANTE SE DEJA     *
   902*             *          DISPONIBLE PARA OTROS DOS INDICADORES   *
   903******************************************************************
   904* FAC0009     * REGLOC - SE ABRE EL CAMPO FILLER-RECLAMO-ABD07 EN*
   905* F.CUADROS C.*          DOS CAMPOS: REG-LOCK-ABD07 PARA INDICAR *
   906*             *          SI EL REGISTRO ESTA CERRADO POR NOVEDAT *
   907* ENE.31/2006 *          (1-SI 0-NO), Y FILLER-RECLAMO-ABD07 QUE *
   908*             *          SE DEJA DISPONIBLE PARA USO FUTURO      *
   909******************************************************************
   910* JGR0010     * REGVEC - SE REUTILIZAN CAMPOS PARA PODER GRABAR  *
   911* JAIRO GOMEZ.*          LOS VECTORES HISTORICOS DEL TERCERO Y   *
   912*             *          CUARTO AÑO DE HISTORIA CREDITICIA       *
   913* 09/AGO/2007 *                                                  *
   914******************************************************************
   915* GJC0011     * NHC001 - CREACION DE NUEVOS CAMPOS RELACIONADOS  *
   916* G. JIMENEZ  *          CON LA LEY Y CON LA NUEVA HISTORIA DE   *
   917* 09/AGO/2007 *          CREDITO. REDEFINEN LOS CAMPOS CREADOS   *
   918*             *          PARA EL MANEJO DE LOS 4 TRIMESTRES DE   *
   919*             *          ENDEUDAMIENTO                           *
   920******************************************************************
   921* GJC0012     * RZN001 - SE CAMBIA FILLER POR RAZON DE BLOQUEO   *
   922* G. JIMENEZ  *          DEBIDO A QUE LOS TIPOS DE BLOQUEO YA    *
   923* OCTUBRE/2010*          SON MÁS DE 10                           *
   924******************************************************************
   925* CAV0013     * MICROC - SE REDEFINE  CAMPO IND-BLOQUEO-R-ABD07  *
   926* C. VELASCO. *          DE PIC 9 A PIC X PARA ALMACENAR MAS DE  *
   927* 19/SEP/2011.*          10 POSIBLES VALORES PARA TIPO GARANTIA. *
   928******************************************************************
   929 FD  MAESTRO-CREDIT.
   930 01  COMPLETO-ABD07.
   931     03  LLAVE-MAES-CREDIT.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  17
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   932         05  LLAVE-MAES-CREDIT-PRI.
   933             07  TIPO-ID-ABD07     PIC 9.
   934             07  NUM-ID-ABD07      PIC 9(11).
   935         05  LLAVE-MAES-CREDIT-ALT.
   936             07  COD-SUS-ABD07     PIC 9(6).
   937             07  COD-CTA-ABD07     PIC 99.
   938             07  NUM-CTA-ABD07     PIC X(18).
   939             07  NUM-CTA-VEN16-ABD07 REDEFINES NUM-CTA-ABD07.      AMPLIA
   940                 09  NUM-CTA-VEN-ABD07 PIC 9(16).                  AMPLIA
   941                 09  GARANTE-VEN-ABD07 PIC 99.                     AMPLIA
   942     03  IND-BLOQUEO-ABD07         PIC 9     COMP-3.
   943     03  FECHA-APERT-ABD07         PIC 9(4)  COMP-3.
   944     03  FECHA-VENC-ABD07          PIC 9(4)  COMP-3.
   945     03  CUANTIA-ABD07             PIC 9(5)  COMP-3.
   946     03  CALIFIC-ABD07             PIC 9     COMP-3.
   947     03  TIP-CALIFIC-ABD07         PIC 9     COMP-3.
   948     03  NOV-REPORT-ABD07          PIC 99    COMP-3.
   949     03  FEC-NOVEDAD-ABD07         PIC 9(4)  COMP-3.
   950     03  NUM-MORAS30-ABD07         PIC 99    COMP-3.
   951     03  ESTADO-MES-ABD07          PIC 9(12) COMP-3.
   952     03  VECTOR-HIS-1-ABD07        PIC 9(12) COMP-3     *> AÑO 1   JGR0010
   953         REDEFINES                 ESTADO-MES-ABD07.               JGR0010
   954     03  MORA-MAXIMA-ABD07         PIC 9     COMP-3.
   955     03  ADJETIVO1-ABD07           PIC 9     COMP-3.
   956     03  FEC-MEN-ADJ-ABD07         PIC 9(4)  COMP-3.
   957     03  ADJETIVO2-ABD07           PIC 9     COMP-3.
   958     03  FEC-MAY-ADJ-ABD07         PIC 9(4)  COMP-3.
   959     03  ADJETIVO3-ABD07           PIC 9     COMP-3.
   960     03  ART15-ABD07               PIC 9     COMP-3.
   961     03  IND-MODIFICACION-ABD07    PIC 9     COMP-3               VHF0008
   962         REDEFINES                 ART15-ABD07.                   VHF0008
   963     03  RECLAMO-ABD07             PIC 9(5)  COMP-3.
   964     03  RECLAMO-ABD07-RR          REDEFINES RECLAMO-ABD07        FAC0008
   965                                   PIC 9(3).                      FAC0008
   966     03  RECLAMO-ABD07-R           REDEFINES RECLAMO-ABD07.       VHF0008
   967         05 IND-RECLAMO-ABD07      PIC 9(01).                     VHF0008
   968         05 REG-LOCK-ABD07         PIC 9(01).                     FAC0009
   969         05 FILLER-RECLAMO-ABD07   PIC 9(01).                     FAC0009
   970         05 TARJ-ESTADO-PLAST-ABD07    PIC 9(1)  REDEFINES        GJC0011
   971            FILLER-RECLAMO-ABD07.                                 GJC0011
   972         05 REAL-TERMINO-CONTRATO-ABD07 PIC 9(1) *> 1-DEFINIDO    GJC0011
   973            REDEFINES FILLER-RECLAMO-ABD07.      *> 2-INDEF       GJC0011
   974         05 IND-SUBSIDIO-HIPOTEC-ABD07 PIC 9(1)  *> 0-NO          GJC0011
   975            REDEFINES FILLER-RECLAMO-ABD07.      *> 1-SI          GJC0011
   976*    03  IND-BLOQUEO-R-ABD07       PIC 9     COMP-3.              CAV0013
   977     03  IND-BLOQUEO-R-ABD07       PIC X.                         CAV0013
   978     03  TIPO-GAR-DETALLE-ABD07    PIC X   REDEFINES *> TIPO DE   CAV0013
   979         IND-BLOQUEO-R-ABD07.     *> GARANTIA DETALLADO           CAV0013
   980     03  CALIFIC-R-ABD07           PIC 9     COMP-3.
   981     03  TIP-CALIFIC-R-ABD07       PIC 9     COMP-3.
   982     03  IND-MAPA-BITS-VLR-ABD07 REDEFINES TIP-CALIFIC-R-ABD07    FAC0007
   983                                   PIC 9     COMP-3.
   984     03  NOV-REPORT-R-ABD07        PIC 99    COMP-3.
   985     03  FEC-NOVEDAD-R-ABD07       PIC 9(4)  COMP-3.
   986     03  NUM-MORAS30-R-ABD07       PIC 99    COMP-3.
   987     03  MAPA-BITS-VLR-ABD07 REDEFINES NUM-MORAS30-R-ABD07        FAC0007
   988                                   PIC X(02).                     FAC0007
   989     03  ESTADO-MES-R-ABD07        PIC 9(12) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  18
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
   990     03  VECTOR-HIS-3-ABD07        PIC 9(12) COMP-3     *> AÑO 3   JGR0010
   991         REDEFINES                 ESTADO-MES-R-ABD07.             JGR0010
   992     03  MORA-MAXIMA-R-ABD07       PIC 9     COMP-3.
   993     03  VALOR-INICIAL-ABD07       PIC 9(7)  COMP-3.               AMPLIA
   994*     03  CAMPOS-ENDEUDAMIENTO. *> SE ELIMINAN PARA CREAR NUEVOS  GJC0011
   995*                              *> CAMPOS                          GJC0011
   996*     05  VALOR-SALDO-DEUDA-ABD07-R           OCCURS 4 TIMES.     GJC0011
   997*         07  VALOR-SALDO-DEUDA-ABD07   PIC  9(7) COMP-3.         GJC0011
   998*     05  VALOR-DISPONIBLE-ABD07-R            OCCURS 4 TIMES.     GJC0011
   999*         07  VALOR-DISPONIBLE-ABD07    PIC  9(7) COMP-3.         GJC0011
  1000*     05  VALOR-SALDO-MORA-ABD07-R            OCCURS 4 TIMES.     GJC0011
  1001*         07  VALOR-SALDO-MORA-ABD07    PIC  9(7) COMP-3.         GJC0011
  1002*     05  CALIFICACION-ABD07-R                OCCURS 4 TIMES.     GJC0011
  1003*         07  CALIFICACION-ABD07        PIC  9    COMP-3.         GJC0011
  1004     03  NUEVOS-CAMPOS-HISTORIA-CREDITO.                          GJC0011
  1005* CAMPOS DE FECHAS QUE EXISTIAN PERO AHORA SON COMPLETAS          GJC0011
  1006        05  FECHA-APERTURA-ABD07       PIC 9(8)  COMP-3.          GJC0011
  1007        05  FECHA-VENCIMIENTO-ABD07    PIC 9(8)  COMP-3.          GJC0011
  1008        05  FECHA-ADJETIVO1-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1009        05  FECHA-ADJETIVO2-ABD07      PIC 9(8) COMP-3.           GJC0011
  1010        05  FECHA-ADJETIVO3-ABD07      PIC 9(8)  COMP-3.          GJC0011
  1011* DEFINICIONES DE NUEVOS CAMPOS                                   GJC0011
  1012         05  ESTADO-OBLIG-ABD07         PIC 9(2)  COMP-3.         GJC0011
  1013         05  FECHA-ESTADO-OBLIG-ABD07   PIC 9(8)  COMP-3.         GJC0011
  1014         05  FECHA-ESTADO-ORIGEN-ABD07  PIC 9(8)  COMP-3.         GJC0011
  1015         05  FECHA-LIMITE-PAGO-ABD07    PIC 9(8)  COMP-3.         GJC0011
  1016         05  TARJ-FEC-ESTADO-PLAST-ABD07 PIC 9(8) COMP-3.         GJC0011
  1017         05  REAL-FEC-CLAUS-PERM-ABD07  PIC 9(8) COMP-3           GJC0011
  1018             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1019         05  FEC-SUBSIDIO-HIPOTEC-ABD07 PIC 9(8) COMP-3           GJC0011
  1020             REDEFINES TARJ-FEC-ESTADO-PLAST-ABD07.               GJC0011
  1021         05  TARJ-CLASE-ABD07           PIC 9(1)  COMP-3.         GJC0011
  1022         05  TARJ-FRANQUICIA-ABD07      PIC 9(1)  COMP-3.         GJC0011
  1023         05  PROBAB-INCUMP-ABD07        PIC 9(3)  COMP-3.         GJC0011
  1024*        05  FILLER                     PIC 9(1)  COMP-3.         GJC0012
  1025         05  RAZON-BLOQUEO-ABD07        PIC X(1).                 GJC0012
  1026* CONTINUAN LOS CAMPOS QUE YA EXISTIAN ANTES                      GJC0011
  1027     03  VALOR-SALDO-DEUDAM-ABD07   PIC 9(7)  COMP-3.              AMPLIA
  1028     03  VALOR-DISPONIBLEM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1029     03  VALOR-SALDO-MORAM-ABD07    PIC 9(7)  COMP-3.              AMPLIA
  1030     03  CALIFICACIONM-ABD07        PIC 9     COMP-3.              AMPLIA
  1031     03  TIPO-MONEDA-ABD07          PIC 9     COMP-3.              AMPLIA
  1032     03  TIPO-OBLIGACION-ABD07      PIC 9     COMP-3.              AMPLIA
  1033     03  TIPO-GARANTIA-ABD07        PIC 9     COMP-3.              AMPLIA
  1034     03  CUOTAS-CANCELADAS-ABD07    PIC 9(3)  COMP-3.              AMPLIA
  1035     03  FECHA-DE-PAGO-ABD07        PIC 9(8)  COMP-3.              AMPLIA
  1036     03  TOTAL-CUOTAS-ABD07         PIC 9(3)  COMP-3.              AMPLIA
  1037     03  CUOTAS-EN-MORA-ABD07       PIC 9(3)  COMP-3.              AMPLIA
  1038     03  SITUACION-ABD07            PIC X.                         AMPLIA
  1039     03  FECHA-ACT-END-ABD07        PIC 9(6)  COMP-3.              AMPLIA
  1040     03  CAMPOS-NUEVOS-NHC-ABD07 REDEFINES FECHA-ACT-END-ABD07.   GJC0011
  1041         05  ESTADO-ORIGEN-ABD07        PIC 9(1)  COMP-3.         GJC0011
  1042         05  CAMPOS-TARJETA-ABD07.                                GJC0011
  1043             07 TARJ-MARCA-PRIV-ABD07   PIC 9(3)  COMP-3.         GJC0011
  1044             07 REAL-CLAUS-PERM-ABD07   PIC 9(3) COMP-3           GJC0011
  1045                REDEFINES TARJ-MARCA-PRIV-ABD07. *> MESES CLAUSULAGJC0011
  1046         05 SITUACION-TITULAR-ABD07 PIC 9(1)  COMP-3.*> EJ.LIQ    GJC0012
  1047     03  CONSECUTIVO-ABD07          PIC 99    COMP-3.              VMATCH
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  19
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICBC
  1048     03  FECHA-MORA-MAXIMA-ABD07    PIC 9(6)  COMP-3.              AMPLIA
  1049     03  FECHA-ACTUALIZ-VALOR-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1050*    03  FECHA-CARTERA-CASTIG-ABD07 PIC 9(6)  COMP-3.              AMPLIA
  1051     03  FECHA-SITUACION-ABD07      PIC 9(6)  COMP-3.              AMPINF7
  1052     03  VECTOR-2-ABD07             PIC 9(12) COMP-3.              AMPLIA
  1053     03  VECTOR-HIS-2-ABD07         PIC 9(12) COMP-3               JGR0010
  1054         REDEFINES                  VECTOR-2-ABD07.     *> AÑO 2   JGR0010
  1055     03  PERIODICIDAD-PAGO-ABD07    PIC 9     COMP-3.              AMPINF5
  1056     03  GARANTE-ABD07              PIC 9(2)  COMP-3.              AMPINF5
  1057     03  FORMA-PAGO-TOTAL-ABD07     PIC 9     COMP-3.              AMPINF5
  1058     03  MOROSIDAD-ABD07            PIC 9(3)  COMP-3.              AMPINF5
  1059     03  NOV-REPORT2-ABD07          PIC 9(2).                      AMPINF7
  1060     03  VECTOR-2-R-ABD07           PIC 9(12) COMP-3.              GJC0002
  1061     03  VECTOR-HIS-4-ABD07         PIC 9(12) COMP-3    *> AÑO 4   JGR0010
  1062         REDEFINES                  VECTOR-2-R-ABD07.              JGR0010
  1063
* 1064 COPY BDIEMSUP.FD.
  1065* BDIEMSUP-FD.v.0005
  1066*-------------------------------------------
  1067*  MAESTRO CON INFORMACION SUPERINTENDENCIA
  1068*-------------------------------------------
  1069******************************************************************
  1070* GJC0002   * MICROC: SE ADICIONA VARIABLE DE SUBTIPO DE DEUDA QUE
  1071* G.JIMENEZ * PERMITE IDENTIFICAR LOS MICROCREDITOS Y LAS
  1072* JUN./2003 * FIDUCIAS.
  1073******************************************************************
  1074* RMB0003   * DRP001: SE ADICIONA CAMPO PARA CALCULAR CAMBIO EN
  1075* R.MARTINEZ* EL REGISTRO Y ACTUALIZAR EL DRP
  1076* DIC./2007 *
  1077******************************************************************
  1078* VHF0004     * GARANT - SE MODIFICA FILLER PARA GUARDAR         *
  1079* VICTOR HUGO *          INFORMACION DE GARANTIAS                *
  1080* FORERO      *                                                  *
  1081* SEP.24/2009 *                                                  *
  1082******************************************************************
  1083* LAG0005     * TIPGAR - BDIEMSUP-TIPGAR SE DEJA ALFANUMERICO    *
  1084* VICTOR HUGO *          PARA DEJAR "A" CUANDO VEGA 10, "B"      *
  1085* FORERO      *          CUANDA VENGA 11 Y "C" CUANDO VENGA 12   *
  1086* SEP.24/2009 *                                                  *
  1087******************************************************************
  1088 FD BDIEMSUP.
  1089 01 BDIEMSUP-REGISTRO.
  1090    03 BDIEMSUP-LLAVE.
  1091       05 BDIEMSUP-TIP-ID           PIC 9(1).
  1092       05 BDIEMSUP-NUM-ID           PIC 9(11).
  1093       05 BDIEMSUP-FECHA            PIC 9(8).
  1094       05 BDIEMSUP-TIP-ENTID        PIC 9(2).
  1095       05 BDIEMSUP-COD-ENTID        PIC 9(6).
  1096       05 BDIEMSUP-MONEDA           PIC X(1).
  1097       05 BDIEMSUP-TIP-DEUDA        PIC X(1).
  1098       05 BDIEMSUP-CALIFICA         PIC X(1).
  1099       05 BDIEMSUP-GARANTIA         PIC X(1).
  1100    03 BDIEMSUP-ENCABEZADO.
  1101       05 BDIEMSUP-DESCRIP          PIC X(45).
  1102       05 BDIEMSUP-CIIU             PIC 9(4).
  1103       05 BDIEMSUP-FEC-APERT        PIC 9(8).
  1104       05 BDIEMSUP-SUBTIPO-DEUDA    PIC X.                        GJC0002
  1105       05 FILLER                    PIC X(6).                     GJC0002
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  20
* ).FD)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDIE
  1106    03 BDIEMSUP-ITEMS REDEFINES BDIEMSUP-ENCABEZADO.
  1107       05 BDIEMSUP-VALOR            PIC S9(14)  COMP-3.
  1108       05 BDIEMSUP-INTERES          PIC S9(14)  COMP-3.
  1109       05 BDIEMSUP-CONTING          PIC S9(14)  COMP-3.
  1110       05 BDIEMSUP-CANTIDAD         PIC 9(3)    COMP-3.
  1111       05 BDIEMSUP-IND-BLOQ         PIC 9(1)    COMP-3.
  1112       05 BDIEMSUP-ART-15           PIC 9(2)    COMP-3.
  1113       05 BDIEMSUP-FEC-ART-15       PIC 9(8)    COMP-3.
  1114       05 BDIEMSUP-FEC-ACTUALIZ     PIC 9(8)    COMP-3.
  1115       05 BDIEMSUP-ART-15-CTI       PIC 9(2)    COMP-3.
  1116       05 BDIEMSUP-FEC-ART-15-CTI   PIC 9(8)    COMP-3.
  1117       05 BDIEMSUP-NUM-RECLAMO      PIC 9(5)    COMP-3.
  1118       05 FILLER-X                  PIC X(14).                    VHF0004
  1119       05 BDIEMSUP-GAR              REDEFINES FILLER-X.           VHF0004
  1120          07 BDIEMSUP-VLRGAR        PIC S9(14)  COMP-3.           VHF0004
  1121          07 BDIEMSUP-TIPGAR        PIC X(1).                     LAG0005
  1122          07 BDIEMSUP-FECGAR        PIC S9(8)   COMP-3.           VHF0004
  1123       05 BDIEMSUP-DRP              PIC X(01).                    VHF0004
* 1124 COPY BDIEENTI.FD.
  1125* BDIEENTI-FD.v.0002
  1126******************************************************************
  1127* JGR0002     * NITENT - SE COMPARTE EL CAMPO NOMBRE DE LA       *
  1128* JAIRO GOMEZ.*          ENTIDAD, PARA PORDER GRABAR EL NUMERO   *
  1129*             *          DE NIT DE LA ENTIDAD REPORTANTE         *
  1130* 09/ENE/2008 *                                                  *
  1131******************************************************************
  1132********************************************
  1133*  MAESTRO DE ENTIDADES SUPERINTENDENCIA
  1134********************************************
  1135
  1136 FD BDIEENTI.
  1137 01 BDIEENTI-REGISTRO.
  1138    03 BDIEENTI-LLAVE.
  1139       05 BDIEENTI-TIP-ENTID        PIC 9(2).
  1140       05 BDIEENTI-COD-ENTID        PIC 9(6).
  1141    03 BDIEENTI-NOM-ENTID.
  1142       05 BDIEENTI-NOMBRE           PIC X(29).                     JGR0002
  1143       05 BDIEENTI-NIT-ENTID        PIC 9(11).                     JGR0002
* 1144 COPY BDACUE.FD.
  1146* BDACUE.v.01.001
  1147*ARCHIVO TIPOS DE CUENTA VS. NOVEDADES Y ADJETIVOS VALIDOS
  1148*----------------------------------------------------------------*
  1149*-TABLA CON 10 OCURRENCIAS QUE CORRESPONDEN A CAMPOS DEL MAESTRO
  1150* RESUMIDO CON RANGO DE VALORES INICIAL Y FINAL PARA VALIDACION
  1151* TAB-RANGOS: EL ORDEN DE LOS CAMPOS ALMACENADOS ES CUOTA-MES,
  1152* VALOR-INICIAL, SALDO-DEUDA, SALDO-MORA, VALOR-DISPONIBLE, CUOTAS-
  1153* CANCELADAS, CUOTAS-EN-MORA, 3 OCURRENCIAS PARA USO FUTURO
  1154* IND-SECTOR-BDACUE: F-FINANCIERO, C-COOPERATIVO, R-REAL
  1155*-TABLA CON 15 INDICADORES DE LOS CAMPOS CONTENIDOS EN EL MAPA DE
  1156* BITS; VALOR=0 SI NO APLICA VALOR=1 SI APLICA AL TIPO DE CUENTA.
  1157*-CAMPOS CONTROL0X USADOS COMO DELIMITADORES.
  1158*----------------------------------------------------------------*
  1159* GJC0002    * NEWACT- PARA NUEVA ACTUALIZACION LOS ADJETIVOS
  1160* G JIMENEZ  *         VAN DE 1 A 9. SE DEFINE NUEVA TABLA DE
  1161* 21-07-2009 *         ADJETIVOS VALIDOS
  1162*****************************************************************
  1163 FD  BDACUE.
  1164 01  REG-BDACUE.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  21
* FD)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/BDAC
  1165     03  TIP-CTA-BDACUE               PIC 9(2).
  1166     03  DES-CORTA-BDACUE             PIC X(3).
  1167     03  DES-LARGA-BDACUE             PIC X(21).
  1168     03  DES-COMPLETA-BDACUE          PIC X(30).
  1169     03  CONTROL01-BDACUE             PIC X(01).
  1170     03  IND-NOV-BDACUE OCCURS 35     PIC 9(1).
  1171     03  CONTROL02-BDACUE             PIC X(01).
  1172     03  IND-ADJ-BDACUE OCCURS 31     PIC 9(2).
  1173     03  CONTROL03-BDACUE             PIC X(01).
  1174     03  IND-SECTOR-BDACUE            PIC X(1).
  1175     03  CONTROL04-BDACUE             PIC X(01).
  1176     03  TAB-RANGOS-BDACUE OCCURS 10.
  1177         04 VAL-INI-BDACUE            PIC 9(10).
  1178         04 VAL-FIN-BDACUE            PIC 9(10).
  1179     03  CONTROL05-BDACUE             PIC X(01).
  1180     03  TAB-IND-VAL-BDACUE.
  1181         04 VEC-IND-VAL-BDACUE OCCURS 15 TIMES PIC 9.
  1182     03  CONTROL06-BDACUE             PIC X(01).
  1183     03  IND-ADJ-NWACT-BDACUE OCCURS 9 TIMES                      GJC0002
  1184                                      PIC 9.                      GJC0002
  1185     03  CONTROL07-BDACUE             PIC X(1).                   GJC0002
  1186     03  FILLER-BDACUE                PIC X(40).                  GJC0002
  1187
  1188*----------------------------------*
  1189 WORKING-STORAGE SECTION.
  1190*----------------------------------*
  1191 01  W-REG-SALIDA.
  1192     03 W-TIPO-ID                    PIC 9(01).
  1193     03 FILLER                       PIC X(01) VALUE ";".
  1194     03 W-NUME-ID                    PIC 9(11).
  1195     03 FILLER                       PIC X(01) VALUE ";".
  1196     03 W-NOMCLI                     PIC X(45).
  1197     03 FILLER                       PIC X(01) VALUE ";".
  1198     03 W-CALENDPERANT               PIC X(02).
  1199     03 FILLER                       PIC X(01) VALUE ";".
  1200     03 W-CALENDPERACT               PIC X(02).
  1201     03 FILLER                       PIC X(01) VALUE ";".
  1202     03 W-ACIERTA                    PIC 9(05).
  1203     03 FILLER                       PIC X(01) VALUE ";".
  1204     03 W-NUM-CTA                    PIC X(18).
  1205     03 FILLER                       PIC X(01) VALUE ";".
  1206     03 W-DESPRODU                   PIC X(35).
  1207     03 FILLER                       PIC X(01) VALUE ";".
  1208     03 W-SUSCRIPTOTOR               PIC X(40).
  1209     03 FILLER                       PIC X(01) VALUE ";".
  1210     03 W-FECHA-INICIAL              PIC X(06).
  1211     03 FILLER                       PIC X(01) VALUE ";".
  1212     03 W-FECHA-NOVEDAD              PIC X(06).
  1213     03 FILLER                       PIC X(01) VALUE ";".
  1214     03 W-NOVEDAD                    PIC X(10).
  1215     03 FILLER                       PIC X(01) VALUE ";".
  1216     03 W-VECTOR-1                   PIC X(48).
  1217     03 FILLER                       PIC X(01) VALUE ";".
  1218     03 W-VALOR-INI                  PIC 9(07).
  1219     03 FILLER                       PIC X(01) VALUE ";".
  1220     03 W-SALDO-CARTERA              PIC 9(07).
  1221     03 FILLER                       PIC X(01) VALUE ";".
  1222     03 W-SALDO-MORA                 PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  22
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1223     03 FILLER                       PIC X(01) VALUE ";".
  1224     03 W-VALOR-CUOTA                PIC 9(07).
  1225     03 FILLER                       PIC X(01) VALUE ";".
  1226     03 W-TIPOCLI                    PIC X(01).
  1227     03 FILLER                       PIC X(01) VALUE ";".
  1228     03 W-FECHA-VENCIM               PIC X(06).
  1229
  1230 01  W-VARIABLES.
  1231     03 W-VEC-APROBACI.
  1232        05 W-CC-SN            PIC X VALUE SPACES.                      **>
  1233        05 W-DR-SN            PIC X VALUE SPACES.
  1234        05 W-COBRA-SN         PIC X VALUE SPACES.
  1235        05 W-CALI-SN          PIC X VALUE SPACES.
  1236     03 FILLER  REDEFINES W-VEC-APROBACI.
  1237        05 W-VEC-APROBACI-X   PIC X(04).
  1238*
  1239     03 RELLENO                     PIC X(48).
  1240     03 FECHA-AUX                   PIC 9(04).
  1241     03 II                          PIC 9(04).
  1242     03 LL                          PIC 9(04).
  1243     03 TOPE-V                      PIC S9999     VALUE  ZEROS.
  1244     03 W-MESES-NOV                 PIC 9(04)     VALUE  ZEROS.
  1245     03 W-CREDITOS-ACTV             PIC 9(04)     VALUE  ZEROS.
  1246     03 W-NUM-OBLIG-CAB             PIC 9(04)     VALUE  ZEROS.
  1247     03 W-TOT-INICIAL-CAB           PIC 9(15)     VALUE  ZEROS.
  1248     03 W-TOT-SALDOS-CAB            PIC 9(15)     VALUE  ZEROS.
  1249     03 W-TOT-CUOTAS-CAB            PIC 9(11)     VALUE  ZEROS.
  1250     03 W-TOT-MORA-CAB              PIC 9(11)     VALUE  ZEROS.
  1251     03 W-NUM-OBLIG-CAV             PIC 9(04)     VALUE  ZEROS.
  1252     03 W-TOT-INICIAL-CAV           PIC 9(15)     VALUE  ZEROS.
  1253     03 W-TOT-SALDOS-CAV            PIC 9(15)     VALUE  ZEROS.
  1254     03 W-TOT-CUOTAS-CAV            PIC 9(11)     VALUE  ZEROS.
  1255     03 W-TOT-MORA-CAV              PIC 9(11)     VALUE  ZEROS.
  1256     03 W-NUM-OBLIG-OTR             PIC 9(04)     VALUE  ZEROS.
  1257     03 W-TOT-INICIAL-OTR           PIC 9(15)     VALUE  ZEROS.
  1258     03 W-TOT-SALDOS-OTR            PIC 9(15)     VALUE  ZEROS.
  1259     03 W-TOT-CUOTAS-OTR            PIC 9(11)     VALUE  ZEROS.
  1260     03 W-TOT-MORA-OTR              PIC 9(11)     VALUE  ZEROS.
  1261     03 W-TOT-NUM-TDC               PIC 9(04)     VALUE  ZEROS.
  1262     03 W-TOT-CUPOS-TDC             PIC 9(15)     VALUE  ZEROS.
  1263     03 W-TOT-SALDO-TDC             PIC 9(15)     VALUE  ZEROS.
  1264     03 W-SAL-CUPOS-TDC             PIC 9(11)     VALUE  ZEROS.
  1265     03 W-UTLIZACION-TDC            PIC 9(3)V9999 VALUE  ZEROS.
  1266     03 W-TOT-CUOTAS-TDC            PIC 9(11)     VALUE  ZEROS.
  1267     03 W-TOT-MORA-TDC              PIC 9(11)     VALUE  ZEROS.
  1268     03 W-NRO-RANGO-0               PIC 9(03)     VALUE  ZEROS.
  1269     03 W-NRO-RANGO-1               PIC 9(03)     VALUE  ZEROS.
  1270     03 W-NRO-RANGO-2               PIC 9(03)     VALUE  ZEROS.
  1271     03 W-NRO-RANGO-3               PIC 9(03)     VALUE  ZEROS.
  1272     03 W-NRO-RANGO-4               PIC 9(03)     VALUE  ZEROS.
  1273     03 W-NRO-RANGO-5               PIC 9(03)     VALUE  ZEROS.
  1274     03 W-NRO-RANGO-6               PIC 9(03)     VALUE  ZEROS.
  1275     03 W-FEC-MENOR-TDC.
  1276        05 W-ANO-MEN-TDC            PIC 9(04)     VALUE  ZEROS.
  1277        05 W-MES-MEN-TDC            PIC 9(02)     VALUE  ZEROS.
  1278     03 W-FEC-APERTURA.
  1279        05 W-ANO-APERTURA           PIC 9(04)     VALUE  ZEROS.
  1280        05 W-MES-APERTURA           PIC 9(02)     VALUE  ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  23
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1281     03 W-FEC-NOVEDAD.
  1282        05 W-ANO-NOV                PIC 9(04)     VALUE  ZEROS.
  1283        05 W-MES-NOV                PIC 9(02)     VALUE  ZEROS.
  1284     03 W-NUM-OBLIG-REAL            PIC 9(04)     VALUE  ZEROS.
  1285     03 W-TOT-INICIAL-REAL          PIC 9(15)     VALUE  ZEROS.
  1286     03 W-TOT-SALDOS-REAL           PIC 9(15)     VALUE  ZEROS.
  1287     03 W-TOT-CUOTAS-REAL           PIC 9(11)     VALUE  ZEROS.
  1288     03 W-TOT-MORA-REAL             PIC 9(11)     VALUE  ZEROS.
  1289     03 W-NUM-OBLIG-TELE            PIC 9(04)     VALUE  ZEROS.
  1290     03 W-TOT-CUOTAS-TELE           PIC 9(11)     VALUE  ZEROS.
  1291     03 W-TOT-MORA-TELE             PIC 9(11)     VALUE  ZEROS.
  1292     03 W-NUM-OBLIG-COOP            PIC 9(04)     VALUE  ZEROS.
  1293     03 W-TOT-INICIAL-COOP          PIC 9(15)     VALUE  ZEROS.
  1294     03 W-TOT-SALDOS-COOP           PIC 9(15)     VALUE  ZEROS.
  1295     03 W-TOT-CUOTAS-COOP           PIC 9(11)     VALUE  ZEROS.
  1296     03 W-TOT-MORA-COOP             PIC 9(11)     VALUE  ZEROS.
  1297     03 W-NUM-OBLIG-CODEU           PIC 9(04)     VALUE  ZEROS.
  1298     03 W-TOT-SALDOS-CODEU          PIC 9(15)     VALUE  ZEROS.
  1299     03 W-TOT-CUOTAS-CODEU          PIC 9(11)     VALUE  ZEROS.
  1300     03 W-TOT-MORA-CODEU            PIC 9(11)     VALUE  ZEROS.
  1301     03 W-CREDITOS-ALDIA            PIC 9(03)     VALUE  ZEROS.
  1302     03 W-MORAS-30-ACT              PIC 9(03)     VALUE  ZEROS.
  1303     03 W-MORAS-60-ACT              PIC 9(03)     VALUE  ZEROS.
  1304     03 W-MORAS-90-ACT              PIC 9(03)     VALUE  ZEROS.
  1305     03 W-MORAS-120-ACT             PIC 9(03) VALUE ZEROS.
  1306     03 W-CAR-CASTIGA               PIC 9(03) VALUE ZEROS.
  1307     03 W-DUD-RECAUDO               PIC 9(03) VALUE ZEROS.
  1308     03 W-CUENTAS-COBRADOR          PIC 9(03) VALUE ZEROS.
  1309     03 W-MORAS-30-HIS              PIC 9(03) VALUE ZEROS.
  1310     03 W-MORAS-60-HIS              PIC 9(03) VALUE ZEROS.
  1311     03 W-MORAS-90-HIS              PIC 9(03) VALUE ZEROS.
  1312     03 W-MORAS-120-HIS             PIC 9(03) VALUE ZEROS.
  1313     03 W-CANC-MMANEJO              PIC 9(03) VALUE ZEROS.
  1314     03 W-CAR-RECUPERADA            PIC 9(03) VALUE ZEROS.
  1315     03 W-MORA-MAX-TDC              PIC 9(03) VALUE ZEROS.
  1316     03 W-MORA-MAX-CAB              PIC 9(03) VALUE ZEROS.
  1317     03 W-MORA-MAX-COOP             PIC 9(03) VALUE ZEROS.
  1318     03 W-MORA-MAX-CAV              PIC 9(03) VALUE ZEROS.
  1319     03 W-CTAS-AHORROS              PIC 9(03) VALUE ZEROS.
  1320     03 W-CTES-CORRIENTES           PIC 9(03) VALUE ZEROS.
  1321     03 W-CTES-EMBARGADAS           PIC 9(03) VALUE ZEROS.
  1322     03 W-CTES-MAL-MANEJO           PIC 9(03) VALUE ZEROS.
  1323     03 W-CTES-SALDADAS             PIC 9(03) VALUE ZEROS.
  1324     03 W-TOTAL-CONSULTAS           PIC 9(03) VALUE ZEROS.
  1325     03 W-ALDIA-FINA                PIC 9(03) VALUE ZEROS.
  1326     03 W-ALDIA-REAL                PIC 9(03) VALUE ZEROS.
  1327     03 W-ALDIA-COOP                PIC 9(03) VALUE ZEROS.
  1328     03 W-ALDIA-TELE                PIC 9(03) VALUE ZEROS.
  1329     03 W-MORAS-FINA                PIC 9(03) VALUE ZEROS.
  1330     03 W-MORAS-REAL                PIC 9(03) VALUE ZEROS.
  1331     03 W-MORAS-COOP                PIC 9(03) VALUE ZEROS.
  1332     03 W-MORAS-TELE                PIC 9(03) VALUE ZEROS.
  1333     03 W-CC-DR-FINA                PIC 9(03) VALUE ZEROS.
  1334     03 W-CC-DR-REAL                PIC 9(03) VALUE ZEROS.
  1335     03 W-CC-DR-COOP                PIC 9(03) VALUE ZEROS.
  1336     03 W-CC-DR-TELE                PIC 9(03) VALUE ZEROS.
  1337     03 W-EDAD                      PIC 9(03) VALUE ZEROS.
  1338     03 FIN-CHECK                   PIC 9(01) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  24
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1339     03 SALIR-END                   PIC 9(01) VALUE ZEROS.
  1340     03 IND-E                       PIC 9(03) VALUE ZEROS.
  1341     03 F                           PIC 9(01) VALUE ZEROS.
  1342     03 J                           PIC 9(04) VALUE ZEROS.
  1343
  1344     03 W-ENDEUDA                   PIC X(01) VALUE SPACES.
  1345     03 IND-J                       PIC 9(02) VALUE ZEROS.
  1346     03 SW-CODEUDOR                 PIC 9(01) VALUE ZEROS.
  1347     03 TOPE-IND                    PIC 9(03) VALUE ZEROS.
  1348     03 SW-FECHA-LOW                PIC 9(01) VALUE ZEROS.
  1349     03 SW-END                      PIC 9(01) VALUE ZEROS.
  1350     03 FEC-MENOR-TDC               PIC 9(06) VALUE ZEROS.
  1351     03 EVALUA-FINAL                PIC 9(01) VALUE ZEROS.
  1352     03 CONT-LECTURA                PIC 9(03) VALUE ZEROS.
  1353     03 EVALUA-CREDITO              PIC 9(01) VALUE ZEROS.
  1354     03 EVALUA-ENDEUDA              PIC 9(01) VALUE ZEROS.
  1355     03 EVALUA-CTA-CTE              PIC 9(01) VALUE ZEROS.
  1356     03 W-EDAD-CEDULA               PIC 9(03) VALUE ZEROS.
  1357     03 W-FEC-EXPE                  PIC 9(08) VALUE ZEROS.
  1358     03 W-FEC-EXPE-R REDEFINES W-FEC-EXPE.
  1359        05 W-ANO-EXPE               PIC 9(04).
  1360        05 W-MES-EXPE               PIC 9(02).
  1361        05 W-DIA-EXPE               PIC 9(02).
  1362     03 W-ACU-MMAX-TDC              PIC 9(03) VALUE ZEROS.
  1363     03 W-ACU-MMAX-CAB              PIC 9(03) VALUE ZEROS.
  1364     03 W-ACU-MMAX-COOP             PIC 9(03) VALUE ZEROS.
  1365     03 W-ACU-MMAX-CAV              PIC 9(03) VALUE ZEROS.
  1366     03 TEM-NRO-CTA.
  1367        05 TEM-NRO-CTA-C16          PIC X(16) VALUE ZEROS.
  1368        05 TEM-NRO-CTA-C17          PIC X(01) VALUE ZEROS.
  1369        05 TEM-NRO-CTA-C18          PIC X(01) VALUE ZEROS.
  1370     03 W-SUSCRIPTOR.
  1371        05 W-CODIGO-TIPOCTA         PIC 9(02).
  1372        05 W-CODIGO-RESTCTA         PIC 9(04).
  1373     03 W-TABLA-END-MAYOR.
  1374        05 W-TRIMESTRE-END  OCCURS   3 TIMES.
  1375           07 W-FECHA-END           PIC 9(08).
  1376           07 W-MAYOR-END           PIC X(01).
  1377     03 W-TABLA-SUS-CONSU.
  1378        05 W-SUS-CONSU      OCCURS  50 TIMES PIC 9(06).
  1379     03 W-FECHA-AUX                 PIC  9(04).
  1380     03 W-FECHA-AUX-R REDEFINES W-FECHA-AUX.
  1381        05 W-MES-AUX                PIC  9(02).
  1382        05 W-ANO-AUX                PIC  9(02).
  1383     03 W-FECHA-AUX1              PIC 9(06) VALUE ZEROS.
  1384     03 W-FECHA-AUX1-R REDEFINES W-FECHA-AUX1.
  1385        05 W-MES-AUX1             PIC 9(02).
  1386        05 W-ANO-AUX1             PIC 9(04).
  1387     03 W-FECHA-OK                PIC 9(06) VALUE ZEROS.
  1388     03 W-FECHA-OK-R REDEFINES W-FECHA-OK.
  1389        05 W-SLGANO-OK            PIC 9(04).
  1390        05 W-SLGANO-OK-R REDEFINES W-SLGANO-OK.
  1391           07 W-SGL-OK            PIC 9(02).
  1392           07 W-ANO-OK            PIC 9(02).
  1393        05 W-MES-OK               PIC 9(02).
  1394     03 W-FECHA-FINAL             PIC 9(06) VALUE ZEROS.
  1395     03 W-FECHA-APERTURA          PIC 9(06) VALUE ZEROS.
  1396
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  25
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1397*-------------------------------------------------------------*
  1398  01 FECHAS-AAAAMM.
  1399    02 FECHA-TAG                   PIC 9(6).
  1400    02 FILLER REDEFINES FECHA-TAG.
  1401       03 SIG-ANO-TAG              PIC 9(4).
  1402       03 FILLER REDEFINES SIG-ANO-TAG.
  1403          04 SIG-TAG               PIC 9(2).
  1404          04 ANO-TAG               PIC 9(2).
  1405       03 MES-TAG                  PIC 9(2).
  1406    02 FECHA-NOVEDAD07             PIC 9(6).
  1407    02 FILLER REDEFINES FECHA-NOVEDAD07.
  1408       03 SIG-ANO-NOV              PIC 9(4).
  1409       03 FILLER REDEFINES SIG-ANO-NOV.
  1410          04 SIG-NOV               PIC 9(2).
  1411          04 ANO-NOV               PIC 9(2).
  1412       03 MES-NOV                  PIC 9(2).
  1413    02 FECHA-APERTURA07            PIC 9(6).
  1414    02 FILLER REDEFINES FECHA-APERTURA07.
  1415       03 SIG-ANO-APE              PIC 9(4).
  1416       03 FILLER REDEFINES SIG-ANO-APE.
  1417          04 SIG-APE               PIC 9(2).
  1418          04 ANO-APE               PIC 9(2).
  1419       03 MES-APE                  PIC 9(2).
  1420    02 FECHA-VENCIMIENTO07         PIC 9(6).
  1421    02 FILLER REDEFINES FECHA-VENCIMIENTO07.
  1422       03 SIG-ANO-VEN              PIC 9(4).
  1423       03 FILLER REDEFINES SIG-ANO-VEN.
  1424          04 SIG-VEN               PIC 9(2).
  1425          04 ANO-VEN               PIC 9(2).
  1426       03 MES-VEN                  PIC 9(2).
  1427   02 FECHA-INGRESO               PIC 9(6).
  1428    02 FILLER REDEFINES FECHA-INGRESO.
  1429       03 SIG-ANO-ING              PIC 9(4).
  1430       03 FILLER REDEFINES SIG-ANO-ING.
  1431          04 SIG-ING               PIC 9(2).
  1432          04 ANO-ING               PIC 9(2).
  1433       03 MES-ING                  PIC 9(2).
  1434 01  FECHA-SITMMAAAA-ORI     PIC 9(6).
  1435 01  FILLER REDEFINES FECHA-SITMMAAAA-ORI.
  1436     03 FECHA-SITMM-ORI      PIC 9(2).
  1437     03 FECHA-SITAAAA-ORI    PIC 9(4).
  1438 01  FECHA-SITAAAAMM         PIC 9(6).
  1439 01  FILLER REDEFINES FECHA-SITAAAAMM.
  1440     03 FECHA-SITAAAA        PIC 9(4).
  1441     03 FECHA-SITMM          PIC 9(2).
  1442 01  FECHA-VALAAAAMM         PIC 9(6).
  1443 01  FILLER REDEFINES FECHA-VALAAAAMM.
  1444     03 FECHA-VALAAAA        PIC 9(4).
  1445     03 FECHA-VALMM          PIC 9(2).
  1446*---------------------------------------------------------------*
  1447 01  W-FECHA-MILENIO.
  1448     03 W-FMILENIO-SIGLO            PIC  9(02).
  1449     03 W-FMILENIO-ANIO             PIC  9(02).
  1450     03 W-FMILENIO-MES              PIC  9(02).
  1451*----------------------------------------------------------------*
  1452 01  W-CONSTANTES.
  1453     03 SW-READ-INC                 PIC 9(01) VALUE ZEROS.
  1454     03 W-IND                       PIC 9(02) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  26
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1455     03 LEIDOS                      PIC 9(08) VALUE ZEROS.
  1456     03 GRABADOS                    PIC 9(08) VALUE ZEROS.
  1457     03 END-RUN                     PIC X(01) VALUE " ".
  1458     03 W-STATUS-ENT                PIC 9(02) VALUE ZEROS.
  1459     03 W-STATUS-INC                PIC 9(02) VALUE ZEROS.
  1460*
  1461     03 W-RESET-LEIDOS              PIC 9(09) VALUE 9.
  1462     03 W-LEIDOS                    PIC 9(09) VALUE ZEROS.
  1463     03 W-LEIDOS-RED REDEFINES W-LEIDOS.
  1464        05 FILLER                   PIC 9(06).
  1465        05 CEROS                    PIC 9(03).
  1466     03 W-GRABADOS                  PIC 9(09) VALUE ZEROS.
  1467     03 W-SOLO-CODEUDORES           PIC 9(09) VALUE ZEROS.
  1468     03 W-SOLO-COOPERATIVAS         PIC 9(09) VALUE ZEROS.
  1469     03 W-SOLO-CERRADOS             PIC 9(09) VALUE ZEROS.
  1470     03 W-MORA-TOT-SEC-FINA         PIC 9(09) VALUE ZEROS.
  1471     03 W-MORA-TOT-SEC-REAL         PIC 9(09) VALUE ZEROS.
  1472     03 W-MORA-TOT-REAL-FINA        PIC 9(09) VALUE ZEROS.
  1473
  1474     03 W-FECHA-BASE                PIC 9(06) VALUE ZEROS.
  1475     03 W-OPCION                    PIC X(01) VALUE SPACES.
  1476     03 W-VECTOR-L                  PIC 9(02) VALUE 12.
  1477     03 END-RUN                     PIC X(01) VALUE SPACES.
  1478     03 W-CC                        PIC 9(05) VALUE ZEROS.
  1479     03 W-DR                        PIC 9(05) VALUE ZEROS.
  1480     03 W-COBRA                     PIC 9(05) VALUE ZEROS.
  1481     03 W-CALI                      PIC X(01) VALUE ZEROS.
  1482
  1483*------------------------------------------------------------*
  1484*     AREA WORK ACUMULADORES
  1485*------------------------------------------------------------*
  1486 01  W-ACUMULADORES-ESTA.
  1487     03 W-EDITOR-CON                PIC Z,ZZZ,ZZ9.
  1488     03 W-EDITOR-SIN                PIC Z,ZZZ,ZZ9.
  1489     03 W-EDITOR-INC                PIC Z,ZZZ,ZZ9.
  1490     03 W-EDITOR-TOT                PIC Z,ZZZ,ZZ9.
  1491     03 W-CON-INFORMACION           PIC 9(07) VALUE ZEROS.
  1492     03 W-SIN-INFORMACION           PIC 9(07) VALUE ZEROS.
  1493     03 W-INCONSISTENCIAS           PIC 9(07) VALUE ZEROS.
  1494*----------------------------------------------------------------*
  1495*     VARIABLES DEL MANEJO DE BDACUE                             *
  1496*----------------------------------------------------------------*
  1497 01  VAL-VARIABLES.
  1498     03  W-CTA-BDCUE                 PIC 9(02) VALUE ZEROS.
  1499     03  SW-LOAD-TBL                 PIC 9(01) VALUE ZEROS.
  1500     03  T                           PIC 9(04) VALUE ZEROS.
  1501     03  TOPE-T                      PIC 9(04) VALUE ZEROS.
  1502     03  TABLA-VAL-TIP-CTA OCCURS 100 TIMES.
  1503         04 VEC-VALOR-BDACUE OCCURS 15 TIMES PIC 9.
  1504*----------------------------------------------------------------*
  1505*     VARIABLES ESTADISTICAS                                     *
  1506*----------------------------------------------------------------*
  1507 01  W-ACUMULADORES-ESTA.
  1508     03 W-ESTADO-INF          OCCURS  3 TIMES.
  1509        05 W-TABLA-TIPO-ID    OCCURS  5 TIMES.
  1510           07 W-ACUM-TIPO-ID    PIC  9(07) VALUE ZEROS.
  1511*------------------------------------------------------------*
  1512*    ACUMULACION VARIABLES DEMOGRAFICAS
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  27
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1513*------------------------------------------------------------*
  1514     03 W-EDAD-66           PIC  9(07) VALUE ZEROS.
  1515     03 W-EDAD-56-65        PIC  9(07) VALUE ZEROS.
  1516     03 W-EDAD-46-55        PIC  9(07) VALUE ZEROS.
  1517     03 W-EDAD-36-45        PIC  9(07) VALUE ZEROS.
  1518     03 W-EDAD-29-35        PIC  9(07) VALUE ZEROS.
  1519     03 W-EDAD-22-28        PIC  9(07) VALUE ZEROS.
  1520     03 W-EDAD-18-21        PIC  9(07) VALUE ZEROS.
  1521*------------------------------------------------------------*
  1522*    ACUMULACION ESTADO ACTUAL
  1523*------------------------------------------------------------*
  1524     03 W-TOT-CAR-CASTIGA      PIC  9(07) VALUE ZEROS.
  1525     03 W-TOT-DUD-RECAUDO      PIC  9(07) VALUE ZEROS.
  1526     03 W-TOT-CTES-EMBARGADAS  PIC  9(07) VALUE ZEROS.
  1527     03 W-TOT-MORAS-120-ACT    PIC  9(07) VALUE ZEROS.
  1528     03 W-TOT-MORAS-90-ACT     PIC  9(07) VALUE ZEROS.
  1529     03 W-TOT-MORAS-60-ACT     PIC  9(07) VALUE ZEROS.
  1530     03 W-TOT-MORAS-30-ACT     PIC  9(07) VALUE ZEROS.
  1531     03 W-TOT-W-ENDEUDA        PIC  9(07) VALUE ZEROS.
  1532     03 W-TOT-ALDIA            PIC  9(07) VALUE ZEROS.
  1533     03 W-TOT-SIN-CTAS         PIC  9(07) VALUE ZEROS.
  1534*------------------------------------------------------------*
  1535*    ACUMULACION ESTADO SECTOR
  1536*------------------------------------------------------------*
  1537     03 W-TOT-CC-DR-FINA       PIC  9(07) VALUE ZEROS.
  1538     03 W-TOT-MORAS-FINA       PIC  9(07) VALUE ZEROS.
  1539     03 W-TOT-ALDIA-FINA       PIC  9(07) VALUE ZEROS.
  1540     03 W-TOT-CC-DR-REAL       PIC  9(07) VALUE ZEROS.
  1541     03 W-TOT-MORAS-REAL       PIC  9(07) VALUE ZEROS.
  1542     03 W-TOT-ALDIA-REAL       PIC  9(07) VALUE ZEROS.
  1543     03 W-TOT-CC-DR-COOP       PIC  9(07) VALUE ZEROS.
  1544     03 W-TOT-MORAS-COOP       PIC  9(07) VALUE ZEROS.
  1545     03 W-TOT-ALDIA-COOP       PIC  9(07) VALUE ZEROS.
  1546     03 W-TOT-CC-DR-TELE       PIC  9(07) VALUE ZEROS.
  1547     03 W-TOT-MORAS-TELE       PIC  9(07) VALUE ZEROS.
  1548     03 W-TOT-ALDIA-TELE       PIC  9(07) VALUE ZEROS.
  1549*------------------------------------------------------------*
  1550*    ACUMULACION VALORES TOTALES
  1551*------------------------------------------------------------*
  1552     03 W-SALDOS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1553     03 W-CUOTAS-SEC-FINA      PIC  9(15) VALUE ZEROS.
  1554     03 W-MORAS-SEC-FINA       PIC  9(15) VALUE ZEROS.
  1555     03 W-SALDOS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1556     03 W-CUOTAS-SEC-REAL      PIC  9(15) VALUE ZEROS.
  1557     03 W-MORAS-SEC-REAL       PIC  9(15) VALUE ZEROS.
  1558     03 W-SALDOS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1559     03 W-CUOTAS-SEC-COOP      PIC  9(15) VALUE ZEROS.
  1560     03 W-MORAS-SEC-COOP       PIC  9(15) VALUE ZEROS.
  1561
  1562*---------------------------------------------------------*
  1563 01  W-PARAMETROS              PIC  X(94) VALUE SPACES.
  1564*---------------------------------------------------------*
  1565
  1566*----------------------------------------------------------------*
  1567* Estas son las variables para analizar los vectores de          *
  1568* comportamiento de moras HISTORICAS (estado-mes-abd07) y        *
  1569* (vector-2-abd07)                                               *
  1570*----------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  28
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1571 01  WS-ESTADO-MES-1                        PIC 9(12).
  1572 01  WS-ESTADO-MES-2                        PIC 9(12).
  1573 01  WS-ESTADO-MES                          PIC 9(12).
  1574 01  WS-ESTADO-MES-R REDEFINES WS-ESTADO-MES.
  1575     03  WS-MES                             PIC X OCCURS 12 TIMES.
  1576 01  ESTADO-MES-IMP.
  1577     03  E-MES-IMP                          PIC X OCCURS 12 TIMES.
  1578
  1579 01  ESTADO-ANUAL.
  1580     03  CHAR-H                             PIC X OCCURS 12 TIMES.
  1581 01  I                                      PIC 9(3)   VALUE ZERO.
  1582
  1583 01  E                                      PIC 9(3)   VALUE ZERO.
  1584 01  K                                      PIC 9(4)   VALUE 01.
  1585 01  N                                      PIC 9(3)   VALUE ZERO.
  1586 01  TIV                                    PIC 9(3)   VALUE ZERO.
  1587 01  TFV                                    PIC 9(3)   VALUE ZERO.
  1588 01  F-AUX-1                                PIC 9(4)   VALUE ZERO.
  1589 01  F-AUX                                  PIC 9(4)   VALUE ZERO.
  1590 01  F-UACT-2                               PIC 9(4)   VALUE ZERO.
  1591 01  F-APE-7                                PIC 9(4)   VALUE ZERO.
  1592 01  F-ING-2                                PIC 9(4)   VALUE ZERO.
  1593 01  F-NOV-7                                PIC 9(4)   VALUE ZERO.
  1594 01  F-VIEJ                                 PIC 9(4)   VALUE ZERO.
  1595 01  ENCONTRO                               PIC 9(1)   VALUE ZERO.
  1596*01  RELLENO                                PIC 9(1)   VALUE ZERO.
  1597 01  CINCO                                  PIC 9(2)   VALUE 5.
  1598 01  NUEVO                                  PIC 9      VALUE 0.
  1599 01  COD-SUSCRIP-AUX                        PIC 9(6)   VALUE ZERO.
  1600*------------------------------------------------------------*
  1601 01  VECTOR-S.
  1602     03 VECTOR-A-R1                        PIC X(24).
  1603     03 VECTOR-A-R2                        PIC X(24).
  1604 01  VECTOR-S-12.
  1605     03 VECTOR-N-R1                        PIC X(24).
  1606     03 VECTOR-N-R2                        PIC X(24).
  1607*------------------------------------------------------------*
  1608  01 V-NOR.
  1609     02 V-NOR1                     PIC 9(12).
  1610     02 V-NOR2                     PIC 9(12).
  1611     02 V-NOR3                     PIC 9(12).
  1612     02 V-NOR4                     PIC 9(12).
  1613  01 V-NOR-AUX     PIC X(47) VALUE SPACES.
  1614
  1615  01 VECTORES-W.
  1616    02 VECTOR-MORA.
  1617       03 FILLER PIC X(25) VALUE "5PMPPPPPPPPP5555123411212".
  1618       03 FILLER PIC X(25) VALUE "3234123412341234999CRD999".
  1619    02 FILLER REDEFINES VECTOR-MORA.
  1620       03 V-MORA OCCURS 50 TIMES PIC X.
  1621*------------------------------------------------------------*
  1622 01  SALIDA-48.
  1623     05 S48-EST                     PIC X(15).
  1624     05 S48-SUS                     PIC X(14).
  1625     05 S48-FEC                     PIC 9(6).
  1626     05 S48-FECALPHA REDEFINES S48-FEC    PIC X(6).
  1627     05 S48-AVA                     PIC X(9).
  1628     05 S48-VEC                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  29
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1629     05 S48-VEC-12                  PIC X(12).
  1630*------------------------------------------------------------*
  1631 01  F-APE-07                      PIC 9999.
  1632 01  F-APE-07-R                    REDEFINES F-APE-07.
  1633     03  M-APE-07                  PIC 99.
  1634     03  A-APE-07                  PIC 99.
  1635*------------------------------------------------------------*
  1636 01  F-ING-02                      PIC 9999.
  1637 01  F-ING-02-R                    REDEFINES F-ING-02.
  1638     03  M-ING-02                  PIC 99.
  1639     03  A-ING-02                  PIC 99.
  1640 01  F-NOV-07                      PIC 9999.
  1641 01  F-NOV-07-R                    REDEFINES F-NOV-07.
  1642     03  M-NOV-07                  PIC 99.
  1643     03  A-NOV-07                  PIC 99.
  1644*---------------------------------------------------------------*
  1645 01  W-FECHA-APE.
  1646     03  W-ANIO-APE                PIC 9(04).
  1647     03  W-MES-APE                 PIC 9(02).
  1648*---------------------------------------------------------------*
  1649 01  W-FECHA-HOY                   PIC X(08).
  1650 01  W-FECHA-HOY-R                 REDEFINES W-FECHA-HOY.
  1651     03  W-ANO-HOY                 PIC 9(04).
  1652     03  W-MES-HOY                 PIC 9(02).
  1653     03  W-DIA-HOY                 PIC 9(02).
  1654 01  CAL-NRO-MESES                 PIC S9(05).
  1655*---------------------------------------------------------------*
  1656 01  F-UACT-02                     PIC 9999.
  1657 01  F-UACT-02-R                   REDEFINES F-UACT-02.
  1658     03  M-UACT-02                 PIC 99.
  1659     03  A-UACT-02                 PIC 99.
  1660 01  WS-EST-MES.
  1661     03  WS-MES-NUEV               PIC 9.
  1662     03  WS-MESES-VIEJ             PIC 9(12).
  1663 01  WS-EST-MES-R REDEFINES WS-EST-MES.
  1664     03  WS-MESES-NUEV             PIC 9(12).
  1665     03  WS-MES-VIEJ               PIC 9.
  1666 01  FN.
  1667     03  FEC-NOV-S                 PIC 9(4)   VALUE ZERO.
  1668     03  FEC-NOV-RED-S REDEFINES FEC-NOV-S
  1669                                   PIC X(04).
  1670 01 ANO-2000                       PIC 99  VALUE 0.
  1671 01  SCREEN-HEADER.
  1672     03  FILLER                    PIC X(30) VALUE SPACES.
  1673     03  FILLER                    PIC X(20) VALUE
  1674         "=== DATA CREDITO ===" .
  1675     03  FILLER                    PIC X(30) VALUE SPACES.
  1676 01  SCREEN-TITLE REDEFINES SCREEN-HEADER PIC X(80).
  1677 01  MULT-TABLA OCCURS 200 TIMES.
  1678     03 MULT-CODIGO                PIC 9(6).
  1679     03 MULT-CLAVE                 PIC X(5).
  1680     03 MULT-TERMINAL              PIC 9(4).
  1681     03 MULT-PRODUCTO              PIC 9(2).
  1682     03 MULT-MODALIDAD             PIC 9(2).
  1683     03 MULT-ESTADO                PIC 9.
  1684     03 MULT-TTY                   PIC X(8).
  1685     03 MULT-SESION                PIC X(4) COMP-5.
  1686     03 MULT-PRIV-CLAVE            PIC 9(1).
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  30
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl                   lo/copys/BDAC
  1687     03 MULT-PRO-EXCLU             PIC 9(1).
  1688     03 MULT-NOM-SUS               PIC X(14).
  1689     03 MULT-NIT                   PIC 9(11) COMP-3.
  1690 01  NOM-COR-AUX             PIC X(14) VALUE SPACES.
  1691 01  FILLER REDEFINES NOM-COR-AUX.
  1692      02 NOM-COR-AUXN        PIC 9(6).
  1693      02 FILLER              PIC X(8).
  1694 01  NOM-COR-AUX2            PIC X(14) VALUE SPACES.
  1695 01  MENSAJE-CS.
  1696     02 HEADER.
  1697       03 HEADER-USUARIO           PIC X(10).
  1698       03 HEADER-TIPO-MENSAJE      PIC 9.
  1699       03 HEADER-LSN               PIC 9(4).
  1700       03 HEADER-LONGITUD          PIC 9(4).
  1701       03 HEADER-TERMINAL          PIC X(8).
  1702       03 HEADER-NOMB-PROG         PIC X(6).
  1703       03 HEADER-FILA              PIC 99.
  1704       03 HEADER-COLUMNA           PIC 99.
  1705       03 HEADER-CARACT-INICIO     PIC 9.
  1706       03 HEADER-CARACT-FIN        PIC 9.
  1707       03 HEADER-TIPO-TERMINAL     PIC X(6).
  1708       03 HEADER-FILLER            PIC X(5).
  1709    02 TEXTO                       PIC X(2000).
  1710    02 TEXTO-INPUT REDEFINES TEXTO.
  1711       03 AREA-INPUT               PIC X(80).
  1712       03 FILLER                   PIC X(1920).
  1713*-----------------------------------------------------------*
  1714 01  TABLA-HISTORICA-MORAS.
  1715     03 w-moras-historicas-v       pic X(48) value zeros.
  1716     03 w-moras-historicas-v-r redefines w-moras-historicas-v.
  1717        05 w-moras-historicas occurs 48 times pic X(01).
  1718 01  ARRASTRE                      PIC 9 VALUE ZEROS.
  1719*------------------------------------------------------------*
* 1720 COPY ICFILE.WS.
  1721* ICFILE-WS.v.0043.
  1722* COPY PARA DIRECCIONAR LOS ARCHIVOS.
  1723*****************************************************************
  1724* RMB0008     * SE ADICIONA NOMBRE DE ARCHIVO DE BASE DE DATOS
  1725*R.MARTINEZ   * UNIVERSAL.
  1726******************************************************************
  1727* VHF0009     * SE ADICIONA TABLA DE CIIUS                       *
  1728* VICTOR HUGO *                                                  *
  1729* FORERO      *                                                  *
  1730* DIC.01/2000 *                                                  *
  1731******************************************************************
  1732* VHF0010     * SE ADICIONAN COPYS PARA MANEJOS DE NOMBRES DE :  *
  1733* VICTOR HUGO * NOMCCB - CAMARA DE COMERCIO DE BOGOTA            *
  1734* FORERO      * NOMREG - REGISTRADURIA                           *
  1735* SEP.10/2001 * NOMDAS - DAS                                     *
  1736*             * NMDIAN - DIAN                                    *
  1737******************************************************************
  1738* VHF0011     * SE ADICIONAN NOMBRES DE ARCHIVO DE NOMBRES DE    *
  1739* VICTOR HUGO * BYINGTON                                         *
  1740* FORERO      *                                                  *
  1741* FEB.18/2002 *                                                  *
  1742******************************************************************
  1743* FAC0012     * BDIEND - SE ADICIONAN RUTAS DE ARCHIVOS PARA     *
  1744* F.CUADROS   * MANEJO DE ENDEUDAMIENTO GLOBAL                   *
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  31
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1745* SEP.04/2002 *                                                  *
  1746* GJC0012     * DTCLOG - SE ADICIONA NOMBRE DEL ARCHIVO DE LOG DE*
  1747* G.JIMENEZ   * MODIFIFICACIONES EN LINEA Y DATACIUDADANOS       *
  1748* OCT.29/2002 *                                                  *
  1749******************************************************************
  1750* VHF0013     * ARCHIVOS ASOCIADOS CON SISTEMA DATACIUDADANOS    *
  1751* VICTOR HUGO * DTCING - ARCHIVO DE INGRESOS FALLIDOS            *
  1752* FORERO      * DTCFAL - MUESTRA LA ULTIMA TRANSACCION ANTES DE  *
  1753* ENE.16/2003 *          LAS BAJADAS DEL SISTEMA NORMAL O ANORMAL*
  1754*             * DTCMDF - CONTIENE CONSECUTIVOS DE RADICACION Y   *
  1755*             *          ENTRADA-ENTIDAD                         *
  1756*             * DTCTRA - LOG DE INSTRUCCIONES SQL FALLIDAS       *
  1757* GJC0013     * BDL001 - NOMBRE DE ARCHIVO DE CLIENTES DE DIREC- *
  1758*             *          CIONES Y TELEFONOS                      *
  1759*             * DTCABD - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1760*             *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1761*             *          RRIENTES CON RECLAMOS VIGENTES          *
  1762******************************************************************
  1763* GJC0014     * DTCAB1 - NOMBRE DE ARCHIVO DE MANEJO DE CAMBIOS  *
  1764* G.JIMENEZ   *          EN REGISTROS DE CARTERA Y CUENTAS CO-   *
  1765* ENE.16/2003 *          RRIENTES CON RECLAMOS VIGENTES AJUSTE EN*
  1766*             *          NOMBRE                                  *
  1767******************************************************************
  1768* FAC0015     * WEB001 - INCLUSION DE NOMBRES DE ARCHIVOS PARA   *
  1769* F.CUADROS C.*          MANEJO DE CLAVES WEB                    *
  1770* FEB.14/2003 *                                                  *
  1771******************************************************************
  1772* FAC0016     * MODBDI - INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1773* F.CUADROS C.*          BDII: BASES DE DATOS DE IDENTIFICACION, *
  1774* MAR.03/2003 *          CON NUEVOS DISENOS.                     *
  1775******************************************************************
  1776* GJC0017     * DTCCOM - CREACION DEL ARCHIVO DE COMENTARIOS DEL *
  1777* G.JIMENEZ   *          SISTEMA DE DATACIUDADANOS.              *
  1778* JUN.05/2003 *                                                  *
  1779* VHF0017     * DTCNHB - DIRECCIONA ARCHIVO DE DIAS NO HABILES   *
  1780* VICTOR HUGO * ICDACT - SE ADICIONA NOMBRE DE ARCHIVO DE        *
  1781* FORERO      *          ESTADISTICAS DE SUSCRIPTORES ICDACT     *
  1782******************************************************************
  1783* FAC0018     * MODDIR-  INCLUSION DE NOMBRES DE ESTRUCTURAS DE  *
  1784* F.CUADROS C.*          ACTALOG Y VALVEST EN NUEVA RUTA         *
  1785* JUL.09/2003 *          en $TRABAJO/logs                        *
  1786******************************************************************
  1787* GJC0019     * CONRAZ-  INCLUSION DE NOMBRE DE ESTRUCTURA CONRAZ*
  1788* G.JIMENEZ  .*                                                  *
  1789* SEP.11/2003 *                                                  *
  1790******************************************************************
  1791* GJC0020     * FRAUDE - INCLUSION DE MANEJO DE ARCHIVO FRALOG   *
  1792* G.JIMENEZ  .*                                                  *
  1793* OCT.14/2004 *                                                  *
  1794******************************************************************
  1795* GJC0021     * PRODUC - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1796* G.JIMENEZ   *          PRODUCTOS                               *
  1797* ABR/2005    *                                                  *
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE         *
  1800* F.CUADROS   *          FRAINQ.DAT                              *
  1801* JUN.23/2005 *                                                  *
  1802******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO            *
  1804* F.CUADROS   *          HISTORICO PARA MICROCREDITO             *
  1805* SEP.02/2005 *                                                  *
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE       *
  1808* F.CUADROS   *          LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *          TIPO 8                                  *
  1810*             *                                                  *
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *          PARA PROCESOS DEL AREA DE CALIDAD.      *
  1814* OCT.17/2006 *                                                  *
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE         *
  1817* F.CUADROS   *          PREGUNTAS GRUPALES PARA FRAINQGR        *
  1818* SEP.11/2007 *                                                  *
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE         *
/d/iccol/desarrollo/fuentes/cobol>fg
vi icestd81.lst
  1797* ABR/2005    **
  1798******************************************************************
  1799* FAC0022     * FRAUD2 - SE INCLUYE MANEJO DE ARCHIVO DE*
  1800* F.CUADROS   *FRAINQ.DAT*
  1801* JUN.23/2005 **
  1802******************************************************************
^L^M* Micro Focus Server ExpressV5.1 revision 000 21-May-14 10:39 Page  32
* )D)D)D)l/desarrollo/fuentes/cobol/icestd81.cbl (/d/iccol/desarrollo/copys/ICFI
  1803* FAC0023     * REPMIC - SE INCLUYE TITULO DE ARCHIVO*
  1804* F.CUADROS   *HISTORICO PARA MICROCREDITO*
  1805* SEP.02/2005 **
  1806******************************************************************
  1807* FAC0023     * SUPT08 - INCLUSION DE TITULO DE MAESTRO DE*
  1808* F.CUADROS   *LA SUPERBANCARIA POR CAMBIO A FORMATO   *
  1809* OCT.28/2005 *TIPO 8*
  1810***
  1811******************************************************************
  1812* FAC0024     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOGS    *
  1813* F.CUADROS   *PARA PROCESOS DEL AREA DE CALIDAD.*
  1814* OCT.17/2006 **
  1815******************************************************************
  1816* CAV0025     * NVAPRE - INCLUSION DE RUTA DE ARCHIVO DE*
  1817* F.CUADROS   *PREGUNTAS GRUPALES PARA FRAINQGR*
  1818* SEP.11/2007 **
  1819******************************************************************
  1820* FLT0026     * BDSCOR - INCLUSION DE RUTA DE ARCHIVO DE*
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
~
  1821* F.LOZANO T. *SCORES MENSUALES.*
  1822* OCT.31/2007 **
  1823******************************************************************
  1824* CAV0027     * LOGCAL - INCLUSION DE RUTA DE ARCHIVO DE LOG     *
  1825* C.VELASCO   *DE LOS PROCESOS DE CALIDAD EJECUTADOS   *
  1826* MAR.05/2009 * LOGDRP - RUTA ARCHIVO PARA ACTUALIZAR DRP*
  1827******************************************************************
  1828* EAL0028     * ICMVLR - INCLUSION DE RUTA DE ARCHIVOS ICMVLR    *
  1829* E.ALVAREZ   *PARA PROCESAR 48 MESES DEL ARCHIVO*
  1830* JUN.19/2009 **
  1831******************************************************************
  1832* RGH0029     * MOD029 - MODIFICAR LONGUITUD DE VARIABLES*
  1833* R.GALVIS    *MAES-DIRECTORY ARCHIVOS ICMVLR*
  1834* JUL.09/2009 *DE 17 A 16 POSICIONES*
  1835** CHEQ01 - SE INCLUYE DEFINICION DE MAESTRO DE     *
  1836**CHEQUES*
  1837******************************************************************
  1838* VHF0030     * ICMCLN - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1839* V.FORERO    *CLIENTES*
  1840* SEP.28/2009 **
  1841******************************************************************
  1842* CAV0031     * NHC002 - INCLUSION DE RUTA DE NUEVO ARCHIVO DE   *
  1843* C.VELASCO   *MARCAS PRIVADAS PARA TARJETAS*
  1844* OCT.09/2009 **
  1845******************************************************************
  1846* RGH0032* MOD032 - INCLUIR ARCHIVOS DE RECONOCER +*
  1847* R. GALVIS H.  *BDLDIRACE*
  1848* ENE. 01/2010  *BDLMAIEXC*
  1849* INTERSCHEMES. *BDLTELEXC*
7025 more lines"icestd81.lst" 8905 lines, 526319 characters /d/iccol/desarrollo/fuentes/cobol>
shell will timeout in 60 seconds due to inactivity
ksh: timed out waiting for input
